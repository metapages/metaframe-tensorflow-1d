var H0,ht,oU,G0,sU,uU,lU,v2={},cU=[],Sbe=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function ql(e,t){for(var n in t)e[n]=t[n];return e}function fU(e){var t=e.parentNode;t&&t.removeChild(e)}function ue(e,t,n){var r,i,a,o={};for(a in t)a=="key"?r=t[a]:a=="ref"?i=t[a]:o[a]=t[a];if(arguments.length>2&&(o.children=arguments.length>3?H0.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(a in e.defaultProps)o[a]===void 0&&(o[a]=e.defaultProps[a]);return K0(e,o,r,i,null)}function K0(e,t,n,r,i){var a={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:i??++oU};return ht.vnode!=null&&ht.vnode(a),a}function Ebe(){return{current:null}}function Vi(e){return e.children}function Ns(e,t){this.props=e,this.context=t}function Lg(e,t){if(t==null)return e.__?Lg(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?Lg(e):null}function dU(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return dU(e)}}function EN(e){(!e.__d&&(e.__d=!0)&&G0.push(e)&&!y2.__r++||uU!==ht.debounceRendering)&&((uU=ht.debounceRendering)||sU)(y2)}function y2(){for(var e;y2.__r=G0.length;)e=G0.sort(function(t,n){return t.__v.__b-n.__v.__b}),G0=[],e.some(function(t){var n,r,i,a,o,s;t.__d&&(o=(a=(n=t).__v).__e,(s=n.__P)&&(r=[],(i=ql({},a)).__v=a.__v+1,CN(s,a,i,n.__n,s.ownerSVGElement!==void 0,a.__h!=null?[o]:null,r,o??Lg(a),a.__h),bU(r,a),a.__e!=o&&dU(a)))})}function hU(e,t,n,r,i,a,o,s,u,l){var c,f,d,h,p,g,m,v=r&&r.__k||cU,y=v.length;for(n.__k=[],c=0;c<t.length;c++)if((h=n.__k[c]=(h=t[c])==null||typeof h=="boolean"?null:typeof h=="string"||typeof h=="number"||typeof h=="bigint"?K0(null,h,null,null,h):Array.isArray(h)?K0(Vi,{children:h},null,null,null):h.__b>0?K0(h.type,h.props,h.key,null,h.__v):h)!=null){if(h.__=n,h.__b=n.__b+1,(d=v[c])===null||d&&h.key==d.key&&h.type===d.type)v[c]=void 0;else for(f=0;f<y;f++){if((d=v[f])&&h.key==d.key&&h.type===d.type){v[f]=void 0;break}d=null}CN(e,h,d=d||v2,i,a,o,s,u,l),p=h.__e,(f=h.ref)&&d.ref!=f&&(m||(m=[]),d.ref&&m.push(d.ref,null,h),m.push(f,h.__c||p,h)),p!=null?(g==null&&(g=p),typeof h.type=="function"&&h.__k!=null&&h.__k===d.__k?h.__d=u=pU(h,u,e):u=gU(e,h,d,v,p,u),l||n.type!=="option"?typeof n.type=="function"&&(n.__d=u):e.value=""):u&&d.__e==u&&u.parentNode!=e&&(u=Lg(d))}for(n.__e=g,c=y;c--;)v[c]!=null&&(typeof n.type=="function"&&v[c].__e!=null&&v[c].__e==n.__d&&(n.__d=Lg(r,c+1)),wU(v[c],v[c]));if(m)for(c=0;c<m.length;c++)xU(m[c],m[++c],m[++c])}function pU(e,t,n){var r,i;for(r=0;r<e.__k.length;r++)(i=e.__k[r])&&(i.__=e,t=typeof i.type=="function"?pU(i,t,n):gU(n,i,i,e.__k,i.__e,t));return t}function Hl(e,t){return t=t||[],e==null||typeof e=="boolean"||(Array.isArray(e)?e.some(function(n){Hl(n,t)}):t.push(e)),t}function gU(e,t,n,r,i,a){var o,s,u;if(t.__d!==void 0)o=t.__d,t.__d=void 0;else if(n==null||i!=a||i.parentNode==null)e:if(a==null||a.parentNode!==e)e.appendChild(i),o=null;else{for(s=a,u=0;(s=s.nextSibling)&&u<r.length;u+=2)if(s==i)break e;e.insertBefore(i,a),o=a}return o!==void 0?o:i.nextSibling}function Cbe(e,t,n,r,i){var a;for(a in n)a==="children"||a==="key"||a in t||b2(e,a,null,n[a],r);for(a in t)i&&typeof t[a]!="function"||a==="children"||a==="key"||a==="value"||a==="checked"||n[a]===t[a]||b2(e,a,t[a],n[a],r)}function mU(e,t,n){t[0]==="-"?e.setProperty(t,n):e[t]=n==null?"":typeof n!="number"||Sbe.test(t)?n:n+"px"}function b2(e,t,n,r,i){var a;e:if(t==="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof r=="string"&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||mU(e.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||mU(e.style,t,n[t])}else if(t[0]==="o"&&t[1]==="n")a=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+a]=n,n?r||e.addEventListener(t,a?yU:vU,a):e.removeEventListener(t,a?yU:vU,a);else if(t!=="dangerouslySetInnerHTML"){if(i)t=t.replace(/xlink[H:h]/,"h").replace(/sName$/,"s");else if(t!=="href"&&t!=="list"&&t!=="form"&&t!=="tabIndex"&&t!=="download"&&t in e)try{e[t]=n??"";break e}catch(o){}typeof n=="function"||(n!=null&&(n!==!1||t[0]==="a"&&t[1]==="r")?e.setAttribute(t,n):e.removeAttribute(t))}}function vU(e){this.l[e.type+!1](ht.event?ht.event(e):e)}function yU(e){this.l[e.type+!0](ht.event?ht.event(e):e)}function CN(e,t,n,r,i,a,o,s,u){var l,c,f,d,h,p,g,m,v,y,b,x=t.type;if(t.constructor!==void 0)return null;n.__h!=null&&(u=n.__h,s=t.__e=n.__e,t.__h=null,a=[s]),(l=ht.__b)&&l(t);try{e:if(typeof x=="function"){if(m=t.props,v=(l=x.contextType)&&r[l.__c],y=l?v?v.props.value:l.__:r,n.__c?g=(c=t.__c=n.__c).__=c.__E:("prototype"in x&&x.prototype.render?t.__c=c=new x(m,y):(t.__c=c=new Ns(m,y),c.constructor=x,c.render=kbe),v&&v.sub(c),c.props=m,c.state||(c.state={}),c.context=y,c.__n=r,f=c.__d=!0,c.__h=[]),c.__s==null&&(c.__s=c.state),x.getDerivedStateFromProps!=null&&(c.__s==c.state&&(c.__s=ql({},c.__s)),ql(c.__s,x.getDerivedStateFromProps(m,c.__s))),d=c.props,h=c.state,f)x.getDerivedStateFromProps==null&&c.componentWillMount!=null&&c.componentWillMount(),c.componentDidMount!=null&&c.__h.push(c.componentDidMount);else{if(x.getDerivedStateFromProps==null&&m!==d&&c.componentWillReceiveProps!=null&&c.componentWillReceiveProps(m,y),!c.__e&&c.shouldComponentUpdate!=null&&c.shouldComponentUpdate(m,c.__s,y)===!1||t.__v===n.__v){c.props=m,c.state=c.__s,t.__v!==n.__v&&(c.__d=!1),c.__v=t,t.__e=n.__e,t.__k=n.__k,t.__k.forEach(function(w){w&&(w.__=t)}),c.__h.length&&o.push(c);break e}c.componentWillUpdate!=null&&c.componentWillUpdate(m,c.__s,y),c.componentDidUpdate!=null&&c.__h.push(function(){c.componentDidUpdate(d,h,p)})}c.context=y,c.props=m,c.state=c.__s,(l=ht.__r)&&l(t),c.__d=!1,c.__v=t,c.__P=e,l=c.render(c.props,c.state,c.context),c.state=c.__s,c.getChildContext!=null&&(r=ql(ql({},r),c.getChildContext())),f||c.getSnapshotBeforeUpdate==null||(p=c.getSnapshotBeforeUpdate(d,h)),b=l!=null&&l.type===Vi&&l.key==null?l.props.children:l,hU(e,Array.isArray(b)?b:[b],t,n,r,i,a,o,s,u),c.base=t.__e,t.__h=null,c.__h.length&&o.push(c),g&&(c.__E=c.__=null),c.__e=!1}else a==null&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=Abe(n.__e,t,n,r,i,a,o,u);(l=ht.diffed)&&l(t)}catch(w){t.__v=null,(u||a!=null)&&(t.__e=s,t.__h=!!u,a[a.indexOf(s)]=null),ht.__e(w,t,n)}}function bU(e,t){ht.__c&&ht.__c(t,e),e.some(function(n){try{e=n.__h,n.__h=[],e.some(function(r){r.call(n)})}catch(r){ht.__e(r,n.__v)}})}function Abe(e,t,n,r,i,a,o,s){var u,l,c,f=n.props,d=t.props,h=t.type,p=0;if(h==="svg"&&(i=!0),a!=null){for(;p<a.length;p++)if((u=a[p])&&(u===e||(h?u.localName==h:u.nodeType==3))){e=u,a[p]=null;break}}if(e==null){if(h===null)return document.createTextNode(d);e=i?document.createElementNS("http://www.w3.org/2000/svg",h):document.createElement(h,d.is&&d),a=null,s=!1}if(h===null)f===d||s&&e.data===d||(e.data=d);else{if(a=a&&H0.call(e.childNodes),l=(f=n.props||v2).dangerouslySetInnerHTML,c=d.dangerouslySetInnerHTML,!s){if(a!=null)for(f={},p=0;p<e.attributes.length;p++)f[e.attributes[p].name]=e.attributes[p].value;(c||l)&&(c&&(l&&c.__html==l.__html||c.__html===e.innerHTML)||(e.innerHTML=c&&c.__html||""))}if(Cbe(e,d,f,i,s),c)t.__k=[];else if(p=t.props.children,hU(e,Array.isArray(p)?p:[p],t,n,r,i&&h!=="foreignObject",a,o,a?a[0]:n.__k&&Lg(n,0),s),a!=null)for(p=a.length;p--;)a[p]!=null&&fU(a[p]);s||("value"in d&&(p=d.value)!==void 0&&(p!==e.value||h==="progress"&&!p)&&b2(e,"value",p,f.value,!1),"checked"in d&&(p=d.checked)!==void 0&&p!==e.checked&&b2(e,"checked",p,f.checked,!1))}return e}function xU(e,t,n){try{typeof e=="function"?e(t):e.current=t}catch(r){ht.__e(r,n)}}function wU(e,t,n){var r,i;if(ht.unmount&&ht.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||xU(r,null,t)),(r=e.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(a){ht.__e(a,t)}r.base=r.__P=null}if(r=e.__k)for(i=0;i<r.length;i++)r[i]&&wU(r[i],t,typeof e.type!="function");n||e.__e==null||fU(e.__e),e.__e=e.__d=void 0}function kbe(e,t,n){return this.constructor(e,n)}function Bg(e,t,n){var r,i,a;ht.__&&ht.__(e,t),i=(r=typeof n=="function")?null:n&&n.__k||t.__k,a=[],CN(t,e=(!r&&n||t).__k=ue(Vi,null,[e]),i||v2,v2,t.ownerSVGElement!==void 0,!r&&n?[n]:i?null:t.firstChild?H0.call(t.childNodes):null,a,!r&&n?n:i?i.__e:t.firstChild,r),bU(a,e)}function _U(e,t){Bg(e,t,_U)}function Tbe(e,t,n){var r,i,a,o=ql({},e.props);for(a in t)a=="key"?r=t[a]:a=="ref"?i=t[a]:o[a]=t[a];return arguments.length>2&&(o.children=arguments.length>3?H0.call(arguments,2):n),K0(e.type,o,r||e.key,i||e.ref,null)}function ha(e,t){var n={__c:t="__cC"+lU++,__:e,Consumer:function(r,i){return r.children(i)},Provider:function(r){var i,a;return this.getChildContext||(i=[],(a={})[t]=this,this.getChildContext=function(){return a},this.shouldComponentUpdate=function(o){this.props.value!==o.value&&i.some(EN)},this.sub=function(o){i.push(o);var s=o.componentWillUnmount;o.componentWillUnmount=function(){i.splice(i.indexOf(o),1),s&&s.call(o)}}),r.children}};return n.Provider.__=n.Consumer.contextType=n}H0=cU.slice,ht={__e:function(e,t){for(var n,r,i;t=t.__;)if((n=t.__c)&&!n.__)try{if((r=n.constructor)&&r.getDerivedStateFromError!=null&&(n.setState(r.getDerivedStateFromError(e)),i=n.__d),n.componentDidCatch!=null&&(n.componentDidCatch(e),i=n.__d),i)return n.__E=n}catch(a){e=a}throw e}},oU=0,Ns.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=ql({},this.state),typeof e=="function"&&(e=e(ql({},n),this.props)),e&&ql(n,e),e!=null&&this.__v&&(t&&this.__h.push(t),EN(this))},Ns.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),EN(this))},Ns.prototype.render=Vi,G0=[],sU=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,y2.__r=0,lU=0;var zg,pa,SU,jg=0,AN=[],EU=ht.__b,CU=ht.__r,AU=ht.diffed,kU=ht.__c,TU=ht.unmount;function X0(e,t){ht.__h&&ht.__h(pa,e,jg||t),jg=0;var n=pa.__H||(pa.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function an(e){return jg=1,kN(IU,e)}function kN(e,t,n){var r=X0(zg++,2);return r.t=e,r.__c||(r.__=[n?n(t):IU(void 0,t),function(i){var a=r.t(r.__[0],i);r.__[0]!==a&&(r.__=[a,r.__[1]],r.__c.setState({}))}],r.__c=pa),r.__}function qt(e,t){var n=X0(zg++,3);!ht.__s&&ON(n.__H,t)&&(n.__=e,n.__H=t,pa.__H.__h.push(n))}function lf(e,t){var n=X0(zg++,4);!ht.__s&&ON(n.__H,t)&&(n.__=e,n.__H=t,pa.__h.push(n))}function Jt(e){return jg=5,xr(function(){return{current:e}},[])}function Obe(e,t,n){jg=6,lf(function(){typeof e=="function"?e(t()):e&&(e.current=t())},n==null?n:n.concat(e))}function xr(e,t){var n=X0(zg++,7);return ON(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function st(e,t){return jg=8,xr(function(){return e},t)}function Un(e){var t=pa.context[e.__c],n=X0(zg++,9);return n.c=e,t?(n.__==null&&(n.__=!0,t.sub(pa)),t.props.value):e.__}function Ibe(e,t){ht.useDebugValue&&ht.useDebugValue(t?t(e):e)}function Nbe(){AN.forEach(function(e){if(e.__P)try{e.__H.__h.forEach(x2),e.__H.__h.forEach(TN),e.__H.__h=[]}catch(t){e.__H.__h=[],ht.__e(t,e.__v)}}),AN=[]}ht.__b=function(e){pa=null,EU&&EU(e)},ht.__r=function(e){CU&&CU(e),zg=0;var t=(pa=e.__c).__H;t&&(t.__h.forEach(x2),t.__h.forEach(TN),t.__h=[])},ht.diffed=function(e){AU&&AU(e);var t=e.__c;t&&t.__H&&t.__H.__h.length&&(AN.push(t)!==1&&SU===ht.requestAnimationFrame||((SU=ht.requestAnimationFrame)||function(n){var r,i=function(){clearTimeout(a),OU&&cancelAnimationFrame(r),setTimeout(n)},a=setTimeout(i,100);OU&&(r=requestAnimationFrame(i))})(Nbe)),pa=void 0},ht.__c=function(e,t){t.some(function(n){try{n.__h.forEach(x2),n.__h=n.__h.filter(function(r){return!r.__||TN(r)})}catch(r){t.some(function(i){i.__h&&(i.__h=[])}),t=[],ht.__e(r,n.__v)}}),kU&&kU(e,t)},ht.unmount=function(e){TU&&TU(e);var t=e.__c;if(t&&t.__H)try{t.__H.__.forEach(x2)}catch(n){ht.__e(n,t.__v)}};var OU=typeof requestAnimationFrame=="function";function x2(e){var t=pa;typeof e.__c=="function"&&e.__c(),pa=t}function TN(e){var t=pa;e.__c=e.__(),pa=t}function ON(e,t){return!e||e.length!==t.length||t.some(function(n,r){return n!==e[r]})}function IU(e,t){return typeof t=="function"?t(e):t}function NU(e,t){for(var n in t)e[n]=t[n];return e}function IN(e,t){for(var n in e)if(n!=="__source"&&!(n in t))return!0;for(var r in t)if(r!=="__source"&&e[r]!==t[r])return!0;return!1}function w2(e){this.props=e}function DU(e,t){function n(i){var a=this.props.ref,o=a==i.ref;return!o&&a&&(a.call?a(null):a.current=null),t?!t(this.props,i)||!o:IN(this.props,i)}function r(i){return this.shouldComponentUpdate=n,ue(e,i)}return r.displayName="Memo("+(e.displayName||e.name)+")",r.prototype.isReactComponent=!0,r.__f=!0,r}(w2.prototype=new Ns).isPureReactComponent=!0,w2.prototype.shouldComponentUpdate=function(e,t){return IN(this.props,e)||IN(this.state,t)};var RU=ht.__b;ht.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),RU&&RU(e)};var Dbe=typeof Symbol!="undefined"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function Gl(e){function t(n,r){var i=NU({},n);return delete i.ref,e(i,(r=n.ref||r)&&(typeof r!="object"||"current"in r)?r:null)}return t.$$typeof=Dbe,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var FU=function(e,t){return e==null?null:Hl(Hl(e).map(t))},_2={map:FU,forEach:FU,count:function(e){return e?Hl(e).length:0},only:function(e){var t=Hl(e);if(t.length!==1)throw"Children.only";return t[0]},toArray:Hl},Rbe=ht.__e;ht.__e=function(e,t,n){if(e.then){for(var r,i=t;i=i.__;)if((r=i.__c)&&r.__c)return t.__e==null&&(t.__e=n.__e,t.__k=n.__k),r.__c(e,t)}Rbe(e,t,n)};var MU=ht.unmount;function S2(){this.__u=0,this.t=null,this.__b=null}function PU(e){var t=e.__.__c;return t&&t.__e&&t.__e(e)}function Fbe(e){var t,n,r;function i(a){if(t||(t=e()).then(function(o){n=o.default||o},function(o){r=o}),r)throw r;if(!n)throw t;return ue(n,a)}return i.displayName="Lazy",i.__f=!0,i}function Y0(){this.u=null,this.o=null}ht.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&e.__h===!0&&(e.type=null),MU&&MU(e)},(S2.prototype=new Ns).__c=function(e,t){var n=t.__c,r=this;r.t==null&&(r.t=[]),r.t.push(n);var i=PU(r.__v),a=!1,o=function(){a||(a=!0,n.__R=null,i?i(s):s())};n.__R=o;var s=function(){if(!--r.__u){if(r.state.__e){var l=r.state.__e;r.__v.__k[0]=function f(d,h,p){return d&&(d.__v=null,d.__k=d.__k&&d.__k.map(function(g){return f(g,h,p)}),d.__c&&d.__c.__P===h&&(d.__e&&p.insertBefore(d.__e,d.__d),d.__c.__e=!0,d.__c.__P=p)),d}(l,l.__c.__P,l.__c.__O)}var c;for(r.setState({__e:r.__b=null});c=r.t.pop();)c.forceUpdate()}},u=t.__h===!0;r.__u++||u||r.setState({__e:r.__b=r.__v.__k[0]}),e.then(o,o)},S2.prototype.componentWillUnmount=function(){this.t=[]},S2.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=function a(o,s,u){return o&&(o.__c&&o.__c.__H&&(o.__c.__H.__.forEach(function(l){typeof l.__c=="function"&&l.__c()}),o.__c.__H=null),(o=NU({},o)).__c!=null&&(o.__c.__P===u&&(o.__c.__P=s),o.__c=null),o.__k=o.__k&&o.__k.map(function(l){return a(l,s,u)})),o}(this.__b,n,r.__O=r.__P)}this.__b=null}var i=t.__e&&ue(Vi,null,e.fallback);return i&&(i.__h=null),[ue(Vi,null,t.__e?null:e.children),i]};var $U=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&(e.props.revealOrder[0]!=="t"||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};function Mbe(e){return this.getChildContext=function(){return e.context},e.children}function Pbe(e){var t=this,n=e.i;t.componentWillUnmount=function(){Bg(null,t.l),t.l=null,t.i=null},t.i&&t.i!==n&&t.componentWillUnmount(),e.__v?(t.l||(t.i=n,t.l={nodeType:1,parentNode:n,childNodes:[],appendChild:function(r){this.childNodes.push(r),t.i.appendChild(r)},insertBefore:function(r,i){this.childNodes.push(r),t.i.appendChild(r)},removeChild:function(r){this.childNodes.splice(this.childNodes.indexOf(r)>>>1,1),t.i.removeChild(r)}}),Bg(ue(Mbe,{context:t.context},e.__v),t.l)):t.l&&t.componentWillUnmount()}function NN(e,t){return ue(Pbe,{__v:e,i:t})}(Y0.prototype=new Ns).__e=function(e){var t=this,n=PU(t.__v),r=t.o.get(e);return r[0]++,function(i){var a=function(){t.props.revealOrder?(r.push(i),$U(t,e,r)):i()};n?n(a):a()}},Y0.prototype.render=function(e){this.u=null,this.o=new Map;var t=Hl(e.children);e.revealOrder&&e.revealOrder[0]==="b"&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},Y0.prototype.componentDidUpdate=Y0.prototype.componentDidMount=function(){var e=this;this.o.forEach(function(t,n){$U(e,n,t)})};var LU=typeof Symbol!="undefined"&&Symbol.for&&Symbol.for("react.element")||60103,$be=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|fill|flood|font|glyph(?!R)|horiz|marker(?!H|W|U)|overline|paint|stop|strikethrough|stroke|text(?!L)|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Lbe=function(e){return(typeof Symbol!="undefined"&&typeof Symbol()=="symbol"?/fil|che|rad/i:/fil|che|ra/i).test(e)};function Bbe(e,t,n){return t.__k==null&&(t.textContent=""),Bg(e,t),typeof n=="function"&&n(),e?e.__c:null}function zbe(e,t,n){return _U(e,t),typeof n=="function"&&n(),e?e.__c:null}Ns.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(Ns.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var BU=ht.event;function jbe(){}function Ube(){return this.cancelBubble}function Wbe(){return this.defaultPrevented}ht.event=function(e){return BU&&(e=BU(e)),e.persist=jbe,e.isPropagationStopped=Ube,e.isDefaultPrevented=Wbe,e.nativeEvent=e};var zU,jU={configurable:!0,get:function(){return this.class}},UU=ht.vnode;ht.vnode=function(e){var t=e.type,n=e.props,r=n;if(typeof t=="string"){for(var i in r={},n){var a=n[i];i==="value"&&"defaultValue"in n&&a==null||(i==="defaultValue"&&"value"in n&&n.value==null?i="value":i==="download"&&a===!0?a="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+t)&&!Lbe(n.type)?i="oninput":/^on(Ani|Tra|Tou|BeforeInp)/.test(i)?i=i.toLowerCase():$be.test(i)?i=i.replace(/[A-Z0-9]/,"-$&").toLowerCase():a===null&&(a=void 0),r[i]=a)}t=="select"&&r.multiple&&Array.isArray(r.value)&&(r.value=Hl(n.children).forEach(function(o){o.props.selected=r.value.indexOf(o.props.value)!=-1})),t=="select"&&r.defaultValue!=null&&(r.value=Hl(n.children).forEach(function(o){o.props.selected=r.multiple?r.defaultValue.indexOf(o.props.value)!=-1:r.defaultValue==o.props.value})),e.props=r}t&&n.class!=n.className&&(jU.enumerable="className"in n,n.className!=null&&(r.class=n.className),Object.defineProperty(r,"className",jU)),e.$$typeof=LU,UU&&UU(e)};var WU=ht.__r;ht.__r=function(e){WU&&WU(e),zU=e.__c};var Vbe={ReactCurrentDispatcher:{current:{readContext:function(e){return zU.__n[e.__c].props.value}}}};function qbe(e){return ue.bind(null,e)}function gh(e){return!!e&&e.$$typeof===LU}function cf(e){return gh(e)?Tbe.apply(null,arguments):e}function Hbe(e){return!!e.__k&&(Bg(null,e),!0)}function Gbe(e){return e&&(e.base||e.nodeType===1&&e)||null}var Kbe=function(e,t){return e(t)},Xbe=function(e,t){return e(t)},zt={useState:an,useReducer:kN,useEffect:qt,useLayoutEffect:lf,useRef:Jt,useImperativeHandle:Obe,useMemo:xr,useCallback:st,useContext:Un,useDebugValue:Ibe,version:"17.0.2",Children:_2,render:Bbe,hydrate:zbe,unmountComponentAtNode:Hbe,createPortal:NN,createElement:ue,createContext:ha,createFactory:qbe,cloneElement:cf,createRef:Ebe,Fragment:Vi,isValidElement:gh,findDOMNode:Gbe,Component:Ns,PureComponent:w2,memo:DU,forwardRef:Gl,flushSync:Xbe,unstable_batchedUpdates:Kbe,StrictMode:Vi,Suspense:S2,SuspenseList:Y0,lazy:Fbe,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:Vbe};const DN=(e,t)=>{const[n,r]=an(RN()[1][e]||t);qt(()=>{const a=o=>{const s=RN()[1];r(s[e])};return window.addEventListener("hashchange",a),()=>window.removeEventListener("hashchange",a)},[]);const i=st((a,o)=>{const s=RN()[1];let u=!1;if(s.hasOwnProperty(e)&&a===null||a===void 0?(delete s[e],u=!0):s[e]!==a&&(s[e]=a,u=!0),!u)return[];const l=Object.keys(s);l.sort();const c=l.map((g,m)=>`${g}=${s[g]}`).join("&");let f=window.location.hash.substr(1);const d=f.indexOf("?");let h="";d>-1&&(h=f.substr(0,d));const p=new URL(window.location.href);p.hash=`${h}?${c}`,(o==null?void 0:o.modifyHistory)?window.location.hash=`${h}?${c}`:(window.history.replaceState(null,document.title,`${p.pathname}${p.search}${p.hash}`),window.dispatchEvent(new HashChangeEvent("hashchange")))},[]);return[n,i]},RN=()=>{let e=window.location.hash.substr(1);const t=e.indexOf("?");if(t===-1)return[e,{}];const n=e.substr(0,t);e=e.substr(t+1);const r=Object.fromEntries(e.split("&").filter(i=>i.length>0).map(i=>i.split("=")));return[n,r]},Ybe=(e,t)=>{const[n,r]=DN(e,t?`${t}`:void 0),[i,a]=an(n==="true");qt(()=>{a(n==="true")},[e,n,a]);const o=st((s,u)=>{s==null||s===!1?r(void 0,u):r("true",u)},[r]);return[i,o]},Zbe=(e,t)=>{const[n,r]=DN(e,t?t.toString():void 0),[i,a]=an(n?parseInt(n):void 0);qt(()=>{a(n?parseInt(n):void 0)},[e,n,a]);const o=st((s,u)=>{r(s?s.toString():void 0,u)},[r]);return[i,o]},VU=(e,t)=>{const[n,r]=DN(e,t?qU(t):void 0),[i,a]=an(HU(n));qt(()=>{a(HU(n))},[e,n,a]);const o=st((s,u)=>{if(s==null)r(void 0,u);else{const l=qU(s);r(l,u)}},[r]);return[i,o]},qU=e=>btoa(JSON.stringify(e)),HU=e=>{if(e&&e.length>0)try{return JSON.parse(atob(e))}catch(t){console.error(t)}};var Ye=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function mh(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach(function(n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}),t}function ff(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Jbe={},Qbe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Jbe}),e1e=mh(Qbe),t1e=function(e,t){for(var n=[],r=0;r<e.length;r++){var i=t(e[r],r);n1e(i)?n.push.apply(n,i):n.push(i)}return n},n1e=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},r1e=GU;function GU(e,t,n){e instanceof RegExp&&(e=KU(e,n)),t instanceof RegExp&&(t=KU(t,n));var r=XU(e,t,n);return r&&{start:r[0],end:r[1],pre:n.slice(0,r[0]),body:n.slice(r[0]+e.length,r[1]),post:n.slice(r[1]+t.length)}}function KU(e,t){var n=t.match(e);return n?n[0]:null}GU.range=XU;function XU(e,t,n){var r,i,a,o,s,u=n.indexOf(e),l=n.indexOf(t,u+1),c=u;if(u>=0&&l>0){if(e===t)return[u,l];for(r=[],a=n.length;c>=0&&!s;)c==u?(r.push(c),u=n.indexOf(e,c+1)):r.length==1?s=[r.pop(),l]:(i=r.pop(),i<a&&(a=i,o=l),l=n.indexOf(t,c+1)),c=u<l&&u>=0?u:l;r.length&&(s=[a,o])}return s}var i1e=t1e,YU=r1e,a1e=u1e,ZU="\0SLASH"+Math.random()+"\0",JU="\0OPEN"+Math.random()+"\0",FN="\0CLOSE"+Math.random()+"\0",QU="\0COMMA"+Math.random()+"\0",eW="\0PERIOD"+Math.random()+"\0";function MN(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function o1e(e){return e.split("\\\\").join(ZU).split("\\{").join(JU).split("\\}").join(FN).split("\\,").join(QU).split("\\.").join(eW)}function s1e(e){return e.split(ZU).join("\\").split(JU).join("{").split(FN).join("}").split(QU).join(",").split(eW).join(".")}function tW(e){if(!e)return[""];var t=[],n=YU("{","}",e);if(!n)return e.split(",");var r=n.pre,i=n.body,a=n.post,o=r.split(",");o[o.length-1]+="{"+i+"}";var s=tW(a);return a.length&&(o[o.length-1]+=s.shift(),o.push.apply(o,s)),t.push.apply(t,o),t}function u1e(e){return e?(e.substr(0,2)==="{}"&&(e="\\{\\}"+e.substr(2)),Ug(o1e(e),!0).map(s1e)):[]}function l1e(e){return"{"+e+"}"}function c1e(e){return/^-?0\d/.test(e)}function f1e(e,t){return e<=t}function d1e(e,t){return e>=t}function Ug(e,t){var n=[],r=YU("{","}",e);if(!r||/\$$/.test(r.pre))return[e];var i=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(r.body),a=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(r.body),o=i||a,s=r.body.indexOf(",")>=0;if(!o&&!s)return r.post.match(/,.*\}/)?(e=r.pre+"{"+r.body+FN+r.post,Ug(e)):[e];var u;if(o)u=r.body.split(/\.\./);else if(u=tW(r.body),u.length===1&&(u=Ug(u[0],!1).map(l1e),u.length===1)){var c=r.post.length?Ug(r.post,!1):[""];return c.map(function(k){return r.pre+u[0]+k})}var l=r.pre,c=r.post.length?Ug(r.post,!1):[""],f;if(o){var d=MN(u[0]),h=MN(u[1]),p=Math.max(u[0].length,u[1].length),g=u.length==3?Math.abs(MN(u[2])):1,m=f1e,v=h<d;v&&(g*=-1,m=d1e);var y=u.some(c1e);f=[];for(var b=d;m(b,h);b+=g){var x;if(a)x=String.fromCharCode(b),x==="\\"&&(x="");else if(x=String(b),y){var w=p-x.length;if(w>0){var S=new Array(w+1).join("0");b<0?x="-"+S+x.slice(1):x=S+x}}f.push(x)}}else f=i1e(u,function(A){return Ug(A,!1)});for(var C=0;C<f.length;C++)for(var _=0;_<c.length;_++){var E=l+f[C]+c[_];(!t||o||E)&&n.push(E)}return n}var h1e=es;es.Minimatch=pi;var Z0={sep:"/"};try{Z0=e1e}catch(e){}var PN=es.GLOBSTAR=pi.GLOBSTAR={},p1e=a1e,nW={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},$N="[^/]",LN=$N+"*?",g1e="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",m1e="(?:(?!(?:\\/|^)\\.).)*?",rW=v1e("().*{}+?[]^$\\!");function v1e(e){return e.split("").reduce(function(t,n){return t[n]=!0,t},{})}var iW=/\/+/;es.filter=y1e;function y1e(e,t){return t=t||{},function(n,r,i){return es(n,e,t)}}function aW(e,t){e=e||{},t=t||{};var n={};return Object.keys(t).forEach(function(r){n[r]=t[r]}),Object.keys(e).forEach(function(r){n[r]=e[r]}),n}es.defaults=function(e){if(!e||!Object.keys(e).length)return es;var t=es,n=function(i,a,o){return t.minimatch(i,a,aW(e,o))};return n.Minimatch=function(i,a){return new t.Minimatch(i,aW(e,a))},n},pi.defaults=function(e){return!e||!Object.keys(e).length?pi:es.defaults(e).Minimatch};function es(e,t,n){if(typeof t!="string")throw new TypeError("glob pattern string required");return n||(n={}),!n.nocomment&&t.charAt(0)==="#"?!1:t.trim()===""?e==="":new pi(t,n).match(e)}function pi(e,t){if(!(this instanceof pi))return new pi(e,t);if(typeof e!="string")throw new TypeError("glob pattern string required");t||(t={}),e=e.trim(),Z0.sep!=="/"&&(e=e.split(Z0.sep).join("/")),this.options=t,this.set=[],this.pattern=e,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.make()}pi.prototype.debug=function(){},pi.prototype.make=b1e;function b1e(){if(!this._made){var e=this.pattern,t=this.options;if(!t.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate();var n=this.globSet=this.braceExpand();t.debug&&(this.debug=console.error),this.debug(this.pattern,n),n=this.globParts=n.map(function(r){return r.split(iW)}),this.debug(this.pattern,n),n=n.map(function(r,i,a){return r.map(this.parse,this)},this),this.debug(this.pattern,n),n=n.filter(function(r){return r.indexOf(!1)===-1}),this.debug(this.pattern,n),this.set=n}}pi.prototype.parseNegate=x1e;function x1e(){var e=this.pattern,t=!1,n=this.options,r=0;if(!n.nonegate){for(var i=0,a=e.length;i<a&&e.charAt(i)==="!";i++)t=!t,r++;r&&(this.pattern=e.substr(r)),this.negate=t}}es.braceExpand=function(e,t){return oW(e,t)},pi.prototype.braceExpand=oW;function oW(e,t){if(t||(this instanceof pi?t=this.options:t={}),e=typeof e=="undefined"?this.pattern:e,typeof e=="undefined")throw new TypeError("undefined pattern");return t.nobrace||!e.match(/\{.*\}/)?[e]:p1e(e)}pi.prototype.parse=w1e;var E2={};function w1e(e,t){if(e.length>1024*64)throw new TypeError("pattern is too long");var n=this.options;if(!n.noglobstar&&e==="**")return PN;if(e==="")return"";var r="",i=!!n.nocase,a=!1,o=[],s=[],u,l=!1,c=-1,f=-1,d=e.charAt(0)==="."?"":n.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",h=this;function p(){if(u){switch(u){case"*":r+=LN,i=!0;break;case"?":r+=$N,i=!0;break;default:r+="\\"+u;break}h.debug("clearStateChar %j %j",u,r),u=!1}}for(var g=0,m=e.length,v;g<m&&(v=e.charAt(g));g++){if(this.debug("%s	%s %s %j",e,g,r,v),a&&rW[v]){r+="\\"+v,a=!1;continue}switch(v){case"/":return!1;case"\\":p(),a=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",e,g,r,v),l){this.debug("  in class"),v==="!"&&g===f+1&&(v="^"),r+=v;continue}h.debug("call clearStateChar %j",u),p(),u=v,n.noext&&p();continue;case"(":if(l){r+="(";continue}if(!u){r+="\\(";continue}o.push({type:u,start:g-1,reStart:r.length,open:nW[u].open,close:nW[u].close}),r+=u==="!"?"(?:(?!(?:":"(?:",this.debug("plType %j %j",u,r),u=!1;continue;case")":if(l||!o.length){r+="\\)";continue}p(),i=!0;var y=o.pop();r+=y.close,y.type==="!"&&s.push(y),y.reEnd=r.length;continue;case"|":if(l||!o.length||a){r+="\\|",a=!1;continue}p(),r+="|";continue;case"[":if(p(),l){r+="\\"+v;continue}l=!0,f=g,c=r.length,r+=v;continue;case"]":if(g===f+1||!l){r+="\\"+v,a=!1;continue}if(l){var b=e.substring(f+1,g);try{RegExp("["+b+"]")}catch(K){var x=this.parse(b,E2);r=r.substr(0,c)+"\\["+x[0]+"\\]",i=i||x[1],l=!1;continue}}i=!0,l=!1,r+=v;continue;default:p(),a?a=!1:rW[v]&&!(v==="^"&&l)&&(r+="\\"),r+=v}}for(l&&(b=e.substr(f+1),x=this.parse(b,E2),r=r.substr(0,c)+"\\["+x[0],i=i||x[1]),y=o.pop();y;y=o.pop()){var w=r.slice(y.reStart+y.open.length);this.debug("setting tail",r,y),w=w.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(K,ee,ce){return ce||(ce="\\"),ee+ee+ce+"|"}),this.debug(`tail=%j
   %s`,w,w,y,r);var S=y.type==="*"?LN:y.type==="?"?$N:"\\"+y.type;i=!0,r=r.slice(0,y.reStart)+S+"\\("+w}p(),a&&(r+="\\\\");var C=!1;switch(r.charAt(0)){case".":case"[":case"(":C=!0}for(var _=s.length-1;_>-1;_--){var E=s[_],A=r.slice(0,E.reStart),k=r.slice(E.reStart,E.reEnd-8),T=r.slice(E.reEnd-8,E.reEnd),I=r.slice(E.reEnd);T+=I;var N=A.split("(").length-1,O=I;for(g=0;g<N;g++)O=O.replace(/\)[+*?]?/,"");I=O;var D="";I===""&&t!==E2&&(D="$");var L=A+k+I+D+T;r=L}if(r!==""&&i&&(r="(?=.)"+r),C&&(r=d+r),t===E2)return[r,i];if(!i)return E1e(e);var W=n.nocase?"i":"";try{var G=new RegExp("^"+r+"$",W)}catch(K){return new RegExp("$.")}return G._glob=e,G._src=r,G}es.makeRe=function(e,t){return new pi(e,t||{}).makeRe()},pi.prototype.makeRe=_1e;function _1e(){if(this.regexp||this.regexp===!1)return this.regexp;var e=this.set;if(!e.length)return this.regexp=!1,this.regexp;var t=this.options,n=t.noglobstar?LN:t.dot?g1e:m1e,r=t.nocase?"i":"",i=e.map(function(a){return a.map(function(o){return o===PN?n:typeof o=="string"?C1e(o):o._src}).join("\\/")}).join("|");i="^(?:"+i+")$",this.negate&&(i="^(?!"+i+").*$");try{this.regexp=new RegExp(i,r)}catch(a){this.regexp=!1}return this.regexp}es.match=function(e,t,n){n=n||{};var r=new pi(t,n);return e=e.filter(function(i){return r.match(i)}),r.options.nonull&&!e.length&&e.push(t),e},pi.prototype.match=S1e;function S1e(e,t){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&t)return!0;var n=this.options;Z0.sep!=="/"&&(e=e.split(Z0.sep).join("/")),e=e.split(iW),this.debug(this.pattern,"split",e);var r=this.set;this.debug(this.pattern,"set",r);var i,a;for(a=e.length-1;a>=0&&(i=e[a],!i);a--);for(a=0;a<r.length;a++){var o=r[a],s=e;n.matchBase&&o.length===1&&(s=[i]);var u=this.matchOne(s,o,t);if(u)return n.flipNegate?!0:!this.negate}return n.flipNegate?!1:this.negate}pi.prototype.matchOne=function(e,t,n){var r=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var i=0,a=0,o=e.length,s=t.length;i<o&&a<s;i++,a++){this.debug("matchOne loop");var u=t[a],l=e[i];if(this.debug(t,u,l),u===!1)return!1;if(u===PN){this.debug("GLOBSTAR",[t,u,l]);var c=i,f=a+1;if(f===s){for(this.debug("** at the end");i<o;i++)if(e[i]==="."||e[i]===".."||!r.dot&&e[i].charAt(0)===".")return!1;return!0}for(;c<o;){var d=e[c];if(this.debug(`
globstar while`,e,c,t,f,d),this.matchOne(e.slice(c),t.slice(f),n))return this.debug("globstar found match!",c,o,d),!0;if(d==="."||d===".."||!r.dot&&d.charAt(0)==="."){this.debug("dot detected!",e,c,t,f);break}this.debug("globstar swallow a segment, and continue"),c++}return!!(n&&(this.debug(`
>>> no match, partial?`,e,c,t,f),c===o))}var h;if(typeof u=="string"?(r.nocase?h=l.toLowerCase()===u.toLowerCase():h=l===u,this.debug("string match",u,l,h)):(h=l.match(u),this.debug("pattern match",u,l,h)),!h)return!1}if(i===o&&a===s)return!0;if(i===o)return n;if(a===s){var p=i===o-1&&e[i]==="";return p}throw new Error("wtf?")};function E1e(e){return e.replace(/\\(.)/g,"$1")}function C1e(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}var C2;(function(e){e.V0_3="0.3",e.V0_4="0.4"})(C2||(C2={}));var Ds;(function(e){e.V0_2="0.2",e.V0_3="0.3"})(Ds||(Ds={}));const sW=Object.keys(C2);C2.V0_4;const uW=Object.keys(Ds),A2=Ds.V0_3;var jt;(function(e){e.Inputs="inputs",e.Outputs="outputs",e.State="state",e.Definition="definition",e.DefinitionUpdateRequest="definitionupdaterequest",e.Error="error",e.UrlHashUpdate="urlhashupdate",e.Message="Message"})(jt||(jt={}));var ga;(function(e){e.InputsUpdate="InputsUpdate",e.OutputsUpdate="OutputsUpdate",e.SetupIframeClientRequest="SetupIframeClientRequest",e.SetupIframeServerResponseAck="SetupIframeServerResponseAck",e.PluginRequest="SetupIframeServerPluginRequestResponseAck",e.HashParamsUpdate="HashParamsUpdate"})(ga||(ga={}));var Kl;(function(e){e.InputsUpdate="InputsUpdate",e.MessageAck="MessageAck",e.SetupIframeServerResponse="SetupIframeServerResponse"})(Kl||(Kl={}));var BN;(function(e){e.State="metapage/state"})(BN||(BN={}));const Ou="metapage/definition",df="metapage/state",lW=uW[uW.length-1],A1e=sW[sW.length-1];var J0={exports:{}};(function(e,t){(function(n,r){e.exports=r()})(Ye,function(){var n=/^v?(?:\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+))?(?:-[\da-z\-]+(?:\.[\da-z\-]+)*)?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i;function r(f,d){return f.indexOf(d)===-1?f.length:f.indexOf(d)}function i(f){var d=f.replace(/^v/,"").replace(/\+.*$/,""),h=r(d,"-"),p=d.substring(0,h).split(".");return p.push(d.substring(h+1)),p}function a(f){return isNaN(Number(f))?f:Number(f)}function o(f){if(typeof f!="string")throw new TypeError("Invalid argument expected string");if(!n.test(f))throw new Error("Invalid argument not valid semver ('"+f+"' received)")}function s(f,d){[f,d].forEach(o);for(var h=i(f),p=i(d),g=0;g<Math.max(h.length-1,p.length-1);g++){var m=parseInt(h[g]||0,10),v=parseInt(p[g]||0,10);if(m>v)return 1;if(v>m)return-1}var y=h[h.length-1],b=p[p.length-1];if(y&&b){var x=y.split(".").map(a),w=b.split(".").map(a);for(g=0;g<Math.max(x.length,w.length);g++){if(x[g]===void 0||typeof w[g]=="string"&&typeof x[g]=="number")return-1;if(w[g]===void 0||typeof x[g]=="string"&&typeof w[g]=="number"||x[g]>w[g])return 1;if(w[g]>x[g])return-1}}else if(y||b)return y?-1:1;return 0}var u=[">",">=","=","<","<="],l={">":[1],">=":[0,1],"=":[0],"<=":[-1,0],"<":[-1]};function c(f){if(typeof f!="string")throw new TypeError("Invalid operator type, expected string but got "+typeof f);if(u.indexOf(f)===-1)throw new TypeError("Invalid operator, expected one of "+u.join("|"))}return s.validate=function(f){return typeof f=="string"&&n.test(f)},s.compare=function(f,d,h){c(h);var p=s(f,d);return l[h].indexOf(p)>-1},s})})(J0);var k2={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(u,l,c){this.fn=u,this.context=l,this.once=c||!1}function a(u,l,c,f,d){if(typeof c!="function")throw new TypeError("The listener must be a function");var h=new i(c,f||u,d),p=n?n+l:l;return u._events[p]?u._events[p].fn?u._events[p]=[u._events[p],h]:u._events[p].push(h):(u._events[p]=h,u._eventsCount++),u}function o(u,l){--u._eventsCount==0?u._events=new r:delete u._events[l]}function s(){this._events=new r,this._eventsCount=0}s.prototype.eventNames=function(){var l=[],c,f;if(this._eventsCount===0)return l;for(f in c=this._events)t.call(c,f)&&l.push(n?f.slice(1):f);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(c)):l},s.prototype.listeners=function(l){var c=n?n+l:l,f=this._events[c];if(!f)return[];if(f.fn)return[f.fn];for(var d=0,h=f.length,p=new Array(h);d<h;d++)p[d]=f[d].fn;return p},s.prototype.listenerCount=function(l){var c=n?n+l:l,f=this._events[c];return f?f.fn?1:f.length:0},s.prototype.emit=function(l,c,f,d,h,p){var g=n?n+l:l;if(!this._events[g])return!1;var m=this._events[g],v=arguments.length,y,b;if(m.fn){switch(m.once&&this.removeListener(l,m.fn,void 0,!0),v){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,c),!0;case 3:return m.fn.call(m.context,c,f),!0;case 4:return m.fn.call(m.context,c,f,d),!0;case 5:return m.fn.call(m.context,c,f,d,h),!0;case 6:return m.fn.call(m.context,c,f,d,h,p),!0}for(b=1,y=new Array(v-1);b<v;b++)y[b-1]=arguments[b];m.fn.apply(m.context,y)}else{var x=m.length,w;for(b=0;b<x;b++)switch(m[b].once&&this.removeListener(l,m[b].fn,void 0,!0),v){case 1:m[b].fn.call(m[b].context);break;case 2:m[b].fn.call(m[b].context,c);break;case 3:m[b].fn.call(m[b].context,c,f);break;case 4:m[b].fn.call(m[b].context,c,f,d);break;default:if(!y)for(w=1,y=new Array(v-1);w<v;w++)y[w-1]=arguments[w];m[b].fn.apply(m[b].context,y)}}return!0},s.prototype.on=function(l,c,f){return a(this,l,c,f,!1)},s.prototype.once=function(l,c,f){return a(this,l,c,f,!0)},s.prototype.removeListener=function(l,c,f,d){var h=n?n+l:l;if(!this._events[h])return this;if(!c)return o(this,h),this;var p=this._events[h];if(p.fn)p.fn===c&&(!d||p.once)&&(!f||p.context===f)&&o(this,h);else{for(var g=0,m=[],v=p.length;g<v;g++)(p[g].fn!==c||d&&!p[g].once||f&&p[g].context!==f)&&m.push(p[g]);m.length?this._events[h]=m.length===1?m[0]:m:o(this,h)}return this},s.prototype.removeAllListeners=function(l){var c;return l?(c=n?n+l:l,this._events[c]&&o(this,c)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s})(k2);var T2;(function(e){e.mp_debug="mp_debug"})(T2||(T2={}));const k1e=()=>{try{return window!==window.top}catch(e){return!1}};class T1e extends k2.exports.EventEmitter{constructor(){super();this._definition={version:Ds.V0_3,metaframes:{}},this.getDefinition=this.getDefinition.bind(this)}error(t){throw"Subclass should implement"}getDefinition(){return this._definition}}var O1e=function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function s(c){try{l(r.next(c))}catch(f){o(f)}}function u(c){try{l(r.throw(c))}catch(f){o(f)}}function l(c){c.done?a(c.value):i(c.value).then(s,u)}l((r=r.apply(e,t||[])).next())})};const cW=e=>{if(e===null)throw"Metapage definition cannot be null";if(typeof e=="string")try{e=JSON.parse(e)}catch(n){throw`Cannot parse into JSON:
${e}`}let t;switch(N1e(e.version)){case Ds.V0_2:{t=cW(I1e(e));break}case Ds.V0_3:{t=e;break}default:console.warn(`Metapage definition version=${e.version} but we only know up to version ${A2}. Assuming the definition is compatible, but it's the future!`),t=e;break}return t},I1e=e=>(e.version=Ds.V0_3,e),O2=(e,t)=>{if(!t)return!1;let n=!1;return Object.keys(t).forEach(r=>{n=!0,t[r]===void 0?delete e[r]:e[r]=t[r]}),n},N1e=e=>{if(e=="latest")return A2;if(J0.exports.compare(e,"0.2","<"))throw`Unknown version: ${e}`;return J0.exports.compare(e,"0.2",">=")&&J0.exports.compare(e,Ds.V0_3,"<")?Ds.V0_2:J0.exports.compare(e,"0.3",">=")?Ds.V0_3:(console.log(`Could not match version=${e} to any known version, assuming ${A2}`),A2)},zN=()=>{const e=new URLSearchParams(window.location.search).get(T2.mp_debug);return e==="true"||e==="1"},D1e=e=>e.filter(n=>new URLSearchParams(window.location.search).has(n)).length>0,R1e=(e=8)=>F1e(e),fW="abcdefghijklmnopqrstuvwxyz0123456789",F1e=(e=8)=>{for(var t="",n=fW.length,r=0;r<e;r++)t+=fW.charAt(Math.floor(Math.random()*n));return t},jN=(e,t,n)=>{t=t||"000",t&&t.trim()==""&&(t=void 0);let r;if(typeof e=="string"?r=e:typeof e=="number"?r=e+"":r=JSON.stringify(e,null,"  "),t&&t.trim()!=""){var i=`color: #${t}`;n&&(i=`${i}; background: #${n}`),r=`%c${r}`,window.console.log(r,i)}else window.console.log(r)},dW=e=>P1e(M1e(e)),M1e=e=>{var t=0;for(let n=0;n<e.length;n++)t=e.charCodeAt(n)+((t<<5)-t);return t},P1e=e=>{var t=(e&16777215).toString(16).toUpperCase();return"00000".substring(0,6-t.length)+t},UN=()=>document.readyState=="complete"||document.readyState=="interactive",WN=()=>O1e(void 0,void 0,void 0,function*(){return UN()?Promise.resolve():new Promise(e=>{if(UN()){e();return}let t=!1;window.addEventListener("load",()=>{t||(t=!0,e())}),setTimeout(()=>{!t&&UN()&&(t=!0,e())},200)})});var hW=function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function s(c){try{l(r.next(c))}catch(f){o(f)}}function u(c){try{l(r.throw(c))}catch(f){o(f)}}function l(c){c.done?a(c.value):i(c.value).then(s,u)}l((r=r.apply(e,t||[])).next())})};class pW extends k2.exports.EventEmitter{constructor(t,n,r,i,a,o=!1){super();if(this.inputs={},this.outputs={},this._disposables=[],this._rpcListeners=[],this._loaded=!1,this._onLoaded=[],this._sendInputsAfterRegistration=!1,this._plugin=!1,this._cachedEventInputsUpdate={iframeId:void 0,inputs:void 0},this._cachedEventOutputsUpdate={iframeId:null,inputs:null},!n.startsWith("http")){for(;n.startsWith("/");)n=n.substr(1);n=window.location.protocol+"//"+window.location.hostname+(window.location.port&&window.location.port!=""?":"+window.location.port:"")+"/"+n}this.url=n,this._metapage=t;var s=new URL(this.url);o&&s.searchParams.set(T2.mp_debug,"true"),this.url=s.href,this.id=r,this._debug=o,this._parentId=i,this._color=dW(this.id),this._consoleBackgroundColor=a,this._iframe=document.createElement("iframe"),this._iframe.name=this.id;const u=this;this.iframe=new Promise(l=>{WN().then(()=>hW(this,void 0,void 0,function*(){if(u._iframe){const c=yield u.getDefinition();if(!u._iframe)return;(c==null?void 0:c.allow)&&(u._iframe.allow=c.allow),u._iframe.src=this.url,l(u._iframe)}}))}),this.ack=this.ack.bind(this),this.dispose=this.dispose.bind(this),this.getDefinition=this.getDefinition.bind(this),this.getDefinitionUrl=this.getDefinitionUrl.bind(this),this.setPlugin=this.setPlugin.bind(this),this.hasPermissionsDefinition=this.hasPermissionsDefinition.bind(this),this.hasPermissionsState=this.hasPermissionsState.bind(this),this.log=this.log.bind(this),this.logInternal=this.logInternal.bind(this),this.onInput=this.onInput.bind(this),this.onInputs=this.onInputs.bind(this),this.onOutput=this.onOutput.bind(this),this.onOutputs=this.onOutputs.bind(this),this.register=this.register.bind(this),this.registered=this.registered.bind(this),this.sendInputs=this.sendInputs.bind(this),this.sendOrBufferPostMessage=this.sendOrBufferPostMessage.bind(this),this.sendRpc=this.sendRpc.bind(this),this.sendRpcInternal=this.sendRpcInternal.bind(this),this.setInput=this.setInput.bind(this),this.setInputs=this.setInputs.bind(this),this.setMetapage=this.setMetapage.bind(this),this.setOutput=this.setOutput.bind(this),this.setOutputs=this.setOutputs.bind(this),this.setPlugin=this.setPlugin.bind(this),this.addListenerReturnDisposer=this.addListenerReturnDisposer.bind(this),this.isDisposed=this.isDisposed.bind(this)}addListenerReturnDisposer(t,n){return super.addListener(t,n),()=>{super.removeListener(t,n)}}setPlugin(){if(this._loaded)throw"Cannot setPlugin after MetapageIFrameRpcClient already loaded";return this._plugin=!0,this}setMetapage(t){return this._metapage=t,this}hasPermissionsState(){return this._definition!==void 0&&this._definition.inputs!==void 0&&this._definition.inputs[df]!==void 0}hasPermissionsDefinition(){return this._definition!==void 0&&this._definition.inputs!==void 0&&this._definition.inputs[Ou]!==void 0}getDefinitionUrl(){var t=new URL(this.url);return t.pathname=t.pathname+(t.pathname.endsWith("/")?"metaframe.json":"/metaframe.json"),t.href}getDefinition(){return hW(this,void 0,void 0,function*(){if(this._definition)return this._definition;var t=this.getDefinitionUrl();try{const n=yield window.fetch(t);if(n.ok){const r=yield n.json();return this._definition=r,this._definition}else this.emit(jt.Error,`Failed to fetch: ${t}
Status: ${n.status}
Status text: ${n.statusText}`)}catch(n){this.emit(jt.Error,`Failed to fetch: ${t}
Error: ${n}`)}})}setInput(t,n){console.assert(!!t);var r={};r[t]=n,this.setInputs(r)}setInputs(t){if(this.log({m:"MetapageIFrameRpcClient",inputs:t}),!O2(this.inputs,t))return this;if(this._loaded||(this._sendInputsAfterRegistration=!0),this._iframe.parentNode&&this._loaded&&this.sendInputs(t),this.emit(jt.Inputs,this.inputs),this._metapage.listenerCount(jt.Inputs)>0){var n={};n[this.id]=t,this._metapage.emit(jt.Inputs,n)}return this}setOutput(t,n){console.assert(!!t);var r={};r[t]=n,this.setOutputs(r)}setOutputs(t){if(!!O2(this.outputs,t)&&(this.emit(jt.Outputs,t),this._metapage.listenerCount(jt.Outputs)>0)){var n={};n[this.id]=this.outputs,this._metapage.emit(jt.Outputs,n)}}onInputs(t){return this.addListenerReturnDisposer(jt.Inputs,t)}onInput(t,n){var r=function(i){i.hasOwnProperty(t)&&n(i[t])};return this.addListenerReturnDisposer(jt.Inputs,r)}onOutputs(t){return this.addListenerReturnDisposer(jt.Outputs,t)}onOutput(t,n){var r=function(i){i.hasOwnProperty(t)&&n(i[t])};return this.addListenerReturnDisposer(jt.Outputs,r)}isDisposed(){return this.inputs===void 0}dispose(){for(super.removeAllListeners();this._disposables&&this._disposables.length>0;){const t=this._disposables.pop();t&&t()}this._rpcListeners=void 0,this.inputs=void 0,this.outputs=void 0,this._iframe&&this._iframe.parentNode&&this._iframe.parentNode.removeChild(this._iframe),this._iframe=void 0,this._bufferMessages=void 0,this._bufferTimeout&&(window.clearInterval(this._bufferTimeout),this._bufferTimeout=void 0),this._metapage=void 0}register(){var t={iframeId:this.id,parentId:this._parentId,plugin:this._plugin,state:{inputs:this.inputs},version:lW};this.sendRpcInternal(Kl.SetupIframeServerResponse,t)}registered(t){if(this.log({m:"MetapageIFrameRpcClient.registered",inputs:this.inputs}),!this._loaded){if(!t)throw"Cannot register without a version";for(this.version=t,this._loaded=!0;this._onLoaded&&this._onLoaded.length>0;)this._onLoaded.pop()();this._sendInputsAfterRegistration&&this.sendInputs(this.inputs)}}sendInputs(t){this.sendRpc(Kl.InputsUpdate,{inputs:t,parentId:this._parentId})}sendRpc(t,n){if(this._iframe.parentNode&&this._loaded)this.sendRpcInternal(t,n);else{this._metapage.error("sending rpc later");const r=this;this._onLoaded.push(()=>{r.sendRpcInternal(t,n)})}}ack(t){if(this.log("\u2692 \u2692 \u2692 calling ack"),this._debug){this.log("\u2692 \u2692 \u2692 sending ack from client to frame");var n={message:t};this.sendRpc(Kl.MessageAck,n)}else this.log("\u2692 \u2692 \u2692 NOT sending ack from client to frame since not debug mode")}log(t){!this._debug||this.logInternal(t)}logInternal(t){let n;typeof t=="string"?n=t:typeof t=="string"?n=t+"":n=JSON.stringify(t),jN(`Metapage[${this._parentId}] Metaframe[${this.id}] ${n}`,this._color,this._consoleBackgroundColor)}sendRpcInternal(t,n){const r={id:"_",iframeId:this.id,jsonrpc:"2.0",method:t,params:n,parentId:this._parentId};this._iframe?this.sendOrBufferPostMessage(r):this._metapage.error(`Cannot send to child iframe messageJSON=${JSON.stringify(r).substr(0,200)}`)}sendOrBufferPostMessage(t){if(this._iframe&&this._iframe.contentWindow)this._iframe.contentWindow.postMessage(t,this.url);else if(this._bufferMessages)this._bufferMessages.push(t);else{this._bufferMessages=[t];const n=this;this._bufferTimeout=window.setInterval(function(){n._iframe&&n._iframe.contentWindow&&(n._bufferMessages.forEach(r=>n._iframe.contentWindow.postMessage(r,n.url)),window.clearInterval(n._bufferTimeout),n._bufferTimeout=void 0,n._bufferMessages=void 0)},0)}}}var $1e=function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function s(c){try{l(r.next(c))}catch(f){o(f)}}function u(c){try{l(r.throw(c))}catch(f){o(f)}}function l(c){c.done?a(c.value):i(c.value).then(s,u)}l((r=r.apply(e,t||[])).next())})},gW;(function(e){e.all="all",e.delta="delta"})(gW||(gW={}));const mW=()=>({metaframes:{inputs:{},outputs:{}},plugins:{inputs:{},outputs:{}}}),L1e="bcbcbc";class Rs extends T1e{constructor(t){super();this._state=mW(),this._metaframes={},this._plugins={},this._pluginOrder=[],this.debug=zN(),this._internalReceivedMessageCounter=0,this._cachedInputLookupMap={},this._inputMap={},this._id=t&&t.id?t.id:R1e(),this._consoleBackgroundColor=t&&t.color?t.color:L1e,this.addPipe=this.addPipe.bind(this),this.dispose=this.dispose.bind(this),this.addMetaframe=this.addMetaframe.bind(this),this.addPlugin=this.addPlugin.bind(this),this.getInputsFromOutput=this.getInputsFromOutput.bind(this),this.getMetaframe=this.getMetaframe.bind(this),this.getMetaframeIds=this.getMetaframeIds.bind(this),this.getMetaframeOrPlugin=this.getMetaframeOrPlugin.bind(this),this.getMetaframes=this.getMetaframes.bind(this),this.getPlugin=this.getPlugin.bind(this),this.getPluginIds=this.getPluginIds.bind(this),this.getState=this.getState.bind(this),this.getStateMetaframes=this.getStateMetaframes.bind(this),this.isValidJSONRpcMessage=this.isValidJSONRpcMessage.bind(this),this.log=this.log.bind(this),this.logInternal=this.logInternal.bind(this),this.metaframeIds=this.metaframeIds.bind(this),this.metaframes=this.metaframes.bind(this),this.onMessage=this.onMessage.bind(this),this.pluginIds=this.pluginIds.bind(this),this.plugins=this.plugins.bind(this),this.removeAll=this.removeAll.bind(this),this.removeMetaframe=this.removeMetaframe.bind(this),this.removePlugin=this.removePlugin.bind(this),this.setDebugFromUrlParams=this.setDebugFromUrlParams.bind(this),this.setDefinition=this.setDefinition.bind(this),this.setInput=this.setInput.bind(this),this.setInputs=this.setInputs.bind(this),this.setInputStateOnly=this.setInputStateOnly.bind(this),this.setMetaframeClientInputAndSentClientEvent=this.setMetaframeClientInputAndSentClientEvent.bind(this),this.setOutputStateOnly=this.setOutputStateOnly.bind(this),this.setState=this.setState.bind(this),this.updatePluginsWithDefinition=this.updatePluginsWithDefinition.bind(this),this._emitDefinitionEvent=this._emitDefinitionEvent.bind(this),WN().then(()=>{window.addEventListener("message",this.onMessage),this.log("Initialized")})}static from(t,n){if(t==null)throw"Metapage definition cannot be null";if(typeof t=="string")try{t=JSON.parse(t)}catch(i){throw"Cannot parse into JSON:\n${metaPageDef}"}var r=new Rs;return r.setDefinition(t)}addListenerReturnDisposer(t,n){return super.addListener(t,n),()=>{super.removeListener(t,n)}}setDebugFromUrlParams(){return this.debug=D1e(["MP_DEBUG","DEBUG","debug","mp_debug"]),this}getState(){return this._state}setState(t){this._state=t,this.getMetaframeIds().forEach(n=>{this.getMetaframe(n).setInputs(this._state.metaframes.inputs[n]),this.getMetaframe(n).setOutputs(this._state.metaframes.outputs[n])}),this.getPluginIds().forEach(n=>{this.getPlugin(n).setInputs(this._state.plugins.inputs[n]),this.getPlugin(n).setOutputs(this._state.plugins.outputs[n])}),this.emit(jt.State,this._state)}getStateMetaframes(){return this._state.metaframes}getDefinition(){return this._definition}setDefinition(t,n){const r=cW(t);return r.metaframes&&Object.keys(r.metaframes).forEach(i=>{if(r.plugins&&r.plugins.includes(i))throw this.emitErrorMessage(`Plugin with url=${i} matches metaframe. Metaframe ids and plugin urls are not allowed to collide`),`Plugin with url=${i} matches metaframe. Metaframe ids and plugin urls are not allowed to collide`;var a=r.metaframes[i];if(typeof a!="object")throw this.emitErrorMessage(`Metaframe "${i}" is not an object`),`Metaframe "${i}" is not an object`;if(!a.url)throw this.emitErrorMessage(`Metaframe "${i}" missing field: url`),`Metaframe "${i}" missing field: url`}),this._definition=r,Object.keys(this._metaframes).forEach(i=>{(!r.metaframes||!r.metaframes[i])&&this.removeMetaframe(i)}),Object.keys(this._plugins).forEach(i=>{r.plugins&&!r.plugins.includes(i)&&this.removePlugin(i)}),this._pluginOrder=r.plugins?r.plugins:[],n&&(this._state=n),r.metaframes&&Object.keys(r.metaframes).forEach(i=>{if(!this._metaframes.hasOwnProperty(i)){const a=r.metaframes[i];this.addMetaframe(i,a)}}),r.plugins&&r.plugins.forEach(i=>{this._plugins.hasOwnProperty(i)||this.addPlugin(i)}),window.setTimeout(()=>{this._emitDefinitionEvent(),n&&this.emit(jt.State,this._state)},0),this}_emitDefinitionEvent(){const t={definition:this._definition,metaframes:this._metaframes,plugins:this._plugins};this.emit(jt.Definition,t)}addPipe(t,n){this._inputMap[t]||(this._inputMap[t]=[]),this._inputMap[t].push(n)}removeMetaframe(t){!this._metaframes[t]||(this._metaframes[t].dispose(),delete this._metaframes[t],delete this._state.metaframes.inputs[t],delete this._state.metaframes.outputs[t],delete this._inputMap[t],Object.keys(this._inputMap).forEach(n=>{var r;const i=this._inputMap[n];let a=0;for(;a<=i.length;)((r=i[a])===null||r===void 0?void 0:r.metaframe)===t?i.splice(a,1):a++}),this._cachedInputLookupMap={})}removePlugin(t){!this._plugins[t]||(this._plugins[t].dispose(),delete this._plugins[t],delete this._state.plugins.inputs[t],delete this._state.plugins.outputs[t])}removeAll(){Object.keys(this._metaframes).forEach(t=>this._metaframes[t].dispose()),Object.keys(this._plugins).forEach(t=>this._plugins[t].dispose()),this._metaframes={},this._plugins={},this._state=mW(),this._inputMap={},this._cachedInputLookupMap={}}metaframes(){return this.getMetaframes()}metaframeIds(){return this.getMetaframeIds()}getMetaframeIds(){return Object.keys(this._metaframes)}getMetaframes(){return Object.assign({},this._metaframes)}plugins(){return Object.assign({},this._plugins)}pluginIds(){return this.getPluginIds()}getPluginIds(){return this._pluginOrder.slice(0)}getMetaframe(t){return this._metaframes[t]}getPlugin(t){return this._plugins[t]}addMetaframe(t,n){if(!t)throw"addMetaframe missing metaframeId";if(!n)throw"addMetaframe missing definition";if(this._metaframes[t])throw this.emitErrorMessage(`Existing metaframe for id=${t}`),`Existing metaframe for id=${t}`;if(!n.url)throw this.emitErrorMessage(`Metaframe definition missing url id=${t}`),`Metaframe definition missing url id=${t}`;var r=new pW(this,n.url,t,this._id,this._consoleBackgroundColor,this.debug).setMetapage(this);return this._metaframes[t]=r,r.addListener(jt.Error,i=>{this.emit(jt.Error,{metaframeId:r.id,metaframeUrl:r.url,error:i})}),n.inputs&&n.inputs.forEach(i=>this.addPipe(t,i)),r.setInputs(this._state.metaframes.inputs[t]),r}addPlugin(t){if(!t)throw"Plugin missing url";const n=new pW(this,t,t,this._id,this._consoleBackgroundColor,this.debug).setInputs(this._state.plugins.inputs[t]).setMetapage(this).setPlugin();return B1e(this,n),this._plugins[t]=n,n}dispose(){super.removeAllListeners(),window.removeEventListener("message",this.onMessage),this._metaframes&&Object.keys(this._metaframes).forEach(t=>this._metaframes[t].dispose()),this._plugins&&Object.keys(this._plugins).forEach(t=>this._plugins[t].dispose()),this._id=void 0,this._metaframes=void 0,this._plugins=void 0,this._state=void 0,this._cachedInputLookupMap=void 0,this._inputMap=void 0}log(t,n,r){!this.debug||this.logInternal(t,n,r)}error(t){this.logInternal(t,"f00",this._consoleBackgroundColor),this.emitErrorMessage(`${t}`)}emitErrorMessage(t){this.emit(jt.Error,t)}getInputsFromOutput(t,n){if(this._cachedInputLookupMap[t]||(this._cachedInputLookupMap[t]={}),!this._cachedInputLookupMap[t][n]){var r=[];this._cachedInputLookupMap[t][n]=r,Object.keys(this._inputMap).forEach(i=>{i!==t&&this._inputMap[i].forEach(a=>{if(a.metaframe==t&&h1e(n,a.source)){var o=a.target;(!a.target||a.target.startsWith("*")||a.target==="")&&(o=n),r.push({metaframe:i,pipe:o})}})})}return this._cachedInputLookupMap[t][n]}isValidJSONRpcMessage(t){if(t.jsonrpc!=="2.0")return!1;switch(t.method){case ga.SetupIframeClientRequest:return!0;default:var r=t.iframeId;return!(r&&!(t.parentId===this._id&&(this._metaframes[r]||this._plugins[r])))}}setInput(t,n,r){this.setInputStateOnly(t,n,r),this.setMetaframeClientInputAndSentClientEvent(t,n,r),this.emit(jt.State,this._state),this.emit(jt.Inputs,this._state)}setMetaframeClientInputAndSentClientEvent(t,n,r){if(typeof t=="object"){if(n||r)throw"bad arguments, see API docs";const i=t;Object.keys(i).forEach(a=>{var o=a,s=i[o];if(typeof s!="object")throw"bad arguments, see API docs";var u=this._metaframes[o];u?u.setInputs(s):this.error("No iframe id=$metaframeId")})}else if(typeof t=="string"){const i=this._metaframes[t];if(i==null&&this.error(`No iframe id=${t}`),typeof n=="string")i.setInput(n,r);else if(typeof n=="object")i.setInputs(n);else throw"bad arguments, see API docs"}else throw"bad arguments, see API docs"}setInputs(t,n,r){this.setInput(t,n,r)}setOutputStateOnly(t,n,r){this._setStateOnly(!1,t,n,r)}setInputStateOnly(t,n,r){this._setStateOnly(!0,t,n,r)}_setStateOnly(t,n,r,i){if(typeof n=="object"){if(r||i)throw"If first argument is an object, subsequent args should be undefined";const a=n;Object.keys(a).forEach(o=>{var s=a[o];if(typeof s!="object")throw"Object values must be objects";const u=this._metaframes.hasOwnProperty(o);if(!u&&!this._plugins.hasOwnProperty(o))throw"No metaframe or plugin: ${metaframeId}";const l=u?t?this._state.metaframes.inputs:this._state.metaframes.outputs:t?this._state.plugins.inputs:this._state.plugins.outputs;l[o]=l[o]?l[o]:{},Object.keys(s).forEach(c=>{s[c]===void 0?delete l[o][c]:l[o][c]=s[c]})})}else if(typeof n=="string"){const a=n,o=this._metaframes.hasOwnProperty(a);if(!o&&!this._plugins.hasOwnProperty(a))throw`No metaframe or plugin: ${a}`;const s=o?t?this._state.metaframes.inputs:this._state.metaframes.outputs:t?this._state.plugins.inputs:this._state.plugins.outputs;if(typeof r=="string"){s[a]=s[a]?s[a]:{};const u=r;i===void 0?delete s[a][u]:s[a][u]=i}else if(typeof r=="object"){s[a]=s[a]?s[a]:{};const u=r;Object.keys(u).forEach(l=>{u[l]===void 0?delete s[a][l]:s[a][l]=u[l]})}else throw"Second argument must be a string or an object"}else throw"First argument must be a string or an object"}getMetaframeOrPlugin(t){var n=this._metaframes[t];return n||(n=this._plugins[t]),n}onMessage(t){if(typeof t.data=="object"){const o=t.data;if(!this.isValidJSONRpcMessage(o))return;var n=o.method;const s=o.iframeId;if(!s)return;const u=this.getMetaframeOrPlugin(s),l=this._plugins[s];switch(o._messageCount=++this._internalReceivedMessageCounter,this.debug&&this.log(`processing ${JSON.stringify(o,null,"  ").substr(0,500)}`),n){case ga.SetupIframeClientRequest:u&&u.register();break;case ga.SetupIframeServerResponseAck:if(u){const f=o.params;u.registered(f.version)}break;case ga.OutputsUpdate:const c=o.params;if(this._metaframes[s]){var r=this._metaframes[s];this.setOutputStateOnly(s,c),r.setOutputs(c),this.emit(jt.State,this._state);var i=!1;const f=Object.keys(c),d={};f.forEach((h,p)=>{const g=this.getInputsFromOutput(s,h);g.length>0&&g.forEach(m=>{d[m.metaframe]||(d[m.metaframe]={}),d[m.metaframe][m.pipe]=c[h],this.setInputStateOnly(m.metaframe,m.pipe,c[h]),i=!0})}),Object.keys(d).forEach(h=>{this._metaframes[h].setInputs(d[h])}),i&&this.emit(jt.State,this._state),this.debug&&r.ack({jsonrpc:o,state:this._state})}else if(this._plugins[s]){const f=!c[df]&&!c[Ou];f&&this.setOutputStateOnly(s,c),this._plugins[s].setOutputs(c),f&&this.emit(jt.State,this._state),this.debug&&this._plugins[s].ack({jsonrpc:o,state:this._state})}else this.error("missing metaframe/plugin=$metaframeId");break;case ga.InputsUpdate:var a=o.params;if(this.debug&&this.log(`inputs ${JSON.stringify(a)} from ${s}`),this._metaframes[s])this.setInputStateOnly(s,a),this._metaframes[s].setInputs(a),this.emit(jt.State,this._state),this.debug&&this._metaframes[s].ack({jsonrpc:o,state:this._state});else if(this._plugins[s]){const f=!a[df]&&!a[Ou];f&&this.setInputStateOnly(s,a),this._plugins[s].setInputs(a),f&&this.emit(jt.State,this._state),this.debug&&this._plugins[s].ack({jsonrpc:o,state:this._state})}else console.error(`InputsUpdate failed no metaframe or plugin id: "${s}"`),this.error(`InputsUpdate failed no metaframe or plugin id: "${s}"`);break;case ga.PluginRequest:l&&u&&u.hasPermissionsState()&&(u.setInput(df,this._state),this.debug&&u.ack({jsonrpc:o,state:this._state}));break;case ga.HashParamsUpdate:if(!l&&u){const f=o.params,d=new URL(u.url);d.hash=f.hash,u.url=d.href,this._definition.metaframes[f.metaframe].url=d.href,this.emit(jt.UrlHashUpdate,o.params),this._emitDefinitionEvent()}break;default:this.debug&&this.log(`Unknown RPC method: "${n}"`)}this.emit(jt.Message,o)}}updatePluginsWithDefinition(){this.getDefinition(),Object.values(this._plugins).forEach(t=>{t.hasPermissionsDefinition()&&z1e(t)})}logInternal(t,n,r){r=r||this._consoleBackgroundColor;let i;typeof t=="string"?i=t:typeof t=="number"?i=t+"":i=JSON.stringify(t),i=this._id?`Metapage[${this._id}] ${i}`:i,jN(i,n,r)}}Rs.version=lW,Rs.DEFINITION=jt.Definition,Rs.DEFINITION_UPDATE_REQUEST=jt.DefinitionUpdateRequest,Rs.ERROR=jt.Error,Rs.INPUTS=jt.Inputs,Rs.MESSAGE=jt.Message,Rs.OUTPUTS=jt.Outputs,Rs.STATE=jt.State,Rs.URL_HASH_UPDATE=jt.UrlHashUpdate;const B1e=(e,t)=>$1e(void 0,void 0,void 0,function*(){try{const i=yield t.getDefinition();if(!i)throw`${t.url}`;if(t.isDisposed())return;if(t.hasPermissionsDefinition()){var n=e.addListenerReturnDisposer(jt.Definition,a=>{t.setInput(Ou,a.definition)});t._disposables.push(n);var r=e.getDefinition();if(r&&(t.setInput(Ou,r),i.outputs)){var n=t.onOutput(Ou,o=>{e.emit(jt.DefinitionUpdateRequest,o)});t._disposables.push(n)}}if(t.hasPermissionsState()&&i.outputs){var n=t.onOutput(df,o=>{e.setState(o)});t._disposables.push(n)}}catch(i){console.error(i),e.emit(jt.Error,`Failed to get plugin definition from "${t.getDefinitionUrl()}", error=${i}`)}}),z1e=e=>{const t=e._metapage.getDefinition();e.setInput(Ou,t)};var j1e=function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function s(c){try{l(r.next(c))}catch(f){o(f)}}function u(c){try{l(r.throw(c))}catch(f){o(f)}}function l(c){c.done?a(c.value):i(c.value).then(s,u)}l((r=r.apply(e,t||[])).next())})},hf;(function(e){e.WaitingForPageLoad="WaitingForPageLoad",e.SentSetupIframeClientRequest="SentSetupIframeClientRequest",e.Ready="Ready"})(hf||(hf={}));var gi;(function(e){e.Connected="connected",e.Error="error",e.Input="input",e.Inputs="inputs",e.Message="message"})(gi||(gi={}));class Fs extends k2.exports.EventEmitter{constructor(t){super();if(this._inputPipeValues={},this._outputPipeValues={},this._state=hf.WaitingForPageLoad,this._messageSendCount=0,this.debug=zN(),this.id=window.name,this.debug=zN(),this._isIframe=k1e(),this.addListener=this.addListener.bind(this),this.dispose=this.dispose.bind(this),this.error=this.error.bind(this),this.getInput=this.getInput.bind(this),this.getInputs=this.getInputs.bind(this),this.getOutput=this.getOutput.bind(this),this.getOutputs=this.getOutputs.bind(this),this.log=this.log.bind(this),this.logInternal=this.logInternal.bind(this),this.onInput=this.onInput.bind(this),this.onInputs=this.onInputs.bind(this),this.onMessage=this.onMessage.bind(this),this.sendRpc=this.sendRpc.bind(this),this.setInput=this.setInput.bind(this),this.setInputs=this.setInputs.bind(this),this.setInternalInputsAndNotify=this.setInternalInputsAndNotify.bind(this),this.setOutput=this.setOutput.bind(this),this.setOutputs=this.setOutputs.bind(this),this.warn=this.warn.bind(this),this._resolveSetupIframeServerResponse=this._resolveSetupIframeServerResponse.bind(this),this.addListenerReturnDisposer=this.addListenerReturnDisposer.bind(this),this.connected=this.connected.bind(this),this.disableNotifyOnHashUrlChange=this.disableNotifyOnHashUrlChange.bind(this),this._onHashUrlChange=this._onHashUrlChange.bind(this),!this._isIframe){this.log("Not an iframe, metaframe code disabled");return}const n=this;WN().then(()=>{this.log("pageLoaded"),window.addEventListener("message",this.onMessage),n.sendRpc(ga.SetupIframeClientRequest,{version:Fs.version}),n._state=hf.SentSetupIframeClientRequest}),(t==null?void 0:t.disableHashChangeEvent)||window.addEventListener("hashchange",this._onHashUrlChange)}_resolveSetupIframeServerResponse(t){if(this._state===hf.WaitingForPageLoad)throw"Got message but page has not finished loading, we should never get in this state";this._parentId?this.log("Got JsonRpcMethods.SetupIframeServerResponse but already resolved"):(this._parentVersion=t.version,this.color=dW(this.id),this._parentId=t.parentId,this.log(`metapage[${this._parentId}](v${this._parentVersion?this._parentVersion:"unknown"}) registered`),this._inputPipeValues=t.state&&t.state.inputs?t.state.inputs:this._inputPipeValues,this._state=hf.Ready,this.sendRpc(ga.SetupIframeServerResponseAck,{version:Fs.version}),this._inputPipeValues&&Object.keys(this._inputPipeValues).length>0&&(this.emit(gi.Inputs,this._inputPipeValues),Object.keys(this._inputPipeValues).forEach(n=>this.emit(gi.Input,n,this._inputPipeValues[n]))),this.emit(gi.Inputs,this._inputPipeValues),t.plugin&&(this.plugin=new U1e(this)),this.emit(gi.Connected))}connected(){return j1e(this,void 0,void 0,function*(){if(this._state!==hf.Ready)return new Promise((t,n)=>{let r;r=this.addListenerReturnDisposer(gi.Connected,()=>{t(),r()})})})}addListenerReturnDisposer(t,n){return super.addListener(t,n),()=>{super.removeListener(t,n)}}log(t,n,r){!this.debug||this.logInternal(t,n||this.color)}warn(t){!this.debug||this.logInternal(t,"000",this.color)}error(t){this.logInternal(t,this.color,"f00")}logInternal(t,n,r){let i;typeof t=="string"?i=t:typeof t=="number"?i=t+"":i=JSON.stringify(t),n=n&&n+"",i=(this.id?`Metaframe[${this.id}] `:"")+`${i}`,jN(i,n,r)}dispose(){super.removeAllListeners(),window.removeEventListener("message",this.onMessage),this.disableNotifyOnHashUrlChange(),this._inputPipeValues=void 0,this._outputPipeValues=void 0}addListener(t,n){return super.addListener(t,n),t===gi.Inputs&&window.setTimeout(()=>{this._inputPipeValues&&n(this._inputPipeValues)},0),this}onInput(t,n){return this.addListenerReturnDisposer(gi.Input,(r,i)=>{t===r&&n(i)})}onInputs(t){return this.addListenerReturnDisposer(gi.Inputs,t)}setInput(t,n){var r={};r[t]=n,this.setInputs(r)}setInputs(t){this.sendRpc(ga.InputsUpdate,t)}setInternalInputsAndNotify(t){!O2(this._inputPipeValues,t)||(Object.keys(t).forEach(n=>this.emit(gi.Input,n,t[n])),this.emit(gi.Inputs,t))}getInput(t){return console.assert(t),this._inputPipeValues[t]}getInputs(){return this._inputPipeValues}getOutput(t){return console.assert(t),this._outputPipeValues[t]}setOutput(t,n){console.assert(t),console.assert(n);var r={};r[t]=n,this.setOutputs(r)}setOutputs(t){!O2(this._outputPipeValues,t)||this.sendRpc(ga.OutputsUpdate,t)}getOutputs(){return this._outputPipeValues}disableNotifyOnHashUrlChange(){window.removeEventListener("hashchange",this._onHashUrlChange)}_onHashUrlChange(t){const n={hash:window.location.hash,metaframe:this.id};this.sendRpc(ga.HashParamsUpdate,n)}sendRpc(t,n){if(this._isIframe){const r={jsonrpc:"2.0",id:++this._messageSendCount,method:t,params:n,iframeId:this.id,parentId:this._parentId};window.parent.postMessage(r,"*")}else this.log("Cannot send JSON-RPC window message: there is no window.parent which means we are not an iframe")}onMessage(t){if(typeof t.data=="object"){let r=t.data;if(r.jsonrpc==="2.0"){var n=r.method;if(!(n==Kl.SetupIframeServerResponse||r.parentId==this._parentId&&r.iframeId==this.id)){this.error(`window.message: received message but jsonrpc.parentId=${r.parentId} _parentId=${this._parentId} jsonrpc.iframeId=${r.iframeId} id=${this.id}`);return}switch(n){case Kl.SetupIframeServerResponse:this._resolveSetupIframeServerResponse(r.params);break;case Kl.InputsUpdate:if(this._state!==hf.Ready)throw"Got InputsUpdate but metaframe is not MetaframeLoadingState.Ready";this.setInternalInputsAndNotify(r.params.inputs);break;case Kl.MessageAck:this.debug&&this.log(`ACK: ${JSON.stringify(r)}`);break;default:this.debug&&this.log(`window.message: unknown JSON-RPC method: ${JSON.stringify(r)}`);break}this.emit(gi.Message,r)}}}}Fs.version=A1e,Fs.ERROR=gi.Error,Fs.CONNECTED=gi.Connected,Fs.INPUT=gi.Input,Fs.INPUTS=gi.Inputs,Fs.MESSAGE=gi.Message;class U1e{constructor(t){this._metaframe=t,this.requestState=this.requestState.bind(this),this.onState=this.onState.bind(this),this.getState=this.getState.bind(this),this.setState=this.setState.bind(this),this.onDefinition=this.onDefinition.bind(this),this.getDefinition=this.getDefinition.bind(this),this.setDefinition=this.setDefinition.bind(this)}requestState(){var t={method:BN.State};this._metaframe.sendRpc(ga.PluginRequest,t)}onState(t){const n=this._metaframe.onInput(df,t);return this.getState()&&t(this.getState()),n}getState(){return this._metaframe.getInput(df)}setState(t){this._metaframe.setOutput(df,t)}onDefinition(t){var n=this._metaframe.onInput(Ou,t);return this.getDefinition()&&t(this.getDefinition()),n}setDefinition(t){this._metaframe.setOutput(Ou,t)}getDefinition(){return this._metaframe.getInput(Ou)}}const W1e={inputs:{}},vW=ha(W1e),V1e=()=>Un(vW),q1e=e=>{const[t,n]=an({inputs:{}}),[r,i]=an(void 0),[a,o]=an(t.inputs);return qt(()=>{const s=new Fs,u=l=>{o(l)};return s.onInputs(u),i(s),()=>{s.removeListener(Fs.INPUTS,u),s.dispose()}},[i,o]),qt(()=>{a&&r&&n({metaframe:r,inputs:a,setOutputs:r.setOutputs})},[a,r]),zt.createElement(vW.Provider,{value:t},e.children)},H1e=()=>{try{return window!==window.top}catch(e){return!1}};function G1e(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function K1e(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),e.nonce!==void 0&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var yW=function(){function e(n){var r=this;this._insertTag=function(i){var a;r.tags.length===0?a=r.prepend?r.container.firstChild:r.before:a=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(i,a),r.tags.push(i)},this.isSpeedy=n.speedy===void 0?!0:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.before=null}var t=e.prototype;return t.hydrate=function(r){r.forEach(this._insertTag)},t.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)==0&&this._insertTag(K1e(this));var i=this.tags[this.tags.length-1];if(this.isSpeedy){var a=G1e(i);try{a.insertRule(r,a.cssRules.length)}catch(o){}}else i.appendChild(document.createTextNode(r));this.ctr++},t.flush=function(){this.tags.forEach(function(r){return r.parentNode.removeChild(r)}),this.tags=[],this.ctr=0},e}(),qi="-ms-",I2="-moz-",An="-webkit-",bW="comm",VN="rule",qN="decl",X1e="@import",Y1e="@keyframes",Z1e=Math.abs,N2=String.fromCharCode;function J1e(e,t){return(((t<<2^Xa(e,0))<<2^Xa(e,1))<<2^Xa(e,2))<<2^Xa(e,3)}function xW(e){return e.trim()}function Q1e(e,t){return(e=t.exec(e))?e[0]:e}function Mn(e,t,n){return e.replace(t,n)}function wW(e,t){return e.indexOf(t)}function Xa(e,t){return e.charCodeAt(t)|0}function Q0(e,t,n){return e.slice(t,n)}function Iu(e){return e.length}function HN(e){return e.length}function D2(e,t){return t.push(e),e}function exe(e,t){return e.map(t).join("")}var R2=1,Wg=1,_W=0,Eo=0,jr=0,Vg="";function F2(e,t,n,r,i,a,o){return{value:e,root:t,parent:n,type:r,props:i,children:a,line:R2,column:Wg,length:o,return:""}}function ey(e,t,n){return F2(e,t.root,t.parent,n,t.props,t.children,0)}function txe(){return jr}function nxe(){return jr=Eo>0?Xa(Vg,--Eo):0,Wg--,jr===10&&(Wg=1,R2--),jr}function ts(){return jr=Eo<_W?Xa(Vg,Eo++):0,Wg++,jr===10&&(Wg=1,R2++),jr}function Xl(){return Xa(Vg,Eo)}function M2(){return Eo}function P2(e,t){return Q0(Vg,e,t)}function $2(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function SW(e){return R2=Wg=1,_W=Iu(Vg=e),Eo=0,[]}function EW(e){return Vg="",e}function GN(e){return xW(P2(Eo-1,KN(e===91?e+2:e===40?e+1:e)))}function rxe(e){for(;(jr=Xl())&&jr<33;)ts();return $2(e)>2||$2(jr)>3?"":" "}function ixe(e,t){for(;--t&&ts()&&!(jr<48||jr>102||jr>57&&jr<65||jr>70&&jr<97););return P2(e,M2()+(t<6&&Xl()==32&&ts()==32))}function KN(e){for(;ts();)switch(jr){case e:return Eo;case 34:case 39:return KN(e===34||e===39?e:jr);case 40:e===41&&KN(e);break;case 92:ts();break}return Eo}function axe(e,t){for(;ts()&&e+jr!==47+10;)if(e+jr===42+42&&Xl()===47)break;return"/*"+P2(t,Eo-1)+"*"+N2(e===47?e:ts())}function CW(e){for(;!$2(Xl());)ts();return P2(e,Eo)}function oxe(e){return EW(L2("",null,null,null,[""],e=SW(e),0,[0],e))}function L2(e,t,n,r,i,a,o,s,u){for(var l=0,c=0,f=o,d=0,h=0,p=0,g=1,m=1,v=1,y=0,b="",x=i,w=a,S=r,C=b;m;)switch(p=y,y=ts()){case 34:case 39:case 91:case 40:C+=GN(y);break;case 9:case 10:case 13:case 32:C+=rxe(p);break;case 92:C+=ixe(M2()-1,7);continue;case 47:switch(Xl()){case 42:case 47:D2(sxe(axe(ts(),M2()),t,n),u);break;default:C+="/"}break;case 123*g:s[l++]=Iu(C)*v;case 125*g:case 59:case 0:switch(y){case 0:case 125:m=0;case 59+c:h>0&&Iu(C)-f&&D2(h>32?kW(C+";",r,n,f-1):kW(Mn(C," ","")+";",r,n,f-2),u);break;case 59:C+=";";default:if(D2(S=AW(C,t,n,l,c,i,s,b,x=[],w=[],f),a),y===123)if(c===0)L2(C,t,S,S,x,a,f,s,w);else switch(d){case 100:case 109:case 115:L2(e,S,S,r&&D2(AW(e,S,S,0,0,i,s,b,i,x=[],f),w),i,w,f,s,r?x:w);break;default:L2(C,S,S,S,[""],w,f,s,w)}}l=c=h=0,g=v=1,b=C="",f=o;break;case 58:f=1+Iu(C),h=p;default:if(g<1){if(y==123)--g;else if(y==125&&g++==0&&nxe()==125)continue}switch(C+=N2(y),y*g){case 38:v=c>0?1:(C+="\f",-1);break;case 44:s[l++]=(Iu(C)-1)*v,v=1;break;case 64:Xl()===45&&(C+=GN(ts())),d=Xl(),c=Iu(b=C+=CW(M2())),y++;break;case 45:p===45&&Iu(C)==2&&(g=0)}}return a}function AW(e,t,n,r,i,a,o,s,u,l,c){for(var f=i-1,d=i===0?a:[""],h=HN(d),p=0,g=0,m=0;p<r;++p)for(var v=0,y=Q0(e,f+1,f=Z1e(g=o[p])),b=e;v<h;++v)(b=xW(g>0?d[v]+" "+y:Mn(y,/&\f/g,d[v])))&&(u[m++]=b);return F2(e,t,n,i===0?VN:s,u,l,c)}function sxe(e,t,n){return F2(e,t,n,bW,N2(txe()),Q0(e,2,-2),0)}function kW(e,t,n,r){return F2(e,t,n,qN,Q0(e,0,r),Q0(e,r+1,-1),r)}function TW(e,t){switch(J1e(e,t)){case 5103:return An+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return An+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return An+e+I2+e+qi+e+e;case 6828:case 4268:return An+e+qi+e+e;case 6165:return An+e+qi+"flex-"+e+e;case 5187:return An+e+Mn(e,/(\w+).+(:[^]+)/,An+"box-$1$2"+qi+"flex-$1$2")+e;case 5443:return An+e+qi+"flex-item-"+Mn(e,/flex-|-self/,"")+e;case 4675:return An+e+qi+"flex-line-pack"+Mn(e,/align-content|flex-|-self/,"")+e;case 5548:return An+e+qi+Mn(e,"shrink","negative")+e;case 5292:return An+e+qi+Mn(e,"basis","preferred-size")+e;case 6060:return An+"box-"+Mn(e,"-grow","")+An+e+qi+Mn(e,"grow","positive")+e;case 4554:return An+Mn(e,/([^-])(transform)/g,"$1"+An+"$2")+e;case 6187:return Mn(Mn(Mn(e,/(zoom-|grab)/,An+"$1"),/(image-set)/,An+"$1"),e,"")+e;case 5495:case 3959:return Mn(e,/(image-set\([^]*)/,An+"$1$`$1");case 4968:return Mn(Mn(e,/(.+:)(flex-)?(.*)/,An+"box-pack:$3"+qi+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+An+e+e;case 4095:case 3583:case 4068:case 2532:return Mn(e,/(.+)-inline(.+)/,An+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Iu(e)-1-t>6)switch(Xa(e,t+1)){case 109:if(Xa(e,t+4)!==45)break;case 102:return Mn(e,/(.+:)(.+)-([^]+)/,"$1"+An+"$2-$3$1"+I2+(Xa(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~wW(e,"stretch")?TW(Mn(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(Xa(e,t+1)!==115)break;case 6444:switch(Xa(e,Iu(e)-3-(~wW(e,"!important")&&10))){case 107:return Mn(e,":",":"+An)+e;case 101:return Mn(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+An+(Xa(e,14)===45?"inline-":"")+"box$3$1"+An+"$2$3$1"+qi+"$2box$3")+e}break;case 5936:switch(Xa(e,t+11)){case 114:return An+e+qi+Mn(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return An+e+qi+Mn(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return An+e+qi+Mn(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return An+e+qi+e+e}return e}function ty(e,t){for(var n="",r=HN(e),i=0;i<r;i++)n+=t(e[i],i,e,t)||"";return n}function uxe(e,t,n,r){switch(e.type){case X1e:case qN:return e.return=e.return||e.value;case bW:return"";case VN:e.value=e.props.join(",")}return Iu(n=ty(e.children,r))?e.return=e.value+"{"+n+"}":""}function lxe(e){var t=HN(e);return function(n,r,i,a){for(var o="",s=0;s<t;s++)o+=e[s](n,r,i,a)||"";return o}}function cxe(e){return function(t){t.root||(t=t.return)&&e(t)}}function fxe(e,t,n,r){if(!e.return)switch(e.type){case qN:e.return=TW(e.value,e.length);break;case Y1e:return ty([ey(Mn(e.value,"@","@"+An),e,"")],r);case VN:if(e.length)return exe(e.props,function(i){switch(Q1e(i,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return ty([ey(Mn(i,/:(read-\w+)/,":"+I2+"$1"),e,"")],r);case"::placeholder":return ty([ey(Mn(i,/:(plac\w+)/,":"+An+"input-$1"),e,""),ey(Mn(i,/:(plac\w+)/,":"+I2+"$1"),e,""),ey(Mn(i,/:(plac\w+)/,qi+"input-$1"),e,"")],r)}return""})}}var OW=function(t){var n=new WeakMap;return function(r){if(n.has(r))return n.get(r);var i=t(r);return n.set(r,i),i}};function IW(e){var t=Object.create(null);return function(n){return t[n]===void 0&&(t[n]=e(n)),t[n]}}var dxe=function(t,n){var r=-1,i=44;do switch($2(i)){case 0:i===38&&Xl()===12&&(n[r]=1),t[r]+=CW(Eo-1);break;case 2:t[r]+=GN(i);break;case 4:if(i===44){t[++r]=Xl()===58?"&\f":"",n[r]=t[r].length;break}default:t[r]+=N2(i)}while(i=ts());return t},hxe=function(t,n){return EW(dxe(SW(t),n))},NW=new WeakMap,pxe=function(t){if(!(t.type!=="rule"||!t.parent||!t.length)){for(var n=t.value,r=t.parent,i=t.column===r.column&&t.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(t.props.length===1&&n.charCodeAt(0)!==58&&!NW.get(r))&&!i){NW.set(t,!0);for(var a=[],o=hxe(n,a),s=r.props,u=0,l=0;u<o.length;u++)for(var c=0;c<s.length;c++,l++)t.props[l]=a[u]?o[u].replace(/&\f/g,s[c]):s[c]+" "+o[u]}}},gxe=function(t){if(t.type==="decl"){var n=t.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(t.return="",t.value="")}},mxe=[fxe],vxe=function(t){var n=t.key;if(n==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(g){var m=g.getAttribute("data-emotion");m.indexOf(" ")!==-1&&(document.head.appendChild(g),g.setAttribute("data-s",""))})}var i=t.stylisPlugins||mxe,a={},o,s=[];o=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(g){for(var m=g.getAttribute("data-emotion").split(" "),v=1;v<m.length;v++)a[m[v]]=!0;s.push(g)});var u,l=[pxe,gxe];{var c,f=[uxe,cxe(function(g){c.insert(g)})],d=lxe(l.concat(i,f)),h=function(m){return ty(oxe(m),d)};u=function(m,v,y,b){c=y,h(m?m+"{"+v.styles+"}":v.styles),b&&(p.inserted[v.name]=!0)}}var p={key:n,sheet:new yW({key:n,container:o,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend}),nonce:t.nonce,inserted:a,registered:{},insert:u};return p.sheet.hydrate(s),p};function vh(){return vh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vh.apply(this,arguments)}var DW={exports:{}},Pn={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mi=typeof Symbol=="function"&&Symbol.for,XN=mi?Symbol.for("react.element"):60103,YN=mi?Symbol.for("react.portal"):60106,B2=mi?Symbol.for("react.fragment"):60107,z2=mi?Symbol.for("react.strict_mode"):60108,j2=mi?Symbol.for("react.profiler"):60114,U2=mi?Symbol.for("react.provider"):60109,W2=mi?Symbol.for("react.context"):60110,ZN=mi?Symbol.for("react.async_mode"):60111,V2=mi?Symbol.for("react.concurrent_mode"):60111,q2=mi?Symbol.for("react.forward_ref"):60112,H2=mi?Symbol.for("react.suspense"):60113,yxe=mi?Symbol.for("react.suspense_list"):60120,G2=mi?Symbol.for("react.memo"):60115,K2=mi?Symbol.for("react.lazy"):60116,bxe=mi?Symbol.for("react.block"):60121,xxe=mi?Symbol.for("react.fundamental"):60117,wxe=mi?Symbol.for("react.responder"):60118,_xe=mi?Symbol.for("react.scope"):60119;function Co(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case XN:switch(e=e.type,e){case ZN:case V2:case B2:case j2:case z2:case H2:return e;default:switch(e=e&&e.$$typeof,e){case W2:case q2:case K2:case G2:case U2:return e;default:return t}}case YN:return t}}}function RW(e){return Co(e)===V2}Pn.AsyncMode=ZN,Pn.ConcurrentMode=V2,Pn.ContextConsumer=W2,Pn.ContextProvider=U2,Pn.Element=XN,Pn.ForwardRef=q2,Pn.Fragment=B2,Pn.Lazy=K2,Pn.Memo=G2,Pn.Portal=YN,Pn.Profiler=j2,Pn.StrictMode=z2,Pn.Suspense=H2,Pn.isAsyncMode=function(e){return RW(e)||Co(e)===ZN},Pn.isConcurrentMode=RW,Pn.isContextConsumer=function(e){return Co(e)===W2},Pn.isContextProvider=function(e){return Co(e)===U2},Pn.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===XN},Pn.isForwardRef=function(e){return Co(e)===q2},Pn.isFragment=function(e){return Co(e)===B2},Pn.isLazy=function(e){return Co(e)===K2},Pn.isMemo=function(e){return Co(e)===G2},Pn.isPortal=function(e){return Co(e)===YN},Pn.isProfiler=function(e){return Co(e)===j2},Pn.isStrictMode=function(e){return Co(e)===z2},Pn.isSuspense=function(e){return Co(e)===H2},Pn.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===B2||e===V2||e===j2||e===z2||e===H2||e===yxe||typeof e=="object"&&e!==null&&(e.$$typeof===K2||e.$$typeof===G2||e.$$typeof===U2||e.$$typeof===W2||e.$$typeof===q2||e.$$typeof===xxe||e.$$typeof===wxe||e.$$typeof===_xe||e.$$typeof===bxe)},Pn.typeOf=Co,DW.exports=Pn;var FW=DW.exports,Sxe={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Exe={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},MW={};MW[FW.ForwardRef]=Sxe,MW[FW.Memo]=Exe;var Cxe=!0;function Axe(e,t,n){var r="";return n.split(" ").forEach(function(i){e[i]!==void 0?t.push(e[i]+";"):r+=i+" "}),r}var PW=function(t,n,r){var i=t.key+"-"+n.name;if((r===!1||Cxe===!1)&&t.registered[i]===void 0&&(t.registered[i]=n.styles),t.inserted[n.name]===void 0){var a=n;do t.insert(n===a?"."+i:"",a,t.sheet,!0),a=a.next;while(a!==void 0)}};function kxe(e){for(var t=0,n,r=0,i=e.length;i>=4;++r,i-=4)n=e.charCodeAt(r)&255|(e.charCodeAt(++r)&255)<<8|(e.charCodeAt(++r)&255)<<16|(e.charCodeAt(++r)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,t=(n&65535)*1540483477+((n>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(i){case 3:t^=(e.charCodeAt(r+2)&255)<<16;case 2:t^=(e.charCodeAt(r+1)&255)<<8;case 1:t^=e.charCodeAt(r)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var Txe={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Oxe=/[A-Z]|^ms/g,Ixe=/_EMO_([^_]+?)_([^]*?)_EMO_/g,$W=function(t){return t.charCodeAt(1)===45},LW=function(t){return t!=null&&typeof t!="boolean"},JN=IW(function(e){return $W(e)?e:e.replace(Oxe,"-$&").toLowerCase()}),BW=function(t,n){switch(t){case"animation":case"animationName":if(typeof n=="string")return n.replace(Ixe,function(r,i,a){return Nu={name:i,styles:a,next:Nu},i})}return Txe[t]!==1&&!$W(t)&&typeof n=="number"&&n!==0?n+"px":n};function ny(e,t,n){if(n==null)return"";if(n.__emotion_styles!==void 0)return n;switch(typeof n){case"boolean":return"";case"object":{if(n.anim===1)return Nu={name:n.name,styles:n.styles,next:Nu},n.name;if(n.styles!==void 0){var r=n.next;if(r!==void 0)for(;r!==void 0;)Nu={name:r.name,styles:r.styles,next:Nu},r=r.next;var i=n.styles+";";return i}return Nxe(e,t,n)}case"function":{if(e!==void 0){var a=Nu,o=n(e);return Nu=a,ny(e,t,o)}break}}if(t==null)return n;var s=t[n];return s!==void 0?s:n}function Nxe(e,t,n){var r="";if(Array.isArray(n))for(var i=0;i<n.length;i++)r+=ny(e,t,n[i])+";";else for(var a in n){var o=n[a];if(typeof o!="object")t!=null&&t[o]!==void 0?r+=a+"{"+t[o]+"}":LW(o)&&(r+=JN(a)+":"+BW(a,o)+";");else if(Array.isArray(o)&&typeof o[0]=="string"&&(t==null||t[o[0]]===void 0))for(var s=0;s<o.length;s++)LW(o[s])&&(r+=JN(a)+":"+BW(a,o[s])+";");else{var u=ny(e,t,o);switch(a){case"animation":case"animationName":{r+=JN(a)+":"+u+";";break}default:r+=a+"{"+u+"}"}}}return r}var zW=/label:\s*([^\s;\n{]+)\s*(;|$)/g,Nu,QN=function(t,n,r){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var i=!0,a="";Nu=void 0;var o=t[0];o==null||o.raw===void 0?(i=!1,a+=ny(r,n,o)):a+=o[0];for(var s=1;s<t.length;s++)a+=ny(r,n,t[s]),i&&(a+=o[s]);zW.lastIndex=0;for(var u="",l;(l=zW.exec(a))!==null;)u+="-"+l[1];var c=kxe(a)+u;return{name:c,styles:a,next:Nu}},jW=ha(typeof HTMLElement!="undefined"?vxe({key:"css"}):null);jW.Provider;var UW=function(t){return Gl(function(n,r){var i=Un(jW);return t(n,i,r)})},ry=ha({}),Dxe=function(t,n){if(typeof n=="function"){var r=n(t);return r}return vh({},t,n)},Rxe=OW(function(e){return OW(function(t){return Dxe(e,t)})}),Fxe=function(t){var n=Un(ry);return t.theme!==n&&(n=Rxe(n)(t.theme)),ue(ry.Provider,{value:n},t.children)},eD=UW(function(e,t){var n=e.styles,r=QN([n],void 0,typeof n=="function"||Array.isArray(n)?Un(ry):void 0),i=Jt();return lf(function(){var a=t.key+"-global",o=new yW({key:a,nonce:t.sheet.nonce,container:t.sheet.container,speedy:t.sheet.isSpeedy}),s=!1,u=document.querySelector('style[data-emotion="'+a+" "+r.name+'"]');return t.sheet.tags.length&&(o.before=t.sheet.tags[0]),u!==null&&(s=!0,u.setAttribute("data-emotion",a),o.hydrate([u])),i.current=[o,s],function(){o.flush()}},[t]),lf(function(){var a=i.current,o=a[0],s=a[1];if(s){a[1]=!1;return}if(r.next!==void 0&&PW(t,r.next,!0),o.tags.length){var u=o.tags[o.tags.length-1].nextElementSibling;o.before=u,o.flush()}t.insert("",r,o,!1)},[t,r.name]),null});function Mxe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return QN(t)}var WW=function(){var t=Mxe.apply(void 0,arguments),n="animation-"+t.name;return{name:n,styles:"@keyframes "+n+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},Pxe=()=>ue(eD,{styles:`
      html {
        line-height: 1.5;
        -webkit-text-size-adjust: 100%;
        font-family: system-ui, sans-serif;
        -webkit-font-smoothing: antialiased;
        text-rendering: optimizeLegibility;      
        -moz-osx-font-smoothing: grayscale; 
        touch-action: manipulation; 
      }

      body {
        position: relative;
        min-height: 100%;
        font-feature-settings: 'kern';
      }

      *,
      *::before,
      *::after {
        border-width: 0;
        border-style: solid;
        box-sizing: border-box;
      }

      main {
        display: block;
      }

      hr {
        border-top-width: 1px;
        box-sizing: content-box;
        height: 0;
        overflow: visible;
      }

      pre,
      code,
      kbd,
      samp {
        font-family: SFMono-Regular,  Menlo, Monaco, Consolas, monospace;
        font-size: 1em;
      }

      a {
        background-color: transparent;
        color: inherit;
        text-decoration: inherit;
      }

      abbr[title] {
        border-bottom: none;
        text-decoration: underline;
        -webkit-text-decoration: underline dotted;
        text-decoration: underline dotted;
      }

      b,
      strong {
        font-weight: bold;
      }

      small {
        font-size: 80%;
      }

      sub,
      sup {
        font-size: 75%;
        line-height: 0;
        position: relative;
        vertical-align: baseline;
      }

      sub {
        bottom: -0.25em;
      }

      sup {
        top: -0.5em;
      }

      img {
        border-style: none;
      }

      button,
      input,
      optgroup,
      select,
      textarea {
        font-family: inherit;
        font-size: 100%;
        line-height: 1.15;
        margin: 0;
      }

      button,
      input {
        overflow: visible;
      }

      button,
      select {
        text-transform: none;
      }

      button::-moz-focus-inner,
      [type="button"]::-moz-focus-inner,
      [type="reset"]::-moz-focus-inner,
      [type="submit"]::-moz-focus-inner {
        border-style: none;
        padding: 0;
      }

      fieldset {
        padding: 0.35em 0.75em 0.625em;
      }

      legend {
        box-sizing: border-box;
        color: inherit;
        display: table;
        max-width: 100%;
        padding: 0;
        white-space: normal;
      }

      progress {
        vertical-align: baseline;
      }

      textarea {
        overflow: auto;
      }

      [type="checkbox"],
      [type="radio"] {
        box-sizing: border-box;
        padding: 0;
      }

      [type="number"]::-webkit-inner-spin-button,
      [type="number"]::-webkit-outer-spin-button {
        -webkit-appearance: none !important;
      }

      input[type="number"] {
        -moz-appearance: textfield;
      }

      [type="search"] {
        -webkit-appearance: textfield;
        outline-offset: -2px;
      }

      [type="search"]::-webkit-search-decoration {
        -webkit-appearance: none !important;
      }

      ::-webkit-file-upload-button {
        -webkit-appearance: button;
        font: inherit;
      }

      details {
        display: block;
      }

      summary {
        display: list-item;
      }

      template {
        display: none;
      }

      [hidden] {
        display: none !important;
      }

      body,
      blockquote,
      dl,
      dd,
      h1,
      h2,
      h3,
      h4,
      h5,
      h6,
      hr,
      figure,
      p,
      pre {
        margin: 0;
      }

      button {
        background: transparent;
        padding: 0;
      }

      fieldset {
        margin: 0;
        padding: 0;
      }

      ol,
      ul {
        margin: 0;
        padding: 0;
      }

      textarea {
        resize: vertical;
      }

      button,
      [role="button"] {
        cursor: pointer;
      }

      button::-moz-focus-inner {
        border: 0 !important;
      }

      table {
        border-collapse: collapse;
      }

      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        font-size: inherit;
        font-weight: inherit;
      }

      button,
      input,
      optgroup,
      select,
      textarea {
        padding: 0;
        line-height: inherit;
        color: inherit;
      }

      img,
      svg,
      video,
      canvas,
      audio,
      iframe,
      embed,
      object {
        display: block;
        vertical-align: middle;
      }

      img,
      video {
        max-width: 100%;
        height: auto;
      }

      [data-js-focus-visible] :focus:not([data-focus-visible-added]) {
        outline: none;
        box-shadow: none;
      }

      select::-ms-expand {
        display: none;
      }
    `});function $xe(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}function pf(e){return typeof e=="number"}function tD(e){return Array.isArray(e)}function VW(e){return typeof e=="function"}function Du(e){var t=typeof e;return e!=null&&(t==="object"||t==="function")&&!tD(e)}function Lxe(e){return Du(e)&&Object.keys(e).length===0}function qW(e){return e==null}function nD(e){return Object.prototype.toString.call(e)==="[object String]"}function HW(e){return/^var\(--.+\)$/.test(e)}var X2=!1,rD={exports:{}};(function(e,t){var n=200,r="__lodash_hash_undefined__",i=800,a=16,o=9007199254740991,s="[object Arguments]",u="[object Array]",l="[object AsyncFunction]",c="[object Boolean]",f="[object Date]",d="[object Error]",h="[object Function]",p="[object GeneratorFunction]",g="[object Map]",m="[object Number]",v="[object Null]",y="[object Object]",b="[object Proxy]",x="[object RegExp]",w="[object Set]",S="[object String]",C="[object Undefined]",_="[object WeakMap]",E="[object ArrayBuffer]",A="[object DataView]",k="[object Float32Array]",T="[object Float64Array]",I="[object Int8Array]",N="[object Int16Array]",O="[object Int32Array]",D="[object Uint8Array]",L="[object Uint8ClampedArray]",W="[object Uint16Array]",G="[object Uint32Array]",K=/[\\^$.*+?()[\]{}|]/g,ee=/^\[object .+?Constructor\]$/,ce=/^(?:0|[1-9]\d*)$/,he={};he[k]=he[T]=he[I]=he[N]=he[O]=he[D]=he[L]=he[W]=he[G]=!0,he[s]=he[u]=he[E]=he[c]=he[A]=he[f]=he[d]=he[h]=he[g]=he[m]=he[y]=he[x]=he[w]=he[S]=he[_]=!1;var Oe=typeof Ye=="object"&&Ye&&Ye.Object===Object&&Ye,Te=typeof self=="object"&&self&&self.Object===Object&&self,De=Oe||Te||Function("return this")(),me=t&&!t.nodeType&&t,P=me&&!0&&e&&!e.nodeType&&e,F=P&&P.exports===me,V=F&&Oe.process,ae=function(){try{var H=P&&P.require&&P.require("util").types;return H||V&&V.binding&&V.binding("util")}catch(ne){}}(),Y=ae&&ae.isTypedArray;function M(H,ne,de){switch(de.length){case 0:return H.call(ne);case 1:return H.call(ne,de[0]);case 2:return H.call(ne,de[0],de[1]);case 3:return H.call(ne,de[0],de[1],de[2])}return H.apply(ne,de)}function B(H,ne){for(var de=-1,Xe=Array(H);++de<H;)Xe[de]=ne(de);return Xe}function R(H){return function(ne){return H(ne)}}function X(H,ne){return H==null?void 0:H[ne]}function ge(H,ne){return function(de){return H(ne(de))}}var xe=Array.prototype,ze=Function.prototype,Ke=Object.prototype,Ze=De["__core-js_shared__"],Bt=ze.toString,Je=Ke.hasOwnProperty,Zt=function(){var H=/[^.]+$/.exec(Ze&&Ze.keys&&Ze.keys.IE_PROTO||"");return H?"Symbol(src)_1."+H:""}(),mn=Ke.toString,Hn=Bt.call(Object),ti=RegExp("^"+Bt.call(Je).replace(K,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),er=F?De.Buffer:void 0,Dn=De.Symbol,Jo=De.Uint8Array,Ka=er?er.allocUnsafe:void 0,jl=ge(Object.getPrototypeOf,Object),Ts=Object.create,Os=Ke.propertyIsEnumerable,Ul=xe.splice,Wl=Dn?Dn.toStringTag:void 0,af=function(){try{var H=Pe(Object,"defineProperty");return H({},"",{}),H}catch(ne){}}(),f2=er?er.isBuffer:void 0,d2=Math.max,ku=Date.now,h2=Pe(De,"Map"),fh=Pe(Object,"create"),p2=function(){function H(){}return function(ne){if(!ph(ne))return{};if(Ts)return Ts(ne);H.prototype=ne;var de=new H;return H.prototype=void 0,de}}();function Vl(H){var ne=-1,de=H==null?0:H.length;for(this.clear();++ne<de;){var Xe=H[ne];this.set(Xe[0],Xe[1])}}function KI(){this.__data__=fh?fh(null):{},this.size=0}function XI(H){var ne=this.has(H)&&delete this.__data__[H];return this.size-=ne?1:0,ne}function YI(H){var ne=this.__data__;if(fh){var de=ne[H];return de===r?void 0:de}return Je.call(ne,H)?ne[H]:void 0}function ZI(H){var ne=this.__data__;return fh?ne[H]!==void 0:Je.call(ne,H)}function JI(H,ne){var de=this.__data__;return this.size+=this.has(H)?0:1,de[H]=fh&&ne===void 0?r:ne,this}Vl.prototype.clear=KI,Vl.prototype.delete=XI,Vl.prototype.get=YI,Vl.prototype.has=ZI,Vl.prototype.set=JI;function Is(H){var ne=-1,de=H==null?0:H.length;for(this.clear();++ne<de;){var Xe=H[ne];this.set(Xe[0],Xe[1])}}function QI(){this.__data__=[],this.size=0}function eN(H){var ne=this.__data__,de=Tu(ne,H);if(de<0)return!1;var Xe=ne.length-1;return de==Xe?ne.pop():Ul.call(ne,de,1),--this.size,!0}function tN(H){var ne=this.__data__,de=Tu(ne,H);return de<0?void 0:ne[de][1]}function g2(H){return Tu(this.__data__,H)>-1}function nN(H,ne){var de=this.__data__,Xe=Tu(de,H);return Xe<0?(++this.size,de.push([H,ne])):de[Xe][1]=ne,this}Is.prototype.clear=QI,Is.prototype.delete=eN,Is.prototype.get=tN,Is.prototype.has=g2,Is.prototype.set=nN;function of(H){var ne=-1,de=H==null?0:H.length;for(this.clear();++ne<de;){var Xe=H[ne];this.set(Xe[0],Xe[1])}}function rN(){this.size=0,this.__data__={hash:new Vl,map:new(h2||Is),string:new Vl}}function iN(H){var ne=Fe(this,H).delete(H);return this.size-=ne?1:0,ne}function aN(H){return Fe(this,H).get(H)}function oN(H){return Fe(this,H).has(H)}function sN(H,ne){var de=Fe(this,H),Xe=de.size;return de.set(H,ne),this.size+=de.size==Xe?0:1,this}of.prototype.clear=rN,of.prototype.delete=iN,of.prototype.get=aN,of.prototype.has=oN,of.prototype.set=sN;function sf(H){var ne=this.__data__=new Is(H);this.size=ne.size}function uN(){this.__data__=new Is,this.size=0}function lN(H){var ne=this.__data__,de=ne.delete(H);return this.size=ne.size,de}function cN(H){return this.__data__.get(H)}function fN(H){return this.__data__.has(H)}function dN(H,ne){var de=this.__data__;if(de instanceof Is){var Xe=de.__data__;if(!h2||Xe.length<n-1)return Xe.push([H,ne]),this.size=++de.size,this;de=this.__data__=new of(Xe)}return de.set(H,ne),this.size=de.size,this}sf.prototype.clear=uN,sf.prototype.delete=lN,sf.prototype.get=cN,sf.prototype.has=fN,sf.prototype.set=dN;function hN(H,ne){var de=bN(H),Xe=!de&&$g(H),un=!de&&!Xe&&eU(H),Gn=!de&&!Xe&&!un&&nU(H),or=de||Xe||un||Gn,rn=or?B(H.length,String):[],sr=rn.length;for(var Qo in H)(ne||Je.call(H,Qo))&&!(or&&(Qo=="length"||un&&(Qo=="offset"||Qo=="parent")||Gn&&(Qo=="buffer"||Qo=="byteLength"||Qo=="byteOffset")||Ft(Qo,sr)))&&rn.push(Qo);return rn}function B0(H,ne,de){(de!==void 0&&!Pg(H[ne],de)||de===void 0&&!(ne in H))&&Rg(H,ne,de)}function m2(H,ne,de){var Xe=H[ne];(!(Je.call(H,ne)&&Pg(Xe,de))||de===void 0&&!(ne in H))&&Rg(H,ne,de)}function Tu(H,ne){for(var de=H.length;de--;)if(Pg(H[de][0],ne))return de;return-1}function Rg(H,ne,de){ne=="__proto__"&&af?af(H,ne,{configurable:!0,enumerable:!0,value:de,writable:!0}):H[ne]=de}var uf=Re();function Fg(H){return H==null?H===void 0?C:v:Wl&&Wl in Object(H)?je(H):hh(H)}function dh(H){return V0(H)&&Fg(H)==s}function z0(H){if(!ph(H)||Dr(H))return!1;var ne=wN(H)?ti:ee;return ne.test(yN(H))}function pN(H){return V0(H)&&tU(H.length)&&!!he[Fg(H)]}function gN(H){if(!ph(H))return Oi(H);var ne=dr(H),de=[];for(var Xe in H)Xe=="constructor"&&(ne||!Je.call(H,Xe))||de.push(Xe);return de}function Mg(H,ne,de,Xe,un){H!==ne&&uf(ne,function(Gn,or){if(un||(un=new sf),ph(Gn))mN(H,ne,or,de,Mg,Xe,un);else{var rn=Xe?Xe(U0(H,or),Gn,or+"",H,ne,un):void 0;rn===void 0&&(rn=Gn),B0(H,or,rn)}},rU)}function mN(H,ne,de,Xe,un,Gn,or){var rn=U0(H,de),sr=U0(ne,de),Qo=or.get(sr);if(Qo){B0(H,de,Qo);return}var So=Gn?Gn(rn,sr,de+"",H,ne,or):void 0,q0=So===void 0;if(q0){var _N=bN(sr),SN=!_N&&eU(sr),aU=!_N&&!SN&&nU(sr);So=sr,_N||SN||aU?bN(rn)?So=rn:vbe(rn)?So=oe(rn):SN?(q0=!1,So=Z(sr,!0)):aU?(q0=!1,So=re(sr,!0)):So=[]:ybe(sr)||$g(sr)?(So=rn,$g(rn)?So=bbe(rn):(!ph(rn)||wN(rn))&&(So=it(sr))):q0=!1}q0&&(or.set(sr,So),un(So,sr,Xe,Gn,or),or.delete(sr)),B0(H,de,So)}function vN(H,ne){return W0(j0(H,ne,iU),H+"")}var z=af?function(H,ne){return af(H,"toString",{configurable:!0,enumerable:!1,value:wbe(ne),writable:!0})}:iU;function Z(H,ne){if(ne)return H.slice();var de=H.length,Xe=Ka?Ka(de):new H.constructor(de);return H.copy(Xe),Xe}function q(H){var ne=new H.constructor(H.byteLength);return new Jo(ne).set(new Jo(H)),ne}function re(H,ne){var de=ne?q(H.buffer):H.buffer;return new H.constructor(de,H.byteOffset,H.length)}function oe(H,ne){var de=-1,Xe=H.length;for(ne||(ne=Array(Xe));++de<Xe;)ne[de]=H[de];return ne}function te(H,ne,de,Xe){var un=!de;de||(de={});for(var Gn=-1,or=ne.length;++Gn<or;){var rn=ne[Gn],sr=Xe?Xe(de[rn],H[rn],rn,de,H):void 0;sr===void 0&&(sr=H[rn]),un?Rg(de,rn,sr):m2(de,rn,sr)}return de}function Ce(H){return vN(function(ne,de){var Xe=-1,un=de.length,Gn=un>1?de[un-1]:void 0,or=un>2?de[2]:void 0;for(Gn=H.length>3&&typeof Gn=="function"?(un--,Gn):void 0,or&&bn(de[0],de[1],or)&&(Gn=un<3?void 0:Gn,un=1),ne=Object(ne);++Xe<un;){var rn=de[Xe];rn&&H(ne,rn,Xe,Gn)}return ne})}function Re(H){return function(ne,de,Xe){for(var un=-1,Gn=Object(ne),or=Xe(ne),rn=or.length;rn--;){var sr=or[H?rn:++un];if(de(Gn[sr],sr,Gn)===!1)break}return ne}}function Fe(H,ne){var de=H.__data__;return Cn(ne)?de[typeof ne=="string"?"string":"hash"]:de.map}function Pe(H,ne){var de=X(H,ne);return z0(de)?de:void 0}function je(H){var ne=Je.call(H,Wl),de=H[Wl];try{H[Wl]=void 0;var Xe=!0}catch(Gn){}var un=mn.call(H);return Xe&&(ne?H[Wl]=de:delete H[Wl]),un}function it(H){return typeof H.constructor=="function"&&!dr(H)?p2(jl(H)):{}}function Ft(H,ne){var de=typeof H;return ne=ne??o,!!ne&&(de=="number"||de!="symbol"&&ce.test(H))&&H>-1&&H%1==0&&H<ne}function bn(H,ne,de){if(!ph(de))return!1;var Xe=typeof ne;return(Xe=="number"?xN(de)&&Ft(ne,de.length):Xe=="string"&&ne in de)?Pg(de[ne],H):!1}function Cn(H){var ne=typeof H;return ne=="string"||ne=="number"||ne=="symbol"||ne=="boolean"?H!=="__proto__":H===null}function Dr(H){return!!Zt&&Zt in H}function dr(H){var ne=H&&H.constructor,de=typeof ne=="function"&&ne.prototype||Ke;return H===de}function Oi(H){var ne=[];if(H!=null)for(var de in Object(H))ne.push(de);return ne}function hh(H){return mn.call(H)}function j0(H,ne,de){return ne=d2(ne===void 0?H.length-1:ne,0),function(){for(var Xe=arguments,un=-1,Gn=d2(Xe.length-ne,0),or=Array(Gn);++un<Gn;)or[un]=Xe[ne+un];un=-1;for(var rn=Array(ne+1);++un<ne;)rn[un]=Xe[un];return rn[ne]=de(or),M(H,this,rn)}}function U0(H,ne){if(!(ne==="constructor"&&typeof H[ne]=="function")&&ne!="__proto__")return H[ne]}var W0=Q7(z);function Q7(H){var ne=0,de=0;return function(){var Xe=ku(),un=a-(Xe-de);if(de=Xe,un>0){if(++ne>=i)return arguments[0]}else ne=0;return H.apply(void 0,arguments)}}function yN(H){if(H!=null){try{return Bt.call(H)}catch(ne){}try{return H+""}catch(ne){}}return""}function Pg(H,ne){return H===ne||H!==H&&ne!==ne}var $g=dh(function(){return arguments}())?dh:function(H){return V0(H)&&Je.call(H,"callee")&&!Os.call(H,"callee")},bN=Array.isArray;function xN(H){return H!=null&&tU(H.length)&&!wN(H)}function vbe(H){return V0(H)&&xN(H)}var eU=f2||_be;function wN(H){if(!ph(H))return!1;var ne=Fg(H);return ne==h||ne==p||ne==l||ne==b}function tU(H){return typeof H=="number"&&H>-1&&H%1==0&&H<=o}function ph(H){var ne=typeof H;return H!=null&&(ne=="object"||ne=="function")}function V0(H){return H!=null&&typeof H=="object"}function ybe(H){if(!V0(H)||Fg(H)!=y)return!1;var ne=jl(H);if(ne===null)return!0;var de=Je.call(ne,"constructor")&&ne.constructor;return typeof de=="function"&&de instanceof de&&Bt.call(de)==Hn}var nU=Y?R(Y):pN;function bbe(H){return te(H,rU(H))}function rU(H){return xN(H)?hN(H,!0):gN(H)}var xbe=Ce(function(H,ne,de,Xe){Mg(H,ne,de,Xe)});function wbe(H){return function(){return H}}function iU(H){return H}function _be(){return!1}e.exports=xbe})(rD,rD.exports);var Ru=rD.exports;function iD(e,t){var n={};return Object.keys(e).forEach(r=>{t.includes(r)||(n[r]=e[r])}),n}function Bxe(e,t){var n={};return t.forEach(r=>{r in e&&(n[r]=e[r])}),n}function zxe(e,t){var n={},r={};return Object.keys(e).forEach(i=>{t.includes(i)?n[i]=e[i]:r[i]=e[i]}),[n,r]}function jxe(e,t,n,r){var i=typeof t=="string"?t.split("."):[t];for(r=0;r<i.length&&e;r+=1)e=e[i[r]];return e===void 0?n:e}var Uxe=e=>{var t=new WeakMap,n=(r,i,a,o)=>{if(typeof r=="undefined")return e(r,i,a);t.has(r)||t.set(r,new Map);var s=t.get(r);if(s.has(i))return s.get(i);var u=e(r,i,a,o);return s.set(i,u),u};return n},Y2=Uxe(jxe);function GW(e,t){var n={};return Object.keys(e).forEach(r=>{var i=e[r],a=t(i,r,e);a&&(n[r]=i)}),n}var Z2=e=>GW(e,t=>t!=null),J2=e=>Object.keys(e),Wxe=e=>e.reduce((t,n)=>{var[r,i]=n;return t[r]=i,t},{});function Vxe(e){var t=parseFloat(e.toString()),n=e.toString().replace(String(t),"");return{unitless:!n,value:t,unit:n}}function aD(e){if(e==null)return e;var{unitless:t}=Vxe(e);return t||pf(e)?e+"px":e}var KW=(e,t)=>parseInt(e[1],10)>parseInt(t[1],10)?1:-1,oD=e=>Wxe(Object.entries(e).sort(KW));function XW(e){var t=oD(e);return Object.assign(Object.values(t),t)}function qxe(e){var t=Object.keys(oD(e));return new Set(t)}function Hxe(e){var t;if(!e)return e;e=(t=aD(e))!=null?t:e;var n=e.endsWith("px")?-1:-.0635;return pf(e)?""+(e+n):e.replace(/([0-9]+\.?[0-9]*)/,r=>""+(parseFloat(r)+n))}function Q2(e,t){var n=[];return e&&n.push("@media screen and (min-width: "+aD(e)+")"),n.length>0&&t&&n.push("and"),t&&n.push("@media screen and (max-width: "+aD(t)+")"),n.join(" ")}function Gxe(e){var t;if(!e)return null;e.base=(t=e.base)!=null?t:"0px";var n=XW(e),r=Object.entries(e).sort(KW).map((o,s,u)=>{var l,[c,f]=o,[,d]=(l=u[s+1])!=null?l:[];return d=parseFloat(d)>0?Hxe(d):void 0,{breakpoint:c,minW:f,maxW:d,maxWQuery:Q2(null,d),minWQuery:Q2(f),minMaxQuery:Q2(f,d)}}),i=qxe(e),a=Array.from(i.values());return{keys:i,normalized:n,isResponsive(o){var s=Object.keys(o);return s.length>0&&s.every(u=>i.has(u))},asObject:oD(e),asArray:XW(e),details:r,media:[null,...n.map(o=>Q2(o)).slice(1)],toArrayValue(o){if(!Du(o))throw new Error("toArrayValue: value must be an object");for(var s=a.map(u=>{var l;return(l=o[u])!=null?l:null});$xe(s)===null;)s.pop();return s},toObjectValue(o){if(!Array.isArray(o))throw new Error("toObjectValue: value must be an array");return o.reduce((s,u,l)=>{var c=a[l];return c!=null&&u!=null&&(s[c]=u),s},{})}}}function YW(e){var t;return e instanceof Element&&(t=e.ownerDocument)!=null?t:document}function Kxe(){return!!(typeof window!="undefined"&&window.document&&window.document.createElement)}var qg=Kxe(),Ii=e=>e?"":void 0,sD=e=>e?!0:void 0,Wn=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.filter(Boolean).join(" ")};function Xxe(e){var{key:t,keyCode:n}=e,r=n>=37&&n<=40&&t.indexOf("Arrow")!==0,i=r?"Arrow"+t:t;return i}function ZW(e){return e.button!==0}var Yxe=e=>e.hasAttribute("tabindex");function Zxe(e){return Boolean(e.getAttribute("disabled"))===!0||Boolean(e.getAttribute("aria-disabled"))===!0}function Jxe(e){return JW(e)&&e.tagName.toLowerCase()==="input"&&"select"in e}function Qxe(e){var t=e instanceof HTMLElement?YW(e):document;return t.activeElement===e}function JW(e){return e instanceof HTMLElement}function QW(e){return e.parentElement&&QW(e.parentElement)?!0:e.hidden}function ewe(e){var t=e.getAttribute("contenteditable");return t!=="false"&&t!=null}function twe(e){if(!JW(e)||QW(e)||Zxe(e))return!1;var{localName:t}=e,n=["input","select","textarea","button"];if(n.indexOf(t)>=0)return!0;var r={a:()=>e.hasAttribute("href"),audio:()=>e.hasAttribute("controls"),video:()=>e.hasAttribute("controls")};return t in r?r[t]():ewe(e)?!0:Yxe(e)}var nwe=["input:not([disabled])","select:not([disabled])","textarea:not([disabled])","embed","iframe","object","a[href]","area[href]","button:not([disabled])","[tabindex]","audio[controls]","video[controls]","*[tabindex]:not([aria-disabled])","*[contenteditable]"],rwe=nwe.join();function iwe(e){var t=Array.from(e.querySelectorAll(rwe));return t.unshift(e),t.filter(twe).filter(n=>window.getComputedStyle(n).display!=="none")}function Ms(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return VW(e)?e(...n):e}function wr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(i){t.some(a=>(a==null||a(i),i==null?void 0:i.defaultPrevented))}}function awe(e){var t;return function(){if(e){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];t=e.apply(this,i),e=null}return t}}var iy=()=>{},uD=awe(e=>()=>{var{condition:t,message:n}=e;t&&X2&&console.warn(n)}),owe=e=>{Promise.resolve().then(e)},swe=typeof queueMicrotask=="function"?queueMicrotask:owe;function Hg(e,t){t===void 0&&(t={});var{isActive:n=Qxe,nextTick:r,preventScroll:i=!0,selectTextIfInput:a=!0}=t;if(!e||n(e))return-1;function o(){if(!e){uD({condition:!0,message:"[chakra-ui]: can't call focus() on `null` or `undefined` element"});return}if(uwe())e.focus({preventScroll:i});else if(e.focus(),i){var s=lwe(e);cwe(s)}Jxe(e)&&a&&e.select()}return r?requestAnimationFrame(o):(o(),-1)}var e_=null;function uwe(){if(e_==null){e_=!1;try{var e=document.createElement("div");e.focus({get preventScroll(){return e_=!0,!0}})}catch(t){}}return e_}function lwe(e){for(var t=YW(e),n=e.parentNode,r=[],i=t.scrollingElement||t.documentElement;n instanceof HTMLElement&&n!==i;)(n.offsetHeight<n.scrollHeight||n.offsetWidth<n.scrollWidth)&&r.push({element:n,scrollTop:n.scrollTop,scrollLeft:n.scrollLeft}),n=n.parentNode;return i instanceof HTMLElement&&r.push({element:i,scrollTop:i.scrollTop,scrollLeft:i.scrollLeft}),r}function cwe(e){for(var{element:t,scrollTop:n,scrollLeft:r}of e)t.scrollTop=n,t.scrollLeft=r}function fwe(e){var{hasBeenSelected:t,isLazy:n,isSelected:r,lazyBehavior:i="unmount"}=e;return!!(!n||r||i==="keepMounted"&&t)}var eV=1/60*1e3,dwe=typeof performance!="undefined"?function(){return performance.now()}:function(){return Date.now()},tV=typeof window!="undefined"?function(e){return window.requestAnimationFrame(e)}:function(e){return setTimeout(function(){return e(dwe())},eV)};function hwe(e){var t=[],n=[],r=0,i=!1,a=new WeakSet,o={schedule:function(s,u,l){u===void 0&&(u=!1),l===void 0&&(l=!1);var c=l&&i,f=c?t:n;return u&&a.add(s),f.indexOf(s)===-1&&(f.push(s),c&&i&&(r=t.length)),s},cancel:function(s){var u=n.indexOf(s);u!==-1&&n.splice(u,1),a.delete(s)},process:function(s){var u;if(i=!0,u=[n,t],t=u[0],n=u[1],n.length=0,r=t.length,r)for(var l=0;l<r;l++){var c=t[l];c(s),a.has(c)&&(o.schedule(c),e())}i=!1}};return o}var pwe=40,lD=!0,ay=!1,cD=!1,Gg={delta:0,timestamp:0},oy=["read","update","preRender","render","postRender"],t_=oy.reduce(function(e,t){return e[t]=hwe(function(){return ay=!0}),e},{}),Fu=oy.reduce(function(e,t){var n=t_[t];return e[t]=function(r,i,a){return i===void 0&&(i=!1),a===void 0&&(a=!1),ay||mwe(),n.schedule(r,i,a)},e},{}),sy=oy.reduce(function(e,t){return e[t]=t_[t].cancel,e},{}),Kg=oy.reduce(function(e,t){return e[t]=function(){return t_[t].process(Gg)},e},{}),gwe=function(e){return t_[e].process(Gg)},nV=function(e){ay=!1,Gg.delta=lD?eV:Math.max(Math.min(e-Gg.timestamp,pwe),1),Gg.timestamp=e,cD=!0,oy.forEach(gwe),cD=!1,ay&&(lD=!1,tV(nV))},mwe=function(){ay=!0,lD=!0,cD||tV(nV)},n_=function(){return Gg};Object.freeze(["base","sm","md","lg","xl","2xl"]);function uy(e,t){return tD(e)?e.map(n=>n===null?null:t(n)):Du(e)?J2(e).reduce((n,r)=>(n[r]=t(e[r]),n),{}):e!=null?t(e):null}function vwe(e,t){function n(r,i){return i===void 0&&(i=[]),tD(r)?r.map((a,o)=>n(a,[...i,String(o)])):Du(r)?Object.fromEntries(Object.entries(r).map(a=>{var[o,s]=a;return[o,n(s,[...i,o])]})):t(r,i)}return n(e)}function ywe(e,t){if(e!=null){if(VW(e)){e(t);return}try{e.current=t}catch(n){throw new Error("Cannot assign value '"+t+"' to ref '"+e+"'")}}}function gf(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r=>{t.forEach(i=>ywe(i,r))}}function Mu(e){e===void 0&&(e={});var{strict:t=!0,errorMessage:n="useContext: `context` is undefined. Seems you forgot to wrap component within the Provider",name:r}=e,i=ha(void 0);i.displayName=r;function a(){var o=Un(i);if(!o&&t){var s=new Error(n);throw s.name="ContextError",Error.captureStackTrace==null||Error.captureStackTrace(s,a),s}return o}return[i.Provider,a,i]}function fD(e){return _2.toArray(e).filter(t=>gh(t))}var[bwe,xwe]=Mu({strict:!1,name:"PortalManagerContext"});function rV(e){var{children:t,zIndex:n}=e;return ue(bwe,{value:{zIndex:n}},t)}X2&&(rV.displayName="PortalManager");function dD(e){e===void 0&&(e=!1);var[t,n]=an(e),r=st(()=>{n(!0)},[]),i=st(()=>{n(!1)},[]),a=st(()=>{n(o=>!o)},[]);return[t,{on:r,off:i,toggle:a}]}var Xg=qg?lf:qt;function ly(e,t){t===void 0&&(t=[]);var n=Jt(e);return Xg(()=>{n.current=e}),st(function(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return n.current==null?void 0:n.current(...i)},t)}function wwe(e,t){var n=e!==void 0,r=n&&typeof e!="undefined"?e:t;return[n,r]}function _we(e){var{value:t,defaultValue:n,onChange:r,shouldUpdate:i=(d,h)=>d!==h}=e,a=ly(r),o=ly(i),[s,u]=an(n),l=t!==void 0,c=l?t:s,f=st(d=>{var h=Ms(d,c);!o(c,h)||(l||u(h),a(h))},[l,a,c,o]);return[c,f]}var iV={prefix:Math.round(Math.random()*1e10),current:0},hD=ha(iV),Swe=DU(e=>{var{children:t}=e,n=Un(hD),r=n===iV,i=xr(()=>({prefix:r?0:++n.prefix,current:0}),[r,n]);return ue(hD.Provider,{value:i},t)});function aV(e,t){var n=Un(hD);return xr(()=>e||[t,n.prefix,++n.current].filter(Boolean).join("-"),[e,t])}function Ewe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=aV(e);return xr(()=>n.map(a=>a+"-"+i),[i,n])}function Cwe(e,t){return t===void 0&&(t=[]),qt(()=>()=>e(),t)}function oV(){var e=Jt(!1),[t,n]=an(0);return Cwe(()=>{e.current=!0}),st(()=>{e.current||n(t+1)},[t])}function pD(){return pD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},pD.apply(this,arguments)}function Awe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var[sV,kwe]=Mu({strict:!1,name:"PortalContext"}),gD="chakra-portal",Twe=".chakra-portal",Owe=e=>ue("div",{className:"chakra-portal-zIndex",style:{position:"absolute",zIndex:e.zIndex,top:0,left:0,right:0}},e.children),Iwe=e=>{var{appendToParentPortal:t,children:n}=e,r=Jt(null),i=Jt(null),a=oV(),o=kwe(),s=xwe();Xg(()=>{if(!!r.current){var l=r.current.ownerDocument,c=t?o??l.body:l.body;if(!!c){i.current=l.createElement("div"),i.current.className=gD,c.appendChild(i.current),a();var f=i.current;return()=>{c.contains(f)&&c.removeChild(f)}}}},[]);var u=s!=null&&s.zIndex?ue(Owe,{zIndex:s==null?void 0:s.zIndex},n):n;return i.current?NN(ue(sV,{value:i.current},u),i.current):ue("span",{ref:r})},Nwe=e=>{var{children:t,containerRef:n,appendToParentPortal:r}=e,i=n.current,a=i??(qg?document.body:void 0),o=xr(()=>{var u=i==null?void 0:i.ownerDocument.createElement("div");return u&&(u.className=gD),u},[i]),s=oV();return Xg(()=>{s()},[]),Xg(()=>{if(!(!o||!a))return a.appendChild(o),()=>{a.removeChild(o)}},[o,a]),a&&o?NN(ue(sV,{value:r?o:null},t),o):null};function r_(e){var{containerRef:t}=e,n=Awe(e,["containerRef"]);return t?ue(Nwe,pD({containerRef:t},n)):ue(Iwe,n)}r_.defaultProps={appendToParentPortal:!0},r_.className=gD,r_.selector=Twe;var i_={light:"chakra-ui-light",dark:"chakra-ui-dark"},Dwe={classList:{add:iy,remove:iy}},Rwe=()=>qg?document.body:Dwe;function Fwe(e){var t=Rwe();t.classList.add(e?i_.dark:i_.light),t.classList.remove(e?i_.light:i_.dark)}function Mwe(e){var t=window.matchMedia==null?void 0:window.matchMedia(e);if(!!t)return!!t.media===t.matches}var uV={light:"(prefers-color-scheme: light)",dark:"(prefers-color-scheme: dark)"};function Pwe(e){var t,n=(t=Mwe(uV.dark))!=null?t:e==="dark";return n?"dark":"light"}function $we(e){if(!("matchMedia"in window))return iy;var t=window.matchMedia(uV.dark),n=()=>{e(t.matches?"dark":"light")};return n(),t.addListener(n),()=>{t.removeListener(n)}}var lV={get:()=>document.documentElement.style.getPropertyValue("--chakra-ui-color-mode"),set:e=>{qg&&document.documentElement.style.setProperty("--chakra-ui-color-mode",e)}},cV=()=>typeof Storage!="undefined",fV="chakra-ui-color-mode",Lwe={get(e){if(!cV())return e;try{var t=localStorage.getItem(fV);return t??e}catch(n){return e}},set(e){if(!!cV())try{localStorage.setItem(fV,e)}catch(t){}},type:"localStorage"},mD=ha({});X2&&(mD.displayName="ColorModeContext");var vD=()=>{var e=Un(mD);if(e===void 0)throw new Error("useColorMode must be used within a ColorModeProvider");return e};function dV(e){var{value:t,children:n,options:{useSystemColorMode:r,initialColorMode:i},colorModeManager:a=Lwe}=e,[o,s]=an(a.type==="cookie"?a.get(i):i);qt(()=>{if(qg&&a.type==="localStorage"){var f=r?Pwe(i):lV.get()||a.get();f&&s(f)}},[a,r,i]),qt(()=>{var f=o==="dark";Fwe(f),lV.set(f?"dark":"light")},[o]);var u=st(f=>{a.set(f),s(f)},[a]),l=st(()=>{u(o==="light"?"dark":"light")},[o,u]);qt(()=>{var f;return r&&(f=$we(u)),()=>{f&&r&&f()}},[u,r]);var c=xr(()=>({colorMode:t??o,toggleColorMode:t?iy:l,setColorMode:t?iy:u}),[o,u,l,t]);return ue(mD.Provider,{value:c},n)}X2&&(dV.displayName="ColorModeProvider");function Bwe(e,t){var{colorMode:n}=vD();return n==="dark"?t:e}var zwe=(e,t)=>n=>{var r=String(t),i=e?e+"."+r:r;return Du(n.__cssMap)&&i in n.__cssMap?n.__cssMap[i].varRef:t};function cy(e){var{scale:t,transform:n,compose:r}=e,i=(a,o)=>{var s,u=zwe(t,a)(o),l=(s=n==null?void 0:n(u,o))!=null?s:u;return r&&(l=r(l,o)),l};return i}function Ps(e,t){return n=>{var r={property:n,scale:e};return r.transform=cy({scale:e,transform:t}),r}}var jwe=e=>{var{rtl:t,ltr:n}=e;return r=>r.direction==="rtl"?t:n};function Uwe(e){var{property:t,scale:n,transform:r}=e;return{scale:n,property:jwe(t),transform:n?cy({scale:n,compose:r}):r}}var hV=["rotate(var(--chakra-rotate, 0))","scaleX(var(--chakra-scale-x, 1))","scaleY(var(--chakra-scale-y, 1))","skewX(var(--chakra-skew-x, 0))","skewY(var(--chakra-skew-y, 0))"];function Wwe(){return["translateX(var(--chakra-translate-x, 0))","translateY(var(--chakra-translate-y, 0))",...hV].join(" ")}function Vwe(){return["translate3d(var(--chakra-translate-x, 0), var(--chakra-translate-y, 0), 0)",...hV].join(" ")}var qwe={"--chakra-blur":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-brightness":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-contrast":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-grayscale":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-hue-rotate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-invert":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-saturate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-sepia":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-drop-shadow":"var(--chakra-empty,/*!*/ /*!*/)",filter:["var(--chakra-blur)","var(--chakra-brightness)","var(--chakra-contrast)","var(--chakra-grayscale)","var(--chakra-hue-rotate)","var(--chakra-invert)","var(--chakra-saturate)","var(--chakra-sepia)","var(--chakra-drop-shadow)"].join(" ")},Hwe={backdropFilter:["var(--chakra-backdrop-blur)","var(--chakra-backdrop-brightness)","var(--chakra-backdrop-contrast)","var(--chakra-backdrop-grayscale)","var(--chakra-backdrop-hue-rotate)","var(--chakra-backdrop-invert)","var(--chakra-backdrop-opacity)","var(--chakra-backdrop-saturate)","var(--chakra-backdrop-sepia)"].join(" "),"--chakra-backdrop-blur":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-brightness":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-contrast":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-grayscale":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-hue-rotate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-invert":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-opacity":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-saturate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-sepia":"var(--chakra-empty,/*!*/ /*!*/)"};function Gwe(e){return{"--chakra-ring-offset-shadow":"var(--chakra-ring-inset) 0 0 0 var(--chakra-ring-offset-width) var(--chakra-ring-offset-color)","--chakra-ring-shadow":"var(--chakra-ring-inset) 0 0 0 calc(var(--chakra-ring-width) + var(--chakra-ring-offset-width)) var(--chakra-ring-color)","--chakra-ring-width":e,boxShadow:["var(--chakra-ring-offset-shadow)","var(--chakra-ring-shadow)","var(--chakra-shadow, 0 0 #0000)"].join(", ")}}var Kwe={"row-reverse":{space:"--chakra-space-x-reverse",divide:"--chakra-divide-x-reverse"},"column-reverse":{space:"--chakra-space-y-reverse",divide:"--chakra-divide-y-reverse"}},pV="& > :not(style) ~ :not(style)",Xwe={[pV]:{marginInlineStart:"calc(var(--chakra-space-x) * calc(1 - var(--chakra-space-x-reverse)))",marginInlineEnd:"calc(var(--chakra-space-x) * var(--chakra-space-x-reverse))"}},Ywe={[pV]:{marginTop:"calc(var(--chakra-space-y) * calc(1 - var(--chakra-space-y-reverse)))",marginBottom:"calc(var(--chakra-space-y) * var(--chakra-space-y-reverse))"}};function yD(e,t){yD=function(u,l){return new a(u,void 0,l)};var n=bD(RegExp),r=RegExp.prototype,i=new WeakMap;function a(s,u,l){var c=n.call(this,s,u);return i.set(c,l||i.get(s)),c}Zwe(a,n),a.prototype.exec=function(s){var u=r.exec.call(this,s);return u&&(u.groups=o(u,this)),u},a.prototype[Symbol.replace]=function(s,u){if(typeof u=="string"){var l=i.get(this);return r[Symbol.replace].call(this,s,u.replace(/\$<([^>]+)>/g,function(f,d){return"$"+l[d]}))}else if(typeof u=="function"){var c=this;return r[Symbol.replace].call(this,s,function(){var f=[];return f.push.apply(f,arguments),typeof f[f.length-1]!="object"&&f.push(o(f,c)),u.apply(this,f)})}else return r[Symbol.replace].call(this,s,u)};function o(s,u){var l=i.get(u);return Object.keys(l).reduce(function(c,f){return c[f]=s[l[f]],c},Object.create(null))}return yD.apply(this,arguments)}function Zwe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fy(e,t)}function bD(e){var t=typeof Map=="function"?new Map:void 0;return bD=function(r){if(r===null||!Qwe(r))return r;if(typeof r!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t!="undefined"){if(t.has(r))return t.get(r);t.set(r,i)}function i(){return a_(r,arguments,xD(this).constructor)}return i.prototype=Object.create(r.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),fy(i,r)},bD(e)}function a_(e,t,n){return Jwe()?a_=Reflect.construct:a_=function(i,a,o){var s=[null];s.push.apply(s,a);var u=Function.bind.apply(i,s),l=new u;return o&&fy(l,o.prototype),l},a_.apply(null,arguments)}function Jwe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function Qwe(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function fy(e,t){return fy=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},fy(e,t)}function xD(e){return xD=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},xD(e)}var wD={"to-t":"to top","to-tr":"to top right","to-r":"to right","to-br":"to bottom right","to-b":"to bottom","to-bl":"to bottom left","to-l":"to left","to-tl":"to top left"},e2e=new Set(Object.values(wD)),gV=new Set(["none","-moz-initial","inherit","initial","revert","unset"]),t2e=e=>e.trim();function n2e(e,t){var n,r;if(e==null||gV.has(e))return e;var i=yD(/(^[\x2DA-Za-z]+)\(((.*))\)/g,{type:1,values:2}),{type:a,values:o}=(n=(r=i.exec(e))==null?void 0:r.groups)!=null?n:{};if(!a||!o)return e;var s=a.includes("-gradient")?a:a+"-gradient",[u,...l]=o.split(",").map(t2e).filter(Boolean);if((l==null?void 0:l.length)===0)return e;var c=u in wD?wD[u]:u;l.unshift(c);var f=l.map(d=>{if(e2e.has(d))return d;var[h,p]=d.split(" "),g="colors."+h,m=g in t.__cssMap?t.__cssMap[g].varRef:h;return p?[m,p].join(" "):m});return s+"("+f.join(", ")+")"}var r2e=(e,t)=>n2e(e,t??{}),i2e=e=>{var t=parseFloat(e.toString()),n=e.toString().replace(String(t),"");return{unitless:!n,value:t,unit:n}},Pu=e=>t=>e+"("+t+")",$n={filter(e){return e!=="auto"?e:qwe},backdropFilter(e){return e!=="auto"?e:Hwe},ring(e){return Gwe($n.px(e))},bgClip(e){return e==="text"?{color:"transparent",backgroundClip:"text"}:{backgroundClip:e}},transform(e){return e==="auto"?Wwe():e==="auto-gpu"?Vwe():e},px(e){if(e==null)return e;var{unitless:t}=i2e(e);return t||pf(e)?e+"px":e},fraction(e){return!pf(e)||e>1?e:e*100+"%"},float(e,t){var n={left:"right",right:"left"};return t.direction==="rtl"?n[e]:e},degree(e){if(HW(e)||e==null)return e;var t=nD(e)&&!e.endsWith("deg");return pf(e)||t?e+"deg":e},gradient:r2e,blur:Pu("blur"),opacity:Pu("opacity"),brightness:Pu("brightness"),contrast:Pu("contrast"),dropShadow:Pu("drop-shadow"),grayscale:Pu("grayscale"),hueRotate:Pu("hue-rotate"),invert:Pu("invert"),saturate:Pu("saturate"),sepia:Pu("sepia"),bgImage(e){if(e==null)return e;var t=a2e(e)||gV.has(e);return t?e:"url("+e+")"},outline(e){var t=String(e)==="0"||String(e)==="none";return e!==null&&t?{outline:"2px solid transparent",outlineOffset:"2px"}:{outline:e}},flexDirection(e){var t,{space:n,divide:r}=(t=Kwe[e])!=null?t:{},i={flexDirection:e};return n&&(i[n]=1),r&&(i[r]=1),i}},a2e=e=>nD(e)&&e.includes("(")&&e.includes(")");function _D(){return _D=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_D.apply(this,arguments)}var se={borderWidths:Ps("borderWidths"),borderStyles:Ps("borderStyles"),colors:Ps("colors"),borders:Ps("borders"),radii:Ps("radii",$n.px),space:Ps("space",$n.px),spaceT:Ps("space",$n.px),degreeT(e){return{property:e,transform:$n.degree}},prop(e,t,n){return _D({property:e,scale:t},t&&{transform:cy({scale:t,transform:n})})},propT(e,t){return{property:e,transform:t}},sizes:Ps("sizes",$n.px),sizesT:Ps("sizes",$n.fraction),shadows:Ps("shadows"),logical:Uwe,blur:Ps("blur",$n.blur)},o_={background:se.colors("background"),backgroundColor:se.colors("backgroundColor"),backgroundImage:se.propT("backgroundImage",$n.bgImage),backgroundSize:!0,backgroundPosition:!0,backgroundRepeat:!0,backgroundAttachment:!0,backgroundClip:{transform:$n.bgClip},bgSize:se.prop("backgroundSize"),bgPosition:se.prop("backgroundPosition"),bg:se.colors("background"),bgColor:se.colors("backgroundColor"),bgPos:se.prop("backgroundPosition"),bgRepeat:se.prop("backgroundRepeat"),bgAttachment:se.prop("backgroundAttachment"),bgGradient:se.propT("backgroundImage",$n.gradient),bgClip:{transform:$n.bgClip}};Object.assign(o_,{bgImage:o_.backgroundImage,bgImg:o_.backgroundImage});var kn={border:se.borders("border"),borderWidth:se.borderWidths("borderWidth"),borderStyle:se.borderStyles("borderStyle"),borderColor:se.colors("borderColor"),borderRadius:se.radii("borderRadius"),borderTop:se.borders("borderTop"),borderBlockStart:se.borders("borderBlockStart"),borderTopLeftRadius:se.radii("borderTopLeftRadius"),borderStartStartRadius:se.logical({scale:"radii",property:{ltr:"borderTopLeftRadius",rtl:"borderTopRightRadius"}}),borderEndStartRadius:se.logical({scale:"radii",property:{ltr:"borderBottomLeftRadius",rtl:"borderBottomRightRadius"}}),borderTopRightRadius:se.radii("borderTopRightRadius"),borderStartEndRadius:se.logical({scale:"radii",property:{ltr:"borderTopRightRadius",rtl:"borderTopLeftRadius"}}),borderEndEndRadius:se.logical({scale:"radii",property:{ltr:"borderBottomRightRadius",rtl:"borderBottomLeftRadius"}}),borderRight:se.borders("borderRight"),borderInlineEnd:se.borders("borderInlineEnd"),borderBottom:se.borders("borderBottom"),borderBlockEnd:se.borders("borderBlockEnd"),borderBottomLeftRadius:se.radii("borderBottomLeftRadius"),borderBottomRightRadius:se.radii("borderBottomRightRadius"),borderLeft:se.borders("borderLeft"),borderInlineStart:{property:"borderInlineStart",scale:"borders"},borderInlineStartRadius:se.logical({scale:"radii",property:{ltr:["borderTopLeftRadius","borderBottomLeftRadius"],rtl:["borderTopRightRadius","borderBottomRightRadius"]}}),borderInlineEndRadius:se.logical({scale:"radii",property:{ltr:["borderTopRightRadius","borderBottomRightRadius"],rtl:["borderTopLeftRadius","borderBottomLeftRadius"]}}),borderX:se.borders(["borderLeft","borderRight"]),borderInline:se.borders("borderInline"),borderY:se.borders(["borderTop","borderBottom"]),borderBlock:se.borders("borderBlock"),borderTopWidth:se.borderWidths("borderTopWidth"),borderBlockStartWidth:se.borderWidths("borderBlockStartWidth"),borderTopColor:se.colors("borderTopColor"),borderBlockStartColor:se.colors("borderBlockStartColor"),borderTopStyle:se.borderStyles("borderTopStyle"),borderBlockStartStyle:se.borderStyles("borderBlockStartStyle"),borderBottomWidth:se.borderWidths("borderBottomWidth"),borderBlockEndWidth:se.borderWidths("borderBlockEndWidth"),borderBottomColor:se.colors("borderBottomColor"),borderBlockEndColor:se.colors("borderBlockEndColor"),borderBottomStyle:se.borderStyles("borderBottomStyle"),borderBlockEndStyle:se.borderStyles("borderBlockEndStyle"),borderLeftWidth:se.borderWidths("borderLeftWidth"),borderInlineStartWidth:se.borderWidths("borderInlineStartWidth"),borderLeftColor:se.colors("borderLeftColor"),borderInlineStartColor:se.colors("borderInlineStartColor"),borderLeftStyle:se.borderStyles("borderLeftStyle"),borderInlineStartStyle:se.borderStyles("borderInlineStartStyle"),borderRightWidth:se.borderWidths("borderRightWidth"),borderInlineEndWidth:se.borderWidths("borderInlineEndWidth"),borderRightColor:se.colors("borderRightColor"),borderInlineEndColor:se.colors("borderInlineEndColor"),borderRightStyle:se.borderStyles("borderRightStyle"),borderInlineEndStyle:se.borderStyles("borderInlineEndStyle"),borderTopRadius:se.radii(["borderTopLeftRadius","borderTopRightRadius"]),borderBottomRadius:se.radii(["borderBottomLeftRadius","borderBottomRightRadius"]),borderLeftRadius:se.radii(["borderTopLeftRadius","borderBottomLeftRadius"]),borderRightRadius:se.radii(["borderTopRightRadius","borderBottomRightRadius"])};Object.assign(kn,{rounded:kn.borderRadius,roundedTop:kn.borderTopRadius,roundedTopLeft:kn.borderTopLeftRadius,roundedTopRight:kn.borderTopRightRadius,roundedTopStart:kn.borderStartStartRadius,roundedTopEnd:kn.borderStartEndRadius,roundedBottom:kn.borderBottomRadius,roundedBottomLeft:kn.borderBottomLeftRadius,roundedBottomRight:kn.borderBottomRightRadius,roundedBottomStart:kn.borderEndStartRadius,roundedBottomEnd:kn.borderEndEndRadius,roundedLeft:kn.borderLeftRadius,roundedRight:kn.borderRightRadius,roundedStart:kn.borderInlineStartRadius,roundedEnd:kn.borderInlineEndRadius,borderStart:kn.borderInlineStart,borderEnd:kn.borderInlineEnd,borderTopStartRadius:kn.borderStartStartRadius,borderTopEndRadius:kn.borderStartEndRadius,borderBottomStartRadius:kn.borderEndStartRadius,borderBottomEndRadius:kn.borderEndEndRadius,borderStartRadius:kn.borderInlineStartRadius,borderEndRadius:kn.borderInlineEndRadius,borderStartWidth:kn.borderInlineStartWidth,borderEndWidth:kn.borderInlineEndWidth,borderStartColor:kn.borderInlineStartColor,borderEndColor:kn.borderInlineEndColor,borderStartStyle:kn.borderInlineStartStyle,borderEndStyle:kn.borderInlineEndStyle});var o2e={color:se.colors("color"),textColor:se.colors("color"),fill:se.colors("fill"),stroke:se.colors("stroke")},SD={boxShadow:se.shadows("boxShadow"),mixBlendMode:!0,blendMode:se.prop("mixBlendMode"),backgroundBlendMode:!0,bgBlendMode:se.prop("backgroundBlendMode"),opacity:!0};Object.assign(SD,{shadow:SD.boxShadow});var s2e={filter:{transform:$n.filter},blur:se.blur("--chakra-blur"),brightness:se.propT("--chakra-brightness",$n.brightness),contrast:se.propT("--chakra-contrast",$n.contrast),hueRotate:se.degreeT("--chakra-hue-rotate"),invert:se.propT("--chakra-invert",$n.invert),saturate:se.propT("--chakra-saturate",$n.saturate),dropShadow:se.propT("--chakra-drop-shadow",$n.dropShadow),backdropFilter:{transform:$n.backdropFilter},backdropBlur:se.blur("--chakra-backdrop-blur"),backdropBrightness:se.propT("--chakra-backdrop-brightness",$n.brightness),backdropContrast:se.propT("--chakra-backdrop-contrast",$n.contrast),backdropHueRotate:se.degreeT("--chakra-backdrop-hue-rotate"),backdropInvert:se.propT("--chakra-backdrop-invert",$n.invert),backdropSaturate:se.propT("--chakra-backdrop-saturate",$n.saturate)},s_={alignItems:!0,alignContent:!0,justifyItems:!0,justifyContent:!0,flexWrap:!0,flexDirection:{transform:$n.flexDirection},experimental_spaceX:{static:Xwe,transform:cy({scale:"space",transform:e=>e!==null?{"--chakra-space-x":e}:null})},experimental_spaceY:{static:Ywe,transform:cy({scale:"space",transform:e=>e!=null?{"--chakra-space-y":e}:null})},flex:!0,flexFlow:!0,flexGrow:!0,flexShrink:!0,flexBasis:se.sizes("flexBasis"),justifySelf:!0,alignSelf:!0,order:!0,placeItems:!0,placeContent:!0,placeSelf:!0};Object.assign(s_,{flexDir:s_.flexDirection});var mV={gridGap:se.space("gridGap"),gridColumnGap:se.space("gridColumnGap"),gridRowGap:se.space("gridRowGap"),gridColumn:!0,gridRow:!0,gridAutoFlow:!0,gridAutoColumns:!0,gridColumnStart:!0,gridColumnEnd:!0,gridRowStart:!0,gridRowEnd:!0,gridAutoRows:!0,gridTemplate:!0,gridTemplateColumns:!0,gridTemplateRows:!0,gridTemplateAreas:!0,gridArea:!0},u2e={appearance:!0,cursor:!0,resize:!0,userSelect:!0,pointerEvents:!0,outline:{transform:$n.outline},outlineOffset:!0,outlineColor:se.colors("outlineColor")},ns={width:se.sizesT("width"),inlineSize:se.sizesT("inlineSize"),height:se.sizes("height"),blockSize:se.sizes("blockSize"),boxSize:se.sizes(["width","height"]),minWidth:se.sizes("minWidth"),minInlineSize:se.sizes("minInlineSize"),minHeight:se.sizes("minHeight"),minBlockSize:se.sizes("minBlockSize"),maxWidth:se.sizes("maxWidth"),maxInlineSize:se.sizes("maxInlineSize"),maxHeight:se.sizes("maxHeight"),maxBlockSize:se.sizes("maxBlockSize"),d:se.prop("display"),overflow:!0,overflowX:!0,overflowY:!0,overscrollBehavior:!0,overscrollBehaviorX:!0,overscrollBehaviorY:!0,display:!0,verticalAlign:!0,boxSizing:!0,boxDecorationBreak:!0,float:se.propT("float",$n.float),objectFit:!0,objectPosition:!0,visibility:!0,isolation:!0};Object.assign(ns,{w:ns.width,h:ns.height,minW:ns.minWidth,maxW:ns.maxWidth,minH:ns.minHeight,maxH:ns.maxHeight,overscroll:ns.overscrollBehavior,overscrollX:ns.overscrollBehaviorX,overscrollY:ns.overscrollBehaviorY});var l2e={listStyleType:!0,listStylePosition:!0,listStylePos:se.prop("listStylePosition"),listStyleImage:!0,listStyleImg:se.prop("listStyleImage")},c2e={border:"0px",clip:"rect(0, 0, 0, 0)",width:"1px",height:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"},f2e={position:"static",width:"auto",height:"auto",clip:"auto",padding:"0",margin:"0",overflow:"visible",whiteSpace:"normal"},ED=(e,t,n)=>{var r={},i=Y2(e,t,{});for(var a in i){var o=a in n&&n[a]!=null;o||(r[a]=i[a])}return r},d2e={srOnly:{transform(e){return e===!0?c2e:e==="focusable"?f2e:{}}},layerStyle:{processResult:!0,transform:(e,t,n)=>ED(t,"layerStyles."+e,n)},textStyle:{processResult:!0,transform:(e,t,n)=>ED(t,"textStyles."+e,n)},apply:{processResult:!0,transform:(e,t,n)=>ED(t,e,n)}},dy={position:!0,pos:se.prop("position"),zIndex:se.prop("zIndex","zIndices"),inset:se.spaceT(["top","right","bottom","left"]),insetX:se.spaceT(["left","right"]),insetInline:se.spaceT("insetInline"),insetY:se.spaceT(["top","bottom"]),insetBlock:se.spaceT("insetBlock"),top:se.spaceT("top"),insetBlockStart:se.spaceT("insetBlockStart"),bottom:se.spaceT("bottom"),insetBlockEnd:se.spaceT("insetBlockEnd"),left:se.spaceT("left"),insetInlineStart:se.logical({scale:"space",property:{ltr:"left",rtl:"right"}}),right:se.spaceT("right"),insetInlineEnd:se.logical({scale:"space",property:{ltr:"right",rtl:"left"}})};Object.assign(dy,{insetStart:dy.insetInlineStart,insetEnd:dy.insetInlineEnd});var h2e={ring:{transform:$n.ring},ringColor:se.colors("--chakra-ring-color"),ringOffset:se.prop("--chakra-ring-offset-width"),ringOffsetColor:se.colors("--chakra-ring-offset-color"),ringInset:se.prop("--chakra-ring-inset")},tr={margin:se.spaceT("margin"),marginTop:se.spaceT("marginTop"),marginBlockStart:se.spaceT("marginBlockStart"),marginRight:se.spaceT("marginRight"),marginInlineEnd:se.spaceT("marginInlineEnd"),marginBottom:se.spaceT("marginBottom"),marginBlockEnd:se.spaceT("marginBlockEnd"),marginLeft:se.spaceT("marginLeft"),marginInlineStart:se.spaceT("marginInlineStart"),marginX:se.spaceT(["marginInlineStart","marginInlineEnd"]),marginInline:se.spaceT("marginInline"),marginY:se.spaceT(["marginTop","marginBottom"]),marginBlock:se.spaceT("marginBlock"),padding:se.space("padding"),paddingTop:se.space("paddingTop"),paddingBlockStart:se.space("paddingBlockStart"),paddingRight:se.space("paddingRight"),paddingBottom:se.space("paddingBottom"),paddingBlockEnd:se.space("paddingBlockEnd"),paddingLeft:se.space("paddingLeft"),paddingInlineStart:se.space("paddingInlineStart"),paddingInlineEnd:se.space("paddingInlineEnd"),paddingX:se.space(["paddingInlineStart","paddingInlineEnd"]),paddingInline:se.space("paddingInline"),paddingY:se.space(["paddingTop","paddingBottom"]),paddingBlock:se.space("paddingBlock")};Object.assign(tr,{m:tr.margin,mt:tr.marginTop,mr:tr.marginRight,me:tr.marginInlineEnd,marginEnd:tr.marginInlineEnd,mb:tr.marginBottom,ml:tr.marginLeft,ms:tr.marginInlineStart,marginStart:tr.marginInlineStart,mx:tr.marginX,my:tr.marginY,p:tr.padding,pt:tr.paddingTop,py:tr.paddingY,px:tr.paddingX,pb:tr.paddingBottom,pl:tr.paddingLeft,ps:tr.paddingInlineStart,paddingStart:tr.paddingInlineStart,pr:tr.paddingRight,pe:tr.paddingInlineEnd,paddingEnd:tr.paddingInlineEnd});var p2e={textDecorationColor:se.colors("textDecorationColor"),textDecoration:!0,textDecor:{property:"textDecoration"},textDecorationLine:!0,textDecorationStyle:!0,textDecorationThickness:!0,textUnderlineOffset:!0,textShadow:se.shadows("textShadow")},g2e={clipPath:!0,transform:se.propT("transform",$n.transform),transformOrigin:!0,translateX:se.spaceT("--chakra-translate-x"),translateY:se.spaceT("--chakra-translate-y"),skewX:se.degreeT("--chakra-skew-x"),skewY:se.degreeT("--chakra-skew-y"),scaleX:se.prop("--chakra-scale-x"),scaleY:se.prop("--chakra-scale-y"),scale:se.prop(["--chakra-scale-x","--chakra-scale-y"]),rotate:se.degreeT("--chakra-rotate")},m2e={transition:!0,transitionDelay:!0,animation:!0,willChange:!0,transitionDuration:se.prop("transitionDuration","transition.duration"),transitionProperty:se.prop("transitionProperty","transition.property"),transitionTimingFunction:se.prop("transitionTimingFunction","transition.easing")},v2e={fontFamily:se.prop("fontFamily","fonts"),fontSize:se.prop("fontSize","fontSizes",$n.px),fontWeight:se.prop("fontWeight","fontWeights"),lineHeight:se.prop("lineHeight","lineHeights"),letterSpacing:se.prop("letterSpacing","letterSpacings"),textAlign:!0,fontStyle:!0,wordBreak:!0,overflowWrap:!0,textOverflow:!0,textTransform:!0,whiteSpace:!0,noOfLines:{static:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:"var(--chakra-line-clamp)"},property:"--chakra-line-clamp"},isTruncated:{transform(e){if(e===!0)return{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}}},Yg={hover:e=>e+":hover &, "+e+"[data-hover] &",focus:e=>e+":focus &, "+e+"[data-focus] &",active:e=>e+":active &, "+e+"[data-active] &",disabled:e=>e+":disabled &, "+e+"[data-disabled] &",invalid:e=>e+":invalid &, "+e+"[data-invalid] &",checked:e=>e+":checked &, "+e+"[data-checked] &",indeterminate:e=>e+":indeterminate &, "+e+"[aria-checked=mixed] &, "+e+"[data-indeterminate] &",readOnly:e=>e+":read-only &, "+e+"[readonly] &, "+e+"[data-read-only] &",expanded:e=>e+":read-only &, "+e+"[aria-expanded=true] &, "+e+"[data-expanded] &"},Zg=e=>y2e(e,"[role=group]","[data-group]",".group"),y2e=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.map(t).join(", ")},CD={_hover:"&:hover, &[data-hover]",_active:"&:active, &[data-active]",_focus:"&:focus, &[data-focus]",_highlighted:"&[data-highlighted]",_focusWithin:"&:focus-within",_focusVisible:"&:focus-visible",_disabled:"&[disabled], &[aria-disabled=true], &[data-disabled]",_readOnly:"&[aria-readonly=true], &[readonly], &[data-readonly]",_before:"&::before",_after:"&::after",_empty:"&:empty",_expanded:"&[aria-expanded=true], &[data-expanded]",_checked:"&[aria-checked=true], &[data-checked]",_grabbed:"&[aria-grabbed=true], &[data-grabbed]",_pressed:"&[aria-pressed=true], &[data-pressed]",_invalid:"&[aria-invalid=true], &[data-invalid]",_valid:"&[data-valid], &[data-state=valid]",_loading:"&[data-loading], &[aria-busy=true]",_selected:"&[aria-selected=true], &[data-selected]",_hidden:"&[hidden], &[data-hidden]",_autofill:"&:-webkit-autofill",_even:"&:nth-of-type(even)",_odd:"&:nth-of-type(odd)",_first:"&:first-of-type",_last:"&:last-of-type",_notFirst:"&:not(:first-of-type)",_notLast:"&:not(:last-of-type)",_visited:"&:visited",_activeLink:"&[aria-current=page]",_activeStep:"&[aria-current=step]",_indeterminate:"&:indeterminate, &[aria-checked=mixed], &[data-indeterminate]",_groupHover:Zg(Yg.hover),_groupFocus:Zg(Yg.focus),_groupActive:Zg(Yg.active),_groupDisabled:Zg(Yg.disabled),_groupInvalid:Zg(Yg.invalid),_groupChecked:Zg(Yg.checked),_placeholder:"&::placeholder",_fullScreen:"&:fullscreen",_selection:"&::selection",_rtl:"[dir=rtl] &",_mediaDark:"@media (prefers-color-scheme: dark)",_dark:".chakra-ui-dark &, [data-theme=dark] &, &[data-theme=dark]",_light:".chakra-ui-light &, [data-theme=light] &, &[data-theme=light]"},b2e=J2(CD);function AD(){return AD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},AD.apply(this,arguments)}var kD=Ru({},o_,kn,o2e,s_,ns,s2e,h2e,u2e,mV,d2e,dy,SD,tr,v2e,p2e,g2e,l2e,m2e),x2e=Object.assign({},tr,ns,s_,mV,dy),w2e=J2(x2e),_2e=[...J2(kD),...b2e],S2e=AD({},kD,CD),E2e=e=>e in S2e,C2e=e=>t=>{if(!t.__breakpoints)return e;var{isResponsive:n,toArrayValue:r,media:i}=t.__breakpoints,a={};for(var o in e){var s=Ms(e[o],t);if(s!=null){if(s=Du(s)&&n(s)?r(s):s,!Array.isArray(s)){a[o]=s;continue}for(var u=s.slice(0,i.length).length,l=0;l<u;l+=1){var c=i==null?void 0:i[l];if(!c){a[o]=s[l];continue}a[c]=a[c]||{},s[l]!=null&&(a[c][o]=s[l])}}}return a},A2e=(e,t)=>e.startsWith("--")&&nD(t)&&!HW(t),k2e=(e,t)=>{var n,r;if(t==null)return t;var i=l=>{var c,f;return(c=e.__cssMap)==null||(f=c[l])==null?void 0:f.varRef},a=l=>{var c;return(c=i(l))!=null?c:l},o=t.split(",").map(l=>l.trim()),[s,u]=o;return t=(n=(r=i(s))!=null?r:a(u))!=null?n:a(t),t};function T2e(e){var{configs:t={},pseudos:n={},theme:r}=e,i=function a(o,s){s===void 0&&(s=!1);var u=Ms(o,r),l=C2e(u)(r),c={};for(var f in l){var d,h,p,g,m,v=l[f],y=Ms(v,r);f in n&&(f=n[f]),A2e(f,y)&&(y=k2e(r,y));var b=t[f];if(b===!0&&(b={property:f}),Du(y)){var x;c[f]=(x=c[f])!=null?x:{},c[f]=Ru({},c[f],a(y,!0));continue}var w=(d=(h=b)==null||h.transform==null?void 0:h.transform(y,r,u))!=null?d:y;w=(p=b)!=null&&p.processResult?a(w,!0):w;var S=Ms((g=b)==null?void 0:g.property,r);if(!s&&(m=b)!=null&&m.static){var C=Ms(b.static,r);c=Ru({},c,C)}if(S&&Array.isArray(S)){for(var _ of S)c[_]=w;continue}if(S){S==="&"&&Du(w)?c=Ru({},c,w):c[S]=w;continue}if(Du(w)){c=Ru({},c,w);continue}c[f]=w}return c};return i}var vV=e=>t=>{var n=T2e({theme:t,pseudos:CD,configs:kD});return n(e)};function yV(e){return Du(e)&&e.reference?e.reference:String(e)}var u_=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.map(yV).join(" "+t+" ").replace(/calc/g,"")},bV=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return"calc("+u_("+",...n)+")"},xV=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return"calc("+u_("-",...n)+")"},TD=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return"calc("+u_("*",...n)+")"},wV=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return"calc("+u_("/",...n)+")"},_V=e=>{var t=yV(e);return t!=null&&!Number.isNaN(parseFloat(t))?String(t).startsWith("-")?String(t).slice(1):"-"+t:TD(t,-1)},yh=Object.assign(e=>({add:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yh(bV(e,...r))},subtract:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yh(xV(e,...r))},multiply:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yh(TD(e,...r))},divide:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yh(wV(e,...r))},negate:()=>yh(_V(e)),toString:()=>e.toString()}),{add:bV,subtract:xV,multiply:TD,divide:wV,negate:_V});function O2e(e,t){return t===void 0&&(t="-"),e.replace(/\s+/g,t)}function SV(e){var t=O2e(e.toString());if(t.includes("\\."))return e;var n=!Number.isInteger(parseFloat(e.toString()));return n?t.replace(".","\\."):e}function I2e(e,t){return t===void 0&&(t=""),[t,SV(e)].filter(Boolean).join("-")}function N2e(e,t){return"var("+SV(e)+(t?", "+t:"")+")"}function D2e(e,t){return t===void 0&&(t=""),"--"+I2e(e,t)}function EV(e,t,n){var r=D2e(e,n);return{variable:r,reference:N2e(r,t)}}function OD(){return OD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},OD.apply(this,arguments)}function R2e(e,t){var n={cssMap:{},cssVars:{}};return vwe(e,(r,i)=>{var a,[o]=i,s=(a=ID[o])!=null?a:ID.defaultHandler,{cssVars:u,cssMap:l}=s(i,r,t);Object.assign(n.cssVars,u),Object.assign(n.cssMap,l)}),n}var ID={space:(e,t,n)=>{var r=ID.defaultHandler(e,t,n),[i,...a]=e,o=i+".-"+a.join("."),s=e.join("-"),{variable:u,reference:l}=EV(s,void 0,n.cssVarPrefix),c=yh.negate(t),f=yh.negate(l);return{cssVars:r.cssVars,cssMap:OD({},r.cssMap,{[o]:{value:""+c,var:""+u,varRef:f}})}},defaultHandler:(e,t,n)=>{var r=e.join("."),i=e.join("-"),{variable:a,reference:o}=EV(i,void 0,n.cssVarPrefix);return{cssVars:{[a]:t},cssMap:{[r]:{value:t,var:a,varRef:o}}}}};function F2e(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var M2e=["colors","borders","borderWidths","borderStyles","fonts","fontSizes","fontWeights","letterSpacings","lineHeights","radii","space","shadows","sizes","zIndices","transition","blur"];function P2e(e){var t=M2e;return Bxe(e,t)}function $2e(e){var t=F2e(e,["__cssMap","__cssVars","__breakpoints"]);return t}function ND(){return ND=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ND.apply(this,arguments)}function L2e(e){var t,n=$2e(e),r=P2e(n),i=(t=n.config)==null?void 0:t.cssVarPrefix,{cssMap:a,cssVars:o}=R2e(r,{cssVarPrefix:i}),s={"--chakra-ring-inset":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-ring-offset-width":"0px","--chakra-ring-offset-color":"#fff","--chakra-ring-color":"rgba(66, 153, 225, 0.6)","--chakra-ring-offset-shadow":"0 0 #0000","--chakra-ring-shadow":"0 0 #0000","--chakra-space-x-reverse":"0","--chakra-space-y-reverse":"0"};return Object.assign(n,{__cssVars:ND({},s,o),__cssMap:a,__breakpoints:Gxe(n.breakpoints)}),n}var B2e=typeof Element!="undefined",z2e=typeof Map=="function",j2e=typeof Set=="function",U2e=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function l_(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var n,r,i;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!=0;)if(!l_(e[r],t[r]))return!1;return!0}var a;if(z2e&&e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(a=e.entries();!(r=a.next()).done;)if(!t.has(r.value[0]))return!1;for(a=e.entries();!(r=a.next()).done;)if(!l_(r.value[1],t.get(r.value[0])))return!1;return!0}if(j2e&&e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(a=e.entries();!(r=a.next()).done;)if(!t.has(r.value[0]))return!1;return!0}if(U2e&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(n=e.length,n!=t.length)return!1;for(r=n;r--!=0;)if(e[r]!==t[r])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(i=Object.keys(e),n=i.length,n!==Object.keys(t).length)return!1;for(r=n;r--!=0;)if(!Object.prototype.hasOwnProperty.call(t,i[r]))return!1;if(B2e&&e instanceof Element)return!1;for(r=n;r--!=0;)if(!((i[r]==="_owner"||i[r]==="__v"||i[r]==="__o")&&e.$$typeof)&&!l_(e[i[r]],t[i[r]]))return!1;return!0}return e!==e&&t!==t}var W2e=function(t,n){try{return l_(t,n)}catch(r){if((r.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw r}},V2e=e=>{var{cssVarsRoot:t=":host, :root",theme:n,children:r}=e,i=xr(()=>L2e(n),[n]);return ue(Fxe,{theme:i},ue(eD,{styles:a=>({[t]:a.__cssVars})}),r)};function CV(){var e=Un(ry);if(!e)throw Error("useTheme: `theme` is undefined. Seems you forgot to wrap your app in `<ChakraProvider />` or `<ThemeProvider />`");return e}var[hy,vi]=Mu({name:"StylesContext",errorMessage:"useStyles: `styles` is undefined. Seems you forgot to wrap the components in `<StylesProvider />` "}),q2e=()=>{var{colorMode:e}=vD();return ue(eD,{styles:t=>{var n=Y2(t,"styles.global"),r=Ms(n,{theme:t,colorMode:e});if(!!r){var i=vV(r)(t);return i}}})},H2e=["a","b","article","aside","blockquote","button","caption","cite","circle","code","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hr","img","input","kbd","label","li","main","mark","nav","ol","p","path","pre","q","rect","s","svg","section","select","strong","small","span","sub","sup","table","tbody","td","textarea","tfoot","th","thead","tr","ul"];function Ao(e){return iD(e,["styleConfig","size","variant","colorScheme"])}function DD(){return DD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},DD.apply(this,arguments)}function G2e(){var e=vD(),t=CV();return DD({},e,{theme:t})}var K2e=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,X2e=IW(function(e){return K2e.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91}),Y2e=X2e,Z2e=function(t){return t!=="theme"},AV=function(t){return typeof t=="string"&&t.charCodeAt(0)>96?Y2e:Z2e},kV=function(t,n,r){var i;if(n){var a=n.shouldForwardProp;i=t.__emotion_forwardProp&&a?function(o){return t.__emotion_forwardProp(o)&&a(o)}:a}return typeof i!="function"&&r&&(i=t.__emotion_forwardProp),i},J2e=function e(t,n){var r=t.__emotion_real===t,i=r&&t.__emotion_base||t,a,o;n!==void 0&&(a=n.label,o=n.target);var s=kV(t,n,r),u=s||AV(i),l=!u("as");return function(){var c=arguments,f=r&&t.__emotion_styles!==void 0?t.__emotion_styles.slice(0):[];if(a!==void 0&&f.push("label:"+a+";"),c[0]==null||c[0].raw===void 0)f.push.apply(f,c);else{f.push(c[0][0]);for(var d=c.length,h=1;h<d;h++)f.push(c[h],c[0][h])}var p=UW(function(g,m,v){var y=l&&g.as||i,b="",x=[],w=g;if(g.theme==null){w={};for(var S in g)w[S]=g[S];w.theme=Un(ry)}typeof g.className=="string"?b=Axe(m.registered,x,g.className):g.className!=null&&(b=g.className+" ");var C=QN(f.concat(x),m.registered,w);PW(m,C,typeof y=="string"),b+=m.key+"-"+C.name,o!==void 0&&(b+=" "+o);var _=l&&s===void 0?AV(y):u,E={};for(var A in g)l&&A==="as"||_(A)&&(E[A]=g[A]);E.className=b,E.ref=v;var k=ue(y,E);return k});return p.displayName=a!==void 0?a:"Styled("+(typeof i=="string"?i:i.displayName||i.name||"Component")+")",p.defaultProps=t.defaultProps,p.__emotion_real=p,p.__emotion_base=i,p.__emotion_styles=f,p.__emotion_forwardProp=s,Object.defineProperty(p,"toString",{value:function(){return"."+o}}),p.withComponent=function(g,m){return e(g,vh({},n,m,{shouldForwardProp:kV(p,m,!0)})).apply(void 0,f)},p}},Q2e=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],RD=J2e.bind();Q2e.forEach(function(e){RD[e]=RD(e)});var e_e=new Set([..._2e,"textStyle","layerStyle","apply","isTruncated","noOfLines","focusBorderColor","errorBorderColor","as","__css","css","sx"]),t_e=new Set(["htmlWidth","htmlHeight","htmlSize"]),n_e=e=>t_e.has(e)||!e_e.has(e);function TV(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var r_e=e=>{var{baseStyle:t}=e;return n=>{var{css:r,__css:i,sx:a}=n,o=TV(n,["theme","css","__css","sx"]),s=GW(o,(f,d)=>E2e(d)),u=Ms(t,n),l=Object.assign({},i,u,Z2(s),a),c=vV(l)(n.theme);return r?[c,r]:c}};function i_e(e,t){var n=t??{},{baseStyle:r}=n,i=TV(n,["baseStyle"]);i.shouldForwardProp||(i.shouldForwardProp=n_e);var a=r_e({baseStyle:r});return RD(e,i)(a)}var xt=i_e;H2e.forEach(e=>{xt[e]=xt(e)});function Mt(e){return Gl(e)}function a_e(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function bh(e,t,n){var r,i;t===void 0&&(t={}),n===void 0&&(n={});var{styleConfig:a}=t,o=a_e(t,["styleConfig"]),{theme:s,colorMode:u}=G2e(),l=Y2(s,"components."+e),c=a||l,f=Ru({theme:s,colorMode:u},(r=c==null?void 0:c.defaultProps)!=null?r:{},Z2(iD(o,["children"]))),d=Jt({});return xr(()=>{if(c){var h,p,g,m,v,y,b=Ms((h=c.baseStyle)!=null?h:{},f),x=Ms((p=(g=c.variants)==null?void 0:g[f.variant])!=null?p:{},f),w=Ms((m=(v=c.sizes)==null?void 0:v[f.size])!=null?m:{},f),S=Ru({},b,w,x);(y=n)!=null&&y.isMultiPart&&c.parts&&c.parts.forEach(_=>{var E;S[_]=(E=S[_])!=null?E:{}});var C=W2e(d.current,S);C||(d.current=S)}return d.current},[c,f,(i=n)==null?void 0:i.isMultiPart])}function mf(e,t){return bh(e,t,{isMultiPart:!0})}var o_e=["container","button","panel","icon"],s_e={borderTopWidth:"1px",borderColor:"inherit",_last:{borderBottomWidth:"1px"}},u_e={transitionProperty:"common",transitionDuration:"normal",fontSize:"1rem",_focus:{boxShadow:"outline"},_hover:{bg:"blackAlpha.50"},_disabled:{opacity:.4,cursor:"not-allowed"},px:4,py:2},l_e={pt:2,px:4,pb:5},c_e={fontSize:"1.25em"},f_e={container:s_e,button:u_e,panel:l_e,icon:c_e},d_e={parts:o_e,baseStyle:f_e},OV={exports:{}};(function(e){(function(t){var n=/^\s+/,r=/\s+$/,i=0,a=t.round,o=t.min,s=t.max,u=t.random;function l(M,B){if(M=M||"",B=B||{},M instanceof l)return M;if(!(this instanceof l))return new l(M,B);var R=c(M);this._originalInput=M,this._r=R.r,this._g=R.g,this._b=R.b,this._a=R.a,this._roundA=a(100*this._a)/100,this._format=B.format||R.format,this._gradientType=B.gradientType,this._r<1&&(this._r=a(this._r)),this._g<1&&(this._g=a(this._g)),this._b<1&&(this._b=a(this._b)),this._ok=R.ok,this._tc_id=i++}l.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var M=this.toRgb();return(M.r*299+M.g*587+M.b*114)/1e3},getLuminance:function(){var M=this.toRgb(),B,R,X,ge,xe,ze;return B=M.r/255,R=M.g/255,X=M.b/255,B<=.03928?ge=B/12.92:ge=t.pow((B+.055)/1.055,2.4),R<=.03928?xe=R/12.92:xe=t.pow((R+.055)/1.055,2.4),X<=.03928?ze=X/12.92:ze=t.pow((X+.055)/1.055,2.4),.2126*ge+.7152*xe+.0722*ze},setAlpha:function(M){return this._a=G(M),this._roundA=a(100*this._a)/100,this},toHsv:function(){var M=p(this._r,this._g,this._b);return{h:M.h*360,s:M.s,v:M.v,a:this._a}},toHsvString:function(){var M=p(this._r,this._g,this._b),B=a(M.h*360),R=a(M.s*100),X=a(M.v*100);return this._a==1?"hsv("+B+", "+R+"%, "+X+"%)":"hsva("+B+", "+R+"%, "+X+"%, "+this._roundA+")"},toHsl:function(){var M=d(this._r,this._g,this._b);return{h:M.h*360,s:M.s,l:M.l,a:this._a}},toHslString:function(){var M=d(this._r,this._g,this._b),B=a(M.h*360),R=a(M.s*100),X=a(M.l*100);return this._a==1?"hsl("+B+", "+R+"%, "+X+"%)":"hsla("+B+", "+R+"%, "+X+"%, "+this._roundA+")"},toHex:function(M){return m(this._r,this._g,this._b,M)},toHexString:function(M){return"#"+this.toHex(M)},toHex8:function(M){return v(this._r,this._g,this._b,this._a,M)},toHex8String:function(M){return"#"+this.toHex8(M)},toRgb:function(){return{r:a(this._r),g:a(this._g),b:a(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+a(this._r)+", "+a(this._g)+", "+a(this._b)+")":"rgba("+a(this._r)+", "+a(this._g)+", "+a(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:a(K(this._r,255)*100)+"%",g:a(K(this._g,255)*100)+"%",b:a(K(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+a(K(this._r,255)*100)+"%, "+a(K(this._g,255)*100)+"%, "+a(K(this._b,255)*100)+"%)":"rgba("+a(K(this._r,255)*100)+"%, "+a(K(this._g,255)*100)+"%, "+a(K(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:L[m(this._r,this._g,this._b,!0)]||!1},toFilter:function(M){var B="#"+y(this._r,this._g,this._b,this._a),R=B,X=this._gradientType?"GradientType = 1, ":"";if(M){var ge=l(M);R="#"+y(ge._r,ge._g,ge._b,ge._a)}return"progid:DXImageTransform.Microsoft.gradient("+X+"startColorstr="+B+",endColorstr="+R+")"},toString:function(M){var B=!!M;M=M||this._format;var R=!1,X=this._a<1&&this._a>=0,ge=!B&&X&&(M==="hex"||M==="hex6"||M==="hex3"||M==="hex4"||M==="hex8"||M==="name");return ge?M==="name"&&this._a===0?this.toName():this.toRgbString():(M==="rgb"&&(R=this.toRgbString()),M==="prgb"&&(R=this.toPercentageRgbString()),(M==="hex"||M==="hex6")&&(R=this.toHexString()),M==="hex3"&&(R=this.toHexString(!0)),M==="hex4"&&(R=this.toHex8String(!0)),M==="hex8"&&(R=this.toHex8String()),M==="name"&&(R=this.toName()),M==="hsl"&&(R=this.toHslString()),M==="hsv"&&(R=this.toHsvString()),R||this.toHexString())},clone:function(){return l(this.toString())},_applyModification:function(M,B){var R=M.apply(null,[this].concat([].slice.call(B)));return this._r=R._r,this._g=R._g,this._b=R._b,this.setAlpha(R._a),this},lighten:function(){return this._applyModification(S,arguments)},brighten:function(){return this._applyModification(C,arguments)},darken:function(){return this._applyModification(_,arguments)},desaturate:function(){return this._applyModification(b,arguments)},saturate:function(){return this._applyModification(x,arguments)},greyscale:function(){return this._applyModification(w,arguments)},spin:function(){return this._applyModification(E,arguments)},_applyCombination:function(M,B){return M.apply(null,[this].concat([].slice.call(B)))},analogous:function(){return this._applyCombination(N,arguments)},complement:function(){return this._applyCombination(A,arguments)},monochromatic:function(){return this._applyCombination(O,arguments)},splitcomplement:function(){return this._applyCombination(I,arguments)},triad:function(){return this._applyCombination(k,arguments)},tetrad:function(){return this._applyCombination(T,arguments)}},l.fromRatio=function(M,B){if(typeof M=="object"){var R={};for(var X in M)M.hasOwnProperty(X)&&(X==="a"?R[X]=M[X]:R[X]=De(M[X]));M=R}return l(M,B)};function c(M){var B={r:0,g:0,b:0},R=1,X=null,ge=null,xe=null,ze=!1,Ke=!1;return typeof M=="string"&&(M=ae(M)),typeof M=="object"&&(V(M.r)&&V(M.g)&&V(M.b)?(B=f(M.r,M.g,M.b),ze=!0,Ke=String(M.r).substr(-1)==="%"?"prgb":"rgb"):V(M.h)&&V(M.s)&&V(M.v)?(X=De(M.s),ge=De(M.v),B=g(M.h,X,ge),ze=!0,Ke="hsv"):V(M.h)&&V(M.s)&&V(M.l)&&(X=De(M.s),xe=De(M.l),B=h(M.h,X,xe),ze=!0,Ke="hsl"),M.hasOwnProperty("a")&&(R=M.a)),R=G(R),{ok:ze,format:M.format||Ke,r:o(255,s(B.r,0)),g:o(255,s(B.g,0)),b:o(255,s(B.b,0)),a:R}}function f(M,B,R){return{r:K(M,255)*255,g:K(B,255)*255,b:K(R,255)*255}}function d(M,B,R){M=K(M,255),B=K(B,255),R=K(R,255);var X=s(M,B,R),ge=o(M,B,R),xe,ze,Ke=(X+ge)/2;if(X==ge)xe=ze=0;else{var Ze=X-ge;switch(ze=Ke>.5?Ze/(2-X-ge):Ze/(X+ge),X){case M:xe=(B-R)/Ze+(B<R?6:0);break;case B:xe=(R-M)/Ze+2;break;case R:xe=(M-B)/Ze+4;break}xe/=6}return{h:xe,s:ze,l:Ke}}function h(M,B,R){var X,ge,xe;M=K(M,360),B=K(B,100),R=K(R,100);function ze(Bt,Je,Zt){return Zt<0&&(Zt+=1),Zt>1&&(Zt-=1),Zt<1/6?Bt+(Je-Bt)*6*Zt:Zt<1/2?Je:Zt<2/3?Bt+(Je-Bt)*(2/3-Zt)*6:Bt}if(B===0)X=ge=xe=R;else{var Ke=R<.5?R*(1+B):R+B-R*B,Ze=2*R-Ke;X=ze(Ze,Ke,M+1/3),ge=ze(Ze,Ke,M),xe=ze(Ze,Ke,M-1/3)}return{r:X*255,g:ge*255,b:xe*255}}function p(M,B,R){M=K(M,255),B=K(B,255),R=K(R,255);var X=s(M,B,R),ge=o(M,B,R),xe,ze,Ke=X,Ze=X-ge;if(ze=X===0?0:Ze/X,X==ge)xe=0;else{switch(X){case M:xe=(B-R)/Ze+(B<R?6:0);break;case B:xe=(R-M)/Ze+2;break;case R:xe=(M-B)/Ze+4;break}xe/=6}return{h:xe,s:ze,v:Ke}}function g(M,B,R){M=K(M,360)*6,B=K(B,100),R=K(R,100);var X=t.floor(M),ge=M-X,xe=R*(1-B),ze=R*(1-ge*B),Ke=R*(1-(1-ge)*B),Ze=X%6,Bt=[R,ze,xe,xe,Ke,R][Ze],Je=[Ke,R,R,ze,xe,xe][Ze],Zt=[xe,xe,Ke,R,R,ze][Ze];return{r:Bt*255,g:Je*255,b:Zt*255}}function m(M,B,R,X){var ge=[Te(a(M).toString(16)),Te(a(B).toString(16)),Te(a(R).toString(16))];return X&&ge[0].charAt(0)==ge[0].charAt(1)&&ge[1].charAt(0)==ge[1].charAt(1)&&ge[2].charAt(0)==ge[2].charAt(1)?ge[0].charAt(0)+ge[1].charAt(0)+ge[2].charAt(0):ge.join("")}function v(M,B,R,X,ge){var xe=[Te(a(M).toString(16)),Te(a(B).toString(16)),Te(a(R).toString(16)),Te(me(X))];return ge&&xe[0].charAt(0)==xe[0].charAt(1)&&xe[1].charAt(0)==xe[1].charAt(1)&&xe[2].charAt(0)==xe[2].charAt(1)&&xe[3].charAt(0)==xe[3].charAt(1)?xe[0].charAt(0)+xe[1].charAt(0)+xe[2].charAt(0)+xe[3].charAt(0):xe.join("")}function y(M,B,R,X){var ge=[Te(me(X)),Te(a(M).toString(16)),Te(a(B).toString(16)),Te(a(R).toString(16))];return ge.join("")}l.equals=function(M,B){return!M||!B?!1:l(M).toRgbString()==l(B).toRgbString()},l.random=function(){return l.fromRatio({r:u(),g:u(),b:u()})};function b(M,B){B=B===0?0:B||10;var R=l(M).toHsl();return R.s-=B/100,R.s=ee(R.s),l(R)}function x(M,B){B=B===0?0:B||10;var R=l(M).toHsl();return R.s+=B/100,R.s=ee(R.s),l(R)}function w(M){return l(M).desaturate(100)}function S(M,B){B=B===0?0:B||10;var R=l(M).toHsl();return R.l+=B/100,R.l=ee(R.l),l(R)}function C(M,B){B=B===0?0:B||10;var R=l(M).toRgb();return R.r=s(0,o(255,R.r-a(255*-(B/100)))),R.g=s(0,o(255,R.g-a(255*-(B/100)))),R.b=s(0,o(255,R.b-a(255*-(B/100)))),l(R)}function _(M,B){B=B===0?0:B||10;var R=l(M).toHsl();return R.l-=B/100,R.l=ee(R.l),l(R)}function E(M,B){var R=l(M).toHsl(),X=(R.h+B)%360;return R.h=X<0?360+X:X,l(R)}function A(M){var B=l(M).toHsl();return B.h=(B.h+180)%360,l(B)}function k(M){var B=l(M).toHsl(),R=B.h;return[l(M),l({h:(R+120)%360,s:B.s,l:B.l}),l({h:(R+240)%360,s:B.s,l:B.l})]}function T(M){var B=l(M).toHsl(),R=B.h;return[l(M),l({h:(R+90)%360,s:B.s,l:B.l}),l({h:(R+180)%360,s:B.s,l:B.l}),l({h:(R+270)%360,s:B.s,l:B.l})]}function I(M){var B=l(M).toHsl(),R=B.h;return[l(M),l({h:(R+72)%360,s:B.s,l:B.l}),l({h:(R+216)%360,s:B.s,l:B.l})]}function N(M,B,R){B=B||6,R=R||30;var X=l(M).toHsl(),ge=360/R,xe=[l(M)];for(X.h=(X.h-(ge*B>>1)+720)%360;--B;)X.h=(X.h+ge)%360,xe.push(l(X));return xe}function O(M,B){B=B||6;for(var R=l(M).toHsv(),X=R.h,ge=R.s,xe=R.v,ze=[],Ke=1/B;B--;)ze.push(l({h:X,s:ge,v:xe})),xe=(xe+Ke)%1;return ze}l.mix=function(M,B,R){R=R===0?0:R||50;var X=l(M).toRgb(),ge=l(B).toRgb(),xe=R/100,ze={r:(ge.r-X.r)*xe+X.r,g:(ge.g-X.g)*xe+X.g,b:(ge.b-X.b)*xe+X.b,a:(ge.a-X.a)*xe+X.a};return l(ze)},l.readability=function(M,B){var R=l(M),X=l(B);return(t.max(R.getLuminance(),X.getLuminance())+.05)/(t.min(R.getLuminance(),X.getLuminance())+.05)},l.isReadable=function(M,B,R){var X=l.readability(M,B),ge,xe;switch(xe=!1,ge=Y(R),ge.level+ge.size){case"AAsmall":case"AAAlarge":xe=X>=4.5;break;case"AAlarge":xe=X>=3;break;case"AAAsmall":xe=X>=7;break}return xe},l.mostReadable=function(M,B,R){var X=null,ge=0,xe,ze,Ke,Ze;R=R||{},ze=R.includeFallbackColors,Ke=R.level,Ze=R.size;for(var Bt=0;Bt<B.length;Bt++)xe=l.readability(M,B[Bt]),xe>ge&&(ge=xe,X=l(B[Bt]));return l.isReadable(M,X,{level:Ke,size:Ze})||!ze?X:(R.includeFallbackColors=!1,l.mostReadable(M,["#fff","#000"],R))};var D=l.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},L=l.hexNames=W(D);function W(M){var B={};for(var R in M)M.hasOwnProperty(R)&&(B[M[R]]=R);return B}function G(M){return M=parseFloat(M),(isNaN(M)||M<0||M>1)&&(M=1),M}function K(M,B){he(M)&&(M="100%");var R=Oe(M);return M=o(B,s(0,parseFloat(M))),R&&(M=parseInt(M*B,10)/100),t.abs(M-B)<1e-6?1:M%B/parseFloat(B)}function ee(M){return o(1,s(0,M))}function ce(M){return parseInt(M,16)}function he(M){return typeof M=="string"&&M.indexOf(".")!=-1&&parseFloat(M)===1}function Oe(M){return typeof M=="string"&&M.indexOf("%")!=-1}function Te(M){return M.length==1?"0"+M:""+M}function De(M){return M<=1&&(M=M*100+"%"),M}function me(M){return t.round(parseFloat(M)*255).toString(16)}function P(M){return ce(M)/255}var F=function(){var M="[-\\+]?\\d+%?",B="[-\\+]?\\d*\\.\\d+%?",R="(?:"+B+")|(?:"+M+")",X="[\\s|\\(]+("+R+")[,|\\s]+("+R+")[,|\\s]+("+R+")\\s*\\)?",ge="[\\s|\\(]+("+R+")[,|\\s]+("+R+")[,|\\s]+("+R+")[,|\\s]+("+R+")\\s*\\)?";return{CSS_UNIT:new RegExp(R),rgb:new RegExp("rgb"+X),rgba:new RegExp("rgba"+ge),hsl:new RegExp("hsl"+X),hsla:new RegExp("hsla"+ge),hsv:new RegExp("hsv"+X),hsva:new RegExp("hsva"+ge),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function V(M){return!!F.CSS_UNIT.exec(M)}function ae(M){M=M.replace(n,"").replace(r,"").toLowerCase();var B=!1;if(D[M])M=D[M],B=!0;else if(M=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var R;return(R=F.rgb.exec(M))?{r:R[1],g:R[2],b:R[3]}:(R=F.rgba.exec(M))?{r:R[1],g:R[2],b:R[3],a:R[4]}:(R=F.hsl.exec(M))?{h:R[1],s:R[2],l:R[3]}:(R=F.hsla.exec(M))?{h:R[1],s:R[2],l:R[3],a:R[4]}:(R=F.hsv.exec(M))?{h:R[1],s:R[2],v:R[3]}:(R=F.hsva.exec(M))?{h:R[1],s:R[2],v:R[3],a:R[4]}:(R=F.hex8.exec(M))?{r:ce(R[1]),g:ce(R[2]),b:ce(R[3]),a:P(R[4]),format:B?"name":"hex8"}:(R=F.hex6.exec(M))?{r:ce(R[1]),g:ce(R[2]),b:ce(R[3]),format:B?"name":"hex"}:(R=F.hex4.exec(M))?{r:ce(R[1]+""+R[1]),g:ce(R[2]+""+R[2]),b:ce(R[3]+""+R[3]),a:P(R[4]+""+R[4]),format:B?"name":"hex8"}:(R=F.hex3.exec(M))?{r:ce(R[1]+""+R[1]),g:ce(R[2]+""+R[2]),b:ce(R[3]+""+R[3]),format:B?"name":"hex"}:!1}function Y(M){var B,R;return M=M||{level:"AA",size:"small"},B=(M.level||"AA").toUpperCase(),R=(M.size||"small").toLowerCase(),B!=="AA"&&B!=="AAA"&&(B="AA"),R!=="small"&&R!=="large"&&(R="small"),{level:B,size:R}}e.exports?e.exports=l:window.tinycolor=l})(Math)})(OV);var c_=OV.exports,ni=(e,t,n)=>{var r=Y2(e,"colors."+t,t),i=c_(r).isValid();return i?r:n},h_e=e=>t=>{var n=ni(t,e),r=c_(n).isDark();return r?"dark":"light"},p_e=e=>t=>h_e(e)(t)==="dark",Jg=(e,t)=>n=>{var r=ni(n,e);return c_(r).setAlpha(t).toRgbString()};function IV(e,t){return e===void 0&&(e="1rem"),t===void 0&&(t="rgba(255, 255, 255, 0.15)"),{backgroundImage:`linear-gradient(
    45deg,
    `+t+` 25%,
    transparent 25%,
    transparent 50%,
    `+t+` 50%,
    `+t+` 75%,
    transparent 75%,
    transparent
  )`,backgroundSize:e+" "+e}}function g_e(e){var t=c_.random().toHexString();return!e||Lxe(e)?t:e.string&&e.colors?v_e(e.string,e.colors):e.string&&!e.colors?m_e(e.string):e.colors&&!e.string?y_e(e.colors):t}function m_e(e){var t=0;if(e.length===0)return t.toString();for(var n=0;n<e.length;n+=1)t=e.charCodeAt(n)+((t<<5)-t),t=t&t;for(var r="#",i=0;i<3;i+=1){var a=t>>i*8&255;r+=("00"+a.toString(16)).substr(-2)}return r}function v_e(e,t){var n=0;if(e.length===0)return t[0];for(var r=0;r<e.length;r+=1)n=e.charCodeAt(r)+((n<<5)-n),n=n&n;return n=(n%t.length+t.length)%t.length,t[n]}function y_e(e){return e[Math.floor(Math.random()*e.length)]}function Ae(e,t){return n=>n.colorMode==="dark"?t:e}function py(e){var{orientation:t,vertical:n,horizontal:r}=e;return t?t==="vertical"?n:r:{}}function FD(){return FD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},FD.apply(this,arguments)}var b_e=e=>(uD({condition:!0,message:["[chakra-ui]: createBreakpoints(...) will be deprecated pretty soon","simply pass the breakpoints as an object. Remove the createBreakpoint(..) call"].join("")}),FD({base:"0em"},e)),x_e=["container","title","description","icon"],w_e={container:{px:4,py:3},title:{fontWeight:"bold",lineHeight:6,marginEnd:2},description:{lineHeight:6},icon:{flexShrink:0,marginEnd:3,w:5,h:6}};function MD(e){var{theme:t,colorScheme:n}=e,r=ni(t,n+".100",n),i=Jg(n+".200",.16)(t);return Ae(r,i)(e)}function __e(e){var{colorScheme:t}=e;return{container:{bg:MD(e)},icon:{color:Ae(t+".500",t+".200")(e)}}}function S_e(e){var{colorScheme:t}=e;return{container:{paddingStart:3,borderStartWidth:"4px",borderStartColor:Ae(t+".500",t+".200")(e),bg:MD(e)},icon:{color:Ae(t+".500",t+".200")(e)}}}function E_e(e){var{colorScheme:t}=e;return{container:{pt:2,borderTopWidth:"4px",borderTopColor:Ae(t+".500",t+".200")(e),bg:MD(e)},icon:{color:Ae(t+".500",t+".200")(e)}}}function C_e(e){var{colorScheme:t}=e;return{container:{bg:Ae(t+".500",t+".200")(e),color:Ae("white","gray.900")(e)}}}var A_e={subtle:__e,"left-accent":S_e,"top-accent":E_e,solid:C_e},k_e={variant:"subtle",colorScheme:"blue"},T_e={parts:x_e,baseStyle:w_e,variants:A_e,defaultProps:k_e},NV={px:"1px",.5:"0.125rem",1:"0.25rem",1.5:"0.375rem",2:"0.5rem",2.5:"0.625rem",3:"0.75rem",3.5:"0.875rem",4:"1rem",5:"1.25rem",6:"1.5rem",7:"1.75rem",8:"2rem",9:"2.25rem",10:"2.5rem",12:"3rem",14:"3.5rem",16:"4rem",20:"5rem",24:"6rem",28:"7rem",32:"8rem",36:"9rem",40:"10rem",44:"11rem",48:"12rem",52:"13rem",56:"14rem",60:"15rem",64:"16rem",72:"18rem",80:"20rem",96:"24rem"};function PD(){return PD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},PD.apply(this,arguments)}var O_e={max:"max-content",min:"min-content",full:"100%","3xs":"14rem","2xs":"16rem",xs:"20rem",sm:"24rem",md:"28rem",lg:"32rem",xl:"36rem","2xl":"42rem","3xl":"48rem","4xl":"56rem","5xl":"64rem","6xl":"72rem","7xl":"80rem","8xl":"90rem"},I_e={sm:"640px",md:"768px",lg:"1024px",xl:"1280px"},DV=PD({},NV,O_e,{container:I_e}),N_e=["container","excessLabel","badge","label"];function D_e(e){return{transform:"translate(25%, 25%)",borderRadius:"full",border:"0.2em solid",borderColor:Ae("white","gray.800")(e)}}function R_e(e){return{bg:Ae("gray.200","whiteAlpha.400")(e)}}function F_e(e){var{name:t,theme:n}=e,r=t?g_e({string:t}):"gray.400",i=p_e(r)(n),a="white";i||(a="gray.800");var o=Ae("white","gray.800")(e);return{bg:r,color:a,borderColor:o,verticalAlign:"top"}}var M_e=e=>({badge:D_e(e),excessLabel:R_e(e),container:F_e(e)});function vf(e){var t=DV[e];return{container:{width:e,height:e,fontSize:"calc("+(t??e)+" / 2.5)"},excessLabel:{width:e,height:e},label:{fontSize:"calc("+(t??e)+" / 2.5)",lineHeight:e!=="100%"?t??e:void 0}}}var P_e={"2xs":vf("4"),xs:vf("6"),sm:vf("8"),md:vf("12"),lg:vf("16"),xl:vf("24"),"2xl":vf("32"),full:vf("100%")},$_e={size:"md"},L_e={parts:N_e,baseStyle:M_e,sizes:P_e,defaultProps:$_e},B_e={px:1,textTransform:"uppercase",fontSize:"xs",borderRadius:"sm",fontWeight:"bold"};function z_e(e){var{colorScheme:t,theme:n}=e,r=Jg(t+".500",.6)(n);return{bg:Ae(t+".500",r)(e),color:Ae("white","whiteAlpha.800")(e)}}function j_e(e){var{colorScheme:t,theme:n}=e,r=Jg(t+".200",.16)(n);return{bg:Ae(t+".100",r)(e),color:Ae(t+".800",t+".200")(e)}}function U_e(e){var{colorScheme:t,theme:n}=e,r=Jg(t+".200",.8)(n),i=ni(n,t+".500"),a=Ae(i,r)(e);return{color:a,boxShadow:"inset 0 0 0px 1px "+a}}var W_e={solid:z_e,subtle:j_e,outline:U_e},V_e={variant:"subtle",colorScheme:"gray"},gy={baseStyle:B_e,variants:W_e,defaultProps:V_e},q_e=["container","item","link","separator"],H_e={transitionProperty:"common",transitionDuration:"fast",transitionTimingFunction:"ease-out",cursor:"pointer",textDecoration:"none",outline:"none",color:"inherit",_hover:{textDecoration:"underline"},_focus:{boxShadow:"outline"}},G_e={link:H_e},K_e={parts:q_e,baseStyle:G_e};function $D(){return $D=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},$D.apply(this,arguments)}var X_e={lineHeight:"1.2",borderRadius:"md",fontWeight:"semibold",transitionProperty:"common",transitionDuration:"normal",_focus:{boxShadow:"outline"},_disabled:{opacity:.4,cursor:"not-allowed",boxShadow:"none"},_hover:{_disabled:{bg:"initial"}}};function RV(e){var{colorScheme:t,theme:n}=e;if(t==="gray")return{color:Ae("inherit","whiteAlpha.900")(e),_hover:{bg:Ae("gray.100","whiteAlpha.200")(e)},_active:{bg:Ae("gray.200","whiteAlpha.300")(e)}};var r=Jg(t+".200",.12)(n),i=Jg(t+".200",.24)(n);return{color:Ae(t+".600",t+".200")(e),bg:"transparent",_hover:{bg:Ae(t+".50",r)(e)},_active:{bg:Ae(t+".100",i)(e)}}}function Y_e(e){var{colorScheme:t}=e,n=Ae("gray.200","whiteAlpha.300")(e);return $D({border:"1px solid",borderColor:t==="gray"?n:"currentColor"},RV(e))}var Z_e={yellow:{bg:"yellow.400",color:"black",hoverBg:"yellow.500",activeBg:"yellow.600"},cyan:{bg:"cyan.400",color:"black",hoverBg:"cyan.500",activeBg:"cyan.600"}};function J_e(e){var{colorScheme:t}=e;if(t==="gray"){var n=Ae("gray.100","whiteAlpha.200")(e);return{bg:n,_hover:{bg:Ae("gray.200","whiteAlpha.300")(e),_disabled:{bg:n}},_active:{bg:Ae("gray.300","whiteAlpha.400")(e)}}}var{bg:r=t+".500",color:i="white",hoverBg:a=t+".600",activeBg:o=t+".700"}=Z_e[t]||{},s=Ae(r,t+".200")(e);return{bg:s,color:Ae(i,"gray.800")(e),_hover:{bg:Ae(a,t+".300")(e),_disabled:{bg:s}},_active:{bg:Ae(o,t+".400")(e)}}}function Q_e(e){var{colorScheme:t}=e;return{padding:0,height:"auto",lineHeight:"normal",verticalAlign:"baseline",color:Ae(t+".500",t+".200")(e),_hover:{textDecoration:"underline",_disabled:{textDecoration:"none"}},_active:{color:Ae(t+".700",t+".500")(e)}}}var eSe={bg:"none",color:"inherit",display:"inline",lineHeight:"inherit",m:0,p:0},tSe={ghost:RV,outline:Y_e,solid:J_e,link:Q_e,unstyled:eSe},nSe={lg:{h:12,minW:12,fontSize:"lg",px:6},md:{h:10,minW:10,fontSize:"md",px:4},sm:{h:8,minW:8,fontSize:"sm",px:3},xs:{h:6,minW:6,fontSize:"xs",px:2}},rSe={variant:"solid",size:"md",colorScheme:"gray"},iSe={baseStyle:X_e,variants:tSe,sizes:nSe,defaultProps:rSe},aSe=["container","control","label","icon"];function oSe(e){var{colorScheme:t}=e;return{w:"100%",transitionProperty:"box-shadow",transitionDuration:"normal",border:"2px solid",borderRadius:"sm",borderColor:"inherit",color:"white",_checked:{bg:Ae(t+".500",t+".200")(e),borderColor:Ae(t+".500",t+".200")(e),color:Ae("white","gray.900")(e),_hover:{bg:Ae(t+".600",t+".300")(e),borderColor:Ae(t+".600",t+".300")(e)},_disabled:{borderColor:Ae("gray.200","transparent")(e),bg:Ae("gray.200","whiteAlpha.300")(e),color:Ae("gray.500","whiteAlpha.500")(e)}},_indeterminate:{bg:Ae(t+".500",t+".200")(e),borderColor:Ae(t+".500",t+".200")(e),color:Ae("white","gray.900")(e)},_disabled:{bg:Ae("gray.100","whiteAlpha.100")(e),borderColor:Ae("gray.100","transparent")(e)},_focus:{boxShadow:"outline"},_invalid:{borderColor:Ae("red.500","red.300")(e)}}}var sSe={userSelect:"none",_disabled:{opacity:.4}},uSe={transitionProperty:"transform",transitionDuration:"normal"},lSe=e=>({icon:uSe,control:oSe(e),label:sSe}),cSe={sm:{control:{h:3,w:3},label:{fontSize:"sm"},icon:{fontSize:"0.45rem"}},md:{control:{w:4,h:4},label:{fontSize:"md"},icon:{fontSize:"0.625rem"}},lg:{control:{w:5,h:5},label:{fontSize:"lg"},icon:{fontSize:"0.625rem"}}},fSe={size:"md",colorScheme:"blue"},LD={parts:aSe,baseStyle:lSe,sizes:cSe,defaultProps:fSe};function dSe(e){var t=Ae("blackAlpha.100","whiteAlpha.100")(e),n=Ae("blackAlpha.200","whiteAlpha.200")(e);return{borderRadius:"md",transitionProperty:"common",transitionDuration:"normal",_disabled:{opacity:.4,cursor:"not-allowed",boxShadow:"none"},_hover:{bg:t},_active:{bg:n},_focus:{boxShadow:"outline"}}}var hSe={lg:{w:"40px",h:"40px",fontSize:"16px"},md:{w:"32px",h:"32px",fontSize:"12px"},sm:{w:"24px",h:"24px",fontSize:"10px"}},pSe={size:"md"},gSe={baseStyle:dSe,sizes:hSe,defaultProps:pSe},{variants:mSe,defaultProps:vSe}=gy,ySe={fontFamily:"mono",fontSize:"sm",px:"0.2em",borderRadius:"sm"},bSe={baseStyle:ySe,variants:mSe,defaultProps:vSe},xSe={w:"100%",mx:"auto",maxW:"60ch",px:"1rem"},wSe={baseStyle:xSe},_Se={opacity:.6,borderColor:"inherit"},SSe={borderStyle:"solid"},ESe={borderStyle:"dashed"},CSe={solid:SSe,dashed:ESe},ASe={variant:"solid"},kSe={baseStyle:_Se,variants:CSe,defaultProps:ASe},TSe=["overlay","dialogContainer","dialog","header","closeButton","body","footer"],OSe={bg:"blackAlpha.600",zIndex:"modal"};function ISe(e){var{isCentered:t,scrollBehavior:n}=e;return{display:"flex",zIndex:"modal",justifyContent:"center",alignItems:t?"center":"flex-start",overflow:n==="inside"?"hidden":"auto"}}function NSe(e){var{scrollBehavior:t}=e;return{borderRadius:"md",bg:Ae("white","gray.700")(e),color:"inherit",my:"3.75rem",zIndex:"modal",maxH:t==="inside"?"calc(100% - 7.5rem)":void 0,boxShadow:Ae("lg","dark-lg")(e)}}var DSe={px:6,py:4,fontSize:"xl",fontWeight:"semibold"},RSe={position:"absolute",top:2,insetEnd:3};function FSe(e){var{scrollBehavior:t}=e;return{px:6,py:2,flex:1,overflow:t==="inside"?"auto":void 0}}var MSe={px:6,py:4},PSe=e=>({overlay:OSe,dialogContainer:ISe(e),dialog:NSe(e),header:DSe,closeButton:RSe,body:FSe(e),footer:MSe});function $s(e){return e==="full"?{dialog:{maxW:"100vw",minH:"100vh"}}:{dialog:{maxW:e}}}var $Se={xs:$s("xs"),sm:$s("sm"),md:$s("md"),lg:$s("lg"),xl:$s("xl"),"2xl":$s("2xl"),"3xl":$s("3xl"),"4xl":$s("4xl"),"5xl":$s("5xl"),"6xl":$s("6xl"),full:$s("full")},LSe={size:"md"},FV={parts:TSe,baseStyle:PSe,sizes:$Se,defaultProps:LSe};function BD(){return BD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},BD.apply(this,arguments)}var BSe=FV.parts;function Qg(e){return e==="full"?{dialog:{maxW:"100vw",h:"100vh"}}:{dialog:{maxW:e}}}var zSe={bg:"blackAlpha.600",zIndex:"overlay"},jSe={display:"flex",zIndex:"modal",justifyContent:"center"};function USe(e){var{isFullHeight:t}=e;return BD({},t&&{height:"100vh"},{zIndex:"modal",maxH:"100vh",bg:Ae("white","gray.700")(e),color:"inherit",boxShadow:Ae("lg","dark-lg")(e)})}var WSe={px:6,py:4,fontSize:"xl",fontWeight:"semibold"},VSe={position:"absolute",top:2,insetEnd:3},qSe={px:6,py:2,flex:1,overflow:"auto"},HSe={px:6,py:4},GSe=e=>({overlay:zSe,dialogContainer:jSe,dialog:USe(e),header:WSe,closeButton:VSe,body:qSe,footer:HSe}),KSe={xs:Qg("xs"),sm:Qg("md"),md:Qg("lg"),lg:Qg("2xl"),xl:Qg("4xl"),full:Qg("full")},XSe={size:"xs"},YSe={parts:BSe,baseStyle:GSe,sizes:KSe,defaultProps:XSe},ZSe=["preview","input"],JSe={borderRadius:"md",py:"3px",transitionProperty:"common",transitionDuration:"normal"},QSe={borderRadius:"md",py:"3px",transitionProperty:"common",transitionDuration:"normal",width:"full",_focus:{boxShadow:"outline"},_placeholder:{opacity:.6}},eEe={preview:JSe,input:QSe},tEe={parts:ZSe,baseStyle:eEe},nEe=["requiredIndicator","helperText"];function rEe(e){return{marginStart:1,color:Ae("red.500","red.300")(e)}}function iEe(e){return{mt:2,color:Ae("gray.500","whiteAlpha.600")(e),lineHeight:"normal",fontSize:"sm"}}var aEe=e=>({requiredIndicator:rEe(e),helperText:iEe(e)}),oEe={parts:nEe,baseStyle:aEe},sEe={fontSize:"md",marginEnd:3,mb:2,fontWeight:"medium",transitionProperty:"common",transitionDuration:"normal",opacity:1,_disabled:{opacity:.4}},uEe={baseStyle:sEe},lEe={fontFamily:"heading",fontWeight:"bold"},cEe={"4xl":{fontSize:["6xl",null,"7xl"],lineHeight:1},"3xl":{fontSize:["5xl",null,"6xl"],lineHeight:1},"2xl":{fontSize:["4xl",null,"5xl"],lineHeight:[1.2,null,1]},xl:{fontSize:["3xl",null,"4xl"],lineHeight:[1.33,null,1.2]},lg:{fontSize:["2xl",null,"3xl"],lineHeight:[1.33,null,1.2]},md:{fontSize:"xl",lineHeight:1.2},sm:{fontSize:"md",lineHeight:1.2},xs:{fontSize:"sm",lineHeight:1.2}},fEe={size:"xl"},dEe={baseStyle:lEe,sizes:cEe,defaultProps:fEe},hEe=["field","addon"],pEe={field:{width:"100%",minWidth:0,outline:0,position:"relative",appearance:"none",transitionProperty:"common",transitionDuration:"normal"}},yf={lg:{fontSize:"lg",px:4,h:12,borderRadius:"md"},md:{fontSize:"md",px:4,h:10,borderRadius:"md"},sm:{fontSize:"sm",px:3,h:8,borderRadius:"sm"},xs:{fontSize:"xs",px:2,h:6,borderRadius:"sm"}},gEe={lg:{field:yf.lg,addon:yf.lg},md:{field:yf.md,addon:yf.md},sm:{field:yf.sm,addon:yf.sm},xs:{field:yf.xs,addon:yf.xs}};function zD(e){var{focusBorderColor:t,errorBorderColor:n}=e;return{focusBorderColor:t||Ae("blue.500","blue.300")(e),errorBorderColor:n||Ae("red.500","red.300")(e)}}function mEe(e){var{theme:t}=e,{focusBorderColor:n,errorBorderColor:r}=zD(e);return{field:{border:"1px solid",borderColor:"inherit",bg:"inherit",_hover:{borderColor:Ae("gray.300","whiteAlpha.400")(e)},_readOnly:{boxShadow:"none !important",userSelect:"all"},_disabled:{opacity:.4,cursor:"not-allowed"},_invalid:{borderColor:ni(t,r),boxShadow:"0 0 0 1px "+ni(t,r)},_focus:{zIndex:1,borderColor:ni(t,n),boxShadow:"0 0 0 1px "+ni(t,n)}},addon:{border:"1px solid",borderColor:Ae("inherit","whiteAlpha.50")(e),bg:Ae("gray.100","whiteAlpha.300")(e)}}}function vEe(e){var{theme:t}=e,{focusBorderColor:n,errorBorderColor:r}=zD(e);return{field:{border:"2px solid",borderColor:"transparent",bg:Ae("gray.100","whiteAlpha.50")(e),_hover:{bg:Ae("gray.200","whiteAlpha.100")(e)},_readOnly:{boxShadow:"none !important",userSelect:"all"},_disabled:{opacity:.4,cursor:"not-allowed"},_invalid:{borderColor:ni(t,r)},_focus:{bg:"transparent",borderColor:ni(t,n)}},addon:{border:"2px solid",borderColor:"transparent",bg:Ae("gray.100","whiteAlpha.50")(e)}}}function yEe(e){var{theme:t}=e,{focusBorderColor:n,errorBorderColor:r}=zD(e);return{field:{borderBottom:"1px solid",borderColor:"inherit",borderRadius:0,px:0,bg:"transparent",_readOnly:{boxShadow:"none !important",userSelect:"all"},_invalid:{borderColor:ni(t,r),boxShadow:"0px 1px 0px 0px "+ni(t,r)},_focus:{borderColor:ni(t,n),boxShadow:"0px 1px 0px 0px "+ni(t,n)}},addon:{borderBottom:"2px solid",borderColor:"inherit",borderRadius:0,px:0,bg:"transparent"}}}var bEe={field:{bg:"transparent",px:0,height:"auto"},addon:{bg:"transparent",px:0,height:"auto"}},xEe={outline:mEe,filled:vEe,flushed:yEe,unstyled:bEe},wEe={size:"md",variant:"outline"},hr={parts:hEe,baseStyle:pEe,sizes:gEe,variants:xEe,defaultProps:wEe};function _Ee(e){return{bg:Ae("gray.100","whiteAlpha")(e),borderRadius:"md",borderWidth:"1px",borderBottomWidth:"3px",fontSize:"0.8em",fontWeight:"bold",lineHeight:"normal",px:"0.4em",whiteSpace:"nowrap"}}var SEe={baseStyle:_Ee},EEe={transitionProperty:"common",transitionDuration:"fast",transitionTimingFunction:"ease-out",cursor:"pointer",textDecoration:"none",outline:"none",color:"inherit",_hover:{textDecoration:"underline"},_focus:{boxShadow:"outline"}},CEe={baseStyle:EEe},AEe=["container","item","icon"],kEe={},TEe={},OEe={marginEnd:"0.5rem",display:"inline",verticalAlign:"text-bottom"},IEe={container:kEe,item:TEe,icon:OEe},NEe={parts:AEe,baseStyle:IEe},DEe=["item","command","list","button","groupTitle","divider"];function REe(e){return{bg:Ae("#fff","gray.700")(e),boxShadow:Ae("sm","dark-lg")(e),color:"inherit",minW:"3xs",py:"2",zIndex:1,borderRadius:"md",borderWidth:"1px"}}function FEe(e){return{py:"0.4rem",px:"0.8rem",transitionProperty:"background",transitionDuration:"ultra-fast",transitionTimingFunction:"ease-in",_focus:{bg:Ae("gray.100","whiteAlpha.100")(e)},_active:{bg:Ae("gray.200","whiteAlpha.200")(e)},_expanded:{bg:Ae("gray.100","whiteAlpha.100")(e)},_disabled:{opacity:.4,cursor:"not-allowed"}}}var MEe={mx:4,my:2,fontWeight:"semibold",fontSize:"sm"},PEe={opacity:.6},$Ee={border:0,borderBottom:"1px solid",borderColor:"inherit",my:"0.5rem",opacity:.6},LEe={transitionProperty:"common",transitionDuration:"normal"},BEe=e=>({button:LEe,list:REe(e),item:FEe(e),groupTitle:MEe,command:PEe,divider:$Ee}),zEe={parts:DEe,baseStyle:BEe},MV={letterSpacings:{tighter:"-0.05em",tight:"-0.025em",normal:"0",wide:"0.025em",wider:"0.05em",widest:"0.1em"},lineHeights:{normal:"normal",none:1,shorter:1.25,short:1.375,base:1.5,tall:1.625,taller:"2","3":".75rem","4":"1rem","5":"1.25rem","6":"1.5rem","7":"1.75rem","8":"2rem","9":"2.25rem","10":"2.5rem"},fontWeights:{hairline:100,thin:200,light:300,normal:400,medium:500,semibold:600,bold:700,extrabold:800,black:900},fonts:{heading:'-apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',body:'-apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',mono:'SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace'},fontSizes:{xs:"0.75rem",sm:"0.875rem",md:"1rem",lg:"1.125rem",xl:"1.25rem","2xl":"1.5rem","3xl":"1.875rem","4xl":"2.25rem","5xl":"3rem","6xl":"3.75rem","7xl":"4.5rem","8xl":"6rem","9xl":"8rem"}},PV;function jD(){return jD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},jD.apply(this,arguments)}var jEe=["root","field","stepper","stepperGroup"],{variants:UEe,defaultProps:WEe}=hr,VEe={"--number-input-stepper-width":"24px","--number-input-field-padding":"calc(var(--number-input-stepper-width) + 0.5rem)"},qEe=(PV=hr.baseStyle)==null?void 0:PV.field,HEe={width:"var(--number-input-stepper-width)"};function GEe(e){return{borderStart:"1px solid",borderStartColor:Ae("inherit","whiteAlpha.300")(e),color:Ae("inherit","whiteAlpha.800")(e),_active:{bg:Ae("gray.200","whiteAlpha.300")(e)},_disabled:{opacity:.4,cursor:"not-allowed"}}}var KEe=e=>({root:VEe,field:qEe,stepperGroup:HEe,stepper:GEe(e)});function f_(e){var t=hr.sizes[e],n={lg:"md",md:"md",sm:"sm",xs:"sm"},r=MV.fontSizes[t.field.fontSize];return{field:jD({},t.field,{paddingInlineEnd:"var(--number-input-field-padding)",verticalAlign:"top"}),stepper:{fontSize:"calc("+r+" * 0.75)",_first:{borderTopEndRadius:n[e]},_last:{borderBottomEndRadius:n[e],mt:"-1px",borderTopWidth:1}}}}var XEe={xs:f_("xs"),sm:f_("sm"),md:f_("md"),lg:f_("lg")},YEe={parts:jEe,baseStyle:KEe,sizes:XEe,variants:UEe,defaultProps:WEe};function UD(){return UD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},UD.apply(this,arguments)}var ZEe=UD({},hr.baseStyle.field,{textAlign:"center"}),JEe={lg:{fontSize:"lg",w:12,h:12,borderRadius:"md"},md:{fontSize:"md",w:10,h:10,borderRadius:"md"},sm:{fontSize:"sm",w:8,h:8,borderRadius:"sm"},xs:{fontSize:"xs",w:6,h:6,borderRadius:"sm"}},QEe={outline:e=>hr.variants.outline(e).field,flushed:e=>hr.variants.flushed(e).field,filled:e=>hr.variants.filled(e).field,unstyled:hr.variants.unstyled.field},eCe=hr.defaultProps,tCe={baseStyle:ZEe,sizes:JEe,variants:QEe,defaultProps:eCe},nCe=["popper","content","header","body","footer","arrow"],rCe={zIndex:10};function iCe(e){var t=Ae("white","gray.700")(e),n=Ae("gray.200","whiteAlpha.300")(e);return{"--popover-bg":"colors."+t,bg:"var(--popover-bg)","--popper-arrow-bg":"var(--popover-bg)","--popper-arrow-shadow-color":"colors."+n,width:"xs",border:"1px solid",borderColor:"inherit",borderRadius:"md",boxShadow:"sm",zIndex:"inherit",_focus:{outline:0,boxShadow:"outline"}}}var aCe={px:3,py:2,borderBottomWidth:"1px"},oCe={px:3,py:2},sCe={px:3,py:2,borderTopWidth:"1px"},uCe=e=>({popper:rCe,content:iCe(e),header:aCe,body:oCe,footer:sCe,arrow:{}}),lCe={parts:nCe,baseStyle:uCe};function d_(){return d_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d_.apply(this,arguments)}var cCe=["track","filledTrack","label"];function fCe(e){var{colorScheme:t,theme:n,isIndeterminate:r,hasStripe:i}=e,a=Ae(IV(),IV("1rem","rgba(0,0,0,0.1)"))(e),o=Ae(t+".500",t+".200")(e),s=`linear-gradient(
    to right,
    transparent 0%,
    `+ni(n,o)+` 50%,
    transparent 100%
  )`,u=!r&&i;return d_({},u&&a,r?{bgImage:s}:{bgColor:o})}var dCe={lineHeight:"1",fontSize:"0.25em",fontWeight:"bold",color:"white"};function hCe(e){return{bg:Ae("gray.100","whiteAlpha.300")(e)}}function pCe(e){return d_({transitionProperty:"common",transitionDuration:"slow"},fCe(e))}var gCe=e=>({label:dCe,filledTrack:pCe(e),track:hCe(e)}),mCe={xs:{track:{h:"0.25rem"}},sm:{track:{h:"0.5rem"}},md:{track:{h:"0.75rem"}},lg:{track:{h:"1rem"}}},vCe={size:"md",colorScheme:"blue"},yCe={parts:cCe,sizes:mCe,baseStyle:gCe,defaultProps:vCe};function h_(){return h_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},h_.apply(this,arguments)}var bCe=["container","control","label"];function xCe(e){var{control:t}=LD.baseStyle(e);return h_({},t,{borderRadius:"full",_checked:h_({},t._checked,{_before:{content:'""',display:"inline-block",pos:"relative",w:"50%",h:"50%",borderRadius:"50%",bg:"currentColor"}})})}var wCe=e=>({label:LD.baseStyle(e).label,control:xCe(e)}),_Ce={md:{control:{w:4,h:4},label:{fontSize:"md"}},lg:{control:{w:5,h:5},label:{fontSize:"lg"}},sm:{control:{width:3,height:3},label:{fontSize:"sm"}}},SCe={size:"md",colorScheme:"blue"},ECe={parts:bCe,baseStyle:wCe,sizes:_Ce,defaultProps:SCe};function WD(){return WD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},WD.apply(this,arguments)}var CCe=["field","icon"];function ACe(e){return WD({},hr.baseStyle.field,{appearance:"none",paddingBottom:"1px",lineHeight:"normal","> option, > optgroup":{bg:Ae("white","gray.700")(e)}})}var kCe={width:"1.5rem",height:"100%",insetEnd:"0.5rem",position:"relative",color:"currentColor",fontSize:"1.25rem",_disabled:{opacity:.5}},TCe=e=>({field:ACe(e),icon:kCe}),OCe=Ru({},hr.sizes,{xs:{icon:{insetEnd:"0.25rem"}}}),ICe={parts:CCe,baseStyle:TCe,sizes:OCe,variants:hr.variants,defaultProps:hr.defaultProps},NCe=(e,t)=>WW({from:{borderColor:e,background:e},to:{borderColor:t,background:t}}),DCe=e=>{var t=Ae("gray.100","gray.800")(e),n=Ae("gray.400","gray.600")(e),{startColor:r=t,endColor:i=n,speed:a,theme:o}=e,s=ni(o,r),u=ni(o,i);return{opacity:.7,borderRadius:"2px",borderColor:s,background:u,animation:a+"s linear infinite alternate "+NCe(s,u)}},RCe={baseStyle:DCe},FCe=e=>({borderRadius:"md",fontWeight:"semibold",_focus:{boxShadow:"outline",padding:"1rem",position:"fixed",top:"1.5rem",insetStart:"1.5rem",bg:Ae("white","gray.700")(e)}}),MCe={baseStyle:FCe};function p_(){return p_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},p_.apply(this,arguments)}var PCe=["container","thumb","track","filledTrack"];function $Ce(e){return py({orientation:e.orientation,vertical:{left:"50%",transform:"translateX(-50%)",_active:{transform:"translateX(-50%) scale(1.15)"}},horizontal:{top:"50%",transform:"translateY(-50%)",_active:{transform:"translateY(-50%) scale(1.15)"}}})}var LCe=e=>{var{orientation:t}=e;return p_({_disabled:{opacity:.6,cursor:"default",pointerEvents:"none"}},py({orientation:t,vertical:{h:"100%"},horizontal:{w:"100%"}}))};function BCe(e){return{borderRadius:"sm",bg:Ae("gray.200","whiteAlpha.200")(e),_disabled:{bg:Ae("gray.300","whiteAlpha.300")(e)}}}function zCe(e){return p_({zIndex:1,borderRadius:"full",bg:"white",boxShadow:"base",border:"1px solid",borderColor:"transparent",transitionProperty:"transform",transitionDuration:"normal",_focus:{boxShadow:"outline"},_disabled:{bg:"gray.300"}},$Ce(e))}function jCe(e){var{colorScheme:t}=e;return{bg:Ae(t+".500",t+".200")(e)}}var UCe=e=>({container:LCe(e),track:BCe(e),thumb:zCe(e),filledTrack:jCe(e)});function WCe(e){return{thumb:{w:"16px",h:"16px"},track:py({orientation:e.orientation,horizontal:{h:"4px"},vertical:{w:"4px"}})}}function VCe(e){return{thumb:{w:"14px",h:"14px"},track:py({orientation:e.orientation,horizontal:{h:"4px"},vertical:{w:"4px"}})}}function qCe(e){return{thumb:{w:"10px",h:"10px"},track:py({orientation:e.orientation,horizontal:{h:"2px"},vertical:{w:"2px"}})}}var HCe={lg:WCe,md:VCe,sm:qCe},GCe={size:"md",colorScheme:"blue"},KCe={parts:PCe,sizes:HCe,baseStyle:UCe,defaultProps:GCe},XCe={width:"var(--spinner-size)",height:"var(--spinner-size)"},YCe={xs:{"--spinner-size":"0.75rem"},sm:{"--spinner-size":"1rem"},md:{"--spinner-size":"1.5rem"},lg:{"--spinner-size":"2rem"},xl:{"--spinner-size":"3rem"}},ZCe={size:"md"},JCe={baseStyle:XCe,sizes:YCe,defaultProps:ZCe},QCe=["label","number","icon","helpText"],eAe={fontWeight:"medium"},tAe={opacity:.8,marginBottom:2},nAe={verticalAlign:"baseline",fontWeight:"semibold"},rAe={marginEnd:1,w:"14px",h:"14px",verticalAlign:"middle"},iAe={label:eAe,helpText:tAe,number:nAe,icon:rAe},aAe={md:{label:{fontSize:"sm"},helpText:{fontSize:"sm"},number:{fontSize:"2xl"}}},oAe={size:"md"},sAe={parts:QCe,baseStyle:iAe,sizes:aAe,defaultProps:oAe},uAe=["container","track","thumb"];function lAe(e){var{colorScheme:t}=e;return{borderRadius:"full",p:"2px",width:"var(--slider-track-width)",height:"var(--slider-track-height)",transitionProperty:"common",transitionDuration:"fast",bg:Ae("gray.300","whiteAlpha.400")(e),_focus:{boxShadow:"outline"},_disabled:{opacity:.4,cursor:"not-allowed"},_checked:{bg:Ae(t+".500",t+".200")(e)}}}var cAe={bg:"white",transitionProperty:"transform",transitionDuration:"normal",borderRadius:"inherit",width:"var(--slider-track-height)",height:"var(--slider-track-height)",_checked:{transform:"translateX(var(--slider-thumb-x))"}},fAe=e=>({container:{"--slider-track-diff":"calc(var(--slider-track-width) - var(--slider-track-height))","--slider-thumb-x":"var(--slider-track-diff)",_rtl:{"--slider-thumb-x":"calc(-1 * var(--slider-track-diff))"}},track:lAe(e),thumb:cAe}),dAe={sm:{container:{"--slider-track-width":"1.375rem","--slider-track-height":"0.75rem"}},md:{container:{"--slider-track-width":"1.875rem","--slider-track-height":"1rem"}},lg:{container:{"--slider-track-width":"2.875rem","--slider-track-height":"1.5rem"}}},hAe={size:"md",colorScheme:"blue"},pAe={parts:uAe,baseStyle:fAe,sizes:dAe,defaultProps:hAe};function em(){return em=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},em.apply(this,arguments)}var gAe=["table","thead","tbody","tr","th","td","caption"],mAe={table:{fontVariantNumeric:"lining-nums tabular-nums",borderCollapse:"collapse",width:"full"},th:{fontFamily:"heading",fontWeight:"bold",textTransform:"uppercase",letterSpacing:"wider",textAlign:"start"},td:{textAlign:"start"},caption:{mt:4,fontFamily:"heading",textAlign:"center",fontWeight:"medium"}},g_={"&[data-is-numeric=true]":{textAlign:"end"}},vAe=e=>{var{colorScheme:t}=e;return{th:em({color:Ae("gray.600","gray.400")(e),borderBottom:"1px",borderColor:Ae(t+".100",t+".700")(e)},g_),td:em({borderBottom:"1px",borderColor:Ae(t+".100",t+".700")(e)},g_),caption:{color:Ae("gray.600","gray.100")(e)},tfoot:{tr:{"&:last-of-type":{th:{borderBottomWidth:0}}}}}},yAe=e=>{var{colorScheme:t}=e;return{th:em({color:Ae("gray.600","gray.400")(e),borderBottom:"1px",borderColor:Ae(t+".100",t+".700")(e)},g_),td:em({borderBottom:"1px",borderColor:Ae(t+".100",t+".700")(e)},g_),caption:{color:Ae("gray.600","gray.100")(e)},tbody:{tr:{"&:nth-of-type(odd)":{"th, td":{borderBottomWidth:"1px",borderColor:Ae(t+".100",t+".700")(e)},td:{background:Ae(t+".100",t+".700")(e)}}}},tfoot:{tr:{"&:last-of-type":{th:{borderBottomWidth:0}}}}}},bAe={simple:vAe,striped:yAe,unstyled:{}},xAe={sm:{th:{px:"4",py:"1",lineHeight:"4",fontSize:"xs"},td:{px:"4",py:"2",fontSize:"sm",lineHeight:"4"},caption:{px:"4",py:"2",fontSize:"xs"}},md:{th:{px:"6",py:"3",lineHeight:"4",fontSize:"xs"},td:{px:"6",py:"4",lineHeight:"5"},caption:{px:"6",py:"2",fontSize:"sm"}},lg:{th:{px:"8",py:"4",lineHeight:"5",fontSize:"sm"},td:{px:"8",py:"5",lineHeight:"6"},caption:{px:"6",py:"2",fontSize:"md"}}},wAe={variant:"simple",size:"md",colorScheme:"gray"},_Ae={parts:gAe,baseStyle:mAe,variants:bAe,sizes:xAe,defaultProps:wAe},SAe=["root","tablist","tab","tabpanels","tabpanel","indicator"];function EAe(e){var{orientation:t}=e;return{display:t==="vertical"?"flex":"block"}}function CAe(e){var{isFitted:t}=e;return{flex:t?1:void 0,transitionProperty:"common",transitionDuration:"normal",_focus:{zIndex:1,boxShadow:"outline"}}}function AAe(e){var{align:t="start",orientation:n}=e,r={end:"flex-end",center:"center",start:"flex-start"};return{justifyContent:r[t],flexDirection:n==="vertical"?"column":"row"}}var kAe={p:4},TAe=e=>({root:EAe(e),tab:CAe(e),tablist:AAe(e),tabpanel:kAe}),OAe={sm:{tab:{py:1,px:4,fontSize:"sm"}},md:{tab:{fontSize:"md",py:2,px:4}},lg:{tab:{fontSize:"lg",py:3,px:4}}};function IAe(e){var{colorScheme:t,orientation:n}=e,r=n==="vertical",i=n==="vertical"?"borderStart":"borderBottom",a=r?"marginStart":"marginBottom";return{tablist:{[i]:"2px solid",borderColor:"inherit"},tab:{[i]:"2px solid",borderColor:"transparent",[a]:"-2px",_selected:{color:Ae(t+".600",t+".300")(e),borderColor:"currentColor"},_active:{bg:Ae("gray.200","whiteAlpha.300")(e)},_disabled:{opacity:.4,cursor:"not-allowed"}}}}function NAe(e){var{colorScheme:t}=e;return{tab:{borderTopRadius:"md",border:"1px solid",borderColor:"transparent",mb:"-1px",_selected:{color:Ae(t+".600",t+".300")(e),borderColor:"inherit",borderBottomColor:Ae("white","gray.800")(e)}},tablist:{mb:"-1px",borderBottom:"1px solid",borderColor:"inherit"}}}function DAe(e){var{colorScheme:t}=e;return{tab:{border:"1px solid",borderColor:"inherit",bg:Ae("gray.50","whiteAlpha.50")(e),mb:"-1px",_notLast:{marginEnd:"-1px"},_selected:{bg:Ae("#fff","gray.800")(e),color:Ae(t+".600",t+".300")(e),borderColor:"inherit",borderTopColor:"currentColor",borderBottomColor:"transparent"}},tablist:{mb:"-1px",borderBottom:"1px solid",borderColor:"inherit"}}}function RAe(e){var{colorScheme:t,theme:n}=e;return{tab:{borderRadius:"full",fontWeight:"semibold",color:"gray.600",_selected:{color:ni(n,t+".700"),bg:ni(n,t+".100")}}}}function FAe(e){var{colorScheme:t}=e;return{tab:{borderRadius:"full",fontWeight:"semibold",color:Ae("gray.600","inherit")(e),_selected:{color:Ae("#fff","gray.800")(e),bg:Ae(t+".600",t+".300")(e)}}}}var MAe={},PAe={line:IAe,enclosed:NAe,"enclosed-colored":DAe,"soft-rounded":RAe,"solid-rounded":FAe,unstyled:MAe},$Ae={size:"md",variant:"line",colorScheme:"blue"},LAe={parts:SAe,baseStyle:TAe,sizes:OAe,variants:PAe,defaultProps:$Ae},BAe=["container","label","closeButton"],zAe={fontWeight:"medium",lineHeight:1.2,outline:0,_focus:{boxShadow:"outline"}},jAe={lineHeight:1.2},UAe={fontSize:"18px",w:"1.25rem",h:"1.25rem",transitionProperty:"common",transitionDuration:"normal",borderRadius:"full",marginStart:"0.375rem",marginEnd:"-1",opacity:.5,_disabled:{opacity:.4},_focus:{boxShadow:"outline",bg:"rgba(0, 0, 0, 0.14)"},_hover:{opacity:.8},_active:{opacity:1}},WAe={container:zAe,label:jAe,closeButton:UAe},VAe={sm:{container:{minH:"1.25rem",minW:"1.25rem",fontSize:"xs",px:2,borderRadius:"md"},closeButton:{marginEnd:"-2px",marginStart:"0.35rem"}},md:{container:{minH:"1.5rem",minW:"1.5rem",fontSize:"sm",borderRadius:"md",px:2}},lg:{container:{minH:8,minW:8,fontSize:"md",borderRadius:"md",px:3}}},qAe={subtle:e=>({container:gy.variants.subtle(e)}),solid:e=>({container:gy.variants.solid(e)}),outline:e=>({container:gy.variants.outline(e)})},HAe={size:"md",variant:"subtle",colorScheme:"gray"},GAe={parts:BAe,variants:qAe,baseStyle:WAe,sizes:VAe,defaultProps:HAe};function VD(){return VD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},VD.apply(this,arguments)}var KAe=VD({},hr.baseStyle.field,{paddingY:"8px",minHeight:"80px",lineHeight:"short",verticalAlign:"top"}),XAe={outline:e=>hr.variants.outline(e).field,flushed:e=>hr.variants.flushed(e).field,filled:e=>hr.variants.filled(e).field,unstyled:hr.variants.unstyled.field},YAe={xs:hr.sizes.xs.field,sm:hr.sizes.sm.field,md:hr.sizes.md.field,lg:hr.sizes.lg.field},ZAe={size:"md",variant:"outline"},JAe={baseStyle:KAe,sizes:YAe,variants:XAe,defaultProps:ZAe};function QAe(e){var t=Ae("gray.700","gray.300")(e);return{"--tooltip-bg":"colors."+t,px:"8px",py:"2px",bg:"var(--tooltip-bg)","--popper-arrow-bg":"var(--tooltip-bg)",color:Ae("whiteAlpha.900","gray.900")(e),borderRadius:"sm",fontWeight:"medium",fontSize:"sm",boxShadow:"md",maxW:"320px",zIndex:"tooltip"}}var eke={baseStyle:QAe},tke=["text","icon"];function nke(e){return{color:Ae("red.500","red.300")(e),mt:2,fontSize:"sm"}}function rke(e){return{marginEnd:"0.5em",color:Ae("red.500","red.300")(e)}}var ike=e=>({text:nke(e),icon:rke(e)}),ake={parts:tke,baseStyle:ike},oke={Accordion:d_e,Alert:T_e,Avatar:L_e,Badge:gy,Breadcrumb:K_e,Button:iSe,Checkbox:LD,CloseButton:gSe,Code:bSe,Container:wSe,Divider:kSe,Drawer:YSe,Editable:tEe,Form:oEe,FormLabel:uEe,Heading:dEe,Input:hr,Kbd:SEe,Link:CEe,List:NEe,Menu:zEe,Modal:FV,NumberInput:YEe,PinInput:tCe,Popover:lCe,Progress:yCe,Radio:ECe,Select:ICe,Skeleton:RCe,SkipLink:MCe,Slider:KCe,Spinner:JCe,Stat:sAe,Switch:pAe,Table:_Ae,Tabs:LAe,Tag:GAe,Textarea:JAe,Tooltip:eke,FormError:ake},ske={none:0,"1px":"1px solid","2px":"2px solid","4px":"4px solid","8px":"8px solid"},uke=b_e({sm:"30em",md:"48em",lg:"62em",xl:"80em","2xl":"96em"}),lke={transparent:"transparent",current:"currentColor",black:"#000000",white:"#FFFFFF",whiteAlpha:{50:"rgba(255, 255, 255, 0.04)",100:"rgba(255, 255, 255, 0.06)",200:"rgba(255, 255, 255, 0.08)",300:"rgba(255, 255, 255, 0.16)",400:"rgba(255, 255, 255, 0.24)",500:"rgba(255, 255, 255, 0.36)",600:"rgba(255, 255, 255, 0.48)",700:"rgba(255, 255, 255, 0.64)",800:"rgba(255, 255, 255, 0.80)",900:"rgba(255, 255, 255, 0.92)"},blackAlpha:{50:"rgba(0, 0, 0, 0.04)",100:"rgba(0, 0, 0, 0.06)",200:"rgba(0, 0, 0, 0.08)",300:"rgba(0, 0, 0, 0.16)",400:"rgba(0, 0, 0, 0.24)",500:"rgba(0, 0, 0, 0.36)",600:"rgba(0, 0, 0, 0.48)",700:"rgba(0, 0, 0, 0.64)",800:"rgba(0, 0, 0, 0.80)",900:"rgba(0, 0, 0, 0.92)"},gray:{50:"#F7FAFC",100:"#EDF2F7",200:"#E2E8F0",300:"#CBD5E0",400:"#A0AEC0",500:"#718096",600:"#4A5568",700:"#2D3748",800:"#1A202C",900:"#171923"},red:{50:"#FFF5F5",100:"#FED7D7",200:"#FEB2B2",300:"#FC8181",400:"#F56565",500:"#E53E3E",600:"#C53030",700:"#9B2C2C",800:"#822727",900:"#63171B"},orange:{50:"#FFFAF0",100:"#FEEBC8",200:"#FBD38D",300:"#F6AD55",400:"#ED8936",500:"#DD6B20",600:"#C05621",700:"#9C4221",800:"#7B341E",900:"#652B19"},yellow:{50:"#FFFFF0",100:"#FEFCBF",200:"#FAF089",300:"#F6E05E",400:"#ECC94B",500:"#D69E2E",600:"#B7791F",700:"#975A16",800:"#744210",900:"#5F370E"},green:{50:"#F0FFF4",100:"#C6F6D5",200:"#9AE6B4",300:"#68D391",400:"#48BB78",500:"#38A169",600:"#2F855A",700:"#276749",800:"#22543D",900:"#1C4532"},teal:{50:"#E6FFFA",100:"#B2F5EA",200:"#81E6D9",300:"#4FD1C5",400:"#38B2AC",500:"#319795",600:"#2C7A7B",700:"#285E61",800:"#234E52",900:"#1D4044"},blue:{50:"#ebf8ff",100:"#bee3f8",200:"#90cdf4",300:"#63b3ed",400:"#4299e1",500:"#3182ce",600:"#2b6cb0",700:"#2c5282",800:"#2a4365",900:"#1A365D"},cyan:{50:"#EDFDFD",100:"#C4F1F9",200:"#9DECF9",300:"#76E4F7",400:"#0BC5EA",500:"#00B5D8",600:"#00A3C4",700:"#0987A0",800:"#086F83",900:"#065666"},purple:{50:"#FAF5FF",100:"#E9D8FD",200:"#D6BCFA",300:"#B794F4",400:"#9F7AEA",500:"#805AD5",600:"#6B46C1",700:"#553C9A",800:"#44337A",900:"#322659"},pink:{50:"#FFF5F7",100:"#FED7E2",200:"#FBB6CE",300:"#F687B3",400:"#ED64A6",500:"#D53F8C",600:"#B83280",700:"#97266D",800:"#702459",900:"#521B41"},linkedin:{50:"#E8F4F9",100:"#CFEDFB",200:"#9BDAF3",300:"#68C7EC",400:"#34B3E4",500:"#00A0DC",600:"#008CC9",700:"#0077B5",800:"#005E93",900:"#004471"},facebook:{50:"#E8F4F9",100:"#D9DEE9",200:"#B7C2DA",300:"#6482C0",400:"#4267B2",500:"#385898",600:"#314E89",700:"#29487D",800:"#223B67",900:"#1E355B"},messenger:{50:"#D0E6FF",100:"#B9DAFF",200:"#A2CDFF",300:"#7AB8FF",400:"#2E90FF",500:"#0078FF",600:"#0063D1",700:"#0052AC",800:"#003C7E",900:"#002C5C"},whatsapp:{50:"#dffeec",100:"#b9f5d0",200:"#90edb3",300:"#65e495",400:"#3cdd78",500:"#22c35e",600:"#179848",700:"#0c6c33",800:"#01421c",900:"#001803"},twitter:{50:"#E5F4FD",100:"#C8E9FB",200:"#A8DCFA",300:"#83CDF7",400:"#57BBF5",500:"#1DA1F2",600:"#1A94DA",700:"#1681BF",800:"#136B9E",900:"#0D4D71"},telegram:{50:"#E3F2F9",100:"#C5E4F3",200:"#A2D4EC",300:"#7AC1E4",400:"#47A9DA",500:"#0088CC",600:"#007AB8",700:"#006BA1",800:"#005885",900:"#003F5E"}},cke={none:"0",sm:"0.125rem",base:"0.25rem",md:"0.375rem",lg:"0.5rem",xl:"0.75rem","2xl":"1rem","3xl":"1.5rem",full:"9999px"},fke={xs:"0 0 0 1px rgba(0, 0, 0, 0.05)",sm:"0 1px 2px 0 rgba(0, 0, 0, 0.05)",base:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)",md:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",lg:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",xl:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)","2xl":"0 25px 50px -12px rgba(0, 0, 0, 0.25)",outline:"0 0 0 3px rgba(66, 153, 225, 0.6)",inner:"inset 0 2px 4px 0 rgba(0,0,0,0.06)",none:"none","dark-lg":"rgba(0, 0, 0, 0.1) 0px 0px 0px 1px, rgba(0, 0, 0, 0.2) 0px 5px 10px, rgba(0, 0, 0, 0.4) 0px 15px 40px"},dke={common:"background-color, border-color, color, fill, stroke, opacity, box-shadow, transform",colors:"background-color, border-color, color, fill, stroke",dimensions:"width, height",position:"left, right, top, bottom",background:"background-color, background-image, background-position"},hke={"ease-in":"cubic-bezier(0.4, 0, 1, 1)","ease-out":"cubic-bezier(0, 0, 0.2, 1)","ease-in-out":"cubic-bezier(0.4, 0, 0.2, 1)"},pke={"ultra-fast":"50ms",faster:"100ms",fast:"150ms",normal:"200ms",slow:"300ms",slower:"400ms","ultra-slow":"500ms"},gke={property:dke,easing:hke,duration:pke},mke={hide:-1,auto:"auto",base:0,docked:10,dropdown:1e3,sticky:1100,banner:1200,overlay:1300,modal:1400,popover:1500,skipLink:1600,toast:1700,tooltip:1800},vke={none:0,sm:"4px",base:"8px",md:"12px",lg:"16px",xl:"24px","2xl":"40px","3xl":"64px"};function qD(){return qD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},qD.apply(this,arguments)}var yke=qD({breakpoints:uke,zIndices:mke,radii:cke,blur:vke,colors:lke},MV,{sizes:DV,shadows:fke,space:NV,borders:ske,transition:gke}),bke={global:e=>({body:{fontFamily:"body",color:Ae("gray.800","whiteAlpha.900")(e),bg:Ae("white","gray.800")(e),transitionProperty:"background-color",transitionDuration:"normal",lineHeight:"base"},"*::placeholder":{color:Ae("gray.400","whiteAlpha.400")(e)},"*, *::before, &::after":{borderColor:Ae("gray.200","whiteAlpha.300")(e),wordWrap:"break-word"}})};function HD(){return HD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},HD.apply(this,arguments)}var xke="ltr",wke={useSystemColorMode:!1,initialColorMode:"light",cssVarPrefix:"chakra"},_ke=HD({direction:xke},yke,{components:oke,styles:bke,config:wke}),Ske={body:{classList:{add(){},remove(){}}},addEventListener(){},removeEventListener(){},activeElement:{blur(){},nodeName:""},querySelector(){return null},querySelectorAll(){return[]},getElementById(){return null},createEvent(){return{initEvent(){}}},createElement(){return{children:[],childNodes:[],style:{},setAttribute(){},getElementsByTagName(){return[]}}}},$V=Ske,tm=()=>{},Eke={document:$V,navigator:{userAgent:""},CustomEvent:function(){return this},addEventListener:tm,removeEventListener:tm,getComputedStyle(){return{getPropertyValue(){return""}}},matchMedia(){return{matches:!1,addListener:tm,removeListener:tm}},requestAnimationFrame(e){return typeof setTimeout=="undefined"?(e(),null):setTimeout(e,0)},cancelAnimationFrame(e){typeof setTimeout!="undefined"&&clearTimeout(e)},setTimeout:()=>0,clearTimeout:tm,setInterval:()=>0,clearInterval:tm},Cke=Eke,Ake={window:Cke,document:$V},LV=qg?{window,document}:Ake,kke=ha(LV);function Tke(e){var{children:t,environment:n}=e,[r,i]=an(null),a=xr(()=>{var s,u=r==null?void 0:r.ownerDocument,l=r==null?void 0:r.ownerDocument.defaultView,c=u?{document:u,window:l}:void 0,f=(s=n??c)!=null?s:LV;return f},[r,n]),o=!r&&!n;return zt.createElement(kke.Provider,{value:a},t,o&&zt.createElement("span",{ref:s=>{s&&i(s)}}))}var Oke=e=>{var{children:t,colorModeManager:n,portalZIndex:r,resetCSS:i=!0,theme:a=_ke,environment:o,cssVarsRoot:s}=e,u=ue(Tke,{environment:o},t);return ue(Swe,null,ue(V2e,{theme:a,cssVarsRoot:s},ue(dV,{colorModeManager:n,options:a.config},i&&ue(Pxe,null),ue(q2e,null),r?ue(rV,{zIndex:r},u):u)))};function my(){return my=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},my.apply(this,arguments)}function Ike(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var BV={path:ue("g",{stroke:"currentColor",strokeWidth:"1.5"},ue("path",{strokeLinecap:"round",fill:"none",d:"M9,9a3,3,0,1,1,4,2.829,1.5,1.5,0,0,0-1,1.415V14.25"}),ue("path",{fill:"currentColor",strokeLinecap:"round",d:"M12,17.25a.375.375,0,1,0,.375.375A.375.375,0,0,0,12,17.25h0"}),ue("circle",{fill:"none",strokeMiterlimit:"10",cx:"12",cy:"12",r:"11.25"})),viewBox:"0 0 24 24"},vy=Mt((e,t)=>{var{as:n,viewBox:r,color:i="currentColor",focusable:a=!1,children:o,className:s,__css:u}=e,l=Ike(e,["as","viewBox","color","focusable","children","className","__css"]),c=Wn("chakra-icon",s),f=my({w:"1em",h:"1em",display:"inline-block",lineHeight:"1em",flexShrink:0,color:i},u),d={ref:t,focusable:a,className:c,__css:f},h=r??BV.viewBox;if(n&&typeof n!="string")return ue(xt.svg,my({as:n},d,l));var p=o??BV.path;return ue(xt.svg,my({verticalAlign:"middle",viewBox:h},d,l),p)});function GD(){return GD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},GD.apply(this,arguments)}function yy(e){var{viewBox:t="0 0 24 24",d:n,path:r,displayName:i,defaultProps:a={}}=e,o=Mt((s,u)=>ue(vy,GD({ref:u,viewBox:t},a,s),r??ue("path",{fill:"currentColor",d:n})));return o}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var KD=function(e,t){return KD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},KD(e,t)};function zV(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");KD(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var Ie=function(){return Ie=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},Ie.apply(this,arguments)};function ko(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function pr(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),i,a=[],o;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return a}function ma(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,a;r<i;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return e.concat(a||t)}var Yl=function(e){return{isEnabled:function(t){return e.some(function(n){return!!t[n]})}}},XD={measureLayout:Yl(["layout","layoutId","drag","_layoutResetTransform"]),animation:Yl(["animate","exit","variants","whileHover","whileTap","whileFocus","whileDrag"]),exit:Yl(["exit"]),drag:Yl(["drag","dragControls"]),focus:Yl(["whileFocus"]),hover:Yl(["whileHover","onHoverStart","onHoverEnd"]),tap:Yl(["whileTap","onTap","onTapStart","onTapCancel"]),pan:Yl(["onPan","onPanStart","onPanSessionStart","onPanEnd"]),layoutAnimation:Yl(["layout","layoutId"])};function Nke(e){for(var t in e){var n=e[t];n!==null&&(XD[t].Component=n)}}var by=function(){},jV=ha({strict:!1}),UV=Object.keys(XD),Dke=UV.length;function Rke(e,t,n){var r=[];if(Un(jV),!t)return null;for(var i=0;i<Dke;i++){var a=UV[i],o=XD[a],s=o.isEnabled,u=o.Component;s(e)&&u&&r.push(ue(u,Ie({key:a},e,{visualElement:t})))}return r}var m_=ha({transformPagePoint:function(e){return e},isStatic:!1}),v_=ha({});function Fke(){return Un(v_).visualElement}var xy=ha(null);function wy(e){var t=Jt(null);return t.current===null&&(t.current=e()),t.current}function YD(){var e=Un(xy);if(e===null)return[!0,null];var t=e.isPresent,n=e.onExitComplete,r=e.register,i=Lke();qt(function(){return r(i)},[]);var a=function(){return n==null?void 0:n(i)};return!t&&n?[!1,a]:[!0]}function Mke(e){return e===null?!0:e.isPresent}var Pke=0,$ke=function(){return Pke++},Lke=function(){return wy($ke)},Bke=ha(null),_y=typeof window!="undefined",WV=_y?lf:qt;function zke(e){var t=e.layoutId,n=Un(Bke);return n&&t!==void 0?n+"-"+t:t}function jke(e,t,n,r){var i=Un(m_),a=Un(jV),o=Fke(),s=Un(xy),u=zke(n),l=Jt(void 0);r||(r=a.renderer),!l.current&&r&&(l.current=r(e,{visualState:t,parent:o,props:Ie(Ie({},n),{layoutId:u}),presenceId:s==null?void 0:s.id,blockInitialAnimation:(s==null?void 0:s.initial)===!1}));var c=l.current;return WV(function(){!c||(c.setProps(Ie(Ie(Ie({},i),n),{layoutId:u})),c.isPresent=Mke(s),c.isPresenceRoot=!o||o.presenceId!==(s==null?void 0:s.id),c.syncRender())}),qt(function(){var f;!c||(f=c.animationState)===null||f===void 0||f.animateChanges()}),WV(function(){return function(){return c==null?void 0:c.notifyUnmount()}},[]),c}function ZD(e){return typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function Uke(e,t,n){return st(function(r){var i;r&&((i=e.mount)===null||i===void 0||i.call(e,r)),t&&(r?t.mount(r):t.unmount()),n&&(typeof n=="function"?n(r):ZD(n)&&(n.current=r))},[t])}function VV(e){return Array.isArray(e)}function Ls(e){return typeof e=="string"||VV(e)}function Wke(e){var t={};return e.forEachValue(function(n,r){return t[r]=n.get()}),t}function Vke(e){var t={};return e.forEachValue(function(n,r){return t[r]=n.getVelocity()}),t}function qV(e,t,n,r,i){var a;return r===void 0&&(r={}),i===void 0&&(i={}),typeof t=="string"&&(t=(a=e.variants)===null||a===void 0?void 0:a[t]),typeof t=="function"?t(n??e.custom,r,i):t}function y_(e,t,n){var r=e.getProps();return qV(r,t,n??r.custom,Wke(e),Vke(e))}function b_(e){var t;return typeof((t=e.animate)===null||t===void 0?void 0:t.start)=="function"||Ls(e.initial)||Ls(e.animate)||Ls(e.whileHover)||Ls(e.whileDrag)||Ls(e.whileTap)||Ls(e.whileFocus)||Ls(e.exit)}function HV(e){return Boolean(b_(e)||e.variants)}function qke(e,t){if(b_(e)){var n=e.initial,r=e.animate;return{initial:n===!1||Ls(n)?n:void 0,animate:Ls(r)?r:void 0}}return e.inherit!==!1?t:{}}function Hke(e,t){var n=qke(e,Un(v_)),r=n.initial,i=n.animate;return xr(function(){return{initial:r,animate:i}},t?[GV(r),GV(i)]:[])}function GV(e){return Array.isArray(e)?e.join(" "):e}function Gke(e){var t=e.preloadedFeatures,n=e.createVisualElement,r=e.useRender,i=e.useVisualState,a=e.Component;t&&Nke(t);function o(s,u){var l=Un(m_).isStatic,c=null,f=Hke(s,l),d=i(s,l);return!l&&_y&&(f.visualElement=jke(a,d,s,n),c=Rke(s,f.visualElement)),ue(Vi,null,ue(v_.Provider,{value:f},r(a,s,Uke(d,f.visualElement,u),d,l)),c)}return Gl(o)}function Kke(e){function t(r,i){return i===void 0&&(i={}),Gke(e(r,i))}var n=new Map;return new Proxy(t,{get:function(r,i){return n.has(i)||n.set(i,t(i)),n.get(i)}})}var Xke=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","svg","switch","symbol","text","tspan","use","view"];function JD(e){return typeof e!="string"||e.includes("-")?!1:!!(Xke.indexOf(e)>-1||/[A-Z]/.test(e))}var Sy={};function Yke(e){for(var t in e)Sy[t]=e[t]}var Zke=["","X","Y","Z"],Jke=["translate","scale","rotate","skew"],Ey=["transformPerspective","x","y","z"];Jke.forEach(function(e){return Zke.forEach(function(t){return Ey.push(e+t)})});function Qke(e,t){return Ey.indexOf(e)-Ey.indexOf(t)}var eTe=new Set(Ey);function x_(e){return eTe.has(e)}var tTe=new Set(["originX","originY","originZ"]);function KV(e){return tTe.has(e)}function XV(e,t){var n=t.layout,r=t.layoutId;return x_(e)||KV(e)||(n||r!==void 0)&&(!!Sy[e]||e==="opacity")}var bf=function(e){return e!==null&&typeof e=="object"&&e.getVelocity},nTe={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"};function rTe(e,t,n,r){var i=e.transform,a=e.transformKeys,o=t.enableHardwareAcceleration,s=o===void 0?!0:o,u=t.allowTransformNone,l=u===void 0?!0:u,c="";a.sort(Qke);for(var f=!1,d=a.length,h=0;h<d;h++){var p=a[h];c+=(nTe[p]||p)+"("+i[p]+") ",p==="z"&&(f=!0)}return!f&&s?c+="translateZ(0)":c=c.trim(),r?c=r(i,n?"":c):l&&n&&(c="none"),c}function iTe(e){var t=e.originX,n=t===void 0?"50%":t,r=e.originY,i=r===void 0?"50%":r,a=e.originZ,o=a===void 0?0:a;return n+" "+i+" "+o}function YV(e){return e.startsWith("--")}var aTe=function(e,t){return t&&typeof e=="number"?t.transform(e):e},ZV=function(e,t){return function(n){return Math.max(Math.min(n,t),e)}},Cy=function(e){return e%1?Number(e.toFixed(5)):e},Ay=/(-)?([\d]*\.?[\d])+/g,QD=/(#[0-9a-f]{6}|#[0-9a-f]{3}|#(?:[0-9a-f]{2}){2,4}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2,3}\s*\/*\s*[\d\.]+%?\))/gi,oTe=/^(#[0-9a-f]{3}|#(?:[0-9a-f]{2}){2,4}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2,3}\s*\/*\s*[\d\.]+%?\))$/i;function ky(e){return typeof e=="string"}var xh={test:function(e){return typeof e=="number"},parse:parseFloat,transform:function(e){return e}},Ty=Ie(Ie({},xh),{transform:ZV(0,1)}),w_=Ie(Ie({},xh),{default:1}),Oy=function(e){return{test:function(t){return ky(t)&&t.endsWith(e)&&t.split(" ").length===1},parse:parseFloat,transform:function(t){return""+t+e}}},xf=Oy("deg"),nm=Oy("%"),Tt=Oy("px"),sTe=Oy("vh"),uTe=Oy("vw"),JV=Ie(Ie({},nm),{parse:function(e){return nm.parse(e)/100},transform:function(e){return nm.transform(e*100)}}),eR=function(e,t){return function(n){return Boolean(ky(n)&&oTe.test(n)&&n.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(n,t))}},QV=function(e,t,n){return function(r){var i;if(!ky(r))return r;var a=r.match(Ay),o=a[0],s=a[1],u=a[2],l=a[3];return i={},i[e]=parseFloat(o),i[t]=parseFloat(s),i[n]=parseFloat(u),i.alpha=l!==void 0?parseFloat(l):1,i}},rm={test:eR("hsl","hue"),parse:QV("hue","saturation","lightness"),transform:function(e){var t=e.hue,n=e.saturation,r=e.lightness,i=e.alpha,a=i===void 0?1:i;return"hsla("+Math.round(t)+", "+nm.transform(Cy(n))+", "+nm.transform(Cy(r))+", "+Cy(Ty.transform(a))+")"}},lTe=ZV(0,255),tR=Ie(Ie({},xh),{transform:function(e){return Math.round(lTe(e))}}),im={test:eR("rgb","red"),parse:QV("red","green","blue"),transform:function(e){var t=e.red,n=e.green,r=e.blue,i=e.alpha,a=i===void 0?1:i;return"rgba("+tR.transform(t)+", "+tR.transform(n)+", "+tR.transform(r)+", "+Cy(Ty.transform(a))+")"}};function cTe(e){var t="",n="",r="",i="";return e.length>5?(t=e.substr(1,2),n=e.substr(3,2),r=e.substr(5,2),i=e.substr(7,2)):(t=e.substr(1,1),n=e.substr(2,1),r=e.substr(3,1),i=e.substr(4,1),t+=t,n+=n,r+=r,i+=i),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}var nR={test:eR("#"),parse:cTe,transform:im.transform},va={test:function(e){return im.test(e)||nR.test(e)||rm.test(e)},parse:function(e){return im.test(e)?im.parse(e):rm.test(e)?rm.parse(e):nR.parse(e)},transform:function(e){return ky(e)?e:e.hasOwnProperty("red")?im.transform(e):rm.transform(e)}},eq="${c}",tq="${n}";function fTe(e){var t,n,r,i;return isNaN(e)&&ky(e)&&((n=(t=e.match(Ay))===null||t===void 0?void 0:t.length)!==null&&n!==void 0?n:0)+((i=(r=e.match(QD))===null||r===void 0?void 0:r.length)!==null&&i!==void 0?i:0)>0}function nq(e){var t=[],n=0,r=e.match(QD);r&&(n=r.length,e=e.replace(QD,eq),t.push.apply(t,r.map(va.parse)));var i=e.match(Ay);return i&&(e=e.replace(Ay,tq),t.push.apply(t,i.map(xh.parse))),{values:t,numColors:n,tokenised:e}}function rq(e){return nq(e).values}function iq(e){var t=nq(e),n=t.values,r=t.numColors,i=t.tokenised,a=n.length;return function(o){for(var s=i,u=0;u<a;u++)s=s.replace(u<r?eq:tq,u<r?va.transform(o[u]):Cy(o[u]));return s}}var dTe=function(e){return typeof e=="number"?0:e};function hTe(e){var t=rq(e),n=iq(e);return n(t.map(dTe))}var Zl={test:fTe,parse:rq,createTransformer:iq,getAnimatableNone:hTe},pTe=new Set(["brightness","contrast","saturate","opacity"]);function gTe(e){var t=e.slice(0,-1).split("("),n=t[0],r=t[1];if(n==="drop-shadow")return e;var i=(r.match(Ay)||[])[0];if(!i)return e;var a=r.replace(i,""),o=pTe.has(n)?1:0;return i!==r&&(o*=100),n+"("+o+a+")"}var mTe=/([a-z-]*)\(.*?\)/g,rR=Ie(Ie({},Zl),{getAnimatableNone:function(e){var t=e.match(mTe);return t?t.map(gTe).join(" "):e}}),aq=Ie(Ie({},xh),{transform:Math.round}),oq={borderWidth:Tt,borderTopWidth:Tt,borderRightWidth:Tt,borderBottomWidth:Tt,borderLeftWidth:Tt,borderRadius:Tt,radius:Tt,borderTopLeftRadius:Tt,borderTopRightRadius:Tt,borderBottomRightRadius:Tt,borderBottomLeftRadius:Tt,width:Tt,maxWidth:Tt,height:Tt,maxHeight:Tt,size:Tt,top:Tt,right:Tt,bottom:Tt,left:Tt,padding:Tt,paddingTop:Tt,paddingRight:Tt,paddingBottom:Tt,paddingLeft:Tt,margin:Tt,marginTop:Tt,marginRight:Tt,marginBottom:Tt,marginLeft:Tt,rotate:xf,rotateX:xf,rotateY:xf,rotateZ:xf,scale:w_,scaleX:w_,scaleY:w_,scaleZ:w_,skew:xf,skewX:xf,skewY:xf,distance:Tt,translateX:Tt,translateY:Tt,translateZ:Tt,x:Tt,y:Tt,z:Tt,perspective:Tt,transformPerspective:Tt,opacity:Ty,originX:JV,originY:JV,originZ:Tt,zIndex:aq,fillOpacity:Ty,strokeOpacity:Ty,numOctaves:aq};function iR(e,t,n,r,i,a,o,s){var u,l=e.style,c=e.vars,f=e.transform,d=e.transformKeys,h=e.transformOrigin;d.length=0;var p=!1,g=!1,m=!0;for(var v in t){var y=t[v];if(YV(v)){c[v]=y;continue}var b=oq[v],x=aTe(y,b);if(x_(v)){if(p=!0,f[v]=x,d.push(v),!m)continue;y!==((u=b.default)!==null&&u!==void 0?u:0)&&(m=!1)}else if(KV(v))h[v]=x,g=!0;else if((n==null?void 0:n.isHydrated)&&(r==null?void 0:r.isHydrated)&&Sy[v]){var w=Sy[v].process(y,r,n),S=Sy[v].applyTo;if(S)for(var C=S.length,_=0;_<C;_++)l[S[_]]=w;else l[v]=w}else l[v]=x}r&&n&&o&&s?(l.transform=o(r.deltaFinal,r.treeScale,p?f:void 0),a&&(l.transform=a(f,l.transform)),l.transformOrigin=s(r)):(p&&(l.transform=rTe(e,i,m,a)),g&&(l.transformOrigin=iTe(h)))}var aR=function(){return{style:{},transform:{},transformKeys:[],transformOrigin:{},vars:{}}};function sq(e,t,n){for(var r in t)!bf(t[r])&&!XV(r,n)&&(e[r]=t[r])}function vTe(e,t,n){var r=e.transformTemplate;return xr(function(){var i=aR();iR(i,t,void 0,void 0,{enableHardwareAcceleration:!n},r);var a=i.vars,o=i.style;return Ie(Ie({},a),o)},[t])}function yTe(e,t,n){var r=e.style||{},i={};return sq(i,r,e),Object.assign(i,vTe(e,t,n)),e.transformValues&&(i=e.transformValues(i)),i}function bTe(e,t,n){var r={},i=yTe(e,t,n);return Boolean(e.drag)&&(r.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=e.drag===!0?"none":"pan-"+(e.drag==="x"?"y":"x")),r.style=i,r}var xTe=new Set(["initial","animate","exit","style","variants","transition","transformTemplate","transformValues","custom","inherit","layout","layoutId","_layoutResetTransform","onLayoutAnimationComplete","onViewportBoxUpdate","onLayoutMeasure","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","drag","dragControls","dragListener","dragConstraints","dragDirectionLock","_dragX","_dragY","dragElastic","dragMomentum","dragPropagation","dragTransition","whileDrag","onPan","onPanStart","onPanEnd","onPanSessionStart","onTap","onTapStart","onTapCancel","onHoverStart","onHoverEnd","whileFocus","whileTap","whileHover"]);function __(e){return xTe.has(e)}var uq=function(e){return!__(e)};try{var wTe=require("@emotion/is-prop-valid").default;uq=function(e){return e.startsWith("on")?!__(e):wTe(e)}}catch(e){}function _Te(e,t,n){var r={};for(var i in e)(uq(i)||n===!0&&__(i)||!t&&!__(i))&&(r[i]=e[i]);return r}function lq(e,t,n){return typeof e=="string"?e:Tt.transform(t+n*e)}function STe(e,t,n){var r=lq(t,e.x,e.width),i=lq(n,e.y,e.height);return r+" "+i}var oR=function(e,t){return Tt.transform(e*t)},ETe={offset:"stroke-dashoffset",array:"stroke-dasharray"},CTe={offset:"strokeDashoffset",array:"strokeDasharray"};function ATe(e,t,n,r,i,a){r===void 0&&(r=1),i===void 0&&(i=0),a===void 0&&(a=!0);var o=a?ETe:CTe;e[o.offset]=oR(-i,t);var s=oR(n,t),u=oR(r,t);e[o.array]=s+" "+u}function sR(e,t,n,r,i,a,o,s){var u=t.attrX,l=t.attrY,c=t.originX,f=t.originY,d=t.pathLength,h=t.pathSpacing,p=h===void 0?1:h,g=t.pathOffset,m=g===void 0?0:g,v=ko(t,["attrX","attrY","originX","originY","pathLength","pathSpacing","pathOffset"]);iR(e,v,n,r,i,a,o,s),e.attrs=e.style,e.style={};var y=e.attrs,b=e.style,x=e.dimensions,w=e.totalPathLength;y.transform&&(x&&(b.transform=y.transform),delete y.transform),x&&(c!==void 0||f!==void 0||b.transform)&&(b.transformOrigin=STe(x,c!==void 0?c:.5,f!==void 0?f:.5)),u!==void 0&&(y.x=u),l!==void 0&&(y.y=l),w!==void 0&&d!==void 0&&ATe(y,w,d,p,m,!1)}var cq=function(){return Ie(Ie({},aR()),{attrs:{}})};function kTe(e,t){var n=xr(function(){var i=cq();return sR(i,t,void 0,void 0,{enableHardwareAcceleration:!1},e.transformTemplate),Ie(Ie({},i.attrs),{style:Ie({},i.style)})},[t]);if(e.style){var r={};sq(r,e.style,e),n.style=Ie(Ie({},r),n.style)}return n}function TTe(e){e===void 0&&(e=!1);var t=function(n,r,i,a,o){var s=a.latestValues,u=JD(n)?kTe:bTe,l=u(r,s,o),c=_Te(r,typeof n=="string",e),f=Ie(Ie(Ie({},c),l),{ref:i});return ue(n,f)};return t}var OTe=/([a-z])([A-Z])/g,ITe="$1-$2",fq=function(e){return e.replace(OTe,ITe).toLowerCase()};function dq(e,t){var n=t.style,r=t.vars;Object.assign(e.style,n);for(var i in r)e.style.setProperty(i,r[i])}var hq=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform"]);function pq(e,t){dq(e,t);for(var n in t.attrs)e.setAttribute(hq.has(n)?n:fq(n),t.attrs[n])}function uR(e){var t=e.style,n={};for(var r in t)(bf(t[r])||XV(r,e))&&(n[r]=t[r]);return n}function gq(e){var t=uR(e);for(var n in e)if(bf(e[n])){var r=n==="x"||n==="y"?"attr"+n.toUpperCase():n;t[r]=e[n]}return t}function lR(e){return typeof e=="object"&&typeof e.start=="function"}var Iy=function(e){return Array.isArray(e)},NTe=function(e){return Boolean(e&&typeof e=="object"&&e.mix&&e.toValue)},DTe=function(e){return Iy(e)?e[e.length-1]||0:e};function RTe(e){var t=bf(e)?e.get():e;return NTe(t)?t.toValue():t}function mq(e,t,n,r){var i=e.scrapeMotionValuesFromProps,a=e.createRenderState,o=e.onMount,s={latestValues:FTe(t,n,r,i),renderState:a()};return o&&(s.mount=function(u){return o(t,u,s)}),s}var vq=function(e){return function(t,n){var r=Un(v_),i=Un(xy);return n?mq(e,t,r,i):wy(function(){return mq(e,t,r,i)})}};function FTe(e,t,n,r){var i={},a=(n==null?void 0:n.initial)===!1,o=r(e);for(var s in o)i[s]=RTe(o[s]);var u=e.initial,l=e.animate,c=b_(e),f=HV(e);t&&f&&!c&&e.inherit!==!1&&(u??(u=t.initial),l??(l=t.animate));var d=a||u===!1?l:u;if(d&&typeof d!="boolean"&&!lR(d)){var h=Array.isArray(d)?d:[d];h.forEach(function(p){var g=qV(e,p);if(!!g){var m=g.transitionEnd;g.transition;var v=ko(g,["transitionEnd","transition"]);for(var y in v)i[y]=v[y];for(var y in m)i[y]=m[y]}})}return i}var MTe={useVisualState:vq({scrapeMotionValuesFromProps:gq,createRenderState:cq,onMount:function(e,t,n){var r=n.renderState,i=n.latestValues;try{r.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch(a){r.dimensions={x:0,y:0,width:0,height:0}}PTe(t)&&(r.totalPathLength=t.getTotalLength()),sR(r,i,void 0,void 0,{enableHardwareAcceleration:!1},e.transformTemplate),pq(t,r)}})};function PTe(e){return e.tagName==="path"}var $Te={useVisualState:vq({scrapeMotionValuesFromProps:uR,createRenderState:aR})};function LTe(e,t,n,r){var i=t.forwardMotionProps,a=i===void 0?!1:i,o=JD(e)?MTe:$Te;return Ie(Ie({},o),{preloadedFeatures:n,useRender:TTe(a),createVisualElement:r,Component:e})}var _r;(function(e){e.Animate="animate",e.Hover="whileHover",e.Tap="whileTap",e.Drag="whileDrag",e.Focus="whileFocus",e.Exit="exit"})(_r||(_r={}));function cR(e,t,n,r){return e.addEventListener(t,n,r),function(){return e.removeEventListener(t,n,r)}}function fR(e,t,n,r){qt(function(){var i=e.current;if(n&&i)return cR(i,t,n,r)},[e,t,n,r])}function BTe(e){var t=e.whileFocus,n=e.visualElement,r=function(){var a;(a=n.animationState)===null||a===void 0||a.setActive(_r.Focus,!0)},i=function(){var a;(a=n.animationState)===null||a===void 0||a.setActive(_r.Focus,!1)};fR(n,"focus",t?r:void 0),fR(n,"blur",t?i:void 0)}function yq(e){return typeof PointerEvent!="undefined"&&e instanceof PointerEvent?e.pointerType==="mouse":e instanceof MouseEvent}function bq(e){var t=!!e.touches;return t}function zTe(e){return function(t){var n=t instanceof MouseEvent,r=!n||n&&t.button===0;r&&e(t)}}var jTe={pageX:0,pageY:0};function UTe(e,t){t===void 0&&(t="page");var n=e.touches[0]||e.changedTouches[0],r=n||jTe;return{x:r[t+"X"],y:r[t+"Y"]}}function WTe(e,t){return t===void 0&&(t="page"),{x:e[t+"X"],y:e[t+"Y"]}}function dR(e,t){return t===void 0&&(t="page"),{point:bq(e)?UTe(e,t):WTe(e,t)}}function VTe(e){return dR(e,"client")}var xq=function(e,t){t===void 0&&(t=!1);var n=function(r){return e(r,dR(r))};return t?zTe(n):n},qTe=function(){return _y&&window.onpointerdown===null},HTe=function(){return _y&&window.ontouchstart===null},GTe=function(){return _y&&window.onmousedown===null},KTe={pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointercancel:"mousecancel",pointerover:"mouseover",pointerout:"mouseout",pointerenter:"mouseenter",pointerleave:"mouseleave"},XTe={pointerdown:"touchstart",pointermove:"touchmove",pointerup:"touchend",pointercancel:"touchcancel"};function wq(e){return qTe()?e:HTe()?XTe[e]:GTe()?KTe[e]:e}function am(e,t,n,r){return cR(e,wq(t),xq(n,t==="pointerdown"),r)}function S_(e,t,n,r){return fR(e,wq(t),n&&xq(n,t==="pointerdown"),r)}function _q(e){var t=null;return function(){var n=function(){t=null};return t===null?(t=e,n):!1}}var Sq=_q("dragHorizontal"),Eq=_q("dragVertical");function Cq(e){var t=!1;if(e==="y")t=Eq();else if(e==="x")t=Sq();else{var n=Sq(),r=Eq();n&&r?t=function(){n(),r()}:(n&&n(),r&&r())}return t}function Aq(){var e=Cq(!0);return e?(e(),!1):!0}function kq(e,t,n){return function(r,i){var a;!yq(r)||Aq()||(n==null||n(r,i),(a=e.animationState)===null||a===void 0||a.setActive(_r.Hover,t))}}function YTe(e){var t=e.onHoverStart,n=e.onHoverEnd,r=e.whileHover,i=e.visualElement;S_(i,"pointerenter",t||r?kq(i,!0,t):void 0),S_(i,"pointerleave",n||r?kq(i,!1,n):void 0)}var Tq=function(e,t){return t?e===t?!0:Tq(e,t.parentElement):!1};function hR(e){return qt(function(){return function(){return e()}},[])}var E_=function(e,t,n){return Math.min(Math.max(n,e),t)},pR=.001,ZTe=.01,JTe=10,QTe=.05,eOe=1;function tOe(e){var t=e.duration,n=t===void 0?800:t,r=e.bounce,i=r===void 0?.25:r,a=e.velocity,o=a===void 0?0:a,s=e.mass,u=s===void 0?1:s,l,c,f=1-i;f=E_(QTe,eOe,f),n=E_(ZTe,JTe,n/1e3),f<1?(l=function(g){var m=g*f,v=m*n,y=m-o,b=gR(g,f),x=Math.exp(-v);return pR-y/b*x},c=function(g){var m=g*f,v=m*n,y=v*o+o,b=Math.pow(f,2)*Math.pow(g,2)*n,x=Math.exp(-v),w=gR(Math.pow(g,2),f),S=-l(g)+pR>0?-1:1;return S*((y-b)*x)/w}):(l=function(g){var m=Math.exp(-g*n),v=(g-o)*n+1;return-pR+m*v},c=function(g){var m=Math.exp(-g*n),v=(o-g)*(n*n);return m*v});var d=5/n,h=rOe(l,c,d);if(n=n*1e3,isNaN(h))return{stiffness:100,damping:10,duration:n};var p=Math.pow(h,2)*u;return{stiffness:p,damping:f*2*Math.sqrt(u*p),duration:n}}var nOe=12;function rOe(e,t,n){for(var r=n,i=1;i<nOe;i++)r=r-e(r)/t(r);return r}function gR(e,t){return e*Math.sqrt(1-t*t)}var iOe=["duration","bounce"],aOe=["stiffness","damping","mass"];function Oq(e,t){return t.some(function(n){return e[n]!==void 0})}function oOe(e){var t=Ie({velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1},e);if(!Oq(e,aOe)&&Oq(e,iOe)){var n=tOe(e);t=Ie(Ie(Ie({},t),n),{velocity:0,mass:1}),t.isResolvedFromDuration=!0}return t}function mR(e){var t=e.from,n=t===void 0?0:t,r=e.to,i=r===void 0?1:r,a=e.restSpeed,o=a===void 0?2:a,s=e.restDelta,u=ko(e,["from","to","restSpeed","restDelta"]),l={done:!1,value:n},c=oOe(u),f=c.stiffness,d=c.damping,h=c.mass,p=c.velocity,g=c.duration,m=c.isResolvedFromDuration,v=Iq,y=Iq;function b(){var x=p?-(p/1e3):0,w=i-n,S=d/(2*Math.sqrt(f*h)),C=Math.sqrt(f/h)/1e3;if(s??(s=Math.abs(i-n)<=1?.01:.4),S<1){var _=gR(C,S);v=function(A){var k=Math.exp(-S*C*A);return i-k*((x+S*C*w)/_*Math.sin(_*A)+w*Math.cos(_*A))},y=function(A){var k=Math.exp(-S*C*A);return S*C*k*(Math.sin(_*A)*(x+S*C*w)/_+w*Math.cos(_*A))-k*(Math.cos(_*A)*(x+S*C*w)-_*w*Math.sin(_*A))}}else if(S===1)v=function(A){return i-Math.exp(-C*A)*(w+(x+C*w)*A)};else{var E=C*Math.sqrt(S*S-1);v=function(A){var k=Math.exp(-S*C*A),T=Math.min(E*A,300);return i-k*((x+S*C*w)*Math.sinh(T)+E*w*Math.cosh(T))/E}}}return b(),{next:function(x){var w=v(x);if(m)l.done=x>=g;else{var S=y(x)*1e3,C=Math.abs(S)<=o,_=Math.abs(i-w)<=s;l.done=C&&_}return l.value=l.done?i:w,l},flipTarget:function(){var x;p=-p,x=[i,n],n=x[0],i=x[1],b()}}}mR.needsInterpolation=function(e,t){return typeof e=="string"||typeof t=="string"};var Iq=function(e){return 0},Ny=function(e,t,n){var r=t-e;return r===0?1:(n-e)/r},Ya=function(e,t,n){return-n*e+n*t+e},sOe=function(e,t,n){var r=e*e,i=t*t;return Math.sqrt(Math.max(0,n*(i-r)+r))},uOe=[nR,im,rm],Nq=function(e){return uOe.find(function(t){return t.test(e)})},Dq=function(e,t){var n=Nq(e),r=Nq(t);by(n.transform===r.transform);var i=n.parse(e),a=r.parse(t),o=Ie({},i),s=n===rm?Ya:sOe;return function(u){for(var l in o)l!=="alpha"&&(o[l]=s(i[l],a[l],u));return o.alpha=Ya(i.alpha,a.alpha,u),n.transform(o)}},vR=function(e){return typeof e=="number"},lOe=function(e,t){return function(n){return t(e(n))}},Dy=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce(lOe)};function Rq(e,t){return vR(e)?function(n){return Ya(e,t,n)}:va.test(e)?Dq(e,t):Pq(e,t)}var Fq=function(e,t){var n=ma([],e),r=n.length,i=e.map(function(a,o){return Rq(a,t[o])});return function(a){for(var o=0;o<r;o++)n[o]=i[o](a);return n}},cOe=function(e,t){var n=Ie(Ie({},e),t),r={};for(var i in n)e[i]!==void 0&&t[i]!==void 0&&(r[i]=Rq(e[i],t[i]));return function(a){for(var o in r)n[o]=r[o](a);return n}};function Mq(e){for(var t=Zl.parse(e),n=t.length,r=0,i=0,a=0,o=0;o<n;o++)r||typeof t[o]=="number"?r++:t[o].hue!==void 0?a++:i++;return{parsed:t,numNumbers:r,numRGB:i,numHSL:a}}var Pq=function(e,t){var n=Zl.createTransformer(t),r=Mq(e),i=Mq(t);return Dy(Fq(r.parsed,i.parsed),n)},fOe=function(e,t){return function(n){return Ya(e,t,n)}};function dOe(e){if(typeof e=="number")return fOe;if(typeof e=="string")return va.test(e)?Dq:Pq;if(Array.isArray(e))return Fq;if(typeof e=="object")return cOe}function hOe(e,t,n){for(var r=[],i=n||dOe(e[0]),a=e.length-1,o=0;o<a;o++){var s=i(e[o],e[o+1]);if(t){var u=Array.isArray(t)?t[o]:t;s=Dy(u,s)}r.push(s)}return r}function pOe(e,t){var n=e[0],r=e[1],i=t[0];return function(a){return i(Ny(n,r,a))}}function gOe(e,t){var n=e.length,r=n-1;return function(i){var a=0,o=!1;if(i<=e[0]?o=!0:i>=e[r]&&(a=r-1,o=!0),!o){for(var s=1;s<n&&!(e[s]>i||s===r);s++);a=s-1}var u=Ny(e[a],e[a+1],i);return t[a](u)}}function $q(e,t,n){var r=n===void 0?{}:n,i=r.clamp,a=i===void 0?!0:i,o=r.ease,s=r.mixer,u=e.length;by(u===t.length),by(!o||!Array.isArray(o)||o.length===u-1),e[0]>e[u-1]&&(e=[].concat(e),t=[].concat(t),e.reverse(),t.reverse());var l=hOe(t,o,s),c=u===2?pOe(e,l):gOe(e,l);return a?function(f){return c(E_(e[0],e[u-1],f))}:c}var C_=function(e){return function(t){return 1-e(1-t)}},yR=function(e){return function(t){return t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2}},mOe=function(e){return function(t){return Math.pow(t,e)}},Lq=function(e){return function(t){return t*t*((e+1)*t-e)}},vOe=function(e){var t=Lq(e);return function(n){return(n*=2)<1?.5*t(n):.5*(2-Math.pow(2,-10*(n-1)))}},Bq=1.525,yOe=4/11,bOe=8/11,xOe=9/10,zq=function(e){return e},bR=mOe(2),wOe=C_(bR),jq=yR(bR),Uq=function(e){return 1-Math.sin(Math.acos(e))},Wq=C_(Uq),_Oe=yR(Wq),xR=Lq(Bq),SOe=C_(xR),EOe=yR(xR),COe=vOe(Bq),AOe=4356/361,kOe=35442/1805,TOe=16061/1805,A_=function(e){if(e===1||e===0)return e;var t=e*e;return e<yOe?7.5625*t:e<bOe?9.075*t-9.9*e+3.4:e<xOe?AOe*t-kOe*e+TOe:10.8*e*e-20.52*e+10.72},OOe=C_(A_),IOe=function(e){return e<.5?.5*(1-A_(1-e*2)):.5*A_(e*2-1)+.5};function NOe(e,t){return e.map(function(){return t||jq}).splice(0,e.length-1)}function DOe(e){var t=e.length;return e.map(function(n,r){return r!==0?r/(t-1):0})}function ROe(e,t){return e.map(function(n){return n*t})}function k_(e){var t=e.from,n=t===void 0?0:t,r=e.to,i=r===void 0?1:r,a=e.ease,o=e.offset,s=e.duration,u=s===void 0?300:s,l={done:!1,value:n},c=Array.isArray(i)?i:[n,i],f=ROe(o&&o.length===c.length?o:DOe(c),u);function d(){return $q(f,c,{ease:Array.isArray(a)?a:NOe(c,a)})}var h=d();return{next:function(p){return l.value=h(p),l.done=p>=u,l},flipTarget:function(){c.reverse(),h=d()}}}function FOe(e){var t=e.velocity,n=t===void 0?0:t,r=e.from,i=r===void 0?0:r,a=e.power,o=a===void 0?.8:a,s=e.timeConstant,u=s===void 0?350:s,l=e.restDelta,c=l===void 0?.5:l,f=e.modifyTarget,d={done:!1,value:i},h=o*n,p=i+h,g=f===void 0?p:f(p);return g!==p&&(h=g-i),{next:function(m){var v=-h*Math.exp(-m/u);return d.done=!(v>c||v<-c),d.value=d.done?g:g+v,d},flipTarget:function(){}}}var Vq={keyframes:k_,spring:mR,decay:FOe};function MOe(e){if(Array.isArray(e.to))return k_;if(Vq[e.type])return Vq[e.type];var t=new Set(Object.keys(e));return t.has("ease")||t.has("duration")&&!t.has("dampingRatio")?k_:t.has("dampingRatio")||t.has("stiffness")||t.has("mass")||t.has("damping")||t.has("restSpeed")||t.has("restDelta")?mR:k_}function qq(e,t,n){return n===void 0&&(n=0),e-t-n}function POe(e,t,n,r){return n===void 0&&(n=0),r===void 0&&(r=!0),r?qq(t+-e,t,n):t-(e-t)+n}function $Oe(e,t,n,r){return r?e>=t+n:e<=-n}var LOe=function(e){var t=function(n){var r=n.delta;return e(r)};return{start:function(){return Fu.update(t,!0)},stop:function(){return sy.update(t)}}};function Hq(e){var t,n,r=e.from,i=e.autoplay,a=i===void 0?!0:i,o=e.driver,s=o===void 0?LOe:o,u=e.elapsed,l=u===void 0?0:u,c=e.repeat,f=c===void 0?0:c,d=e.repeatType,h=d===void 0?"loop":d,p=e.repeatDelay,g=p===void 0?0:p,m=e.onPlay,v=e.onStop,y=e.onComplete,b=e.onRepeat,x=e.onUpdate,w=ko(e,["from","autoplay","driver","elapsed","repeat","repeatType","repeatDelay","onPlay","onStop","onComplete","onRepeat","onUpdate"]),S=w.to,C,_=0,E=w.duration,A,k=!1,T=!0,I,N=MOe(w);((n=(t=N).needsInterpolation)===null||n===void 0?void 0:n.call(t,r,S))&&(I=$q([0,100],[r,S],{clamp:!1}),r=0,S=100);var O=N(Ie(Ie({},w),{from:r,to:S}));function D(){_++,h==="reverse"?(T=_%2==0,l=POe(l,E,g,T)):(l=qq(l,E,g),h==="mirror"&&O.flipTarget()),k=!1,b&&b()}function L(){C.stop(),y&&y()}function W(K){if(T||(K=-K),l+=K,!k){var ee=O.next(Math.max(0,l));A=ee.value,I&&(A=I(A)),k=T?ee.done:l<=0}x==null||x(A),k&&(_===0&&(E??(E=l)),_<f?$Oe(l,E,g,T)&&D():L())}function G(){m==null||m(),C=s(W),C.start()}return a&&G(),{stop:function(){v==null||v(),C.stop()}}}function Gq(e,t){return t?e*(1e3/t):0}function BOe(e){var t=e.from,n=t===void 0?0:t,r=e.velocity,i=r===void 0?0:r,a=e.min,o=e.max,s=e.power,u=s===void 0?.8:s,l=e.timeConstant,c=l===void 0?750:l,f=e.bounceStiffness,d=f===void 0?500:f,h=e.bounceDamping,p=h===void 0?10:h,g=e.restDelta,m=g===void 0?1:g,v=e.modifyTarget,y=e.driver,b=e.onUpdate,x=e.onComplete,w;function S(D){return a!==void 0&&D<a||o!==void 0&&D>o}function C(D){return a===void 0?o:o===void 0||Math.abs(a-D)<Math.abs(o-D)?a:o}function _(D){w==null||w.stop(),w=Hq(Ie(Ie({},D),{driver:y,onUpdate:function(L){var W;b==null||b(L),(W=D.onUpdate)===null||W===void 0||W.call(D,L)},onComplete:x}))}function E(D){_(Ie({type:"spring",stiffness:d,damping:p,restDelta:m},D))}if(S(n))E({from:n,velocity:i,to:C(n)});else{var A=u*i+n;typeof v!="undefined"&&(A=v(A));var k=C(A),T=k===a?-1:1,I,N,O=function(D){I=N,N=D,i=Gq(D-I,n_().delta),(T===1&&D>k||T===-1&&D<k)&&E({from:D,to:k,velocity:i})};_({type:"decay",from:n,velocity:i,timeConstant:c,power:u,restDelta:m,modifyTarget:v,onUpdate:S(A)?O:void 0})}return{stop:function(){return w==null?void 0:w.stop()}}}var wR=function(e){return e.hasOwnProperty("x")&&e.hasOwnProperty("y")},Kq=function(e){return wR(e)&&e.hasOwnProperty("z")},T_=function(e,t){return Math.abs(e-t)};function Xq(e,t){if(vR(e)&&vR(t))return T_(e,t);if(wR(e)&&wR(t)){var n=T_(e.x,t.x),r=T_(e.y,t.y),i=Kq(e)&&Kq(t)?T_(e.z,t.z):0;return Math.sqrt(Math.pow(n,2)+Math.pow(r,2)+Math.pow(i,2))}}var Yq=function(e,t){return 1-3*t+3*e},Zq=function(e,t){return 3*t-6*e},Jq=function(e){return 3*e},O_=function(e,t,n){return((Yq(t,n)*e+Zq(t,n))*e+Jq(t))*e},Qq=function(e,t,n){return 3*Yq(t,n)*e*e+2*Zq(t,n)*e+Jq(t)},zOe=1e-7,jOe=10;function UOe(e,t,n,r,i){var a,o,s=0;do o=t+(n-t)/2,a=O_(o,r,i)-e,a>0?n=o:t=o;while(Math.abs(a)>zOe&&++s<jOe);return o}var WOe=8,VOe=.001;function qOe(e,t,n,r){for(var i=0;i<WOe;++i){var a=Qq(t,n,r);if(a===0)return t;var o=O_(t,n,r)-e;t-=o/a}return t}var I_=11,N_=1/(I_-1);function HOe(e,t,n,r){if(e===t&&n===r)return zq;for(var i=new Float32Array(I_),a=0;a<I_;++a)i[a]=O_(a*N_,e,n);function o(s){for(var u=0,l=1,c=I_-1;l!==c&&i[l]<=s;++l)u+=N_;--l;var f=(s-i[l])/(i[l+1]-i[l]),d=u+f*N_,h=Qq(d,e,n);return h>=VOe?qOe(s,d,e,n):h===0?d:UOe(s,u,u+N_,e,n)}return function(s){return s===0||s===1?s:O_(o(s),t,r)}}function GOe(e){var t=e.onTap,n=e.onTapStart,r=e.onTapCancel,i=e.whileTap,a=e.visualElement,o=t||n||r||i,s=Jt(!1),u=Jt(null);function l(){var p;(p=u.current)===null||p===void 0||p.call(u),u.current=null}function c(){var p;return l(),s.current=!1,(p=a.animationState)===null||p===void 0||p.setActive(_r.Tap,!1),!Aq()}function f(p,g){!c()||(Tq(a.getInstance(),p.target)?t==null||t(p,g):r==null||r(p,g))}function d(p,g){!c()||r==null||r(p,g)}function h(p,g){var m;l(),!s.current&&(s.current=!0,u.current=Dy(am(window,"pointerup",f),am(window,"pointercancel",d)),n==null||n(p,g),(m=a.animationState)===null||m===void 0||m.setActive(_r.Tap,!0))}S_(a,"pointerdown",o?h:void 0),hR(l)}var wh=function(e){return function(t){return e(t),null}},KOe={tap:wh(GOe),focus:wh(BTe),hover:wh(YTe)};function eH(e,t){if(!Array.isArray(t))return!1;var n=t.length;if(n!==e.length)return!1;for(var r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}var D_=function(e){return e*1e3},XOe={linear:zq,easeIn:bR,easeInOut:jq,easeOut:wOe,circIn:Uq,circInOut:_Oe,circOut:Wq,backIn:xR,backInOut:EOe,backOut:SOe,anticipate:COe,bounceIn:OOe,bounceInOut:IOe,bounceOut:A_},tH=function(e){if(Array.isArray(e)){by(e.length===4);var t=pr(e,4),n=t[0],r=t[1],i=t[2],a=t[3];return HOe(n,r,i,a)}else if(typeof e=="string")return XOe[e];return e},YOe=function(e){return Array.isArray(e)&&typeof e[0]!="number"},nH=function(e,t){return e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&Zl.test(t)&&!t.startsWith("url("))},_h=function(){return{type:"spring",stiffness:500,damping:25,restDelta:.5,restSpeed:10}},R_=function(e){return{type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restDelta:.01,restSpeed:10}},_R=function(){return{type:"keyframes",ease:"linear",duration:.3}},ZOe=function(e){return{type:"keyframes",duration:.8,values:e}},rH={x:_h,y:_h,z:_h,rotate:_h,rotateX:_h,rotateY:_h,rotateZ:_h,scaleX:R_,scaleY:R_,scale:R_,opacity:_R,backgroundColor:_R,color:_R,default:R_},JOe=function(e,t){var n;return Iy(t)?n=ZOe:n=rH[e]||rH.default,Ie({to:t},n(t))},QOe=Ie(Ie({},oq),{color:va,backgroundColor:va,outlineColor:va,fill:va,stroke:va,borderColor:va,borderTopColor:va,borderRightColor:va,borderBottomColor:va,borderLeftColor:va,filter:rR,WebkitFilter:rR}),SR=function(e){return QOe[e]};function ER(e,t){var n,r=SR(e);return r!==rR&&(r=Zl),(n=r.getAnimatableNone)===null||n===void 0?void 0:n.call(r,t)}function eIe(e){e.when,e.delay,e.delayChildren,e.staggerChildren,e.staggerDirection,e.repeat,e.repeatType,e.repeatDelay,e.from;var t=ko(e,["when","delay","delayChildren","staggerChildren","staggerDirection","repeat","repeatType","repeatDelay","from"]);return!!Object.keys(t).length}function tIe(e){var t=e.ease,n=e.times,r=e.yoyo,i=e.flip,a=e.loop,o=ko(e,["ease","times","yoyo","flip","loop"]),s=Ie({},o);return n&&(s.offset=n),o.duration&&(s.duration=D_(o.duration)),o.repeatDelay&&(s.repeatDelay=D_(o.repeatDelay)),t&&(s.ease=YOe(t)?t.map(tH):tH(t)),o.type==="tween"&&(s.type="keyframes"),(r||a||i)&&(r?s.repeatType="reverse":a?s.repeatType="loop":i&&(s.repeatType="mirror"),s.repeat=a||r||i||o.repeat),o.type!=="spring"&&(s.type="keyframes"),s}function nIe(e,t){var n,r=CR(e,t)||{};return(n=r.delay)!==null&&n!==void 0?n:0}function rIe(e){return Array.isArray(e.to)&&e.to[0]===null&&(e.to=ma([],pr(e.to)),e.to[0]=e.from),e}function iIe(e,t,n){var r;return Array.isArray(t.to)&&((r=e.duration)!==null&&r!==void 0||(e.duration=.8)),rIe(t),eIe(e)||(e=Ie(Ie({},e),JOe(n,t.to))),Ie(Ie({},t),tIe(e))}function aIe(e,t,n,r,i){var a,o=CR(r,e),s=(a=o.from)!==null&&a!==void 0?a:t.get(),u=nH(e,n);s==="none"&&u&&typeof n=="string"?s=ER(e,n):iH(s)&&typeof n=="string"?s=aH(n):!Array.isArray(n)&&iH(n)&&typeof s=="string"&&(n=aH(s));var l=nH(e,s);function c(){var d={from:s,to:n,velocity:t.getVelocity(),onComplete:i,onUpdate:function(h){return t.set(h)}};return o.type==="inertia"||o.type==="decay"?BOe(Ie(Ie({},d),o)):Hq(Ie(Ie({},iIe(o,d,e)),{onUpdate:function(h){var p;d.onUpdate(h),(p=o.onUpdate)===null||p===void 0||p.call(o,h)},onComplete:function(){var h;d.onComplete(),(h=o.onComplete)===null||h===void 0||h.call(o)}}))}function f(){var d;return t.set(n),i(),(d=o==null?void 0:o.onComplete)===null||d===void 0||d.call(o),{stop:function(){}}}return!l||!u||o.type===!1?f:c}function iH(e){return e===0||typeof e=="string"&&parseFloat(e)===0&&e.indexOf(" ")===-1}function aH(e){return typeof e=="number"?0:ER("",e)}function CR(e,t){return e[t]||e.default||e}function F_(e,t,n,r){return r===void 0&&(r={}),t.start(function(i){var a,o,s=aIe(e,t,n,r,i),u=nIe(r,e),l=function(){return o=s()};return u?a=setTimeout(l,D_(u)):l(),function(){clearTimeout(a),o==null||o.stop()}})}var oIe=function(e){return/^\-?\d*\.?\d+$/.test(e)};function oH(e,t){e.indexOf(t)===-1&&e.push(t)}function sH(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var M_=function(){function e(){this.subscriptions=[]}return e.prototype.add=function(t){var n=this;return oH(this.subscriptions,t),function(){return sH(n.subscriptions,t)}},e.prototype.notify=function(t,n,r){var i=this.subscriptions.length;if(!!i)if(i===1)this.subscriptions[0](t,n,r);else for(var a=0;a<i;a++){var o=this.subscriptions[a];o&&o(t,n,r)}},e.prototype.getSize=function(){return this.subscriptions.length},e.prototype.clear=function(){this.subscriptions.length=0},e}(),sIe=function(e){return!isNaN(parseFloat(e))},uIe=function(){function e(t){var n=this;this.timeDelta=0,this.lastUpdated=0,this.updateSubscribers=new M_,this.velocityUpdateSubscribers=new M_,this.renderSubscribers=new M_,this.canTrackVelocity=!1,this.updateAndNotify=function(r,i){i===void 0&&(i=!0),n.prev=n.current,n.current=r;var a=n_(),o=a.delta,s=a.timestamp;n.lastUpdated!==s&&(n.timeDelta=o,n.lastUpdated=s,Fu.postRender(n.scheduleVelocityCheck)),n.prev!==n.current&&n.updateSubscribers.notify(n.current),n.velocityUpdateSubscribers.getSize()&&n.velocityUpdateSubscribers.notify(n.getVelocity()),i&&n.renderSubscribers.notify(n.current)},this.scheduleVelocityCheck=function(){return Fu.postRender(n.velocityCheck)},this.velocityCheck=function(r){var i=r.timestamp;i!==n.lastUpdated&&(n.prev=n.current,n.velocityUpdateSubscribers.notify(n.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=t,this.canTrackVelocity=sIe(this.current)}return e.prototype.onChange=function(t){return this.updateSubscribers.add(t)},e.prototype.clearListeners=function(){this.updateSubscribers.clear()},e.prototype.onRenderRequest=function(t){return t(this.get()),this.renderSubscribers.add(t)},e.prototype.attach=function(t){this.passiveEffect=t},e.prototype.set=function(t,n){n===void 0&&(n=!0),!n||!this.passiveEffect?this.updateAndNotify(t,n):this.passiveEffect(t,this.updateAndNotify)},e.prototype.get=function(){return this.current},e.prototype.getPrevious=function(){return this.prev},e.prototype.getVelocity=function(){return this.canTrackVelocity?Gq(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0},e.prototype.start=function(t){var n=this;return this.stop(),new Promise(function(r){n.hasAnimated=!0,n.stopAnimation=t(r)}).then(function(){return n.clearAnimation()})},e.prototype.stop=function(){this.stopAnimation&&this.stopAnimation(),this.clearAnimation()},e.prototype.isAnimating=function(){return!!this.stopAnimation},e.prototype.clearAnimation=function(){this.stopAnimation=null},e.prototype.destroy=function(){this.updateSubscribers.clear(),this.renderSubscribers.clear(),this.stop()},e}();function Sh(e){return new uIe(e)}var uH=function(e){return function(t){return t.test(e)}},lIe={test:function(e){return e==="auto"},parse:function(e){return e}},lH=[xh,Tt,nm,xf,uTe,sTe,lIe],P_=function(e){return lH.find(uH(e))},cIe=ma(ma([],pr(lH)),[va,Zl]),fIe=function(e){return cIe.find(uH(e))};function dIe(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,Sh(n))}function hIe(e,t){var n=y_(e,t),r=n?e.makeTargetAnimatable(n,!1):{},i=r.transitionEnd,a=i===void 0?{}:i;r.transition;var o=ko(r,["transitionEnd","transition"]);o=Ie(Ie({},o),a);for(var s in o){var u=DTe(o[s]);dIe(e,s,u)}}function pIe(e,t,n){var r,i,a,o,s=Object.keys(t).filter(function(h){return!e.hasValue(h)}),u=s.length;if(!!u)for(var l=0;l<u;l++){var c=s[l],f=t[c],d=null;Array.isArray(f)&&(d=f[0]),d===null&&(d=(i=(r=n[c])!==null&&r!==void 0?r:e.readValue(c))!==null&&i!==void 0?i:t[c]),d!=null&&(typeof d=="string"&&oIe(d)?d=parseFloat(d):!fIe(d)&&Zl.test(f)&&(d=ER(c,f)),e.addValue(c,Sh(d)),(a=(o=n)[c])!==null&&a!==void 0||(o[c]=d),e.setBaseTarget(c,d))}}function gIe(e,t){if(!!t){var n=t[e]||t.default||t;return n.from}}function mIe(e,t,n){var r,i,a={};for(var o in e)a[o]=(r=gIe(o,t))!==null&&r!==void 0?r:(i=n.getValue(o))===null||i===void 0?void 0:i.get();return a}function vIe(e,t,n){n===void 0&&(n={}),e.notifyAnimationStart();var r;if(Array.isArray(t)){var i=t.map(function(o){return AR(e,o,n)});r=Promise.all(i)}else if(typeof t=="string")r=AR(e,t,n);else{var a=typeof t=="function"?y_(e,t,n.custom):t;r=cH(e,a,n)}return r.then(function(){return e.notifyAnimationComplete(t)})}function AR(e,t,n){var r;n===void 0&&(n={});var i=y_(e,t,n.custom),a=(i||{}).transition,o=a===void 0?e.getDefaultTransition()||{}:a;n.transitionOverride&&(o=n.transitionOverride);var s=i?function(){return cH(e,i,n)}:function(){return Promise.resolve()},u=((r=e.variantChildren)===null||r===void 0?void 0:r.size)?function(h){h===void 0&&(h=0);var p=o.delayChildren,g=p===void 0?0:p,m=o.staggerChildren,v=o.staggerDirection;return yIe(e,t,g+h,m,v,n)}:function(){return Promise.resolve()},l=o.when;if(l){var c=pr(l==="beforeChildren"?[s,u]:[u,s],2),f=c[0],d=c[1];return f().then(d)}else return Promise.all([s(),u(n.delay)])}function cH(e,t,n){var r,i=n===void 0?{}:n,a=i.delay,o=a===void 0?0:a,s=i.transitionOverride,u=i.type,l=e.makeTargetAnimatable(t),c=l.transition,f=c===void 0?e.getDefaultTransition():c,d=l.transitionEnd,h=ko(l,["transition","transitionEnd"]);s&&(f=s);var p=[],g=u&&((r=e.animationState)===null||r===void 0?void 0:r.getState()[u]);for(var m in h){var v=e.getValue(m),y=h[m];if(!(!v||y===void 0||g&&xIe(g,m))){var b=F_(m,v,y,Ie({delay:o},f));p.push(b)}}return Promise.all(p).then(function(){d&&hIe(e,d)})}function yIe(e,t,n,r,i,a){n===void 0&&(n=0),r===void 0&&(r=0),i===void 0&&(i=1);var o=[],s=(e.variantChildren.size-1)*r,u=i===1?function(l){return l===void 0&&(l=0),l*r}:function(l){return l===void 0&&(l=0),s-l*r};return Array.from(e.variantChildren).sort(bIe).forEach(function(l,c){o.push(AR(l,t,Ie(Ie({},a),{delay:n+u(c)})).then(function(){return l.notifyAnimationComplete(t)}))}),Promise.all(o)}function bIe(e,t){return e.sortNodePosition(t)}function xIe(e,t){var n=e.protectedKeys,r=e.needsAnimating,i=n.hasOwnProperty(t)&&r[t]!==!0;return r[t]=!1,i}var kR=[_r.Animate,_r.Hover,_r.Tap,_r.Drag,_r.Focus,_r.Exit],wIe=ma([],pr(kR)).reverse(),_Ie=kR.length;function SIe(e){return function(t){return Promise.all(t.map(function(n){var r=n.animation,i=n.options;return vIe(e,r,i)}))}}function EIe(e){var t=SIe(e),n=AIe(),r={},i=!0,a=function(c,f){var d=y_(e,f);if(d){d.transition;var h=d.transitionEnd,p=ko(d,["transition","transitionEnd"]);c=Ie(Ie(Ie({},c),p),h)}return c};function o(c){return r[c]!==void 0}function s(c){t=c(e)}function u(c,f){for(var d,h=e.getProps(),p=e.getVariantContext(!0)||{},g=[],m=new Set,v={},y=1/0,b=function(C){var _=wIe[C],E=n[_],A=(d=h[_])!==null&&d!==void 0?d:p[_],k=Ls(A),T=_===f?E.isActive:null;T===!1&&(y=C);var I=A===p[_]&&A!==h[_]&&k;if(I&&i&&e.manuallyAnimateOnMount&&(I=!1),E.protectedKeys=Ie({},v),!E.isActive&&T===null||!A&&!E.prevProp||lR(A)||typeof A=="boolean")return"continue";var N=CIe(E.prevProp,A)||_===f&&E.isActive&&!I&&k||C>y&&k,O=Array.isArray(A)?A:[A],D=O.reduce(a,{});T===!1&&(D={});var L=E.prevResolvedValues,W=L===void 0?{}:L,G=Ie(Ie({},W),D),K=function(Oe){N=!0,m.delete(Oe),E.needsAnimating[Oe]=!0};for(var ee in G){var ce=D[ee],he=W[ee];v.hasOwnProperty(ee)||(ce!==he?Iy(ce)&&Iy(he)?eH(ce,he)?E.protectedKeys[ee]=!0:K(ee):ce!==void 0?K(ee):m.add(ee):ce!==void 0&&m.has(ee)?K(ee):E.protectedKeys[ee]=!0)}E.prevProp=A,E.prevResolvedValues=D,E.isActive&&(v=Ie(Ie({},v),D)),i&&e.blockInitialAnimation&&(N=!1),N&&!I&&g.push.apply(g,ma([],pr(O.map(function(Oe){return{animation:Oe,options:Ie({type:_},c)}}))))},x=0;x<_Ie;x++)b(x);if(r=Ie({},v),m.size){var w={};m.forEach(function(C){var _=e.getBaseTarget(C);_!==void 0&&(w[C]=_)}),g.push({animation:w})}var S=Boolean(g.length);return i&&h.initial===!1&&!e.manuallyAnimateOnMount&&(S=!1),i=!1,S?t(g):Promise.resolve()}function l(c,f,d){var h;return n[c].isActive===f?Promise.resolve():((h=e.variantChildren)===null||h===void 0||h.forEach(function(p){var g;return(g=p.animationState)===null||g===void 0?void 0:g.setActive(c,f)}),n[c].isActive=f,u(d,c))}return{isAnimated:o,animateChanges:u,setActive:l,setAnimateFunction:s,getState:function(){return n}}}function CIe(e,t){return typeof t=="string"?t!==e:VV(t)?!eH(t,e):!1}function om(e){return e===void 0&&(e=!1),{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function AIe(){var e;return e={},e[_r.Animate]=om(!0),e[_r.Hover]=om(),e[_r.Tap]=om(),e[_r.Drag]=om(),e[_r.Focus]=om(),e[_r.Exit]=om(),e}var kIe={animation:wh(function(e){var t=e.visualElement,n=e.animate;t.animationState||(t.animationState=EIe(t)),lR(n)&&qt(function(){return n.subscribe(t)},[n])}),exit:wh(function(e){var t=e.custom,n=e.visualElement,r=pr(YD(),2),i=r[0],a=r[1],o=Un(xy);qt(function(){var s,u,l=(s=n.animationState)===null||s===void 0?void 0:s.setActive(_r.Exit,!i,{custom:(u=o==null?void 0:o.custom)!==null&&u!==void 0?u:t});!i&&(l==null||l.then(a))},[i])})},fH=function(){function e(t,n,r){var i=this,a=r===void 0?{}:r,o=a.transformPagePoint;if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.updatePoint=function(){if(!!(i.lastMoveEvent&&i.lastMoveEventInfo)){var d=OR(i.lastMoveEventInfo,i.history),h=i.startEvent!==null,p=Xq(d.offset,{x:0,y:0})>=3;if(!(!h&&!p)){var g=d.point,m=n_().timestamp;i.history.push(Ie(Ie({},g),{timestamp:m}));var v=i.handlers,y=v.onStart,b=v.onMove;h||(y&&y(i.lastMoveEvent,d),i.startEvent=i.lastMoveEvent),b&&b(i.lastMoveEvent,d)}}},this.handlePointerMove=function(d,h){if(i.lastMoveEvent=d,i.lastMoveEventInfo=TR(h,i.transformPagePoint),yq(d)&&d.buttons===0){i.handlePointerUp(d,h);return}Fu.update(i.updatePoint,!0)},this.handlePointerUp=function(d,h){i.end();var p=i.handlers,g=p.onEnd,m=p.onSessionEnd,v=OR(TR(h,i.transformPagePoint),i.history);i.startEvent&&g&&g(d,v),m&&m(d,v)},!(bq(t)&&t.touches.length>1)){this.handlers=n,this.transformPagePoint=o;var s=dR(t),u=TR(s,this.transformPagePoint),l=u.point,c=n_().timestamp;this.history=[Ie(Ie({},l),{timestamp:c})];var f=n.onSessionStart;f&&f(t,OR(u,this.history)),this.removeListeners=Dy(am(window,"pointermove",this.handlePointerMove),am(window,"pointerup",this.handlePointerUp),am(window,"pointercancel",this.handlePointerUp))}}return e.prototype.updateHandlers=function(t){this.handlers=t},e.prototype.end=function(){this.removeListeners&&this.removeListeners(),sy.update(this.updatePoint)},e}();function TR(e,t){return t?{point:t(e.point)}:e}function dH(e,t){return{x:e.x-t.x,y:e.y-t.y}}function OR(e,t){var n=e.point;return{point:n,delta:dH(n,hH(t)),offset:dH(n,TIe(t)),velocity:OIe(t,.1)}}function TIe(e){return e[0]}function hH(e){return e[e.length-1]}function OIe(e,t){if(e.length<2)return{x:0,y:0};for(var n=e.length-1,r=null,i=hH(e);n>=0&&(r=e[n],!(i.timestamp-r.timestamp>D_(t)));)n--;if(!r)return{x:0,y:0};var a=(i.timestamp-r.timestamp)/1e3;if(a===0)return{x:0,y:0};var o={x:(i.x-r.x)/a,y:(i.y-r.y)/a};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function IIe(e){return e}function pH(e){var t=e.top,n=e.left,r=e.right,i=e.bottom;return{x:{min:n,max:r},y:{min:t,max:i}}}function NIe(e){var t=e.x,n=e.y;return{top:n.min,bottom:n.max,left:t.min,right:t.max}}function DIe(e,t){var n=e.top,r=e.left,i=e.bottom,a=e.right;t===void 0&&(t=IIe);var o=t({x:r,y:n}),s=t({x:a,y:i});return{top:o.y,left:o.x,bottom:s.y,right:s.x}}function wf(){return{x:{min:0,max:1},y:{min:0,max:1}}}function RIe(e){return{x:Ie({},e.x),y:Ie({},e.y)}}var gH={translate:0,scale:1,origin:0,originPoint:0};function mH(){return{x:Ie({},gH),y:Ie({},gH)}}function Za(e){return[e("x"),e("y")]}function vH(e,t,n){var r=t.min,i=t.max;return r!==void 0&&e<r?e=n?Ya(r,e,n.min):Math.max(e,r):i!==void 0&&e>i&&(e=n?Ya(i,e,n.max):Math.min(e,i)),e}function FIe(e,t,n,r,i){var a=e-t*n;return r?vH(a,r,i):a}function yH(e,t,n){return{min:t!==void 0?e.min+t:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function MIe(e,t){var n=t.top,r=t.left,i=t.bottom,a=t.right;return{x:yH(e.x,r,a),y:yH(e.y,n,i)}}function bH(e,t){var n,r=t.min-e.min,i=t.max-e.max;return t.max-t.min<e.max-e.min&&(n=pr([i,r],2),r=n[0],i=n[1]),{min:e.min+r,max:e.min+i}}function PIe(e,t){return{x:bH(e.x,t.x),y:bH(e.y,t.y)}}function $Ie(e,t,n){var r=e.max-e.min,i=Ya(t.min,t.max-r,n);return{min:i,max:i+r}}function LIe(e,t){var n={};return t.min!==void 0&&(n.min=t.min-e.min),t.max!==void 0&&(n.max=t.max-e.min),n}var xH=.35;function BIe(e){return e===!1?e=0:e===!0&&(e=xH),{x:wH(e,"left","right"),y:wH(e,"top","bottom")}}function wH(e,t,n){return{min:_H(e,t),max:_H(e,n)}}function _H(e,t){var n;return typeof e=="number"?e:(n=e[t])!==null&&n!==void 0?n:0}function SH(e,t){var n=e.getBoundingClientRect();return pH(DIe(n,t))}var zIe=function(e){return E_(0,1,e)};function EH(e,t,n){return t===void 0&&(t=0),n===void 0&&(n=.01),Xq(e,t)<n}function Ry(e){return e.max-e.min}function jIe(e,t){var n=.5,r=Ry(e),i=Ry(t);return i>r?n=Ny(t.min,t.max-r,e.min):r>i&&(n=Ny(e.min,e.max-i,t.min)),zIe(n)}function CH(e,t,n,r){r===void 0&&(r=.5),e.origin=r,e.originPoint=Ya(t.min,t.max,e.origin),e.scale=Ry(n)/Ry(t),EH(e.scale,1,1e-4)&&(e.scale=1),e.translate=Ya(n.min,n.max,e.origin)-e.originPoint,EH(e.translate)&&(e.translate=0)}function AH(e,t,n,r){CH(e.x,t.x,n.x,kH(r.originX)),CH(e.y,t.y,n.y,kH(r.originY))}function kH(e){return typeof e=="number"?e:.5}function TH(e,t,n){e.min=n.min+t.min,e.max=e.min+Ry(t)}function UIe(e,t){TH(e.target.x,e.relativeTarget.x,t.target.x),TH(e.target.y,e.relativeTarget.y,t.target.y)}var IR=function(e,t){return e.depth-t.depth};function OH(e){var t=e.projection.isEnabled;return t||e.shouldResetTransform()}function $_(e,t){t===void 0&&(t=[]);var n=e.parent;return n&&$_(n,t),OH(e)&&t.push(e),t}function WIe(e){var t=[],n=function(r){OH(r)&&t.push(r),r.children.forEach(n)};return e.children.forEach(n),t.sort(IR)}function L_(e){if(!e.shouldResetTransform()){var t=e.getLayoutState();e.notifyBeforeLayoutMeasure(t.layout),t.isHydrated=!0,t.layout=e.measureViewportBox(),t.layoutCorrected=RIe(t.layout),e.notifyLayoutMeasure(t.layout,e.prevViewportBox||t.layout),Fu.update(function(){return e.rebaseProjectionTarget()})}}function VIe(e){e.shouldResetTransform()||(e.prevViewportBox=e.measureViewportBox(!1),e.rebaseProjectionTarget(!1,e.prevViewportBox))}function qIe(e,t,n,r){e.min=Ya(t.min,n.min,r),e.max=Ya(t.max,n.max,r)}function IH(e,t){return{min:t.min-e.min,max:t.max-e.min}}function sm(e,t){return{x:IH(e.x,t.x),y:IH(e.y,t.y)}}function HIe(e,t){var n=e.getLayoutId(),r=t.getLayoutId();return n!==r||r===void 0&&e!==t}function NH(e){var t=e.getProps(),n=t.drag,r=t._dragX;return n&&!r}function DH(e,t){e.min=t.min,e.max=t.max}function GIe(e,t){DH(e.x,t.x),DH(e.y,t.y)}function B_(e,t,n){var r=e-n,i=t*r;return n+i}function RH(e,t,n,r,i){return i!==void 0&&(e=B_(e,i,r)),B_(e,n,r)+t}function NR(e,t,n,r,i){t===void 0&&(t=0),n===void 0&&(n=1),e.min=RH(e.min,t,n,r,i),e.max=RH(e.max,t,n,r,i)}function KIe(e,t){var n=t.x,r=t.y;NR(e.x,n.translate,n.scale,n.originPoint),NR(e.y,r.translate,r.scale,r.originPoint)}function FH(e,t,n,r){var i=pr(r,3),a=i[0],o=i[1],s=i[2];e.min=t.min,e.max=t.max;var u=n[s]!==void 0?n[s]:.5,l=Ya(t.min,t.max,u);NR(e,n[a],n[o],l,n.scale)}var MH=["x","scaleX","originX"],PH=["y","scaleY","originY"];function DR(e,t,n){FH(e.x,t.x,n,MH),FH(e.y,t.y,n,PH)}function $H(e,t,n,r,i){return e-=t,e=B_(e,1/n,r),i!==void 0&&(e=B_(e,1/i,r)),e}function XIe(e,t,n,r,i){t===void 0&&(t=0),n===void 0&&(n=1),r===void 0&&(r=.5);var a=Ya(e.min,e.max,r)-t;e.min=$H(e.min,t,n,a,i),e.max=$H(e.max,t,n,a,i)}function LH(e,t,n){var r=pr(n,3),i=r[0],a=r[1],o=r[2];XIe(e,t[i],t[a],t[o],t.scale)}function BH(e,t){LH(e.x,t,MH),LH(e.y,t,PH)}function YIe(e,t,n){var r=n.length;if(!!r){t.x=t.y=1;for(var i,a,o=0;o<r;o++)i=n[o],a=i.getLayoutState().delta,t.x*=a.x.scale,t.y*=a.y.scale,KIe(e,a),NH(i)&&DR(e,e,i.getLatestValues())}}function ZIe(e,t){t===void 0&&(t=!0);var n=e.getProjectionParent();if(!n)return!1;var r;return t?(r=sm(n.projection.target,e.projection.target),BH(r,n.getLatestValues())):r=sm(n.getLayoutState().layout,e.getLayoutState().layout),Za(function(i){return e.setProjectionTargetAxis(i,r[i].min,r[i].max,!0)}),!0}var Fy=new Set;function zH(e,t,n){e[n]||(e[n]=[]),e[n].push(t)}function RR(e){return Fy.add(e),function(){return Fy.delete(e)}}function FR(){if(!!Fy.size){var e=0,t=[[]],n=[],r=function(s){return zH(t,s,e)},i=function(s){zH(n,s,e),e++};Fy.forEach(function(s){s(r,i),e=0}),Fy.clear();for(var a=n.length,o=0;o<=a;o++)t[o]&&t[o].forEach(jH),n[o]&&n[o].forEach(jH)}}var jH=function(e){return e()},JIe=new WeakMap,UH,QIe=function(){function e(t){var n=t.visualElement;this.isDragging=!1,this.currentDirection=null,this.constraints=!1,this.elastic=wf(),this.props={},this.hasMutatedConstraints=!1,this.cursorProgress={x:.5,y:.5},this.originPoint={},this.openGlobalLock=null,this.panSession=null,this.visualElement=n,this.visualElement.enableLayoutProjection(),JIe.set(n,this)}return e.prototype.start=function(t,n){var r=this,i=n===void 0?{}:n,a=i.snapToCursor,o=a===void 0?!1:a,s=i.cursorProgress,u=function(h){var p;r.stopMotion();var g=VTe(h).point;(p=r.cancelLayout)===null||p===void 0||p.call(r),r.cancelLayout=RR(function(m,v){var y=$_(r.visualElement),b=WIe(r.visualElement),x=ma(ma([],pr(y)),pr(b)),w=!1;r.isLayoutDrag()&&r.visualElement.lockProjectionTarget(),v(function(){x.forEach(function(S){return S.resetTransform()})}),m(function(){L_(r.visualElement),b.forEach(L_)}),v(function(){x.forEach(function(S){return S.restoreTransform()}),o&&(w=r.snapToCursor(g))}),m(function(){var S=Boolean(r.getAxisMotionValue("x")&&!r.isExternalDrag());S||r.visualElement.rebaseProjectionTarget(!0,r.visualElement.measureViewportBox(!1)),r.visualElement.scheduleUpdateLayoutProjection();var C=r.visualElement.projection;Za(function(_){if(!w){var E=C.target[_],A=E.min,k=E.max;r.cursorProgress[_]=s?s[_]:Ny(A,k,g[_])}var T=r.getAxisMotionValue(_);T&&(r.originPoint[_]=T.get())})}),v(function(){Kg.update(),Kg.preRender(),Kg.render(),Kg.postRender()}),m(function(){return r.resolveDragConstraints()})})},l=function(h,p){var g,m,v,y=r.props,b=y.drag,x=y.dragPropagation;b&&!x&&(r.openGlobalLock&&r.openGlobalLock(),r.openGlobalLock=Cq(b),!r.openGlobalLock)||(FR(),r.isDragging=!0,r.currentDirection=null,(m=(g=r.props).onDragStart)===null||m===void 0||m.call(g,h,p),(v=r.visualElement.animationState)===null||v===void 0||v.setActive(_r.Drag,!0))},c=function(h,p){var g,m,v,y,b=r.props,x=b.dragPropagation,w=b.dragDirectionLock;if(!(!x&&!r.openGlobalLock)){var S=p.offset;if(w&&r.currentDirection===null){r.currentDirection=eNe(S),r.currentDirection!==null&&((m=(g=r.props).onDirectionLock)===null||m===void 0||m.call(g,r.currentDirection));return}r.updateAxis("x",p.point,S),r.updateAxis("y",p.point,S),(y=(v=r.props).onDrag)===null||y===void 0||y.call(v,h,p),UH=h}},f=function(h,p){return r.stop(h,p)},d=this.props.transformPagePoint;this.panSession=new fH(t,{onSessionStart:u,onStart:l,onMove:c,onSessionEnd:f},{transformPagePoint:d})},e.prototype.resolveDragConstraints=function(){var t=this,n=this.props,r=n.dragConstraints,i=n.dragElastic,a=this.visualElement.getLayoutState().layoutCorrected;r?this.constraints=ZD(r)?this.resolveRefConstraints(a,r):MIe(a,r):this.constraints=!1,this.elastic=BIe(i),this.constraints&&!this.hasMutatedConstraints&&Za(function(o){t.getAxisMotionValue(o)&&(t.constraints[o]=LIe(a[o],t.constraints[o]))})},e.prototype.resolveRefConstraints=function(t,n){var r=this.props,i=r.onMeasureDragConstraints,a=r.transformPagePoint,o=n.current;this.constraintsBox=SH(o,a);var s=PIe(t,this.constraintsBox);if(i){var u=i(NIe(s));this.hasMutatedConstraints=!!u,u&&(s=pH(u))}return s},e.prototype.cancelDrag=function(){var t,n;this.visualElement.unlockProjectionTarget(),(t=this.cancelLayout)===null||t===void 0||t.call(this),this.isDragging=!1,this.panSession&&this.panSession.end(),this.panSession=null,!this.props.dragPropagation&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),(n=this.visualElement.animationState)===null||n===void 0||n.setActive(_r.Drag,!1)},e.prototype.stop=function(t,n){var r,i,a;(r=this.panSession)===null||r===void 0||r.end(),this.panSession=null;var o=this.isDragging;if(this.cancelDrag(),!!o){var s=n.velocity;this.animateDragEnd(s),(a=(i=this.props).onDragEnd)===null||a===void 0||a.call(i,t,n)}},e.prototype.snapToCursor=function(t){var n=this;return Za(function(r){var i=n.props.drag;if(!!z_(r,i,n.currentDirection)){var a=n.getAxisMotionValue(r);if(a){var o=n.visualElement.getLayoutState().layout,s=o[r].max-o[r].min,u=o[r].min+s/2,l=t[r]-u;n.originPoint[r]=t[r],a.set(l)}else return n.cursorProgress[r]=.5,!0}}).includes(!0)},e.prototype.updateAxis=function(t,n,r){var i=this.props.drag;if(!!z_(t,i,this.currentDirection))return this.getAxisMotionValue(t)?this.updateAxisMotionValue(t,r):this.updateVisualElementAxis(t,n)},e.prototype.updateAxisMotionValue=function(t,n){var r=this.getAxisMotionValue(t);if(!(!n||!r)){var i=this.originPoint[t]+n[t],a=this.constraints?vH(i,this.constraints[t],this.elastic[t]):i;r.set(a)}},e.prototype.updateVisualElementAxis=function(t,n){var r,i=this.visualElement.getLayoutState().layout[t],a=i.max-i.min,o=this.cursorProgress[t],s=FIe(n[t],a,o,(r=this.constraints)===null||r===void 0?void 0:r[t],this.elastic[t]);this.visualElement.setProjectionTargetAxis(t,s,s+a)},e.prototype.setProps=function(t){var n=t.drag,r=n===void 0?!1:n,i=t.dragDirectionLock,a=i===void 0?!1:i,o=t.dragPropagation,s=o===void 0?!1:o,u=t.dragConstraints,l=u===void 0?!1:u,c=t.dragElastic,f=c===void 0?xH:c,d=t.dragMomentum,h=d===void 0?!0:d,p=ko(t,["drag","dragDirectionLock","dragPropagation","dragConstraints","dragElastic","dragMomentum"]);this.props=Ie({drag:r,dragDirectionLock:a,dragPropagation:s,dragConstraints:l,dragElastic:f,dragMomentum:h},p)},e.prototype.getAxisMotionValue=function(t){var n=this.props,r=n.layout,i=n.layoutId,a="_drag"+t.toUpperCase();if(this.props[a])return this.props[a];if(!r&&i===void 0)return this.visualElement.getValue(t,0)},e.prototype.isLayoutDrag=function(){return!this.getAxisMotionValue("x")},e.prototype.isExternalDrag=function(){var t=this.props,n=t._dragX,r=t._dragY;return n||r},e.prototype.animateDragEnd=function(t){var n=this,r=this.props,i=r.drag,a=r.dragMomentum,o=r.dragElastic,s=r.dragTransition,u=ZIe(this.visualElement,this.isLayoutDrag()&&!this.isExternalDrag()),l=this.constraints||{};if(u&&Object.keys(l).length&&this.isLayoutDrag()){var c=this.visualElement.getProjectionParent();if(c){var f=sm(c.projection.targetFinal,l);Za(function(h){var p=f[h],g=p.min,m=p.max;l[h]={min:isNaN(g)?void 0:g,max:isNaN(m)?void 0:m}})}}var d=Za(function(h){var p;if(!!z_(h,i,n.currentDirection)){var g=(p=l==null?void 0:l[h])!==null&&p!==void 0?p:{},m=o?200:1e6,v=o?40:1e7,y=Ie(Ie({type:"inertia",velocity:a?t[h]:0,bounceStiffness:m,bounceDamping:v,timeConstant:750,restDelta:1,restSpeed:10},s),g);return n.getAxisMotionValue(h)?n.startAxisValueAnimation(h,y):n.visualElement.startLayoutAnimation(h,y,u)}});return Promise.all(d).then(function(){var h,p;(p=(h=n.props).onDragTransitionEnd)===null||p===void 0||p.call(h)})},e.prototype.stopMotion=function(){var t=this;Za(function(n){var r=t.getAxisMotionValue(n);r?r.stop():t.visualElement.stopLayoutAnimation()})},e.prototype.startAxisValueAnimation=function(t,n){var r=this.getAxisMotionValue(t);if(!!r){var i=r.get();return r.set(i),r.set(i),F_(t,r,0,n)}},e.prototype.scalePoint=function(){var t=this,n=this.props,r=n.drag,i=n.dragConstraints;if(!(!ZD(i)||!this.constraintsBox)){this.stopMotion();var a={x:0,y:0};Za(function(o){a[o]=jIe(t.visualElement.projection.target[o],t.constraintsBox[o])}),this.updateConstraints(function(){Za(function(o){if(!!z_(o,r,null)){var s=$Ie(t.visualElement.projection.target[o],t.constraintsBox[o],a[o]),u=s.min,l=s.max;t.visualElement.setProjectionTargetAxis(o,u,l)}})}),setTimeout(FR,1)}},e.prototype.updateConstraints=function(t){var n=this;this.cancelLayout=RR(function(r,i){var a=$_(n.visualElement);i(function(){return a.forEach(function(o){return o.resetTransform()})}),r(function(){return L_(n.visualElement)}),i(function(){return a.forEach(function(o){return o.restoreTransform()})}),r(function(){n.resolveDragConstraints()}),t&&i(t)})},e.prototype.mount=function(t){var n=this,r=t.getInstance(),i=am(r,"pointerdown",function(u){var l=n.props,c=l.drag,f=l.dragListener,d=f===void 0?!0:f;c&&d&&n.start(u)}),a=cR(window,"resize",function(){n.scalePoint()}),o=t.onLayoutUpdate(function(){n.isDragging&&n.resolveDragConstraints()}),s=t.prevDragCursor;return s&&this.start(UH,{cursorProgress:s}),function(){i==null||i(),a==null||a(),o==null||o(),n.cancelDrag()}},e}();function z_(e,t,n){return(t===!0||t===e)&&(n===null||n===e)}function eNe(e,t){t===void 0&&(t=10);var n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}function tNe(e){var t=e.dragControls,n=e.visualElement,r=Un(m_).transformPagePoint,i=wy(function(){return new QIe({visualElement:n})});i.setProps(Ie(Ie({},e),{transformPagePoint:r})),qt(function(){return t&&t.subscribe(i)},[i]),qt(function(){return i.mount(n)},[])}function nNe(e){var t=e.onPan,n=e.onPanStart,r=e.onPanEnd,i=e.onPanSessionStart,a=e.visualElement,o=t||n||r||i,s=Jt(null),u=Un(m_).transformPagePoint,l={onSessionStart:i,onStart:n,onMove:t,onEnd:function(f,d){s.current=null,r&&r(f,d)}};qt(function(){s.current!==null&&s.current.updateHandlers(l)});function c(f){s.current=new fH(f,l,{transformPagePoint:u})}S_(a,"pointerdown",o&&c),hR(function(){return s.current&&s.current.end()})}var rNe={pan:wh(nNe),drag:wh(tNe)},My;(function(e){e[e.Entering=0]="Entering",e[e.Present=1]="Present",e[e.Exiting=2]="Exiting"})(My||(My={}));var MR;(function(e){e[e.Hide=0]="Hide",e[e.Show=1]="Show"})(MR||(MR={}));function PR(e){return typeof e=="string"&&e.startsWith("var(--")}var WH=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function iNe(e){var t=WH.exec(e);if(!t)return[,];var n=pr(t,3),r=n[1],i=n[2];return[r,i]}function $R(e,t,n){var r=pr(iNe(e),2),i=r[0],a=r[1];if(!!i){var o=window.getComputedStyle(t).getPropertyValue(i);return o?o.trim():PR(a)?$R(a,t):a}}function aNe(e,t,n){var r,i=ko(t,[]),a=e.getInstance();if(!(a instanceof HTMLElement))return{target:i,transitionEnd:n};n&&(n=Ie({},n)),e.forEachValue(function(l){var c=l.get();if(!!PR(c)){var f=$R(c,a);f&&l.set(f)}});for(var o in i){var s=i[o];if(!!PR(s)){var u=$R(s,a);!u||(i[o]=u,n&&((r=n[o])!==null&&r!==void 0||(n[o]=s)))}}return{target:i,transitionEnd:n}}function VH(e,t){return e/(t.max-t.min)*100}function oNe(e,t,n){var r=n.target;if(typeof e=="string")if(Tt.test(e))e=parseFloat(e);else return e;var i=VH(e,r.x),a=VH(e,r.y);return i+"% "+a+"%"}var qH="_$css";function sNe(e,t){var n=t.delta,r=t.treeScale,i=e,a=e.includes("var("),o=[];a&&(e=e.replace(WH,function(g){return o.push(g),qH}));var s=Zl.parse(e);if(s.length>5)return i;var u=Zl.createTransformer(e),l=typeof s[0]!="number"?1:0,c=n.x.scale*r.x,f=n.y.scale*r.y;s[0+l]/=c,s[1+l]/=f;var d=Ya(c,f,.5);typeof s[2+l]=="number"&&(s[2+l]/=d),typeof s[3+l]=="number"&&(s[3+l]/=d);var h=u(s);if(a){var p=0;h=h.replace(qH,function(){var g=o[p];return p++,g})}return h}var Py={process:oNe},uNe={borderRadius:Ie(Ie({},Py),{applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]}),borderTopLeftRadius:Py,borderTopRightRadius:Py,borderBottomLeftRadius:Py,borderBottomRightRadius:Py,boxShadow:{process:sNe}},HH=1e3,lNe=function(e){zV(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.frameTarget=wf(),n.currentAnimationTarget=wf(),n.isAnimating={x:!1,y:!1},n.stopAxisAnimation={x:void 0,y:void 0},n.isAnimatingTree=!1,n.animate=function(r,i,a){a===void 0&&(a={});var o=a.originBox,s=a.targetBox,u=a.visibilityAction,l=a.shouldStackAnimate,c=a.onComplete,f=a.prevParent,d=ko(a,["originBox","targetBox","visibilityAction","shouldStackAnimate","onComplete","prevParent"]),h=n.props,p=h.visualElement,g=h.layout;if(l===!1)return n.isAnimatingTree=!1,n.safeToRemove();if(!(n.isAnimatingTree&&l!==!0)){l&&(n.isAnimatingTree=!0),i=o||i,r=s||r;var m=!1,v=p.getProjectionParent();if(v){var y=v.prevViewportBox,b=v.getLayoutState().layout;f&&(s&&(b=f.getLayoutState().layout),o&&!HIe(f,v)&&f.prevViewportBox&&(y=f.prevViewportBox)),y&&hNe(f,o,s)&&(m=!0,i=sm(y,i),r=sm(b,r))}var x=fNe(i,r),w=Za(function(S){var C,_;if(g==="position"){var E=r[S].max-r[S].min;i[S].max=i[S].min+E}if(!p.projection.isTargetLocked)if(u!==void 0)p.setVisibility(u===MR.Show);else return x?n.animateAxis(S,r[S],i[S],Ie(Ie({},d),{isRelative:m})):((_=(C=n.stopAxisAnimation)[S])===null||_===void 0||_.call(C),p.setProjectionTargetAxis(S,r[S].min,r[S].max,m))});return p.syncRender(),Promise.all(w).then(function(){n.isAnimatingTree=!1,c&&c(),p.notifyLayoutAnimationComplete()})}},n}return t.prototype.componentDidMount=function(){var n=this,r=this.props.visualElement;r.animateMotionValue=F_,r.enableLayoutProjection(),this.unsubLayoutReady=r.onLayoutUpdate(this.animate),r.layoutSafeToRemove=function(){return n.safeToRemove()},Yke(uNe)},t.prototype.componentWillUnmount=function(){var n=this;this.unsubLayoutReady(),Za(function(r){var i,a;return(a=(i=n.stopAxisAnimation)[r])===null||a===void 0?void 0:a.call(i)})},t.prototype.animateAxis=function(n,r,i,a){var o=this,s,u,l=a===void 0?{}:a,c=l.transition,f=l.isRelative;if(!(this.isAnimating[n]&&$y(r,this.currentAnimationTarget[n]))){(u=(s=this.stopAxisAnimation)[n])===null||u===void 0||u.call(s),this.isAnimating[n]=!0;var d=this.props.visualElement,h=this.frameTarget[n],p=d.getProjectionAnimationProgress()[n];p.clearListeners(),p.set(0),p.set(0);var g=function(){var b=p.get()/HH;qIe(h,i,r,b),d.setProjectionTargetAxis(n,h.min,h.max,f)};g();var m=p.onChange(g);this.stopAxisAnimation[n]=function(){o.isAnimating[n]=!1,p.stop(),m()},this.currentAnimationTarget[n]=r;var v=c||d.getDefaultTransition()||dNe,y=F_(n==="x"?"layoutX":"layoutY",p,HH,v&&CR(v,"layout")).then(this.stopAxisAnimation[n]);return y}},t.prototype.safeToRemove=function(){var n,r;(r=(n=this.props).safeToRemove)===null||r===void 0||r.call(n)},t.prototype.render=function(){return null},t}(Ns);function cNe(e){var t=pr(YD(),2),n=t[1];return ue(lNe,Ie({},e,{safeToRemove:n}))}function fNe(e,t){return!KH(e)&&!KH(t)&&(!$y(e.x,t.x)||!$y(e.y,t.y))}var GH={min:0,max:0};function KH(e){return $y(e.x,GH)&&$y(e.y,GH)}function $y(e,t){return e.min===t.min&&e.max===t.max}var dNe={duration:.45,ease:[.4,0,.1,1]};function hNe(e,t,n){return e||!e&&!(t||n)}var pNe={layoutReady:function(e){return e.notifyLayoutReady()}};function XH(){var e=new Set;return{add:function(t){return e.add(t)},flush:function(t){var n=t===void 0?pNe:t,r=n.layoutReady,i=n.parent;RR(function(a,o){var s=Array.from(e).sort(IR),u=i?$_(i):[];o(function(){var l=ma(ma([],pr(u)),pr(s));l.forEach(function(c){return c.resetTransform()})}),a(function(){s.forEach(L_)}),o(function(){u.forEach(function(l){return l.restoreTransform()}),s.forEach(r)}),a(function(){s.forEach(function(l){l.isPresent&&(l.presence=My.Present)})}),o(function(){Kg.preRender(),Kg.render()}),a(function(){Fu.postRender(function(){return s.forEach(gNe)}),e.clear()})}),FR()}}}function gNe(e){e.prevViewportBox=e.projection.target}var YH=ha(XH()),mNe=ha(XH());function Eh(e){return!!e.forceUpdate}var vNe=function(e){zV(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.componentDidMount=function(){var n=this.props,r=n.syncLayout,i=n.framerSyncLayout,a=n.visualElement;Eh(r)&&r.register(a),Eh(i)&&i.register(a),a.onUnmount(function(){Eh(r)&&r.remove(a),Eh(i)&&i.remove(a)})},t.prototype.getSnapshotBeforeUpdate=function(){var n=this.props,r=n.syncLayout,i=n.visualElement;return Eh(r)?r.syncUpdate():(VIe(i),r.add(i)),null},t.prototype.componentDidUpdate=function(){var n=this.props.syncLayout;Eh(n)||n.flush()},t.prototype.render=function(){return null},t}(zt.Component);function yNe(e){var t=Un(YH),n=Un(mNe);return zt.createElement(vNe,Ie({},e,{syncLayout:t,framerSyncLayout:n}))}var bNe={measureLayout:yNe,layoutAnimation:cNe},xNe=function(){return{isEnabled:!1,isHydrated:!1,isTargetLocked:!1,target:wf(),targetFinal:wf()}};function ZH(){return{isHydrated:!1,layout:wf(),layoutCorrected:wf(),treeScale:{x:1,y:1},delta:mH(),deltaFinal:mH(),deltaTransform:""}}var JH=ZH();function j_(e,t,n){var r=e.x,i=e.y,a=r.translate/t.x,o=i.translate/t.y,s="translate3d("+a+"px, "+o+"px, 0) ";if(n){var u=n.rotate,l=n.rotateX,c=n.rotateY;u&&(s+="rotate("+u+") "),l&&(s+="rotateX("+l+") "),c&&(s+="rotateY("+c+") ")}return s+="scale("+r.scale+", "+i.scale+")",!n&&s===wNe?"":s}function QH(e){var t=e.deltaFinal;return t.x.origin*100+"% "+t.y.origin*100+"% 0"}var wNe=j_(JH.delta,JH.treeScale,{x:1,y:1}),U_=["LayoutMeasure","BeforeLayoutMeasure","LayoutUpdate","ViewportBoxUpdate","Update","Render","AnimationComplete","LayoutAnimationComplete","AnimationStart","SetAxisTarget","Unmount"];function _Ne(){var e=U_.map(function(){return new M_}),t={},n={clearAllListeners:function(){return e.forEach(function(r){return r.clear()})},updatePropListeners:function(r){return U_.forEach(function(i){var a;(a=t[i])===null||a===void 0||a.call(t);var o="on"+i,s=r[o];s&&(t[i]=n[o](s))})}};return e.forEach(function(r,i){n["on"+U_[i]]=function(a){return r.add(a)},n["notify"+U_[i]]=function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];return r.notify.apply(r,ma([],pr(a)))}}),n}function SNe(e,t,n){var r;for(var i in t){var a=t[i],o=n[i];if(bf(a))e.addValue(i,a);else if(bf(o))e.addValue(i,Sh(a));else if(o!==a)if(e.hasValue(i)){var s=e.getValue(i);!s.hasAnimated&&s.set(a)}else e.addValue(i,Sh((r=e.getStaticValue(i))!==null&&r!==void 0?r:a))}for(var i in n)t[i]===void 0&&e.removeValue(i);return t}function ENe(e,t,n,r){var i=e.delta,a=e.layout,o=e.layoutCorrected,s=e.treeScale,u=t.target;GIe(o,a),YIe(o,s,n),AH(i,o,u,r)}var CNe=function(){function e(){this.children=[],this.isDirty=!1}return e.prototype.add=function(t){oH(this.children,t),this.isDirty=!0},e.prototype.remove=function(t){sH(this.children,t),this.isDirty=!0},e.prototype.forEach=function(t){this.isDirty&&this.children.sort(IR),this.isDirty=!1,this.children.forEach(t)},e}();function ANe(e){var t=e.getProjectionParent();if(!t){e.rebaseProjectionTarget();return}var n=sm(t.getLayoutState().layout,e.getLayoutState().layout);Za(function(r){e.setProjectionTargetAxis(r,n[r].min,n[r].max,!0)})}var eG=function(e){var t=e.treeType,n=t===void 0?"":t,r=e.build,i=e.getBaseTarget,a=e.makeTargetAnimatable,o=e.measureViewportBox,s=e.render,u=e.readValueFromInstance,l=e.resetTransform,c=e.restoreTransform,f=e.removeValueFromRenderState,d=e.sortNodePosition,h=e.scrapeMotionValuesFromProps;return function(p,g){var m=p.parent,v=p.props,y=p.presenceId,b=p.blockInitialAnimation,x=p.visualState;g===void 0&&(g={});var w=x.latestValues,S=x.renderState,C,_=_Ne(),E=xNe(),A,k=E,T=w,I,N=ZH(),O,D=!1,L=new Map,W=new Map,G={},K,ee=Ie({},w),ce;function he(){!C||(B.isProjectionReady()&&(DR(k.targetFinal,k.target,T),AH(N.deltaFinal,N.layoutCorrected,k.targetFinal,w)),Oe(),s(C,S))}function Oe(){var R=w;if(O&&O.isActive()){var X=O.getCrossfadeState(B);X&&(R=X)}r(B,S,R,k,N,g,v)}function Te(){_.notifyUpdate(w)}function De(){if(!!B.isProjectionReady()){var R=N.delta,X=N.treeScale,ge=X.x,xe=X.y,ze=N.deltaTransform;ENe(N,k,B.path,w),D&&B.notifyViewportBoxUpdate(k.target,R),D=!1;var Ke=j_(R,X);(Ke!==ze||ge!==X.x||xe!==X.y)&&B.scheduleRender(),N.deltaTransform=Ke}}function me(){B.layoutTree.forEach(TNe)}function P(R,X){var ge=X.onChange(function(ze){w[R]=ze,v.onUpdate&&Fu.update(Te,!1,!0)}),xe=X.onRenderRequest(B.scheduleRender);W.set(R,function(){ge(),xe()})}var F=h(v);for(var V in F){var ae=F[V];w[V]!==void 0&&bf(ae)&&ae.set(w[V],!1)}var Y=b_(v),M=HV(v),B=Ie(Ie({treeType:n,current:null,depth:m?m.depth+1:0,parent:m,children:new Set,path:m?ma(ma([],pr(m.path)),[m]):[],layoutTree:m?m.layoutTree:new CNe,presenceId:y,projection:E,variantChildren:M?new Set:void 0,isVisible:void 0,manuallyAnimateOnMount:Boolean(m==null?void 0:m.isMounted()),blockInitialAnimation:b,isMounted:function(){return Boolean(C)},mount:function(R){C=B.current=R,B.pointTo(B),M&&m&&!Y&&(ce=m==null?void 0:m.addVariantChild(B)),m==null||m.children.add(B)},unmount:function(){sy.update(Te),sy.render(he),sy.preRender(B.updateLayoutProjection),W.forEach(function(R){return R()}),B.stopLayoutAnimation(),B.layoutTree.remove(B),ce==null||ce(),m==null||m.children.delete(B),I==null||I(),_.clearAllListeners()},addVariantChild:function(R){var X,ge=B.getClosestVariantNode();if(ge)return(X=ge.variantChildren)===null||X===void 0||X.add(R),function(){return ge.variantChildren.delete(R)}},sortNodePosition:function(R){return!d||n!==R.treeType?0:d(B.getInstance(),R.getInstance())},getClosestVariantNode:function(){return M?B:m==null?void 0:m.getClosestVariantNode()},scheduleUpdateLayoutProjection:m?m.scheduleUpdateLayoutProjection:function(){return Fu.preRender(B.updateTreeLayoutProjection,!1,!0)},getLayoutId:function(){return v.layoutId},getInstance:function(){return C},getStaticValue:function(R){return w[R]},setStaticValue:function(R,X){return w[R]=X},getLatestValues:function(){return w},setVisibility:function(R){B.isVisible!==R&&(B.isVisible=R,B.scheduleRender())},makeTargetAnimatable:function(R,X){return X===void 0&&(X=!0),a(B,R,v,X)},addValue:function(R,X){B.hasValue(R)&&B.removeValue(R),L.set(R,X),w[R]=X.get(),P(R,X)},removeValue:function(R){var X;L.delete(R),(X=W.get(R))===null||X===void 0||X(),W.delete(R),delete w[R],f(R,S)},hasValue:function(R){return L.has(R)},getValue:function(R,X){var ge=L.get(R);return ge===void 0&&X!==void 0&&(ge=Sh(X),B.addValue(R,ge)),ge},forEachValue:function(R){return L.forEach(R)},readValue:function(R){var X;return(X=w[R])!==null&&X!==void 0?X:u(C,R,g)},setBaseTarget:function(R,X){ee[R]=X},getBaseTarget:function(R){if(i){var X=i(v,R);if(X!==void 0&&!bf(X))return X}return ee[R]}},_),{build:function(){return Oe(),S},scheduleRender:function(){Fu.render(he,!1,!0)},syncRender:he,setProps:function(R){v=R,_.updatePropListeners(R),G=SNe(B,h(v),G)},getProps:function(){return v},getVariant:function(R){var X;return(X=v.variants)===null||X===void 0?void 0:X[R]},getDefaultTransition:function(){return v.transition},getVariantContext:function(R){if(R===void 0&&(R=!1),R)return m==null?void 0:m.getVariantContext();if(!Y){var X=(m==null?void 0:m.getVariantContext())||{};return v.initial!==void 0&&(X.initial=v.initial),X}for(var ge={},xe=0;xe<ONe;xe++){var ze=tG[xe],Ke=v[ze];(Ls(Ke)||Ke===!1)&&(ge[ze]=Ke)}return ge},enableLayoutProjection:function(){E.isEnabled=!0,B.layoutTree.add(B)},lockProjectionTarget:function(){E.isTargetLocked=!0},unlockProjectionTarget:function(){B.stopLayoutAnimation(),E.isTargetLocked=!1},getLayoutState:function(){return N},setCrossfader:function(R){O=R},isProjectionReady:function(){return E.isEnabled&&E.isHydrated&&N.isHydrated},startLayoutAnimation:function(R,X,ge){ge===void 0&&(ge=!1);var xe=B.getProjectionAnimationProgress()[R],ze=ge?E.relativeTarget[R]:E.target[R],Ke=ze.min,Ze=ze.max,Bt=Ze-Ke;return xe.clearListeners(),xe.set(Ke),xe.set(Ke),xe.onChange(function(Je){B.setProjectionTargetAxis(R,Je,Je+Bt,ge)}),B.animateMotionValue(R,xe,0,X)},stopLayoutAnimation:function(){Za(function(R){return B.getProjectionAnimationProgress()[R].stop()})},measureViewportBox:function(R){R===void 0&&(R=!0);var X=o(C,g);return R||BH(X,w),X},getProjectionAnimationProgress:function(){return K||(K={x:Sh(0),y:Sh(0)}),K},setProjectionTargetAxis:function(R,X,ge,xe){xe===void 0&&(xe=!1);var ze;xe?(E.relativeTarget||(E.relativeTarget=wf()),ze=E.relativeTarget[R]):(E.relativeTarget=void 0,ze=E.target[R]),E.isHydrated=!0,ze.min=X,ze.max=ge,D=!0,_.notifySetAxisTarget()},rebaseProjectionTarget:function(R,X){X===void 0&&(X=N.layout);var ge=B.getProjectionAnimationProgress(),xe=ge.x,ze=ge.y,Ke=!E.relativeTarget&&!E.isTargetLocked&&!xe.isAnimating()&&!ze.isAnimating();(R||Ke)&&Za(function(Ze){var Bt=X[Ze],Je=Bt.min,Zt=Bt.max;B.setProjectionTargetAxis(Ze,Je,Zt)})},notifyLayoutReady:function(R){ANe(B),B.notifyLayoutUpdate(N.layout,B.prevViewportBox||N.layout,R)},resetTransform:function(){return l(B,C,v)},restoreTransform:function(){return c(C,S)},updateLayoutProjection:De,updateTreeLayoutProjection:function(){B.layoutTree.forEach(kNe),Fu.preRender(me,!1,!0)},getProjectionParent:function(){if(A===void 0){for(var R=!1,X=B.path.length-1;X>=0;X--){var ge=B.path[X];if(ge.projection.isEnabled){R=ge;break}}A=R}return A},resolveRelativeTargetBox:function(){var R=B.getProjectionParent();if(!(!E.relativeTarget||!R)&&(UIe(E,R.projection),NH(R))){var X=E.target;DR(X,X,R.getLatestValues())}},shouldResetTransform:function(){return Boolean(v._layoutResetTransform)},pointTo:function(R){k=R.projection,T=R.getLatestValues(),I==null||I(),I=Dy(R.onSetAxisTarget(B.scheduleUpdateLayoutProjection),R.onLayoutAnimationComplete(function(){var X;B.isPresent?B.presence=My.Present:(X=B.layoutSafeToRemove)===null||X===void 0||X.call(B)}))},isPresent:!0,presence:My.Entering});return B}};function kNe(e){e.resolveRelativeTargetBox()}function TNe(e){e.updateLayoutProjection()}var tG=ma(["initial"],pr(kR)),ONe=tG.length,INe=new Set(["width","height","top","left","right","bottom","x","y"]),nG=function(e){return INe.has(e)},NNe=function(e){return Object.keys(e).some(nG)},rG=function(e,t){e.set(t,!1),e.set(t)},iG=function(e){return e===xh||e===Tt},aG;(function(e){e.width="width",e.height="height",e.left="left",e.right="right",e.top="top",e.bottom="bottom"})(aG||(aG={}));var oG=function(e,t){return parseFloat(e.split(", ")[t])},sG=function(e,t){return function(n,r){var i=r.transform;if(i==="none"||!i)return 0;var a=i.match(/^matrix3d\((.+)\)$/);if(a)return oG(a[1],t);var o=i.match(/^matrix\((.+)\)$/);return o?oG(o[1],e):0}},DNe=new Set(["x","y","z"]),RNe=Ey.filter(function(e){return!DNe.has(e)});function FNe(e){var t=[];return RNe.forEach(function(n){var r=e.getValue(n);r!==void 0&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),t.length&&e.syncRender(),t}var uG={width:function(e){var t=e.x;return t.max-t.min},height:function(e){var t=e.y;return t.max-t.min},top:function(e,t){var n=t.top;return parseFloat(n)},left:function(e,t){var n=t.left;return parseFloat(n)},bottom:function(e,t){var n=e.y,r=t.top;return parseFloat(r)+(n.max-n.min)},right:function(e,t){var n=e.x,r=t.left;return parseFloat(r)+(n.max-n.min)},x:sG(4,13),y:sG(5,14)},MNe=function(e,t,n){var r=t.measureViewportBox(),i=t.getInstance(),a=getComputedStyle(i),o=a.display,s=a.top,u=a.left,l=a.bottom,c=a.right,f=a.transform,d={top:s,left:u,bottom:l,right:c,transform:f};o==="none"&&t.setStaticValue("display",e.display||"block"),t.syncRender();var h=t.measureViewportBox();return n.forEach(function(p){var g=t.getValue(p);rG(g,uG[p](r,d)),e[p]=uG[p](h,a)}),e},PNe=function(e,t,n,r){n===void 0&&(n={}),r===void 0&&(r={}),t=Ie({},t),r=Ie({},r);var i=Object.keys(t).filter(nG),a=[],o=!1,s=[];if(i.forEach(function(l){var c=e.getValue(l);if(!!e.hasValue(l)){var f=n[l],d=t[l],h=P_(f),p;if(Iy(d))for(var g=d.length,m=d[0]===null?1:0;m<g;m++)p?by(P_(d[m])===p):p=P_(d[m]);else p=P_(d);if(h!==p)if(iG(h)&&iG(p)){var v=c.get();typeof v=="string"&&c.set(parseFloat(v)),typeof d=="string"?t[l]=parseFloat(d):Array.isArray(d)&&p===Tt&&(t[l]=d.map(parseFloat))}else(h==null?void 0:h.transform)&&(p==null?void 0:p.transform)&&(f===0||d===0)?f===0?c.set(p.transform(f)):t[l]=h.transform(d):(o||(a=FNe(e),o=!0),s.push(l),r[l]=r[l]!==void 0?r[l]:t[l],rG(c,d))}}),s.length){var u=MNe(t,e,s);return a.length&&a.forEach(function(l){var c=pr(l,2),f=c[0],d=c[1];e.getValue(f).set(d)}),e.syncRender(),{target:u,transitionEnd:r}}else return{target:t,transitionEnd:r}};function $Ne(e,t,n,r){return NNe(t)?PNe(e,t,n,r):{target:t,transitionEnd:r}}var LNe=function(e,t,n,r){var i=aNe(e,t,r);return t=i.target,r=i.transitionEnd,$Ne(e,t,n,r)};function BNe(e){return window.getComputedStyle(e)}var lG={treeType:"dom",readValueFromInstance:function(e,t){if(x_(t)){var n=SR(t);return n&&n.default||0}else{var r=BNe(e);return(YV(t)?r.getPropertyValue(t):r[t])||0}},sortNodePosition:function(e,t){return e.compareDocumentPosition(t)&2?1:-1},getBaseTarget:function(e,t){var n;return(n=e.style)===null||n===void 0?void 0:n[t]},measureViewportBox:function(e,t){var n=t.transformPagePoint;return SH(e,n)},resetTransform:function(e,t,n){var r=n.transformTemplate;t.style.transform=r?r({},""):"none",e.scheduleRender()},restoreTransform:function(e,t){e.style.transform=t.style.transform},removeValueFromRenderState:function(e,t){var n=t.vars,r=t.style;delete n[e],delete r[e]},makeTargetAnimatable:function(e,t,n,r){var i=n.transformValues;r===void 0&&(r=!0);var a=t.transition,o=t.transitionEnd,s=ko(t,["transition","transitionEnd"]),u=mIe(s,a||{},e);if(i&&(o&&(o=i(o)),s&&(s=i(s)),u&&(u=i(u))),r){pIe(e,s,u);var l=LNe(e,s,u,o);o=l.transitionEnd,s=l.target}return Ie({transition:a,transitionEnd:o},s)},scrapeMotionValuesFromProps:uR,build:function(e,t,n,r,i,a,o){e.isVisible!==void 0&&(t.style.visibility=e.isVisible?"visible":"hidden");var s=r.isEnabled&&i.isHydrated;iR(t,n,r,i,a,o.transformTemplate,s?j_:void 0,s?QH:void 0)},render:dq},zNe=eG(lG),jNe=eG(Ie(Ie({},lG),{getBaseTarget:function(e,t){return e[t]},readValueFromInstance:function(e,t){var n;return x_(t)?((n=SR(t))===null||n===void 0?void 0:n.default)||0:(t=hq.has(t)?t:fq(t),e.getAttribute(t))},scrapeMotionValuesFromProps:gq,build:function(e,t,n,r,i,a,o){var s=r.isEnabled&&i.isHydrated;sR(t,n,r,i,a,o.transformTemplate,s?j_:void 0,s?QH:void 0)},render:pq})),UNe=function(e,t){return JD(e)?jNe(t,{enableHardwareAcceleration:!1}):zNe(t,{enableHardwareAcceleration:!0})},WNe=Ie(Ie(Ie(Ie({},kIe),KOe),rNe),bNe),cG=Kke(function(e,t){return LTe(e,t,WNe,UNe)});function VNe(){var e=Jt(!1),t=pr(an(0),2),n=t[0],r=t[1];return hR(function(){return e.current=!0}),st(function(){!e.current&&r(n+1)},[n])}var fG=0;function qNe(){var e=fG;return fG++,e}var LR=function(e){var t=e.children,n=e.initial,r=e.isPresent,i=e.onExitComplete,a=e.custom,o=e.presenceAffectsLayout,s=wy(HNe),u=wy(qNe),l=xr(function(){return{id:u,initial:n,isPresent:r,custom:a,onExitComplete:function(c){s.set(c,!0);var f=!0;s.forEach(function(d){d||(f=!1)}),f&&(i==null||i())},register:function(c){return s.set(c,!1),function(){return s.delete(c)}}}},o?void 0:[r]);return xr(function(){s.forEach(function(c,f){return s.set(f,!1)})},[r]),qt(function(){!r&&!s.size&&(i==null||i())},[r]),ue(xy.Provider,{value:l},t)};function HNe(){return new Map}function um(e){return e.key||""}function GNe(e,t){e.forEach(function(n){var r=um(n);t.set(r,n)})}function KNe(e){var t=[];return _2.forEach(e,function(n){gh(n)&&t.push(n)}),t}var dG=function(e){var t=e.children,n=e.custom,r=e.initial,i=r===void 0?!0:r,a=e.onExitComplete,o=e.exitBeforeEnter,s=e.presenceAffectsLayout,u=s===void 0?!0:s,l=VNe(),c=Un(YH);Eh(c)&&(l=c.forceUpdate);var f=Jt(!0),d=KNe(t),h=Jt(d),p=Jt(new Map).current,g=Jt(new Set).current;if(GNe(d,p),f.current)return f.current=!1,ue(Vi,null,d.map(function(S){return ue(LR,{key:um(S),isPresent:!0,initial:i?void 0:!1,presenceAffectsLayout:u},S)}));for(var m=ma([],pr(d)),v=h.current.map(um),y=d.map(um),b=v.length,x=0;x<b;x++){var w=v[x];y.indexOf(w)===-1?g.add(w):g.delete(w)}return o&&g.size&&(m=[]),g.forEach(function(S){if(y.indexOf(S)===-1){var C=p.get(S);if(!!C){var _=v.indexOf(S),E=function(){p.delete(S),g.delete(S);var A=h.current.findIndex(function(k){return k.key===S});h.current.splice(A,1),g.size||(h.current=d,l(),a&&a())};m.splice(_,0,ue(LR,{key:um(C),isPresent:!1,onExitComplete:E,custom:n,presenceAffectsLayout:u},C))}}}),m=m.map(function(S){var C=S.key;return g.has(C)?S:ue(LR,{key:um(S),isPresent:!0,presenceAffectsLayout:u},S)}),h.current=m,ue(Vi,null,g.size?m:m.map(function(S){return cf(S)}))};function W_(){return W_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},W_.apply(this,arguments)}var BR={ease:[.25,.1,.25,1],easeIn:[.4,0,1,1],easeOut:[0,0,.2,1],easeInOut:[.4,0,.2,1]},Ly={scale:{enter:{scale:1},exit:{scale:.95}},fade:{enter:{opacity:1},exit:{opacity:0}},pushLeft:{enter:{x:"100%"},exit:{x:"-30%"}},pushRight:{enter:{x:"-100%"},exit:{x:"30%"}},pushUp:{enter:{y:"100%"},exit:{y:"-30%"}},pushDown:{enter:{y:"-100%"},exit:{y:"30%"}},slideLeft:{position:{left:0,top:0,bottom:0,width:"100%"},enter:{x:0},exit:{x:"-100%"}},slideRight:{position:{right:0,top:0,bottom:0,width:"100%"},enter:{x:0},exit:{x:"100%"}},slideUp:{position:{top:0,left:0,right:0,maxWidth:"100vw"},enter:{y:0},exit:{y:"-100%"}},slideDown:{position:{bottom:0,left:0,right:0,maxWidth:"100vw"},enter:{y:0},exit:{y:"100%"}}};function zR(e){var t,n=(t=e==null?void 0:e.direction)!=null?t:"right";switch(n){case"right":return Ly.slideRight;case"left":return Ly.slideLeft;case"bottom":return Ly.slideDown;case"top":return Ly.slideUp;default:return Ly.slideRight}}var hG={enter:{duration:.2,ease:BR.easeOut},exit:{duration:.1,ease:BR.easeIn}},V_={enter:(e,t)=>W_({},e,{delay:pf(t)?t:t==null?void 0:t.enter}),exit:(e,t)=>W_({},e,{delay:pf(t)?t:t==null?void 0:t.exit})},XNe={enter:function(t){var n,{transition:r,transitionEnd:i,delay:a}=t===void 0?{}:t;return{opacity:1,transition:(n=r==null?void 0:r.enter)!=null?n:V_.enter(hG.enter,a),transitionEnd:i==null?void 0:i.enter}},exit:function(t){var n,{transition:r,transitionEnd:i,delay:a}=t===void 0?{}:t;return{opacity:0,transition:(n=r==null?void 0:r.exit)!=null?n:V_.exit(hG.exit,a),transitionEnd:i==null?void 0:i.exit}}},YNe={initial:"exit",animate:"enter",exit:"exit",variants:XNe};function ZNe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function By(){return By=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},By.apply(this,arguments)}var pG={exit:{duration:.15,ease:BR.easeInOut},enter:{type:"spring",damping:25,stiffness:180}},JNe={exit:e=>{var t,{direction:n,transition:r,transitionEnd:i,delay:a}=e,{exit:o}=zR({direction:n});return By({},o,{transition:(t=r==null?void 0:r.exit)!=null?t:V_.exit(pG.exit,a),transitionEnd:i==null?void 0:i.exit})},enter:e=>{var t,{direction:n,transitionEnd:r,transition:i,delay:a}=e,{enter:o}=zR({direction:n});return By({},o,{transition:(t=i==null?void 0:i.enter)!=null?t:V_.enter(pG.enter,a),transitionEnd:r==null?void 0:r.enter})}},QNe=Gl((e,t)=>{var{direction:n="right",style:r,unmountOnExit:i,in:a,className:o,transition:s,transitionEnd:u,delay:l}=e,c=ZNe(e,["direction","style","unmountOnExit","in","className","transition","transitionEnd","delay"]),f=zR({direction:n}),d=Object.assign({position:"fixed"},f.position,r),h=i?a&&i:!0,p=a||i?"enter":"exit",g={transitionEnd:u,transition:s,direction:n,delay:l};return ue(dG,{custom:g},h&&ue(cG.div,By({ref:t,initial:"exit",className:Wn("chakra-slide",o),animate:p,exit:"exit",custom:g,variants:JNe,style:d},c)))});function gG(e){return e.sort((t,n)=>{var r=t.compareDocumentPosition(n);if(r&Node.DOCUMENT_POSITION_FOLLOWING||r&Node.DOCUMENT_POSITION_CONTAINED_BY)return-1;if(r&Node.DOCUMENT_POSITION_PRECEDING||r&Node.DOCUMENT_POSITION_CONTAINS)return 1;if(r&Node.DOCUMENT_POSITION_DISCONNECTED||r&Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC)throw Error("Cannot sort the given nodes.");return 0})}var eDe=e=>typeof e=="object"&&"nodeType"in e&&e.nodeType===Node.ELEMENT_NODE;function mG(e,t,n){var r=e+1;return n&&r>=t&&(r=0),r}function vG(e,t,n){var r=e-1;return n&&r<0&&(r=t),r}var jR=typeof window!="undefined"?lf:qt,q_=e=>e;function UR(){return UR=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},UR.apply(this,arguments)}function Sr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class tDe{constructor(){var t=this;Sr(this,"descendants",new Map),Sr(this,"register",n=>{if(n!=null)return eDe(n)?this.registerNode(n):r=>{this.registerNode(r,n)}}),Sr(this,"unregister",n=>{this.descendants.delete(n);var r=gG(Array.from(this.descendants.keys()));this.assignIndex(r)}),Sr(this,"destroy",()=>{this.descendants.clear()}),Sr(this,"assignIndex",n=>{this.descendants.forEach(r=>{var i=n.indexOf(r.node);r.index=i,r.node.dataset.index=r.index.toString()})}),Sr(this,"count",()=>this.descendants.size),Sr(this,"enabledCount",()=>this.enabledValues().length),Sr(this,"values",()=>{var n=Array.from(this.descendants.values());return n.sort((r,i)=>r.index-i.index)}),Sr(this,"enabledValues",()=>this.values().filter(n=>!n.disabled)),Sr(this,"item",n=>{if(this.count()!==0)return this.values()[n]}),Sr(this,"enabledItem",n=>{if(this.enabledCount()!==0)return this.enabledValues()[n]}),Sr(this,"first",()=>this.item(0)),Sr(this,"firstEnabled",()=>this.enabledItem(0)),Sr(this,"last",()=>this.item(this.descendants.size-1)),Sr(this,"lastEnabled",()=>{var n=this.enabledValues().length-1;return this.enabledItem(n)}),Sr(this,"indexOf",n=>{var r,i;return n&&(r=(i=this.descendants.get(n))==null?void 0:i.index)!=null?r:-1}),Sr(this,"enabledIndexOf",n=>n==null?-1:this.enabledValues().findIndex(r=>r.node.isSameNode(n))),Sr(this,"next",function(n,r){r===void 0&&(r=!0);var i=mG(n,t.count(),r);return t.item(i)}),Sr(this,"nextEnabled",function(n,r){r===void 0&&(r=!0);var i=t.item(n);if(!!i){var a=t.enabledIndexOf(i.node),o=mG(a,t.enabledCount(),r);return t.enabledItem(o)}}),Sr(this,"prev",function(n,r){r===void 0&&(r=!0);var i=vG(n,t.count()-1,r);return t.item(i)}),Sr(this,"prevEnabled",function(n,r){r===void 0&&(r=!0);var i=t.item(n);if(!!i){var a=t.enabledIndexOf(i.node),o=vG(a,t.enabledCount()-1,r);return t.enabledItem(o)}}),Sr(this,"registerNode",(n,r)=>{if(!(!n||this.descendants.has(n))){var i=Array.from(this.descendants.keys()).concat(n),a=gG(i);r!=null&&r.disabled&&(r.disabled=!!r.disabled);var o=UR({node:n,index:-1},r);this.descendants.set(n,o),this.assignIndex(a)}})}}function nDe(){var[e]=an(()=>new tDe);return jR(()=>()=>e.destroy()),e}var[rDe,yG]=Mu({name:"DescendantsProvider",errorMessage:"useDescendantsContext must be used within DescendantsProvider"});function iDe(e){var t=yG(),[n,r]=an(-1),i=Jt(null);jR(()=>()=>{!i.current||t.unregister(i.current)},[]),jR(()=>{if(!!i.current){var o=Number(i.current.dataset.index);n!=o&&!Number.isNaN(o)&&r(o)}});var a=q_(e?t.register(e):t.register);return{descendants:t,index:n,enabledIndex:t.enabledIndexOf(i.current),register:gf(a,i)}}function aDe(){var e=q_(rDe),t=()=>q_(yG()),n=i=>iDe(i),r=()=>nDe();return[e,t,r,n]}function zy(){return zy=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zy.apply(this,arguments)}var oDe=e=>ue(vy,zy({viewBox:"0 0 24 24"},e),ue("path",{fill:"currentColor",d:"M12,0A12,12,0,1,0,24,12,12.014,12.014,0,0,0,12,0Zm6.927,8.2-6.845,9.289a1.011,1.011,0,0,1-1.43.188L5.764,13.769a1,1,0,1,1,1.25-1.562l4.076,3.261,6.227-8.451A1,1,0,1,1,18.927,8.2Z"})),sDe=e=>ue(vy,zy({viewBox:"0 0 24 24"},e),ue("path",{fill:"currentColor",d:"M12,0A12,12,0,1,0,24,12,12.013,12.013,0,0,0,12,0Zm.25,5a1.5,1.5,0,1,1-1.5,1.5A1.5,1.5,0,0,1,12.25,5ZM14.5,18.5h-4a1,1,0,0,1,0-2h.75a.25.25,0,0,0,.25-.25v-4.5a.25.25,0,0,0-.25-.25H10.5a1,1,0,0,1,0-2h1a2,2,0,0,1,2,2v4.75a.25.25,0,0,0,.25.25h.75a1,1,0,1,1,0,2Z"})),bG=e=>ue(vy,zy({viewBox:"0 0 24 24"},e),ue("path",{fill:"currentColor",d:"M11.983,0a12.206,12.206,0,0,0-8.51,3.653A11.8,11.8,0,0,0,0,12.207,11.779,11.779,0,0,0,11.8,24h.214A12.111,12.111,0,0,0,24,11.791h0A11.766,11.766,0,0,0,11.983,0ZM10.5,16.542a1.476,1.476,0,0,1,1.449-1.53h.027a1.527,1.527,0,0,1,1.523,1.47,1.475,1.475,0,0,1-1.449,1.53h-.027A1.529,1.529,0,0,1,10.5,16.542ZM11,12.5v-6a1,1,0,0,1,2,0v6a1,1,0,1,1-2,0Z"}));function Jl(){return Jl=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Jl.apply(this,arguments)}function uDe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var xG={info:{icon:sDe,colorScheme:"blue"},warning:{icon:bG,colorScheme:"orange"},success:{icon:oDe,colorScheme:"green"},error:{icon:bG,colorScheme:"red"}},[lDe,cDe]=Mu({name:"AlertContext",errorMessage:"useAlertContext: `context` is undefined. Seems you forgot to wrap alert components in `<Alert />`"}),fDe=Mt((e,t)=>{var n,r=Ao(e),{status:i="info"}=r,a=uDe(r,["status"]),o=(n=e.colorScheme)!=null?n:xG[i].colorScheme,s=mf("Alert",Jl({},e,{colorScheme:o})),u=Jl({width:"100%",display:"flex",alignItems:"center",position:"relative",overflow:"hidden"},s.container);return ue(lDe,{value:{status:i}},ue(hy,{value:s},ue(xt.div,Jl({role:"alert",ref:t},a,{className:Wn("chakra-alert",e.className),__css:u}))))}),dDe=Mt((e,t)=>{var n=vi();return ue(xt.div,Jl({ref:t},e,{className:Wn("chakra-alert__title",e.className),__css:n.title}))}),hDe=Mt((e,t)=>{var n=vi(),r=Jl({display:"inline"},n.description);return ue(xt.div,Jl({ref:t},e,{className:Wn("chakra-alert__desc",e.className),__css:r}))}),pDe=e=>{var{status:t}=cDe(),{icon:n}=xG[t],r=vi();return ue(xt.span,Jl({display:"inherit"},e,{className:Wn("chakra-alert__icon",e.className),__css:r.icon}),ue(n,{w:"100%",h:"100%"}))},WR={border:"0px",clip:"rect(0px, 0px, 0px, 0px)",height:"1px",width:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"},gDe=xt("span",{baseStyle:WR});xt("input",{baseStyle:WR});function H_(){return H_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},H_.apply(this,arguments)}function mDe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var vDe=WW({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}}),yDe=Mt((e,t)=>{var n=bh("Spinner",e),r=Ao(e),{label:i="Loading...",thickness:a="2px",speed:o="0.45s",emptyColor:s="transparent",className:u}=r,l=mDe(r,["label","thickness","speed","emptyColor","className"]),c=Wn("chakra-spinner",u),f=H_({display:"inline-block",borderColor:"currentColor",borderStyle:"solid",borderRadius:"99999px",borderWidth:a,borderBottomColor:s,borderLeftColor:s,animation:vDe+" "+o+" linear infinite"},n);return ue(xt.div,H_({ref:t,__css:f,className:c},l),i&&ue(gDe,null,i))}),[DTt,bDe]=Mu({strict:!1,name:"ButtonGroupContext"});function VR(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function _f(){return _f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_f.apply(this,arguments)}var wG=Mt((e,t)=>{var n,r=bDe(),i=bh("Button",_f({},r,e)),a=Ao(e),{isDisabled:o=r==null?void 0:r.isDisabled,isLoading:s,isActive:u,isFullWidth:l,children:c,leftIcon:f,rightIcon:d,loadingText:h,iconSpacing:p="0.5rem",type:g,spinner:m,spinnerPlacement:v="start",className:y,as:b}=a,x=VR(a,["isDisabled","isLoading","isActive","isFullWidth","children","leftIcon","rightIcon","loadingText","iconSpacing","type","spinner","spinnerPlacement","className","as"]),w=Ru({},(n=i==null?void 0:i._focus)!=null?n:{},{zIndex:1}),S=_f({display:"inline-flex",appearance:"none",alignItems:"center",justifyContent:"center",userSelect:"none",position:"relative",whiteSpace:"nowrap",verticalAlign:"middle",outline:"none",width:l?"100%":"auto"},i,!!r&&{_focus:w}),{ref:C,type:_}=xDe(b);return ue(xt.button,_f({disabled:o||s,ref:gf(t,C),as:b,type:g??_,"data-active":Ii(u),"data-loading":Ii(s),__css:S,className:Wn("chakra-button",y)},x),f&&!s&&ue(_G,{marginEnd:p},f),s&&v==="start"&&ue(SG,{className:"chakra-button__spinner--start",label:h,placement:"start"},m),s?h||ue(xt.span,{opacity:0},c):c,s&&v==="end"&&ue(SG,{className:"chakra-button__spinner--end",label:h,placement:"end"},m),d&&!s&&ue(_G,{marginStart:p},d))});function xDe(e){var[t,n]=an(!e),r=st(a=>{!a||n(a.tagName==="BUTTON")},[]),i=t?"button":void 0;return{ref:r,type:i}}var _G=e=>{var{children:t,className:n}=e,r=VR(e,["children","className"]),i=gh(t)?cf(t,{"aria-hidden":!0,focusable:!1}):t,a=Wn("chakra-button__icon",n);return ue(xt.span,_f({display:"inline-flex",alignSelf:"center",flexShrink:0},r,{className:a}),i)},SG=e=>{var{label:t,placement:n,children:r=ue(yDe,{color:"currentColor",width:"1em",height:"1em"}),className:i,__css:a}=e,o=VR(e,["label","placement","spacing","children","className","__css"]),s=Wn("chakra-button__spinner",i),u=n==="start"?"marginEnd":"marginStart",l=_f({display:"flex",alignItems:"center",position:t?"relative":"absolute",[u]:t?"0.5rem":0,fontSize:"1em",lineHeight:"normal"},a);return ue(xt.div,_f({className:s},o,{__css:l}),r)};function qR(){return qR=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},qR.apply(this,arguments)}function wDe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var G_=Mt((e,t)=>{var{icon:n,children:r,isRound:i,"aria-label":a}=e,o=wDe(e,["icon","children","isRound","aria-label"]),s=n||r,u=gh(s)?cf(s,{"aria-hidden":!0,focusable:!1}):null;return ue(wG,qR({padding:"0",borderRadius:i?"full":void 0,ref:t,"aria-label":a},o),u)});function lm(){return lm=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},lm.apply(this,arguments)}function _De(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function SDe(e){e===void 0&&(e={});var{defaultIsChecked:t,defaultChecked:n=t,isChecked:r,isFocusable:i,isDisabled:a,isReadOnly:o,isRequired:s,onChange:u,isIndeterminate:l,isInvalid:c,name:f,value:d,id:h,onBlur:p,onFocus:g,"aria-label":m,"aria-labelledby":v,"aria-invalid":y,"aria-describedby":b}=e,x=_De(e,["defaultIsChecked","defaultChecked","isChecked","isFocusable","isDisabled","isReadOnly","isRequired","onChange","isIndeterminate","isInvalid","name","value","id","onBlur","onFocus","aria-label","aria-labelledby","aria-invalid","aria-describedby"]),w=ly(u),S=ly(p),C=ly(g),[_,E]=dD(),[A,k]=dD(),[T,I]=dD(),N=Jt(null),[O,D]=an(!0),[L,W]=an(!!n),[G,K]=wwe(r,L);uD({condition:!!t,message:'The "defaultIsChecked" prop has been deprecated and will be removed in a future version. Please use the "defaultChecked" prop instead, which mirrors default React checkbox behavior.'});var ee=st(F=>{if(o||a){F.preventDefault();return}G||W(K?F.target.checked:l?!0:F.target.checked),w==null||w(F)},[o,a,K,G,l,w]);Xg(()=>{N.current&&(N.current.indeterminate=Boolean(l))},[l]);var ce=a&&!i,he=st(F=>{F.key===" "&&I.on()},[I]),Oe=st(F=>{F.key===" "&&I.off()},[I]);Xg(()=>{if(!!N.current){var F=N.current.checked!==K;F&&W(N.current.checked)}},[N.current]);var Te=st(function(F,V){F===void 0&&(F={}),V===void 0&&(V=null);var ae=Y=>{Y.preventDefault(),I.on()};return lm({},F,{ref:V,"data-active":Ii(T),"data-hover":Ii(A),"data-checked":Ii(K),"data-focus":Ii(_),"data-indeterminate":Ii(l),"data-disabled":Ii(a),"data-invalid":Ii(c),"data-readonly":Ii(o),"aria-hidden":!0,onMouseDown:wr(F.onMouseDown,ae),onMouseUp:wr(F.onMouseUp,I.off),onMouseEnter:wr(F.onMouseEnter,k.on),onMouseLeave:wr(F.onMouseLeave,k.off)})},[T,K,a,_,A,l,c,o,I,k.off,k.on]),De=st(function(F,V){return F===void 0&&(F={}),V===void 0&&(V=null),lm({},x,F,{ref:gf(V,ae=>{!ae||D(ae.tagName==="LABEL")}),onClick:wr(F.onClick,()=>{if(!O){var ae;(ae=N.current)==null||ae.click(),Hg(N.current,{nextTick:!0})}}),"data-disabled":Ii(a)})},[x,a,O]),me=st(function(F,V){F===void 0&&(F={}),V===void 0&&(V=null);var ae=()=>{swe(E.on)};return lm({},F,{ref:gf(N,V),type:"checkbox",name:f,value:d,id:h,onChange:wr(F.onChange,ee),onBlur:wr(F.onBlur,S,E.off),onFocus:wr(F.onFocus,C,ae),onKeyDown:wr(F.onKeyDown,he),onKeyUp:wr(F.onKeyUp,Oe),required:s,checked:K,disabled:ce,readOnly:o,"aria-label":m,"aria-labelledby":v,"aria-invalid":y?Boolean(y):c,"aria-describedby":b,"aria-disabled":a,style:WR})},[f,d,h,ee,E.off,E.on,S,C,he,Oe,s,K,ce,o,m,v,y,c,b,a]),P=st(function(F,V){return F===void 0&&(F={}),V===void 0&&(V=null),lm({},F,{ref:V,onMouseDown:wr(F.onMouseDown,EG),onTouchStart:wr(F.onTouchStart,EG),"data-disabled":Ii(a),"data-checked":Ii(K),"data-invalid":Ii(c)})},[K,a,c]);return{state:{isInvalid:c,isFocused:_,isChecked:K,isActive:T,isHovered:A,isIndeterminate:l,isDisabled:a,isReadOnly:o,isRequired:s},getRootProps:De,getCheckboxProps:Te,getInputProps:me,getLabelProps:P,htmlProps:x}}function EG(e){e.preventDefault(),e.stopPropagation()}function EDe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function jy(){return jy=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},jy.apply(this,arguments)}var CDe=e=>ue(vy,jy({focusable:"false","aria-hidden":!0},e),ue("path",{fill:"currentColor",d:"M.439,21.44a1.5,1.5,0,0,0,2.122,2.121L11.823,14.3a.25.25,0,0,1,.354,0l9.262,9.263a1.5,1.5,0,1,0,2.122-2.121L14.3,12.177a.25.25,0,0,1,0-.354l9.263-9.262A1.5,1.5,0,0,0,21.439.44L12.177,9.7a.25.25,0,0,1-.354,0L2.561.44A1.5,1.5,0,0,0,.439,2.561L9.7,11.823a.25.25,0,0,1,0,.354Z"})),ADe=Mt((e,t)=>{var n=bh("CloseButton",e),r=Ao(e),{children:i,isDisabled:a,__css:o}=r,s=EDe(r,["children","isDisabled","__css"]),u={outline:0,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0};return ue(xt.button,jy({type:"button","aria-label":"Close",ref:t,disabled:a,__css:jy({},u,n,o)},s),i||ue(CDe,{width:"1em",height:"1em"}))}),[RTt,kDe]=Mu({strict:!1,name:"FormControlContext"});function K_(){return K_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},K_.apply(this,arguments)}function CG(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function AG(e){var t=TDe(e),{isDisabled:n,isInvalid:r,isReadOnly:i,isRequired:a}=t,o=CG(t,["isDisabled","isInvalid","isReadOnly","isRequired"]);return K_({},o,{disabled:n,readOnly:i,required:a,"aria-invalid":sD(r),"aria-required":sD(a),"aria-readonly":sD(i)})}function TDe(e){var t,n,r,i=kDe(),{id:a,disabled:o,readOnly:s,required:u,isRequired:l,isInvalid:c,isReadOnly:f,isDisabled:d,onFocus:h,onBlur:p}=e,g=CG(e,["id","disabled","readOnly","required","isRequired","isInvalid","isReadOnly","isDisabled","onFocus","onBlur"]),m=[];return i!=null&&i.hasFeedbackText&&i!=null&&i.isInvalid&&m.push(i.feedbackId),i!=null&&i.hasHelpText&&m.push(i.helpTextId),K_({},g,{"aria-describedby":m.join(" ")||void 0,id:a??(i==null?void 0:i.id),isDisabled:(t=o??d)!=null?t:i==null?void 0:i.isDisabled,isReadOnly:(n=s??f)!=null?n:i==null?void 0:i.isReadOnly,isRequired:(r=u??l)!=null?r:i==null?void 0:i.isRequired,isInvalid:c??(i==null?void 0:i.isInvalid),onFocus:wr(i==null?void 0:i.onFocus,h),onBlur:wr(i==null?void 0:i.onBlur,p)})}function HR(){return HR=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},HR.apply(this,arguments)}var kG=Mt((e,t)=>{var n=mf("Input",e),r=Ao(e),i=AG(r),a=Wn("chakra-input",e.className);return ue(xt.input,HR({},i,{__css:n.field,ref:t,className:a}))});kG.id="Input";var X_=xt("div");function GR(){return GR=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},GR.apply(this,arguments)}function ODe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var IDe=Mt((e,t)=>{var{direction:n,align:r,justify:i,wrap:a,basis:o,grow:s,shrink:u}=e,l=ODe(e,["direction","align","justify","wrap","basis","grow","shrink"]),c={display:"flex",flexDirection:n,alignItems:r,justifyContent:i,flexWrap:a,flexBasis:o,flexGrow:s,flexShrink:u};return ue(xt.div,GR({ref:t,__css:c},l))});function Y_(){return Y_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Y_.apply(this,arguments)}function TG(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var OG=Mt((e,t)=>{var{area:n,templateAreas:r,gap:i,rowGap:a,columnGap:o,column:s,row:u,autoFlow:l,autoRows:c,templateRows:f,autoColumns:d,templateColumns:h}=e,p=TG(e,["area","templateAreas","gap","rowGap","columnGap","column","row","autoFlow","autoRows","templateRows","autoColumns","templateColumns"]),g={display:"grid",gridArea:n,gridTemplateAreas:r,gridGap:i,gridRowGap:a,gridColumnGap:o,gridAutoColumns:d,gridColumn:s,gridRow:u,gridAutoFlow:l,gridAutoRows:c,gridTemplateRows:f,gridTemplateColumns:h};return ue(xt.div,Y_({ref:t,__css:g},p))});function IG(e){return uy(e,t=>t==="auto"?"auto":"span "+t+"/span "+t)}var Ch=Mt((e,t)=>{var{colSpan:n,colStart:r,colEnd:i,rowEnd:a,rowSpan:o,rowStart:s}=e,u=TG(e,["colSpan","colStart","colEnd","rowEnd","rowSpan","rowStart"]),l=Z2({gridColumn:IG(n),gridRow:IG(o),gridColumnStart:r,gridColumnEnd:i,gridRowStart:s,gridRowEnd:a});return ue(xt.div,Y_({ref:t,__css:l},u))});function KR(){return KR=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},KR.apply(this,arguments)}function NDe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var DDe=Mt((e,t)=>{var n=bh("Heading",e),r=Ao(e),i=NDe(r,["className"]);return ue(xt.h2,KR({ref:t,className:Wn("chakra-heading",e.className)},i,{__css:n}))});function XR(){return XR=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},XR.apply(this,arguments)}function RDe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var FDe=Mt((e,t)=>{var n=bh("Link",e),r=Ao(e),{className:i,isExternal:a}=r,o=RDe(r,["className","isExternal"]);return ue(xt.a,XR({target:a?"_blank":void 0,rel:a?"noopener noreferrer":void 0,ref:t,className:Wn("chakra-link",i)},o,{__css:n}))});function cm(){return cm=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},cm.apply(this,arguments)}function NG(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var MDe=Mt((e,t)=>{var n=mf("List",e),r=Ao(e),{children:i,styleType:a="none",stylePosition:o,spacing:s}=r,u=NG(r,["children","styleType","stylePosition","spacing"]),l=fD(i),c="& > *:not(style) ~ *:not(style)",f=s?{[c]:{mt:s}}:{};return ue(hy,{value:n},ue(xt.ul,cm({ref:t,listStyleType:a,listStylePosition:o,role:"list",__css:cm({},n.container,f)},u),l))}),PDe=Mt((e,t)=>{var n=NG(e,["as"]);return ue(MDe,cm({ref:t,as:"ul",styleType:"initial",marginStart:"1em"},n))}),$De=Mt((e,t)=>{var n=vi();return ue(xt.li,cm({ref:t},e,{__css:n.item}))});function YR(){return YR=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},YR.apply(this,arguments)}function LDe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var BDe=Mt((e,t)=>{var{columns:n,spacingX:r,spacingY:i,spacing:a,minChildWidth:o}=e,s=LDe(e,["columns","spacingX","spacingY","spacing","minChildWidth"]),u=o?jDe(o):UDe(n);return ue(OG,YR({ref:t,gap:a,columnGap:r,rowGap:i,templateColumns:u},s))});function zDe(e){return pf(e)?e+"px":e}function jDe(e){return uy(e,t=>qW(t)?null:"repeat(auto-fit, minmax("+zDe(t)+", 1fr))")}function UDe(e){return uy(e,t=>qW(t)?null:"repeat("+t+", minmax(0, 1fr))")}var WDe=xt("div",{baseStyle:{flex:1,justifySelf:"stretch",alignSelf:"stretch"}}),ZR="& > *:not(style) ~ *:not(style)";function VDe(e){var{spacing:t,direction:n}=e,r={column:{marginTop:t,marginEnd:0,marginBottom:0,marginStart:0},row:{marginTop:0,marginEnd:0,marginBottom:0,marginStart:t},"column-reverse":{marginTop:0,marginEnd:0,marginBottom:t,marginStart:0},"row-reverse":{marginTop:0,marginEnd:t,marginBottom:0,marginStart:0}};return{flexDirection:n,[ZR]:uy(n,i=>r[i])}}function qDe(e){var{spacing:t,direction:n}=e,r={column:{my:t,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},"column-reverse":{my:t,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},row:{mx:t,my:0,borderLeftWidth:"1px",borderBottomWidth:0},"row-reverse":{mx:t,my:0,borderLeftWidth:"1px",borderBottomWidth:0}};return{"&":uy(n,i=>r[i])}}function HDe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function fm(){return fm=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},fm.apply(this,arguments)}var GDe=e=>ue(xt.div,fm({className:"chakra-stack__item"},e,{__css:fm({display:"inline-block",flex:"0 0 auto",minWidth:0},e.__css)})),DG=Mt((e,t)=>{var{isInline:n,direction:r,align:i,justify:a,spacing:o="0.5rem",wrap:s,children:u,divider:l,className:c,shouldWrapChildren:f}=e,d=HDe(e,["isInline","direction","align","justify","spacing","wrap","children","divider","className","shouldWrapChildren"]),h=n?"row":r??"column",p=xr(()=>VDe({direction:h,spacing:o}),[h,o]),g=xr(()=>qDe({spacing:o,direction:h}),[o,h]),m=!!l,v=!f&&!m,y=fD(u),b=v?y:y.map((w,S)=>{var C=S+1===y.length,_=ue(GDe,{key:S},w),E=f?_:w;if(!m)return E;var A=cf(l,{__css:g}),k=C?null:A;return ue(Vi,{key:S},E,k)}),x=Wn("chakra-stack",c);return ue(xt.div,fm({ref:t,display:"flex",alignItems:i,justifyContent:a,flexDirection:p.flexDirection,flexWrap:s,className:x,__css:m?{}:{[ZR]:p[ZR]}},d),b)}),KDe=Mt((e,t)=>ue(DG,fm({align:"center"},e,{direction:"row",ref:t})));function JR(){return JR=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},JR.apply(this,arguments)}function XDe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var YDe=Mt((e,t)=>{var n=bh("Text",e),r=Ao(e),i=XDe(r,["className","align","decoration","casing"]),a=Z2({textAlign:e.align,textDecoration:e.decoration,textTransform:e.casing});return ue(xt.p,JR({ref:t,className:Wn("chakra-text",e.className)},a,i,{__css:n}))});function Sf(){return Sf=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Sf.apply(this,arguments)}function QR(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var ZDe=Mt((e,t)=>{var n=mf("Table",e),r=Ao(e),{className:i}=r,a=QR(r,["className"]);return ue(hy,{value:n},ue(xt.table,Sf({role:"table",ref:t,__css:n.table,className:Wn("chakra-table",i)},a)))}),JDe=Mt((e,t)=>{var n=vi();return ue(xt.thead,Sf({},e,{ref:t,__css:n.thead}))}),QDe=Mt((e,t)=>{var n=vi();return ue(xt.tbody,Sf({},e,{ref:t,__css:n.tbody}))}),eRe=Mt((e,t)=>{var{isNumeric:n}=e,r=QR(e,["isNumeric"]),i=vi();return ue(xt.th,Sf({},r,{ref:t,__css:i.th,"data-is-numeric":n}))}),tRe=Mt((e,t)=>{var n=vi();return ue(xt.tr,Sf({role:"row"},e,{ref:t,__css:n.tr}))}),nRe=Mt((e,t)=>{var{isNumeric:n}=e,r=QR(e,["isNumeric"]),i=vi();return ue(xt.td,Sf({role:"gridcell"},r,{ref:t,__css:i.td,"data-is-numeric":n}))});function rRe(){var e=Jt(new Map),t=e.current,n=st((i,a,o,s)=>{e.current.set(o,{type:a,el:i,options:s}),i.addEventListener(a,o,s)},[]),r=st((i,a,o,s)=>{i.removeEventListener(a,o,s),e.current.delete(o)},[]);return qt(()=>()=>{t.forEach((i,a)=>{r(i.el,i.type,a,i.options)})},[r,t]),{add:n,remove:r}}function Z_(){return Z_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Z_.apply(this,arguments)}function iRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function eF(e){var t=e.target,{tagName:n,isContentEditable:r}=t;return n!=="INPUT"&&n!=="TEXTAREA"&&r!==!0}function aRe(e){e===void 0&&(e={});var{ref:t,isDisabled:n,isFocusable:r,clickOnEnter:i=!0,clickOnSpace:a=!0,onMouseDown:o,onMouseUp:s,onClick:u,onKeyDown:l,onKeyUp:c,tabIndex:f,onMouseOver:d,onMouseLeave:h}=e,p=iRe(e,["ref","isDisabled","isFocusable","clickOnEnter","clickOnSpace","onMouseDown","onMouseUp","onClick","onKeyDown","onKeyUp","tabIndex","onMouseOver","onMouseLeave"]),[g,m]=an(!0),[v,y]=an(!1),b=rRe(),x=L=>{!L||L.tagName!=="BUTTON"&&m(!1)},w=g?f:f||0,S=n&&!r,C=st(L=>{if(n){L.stopPropagation(),L.preventDefault();return}var W=L.currentTarget;W.focus(),u==null||u(L)},[n,u]),_=st(L=>{v&&eF(L)&&(L.preventDefault(),L.stopPropagation(),y(!1),b.remove(document,"keyup",_,!1))},[v,b]),E=st(L=>{if(l==null||l(L),!(n||L.defaultPrevented||L.metaKey)&&!(!eF(L.nativeEvent)||g)){var W=i&&L.key==="Enter",G=a&&L.key===" ";if(G&&(L.preventDefault(),y(!0)),W){L.preventDefault();var K=L.currentTarget;K.click()}b.add(document,"keyup",_,!1)}},[n,g,l,i,a,b,_]),A=st(L=>{if(c==null||c(L),!(n||L.defaultPrevented||L.metaKey)&&!(!eF(L.nativeEvent)||g)){var W=a&&L.key===" ";if(W){L.preventDefault(),y(!1);var G=L.currentTarget;G.click()}}},[a,g,n,c]),k=st(L=>{L.button===0&&(y(!1),b.remove(document,"mouseup",k,!1))},[b]),T=st(L=>{if(!ZW(L)){if(n){L.stopPropagation(),L.preventDefault();return}g||y(!0);var W=L.currentTarget;W.focus({preventScroll:!0}),b.add(document,"mouseup",k,!1),o==null||o(L)}},[n,g,o,b,k]),I=st(L=>{ZW(L)||(g||y(!1),s==null||s(L))},[s,g]),N=st(L=>{if(n){L.preventDefault();return}d==null||d(L)},[n,d]),O=st(L=>{v&&(L.preventDefault(),y(!1)),h==null||h(L)},[v,h]),D=gf(t,x);return g?Z_({},p,{ref:D,type:"button","aria-disabled":S?void 0:n,disabled:S,onClick:C,onMouseDown:o,onMouseUp:s,onKeyUp:c,onKeyDown:l,onMouseOver:d,onMouseLeave:h}):Z_({},p,{ref:D,role:"button","data-active":Ii(v),"aria-disabled":n?"true":void 0,tabIndex:S?void 0:w,onClick:C,onMouseDown:T,onMouseUp:I,onKeyUp:A,onKeyDown:E,onMouseOver:N,onMouseLeave:O})}function oRe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var sRe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",uRe=sRe,lRe=uRe;function RG(){}function FG(){}FG.resetWarningCache=RG;var cRe=function(){function e(r,i,a,o,s,u){if(u!==lRe){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}e.isRequired=e;function t(){return e}var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:FG,resetWarningCache:RG};return n.PropTypes=n,n};cRe();var tF="data-focus-lock",MG="data-focus-lock-disabled",fRe="data-no-focus-lock",dRe="data-autofocus-inside";function hRe(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function pRe(e,t){var n=an(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var i=n.value;i!==r&&(n.value=r,n.callback(r,i))}}}})[0];return n.callback=t,n.facade}function PG(e,t){return pRe(t,function(n){return e.forEach(function(r){return hRe(r,n)})})}var nF={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var J_=function(){return J_=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},J_.apply(this,arguments)};function gRe(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function $G(e){return e}function LG(e,t){t===void 0&&(t=$G);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(a){var o=t(a,r);return n.push(o),function(){n=n.filter(function(s){return s!==o})}},assignSyncMedium:function(a){for(r=!0;n.length;){var o=n;n=[],o.forEach(a)}n={push:function(s){return a(s)},filter:function(){return n}}},assignMedium:function(a){r=!0;var o=[];if(n.length){var s=n;n=[],s.forEach(a),o=n}var u=function(){var c=o;o=[],c.forEach(a)},l=function(){return Promise.resolve().then(u)};l(),n={push:function(c){o.push(c),l()},filter:function(c){return o=o.filter(c),n}}}};return i}function rF(e,t){return t===void 0&&(t=$G),LG(e,t)}function BG(e){e===void 0&&(e={});var t=LG(null);return t.options=J_({async:!0,ssr:!1},e),t}var zG=function(e){var t=e.sideCar,n=gRe(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return ue(r,J_({},n))};zG.isSideCarExport=!0;function mRe(e,t){return e.useMedium(t),zG}var jG=rF({},function(e){var t=e.target,n=e.currentTarget;return{target:t,currentTarget:n}}),UG=rF(),vRe=rF(),yRe=BG({async:!0}),bRe=[],Q_=Gl(function(t,n){var r,i=an(),a=i[0],o=i[1],s=Jt(),u=Jt(!1),l=Jt(null),c=t.children,f=t.disabled,d=t.noFocusGuards,h=t.persistentFocus,p=t.crossFrame,g=t.autoFocus;t.allowTextSelection;var m=t.group,v=t.className,y=t.whiteList,b=t.shards,x=b===void 0?bRe:b,w=t.as,S=w===void 0?"div":w,C=t.lockProps,_=C===void 0?{}:C,E=t.sideCar,A=t.returnFocus,k=t.onActivation,T=t.onDeactivation,I=an({}),N=I[0],O=st(function(){l.current=l.current||document&&document.activeElement,s.current&&k&&k(s.current),u.current=!0},[k]),D=st(function(){u.current=!1,T&&T(s.current)},[T]),L=st(function(Te){var De=l.current;if(Boolean(A)&&De&&De.focus){var me=typeof A=="object"?A:void 0;l.current=null,Te?Promise.resolve().then(function(){return De.focus(me)}):De.focus(me)}},[A]),W=st(function(Te){u.current&&jG.useMedium(Te)},[]),G=UG.useMedium,K=st(function(Te){s.current!==Te&&(s.current=Te,o(Te))},[]),ee=vh((r={},r[MG]=f&&"disabled",r[tF]=m,r),_),ce=d!==!0,he=ce&&d!=="tail",Oe=PG([n,K]);return ue(Vi,null,ce&&[ue("div",{key:"guard-first","data-focus-guard":!0,tabIndex:f?-1:0,style:nF}),ue("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:f?-1:1,style:nF})],!f&&ue(E,{id:N,sideCar:yRe,observed:a,disabled:f,persistentFocus:h,crossFrame:p,autoFocus:g,whiteList:y,shards:x,onActivation:O,onDeactivation:D,returnFocus:L}),ue(S,vh({ref:Oe},ee,{className:v,onBlur:G,onFocus:W}),c),he&&ue("div",{"data-focus-guard":!0,tabIndex:f?-1:0,style:nF}))});Q_.propTypes={},Q_.defaultProps={children:void 0,disabled:!1,returnFocus:!1,noFocusGuards:!1,autoFocus:!0,persistentFocus:!1,crossFrame:!0,allowTextSelection:void 0,group:void 0,className:void 0,whiteList:void 0,shards:void 0,as:"div",lockProps:{},onActivation:void 0,onDeactivation:void 0};function iF(e,t){return iF=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},iF(e,t)}function xRe(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,iF(e,t)}function wRe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _Re(e,t){function n(r){return r.displayName||r.name||"Component"}return function(i){var a=[],o;function s(){o=e(a.map(function(l){return l.props})),t(o)}var u=function(l){xRe(c,l);function c(){return l.apply(this,arguments)||this}c.peek=function(){return o};var f=c.prototype;return f.componentDidMount=function(){a.push(this),s()},f.componentDidUpdate=function(){s()},f.componentWillUnmount=function(){var h=a.indexOf(this);a.splice(h,1),s()},f.render=function(){return zt.createElement(i,this.props)},c}(w2);return wRe(u,"displayName","SideEffect("+n(i)+")"),u}}var Ef=function(e){for(var t=Array(e.length),n=0;n<e.length;++n)t[n]=e[n];return t},aF=function(e){return Array.isArray(e)?e:[e]},SRe=function(e){for(var t=new Set,n=e.length,r=0;r<n;r+=1)for(var i=r+1;i<n;i+=1){var a=e[r].compareDocumentPosition(e[i]);(a&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&t.add(i),(a&Node.DOCUMENT_POSITION_CONTAINS)>0&&t.add(r)}return e.filter(function(o,s){return!t.has(s)})},WG=function(e){return e.parentNode?WG(e.parentNode):e},oF=function(e){var t=aF(e);return t.filter(Boolean).reduce(function(n,r){var i=r.getAttribute(tF);return n.push.apply(n,i?SRe(Ef(WG(r).querySelectorAll("["+tF+'="'+i+'"]:not(['+MG+'="disabled"])'))):[r]),n},[])},ERe=function(e){return!e||!e.getPropertyValue?!1:e.getPropertyValue("display")==="none"||e.getPropertyValue("visibility")==="hidden"},VG=function(e){return!e||e===document||e&&e.nodeType===Node.DOCUMENT_NODE||!ERe(window.getComputedStyle(e,null))&&VG(e.parentNode&&e.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e.parentNode.host:e.parentNode)},CRe=function(e){return!((e.tagName==="INPUT"||e.tagName==="BUTTON")&&(e.type==="hidden"||e.disabled))},sF=function(e){return Boolean(e&&e.dataset&&e.dataset.focusGuard)},eS=function(e){return!sF(e)},ARe=function(e){return Boolean(e)},kRe=function(e,t){var n=e.tabIndex-t.tabIndex,r=e.index-t.index;if(n){if(!e.tabIndex)return 1;if(!t.tabIndex)return-1}return n||r},qG=function(e,t,n){return Ef(e).map(function(r,i){return{node:r,index:i,tabIndex:n&&r.tabIndex===-1?(r.dataset||{}).focusGuard?0:-1:r.tabIndex}}).filter(function(r){return!t||r.tabIndex>=0}).sort(kRe)},TRe=["button:enabled","select:enabled","textarea:enabled","input:enabled","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[tabindex]","[contenteditable]","[autofocus]"],uF=TRe.join(","),ORe=uF+", [data-focus-guard]",lF=function(e,t){return e.reduce(function(n,r){return n.concat(Ef(r.querySelectorAll(t?ORe:uF)),r.parentNode?Ef(r.parentNode.querySelectorAll(uF)).filter(function(i){return i===r}):[])},[])},IRe=function(e){var t=e.querySelectorAll("["+dRe+"]");return Ef(t).map(function(n){return lF([n])}).reduce(function(n,r){return n.concat(r)},[])},cF=function(e){return Ef(e).filter(function(t){return VG(t)}).filter(function(t){return CRe(t)})},fF=function(e,t){return qG(cF(lF(e,t)),!0,t)},HG=function(e){return qG(cF(lF(e)),!1)},NRe=function(e){return cF(IRe(e))},dF=function(e,t){return t===void 0&&(t=[]),t.push(e),e.parentNode&&dF(e.parentNode,t),t},hF=function(e,t){for(var n=dF(e),r=dF(t),i=0;i<n.length;i+=1){var a=n[i];if(r.indexOf(a)>=0)return a}return!1},GG=function(e,t,n){var r=aF(e),i=aF(t),a=r[0],o=!1;return i.filter(Boolean).forEach(function(s){o=hF(o||s,s)||o,n.filter(Boolean).forEach(function(u){var l=hF(a,u);l&&(!o||l.contains(o)?o=l:o=hF(l,o))})}),o},DRe=function(e){return e.reduce(function(t,n){return t.concat(NRe(n))},[])},RRe=function(e){var t=oF(e).filter(eS),n=GG(e,e,t),r=fF([n],!0),i=fF(t).filter(function(a){var o=a.node;return eS(o)}).map(function(a){var o=a.node;return o});return r.map(function(a){var o=a.node,s=a.index;return{node:o,index:s,lockItem:i.indexOf(o)>=0,guard:sF(o)}})},FRe=function(e){return e===document.activeElement},MRe=function(e){return Boolean(Ef(e.querySelectorAll("iframe")).some(function(t){return FRe(t)}))},KG=function(e){var t=document&&document.activeElement;return!t||t.dataset&&t.dataset.focusGuard?!1:oF(e).reduce(function(n,r){return n||r.contains(t)||MRe(r)},!1)},PRe=function(){return document&&Ef(document.querySelectorAll("["+fRe+"]")).some(function(e){return e.contains(document.activeElement)})},XG=function(e){return e.tagName==="INPUT"&&e.type==="radio"},$Re=function(e,t){return t.filter(XG).filter(function(n){return n.name===e.name}).filter(function(n){return n.checked})[0]||e},pF=function(e,t){return XG(e)&&e.name?$Re(e,t):e},LRe=function(e){var t=new Set;return e.forEach(function(n){return t.add(pF(n,e))}),e.filter(function(n){return t.has(n)})},YG=function(e){return e[0]&&e.length>1?pF(e[0],e):e[0]},ZG=function(e,t){return e.length>1?e.indexOf(pF(e[t],e)):t},JG="NEW_FOCUS",BRe=function(e,t,n,r){var i=e.length,a=e[0],o=e[i-1],s=sF(n);if(!(e.indexOf(n)>=0)){var u=t.indexOf(n),l=r?t.indexOf(r):u,c=r?e.indexOf(r):-1,f=u-l,d=t.indexOf(a),h=t.indexOf(o),p=LRe(t),g=p.indexOf(n)-(r?p.indexOf(r):u),m=ZG(e,0),v=ZG(e,i-1);if(u===-1||c===-1)return JG;if(!f&&c>=0)return c;if(u<=d&&s&&Math.abs(f)>1)return v;if(u>=h&&s&&Math.abs(f)>1)return m;if(f&&Math.abs(g)>1)return c;if(u<=d)return v;if(u>h)return m;if(f)return Math.abs(f)>1?c:(i+c+f)%i}},zRe=function(e){return function(t){return t.autofocus||t.dataset&&!!t.dataset.autofocus||e.indexOf(t)>=0}},jRe=function(e,t){var n=new Map;return t.forEach(function(r){return n.set(r.node,r)}),e.map(function(r){return n.get(r)}).filter(ARe)},URe=function(e,t){var n=document&&document.activeElement,r=oF(e).filter(eS),i=GG(n||e,e,r),a=HG(r),o=fF(r).filter(function(d){var h=d.node;return eS(h)});if(!(!o[0]&&(o=a,!o[0]))){var s=HG([i]).map(function(d){var h=d.node;return h}),u=jRe(s,o),l=u.map(function(d){var h=d.node;return h}),c=BRe(l,s,n,t);if(c===JG){var f=a.map(function(d){var h=d.node;return h}).filter(zRe(DRe(r)));return{node:f&&f.length?YG(f):YG(l)}}return c===void 0?c:u[c]}},WRe=function(e){e.focus(),"contentWindow"in e&&e.contentWindow&&e.contentWindow.focus()},gF=0,mF=!1,QG=function(e,t){var n=URe(e,t);if(!mF&&n){if(gF>2){console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),mF=!0,setTimeout(function(){mF=!1},1);return}gF++,WRe(n.node),gF--}};function eK(e){var t=window,n=t.setImmediate;typeof n!="undefined"?n(e):setTimeout(e,1)}var VRe=function(){return document&&document.activeElement===document.body},qRe=function(){return VRe()||PRe()},dm=null,hm=null,pm=null,Uy=!1,HRe=function(){return!0},GRe=function(t){return(dm.whiteList||HRe)(t)},KRe=function(t,n){pm={observerNode:t,portaledElement:n}},XRe=function(t){return pm&&pm.portaledElement===t};function tK(e,t,n,r){var i=null,a=e;do{var o=r[a];if(o.guard)o.node.dataset.focusAutoGuard&&(i=o);else if(o.lockItem){if(a!==e)return;i=null}else break}while((a+=n)!==t);i&&(i.node.tabIndex=0)}var YRe=function(t){return t&&"current"in t?t.current:t},ZRe=function(t){return t?Boolean(Uy):Uy==="meanwhile"},tS=function(){var t=!1;if(dm){var n=dm,r=n.observed,i=n.persistentFocus,a=n.autoFocus,o=n.shards,s=n.crossFrame,u=r||pm&&pm.portaledElement,l=document&&document.activeElement;if(u){var c=[u].concat(o.map(YRe).filter(Boolean));if((!l||GRe(l))&&(i||ZRe(s)||!qRe()||!hm&&a)&&(u&&!(KG(c)||XRe(l))&&(document&&!hm&&l&&!a?(l.blur&&l.blur(),document.body.focus()):(t=QG(c,hm),pm={})),Uy=!1,hm=document&&document.activeElement),document){var f=document&&document.activeElement,d=RRe(c),h=d.map(function(p){var g=p.node;return g}).indexOf(f);h>-1&&(d.filter(function(p){var g=p.guard,m=p.node;return g&&m.dataset.focusAutoGuard}).forEach(function(p){var g=p.node;return g.removeAttribute("tabIndex")}),tK(h,d.length,1,d),tK(h,-1,-1,d))}}}return t},nK=function(t){tS()&&t&&(t.stopPropagation(),t.preventDefault())},vF=function(){return eK(tS)},JRe=function(t){var n=t.target,r=t.currentTarget;r.contains(n)||KRe(r,n)},QRe=function(){return null},rK=function(){Uy="just",setTimeout(function(){Uy="meanwhile"},0)},eFe=function(){document.addEventListener("focusin",nK,!0),document.addEventListener("focusout",vF),window.addEventListener("blur",rK)},tFe=function(){document.removeEventListener("focusin",nK,!0),document.removeEventListener("focusout",vF),window.removeEventListener("blur",rK)};function nFe(e){return e.filter(function(t){var n=t.disabled;return!n})}function rFe(e){var t=e.slice(-1)[0];t&&!dm&&eFe();var n=dm,r=n&&t&&t.id===n.id;dm=t,n&&!r&&(n.onDeactivation(),e.filter(function(i){var a=i.id;return a===n.id}).length||n.returnFocus(!t)),t?(hm=null,(!r||n.observed!==t.observed)&&t.onActivation(),tS(),eK(tS)):(tFe(),hm=null)}jG.assignSyncMedium(JRe),UG.assignMedium(vF),vRe.assignMedium(function(e){return e({moveFocusInside:QG,focusInside:KG})});var iFe=_Re(nFe,rFe)(QRe),iK=Gl(function(t,n){return ue(Q_,vh({sideCar:iFe,ref:n},t))}),aK=Q_.propTypes||{};aK.sideCar,oRe(aK,["sideCar"]),iK.propTypes={};var aFe=e=>{var{initialFocusRef:t,finalFocusRef:n,contentRef:r,restoreFocus:i,children:a,isDisabled:o,autoFocus:s,persistentFocus:u,lockFocusAcrossFrames:l}=e,c=st(()=>{if(t!=null&&t.current)t.current.focus();else if(r!=null&&r.current){var h=iwe(r.current);h.length===0&&Hg(r.current,{nextTick:!0})}},[t,r]),f=st(()=>{var h;n==null||(h=n.current)==null||h.focus()},[n]),d=i&&!n;return ue(iK,{crossFrame:l,persistentFocus:u,autoFocus:s,disabled:o,onActivation:c,onDeactivation:f,returnFocus:d},a)};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var gm=function(){return gm=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},gm.apply(this,arguments)};function oFe(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}var nS="right-scroll-bar-position",rS="width-before-scroll-bar",sFe="with-scroll-bars-hidden",uFe="--removed-body-scroll-bar-size",oK=BG(),yF=function(){},iS=Gl(function(e,t){var n=Jt(null),r=an({onScrollCapture:yF,onWheelCapture:yF,onTouchMoveCapture:yF}),i=r[0],a=r[1],o=e.forwardProps,s=e.children,u=e.className,l=e.removeScrollBar,c=e.enabled,f=e.shards,d=e.sideCar,h=e.noIsolation,p=e.inert,g=e.allowPinchZoom,m=e.as,v=m===void 0?"div":m,y=oFe(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),b=d,x=PG([n,t]),w=gm({},y,i);return ue(Vi,null,c&&ue(b,{sideCar:oK,removeScrollBar:l,shards:f,noIsolation:h,inert:p,setCallbacks:a,allowPinchZoom:!!g,lockRef:n}),o?cf(_2.only(s),gm({},w,{ref:x})):ue(v,gm({},w,{className:u,ref:x}),s))});iS.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},iS.classNames={fullWidth:rS,zeroRight:nS};var lFe=function(){if(typeof __webpack_nonce__!="undefined")return __webpack_nonce__};function cFe(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=lFe();return t&&e.setAttribute("nonce",t),e}function fFe(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function dFe(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var hFe=function(){var e=0,t=null;return{add:function(n){e==0&&(t=cFe())&&(fFe(t,n),dFe(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},pFe=function(){var e=hFe();return function(t){qt(function(){return e.add(t),function(){e.remove()}},[])}},sK=function(){var e=pFe(),t=function(n){var r=n.styles;return e(r),null};return t},gFe={left:0,top:0,right:0,gap:0},bF=function(e){return parseInt(e||"",10)||0},mFe=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],i=t[e==="padding"?"paddingRight":"marginRight"];return[bF(n),bF(r),bF(i)]},uK=function(e){if(e===void 0&&(e="margin"),typeof window=="undefined")return gFe;var t=mFe(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},vFe=sK(),yFe=function(e,t,n,r){var i=e.left,a=e.top,o=e.right,s=e.gap;return n===void 0&&(n="margin"),`
  .`+sFe+` {
   overflow: hidden `+r+`;
   padding-right: `+s+"px "+r+`;
  }
  body {
    overflow: hidden `+r+`;
    `+[t&&"position: relative "+r+";",n==="margin"&&`
    padding-left: `+i+`px;
    padding-top: `+a+`px;
    padding-right: `+o+`px;
    margin-left:0;
    margin-top:0;
    margin-right: `+s+"px "+r+`;
    `,n==="padding"&&"padding-right: "+s+"px "+r+";"].filter(Boolean).join("")+`
  }
  
  .`+nS+` {
    right: `+s+"px "+r+`;
  }
  
  .`+rS+` {
    margin-right: `+s+"px "+r+`;
  }
  
  .`+nS+" ."+nS+` {
    right: 0 `+r+`;
  }
  
  .`+rS+" ."+rS+` {
    margin-right: 0 `+r+`;
  }
  
  body {
    `+uFe+": "+s+`px;
  }
`},bFe=function(e){var t=an(uK(e.gapMode)),n=t[0],r=t[1];qt(function(){r(uK(e.gapMode))},[e.gapMode]);var i=e.noRelative,a=e.noImportant,o=e.gapMode,s=o===void 0?"margin":o;return ue(vFe,{styles:yFe(n,!i,s,a?"":"!important")})},xFe=function(e){var t=window.getComputedStyle(e);return t.overflowY!=="hidden"&&!(t.overflowY===t.overflowX&&t.overflowY==="visible")},wFe=function(e){var t=window.getComputedStyle(e);return t.overflowX!=="hidden"&&!(t.overflowY===t.overflowX&&t.overflowX==="visible")},lK=function(e,t){var n=t;do{var r=cK(e,n);if(r){var i=fK(e,n),a=i[1],o=i[2];if(a>o)return!0}n=n.parentNode}while(n&&n!==document.body);return!1},_Fe=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},SFe=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},cK=function(e,t){return e==="v"?xFe(t):wFe(t)},fK=function(e,t){return e==="v"?_Fe(t):SFe(t)},EFe=function(e,t,n,r,i){var a=r,o=n.target,s=t.contains(o),u=!1,l=a>0,c=0,f=0;do{var d=fK(e,o),h=d[0],p=d[1],g=d[2],m=p-g-h;(h||m)&&cK(e,o)&&(c+=m,f+=h),o=o.parentNode}while(!s&&o!==document.body||s&&(t.contains(o)||t===o));return(l&&(i&&c===0||!i&&a>c)||!l&&(i&&f===0||!i&&-a>f))&&(u=!0),u},xF=!1;if(typeof window!="undefined")try{var aS=Object.defineProperty({},"passive",{get:function(){return xF=!0,!0}});window.addEventListener("test",aS,aS),window.removeEventListener("test",aS,aS)}catch(e){xF=!1}var mm=xF?{passive:!1}:!1,oS=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},dK=function(e){return[e.deltaX,e.deltaY]},hK=function(e){return e&&"current"in e?e.current:e},CFe=function(e,t){return e[0]===t[0]&&e[1]===t[1]},AFe=function(e){return`
  .block-interactivity-`+e+` {pointer-events: none;}
  .allow-interactivity-`+e+` {pointer-events: all;}
`},kFe=0,vm=[];function TFe(e){var t=Jt([]),n=Jt([0,0]),r=Jt(),i=an(kFe++)[0],a=an(function(){return sK()})[0],o=Jt(e);qt(function(){o.current=e},[e]),qt(function(){if(e.inert){document.body.classList.add("block-interactivity-"+i);var g=[e.lockRef.current].concat((e.shards||[]).map(hK)).filter(Boolean);return g.forEach(function(m){return m.classList.add("allow-interactivity-"+i)}),function(){document.body.classList.remove("block-interactivity-"+i),g.forEach(function(m){return m.classList.remove("allow-interactivity-"+i)})}}},[e.inert,e.lockRef.current,e.shards]);var s=st(function(g,m){if("touches"in g&&g.touches.length===2)return!o.current.allowPinchZoom;var v=oS(g),y=n.current,b="deltaX"in g?g.deltaX:y[0]-v[0],x="deltaY"in g?g.deltaY:y[1]-v[1],w,S=g.target,C=Math.abs(b)>Math.abs(x)?"h":"v",_=lK(C,S);if(!_)return!0;if(_?w=C:(w=C==="v"?"h":"v",_=lK(C,S)),!_)return!1;if(!r.current&&"changedTouches"in g&&(b||x)&&(r.current=w),!w)return!0;var E=r.current||w;return EFe(E,m,g,E==="h"?b:x,!0)},[]),u=st(function(g){var m=g;if(!(!vm.length||vm[vm.length-1]!==a)){var v="deltaY"in m?dK(m):oS(m),y=t.current.filter(function(w){return w.name===m.type&&w.target===m.target&&CFe(w.delta,v)})[0];if(y&&y.should){m.preventDefault();return}if(!y){var b=(o.current.shards||[]).map(hK).filter(Boolean).filter(function(w){return w.contains(m.target)}),x=b.length>0?s(m,b[0]):!o.current.noIsolation;x&&m.preventDefault()}}},[]),l=st(function(g,m,v,y){var b={name:g,delta:m,target:v,should:y};t.current.push(b),setTimeout(function(){t.current=t.current.filter(function(x){return x!==b})},1)},[]),c=st(function(g){n.current=oS(g),r.current=void 0},[]),f=st(function(g){l(g.type,dK(g),g.target,s(g,e.lockRef.current))},[]),d=st(function(g){l(g.type,oS(g),g.target,s(g,e.lockRef.current))},[]);qt(function(){return vm.push(a),e.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:d}),document.addEventListener("wheel",u,mm),document.addEventListener("touchmove",u,mm),document.addEventListener("touchstart",c,mm),function(){vm=vm.filter(function(g){return g!==a}),document.removeEventListener("wheel",u,mm),document.removeEventListener("touchmove",u,mm),document.removeEventListener("touchstart",c,mm)}},[]);var h=e.removeScrollBar,p=e.inert;return ue(Vi,null,p?ue(a,{styles:AFe(i)}):null,h?ue(bFe,{gapMode:"margin"}):null)}var OFe=mRe(oK,TFe),pK=Gl(function(e,t){return ue(iS,gm({},e,{ref:t,sideCar:OFe}))});pK.classNames=iS.classNames;var IFe=function(e){if(typeof document=="undefined")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},ym=new WeakMap,sS=new WeakMap,uS={},wF=0,NFe=function(e,t,n){t===void 0&&(t=IFe(e)),n===void 0&&(n="data-aria-hidden");var r=Array.isArray(e)?e:[e];uS[n]||(uS[n]=new WeakMap);var i=uS[n],a=[],o=new Set,s=function(l){!l||o.has(l)||(o.add(l),s(l.parentNode))};r.forEach(s);var u=function(l){!l||r.indexOf(l)>=0||Array.prototype.forEach.call(l.children,function(c){if(o.has(c))u(c);else{var f=c.getAttribute("aria-hidden"),d=f!==null&&f!=="false",h=(ym.get(c)||0)+1,p=(i.get(c)||0)+1;ym.set(c,h),i.set(c,p),a.push(c),h===1&&d&&sS.set(c,!0),p===1&&c.setAttribute(n,"true"),d||c.setAttribute("aria-hidden","true")}})};return u(t),o.clear(),wF++,function(){a.forEach(function(l){var c=ym.get(l)-1,f=i.get(l)-1;ym.set(l,c),i.set(l,f),c||(sS.has(l)||l.removeAttribute("aria-hidden"),sS.delete(l)),f||l.removeAttribute(n)}),wF--,wF||(ym=new WeakMap,ym=new WeakMap,sS=new WeakMap,uS={})}};function DFe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class RFe{constructor(){DFe(this,"modals",void 0),this.modals=[]}add(t){this.modals.push(t)}remove(t){this.modals=this.modals.filter(n=>n!==t)}isTopModal(t){var n=this.modals[this.modals.length-1];return n===t}}var _F=new RFe;function FFe(e,t){qt(()=>(t&&_F.add(e),()=>{_F.remove(e)}),[t,e])}function lS(){return lS=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},lS.apply(this,arguments)}function MFe(e){var{isOpen:t,onClose:n,id:r,closeOnOverlayClick:i=!0,closeOnEsc:a=!0,useInert:o=!0,onOverlayClick:s,onEsc:u}=e,l=Jt(null),c=Jt(null),[f,d,h]=Ewe(r,"chakra-modal","chakra-modal--header","chakra-modal--body");PFe(l,t&&o),FFe(l,t);var p=Jt(null),g=st(_=>{p.current=_.target},[]),m=st(_=>{_.key==="Escape"&&(_.stopPropagation(),a&&(n==null||n()),u==null||u())},[a,n,u]),[v,y]=an(!1),[b,x]=an(!1),w=st(function(_,E){return _===void 0&&(_={}),E===void 0&&(E=null),lS({role:"dialog"},_,{ref:gf(E,l),id:f,tabIndex:-1,"aria-modal":!0,"aria-labelledby":v?d:void 0,"aria-describedby":b?h:void 0,onClick:wr(_.onClick,A=>A.stopPropagation())})},[h,b,f,d,v]),S=st(_=>{_.stopPropagation(),p.current===_.target&&(!_F.isTopModal(l)||(i&&(n==null||n()),s==null||s()))},[n,i,s]),C=st(function(_,E){return _===void 0&&(_={}),E===void 0&&(E=null),lS({},_,{ref:gf(E,c),onClick:wr(_.onClick,S),onKeyDown:wr(_.onKeyDown,m),onMouseDown:wr(_.onMouseDown,g)})},[m,g,S]);return{isOpen:t,onClose:n,headerId:d,bodyId:h,setBodyMounted:x,setHeaderMounted:y,dialogRef:l,overlayRef:c,getDialogProps:w,getDialogContainerProps:C}}function PFe(e,t){qt(()=>{if(!!e.current){var n=null;return t&&e.current&&(n=NFe(e.current)),()=>{t&&(n==null||n())}}},[t,e])}function cS(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function Ql(){return Ql=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ql.apply(this,arguments)}var[$Fe,bm]=Mu({strict:!0,name:"ModalContext",errorMessage:"useModalContext: `context` is undefined. Seems you forgot to wrap modal components in `<Modal />`"}),gK=e=>{var{portalProps:t,children:n,autoFocus:r,trapFocus:i,initialFocusRef:a,finalFocusRef:o,returnFocusOnClose:s,blockScrollOnMount:u,allowPinchZoom:l,preserveScrollBarGap:c,motionPreset:f,lockFocusAcrossFrames:d}=e,h=mf("Modal",e),p=MFe(e),g=Ql({},p,{autoFocus:r,trapFocus:i,initialFocusRef:a,finalFocusRef:o,returnFocusOnClose:s,blockScrollOnMount:u,allowPinchZoom:l,preserveScrollBarGap:c,motionPreset:f,lockFocusAcrossFrames:d});return ue($Fe,{value:g},ue(hy,{value:h},ue(dG,null,g.isOpen&&ue(r_,t,n))))};gK.defaultProps={lockFocusAcrossFrames:!0,returnFocusOnClose:!0,scrollBehavior:"outside",trapFocus:!0,autoFocus:!0,blockScrollOnMount:!0,allowPinchZoom:!1,motionPreset:"scale"};var LFe=xt(cG.div);function BFe(e){var{autoFocus:t,trapFocus:n,dialogRef:r,initialFocusRef:i,blockScrollOnMount:a,allowPinchZoom:o,finalFocusRef:s,returnFocusOnClose:u,preserveScrollBarGap:l,lockFocusAcrossFrames:c}=bm(),[f,d]=YD();return qt(()=>{!f&&d&&setTimeout(d)},[f,d]),ue(aFe,{autoFocus:t,isDisabled:!n,initialFocusRef:i,finalFocusRef:s,restoreFocus:u,contentRef:r,lockFocusAcrossFrames:c},ue(pK,{removeScrollBar:!l,allowPinchZoom:o,enabled:a,forwardProps:!0},e.children))}var mK=Mt((e,t)=>{var{className:n}=e,r=cS(e,["className","transition"]),i=Wn("chakra-modal__overlay",n),a=vi(),o=Ql({pos:"fixed",left:"0",top:"0",w:"100vw",h:"100vh"},a.overlay),{motionPreset:s}=bm(),u=s==="none"?{}:YNe;return ue(LFe,Ql({},u,{__css:o,ref:t,className:i},r))}),zFe=Mt((e,t)=>{var{className:n}=e,r=cS(e,["className"]),{headerId:i,setHeaderMounted:a}=bm();qt(()=>(a(!0),()=>a(!1)),[a]);var o=Wn("chakra-modal__header",n),s=vi(),u=Ql({flex:0},s.header);return ue(xt.header,Ql({ref:t,className:o,id:i},r,{__css:u}))}),vK=Mt((e,t)=>{var{className:n}=e,r=cS(e,["className"]),{bodyId:i,setBodyMounted:a}=bm();qt(()=>(a(!0),()=>a(!1)),[a]);var o=Wn("chakra-modal__body",n),s=vi();return ue(xt.div,Ql({ref:t,className:o,id:i},r,{__css:s.body}))}),jFe=Mt((e,t)=>{var{onClick:n,className:r}=e,i=cS(e,["onClick","className"]),{onClose:a}=bm(),o=Wn("chakra-modal__close-btn",r),s=vi();return ue(ADe,Ql({ref:t,__css:s.closeButton,className:o,onClick:wr(n,u=>{u.stopPropagation(),a()})},i))});function Ah(){return Ah=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ah.apply(this,arguments)}function yK(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var[UFe,WFe]=Mu();function bK(e){var t,{isOpen:n,onClose:r,placement:i="right",children:a}=e,o=yK(e,["isOpen","onClose","placement","children"]),s=CV(),u=(t=s.components)==null?void 0:t.Drawer;return ue(UFe,{value:{placement:i}},ue(gK,Ah({isOpen:n,onClose:r,styleConfig:u},o),a))}var VFe=xt(QNe),xK=Mt((e,t)=>{var{className:n,children:r}=e,i=yK(e,["className","children"]),{getDialogProps:a,getDialogContainerProps:o,isOpen:s}=bm(),u=a(i,t),l=o(),c=Wn("chakra-modal__content",n),f=vi(),d=Ah({display:"flex",flexDirection:"column",position:"relative",width:"100%",outline:0},f.dialog),h=Ah({display:"flex",width:"100vw",height:"100vh",position:"fixed",left:0,top:0},f.dialogContainer),{placement:p}=WFe();return ue(xt.div,Ah({},l,{className:"chakra-modal__content-container",__css:h}),ue(BFe,null,ue(VFe,Ah({direction:p,in:s,className:c},u,{__css:d}),r)))});function Cf(){return Cf=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Cf.apply(this,arguments)}function SF(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var qFe=Mt((e,t)=>{var{children:n,placeholder:r,className:i}=e,a=SF(e,["children","placeholder","className"]),o=AG(a);return ue(xt.select,Cf({},o,{ref:t,className:Wn("chakra-select",i)}),r&&ue("option",{value:""},r),n)}),HFe=Mt((e,t)=>{var n=mf("Select",e),r=Ao(e),{rootProps:i,placeholder:a,icon:o,color:s,height:u,h:l,minH:c,minHeight:f,iconColor:d,iconSize:h}=r,p=SF(r,["rootProps","placeholder","icon","color","height","h","minH","minHeight","iconColor","iconSize","isFullWidth"]),[g,m]=zxe(p,w2e),v={width:"100%",height:"fit-content",position:"relative",color:s},y=Ru({},n.field,{paddingEnd:"2rem",_focus:{zIndex:"unset"}});return ue(xt.div,Cf({className:"chakra-select__wrapper",__css:v},g,i),ue(qFe,Cf({ref:t,height:l??u,minH:c??f,placeholder:a},m,{__css:y}),e.children),ue(XFe,Cf({"data-disabled":e.isDisabled},(d||s)&&{color:d||s},{__css:n.icon},h&&{fontSize:h}),o))}),GFe=e=>ue("svg",Cf({viewBox:"0 0 24 24"},e),ue("path",{fill:"currentColor",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"})),KFe=xt("div",{baseStyle:{position:"absolute",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",top:"50%",transform:"translateY(-50%)"}}),XFe=e=>{var{children:t=ue(GFe,null)}=e,n=SF(e,["children"]),r=cf(t,{role:"presentation",className:"chakra-select__icon",focusable:!1,"aria-hidden":!0,style:{width:"1em",height:"1em",color:"currentColor"}});return ue(KFe,Cf({},n,{className:"chakra-select__icon-wrapper"}),gh(t)?r:null)};function ec(){return ec=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ec.apply(this,arguments)}function YFe(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var ZFe=Mt((e,t)=>{var n=mf("Switch",e),r=Ao(e),{spacing:i="0.5rem",children:a}=r,o=YFe(r,["spacing","children"]),{state:s,getInputProps:u,getCheckboxProps:l,getRootProps:c,getLabelProps:f}=SDe(o),d=xr(()=>ec({display:"inline-block",verticalAlign:"middle",lineHeight:"normal"},n.container),[n.container]),h=xr(()=>ec({display:"inline-flex",flexShrink:0,justifyContent:"flex-start",boxSizing:"content-box",cursor:"pointer"},n.track),[n.track]),p=xr(()=>ec({userSelect:"none",marginStart:i},n.label),[i,n.label]);return ue(xt.label,ec({},c(),{className:Wn("chakra-switch",e.className),__css:d}),ue("input",ec({className:"chakra-switch__input"},u({},t))),ue(xt.span,ec({},l(),{className:"chakra-switch__track",__css:h}),ue(xt.span,{__css:n.thumb,className:"chakra-switch__thumb","data-checked":Ii(s.isChecked),"data-hover":Ii(s.isHovered)})),a&&ue(xt.span,ec({className:"chakra-switch__label"},f(),{__css:p}),a))});function kh(){return kh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},kh.apply(this,arguments)}function EF(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var[JFe,QFe,e3e,t3e]=aDe();function n3e(e){var{defaultIndex:t,onChange:n,index:r,isManual:i,isLazy:a,lazyBehavior:o="unmount",orientation:s="horizontal",direction:u="ltr"}=e,l=EF(e,["defaultIndex","onChange","index","isManual","isLazy","lazyBehavior","orientation","direction"]),[c,f]=an(t??0),[d,h]=_we({defaultValue:t??0,value:r,onChange:n});qt(()=>{r!=null&&f(r)},[r]);var p=e3e(),g=aV(e.id,"tabs");return{id:g,selectedIndex:d,focusedIndex:c,setSelectedIndex:h,setFocusedIndex:f,isManual:i,isLazy:a,lazyBehavior:o,orientation:s,descendants:p,direction:u,htmlProps:l}}var[r3e,fS]=Mu({name:"TabsContext",errorMessage:"useTabsContext: `context` is undefined. Seems you forgot to wrap all tabs components within <Tabs />"});function i3e(e){var{focusedIndex:t,orientation:n,direction:r}=fS(),i=QFe(),a=st(o=>{var s=()=>{var y=i.nextEnabled(t);y&&Hg(y.node)},u=()=>{var y=i.prevEnabled(t);y&&Hg(y.node)},l=()=>{var y=i.firstEnabled();y&&Hg(y.node)},c=()=>{var y=i.lastEnabled();y&&Hg(y.node)},f=n==="horizontal",d=n==="vertical",h=Xxe(o),p=r==="ltr"?"ArrowLeft":"ArrowRight",g=r==="ltr"?"ArrowRight":"ArrowLeft",m={[p]:()=>f&&u(),[g]:()=>f&&s(),ArrowDown:()=>d&&s(),ArrowUp:()=>d&&u(),Home:l,End:c},v=m[h];v&&(o.preventDefault(),v(o))},[i,t,n,r]);return kh({},e,{role:"tablist","aria-orientation":n,onKeyDown:wr(e.onKeyDown,a)})}function a3e(e){var{isDisabled:t,isFocusable:n}=e,r=EF(e,["isDisabled","isFocusable"]),{setSelectedIndex:i,isManual:a,id:o,setFocusedIndex:s,selectedIndex:u}=fS(),{index:l,register:c}=t3e({disabled:t&&!n}),f=l===u,d=()=>{i(l)},h=()=>{s(l);var m=t&&n,v=!a&&!m;v&&i(l)},p=aRe(kh({},r,{ref:gf(c,e.ref),isDisabled:t,isFocusable:n,onClick:wr(e.onClick,d)})),g="button";return kh({},p,{id:wK(o,l),role:"tab",tabIndex:f?0:-1,type:g,"aria-selected":f,"aria-controls":_K(o,l),onFocus:t?void 0:wr(e.onFocus,h)})}function o3e(e){var t=fS(),{id:n,selectedIndex:r}=t,i=fD(e.children),a=i.map((o,s)=>cf(o,{isSelected:s===r,id:_K(n,s),"aria-labelledby":wK(n,s)}));return kh({},e,{children:a})}function s3e(e){var{isSelected:t,id:n,children:r}=e,i=EF(e,["isSelected","id","children"]),{isLazy:a,lazyBehavior:o}=fS(),s=Jt(!1);t&&(s.current=!0);var u=fwe({hasBeenSelected:s.current,isSelected:t,isLazy:a,lazyBehavior:o});return kh({tabIndex:0},i,{children:u?r:null,role:"tabpanel",hidden:!t,id:n})}function wK(e,t){return e+"--tab-"+t}function _K(e,t){return e+"--tabpanel-"+t}function rs(){return rs=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},rs.apply(this,arguments)}function SK(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var u3e=Mt((e,t)=>{var n=mf("Tabs",e),r=Ao(e),{children:i,className:a}=r,o=SK(r,["children","className"]),s=n3e(o),{htmlProps:u,descendants:l}=s,c=SK(s,["htmlProps","descendants"]),f=xr(()=>c,[c]),d=iD(u,["isFitted"]);return ue(JFe,{value:l},ue(r3e,{value:f},ue(hy,{value:n},ue(xt.div,rs({className:Wn("chakra-tabs",a),ref:t},d,{__css:n.root}),i))))}),l3e=Mt((e,t)=>{var n=vi(),r=a3e(rs({},e,{ref:t})),i=rs({outline:"0",display:"flex",alignItems:"center",justifyContent:"center"},n.tab);return ue(xt.button,rs({},r,{className:Wn("chakra-tabs__tab",e.className),__css:i}))}),c3e=Mt((e,t)=>{var n=i3e(rs({},e,{ref:t})),r=vi(),i=rs({display:"flex"},r.tablist);return ue(xt.div,rs({},n,{className:Wn("chakra-tabs__tablist",e.className),__css:i}))}),f3e=Mt((e,t)=>{var n=s3e(rs({},e,{ref:t})),r=vi();return ue(xt.div,rs({outline:"0"},n,{className:Wn("chakra-tabs__tab-panel",e.className),__css:r.tabpanel}))}),d3e=Mt((e,t)=>{var n=o3e(e),r=vi();return ue(xt.div,rs({},n,{width:"100%",ref:t,className:Wn("chakra-tabs__tab-panels",e.className),__css:r.tabpanels}))}),h3e=yy({viewBox:"0 0 14 14",d:"M14,7.77 L14,6.17 L12.06,5.53 L11.61,4.44 L12.49,2.6 L11.36,1.47 L9.55,2.38 L8.46,1.93 L7.77,0.01 L6.17,0.01 L5.54,1.95 L4.43,2.4 L2.59,1.52 L1.46,2.65 L2.37,4.46 L1.92,5.55 L0,6.23 L0,7.82 L1.94,8.46 L2.39,9.55 L1.51,11.39 L2.64,12.52 L4.45,11.61 L5.54,12.06 L6.23,13.98 L7.82,13.98 L8.45,12.04 L9.56,11.59 L11.4,12.47 L12.53,11.34 L11.61,9.53 L12.08,8.44 L14,7.75 L14,7.77 Z M7,10 C5.34,10 4,8.66 4,7 C4,5.34 5.34,4 7,4 C8.66,4 10,5.34 10,7 C10,8.66 8.66,10 7,10 Z",displayName:"SettingsIcon"}),p3e=yy({displayName:"ExternalLinkIcon",path:ue("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeWidth:"2"},ue("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),ue("path",{d:"M15 3h6v6"}),ue("path",{d:"M10 14L21 3"}))}),g3e=yy({displayName:"CloseIcon",d:"M.439,21.44a1.5,1.5,0,0,0,2.122,2.121L11.823,14.3a.25.25,0,0,1,.354,0l9.262,9.263a1.5,1.5,0,1,0,2.122-2.121L14.3,12.177a.25.25,0,0,1,0-.354l9.263-9.262A1.5,1.5,0,0,0,21.439.44L12.177,9.7a.25.25,0,0,1-.354,0L2.561.44A1.5,1.5,0,0,0,.439,2.561L9.7,11.823a.25.25,0,0,1,0,.354Z"}),m3e=yy({d:"M12,0A12,12,0,1,0,24,12,12.013,12.013,0,0,0,12,0Zm0,19a1.5,1.5,0,1,1,1.5-1.5A1.5,1.5,0,0,1,12,19Zm1.6-6.08a1,1,0,0,0-.6.917,1,1,0,1,1-2,0,3,3,0,0,1,1.8-2.75A2,2,0,1,0,10,9.255a1,1,0,1,1-2,0,4,4,0,1,1,5.6,3.666Z",displayName:"QuestionIcon"}),EK=yy({viewBox:"0 0 14 14",path:ue("g",{fill:"currentColor"},ue("polygon",{points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"}))});const v3e=({options:e})=>{const[t,n]=an(!1),r=st(()=>{n(!t)},[t]);return zt.createElement(zt.Fragment,null,zt.createElement(G_,{verticalAlign:"top","aria-label":"Metaframe settings",icon:zt.createElement(h3e,null),size:"lg",onClick:r}),zt.createElement(y3e,{isOpen:t,setOpen:n,options:e}))},y3e=({isOpen:e,setOpen:t,options:n})=>{const[r,i]=VU("options",Object.fromEntries(n.filter(d=>d.default).map(d=>[d.name,d.default]))),[a,o]=an(r||{}),[s,u]=an(void 0),l=st(d=>{const{name:h,value:p}=d.target,g=n.find(m=>m.name===h);if(!g){console.error(`No option found for name=${h}`);return}g.type==="boolean"?o(Object.assign(Object.assign({},a),{[h]:p==="1"})):o(Object.assign(Object.assign({},a),{[h]:p}))},[a,o,n]),c=st(()=>{t(!e)},[t,e]),f=st(()=>{const d={};if(Object.keys(a).forEach(p=>{const g=n.find(m=>m.name===p);if(g&&g.validator&&g.type!=="boolean"){const m=g.validator(a[p]);m&&(d[p]=m)}}),Object.keys(d).length>0){u(d);return}u(void 0);const h={};Object.keys(a).forEach(p=>{const g=n.find(m=>m.name===p);g?g.map?h[p]=g.map(a[p]):g.type==="boolean"?h[p]=a[p]===!0||a[p]==="1"||a[p]==="true":h[p]=a[p]:h[p]=a[p]}),t(!e),i(h)},[t,e,n,a,i,u]);return qt(()=>{const d=h=>{h.key==="Enter"&&e&&f()};return window.addEventListener("keyup",d),()=>{window.removeEventListener("keyup",d)}},[f,e]),zt.createElement(bK,{placement:"top",onClose:f,isOpen:e},zt.createElement(mK,null,zt.createElement(xK,null,zt.createElement(zFe,{borderBottomWidth:"0px"},"Configure metaframe (stored in URL hash params )"),zt.createElement(vK,null,zt.createElement(X_,{maxW:"80%",p:2,borderWidth:"4px",borderRadius:"lg",overflow:"hidden"},zt.createElement(OG,{templateColumns:"repeat(12, 1fr)",gap:6},n.map(d=>zt.createElement(zt.Fragment,null,zt.createElement(Ch,{rowSpan:1,colSpan:4},zt.createElement(X_,{w:"100%",h:"100%",display:"flex",alignItems:"center",justifyContent:"flex-end"},zt.createElement(YDe,{textAlign:"right",verticalAlign:"bottom"},d.displayName||d.name,":"))),zt.createElement(Ch,{rowSpan:1,colSpan:8}," ",b3e(d,a[d.name],l)))),zt.createElement(Ch,{rowSpan:1,colSpan:12}),zt.createElement(Ch,{rowSpan:1,colSpan:12}),zt.createElement(Ch,{rowSpan:1,colSpan:12}),zt.createElement(Ch,{rowSpan:1,colSpan:10}),zt.createElement(Ch,{rowSpan:0,colSpan:2},zt.createElement(KDe,{spacing:2,justify:"flex-end",direction:"row"},zt.createElement(G_,{size:"lg",color:"red",icon:zt.createElement(g3e,null),onClick:c}),zt.createElement(G_,{size:"lg",color:"green",icon:zt.createElement(EK,null),onClick:f})))))))))},b3e=(e,t,n)=>{switch(e.type){case"option":return zt.createElement(HFe,{name:e.name,value:t,onChange:n,placeholder:"Select option"},e.options.map(r=>zt.createElement("option",{value:r},r)));case"boolean":return zt.createElement(ZFe,{name:e.name,rightIcon:zt.createElement(EK,null),onChange:n,isChecked:t===!0||t==="1",value:t?0:1});default:return zt.createElement(X_,{w:"100%",h:"10"},zt.createElement(kG,{name:e.name,type:"text",placeholder:"",value:t,onInput:n}))}};var CK={exports:{}};(function(e,t){(function(n){e.exports=n()})(function(){return function n(r,i,a){function o(l,c){if(!i[l]){if(!r[l]){var f=typeof ff=="function"&&ff;if(!c&&f)return f(l,!0);if(s)return s(l,!0);throw new Error("Cannot find module '"+l+"'")}var d=i[l]={exports:{}};r[l][0].call(d.exports,function(h){var p=r[l][1][h];return o(p||h)},d,d.exports,n,r,i,a)}return i[l].exports}for(var s=typeof ff=="function"&&ff,u=0;u<a.length;u++)o(a[u]);return o}({1:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var p=n("crypto");function g(S,C){return function(_,E){var A;if(A=E.algorithm!=="passthrough"?p.createHash(E.algorithm):new w,A.write===void 0&&(A.write=A.update,A.end=A.update),x(E,A).dispatch(_),A.update||A.end(""),A.digest)return A.digest(E.encoding==="buffer"?void 0:E.encoding);var k=A.read();return E.encoding!=="buffer"?k.toString(E.encoding):k}(S,C=y(S,C))}(i=r.exports=g).sha1=function(S){return g(S)},i.keys=function(S){return g(S,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},i.MD5=function(S){return g(S,{algorithm:"md5",encoding:"hex"})},i.keysMD5=function(S){return g(S,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var m=p.getHashes?p.getHashes().slice():["sha1","md5"];m.push("passthrough");var v=["buffer","hex","binary","base64"];function y(S,C){C=C||{};var _={};if(_.algorithm=C.algorithm||"sha1",_.encoding=C.encoding||"hex",_.excludeValues=!!C.excludeValues,_.algorithm=_.algorithm.toLowerCase(),_.encoding=_.encoding.toLowerCase(),_.ignoreUnknown=C.ignoreUnknown===!0,_.respectType=C.respectType!==!1,_.respectFunctionNames=C.respectFunctionNames!==!1,_.respectFunctionProperties=C.respectFunctionProperties!==!1,_.unorderedArrays=C.unorderedArrays===!0,_.unorderedSets=C.unorderedSets!==!1,_.unorderedObjects=C.unorderedObjects!==!1,_.replacer=C.replacer||void 0,_.excludeKeys=C.excludeKeys||void 0,S===void 0)throw new Error("Object argument required.");for(var E=0;E<m.length;++E)m[E].toLowerCase()===_.algorithm.toLowerCase()&&(_.algorithm=m[E]);if(m.indexOf(_.algorithm)===-1)throw new Error('Algorithm "'+_.algorithm+'"  not supported. supported values: '+m.join(", "));if(v.indexOf(_.encoding)===-1&&_.algorithm!=="passthrough")throw new Error('Encoding "'+_.encoding+'"  not supported. supported values: '+v.join(", "));return _}function b(S){if(typeof S=="function")return/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(S))!=null}function x(S,C,_){_=_||[];function E(A){return C.update?C.update(A,"utf8"):C.write(A,"utf8")}return{dispatch:function(A){return S.replacer&&(A=S.replacer(A)),this["_"+(A===null?"null":typeof A)](A)},_object:function(A){var k=Object.prototype.toString.call(A),T=/\[object (.*)\]/i.exec(k);T=(T=T?T[1]:"unknown:["+k+"]").toLowerCase();var I;if(0<=(I=_.indexOf(A)))return this.dispatch("[CIRCULAR:"+I+"]");if(_.push(A),s!==void 0&&s.isBuffer&&s.isBuffer(A))return E("buffer:"),E(A);if(T==="object"||T==="function"||T==="asyncfunction"){var N=Object.keys(A);S.unorderedObjects&&(N=N.sort()),S.respectType===!1||b(A)||N.splice(0,0,"prototype","__proto__","constructor"),S.excludeKeys&&(N=N.filter(function(D){return!S.excludeKeys(D)})),E("object:"+N.length+":");var O=this;return N.forEach(function(D){O.dispatch(D),E(":"),S.excludeValues||O.dispatch(A[D]),E(",")})}if(!this["_"+T]){if(S.ignoreUnknown)return E("["+T+"]");throw new Error('Unknown object type "'+T+'"')}this["_"+T](A)},_array:function(A,k){k=k!==void 0?k:S.unorderedArrays!==!1;var T=this;if(E("array:"+A.length+":"),!k||A.length<=1)return A.forEach(function(O){return T.dispatch(O)});var I=[],N=A.map(function(O){var D=new w,L=_.slice();return x(S,D,L).dispatch(O),I=I.concat(L.slice(_.length)),D.read().toString()});return _=_.concat(I),N.sort(),this._array(N,!1)},_date:function(A){return E("date:"+A.toJSON())},_symbol:function(A){return E("symbol:"+A.toString())},_error:function(A){return E("error:"+A.toString())},_boolean:function(A){return E("bool:"+A.toString())},_string:function(A){E("string:"+A.length+":"),E(A.toString())},_function:function(A){E("fn:"),b(A)?this.dispatch("[native]"):this.dispatch(A.toString()),S.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(A.name)),S.respectFunctionProperties&&this._object(A)},_number:function(A){return E("number:"+A.toString())},_xml:function(A){return E("xml:"+A.toString())},_null:function(){return E("Null")},_undefined:function(){return E("Undefined")},_regexp:function(A){return E("regex:"+A.toString())},_uint8array:function(A){return E("uint8array:"),this.dispatch(Array.prototype.slice.call(A))},_uint8clampedarray:function(A){return E("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(A))},_int8array:function(A){return E("uint8array:"),this.dispatch(Array.prototype.slice.call(A))},_uint16array:function(A){return E("uint16array:"),this.dispatch(Array.prototype.slice.call(A))},_int16array:function(A){return E("uint16array:"),this.dispatch(Array.prototype.slice.call(A))},_uint32array:function(A){return E("uint32array:"),this.dispatch(Array.prototype.slice.call(A))},_int32array:function(A){return E("uint32array:"),this.dispatch(Array.prototype.slice.call(A))},_float32array:function(A){return E("float32array:"),this.dispatch(Array.prototype.slice.call(A))},_float64array:function(A){return E("float64array:"),this.dispatch(Array.prototype.slice.call(A))},_arraybuffer:function(A){return E("arraybuffer:"),this.dispatch(new Uint8Array(A))},_url:function(A){return E("url:"+A.toString())},_map:function(A){E("map:");var k=Array.from(A);return this._array(k,S.unorderedSets!==!1)},_set:function(A){E("set:");var k=Array.from(A);return this._array(k,S.unorderedSets!==!1)},_file:function(A){return E("file:"),this.dispatch([A.name,A.size,A.type,A.lastModfied])},_blob:function(){if(S.ignoreUnknown)return E("[blob]");throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){return E("domwindow")},_bigint:function(A){return E("bigint:"+A.toString())},_process:function(){return E("process")},_timer:function(){return E("timer")},_pipe:function(){return E("pipe")},_tcp:function(){return E("tcp")},_udp:function(){return E("udp")},_tty:function(){return E("tty")},_statwatcher:function(){return E("statwatcher")},_securecontext:function(){return E("securecontext")},_connection:function(){return E("connection")},_zlib:function(){return E("zlib")},_context:function(){return E("context")},_nodescript:function(){return E("nodescript")},_httpparser:function(){return E("httpparser")},_dataview:function(){return E("dataview")},_signal:function(){return E("signal")},_fsevent:function(){return E("fsevent")},_tlswrap:function(){return E("tlswrap")}}}function w(){return{buf:"",write:function(S){this.buf+=S},end:function(S){this.buf+=S},read:function(){return this.buf}}}i.writeToStream=function(S,C,_){return _===void 0&&(_=C,C={}),x(C=y(S,C),_).dispatch(S)}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_7eac155c.js","/")},{buffer:3,crypto:5,lYpoI2:10}],2:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){(function(p){var g=typeof Uint8Array!="undefined"?Uint8Array:Array,m="+".charCodeAt(0),v="/".charCodeAt(0),y="0".charCodeAt(0),b="a".charCodeAt(0),x="A".charCodeAt(0),w="-".charCodeAt(0),S="_".charCodeAt(0);function C(_){var E=_.charCodeAt(0);return E===m||E===w?62:E===v||E===S?63:E<y?-1:E<y+10?E-y+26+26:E<x+26?E-x:E<b+26?E-b+26:void 0}p.toByteArray=function(_){var E,A;if(0<_.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var k=_.length,T=_.charAt(k-2)==="="?2:_.charAt(k-1)==="="?1:0,I=new g(3*_.length/4-T),N=0<T?_.length-4:_.length,O=0;function D(L){I[O++]=L}for(E=0;E<N;E+=4,0)D((16711680&(A=C(_.charAt(E))<<18|C(_.charAt(E+1))<<12|C(_.charAt(E+2))<<6|C(_.charAt(E+3))))>>16),D((65280&A)>>8),D(255&A);return T==2?D(255&(A=C(_.charAt(E))<<2|C(_.charAt(E+1))>>4)):T==1&&(D((A=C(_.charAt(E))<<10|C(_.charAt(E+1))<<4|C(_.charAt(E+2))>>2)>>8&255),D(255&A)),I},p.fromByteArray=function(_){var E,A,k,T,I=_.length%3,N="";function O(D){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(D)}for(E=0,k=_.length-I;E<k;E+=3)A=(_[E]<<16)+(_[E+1]<<8)+_[E+2],N+=O((T=A)>>18&63)+O(T>>12&63)+O(T>>6&63)+O(63&T);switch(I){case 1:N+=O((A=_[_.length-1])>>2),N+=O(A<<4&63),N+="==";break;case 2:N+=O((A=(_[_.length-2]<<8)+_[_.length-1])>>10),N+=O(A>>4&63),N+=O(A<<2&63),N+="="}return N}})(i===void 0?this.base64js={}:i)}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:10}],3:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var p=n("base64-js"),g=n("ieee754");function s(P,F,V){if(!(this instanceof s))return new s(P,F,V);var ae,Y,M,B,R,X=typeof P;if(F==="base64"&&X=="string")for(P=(ae=P).trim?ae.trim():ae.replace(/^\s+|\s+$/g,"");P.length%4!=0;)P+="=";if(X=="number")Y=L(P);else if(X=="string")Y=s.byteLength(P,F);else{if(X!="object")throw new Error("First argument needs to be a number, array or string.");Y=L(P.length)}if(s._useTypedArrays?M=s._augment(new Uint8Array(Y)):((M=this).length=Y,M._isBuffer=!0),s._useTypedArrays&&typeof P.byteLength=="number")M._set(P);else if(W(R=P)||s.isBuffer(R)||R&&typeof R=="object"&&typeof R.length=="number")for(B=0;B<Y;B++)s.isBuffer(P)?M[B]=P.readUInt8(B):M[B]=P[B];else if(X=="string")M.write(P,0,F);else if(X=="number"&&!s._useTypedArrays&&!V)for(B=0;B<Y;B++)M[B]=0;return M}function m(P,F,V,ae){return s._charsWritten=ce(function(Y){for(var M=[],B=0;B<Y.length;B++)M.push(255&Y.charCodeAt(B));return M}(F),P,V,ae)}function v(P,F,V,ae){return s._charsWritten=ce(function(Y){for(var M,B,R,X=[],ge=0;ge<Y.length;ge++)M=Y.charCodeAt(ge),B=M>>8,R=M%256,X.push(R),X.push(B);return X}(F),P,V,ae)}function y(P,F,V){var ae="";V=Math.min(P.length,V);for(var Y=F;Y<V;Y++)ae+=String.fromCharCode(P[Y]);return ae}function b(P,F,V,ae){ae||(me(typeof V=="boolean","missing or invalid endian"),me(F!=null,"missing offset"),me(F+1<P.length,"Trying to read beyond buffer length"));var Y,M=P.length;if(!(M<=F))return V?(Y=P[F],F+1<M&&(Y|=P[F+1]<<8)):(Y=P[F]<<8,F+1<M&&(Y|=P[F+1])),Y}function x(P,F,V,ae){ae||(me(typeof V=="boolean","missing or invalid endian"),me(F!=null,"missing offset"),me(F+3<P.length,"Trying to read beyond buffer length"));var Y,M=P.length;if(!(M<=F))return V?(F+2<M&&(Y=P[F+2]<<16),F+1<M&&(Y|=P[F+1]<<8),Y|=P[F],F+3<M&&(Y+=P[F+3]<<24>>>0)):(F+1<M&&(Y=P[F+1]<<16),F+2<M&&(Y|=P[F+2]<<8),F+3<M&&(Y|=P[F+3]),Y+=P[F]<<24>>>0),Y}function w(P,F,V,ae){if(ae||(me(typeof V=="boolean","missing or invalid endian"),me(F!=null,"missing offset"),me(F+1<P.length,"Trying to read beyond buffer length")),!(P.length<=F)){var Y=b(P,F,V,!0);return 32768&Y?-1*(65535-Y+1):Y}}function S(P,F,V,ae){if(ae||(me(typeof V=="boolean","missing or invalid endian"),me(F!=null,"missing offset"),me(F+3<P.length,"Trying to read beyond buffer length")),!(P.length<=F)){var Y=x(P,F,V,!0);return 2147483648&Y?-1*(4294967295-Y+1):Y}}function C(P,F,V,ae){return ae||(me(typeof V=="boolean","missing or invalid endian"),me(F+3<P.length,"Trying to read beyond buffer length")),g.read(P,F,V,23,4)}function _(P,F,V,ae){return ae||(me(typeof V=="boolean","missing or invalid endian"),me(F+7<P.length,"Trying to read beyond buffer length")),g.read(P,F,V,52,8)}function E(P,F,V,ae,Y){Y||(me(F!=null,"missing value"),me(typeof ae=="boolean","missing or invalid endian"),me(V!=null,"missing offset"),me(V+1<P.length,"trying to write beyond buffer length"),Oe(F,65535));var M=P.length;if(!(M<=V))for(var B=0,R=Math.min(M-V,2);B<R;B++)P[V+B]=(F&255<<8*(ae?B:1-B))>>>8*(ae?B:1-B)}function A(P,F,V,ae,Y){Y||(me(F!=null,"missing value"),me(typeof ae=="boolean","missing or invalid endian"),me(V!=null,"missing offset"),me(V+3<P.length,"trying to write beyond buffer length"),Oe(F,4294967295));var M=P.length;if(!(M<=V))for(var B=0,R=Math.min(M-V,4);B<R;B++)P[V+B]=F>>>8*(ae?B:3-B)&255}function k(P,F,V,ae,Y){Y||(me(F!=null,"missing value"),me(typeof ae=="boolean","missing or invalid endian"),me(V!=null,"missing offset"),me(V+1<P.length,"Trying to write beyond buffer length"),Te(F,32767,-32768)),P.length<=V||E(P,0<=F?F:65535+F+1,V,ae,Y)}function T(P,F,V,ae,Y){Y||(me(F!=null,"missing value"),me(typeof ae=="boolean","missing or invalid endian"),me(V!=null,"missing offset"),me(V+3<P.length,"Trying to write beyond buffer length"),Te(F,2147483647,-2147483648)),P.length<=V||A(P,0<=F?F:4294967295+F+1,V,ae,Y)}function I(P,F,V,ae,Y){Y||(me(F!=null,"missing value"),me(typeof ae=="boolean","missing or invalid endian"),me(V!=null,"missing offset"),me(V+3<P.length,"Trying to write beyond buffer length"),De(F,34028234663852886e22,-34028234663852886e22)),P.length<=V||g.write(P,F,V,ae,23,4)}function N(P,F,V,ae,Y){Y||(me(F!=null,"missing value"),me(typeof ae=="boolean","missing or invalid endian"),me(V!=null,"missing offset"),me(V+7<P.length,"Trying to write beyond buffer length"),De(F,17976931348623157e292,-17976931348623157e292)),P.length<=V||g.write(P,F,V,ae,52,8)}i.Buffer=s,i.SlowBuffer=s,i.INSPECT_MAX_BYTES=50,s.poolSize=8192,s._useTypedArrays=function(){try{var P=new ArrayBuffer(0),F=new Uint8Array(P);return F.foo=function(){return 42},F.foo()===42&&typeof F.subarray=="function"}catch(V){return!1}}(),s.isEncoding=function(P){switch(String(P).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.isBuffer=function(P){return!(P==null||!P._isBuffer)},s.byteLength=function(P,F){var V;switch(P+="",F||"utf8"){case"hex":V=P.length/2;break;case"utf8":case"utf-8":V=K(P).length;break;case"ascii":case"binary":case"raw":V=P.length;break;case"base64":V=ee(P).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":V=2*P.length;break;default:throw new Error("Unknown encoding")}return V},s.concat=function(P,F){if(me(W(P),`Usage: Buffer.concat(list, [totalLength])
list should be an Array.`),P.length===0)return new s(0);if(P.length===1)return P[0];if(typeof F!="number")for(Y=F=0;Y<P.length;Y++)F+=P[Y].length;for(var V=new s(F),ae=0,Y=0;Y<P.length;Y++){var M=P[Y];M.copy(V,ae),ae+=M.length}return V},s.prototype.write=function(P,F,V,ae){var Y;isFinite(F)?isFinite(V)||(ae=V,V=void 0):(Y=ae,ae=F,F=V,V=Y),F=Number(F)||0;var M,B,R,X,ge,xe,ze,Ke,Ze,Bt=this.length-F;switch((!V||Bt<(V=Number(V)))&&(V=Bt),ae=String(ae||"utf8").toLowerCase()){case"hex":M=function(Je,Zt,mn,Hn){mn=Number(mn)||0;var ti=Je.length-mn;(!Hn||ti<(Hn=Number(Hn)))&&(Hn=ti);var er=Zt.length;me(er%2==0,"Invalid hex string"),er/2<Hn&&(Hn=er/2);for(var Dn=0;Dn<Hn;Dn++){var Jo=parseInt(Zt.substr(2*Dn,2),16);me(!isNaN(Jo),"Invalid hex string"),Je[mn+Dn]=Jo}return s._charsWritten=2*Dn,Dn}(this,P,F,V);break;case"utf8":case"utf-8":xe=this,ze=P,Ke=F,Ze=V,M=s._charsWritten=ce(K(ze),xe,Ke,Ze);break;case"ascii":case"binary":M=m(this,P,F,V);break;case"base64":B=this,R=P,X=F,ge=V,M=s._charsWritten=ce(ee(R),B,X,ge);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":M=v(this,P,F,V);break;default:throw new Error("Unknown encoding")}return M},s.prototype.toString=function(P,F,V){var ae,Y,M,B,R=this;if(P=String(P||"utf8").toLowerCase(),F=Number(F)||0,(V=V!==void 0?Number(V):V=R.length)===F)return"";switch(P){case"hex":ae=function(X,ge,xe){var ze=X.length;(!ge||ge<0)&&(ge=0),(!xe||xe<0||ze<xe)&&(xe=ze);for(var Ke="",Ze=ge;Ze<xe;Ze++)Ke+=G(X[Ze]);return Ke}(R,F,V);break;case"utf8":case"utf-8":ae=function(X,ge,xe){var ze="",Ke="";xe=Math.min(X.length,xe);for(var Ze=ge;Ze<xe;Ze++)X[Ze]<=127?(ze+=he(Ke)+String.fromCharCode(X[Ze]),Ke=""):Ke+="%"+X[Ze].toString(16);return ze+he(Ke)}(R,F,V);break;case"ascii":case"binary":ae=y(R,F,V);break;case"base64":Y=R,B=V,ae=(M=F)===0&&B===Y.length?p.fromByteArray(Y):p.fromByteArray(Y.slice(M,B));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":ae=function(X,ge,xe){for(var ze=X.slice(ge,xe),Ke="",Ze=0;Ze<ze.length;Ze+=2)Ke+=String.fromCharCode(ze[Ze]+256*ze[Ze+1]);return Ke}(R,F,V);break;default:throw new Error("Unknown encoding")}return ae},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},s.prototype.copy=function(P,F,V,ae){if(V=V||0,ae||ae===0||(ae=this.length),F=F||0,ae!==V&&P.length!==0&&this.length!==0){me(V<=ae,"sourceEnd < sourceStart"),me(0<=F&&F<P.length,"targetStart out of bounds"),me(0<=V&&V<this.length,"sourceStart out of bounds"),me(0<=ae&&ae<=this.length,"sourceEnd out of bounds"),ae>this.length&&(ae=this.length),P.length-F<ae-V&&(ae=P.length-F+V);var Y=ae-V;if(Y<100||!s._useTypedArrays)for(var M=0;M<Y;M++)P[M+F]=this[M+V];else P._set(this.subarray(V,V+Y),F)}},s.prototype.slice=function(P,F){var V=this.length;if(P=D(P,V,0),F=D(F,V,V),s._useTypedArrays)return s._augment(this.subarray(P,F));for(var ae=F-P,Y=new s(ae,void 0,!0),M=0;M<ae;M++)Y[M]=this[M+P];return Y},s.prototype.get=function(P){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(P)},s.prototype.set=function(P,F){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(P,F)},s.prototype.readUInt8=function(P,F){if(F||(me(P!=null,"missing offset"),me(P<this.length,"Trying to read beyond buffer length")),!(P>=this.length))return this[P]},s.prototype.readUInt16LE=function(P,F){return b(this,P,!0,F)},s.prototype.readUInt16BE=function(P,F){return b(this,P,!1,F)},s.prototype.readUInt32LE=function(P,F){return x(this,P,!0,F)},s.prototype.readUInt32BE=function(P,F){return x(this,P,!1,F)},s.prototype.readInt8=function(P,F){if(F||(me(P!=null,"missing offset"),me(P<this.length,"Trying to read beyond buffer length")),!(P>=this.length))return 128&this[P]?-1*(255-this[P]+1):this[P]},s.prototype.readInt16LE=function(P,F){return w(this,P,!0,F)},s.prototype.readInt16BE=function(P,F){return w(this,P,!1,F)},s.prototype.readInt32LE=function(P,F){return S(this,P,!0,F)},s.prototype.readInt32BE=function(P,F){return S(this,P,!1,F)},s.prototype.readFloatLE=function(P,F){return C(this,P,!0,F)},s.prototype.readFloatBE=function(P,F){return C(this,P,!1,F)},s.prototype.readDoubleLE=function(P,F){return _(this,P,!0,F)},s.prototype.readDoubleBE=function(P,F){return _(this,P,!1,F)},s.prototype.writeUInt8=function(P,F,V){V||(me(P!=null,"missing value"),me(F!=null,"missing offset"),me(F<this.length,"trying to write beyond buffer length"),Oe(P,255)),F>=this.length||(this[F]=P)},s.prototype.writeUInt16LE=function(P,F,V){E(this,P,F,!0,V)},s.prototype.writeUInt16BE=function(P,F,V){E(this,P,F,!1,V)},s.prototype.writeUInt32LE=function(P,F,V){A(this,P,F,!0,V)},s.prototype.writeUInt32BE=function(P,F,V){A(this,P,F,!1,V)},s.prototype.writeInt8=function(P,F,V){V||(me(P!=null,"missing value"),me(F!=null,"missing offset"),me(F<this.length,"Trying to write beyond buffer length"),Te(P,127,-128)),F>=this.length||(0<=P?this.writeUInt8(P,F,V):this.writeUInt8(255+P+1,F,V))},s.prototype.writeInt16LE=function(P,F,V){k(this,P,F,!0,V)},s.prototype.writeInt16BE=function(P,F,V){k(this,P,F,!1,V)},s.prototype.writeInt32LE=function(P,F,V){T(this,P,F,!0,V)},s.prototype.writeInt32BE=function(P,F,V){T(this,P,F,!1,V)},s.prototype.writeFloatLE=function(P,F,V){I(this,P,F,!0,V)},s.prototype.writeFloatBE=function(P,F,V){I(this,P,F,!1,V)},s.prototype.writeDoubleLE=function(P,F,V){N(this,P,F,!0,V)},s.prototype.writeDoubleBE=function(P,F,V){N(this,P,F,!1,V)},s.prototype.fill=function(P,F,V){if(P=P||0,F=F||0,V=V||this.length,typeof P=="string"&&(P=P.charCodeAt(0)),me(typeof P=="number"&&!isNaN(P),"value is not a number"),me(F<=V,"end < start"),V!==F&&this.length!==0){me(0<=F&&F<this.length,"start out of bounds"),me(0<=V&&V<=this.length,"end out of bounds");for(var ae=F;ae<V;ae++)this[ae]=P}},s.prototype.inspect=function(){for(var P=[],F=this.length,V=0;V<F;V++)if(P[V]=G(this[V]),V===i.INSPECT_MAX_BYTES){P[V+1]="...";break}return"<Buffer "+P.join(" ")+">"},s.prototype.toArrayBuffer=function(){if(typeof Uint8Array=="undefined")throw new Error("Buffer.toArrayBuffer not supported in this browser");if(s._useTypedArrays)return new s(this).buffer;for(var P=new Uint8Array(this.length),F=0,V=P.length;F<V;F+=1)P[F]=this[F];return P.buffer};var O=s.prototype;function D(P,F,V){return typeof P!="number"?V:F<=(P=~~P)?F:0<=P||0<=(P+=F)?P:0}function L(P){return(P=~~Math.ceil(+P))<0?0:P}function W(P){return(Array.isArray||function(F){return Object.prototype.toString.call(F)==="[object Array]"})(P)}function G(P){return P<16?"0"+P.toString(16):P.toString(16)}function K(P){for(var F=[],V=0;V<P.length;V++){var ae=P.charCodeAt(V);if(ae<=127)F.push(P.charCodeAt(V));else{var Y=V;55296<=ae&&ae<=57343&&V++;for(var M=encodeURIComponent(P.slice(Y,V+1)).substr(1).split("%"),B=0;B<M.length;B++)F.push(parseInt(M[B],16))}}return F}function ee(P){return p.toByteArray(P)}function ce(P,F,V,ae){for(var Y=0;Y<ae&&!(Y+V>=F.length||Y>=P.length);Y++)F[Y+V]=P[Y];return Y}function he(P){try{return decodeURIComponent(P)}catch(F){return String.fromCharCode(65533)}}function Oe(P,F){me(typeof P=="number","cannot write a non-number as a number"),me(0<=P,"specified a negative value for writing an unsigned value"),me(P<=F,"value is larger than maximum value for type"),me(Math.floor(P)===P,"value has a fractional component")}function Te(P,F,V){me(typeof P=="number","cannot write a non-number as a number"),me(P<=F,"value larger than maximum allowed value"),me(V<=P,"value smaller than minimum allowed value"),me(Math.floor(P)===P,"value has a fractional component")}function De(P,F,V){me(typeof P=="number","cannot write a non-number as a number"),me(P<=F,"value larger than maximum allowed value"),me(V<=P,"value smaller than minimum allowed value")}function me(P,F){if(!P)throw new Error(F||"Failed assertion")}s._augment=function(P){return P._isBuffer=!0,P._get=P.get,P._set=P.set,P.get=O.get,P.set=O.set,P.write=O.write,P.toString=O.toString,P.toLocaleString=O.toString,P.toJSON=O.toJSON,P.copy=O.copy,P.slice=O.slice,P.readUInt8=O.readUInt8,P.readUInt16LE=O.readUInt16LE,P.readUInt16BE=O.readUInt16BE,P.readUInt32LE=O.readUInt32LE,P.readUInt32BE=O.readUInt32BE,P.readInt8=O.readInt8,P.readInt16LE=O.readInt16LE,P.readInt16BE=O.readInt16BE,P.readInt32LE=O.readInt32LE,P.readInt32BE=O.readInt32BE,P.readFloatLE=O.readFloatLE,P.readFloatBE=O.readFloatBE,P.readDoubleLE=O.readDoubleLE,P.readDoubleBE=O.readDoubleBE,P.writeUInt8=O.writeUInt8,P.writeUInt16LE=O.writeUInt16LE,P.writeUInt16BE=O.writeUInt16BE,P.writeUInt32LE=O.writeUInt32LE,P.writeUInt32BE=O.writeUInt32BE,P.writeInt8=O.writeInt8,P.writeInt16LE=O.writeInt16LE,P.writeInt16BE=O.writeInt16BE,P.writeInt32LE=O.writeInt32LE,P.writeInt32BE=O.writeInt32BE,P.writeFloatLE=O.writeFloatLE,P.writeFloatBE=O.writeFloatBE,P.writeDoubleLE=O.writeDoubleLE,P.writeDoubleBE=O.writeDoubleBE,P.fill=O.fill,P.inspect=O.inspect,P.toArrayBuffer=O.toArrayBuffer,P}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:11,lYpoI2:10}],4:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var s=n("buffer").Buffer,p=4,g=new s(p);g.fill(0),r.exports={hash:function(m,v,y,b){return s.isBuffer(m)||(m=new s(m)),function(x,w,S){for(var C=new s(w),_=S?C.writeInt32BE:C.writeInt32LE,E=0;E<x.length;E++)_.call(C,x[E],4*E,!0);return C}(v(function(x,w){var S;x.length%p!=0&&(S=x.length+(p-x.length%p),x=s.concat([x,g],S));for(var C=[],_=w?x.readInt32BE:x.readInt32LE,E=0;E<x.length;E+=p)C.push(_.call(x,E));return C}(m,b),8*m.length),y,b)}}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:10}],5:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var s=n("buffer").Buffer,p=n("./sha"),g=n("./sha256"),m=n("./rng"),v={sha1:p,sha256:g,md5:n("./md5")},y=64,b=new s(y);function x(S,C){var _=v[S=S||"sha1"],E=[];return _||w("algorithm:",S,"is not yet supported"),{update:function(A){return s.isBuffer(A)||(A=new s(A)),E.push(A),A.length,this},digest:function(A){var k=s.concat(E),T=C?function(I,N,O){s.isBuffer(N)||(N=new s(N)),s.isBuffer(O)||(O=new s(O)),N.length>y?N=I(N):N.length<y&&(N=s.concat([N,b],y));for(var D=new s(y),L=new s(y),W=0;W<y;W++)D[W]=54^N[W],L[W]=92^N[W];var G=I(s.concat([D,O]));return I(s.concat([L,G]))}(_,C,k):_(k);return E=null,A?T.toString(A):T}}}function w(){var S=[].slice.call(arguments).join(" ");throw new Error([S,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join(`
`))}b.fill(0),i.createHash=function(S){return x(S)},i.createHmac=x,i.randomBytes=function(S,C){if(!C||!C.call)return new s(m(S));try{C.call(this,void 0,new s(m(S)))}catch(_){C(_)}},function(S,C){for(var _ in S)C(S[_],_)}(["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],function(S){i[S]=function(){w("sorry,",S,"is not implemented yet")}})}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:10}],6:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var p=n("./helpers");function g(S,C){S[C>>5]|=128<<C%32,S[14+(C+64>>>9<<4)]=C;for(var _=1732584193,E=-271733879,A=-1732584194,k=271733878,T=0;T<S.length;T+=16){var I=_,N=E,O=A,D=k,_=v(_,E,A,k,S[T+0],7,-680876936),k=v(k,_,E,A,S[T+1],12,-389564586),A=v(A,k,_,E,S[T+2],17,606105819),E=v(E,A,k,_,S[T+3],22,-1044525330);_=v(_,E,A,k,S[T+4],7,-176418897),k=v(k,_,E,A,S[T+5],12,1200080426),A=v(A,k,_,E,S[T+6],17,-1473231341),E=v(E,A,k,_,S[T+7],22,-45705983),_=v(_,E,A,k,S[T+8],7,1770035416),k=v(k,_,E,A,S[T+9],12,-1958414417),A=v(A,k,_,E,S[T+10],17,-42063),E=v(E,A,k,_,S[T+11],22,-1990404162),_=v(_,E,A,k,S[T+12],7,1804603682),k=v(k,_,E,A,S[T+13],12,-40341101),A=v(A,k,_,E,S[T+14],17,-1502002290),_=y(_,E=v(E,A,k,_,S[T+15],22,1236535329),A,k,S[T+1],5,-165796510),k=y(k,_,E,A,S[T+6],9,-1069501632),A=y(A,k,_,E,S[T+11],14,643717713),E=y(E,A,k,_,S[T+0],20,-373897302),_=y(_,E,A,k,S[T+5],5,-701558691),k=y(k,_,E,A,S[T+10],9,38016083),A=y(A,k,_,E,S[T+15],14,-660478335),E=y(E,A,k,_,S[T+4],20,-405537848),_=y(_,E,A,k,S[T+9],5,568446438),k=y(k,_,E,A,S[T+14],9,-1019803690),A=y(A,k,_,E,S[T+3],14,-187363961),E=y(E,A,k,_,S[T+8],20,1163531501),_=y(_,E,A,k,S[T+13],5,-1444681467),k=y(k,_,E,A,S[T+2],9,-51403784),A=y(A,k,_,E,S[T+7],14,1735328473),_=b(_,E=y(E,A,k,_,S[T+12],20,-1926607734),A,k,S[T+5],4,-378558),k=b(k,_,E,A,S[T+8],11,-2022574463),A=b(A,k,_,E,S[T+11],16,1839030562),E=b(E,A,k,_,S[T+14],23,-35309556),_=b(_,E,A,k,S[T+1],4,-1530992060),k=b(k,_,E,A,S[T+4],11,1272893353),A=b(A,k,_,E,S[T+7],16,-155497632),E=b(E,A,k,_,S[T+10],23,-1094730640),_=b(_,E,A,k,S[T+13],4,681279174),k=b(k,_,E,A,S[T+0],11,-358537222),A=b(A,k,_,E,S[T+3],16,-722521979),E=b(E,A,k,_,S[T+6],23,76029189),_=b(_,E,A,k,S[T+9],4,-640364487),k=b(k,_,E,A,S[T+12],11,-421815835),A=b(A,k,_,E,S[T+15],16,530742520),_=x(_,E=b(E,A,k,_,S[T+2],23,-995338651),A,k,S[T+0],6,-198630844),k=x(k,_,E,A,S[T+7],10,1126891415),A=x(A,k,_,E,S[T+14],15,-1416354905),E=x(E,A,k,_,S[T+5],21,-57434055),_=x(_,E,A,k,S[T+12],6,1700485571),k=x(k,_,E,A,S[T+3],10,-1894986606),A=x(A,k,_,E,S[T+10],15,-1051523),E=x(E,A,k,_,S[T+1],21,-2054922799),_=x(_,E,A,k,S[T+8],6,1873313359),k=x(k,_,E,A,S[T+15],10,-30611744),A=x(A,k,_,E,S[T+6],15,-1560198380),E=x(E,A,k,_,S[T+13],21,1309151649),_=x(_,E,A,k,S[T+4],6,-145523070),k=x(k,_,E,A,S[T+11],10,-1120210379),A=x(A,k,_,E,S[T+2],15,718787259),E=x(E,A,k,_,S[T+9],21,-343485551),_=w(_,I),E=w(E,N),A=w(A,O),k=w(k,D)}return Array(_,E,A,k)}function m(S,C,_,E,A,k){return w((T=w(w(C,S),w(E,k)))<<(I=A)|T>>>32-I,_);var T,I}function v(S,C,_,E,A,k,T){return m(C&_|~C&E,S,C,A,k,T)}function y(S,C,_,E,A,k,T){return m(C&E|_&~E,S,C,A,k,T)}function b(S,C,_,E,A,k,T){return m(C^_^E,S,C,A,k,T)}function x(S,C,_,E,A,k,T){return m(_^(C|~E),S,C,A,k,T)}function w(S,C){var _=(65535&S)+(65535&C);return(S>>16)+(C>>16)+(_>>16)<<16|65535&_}r.exports=function(S){return p.hash(S,g,16)}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],7:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var p;p=function(g){for(var m,v=new Array(g),y=0;y<g;y++)(3&y)==0&&(m=4294967296*Math.random()),v[y]=m>>>((3&y)<<3)&255;return v},r.exports=p}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:10}],8:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){var p=n("./helpers");function g(y,b){y[b>>5]|=128<<24-b%32,y[15+(b+64>>9<<4)]=b;for(var x,w,S,C,_,E=Array(80),A=1732584193,k=-271733879,T=-1732584194,I=271733878,N=-1009589776,O=0;O<y.length;O+=16){for(var D=A,L=k,W=T,G=I,K=N,ee=0;ee<80;ee++){E[ee]=ee<16?y[O+ee]:v(E[ee-3]^E[ee-8]^E[ee-14]^E[ee-16],1);var ce=m(m(v(A,5),(S=k,C=T,_=I,(w=ee)<20?S&C|~S&_:!(w<40)&&w<60?S&C|S&_|C&_:S^C^_)),m(m(N,E[ee]),(x=ee)<20?1518500249:x<40?1859775393:x<60?-1894007588:-899497514)),N=I,I=T,T=v(k,30),k=A,A=ce}A=m(A,D),k=m(k,L),T=m(T,W),I=m(I,G),N=m(N,K)}return Array(A,k,T,I,N)}function m(y,b){var x=(65535&y)+(65535&b);return(y>>16)+(b>>16)+(x>>16)<<16|65535&x}function v(y,b){return y<<b|y>>>32-b}r.exports=function(y){return p.hash(y,g,20,!0)}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],9:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){function p(y,b){var x=(65535&y)+(65535&b);return(y>>16)+(b>>16)+(x>>16)<<16|65535&x}function g(y,b){return y>>>b|y<<32-b}function m(y,b){var x,w,S,C,_,E,A,k,T,I,N=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),O=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),D=new Array(64);y[b>>5]|=128<<24-b%32,y[15+(b+64>>9<<4)]=b;for(var L,W,G,K,ee,ce,he,Oe,Te=0;Te<y.length;Te+=16){x=O[0],w=O[1],S=O[2],C=O[3],_=O[4],E=O[5],A=O[6],k=O[7];for(var De=0;De<64;De++)D[De]=De<16?y[De+Te]:p(p(p((Oe=D[De-2],g(Oe,17)^g(Oe,19)^Oe>>>10),D[De-7]),(he=D[De-15],g(he,7)^g(he,18)^he>>>3)),D[De-16]),T=p(p(p(p(k,g(ce=_,6)^g(ce,11)^g(ce,25)),(ee=_)&E^~ee&A),N[De]),D[De]),I=p(g(K=x,2)^g(K,13)^g(K,22),(L=x)&(W=w)^L&(G=S)^W&G),k=A,A=E,E=_,_=p(C,T),C=S,S=w,w=x,x=p(T,I);O[0]=p(x,O[0]),O[1]=p(w,O[1]),O[2]=p(S,O[2]),O[3]=p(C,O[3]),O[4]=p(_,O[4]),O[5]=p(E,O[5]),O[6]=p(A,O[6]),O[7]=p(k,O[7])}return O}var v=n("./helpers");r.exports=function(y){return v.hash(y,m,32,!0)}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:10}],10:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){function p(){}(a=r.exports={}).nextTick=function(){var g=typeof window!="undefined"&&window.setImmediate,m=typeof window!="undefined"&&window.postMessage&&window.addEventListener;if(g)return function(y){return window.setImmediate(y)};if(m){var v=[];return window.addEventListener("message",function(y){var b=y.source;b!==window&&b!==null||y.data!=="process-tick"||(y.stopPropagation(),0<v.length&&v.shift()())},!0),function(y){v.push(y),window.postMessage("process-tick","*")}}return function(y){setTimeout(y,0)}}(),a.title="browser",a.browser=!0,a.env={},a.argv=[],a.on=p,a.addListener=p,a.once=p,a.off=p,a.removeListener=p,a.removeAllListeners=p,a.emit=p,a.binding=function(g){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(g){throw new Error("process.chdir is not supported")}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:10}],11:[function(n,r,i){(function(a,o,s,u,l,c,f,d,h){i.read=function(p,g,m,v,y){var b,x,w=8*y-v-1,S=(1<<w)-1,C=S>>1,_=-7,E=m?y-1:0,A=m?-1:1,k=p[g+E];for(E+=A,b=k&(1<<-_)-1,k>>=-_,_+=w;0<_;b=256*b+p[g+E],E+=A,_-=8);for(x=b&(1<<-_)-1,b>>=-_,_+=v;0<_;x=256*x+p[g+E],E+=A,_-=8);if(b===0)b=1-C;else{if(b===S)return x?NaN:1/0*(k?-1:1);x+=Math.pow(2,v),b-=C}return(k?-1:1)*x*Math.pow(2,b-v)},i.write=function(p,g,m,v,y,b){var x,w,S,C=8*b-y-1,_=(1<<C)-1,E=_>>1,A=y===23?Math.pow(2,-24)-Math.pow(2,-77):0,k=v?0:b-1,T=v?1:-1,I=g<0||g===0&&1/g<0?1:0;for(g=Math.abs(g),isNaN(g)||g===1/0?(w=isNaN(g)?1:0,x=_):(x=Math.floor(Math.log(g)/Math.LN2),g*(S=Math.pow(2,-x))<1&&(x--,S*=2),2<=(g+=1<=x+E?A/S:A*Math.pow(2,1-E))*S&&(x++,S/=2),_<=x+E?(w=0,x=_):1<=x+E?(w=(g*S-1)*Math.pow(2,y),x+=E):(w=g*Math.pow(2,E-1)*Math.pow(2,y),x=0));8<=y;p[m+k]=255&w,k+=T,w/=256,y-=8);for(x=x<<y|w,C+=y;0<C;p[m+k]=255&x,k+=T,x/=256,C-=8);p[m+k-T]|=128*I}}).call(this,n("lYpoI2"),typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/ieee754/index.js","/node_modules/ieee754")},{buffer:3,lYpoI2:10}]},{},[1])(1)})})(CK);var x3e=CK.exports;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var AK=function(e,t){return(AK=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])})(e,t)};function Bs(e,t){function n(){this.constructor=e}AK(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function tt(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})}function nt(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(u){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){o=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(c[0]===6&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(f){c=[6,f],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}var kK=function(){function e(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return e.prototype.setPlatform=function(t,n){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+n+"."),this.platformName=t,this.platform=n},e.prototype.registerFlag=function(t,n,r){if(this.flagRegistry[t]={evaluationFn:n,setHook:r},this.urlFlags[t]!=null){var i=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+i+"."),this.set(t,i)}},e.prototype.get=function(t){return t in this.flags?this.flags[t]:(this.flags[t]=this.evaluateFlag(t),this.flags[t])},e.prototype.getNumber=function(t){return this.get(t)},e.prototype.getBool=function(t){return this.get(t)},e.prototype.getFlags=function(){return this.flags},Object.defineProperty(e.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),e.prototype.set=function(t,n){if(this.flagRegistry[t]==null)throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=n,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(n)},e.prototype.evaluateFlag=function(t){if(this.flagRegistry[t]==null)throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},e.prototype.setFlags=function(t){this.flags=Object.assign({},t)},e.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},e.prototype.populateURLFlags=function(){var t=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var n,r,i=(n=this.global.location.search,r={},n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(a){for(var o=[],s=1;s<arguments.length;s++)o[s-1]=arguments[s];return w3e(r,o[0],o[1]),o.join("=")}),r);"tfjsflags"in i&&i.tfjsflags.split(",").forEach(function(a){var o=a.split(":"),s=o[0],u=o[1];t.urlFlags[s]=function(l,c){if((c=c.toLowerCase())==="true"||c==="false")return c==="true";if(""+ +c===c)return+c;throw new Error("Could not parse value flag value "+c+" for flag "+l+".")}(s,u)})}},e}();function w3e(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function pe(){return CF}var CF=null,xm=new Map,Wy=new Map;function AF(e,t){var n=IF(e,t);return xm.get(n)}function kF(e){return Wy.get(e)}function TF(e){for(var t=xm.entries(),n=[];;){var r=t.next(),i=r.done,a=r.value;if(i)break;var o=a[0],s=a[1];o.split("_")[0]===e&&n.push(s)}return n}function OF(e){var t=e.kernelName,n=e.backendName,r=IF(t,n);if(xm.has(r))throw new Error("The kernel '"+t+"' for backend '"+n+"' is already registered");xm.set(r,e)}function TK(e){var t=e.kernelName;Wy.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),Wy.set(t,e)}function _3e(e,t){var n=IF(e,t);if(!xm.has(n))throw new Error("The kernel '"+e+"' for backend '"+t+"' is not registered");xm.delete(n)}function S3e(e){if(!Wy.has(e))throw new Error("The gradient '"+e+"' for backend is not registered");Wy.delete(e)}function IF(e,t){return t+"_"+e}function OK(e){for(var t=e.length,n=0,r=0;t>0;)r=Math.random()*t|0,n=e[--t],e[t]=e[r],e[r]=n}function dS(e,t,n){return Math.max(e,Math.min(t,n))}function NF(e){return e%2==0?e:e+1}function IK(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function U(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}function ln(e,t,n){n===void 0&&(n=""),U(Ur(e,t),function(){return n+" Shapes "+e+" and "+t+" must match"})}function Th(e){U(e!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function tc(e,t,n){if(t===void 0&&(t=[]),n===void 0&&(n=!1),t==null&&(t=[]),Array.isArray(e)||Ni(e)&&!n)for(var r=0;r<e.length;++r)tc(e[r],t,n);else t.push(e);return t}function et(e){if(e.length===0)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function Ur(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function gr(e){return e%1==0}function NK(e){if(Math.tanh!=null)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function hS(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function Oh(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function DF(e,t,n){return t===void 0&&(t=function(r){return 0}),new Promise(function(r,i){var a=0,o=function(){if(e())r();else{a++;var s=t(a);n!=null&&a>=n?i():setTimeout(o,s)}};o()})}function DK(e,t){for(var n=1,r=-1,i=0;i<e.length;++i)if(e[i]>=0)n*=e[i];else if(e[i]===-1){if(r!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+i);r=i}else if(e[i]<0)throw Error("Shapes can not be < 0. Found "+e[i]+" at dim "+i);if(r===-1){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(n===0)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+n);var a=e.slice();return a[r]=t/n,a}function Wr(e,t){var n=t.length;return U((e=e==null?t.map(function(r,i){return i}):[].concat(e)).every(function(r){return r>=-n&&r<n}),function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+e}),U(e.every(function(r){return gr(r)}),function(){return"All values in axis param must be integers but got axis "+e}),e.map(function(r){return r<0?n+r:r})}function Af(e,t){for(var n=[],r=[],i=t!=null&&Array.isArray(t)&&t.length===0,a=t==null||i?null:Wr(t,e).sort(),o=0,s=0;s<e.length;++s){if(a!=null){if(a[o]===s&&e[s]!==1)throw new Error("Can't squeeze axis "+s+" since its dim '"+e[s]+"' is not 1");(a[o]==null||a[o]>s)&&e[s]===1&&(n.push(e[s]),r.push(s)),a[o]<=s&&o++}e[s]!==1&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function Ih(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else{if(e!=="bool")throw new Error("Unknown data type "+e);n=new Uint8Array(t)}return n}function Vy(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else{if(e!=="string")throw new Error("Unknown data type "+e);n=new Array(t)}return n}function RK(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+t+" being uploaded contains "+r+".")}}function FK(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}function MK(e,t){return t!=="complex64"&&(t!=="float32"||e==="complex64")&&(t!=="int32"||e==="float32"||e==="complex64")&&(t!=="bool"||e!=="bool")}function Ni(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function RF(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error("Unknown dtype "+e)}function PK(e){if(e==null)return 0;var t=0;return e.forEach(function(n){return t+=n.length}),t}function kf(e){return typeof e=="string"||e instanceof String}function $K(e){return typeof e=="boolean"}function LK(e){return typeof e=="number"}function wm(e){return Array.isArray(e)?wm(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":LK(e)?"float32":kf(e)?"string":$K(e)?"bool":"float32"}function Tf(e){return!!(e&&e.constructor&&e.call&&e.apply)}function pS(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}function Ja(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function FF(e,t,n){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=tc(e)),n&&RK(e,t),function(a,o){return a instanceof Float32Array&&o==="float32"||a instanceof Int32Array&&o==="int32"||a instanceof Uint8Array&&o==="bool"}(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){for(var r=new Uint8Array(e.length),i=0;i<r.length;++i)Math.round(e[i])!==0&&(r[i]=1);return r}throw new Error("Unknown data type "+t)}function MF(e,t){if(e.length===0)return t[0];var n=e.reduce(function(r,i){return r*i});if(n===0)return[];if(n!==t.length)throw new Error("["+e+"] does not match the input size.");return function r(i,a,o){var s=new Array;if(a.length===1)for(var u=a[0],l=0;l<u;l++)s[l]=o[i+l];else{u=a[0];var c=a.slice(1),f=c.reduce(function(d,h){return d*h});for(l=0;l<u;l++)s[l]=r(i+l*f,c,o)}return s}(0,e,t)}function PF(e,t){for(var n=_m(e,t),r=0;r<n.length;r++)n[r]=1;return n}function _m(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error("Unknown data type "+t)}function zs(){return pe().platform.now()}function $F(e){e.forEach(function(t){U(Number.isInteger(t)&&t>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+e+"]."})})}function BK(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",pe().platform.encode(e,t)}function qy(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",pe().platform.decode(e,t)}function gS(e,t,n){if(t===0)return 0;if(t===1)return e[0];for(var r=e[e.length-1],i=0;i<e.length-1;++i)r+=n[i]*e[i];return r}function LF(e,t,n){if(t===0)return[];if(t===1)return[e];for(var r=new Array(t),i=0;i<r.length-1;++i)r[i]=Math.floor(e/n[i]),e-=r[i]*n[i];return r[r.length-1]=e,r}var pt=Object.freeze({shuffle:OK,clamp:dS,nearestLargerEven:NF,sum:IK,randUniform:function(e,t){var n=Math.random();return t*n+(1-n)*e},distSquared:function(e,t){for(var n=0,r=0;r<e.length;r++){var i=Number(e[r])-Number(t[r]);n+=i*i}return n},assert:U,assertShapesMatch:ln,assertNonNull:Th,flatten:tc,sizeFromShape:et,isScalarShape:function(e){return e.length===0},arraysEqual:Ur,isInt:gr,tanh:NK,sizeToSquarishShape:hS,createShuffledIndices:function(e){for(var t=new Uint32Array(e),n=0;n<e;++n)t[n]=n;return OK(t),t},rightPad:Oh,repeatedTry:DF,inferFromImplicitShape:DK,parseAxisParam:Wr,squeezeShape:Af,getTypedArrayFromDType:Ih,getArrayFromDType:Vy,checkConversionForErrors:RK,isValidDtype:FK,hasEncodingLoss:MK,isTypedArray:Ni,bytesPerElement:RF,bytesFromStringArray:PK,isString:kf,isBoolean:$K,isNumber:LK,inferDtype:wm,isFunction:Tf,nearestDivisor:pS,computeStrides:Ja,toTypedArray:FF,toNestedArray:MF,makeOnesTypedArray:PF,makeZerosTypedArray:_m,now:zs,assertNonNegativeIntegerDimensions:$F,fetch:function(e,t){return pe().platform.fetch(e,t)},encodeString:BK,decodeString:qy,locToIndex:gS,indexToLoc:LF}),E3e=function(){function e(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new C3e)}return e.prototype.profileKernel=function(t,n,r){var i,a=this,o=this.backendTimer.time(function(){i=r()});return i.forEach(function(s){s.data().then(function(u){(function(l,c,f){if(c!=="float32")return!1;for(var d=0;d<l.length;d++){var h=l[d];if(isNaN(h)||!isFinite(h))return console.warn("Found "+h+" in the result of '"+f+"'"),!0}})(u,s.dtype,t),o.then(function(l){var c="";l.getExtraProfileInfo!=null&&(c=l.getExtraProfileInfo()),a.logger.logKernelProfile(t,s,u,l.kernelMs,n,c)})})}),i},e}(),C3e=function(){function e(){}return e.prototype.logKernelProfile=function(t,n,r,i,a,o){var s=typeof i=="number"?Oh(i+"ms",9):i.error,u=Oh(t,25),l=n.rank,c=n.size,f=Oh(n.shape.toString(),14),d="";for(var h in a){var p=a[h].shape||n.shape,g=p.length;d+=h+": "+g+"D "+(g>0?p:"")+" "}console.log("%c"+u+"	%c"+s+"	%c"+l+"D "+f+"	%c"+c+"	%c"+d+"	%c"+o,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},e}(),zK=20,Hy=3,BF=7;function A3e(e,t,n,r){var i=Ja(t),a=function(l,c,f,d){var h=et(c),p=d[d.length-1],g=new Array(p).fill(0),m=c.length,v=f==="complex64"?Ky(l):l;if(m>1)for(var y=0;y<h/p;y++)for(var b=y*p,x=0;x<p;x++)g[x]=Math.max(g[x],Gy(v[b+x],0,f).length);return g}(e,t,n,i),o=t.length,s=function l(c,f,d,h,p,g){g===void 0&&(g=!0);var m=d==="complex64"?2:1,v=f[0],y=f.length;if(y===0)return d==="complex64"?[Gy(Ky(c)[0],0,d)]:d==="bool"?[jK(c[0])]:[c[0].toString()];if(y===1){if(v>zK){var b=Hy*m,x=Array.from(c.slice(0,b)),w=Array.from(c.slice((v-Hy)*m,v*m));return d==="complex64"&&(x=Ky(x),w=Ky(w)),["["+x.map(function(O,D){return Gy(O,p[D],d)}).join(", ")+", ..., "+w.map(function(O,D){return Gy(O,p[v-Hy+D],d)}).join(", ")+"]"]}return["["+(d==="complex64"?Ky(c):Array.from(c)).map(function(O,D){return Gy(O,p[D],d)}).join(", ")+"]"]}var S=f.slice(1),C=h.slice(1),_=h[0]*m,E=[];if(v>zK){for(var A=0;A<Hy;A++){var k=(T=A*_)+_;E.push.apply(E,l(c.slice(T,k),S,d,C,p,!1))}for(E.push("..."),A=v-Hy;A<v;A++)k=(T=A*_)+_,E.push.apply(E,l(c.slice(T,k),S,d,C,p,A===v-1))}else for(A=0;A<v;A++){var T;k=(T=A*_)+_,E.push.apply(E,l(c.slice(T,k),S,d,C,p,A===v-1))}var I=y===2?",":"";for(E[0]="["+E[0]+I,A=1;A<E.length-1;A++)E[A]=" "+E[A]+I;var N=`,
`;for(A=2;A<y;A++)N+=`
`;return E[E.length-1]=" "+E[E.length-1]+"]"+(g?"":N),E}(e,t,n,i,a),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+o),u.push("  shape: ["+t+"]"),u.push("  values:")),u.push(s.map(function(l){return"    "+l}).join(`
`)),u.join(`
`)}function Gy(e,t,n){return Oh(Array.isArray(e)?parseFloat(e[0].toFixed(BF))+" + "+parseFloat(e[1].toFixed(BF))+"j":kf(e)?"'"+e+"'":n==="bool"?jK(e):parseFloat(e.toFixed(BF)).toString(),t)}function jK(e){return e===0?"false":"true"}function Ky(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var Sm=function(){function e(t,n,r){var i=this;if(this.dtype=n,this.shape=t.slice(),this.size=et(t),r!=null){var a=r.length;U(a===this.size,function(){return"Length of values '"+a+"' does not match the size inferred by the shape '"+i.size+"'."})}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Vy(n,this.size),this.strides=Ja(t)}return e.prototype.set=function(t){for(var n=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];r.length===0&&(r=[0]),U(r.length===this.rank,function(){return"The number of provided coordinates ("+r.length+") must match the rank ("+n.rank+")"});var a=this.locToIndex(r);this.values[a]=t},e.prototype.get=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.length===0&&(t=[0]);for(var r=0,i=0,a=t;i<a.length;i++){var o=a[i];if(o<0||o>=this.shape[r]){var s="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(s)}r++}for(var u=t[t.length-1],l=0;l<t.length-1;++l)u+=this.strides[l]*t[l];return this.values[u]},e.prototype.locToIndex=function(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];for(var n=t[t.length-1],r=0;r<t.length-1;++r)n+=this.strides[r]*t[r];return n},e.prototype.indexToLoc=function(t){if(this.rank===0)return[];if(this.rank===1)return[t];for(var n=new Array(this.shape.length),r=0;r<n.length-1;++r)n[r]=Math.floor(t/this.strides[r]),t-=n[r]*this.strides[r];return n[n.length-1]=t,n},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return $u().makeTensor(this.values,this.shape,this.dtype)},e}(),$u=null,ye=null,UK=null,Ht=function(){function e(t,n,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=et(t),this.strides=Ja(t),this.dataId=r,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}return e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),U(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(t,n){return this.throwIfDisposed(),this.reshape([t,n])},e.prototype.as3D=function(t,n,r){return this.throwIfDisposed(),this.reshape([t,n,r])},e.prototype.as4D=function(t,n,r,i){return this.throwIfDisposed(),this.reshape([t,n,r,i])},e.prototype.as5D=function(t,n,r,i,a){return this.throwIfDisposed(),this.reshape([t,n,r,i,a])},e.prototype.asType=function(t){return this.throwIfDisposed(),ye.cast(this,t)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.buffer=function(){return tt(this,void 0,void 0,function(){var t;return nt(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,ye.buffer(this.shape,this.dtype,t)]}})})},e.prototype.bufferSync=function(){return ye.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.array=function(){return tt(this,void 0,void 0,function(){var t;return nt(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,MF(this.shape,t)]}})})},e.prototype.arraySync=function(){return MF(this.shape,this.dataSync())},e.prototype.data=function(){return tt(this,void 0,void 0,function(){var t,n;return nt(this,function(r){switch(r.label){case 0:return this.throwIfDisposed(),t=$u().read(this.dataId),this.dtype!=="string"?[3,2]:[4,t];case 1:n=r.sent();try{return[2,n.map(function(i){return qy(i)})]}catch(i){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,t]}})})},e.prototype.dataSync=function(){this.throwIfDisposed();var t=$u().readSync(this.dataId);if(this.dtype==="string")try{return t.map(function(n){return qy(n)})}catch(n){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},e.prototype.bytes=function(){return tt(this,void 0,void 0,function(){var t;return nt(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),[4,$u().read(this.dataId)];case 1:return t=n.sent(),this.dtype==="string"?[2,t]:[2,new Uint8Array(t.buffer)]}})})},e.prototype.dispose=function(){this.isDisposed||($u().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(t){return t===void 0&&(t=!1),ye.print(this,t)},e.prototype.reshape=function(t){return this.throwIfDisposed(),ye.reshape(this,t)},e.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},e.prototype.expandDims=function(t){return t===void 0&&(t=0),ye.expandDims(this,t)},e.prototype.cumsum=function(t,n,r){return t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1),ye.cumsum(this,t,n,r)},e.prototype.squeeze=function(t){return this.throwIfDisposed(),ye.squeeze(this,t)},e.prototype.clone=function(){return this.throwIfDisposed(),ye.clone(this)},e.prototype.toString=function(t){return t===void 0&&(t=!1),A3e(this.dataSync(),this.shape,this.dtype,t)},e.prototype.gather=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),ye.gather(this,t,n)},e.prototype.matMul=function(t,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!1),this.throwIfDisposed(),ye.matMul(this,t,n,r)},e.prototype.dot=function(t){return this.throwIfDisposed(),ye.dot(this,t)},e.prototype.norm=function(t,n,r){return t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1),this.throwIfDisposed(),ye.norm(this,t,n,r)},e.prototype.slice=function(t,n){return this.throwIfDisposed(),ye.slice(this,t,n)},e.prototype.reverse=function(t){return this.throwIfDisposed(),ye.reverse(this,t)},e.prototype.concat=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),t instanceof e&&(t=[t]),ye.concat([this].concat(t),n)},e.prototype.split=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),ye.split(this,t,n)},e.prototype.stack=function(t,n){return n===void 0&&(n=0),ye.stack([this,t],n)},e.prototype.unstack=function(t){return t===void 0&&(t=0),ye.unstack(this,t)},e.prototype.batchNormalization=function(t,n,r,i,a){return r===void 0&&(r=.001),UK("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,n,a,i,r)},e.prototype.all=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ye.all(this,t,n)},e.prototype.any=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ye.any(this,t,n)},e.prototype.logSumExp=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ye.logSumExp(this,t,n)},e.prototype.sum=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ye.sum(this,t,n)},e.prototype.prod=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ye.prod(this,t,n)},e.prototype.mean=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ye.mean(this,t,n)},e.prototype.min=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ye.min(this,t,n)},e.prototype.max=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),ye.max(this,t,n)},e.prototype.argMin=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),ye.argMin(this,t)},e.prototype.argMax=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),ye.argMax(this,t)},e.prototype.cast=function(t){return this.throwIfDisposed(),ye.cast(this,t)},e.prototype.addStrict=function(t){return this.throwIfDisposed(),ye.addStrict(this,t)},e.prototype.atan2=function(t){return this.throwIfDisposed(),ye.atan2(this,t)},e.prototype.sub=function(t){return this.throwIfDisposed(),ye.sub(this,t)},e.prototype.subStrict=function(t){return this.throwIfDisposed(),ye.subStrict(this,t)},e.prototype.pow=function(t){return this.throwIfDisposed(),ye.pow(this,t)},e.prototype.powStrict=function(t){return this.throwIfDisposed(),ye.powStrict(this,t)},e.prototype.mul=function(t){return this.throwIfDisposed(),ye.mul(this,t)},e.prototype.mulStrict=function(t){return this.throwIfDisposed(),ye.mulStrict(this,t)},e.prototype.floorDiv=function(t){return this.throwIfDisposed(),ye.floorDiv(this,t)},e.prototype.divStrict=function(t){return this.throwIfDisposed(),ye.divStrict(this,t)},e.prototype.minimum=function(t){return this.throwIfDisposed(),ye.minimum(this,t)},e.prototype.minimumStrict=function(t){return this.throwIfDisposed(),ye.minimumStrict(this,t)},e.prototype.maximum=function(t){return this.throwIfDisposed(),ye.maximum(this,t)},e.prototype.maximumStrict=function(t){return this.throwIfDisposed(),ye.maximumStrict(this,t)},e.prototype.mod=function(t){return this.throwIfDisposed(),ye.mod(this,t)},e.prototype.modStrict=function(t){return this.throwIfDisposed(),ye.modStrict(this,t)},e.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),ye.squaredDifferenceStrict(this,t)},e.prototype.notEqual=function(t){return this.throwIfDisposed(),ye.notEqual(this,t)},e.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),ye.notEqualStrict(this,t)},e.prototype.less=function(t){return this.throwIfDisposed(),ye.less(this,t)},e.prototype.lessStrict=function(t){return this.throwIfDisposed(),ye.lessStrict(this,t)},e.prototype.equal=function(t){return this.throwIfDisposed(),ye.equal(this,t)},e.prototype.equalStrict=function(t){return this.throwIfDisposed(),ye.equalStrict(this,t)},e.prototype.lessEqual=function(t){return this.throwIfDisposed(),ye.lessEqual(this,t)},e.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),ye.lessEqualStrict(this,t)},e.prototype.greater=function(t){return this.throwIfDisposed(),ye.greater(this,t)},e.prototype.greaterStrict=function(t){return this.throwIfDisposed(),ye.greaterStrict(this,t)},e.prototype.greaterEqual=function(t){return this.throwIfDisposed(),ye.greaterEqual(this,t)},e.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),ye.greaterEqualStrict(this,t)},e.prototype.logicalAnd=function(t){return this.throwIfDisposed(),ye.logicalAnd(this,t)},e.prototype.logicalOr=function(t){return this.throwIfDisposed(),ye.logicalOr(this,t)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),ye.logicalNot(this)},e.prototype.logicalXor=function(t){return this.throwIfDisposed(),ye.logicalXor(this,t)},e.prototype.where=function(t,n){return this.throwIfDisposed(),ye.where(t,this,n)},e.prototype.neg=function(){return this.throwIfDisposed(),ye.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),ye.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),ye.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),ye.sign(this)},e.prototype.isNaN=function(){return this.throwIfDisposed(),ye.isNaN(this)},e.prototype.isInf=function(){return this.throwIfDisposed(),ye.isInf(this)},e.prototype.isFinite=function(){return this.throwIfDisposed(),ye.isFinite(this)},e.prototype.exp=function(){return this.throwIfDisposed(),ye.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),ye.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),ye.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),ye.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),ye.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),ye.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),ye.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),ye.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),ye.abs(this)},e.prototype.clipByValue=function(t,n){return this.throwIfDisposed(),ye.clipByValue(this,t,n)},e.prototype.relu=function(){return this.throwIfDisposed(),ye.relu(this)},e.prototype.relu6=function(){return this.throwIfDisposed(),ye.relu6(this)},e.prototype.elu=function(){return this.throwIfDisposed(),ye.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),ye.selu(this)},e.prototype.leakyRelu=function(t){return t===void 0&&(t=.2),this.throwIfDisposed(),ye.leakyRelu(this,t)},e.prototype.prelu=function(t){return this.throwIfDisposed(),ye.prelu(this,t)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),ye.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),ye.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),ye.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),ye.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),ye.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),ye.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),ye.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),ye.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),ye.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),ye.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),ye.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),ye.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),ye.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),ye.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),ye.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),ye.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),ye.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),ye.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),ye.round(this)},e.prototype.step=function(t){return t===void 0&&(t=0),this.throwIfDisposed(),ye.step(this,t)},e.prototype.softmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),ye.softmax(this,t)},e.prototype.logSoftmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),ye.logSoftmax(this,t)},e.prototype.resizeBilinear=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),ye.image.resizeBilinear(this,t,n)},e.prototype.resizeNearestNeighbor=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),ye.image.resizeNearestNeighbor(this,t,n)},e.prototype.conv1d=function(t,n,r,i,a,o){return i===void 0&&(i="NWC"),a===void 0&&(a=1),this.throwIfDisposed(),ye.conv1d(this,t,n,r,i,a,o)},e.prototype.conv2d=function(t,n,r,i,a,o){return i===void 0&&(i="NHWC"),a===void 0&&(a=[1,1]),this.throwIfDisposed(),ye.conv2d(this,t,n,r,i,a,o)},e.prototype.conv2dTranspose=function(t,n,r,i,a){return this.throwIfDisposed(),ye.conv2dTranspose(this,t,n,r,i,a)},e.prototype.depthwiseConv2D=function(t,n,r,i,a,o){return i===void 0&&(i="NHWC"),a===void 0&&(a=[1,1]),this.throwIfDisposed(),ye.depthwiseConv2d(this,t,n,r,i,a,o)},e.prototype.separableConv2d=function(t,n,r,i,a,o){return a===void 0&&(a=[1,1]),o===void 0&&(o="NHWC"),this.throwIfDisposed(),ye.separableConv2d(this,t,n,r,i,a,o)},e.prototype.avgPool=function(t,n,r,i){return this.throwIfDisposed(),ye.avgPool(this,t,n,r,i)},e.prototype.maxPool=function(t,n,r,i){return this.throwIfDisposed(),ye.maxPool(this,t,n,r,i)},e.prototype.localResponseNormalization=function(t,n,r,i){return t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),i===void 0&&(i=.5),ye.localResponseNormalization(this,t,n,r,i)},e.prototype.pool=function(t,n,r,i,a){return this.throwIfDisposed(),ye.pool(this,t,n,r,i,a)},e.prototype.variable=function(t,n,r){return t===void 0&&(t=!0),this.throwIfDisposed(),$u().makeVariable(this,t,n,r)},e.prototype.unsortedSegmentSum=function(t,n){return this.throwIfDisposed(),ye.unsortedSegmentSum(this,t,n)},e.prototype.batchToSpaceND=function(t,n){return this.throwIfDisposed(),ye.batchToSpaceND(this,t,n)},e.prototype.spaceToBatchND=function(t,n){return this.throwIfDisposed(),ye.spaceToBatchND(this,t,n)},e.prototype.topk=function(t,n){return t===void 0&&(t=1),n===void 0&&(n=!0),this.throwIfDisposed(),ye.topk(this,t,n)},e.prototype.stridedSlice=function(t,n,r,i,a,o,s,u){return i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o=0),s===void 0&&(s=0),u===void 0&&(u=0),this.throwIfDisposed(),ye.stridedSlice(this,t,n,r,i,a,o,s,u)},e.prototype.depthToSpace=function(t,n){return this.throwIfDisposed(),ye.depthToSpace(this,t,n)},e.prototype.fft=function(){return this.throwIfDisposed(),ye.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),ye.spectral.ifft(this)},e.prototype.rfft=function(){return this.throwIfDisposed(),ye.spectral.rfft(this)},e.prototype.irfft=function(){return this.throwIfDisposed(),ye.spectral.irfft(this)},e}();Object.defineProperty(Ht,Symbol.hasInstance,{value:function(e){return!!e&&e.dataId!=null&&e.shape!=null&&e.dtype!=null}});var zF,jF,UF,WF,VF,Xy=function(e){function t(n,r,i,a){var o=e.call(this,n.shape,n.dtype,n.dataId,a)||this;return o.trainable=r,o.name=i,o}return Bs(t,e),t.prototype.assign=function(n){if(n.dtype!==this.dtype)throw new Error("dtype of the new value ("+n.dtype+") and previous value ("+this.dtype+") must match");if(!Ur(n.shape,this.shape))throw new Error("shape of the new value ("+n.shape+") and previous value ("+this.shape+") must match");$u().disposeTensor(this),this.dataId=n.dataId,$u().incRef(this,null)},t.prototype.dispose=function(){$u().disposeVariable(this),this.isDisposedInternal=!0},t}(Ht);Object.defineProperty(Xy,Symbol.hasInstance,{value:function(e){return e instanceof Ht&&e.assign!=null&&e.assign instanceof Function}}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(zF||(zF={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(jF||(jF={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(UF||(UF={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(WF||(WF={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(VF||(VF={}));var k3e={float32:WF,int32:jF,bool:UF,complex64:VF};function yi(e,t){if(e==="string"||t==="string"){if(e==="string"&&t==="string")return"string";throw new Error("Can not upcast "+e+" with "+t)}return k3e[e][t]}function mS(e){return yi(e,"int32")}function ur(e,t){if(e.dtype===t.dtype)return[e,t];var n=yi(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function WK(e,t){U(e.dtype===t.dtype,function(){return"The dtypes of the first("+e.dtype+") and second("+t.dtype+") input must match"})}function qF(e){var t=[];return function n(r,i,a){if(r!=null){if(r instanceof Ht)return void i.push(r);if(o=r,!(!Array.isArray(o)&&typeof o!="object")){var o,s=r;for(var u in s){var l=s[u];a.has(l)||(a.add(l),n(l,i,a))}}}}(e,t,new Set),t}var HF,Lu=Object.freeze({makeTypesMatch:ur,assertTypesMatch:WK,isTensorInList:function(e,t){return t.some(function(n){return n.id===e.id})},getTensorsInContainer:qF}),VK=function(){function e(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return e.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},e}(),T3e=function(){function e(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new VK}return e.prototype.ready=function(){return tt(this,void 0,void 0,function(){var t,n,r;return nt(this,function(i){switch(i.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];t=this.getSortedBackends(),n=0,i.label=1;case 1:return n<t.length?(r=t[n],[4,this.initializeBackend(r).success]):[3,5];case 2:return i.sent()?[4,this.setBackend(r)]:[3,4];case 3:return i.sent(),[2];case 4:return n++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(e.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var t=this.initializeBackendsAndReturnBest(),n=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+n+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(n)}return this.backendInstance},enumerable:!0,configurable:!0}),e.prototype.backendNames=function(){return Object.keys(this.registryFactory)},e.prototype.findBackend=function(t){return!(t in this.registry)&&(!(t in this.registryFactory)||this.initializeBackend(t).asyncInit)?null:this.registry[t]},e.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},e.prototype.registerBackend=function(t,n,r){return r===void 0&&(r=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:n,priority:r},!0)},e.prototype.setBackend=function(t){return tt(this,void 0,void 0,function(){var n,r,i;return nt(this,function(a){switch(a.label){case 0:if(this.registryFactory[t]==null)throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,this.registry[t]!=null?[3,4]:(this.backendInstance=null,n=this.initializeBackend(t),r=n.success,n.asyncInit?[4,r]:[3,2]);case 1:return i=a.sent(),[3,3];case 2:i=r,a.label=3;case 3:if(!i)return[2,!1];a.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new E3e(this.backendInstance),[2,!0]}})})},e.prototype.setupRegisteredKernels=function(){var t=this;TF(this.backendName).forEach(function(n){n.setupFunc!=null&&n.setupFunc(t.backendInstance)})},e.prototype.disposeRegisteredKernels=function(t){var n=this;TF(t).forEach(function(r){r.disposeFunc!=null&&r.disposeFunc(n.registry[t])})},e.prototype.initializeBackend=function(t){var n=this,r=this.registryFactory[t];if(r==null)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var i=r.factory();if(Promise.resolve(i)===i){var a=++this.pendingBackendInitId,o=i.then(function(s){return!(a<n.pendingBackendInitId)&&(n.registry[t]=s,n.pendingBackendInit=null,!0)}).catch(function(s){return!(a<n.pendingBackendInitId)&&(n.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(s.stack||s.message),!1)});return this.pendingBackendInit=o,{success:o,asyncInit:!0}}return this.registry[t]=i,{success:!0,asyncInit:!1}}catch(s){return console.warn("Initialization of backend "+t+" failed"),console.warn(s.stack||s.message),{success:!1,asyncInit:!1}}},e.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},e.prototype.getSortedBackends=function(){var t=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(n,r){return t.registryFactory[r].priority-t.registryFactory[n].priority})},e.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),n=0;n<t.length;n++){var r=t[n],i=this.initializeBackend(r),a=i.success,o=i.asyncInit;if(o||a)return{name:r,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")},e.prototype.moveData=function(t,n){var r=this.state.tensorInfo.get(n),i=r.backend,a=this.readSync(n);i.disposeData(n),r.backend=t,t.move(n,a,r.shape,r.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},e.prototype.tidy=function(t,n){var r,i=this,a=null;if(n==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");n=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");a=t}return this.scopedRun(function(){return i.startScope(a)},function(){return i.endScope(r)},function(){return(r=n())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r})},e.prototype.scopedRun=function(t,n,r){t();try{var i=r();return n(),i}catch(a){throw n(),a}},e.prototype.nextTensorId=function(){return e.nextTensorId++},e.prototype.nextVariableId=function(){return e.nextVariableId++},e.prototype.clone=function(t){var n=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),r={x:t};return this.addTapeNode(this.state.activeScope.name,r,[n],function(i){return{x:function(){return i.toFloat()}}},[],{}),n},e.prototype.runKernel=function(t,n,r,i,a){return this.runKernelFunc(null,n,null,t,r,i,a)},e.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},e.prototype.checkKernelForMemLeak=function(t,n,r){var i=this.backend.numDataIds(),a=0;r.forEach(function(u){a+=u.dtype==="complex64"?3:1});var o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=i-n-a-o;if(s>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+s+" data ids) after running '"+t+"'")},e.prototype.runKernelFunc=function(t,n,r,i,a,o,s){var u,l=this,c=[],f=this.isTapeOn();i==null&&(i=this.state.activeScope!=null?this.state.activeScope.name:"");var d,h=this.state.numBytes,p=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var g,m=AF(i,this.backendName);if(m!=null)d=function(){var y=l.backend.numDataIds();g=m.kernelFunc({inputs:n,attrs:a,backend:l.backend});var b=Array.isArray(g)?g:[g];l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(i,y,b);var x=b.map(function(C){var _=C.dataId,E=C.shape,A=C.dtype;return l.makeTensorFromDataId(_,E,A)});if(f){var w=l.getTensorsForGradient(i,n,x);if(w==null){s==null&&(s=[]);var S=x.filter(function(C,_){return s[_]});w=(o||[]).slice().concat(S)}c=l.saveTensorsForBackwardMode(w)}return x};else{var v=function(y){f&&(c=y.map(function(b){return l.keep(l.clone(b))}))};d=function(){var y=l.backend.numDataIds();g=l.tidy(function(){return t(l.backend,v)});var b=Array.isArray(g)?g:[g];return l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(i,y,b),b}}return this.scopedRun(function(){return l.state.kernelDepth++},function(){return l.state.kernelDepth--},function(){u=l.ENV.getBool("DEBUG")?l.profiler.profileKernel(i,n,function(){return d()}):d()}),f&&this.addTapeNode(i,n,u,r,c,a),this.state.profiling&&this.state.activeProfile.kernels.push({name:i,bytesAdded:this.state.numBytes-h,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-p,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(n).map(function(y){return n[y].shape}),outputShapes:u.map(function(y){return y.shape})}),Array.isArray(g)?u:u[0]},e.prototype.saveTensorsForBackwardMode=function(t){var n=this;return t.map(function(r){return n.keep(n.clone(r))})},e.prototype.getTensorsForGradient=function(t,n,r){var i=kF(t);if(i!=null){var a=i.inputsToSave||[],o=i.outputsToSave||[],s=void 0;i.saveAllInputs?(U(Array.isArray(n),function(){return"saveAllInputs is true, expected inputs to be an array."}),s=Object.keys(n).map(function(l){return n[l]})):s=a.map(function(l){return n[l]});var u=r.filter(function(l,c){return o[c]});return s.concat(u)}return null},e.prototype.makeTensor=function(t,n,r,i){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",i=i||this.backend;var a=t;r==="string"&&kf(t[0])&&(a=t.map(function(c){return BK(c)}));var o=i.write(a,n,r),s=new Ht(n,r,o,this.nextTensorId());if(this.incRef(s,i),r==="string"){var u=this.state.tensorInfo.get(o),l=PK(a);this.state.numBytes+=l-u.bytes,u.bytes=l}return s},e.prototype.makeTensorFromDataId=function(t,n,r,i){var a=new Ht(n,r=r||"float32",t,this.nextTensorId());return this.incRef(a,i),a},e.prototype.makeVariable=function(t,n,r,i){n===void 0&&(n=!0),r=r||this.nextVariableId().toString(),i!=null&&i!==t.dtype&&(t=t.asType(i));var a=new Xy(t,n,r,this.nextTensorId());if(this.state.registeredVariables[a.name]!=null)throw new Error("Variable with name "+a.name+" was already registered");return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a},e.prototype.incRef=function(t,n){var r=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++,r===0){this.state.numDataBuffers++;var i=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(i=t.size*RF(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:n||this.backend,dtype:t.dtype,shape:t.shape,bytes:i,refCount:0}),this.state.numBytes+=i}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof Xy||this.track(t)},e.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,t.dtype==="string"&&this.state.numStringTensors--;var n=this.state.tensorInfo.get(t.dataId);n.refCount<=1?(t.dtype!=="complex64"&&(this.state.numBytes-=n.bytes),this.state.numDataBuffers--,n.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},e.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables){var n=this.state.registeredVariables[t];this.disposeVariable(n)}},e.prototype.disposeVariable=function(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]},e.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},e.prototype.profile=function(t){return tt(this,void 0,void 0,function(){var n,r;return nt(this,function(i){return this.state.profiling=!0,n=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(a){return a.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r,[2,this.state.activeProfile]})})},e.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},e.prototype.addTapeNode=function(t,n,r,i,a,o){var s=this,u={id:this.state.nextTapeNodeId++,kernelName:t,inputs:n,outputs:r,saved:a},l=kF(t);l!=null&&(i=l.gradFunc),i!=null&&(u.gradient=function(c){return c=c.map(function(f,d){if(f==null){var h=r[d],p=_m(h.size,h.dtype);return s.makeTensor(p,h.shape,h.dtype)}return f}),i(c.length>1?c:c[0],a,o)}),this.state.activeTape.push(u)},e.prototype.keep=function(t){return t.kept=!0,t},e.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},e.prototype.endTape=function(){this.state.gradientDepth--},e.prototype.startScope=function(t){var n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(n.name=t),this.state.scopeStack.push(n),this.state.activeScope=n},e.prototype.endScope=function(t){for(var n=this,r=qF(t),i=new Set(r.map(function(u){return u.id})),a=0;a<this.state.activeScope.track.length;a++){var o=this.state.activeScope.track[a];o.kept||i.has(o.id)||o.dispose()}var s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(function(u){u.kept||u.scopeId!==s.id||n.track(u)})},e.prototype.gradients=function(t,n,r,i){var a=this;if(i===void 0&&(i=!1),U(n.length>0,function(){return"gradients() received an empty list of xs."}),r!=null&&r.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+r.dtype+"'");var o=this.scopedRun(function(){return a.startTape()},function(){return a.endTape()},function(){return a.tidy("forward",t)});U(o instanceof Ht,function(){return"The result y returned by f() must be a tensor."});var s=function(u,l,c){for(var f={},d={},h=0;h<l.length;h++)f[l[h].id]=!0;for(h=0;h<u.length;h++){var p=(S=u[h]).inputs;for(var g in p){for(var m=p[g],v=!1,y=0;y<l.length;y++)if(f[m.id]){S.outputs.forEach(function(A){return f[A.id]=!0}),v=!0,d[S.id]=!0;break}if(v)break}}var b={};b[c.id]=!0;var x={};for(h=u.length-1;h>=0;h--)for(p=(S=u[h]).inputs,y=0;y<S.outputs.length;y++)if(b[S.outputs[y].id]){for(var g in p)b[p[g].id]=!0,x[S.id]=!0;break}var w=[];for(h=0;h<u.length;h++){var S;if(d[(S=u[h]).id]&&x[S.id]){var C={};for(var g in S.inputs){var _=S.inputs[g];f[_.id]&&(C[g]=_)}var E=Object.assign({},S);E.inputs=C,E.outputs=S.outputs,w.push(E)}}return w}(this.state.activeTape,n,o);if(!i&&s.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var u,l,c={};c[o.id]=r??(u=o.shape,l=PF(et(u),"float32"),J.makeTensor(l,u,"float32")),function(d,h,p){for(var g=function(v){var y=h[v],b=[];if(y.outputs.forEach(function(C){var _=d[C.id];_!=null?b.push(_):b.push(null)}),y.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+y.kernelName+".");var x=y.gradient(b),w=function(C){if(!(C in x))throw new Error("Cannot backprop through input "+C+". Available gradients found: "+Object.keys(x)+".");var _=p(function(){return x[C]()});if(_.dtype!=="float32")throw new Error("Error in gradient for op "+y.kernelName+". The gradient of input "+C+" must have 'float32' dtype, but has '"+_.dtype+"'");var E=y.inputs[C];if(!Ur(_.shape,E.shape))throw new Error("Error in gradient for op "+y.kernelName+". The gradient of input '"+C+"' has shape '"+_.shape+"', which does not match the shape of the input '"+E.shape+"'");if(d[E.id]==null)d[E.id]=_;else{var A=d[E.id];d[E.id]=A.add(_),A.dispose()}};for(var S in y.inputs)w(S)},m=h.length-1;m>=0;m--)g(m)}(c,s,function(d){return a.tidy(d)});var f=n.map(function(d){return c[d.id]});return a.state.gradientDepth===0&&(a.state.activeTape.forEach(function(d){for(var h=0,p=d.saved;h<p.length;h++)p[h].dispose()}),a.state.activeTape=null),{value:o,grads:f}})},e.prototype.customGrad=function(t){var n=this;return U(Tf(t),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var r,i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];U(i.every(function(s){return s instanceof Ht}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var o={};return i.forEach(function(s,u){o[u]=s}),n.runKernelFunc(function(s,u){return U((r=t.apply(void 0,i.concat([u]))).value instanceof Ht,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),U(Tf(r.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),r.value},o,function(s,u){var l=r.gradFunc(s,u),c=Array.isArray(l)?l:[l];U(c.length===i.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),U(c.every(function(d){return d instanceof Ht}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var f={};return c.forEach(function(d,h){f[h]=function(){return d}}),f})}},e.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},e.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},e.prototype.time=function(t){return tt(this,void 0,void 0,function(){var n,r;return nt(this,function(i){switch(i.label){case 0:return n=zs(),[4,this.backend.time(t)];case 1:return(r=i.sent()).wallMs=zs()-n,[2,r]}})})},e.prototype.track=function(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(e.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),e.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new VK,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},e.nextTensorId=0,e.nextVariableId=0,e}(),J=function(){var e=function(){if(HF==null){var n=void 0;if(typeof window!="undefined")n=window;else if(typeof global!="undefined")n=global;else if(typeof process!="undefined")n=process;else{if(typeof self=="undefined")throw new Error("Could not find a global object");n=self}HF=n}return HF}();if(e._tfengine==null){var t=new kK(e);e._tfengine=new T3e(t)}return function(n){CF=n}(e._tfengine.ENV),$u=function(){return e._tfengine},e._tfengine}();function qK(){return typeof window!="undefined"&&window.document!=null||typeof WorkerGlobalScope!="undefined"}var nc=pe();nc.registerFlag("DEBUG",function(){return!1},function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),nc.registerFlag("IS_BROWSER",function(){return qK()}),nc.registerFlag("IS_NODE",function(){return typeof process!="undefined"&&process.versions!==void 0&&process.versions.node!==void 0}),nc.registerFlag("IS_CHROME",function(){return typeof navigator!="undefined"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),nc.registerFlag("PROD",function(){return!1}),nc.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return nc.getBool("DEBUG")}),nc.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),nc.registerFlag("IS_TEST",function(){return!1});var Yy,To,Oo,Nh={},GF={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function HK(e,t){Nh[e]=t}function Bu(e){e in Nh||(Nh[e]=function(n){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var r=function(i){if(typeof OffscreenCanvas!="undefined"&&i===2)return new OffscreenCanvas(300,150);if(typeof document!="undefined")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(n);return r.addEventListener("webglcontextlost",function(i){i.preventDefault(),delete Nh[n]},!1),n===1?r.getContext("webgl",GF)||r.getContext("experimental-webgl",GF):r.getContext("webgl2",GF)}(e));var t=Nh[e];return t.isContextLost()?(delete Nh[e],Bu(e)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),Nh[e])}function vS(e,t){return[t,e]}function Zy(e){var t=et(e);return hS(Math.ceil(t/4))}function Jy(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function KF(e,t){var n,r,i,a,o,s,u,l,c,f=e;return pe().getNumber("WEBGL_VERSION")===2?(n=f.R32F,r=f.R16F,i=f.RGBA16F,a=f.RGBA32F,o=f.RED,s=4,u=1,l=f.HALF_FLOAT,c=f.FLOAT):(n=e.RGBA,r=e.RGBA,i=e.RGBA,a=f.RGBA,o=e.RGBA,s=4,u=4,l=t!=null?t.HALF_FLOAT_OES:null,c=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:a,textureFormatFloat:o,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:l,textureTypeFloat:c}}function Qe(e,t,n){var r=n();return t&&function(i){var a=i.getError();if(a!==i.NO_ERROR)throw new Error("WebGL Error: "+KK(i,a))}(e),r}(function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"})(Yy||(Yy={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(To||(To={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Oo||(Oo={}));var O3e=596e-10,I3e=65504;function GK(e){return!!(pe().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||e===0||O3e<Math.abs(e)&&Math.abs(e)<I3e)}function KK(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function Qy(e,t,n){return rc(e,t,function(){return e.getExtension(n)},'Extension "'+n+'" not supported on this browser.')}function XK(e,t,n){var r=rc(e,t,function(){return e.createShader(e.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(Qe(e,t,function(){return e.shaderSource(r,n)}),Qe(e,t,function(){return e.compileShader(r)}),e.getShaderParameter(r,e.COMPILE_STATUS)===!1)throw console.log(e.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function YK(e,t,n){var r=rc(e,t,function(){return e.createShader(e.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(Qe(e,t,function(){return e.shaderSource(r,n)}),Qe(e,t,function(){return e.compileShader(r)}),e.getShaderParameter(r,e.COMPILE_STATUS)===!1)throw function(i,a){var o=N3e.exec(a);if(o==null)return console.log("Couldn't parse line number in error: "+a),void console.log(i);for(var s=+o[1],u=i.split(`
`),l=u.length.toString().length+2,c=u.map(function(m,v){return Oh((v+1).toString(),l)+m}),f=0,d=0;d<c.length;d++)f=Math.max(c[d].length,f);var h=c.slice(0,s-1),p=c.slice(s-1,s),g=c.slice(s);console.log(h.join(`
`)),console.log(a.split(`
`)[0]),console.log("%c "+Oh(p[0],f),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(g.join(`
`))}(n,e.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var yS,bS,N3e=/ERROR: [0-9]+:([0-9]+):/g;function ZK(e,t){return rc(e,t,function(){return e.createProgram()},"Unable to create WebGLProgram.")}function JK(e,t,n){if(Qe(e,t,function(){return e.linkProgram(n)}),e.getProgramParameter(n,e.LINK_STATUS)===!1)throw console.log(e.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function xS(e,t,n){if(Qe(e,t,function(){return e.validateProgram(n)}),e.getProgramParameter(n,e.VALIDATE_STATUS)===!1)throw console.log(e.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function QK(e,t,n){var r=rc(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return Qe(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),Qe(e,t,function(){return e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function eX(e,t,n){var r=rc(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return Qe(e,t,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r)}),Qe(e,t,function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function tX(e,t){return rc(e,t,function(){return e.createTexture()},"Unable to create WebGLTexture.")}function nX(e,t){var n=pe().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="["+e+"x"+t+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n)throw r="["+e+"x"+t+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+("["+n+"x"+n+"]")+".")}function rX(e,t){return rc(e,t,function(){return e.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function XF(e,t,n,r,i,a,o,s){var u=e.getAttribLocation(n,r);return u!==-1&&(Qe(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,i)}),Qe(e,t,function(){return e.vertexAttribPointer(u,a,e.FLOAT,!1,o,s)}),Qe(e,t,function(){return e.enableVertexAttribArray(u)}),!0)}function iX(e,t,n,r){lX(e,r),Qe(e,t,function(){return e.activeTexture(e.TEXTURE0+r)}),Qe(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)})}function aX(e,t,n,r){return rc(e,t,function(){return e.getUniformLocation(n,r)},'uniform "'+r+'" not present in program.')}function oX(e,t,n){return e.getUniformLocation(t,n)}function sX(e,t,n,r,i,a){Qe(e,t,function(){return iX(e,t,r,a)}),Qe(e,t,function(){return e.uniform1i(i,a)})}function wS(e,t,n,r){Qe(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,r)}),Qe(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0)})}function YF(e,t,n){Qe(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)}),Qe(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)})}function eb(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+uX(e,t))}function uX(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function rc(e,t,n,r){var i=Qe(e,t,function(){return n()});if(i==null)throw new Error(r);return i}function lX(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+n+"]")+".")}function tb(e,t){return t===void 0&&(t=2),et(e.slice(0,e.length-t))}function nb(e){if(e.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function _S(e){var t=[1,1,1];return e.length===0||e.length===1&&e[0]===1||(t=[tb(e)].concat(nb(e))),t}function cX(e,t){var n;t===void 0&&(t=!1);var r=pe().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(r*=2,(e=e.map(function(l,c){return c>=e.length-2?NF(e[c]):e[c]})).length===1&&(e=[2,e[0]])),e.length!==2){var i=Af(e);e=i.newShape}var a=et(e);if(e.length<=1&&a<=r)return[1,a];if(e.length===2&&e[0]<=r&&e[1]<=r)return e;if(e.length===3&&e[0]*e[1]<=r&&e[2]<=r)return[e[0]*e[1],e[2]];if(e.length===3&&e[0]<=r&&e[1]*e[2]<=r)return[e[0],e[1]*e[2]];if(e.length===4&&e[0]*e[1]*e[2]<=r&&e[3]<=r)return[e[0]*e[1]*e[2],e[3]];if(e.length===4&&e[0]<=r&&e[1]*e[2]*e[3]<=r)return[e[0],e[1]*e[2]*e[3]];if(t){var o=tb(e),s=2,u=2;return e.length&&(s=(n=nb(e))[0],u=n[1]),hS(a=o*(s/2)*(u/2)).map(function(l){return 2*l})}return hS(a)}function SS(e){return e%2==0}function rb(e,t){if(Ur(e=e.slice(-2),t=t.slice(-2))||!e.length||!t.length||e[0]===0||e[1]===0||t[0]===0||t[1]===0)return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r||SS(n)&&SS(r)&&(e[0]===1||t[0]===1))return!0}return e[1]===t[1]&&SS(e[0])&&SS(t[0])}function fX(e){if(yS==null){var t=Bu(e);yS=t.getParameter(t.MAX_TEXTURE_SIZE)}return yS}function dX(e){if(bS==null){var t=Bu(e);bS=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,bS)}function hX(e){if(e===0)return 0;var t=Bu(e);return Io(t,"EXT_disjoint_timer_query_webgl2")&&e===2?2:Io(t,"EXT_disjoint_timer_query")?1:0}function Io(e,t){return e.getExtension(t)!=null}function ZF(e){try{if(Bu(e)!=null)return!0}catch(t){return!1}return!1}function pX(e){if(e===0)return!1;var t=Bu(e);if(e===1){if(!Io(t,"OES_texture_float"))return!1}else if(!Io(t,"EXT_color_buffer_float"))return!1;return JF(t)}function gX(e){if(e===0)return!1;var t=Bu(e);if(e!==1){if(Io(t,"EXT_color_buffer_float"))return JF(t);if(Io(t,"EXT_color_buffer_half_float")){var n=t.getExtension("EXT_color_buffer_half_float");return function(r,i){var a=KF(r,i),o=r.createTexture();r.bindTexture(r.TEXTURE_2D,o),r.texImage2D(r.TEXTURE_2D,0,a.internalFormatHalfFloat,1,1,0,a.textureFormatFloat,a.textureTypeHalfFloat,null);var s=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,s),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,o,0);var u=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(o),r.deleteFramebuffer(s),u}(t,n)}return!1}return!!Io(t,"OES_texture_float")&&!!Io(t,"WEBGL_color_buffer_float")&&JF(t)}function JF(e){var t=KF(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var i=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),i}function mX(e){return e===2&&Bu(e).fenceSync!=null}var D3e=Object.freeze({callAndCheck:Qe,canBeRepresented:GK,getWebGLErrorMessage:KK,getExtensionOrThrow:Qy,createVertexShader:XK,createFragmentShader:YK,createProgram:ZK,linkProgram:JK,validateProgram:xS,createStaticVertexBuffer:QK,createStaticIndexBuffer:eX,getNumChannels:function(){return pe().getNumber("WEBGL_VERSION")===2?1:4},createTexture:tX,validateTextureSize:nX,createFramebuffer:rX,bindVertexBufferToProgramAttribute:XF,bindTextureUnit:iX,unbindTextureUnit:function(e,t,n){lX(e,n),Qe(e,t,function(){return e.activeTexture(e.TEXTURE0+n)}),Qe(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})},getProgramUniformLocationOrThrow:aX,getProgramUniformLocation:oX,bindTextureToProgramUniformSampler:sX,bindCanvasToFramebuffer:function(e,t){Qe(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)}),Qe(e,t,function(){return e.viewport(0,0,e.canvas.width,e.canvas.height)}),Qe(e,t,function(){return e.scissor(0,0,e.canvas.width,e.canvas.height)})},bindColorTextureToFramebuffer:wS,unbindColorTextureFromFramebuffer:YF,validateFramebuffer:eb,getFramebufferErrorMessage:uX,getBatchDim:tb,getRowsCols:nb,getShapeAs3D:_S,getTextureShapeFromLogicalShape:cX,isReshapeFree:rb,getWebGLMaxTextureSize:fX,resetMaxTextureSize:function(){yS=null},resetMaxTexturesInShader:function(){bS=null},getMaxTexturesInShader:dX,getWebGLDisjointQueryTimerVersion:hX,hasExtension:Io,isWebGLVersionEnabled:ZF,isCapableOfRenderingToFloatTexture:pX,isDownloadFloatTextureEnabled:gX,isWebGLFenceEnabled:mX}),Ct=pe();function R3e(){pe().set("PROD",!0)}function F3e(){pe().set("DEBUG",!0)}function M3e(){pe().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function ES(e){pe().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function P3e(){J.disposeVariables()}function $3e(){return J}function CS(){return J.memory()}function L3e(e){return J.profile(e)}function le(e,t){return J.tidy(e,t)}function Ut(e){qF(e).forEach(function(t){return t.dispose()})}function zu(e){return J.keep(e)}function B3e(e){return J.time(e)}function z3e(e){return J.setBackend(e)}function j3e(){return J.ready()}function U3e(){return J.backendName}function W3e(e){J.removeBackend(e)}function V3e(e){return J.findBackend(e)}function q3e(e){return J.findBackendFactory(e)}function H3e(e,t,n){return n===void 0&&(n=1),J.registerBackend(e,t,n)}function vX(){return J.backend}function G3e(e,t){pe().setPlatform(e,t)}function AS(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];pe().getBool("IS_TEST")||console.warn.apply(console,e)}function ju(e,t){var n=e;if(Ni(e))return t==="string"?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||Ni(n)&&t!=="string";)r.push(n.length),n=n[0];return Array.isArray(e)&&pe().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function i(a,o,s){if(s=s||[],!Array.isArray(a)&&!Ni(a))return void U(o.length===0,function(){return"Element arr["+s.join("][")+"] is a primitive, but should be an array/TypedArray of "+o[0]+" elements"});U(o.length>0,function(){return"Element arr["+s.join("][")+"] should be a primitive, but is an array of "+a.length+" elements"}),U(a.length===o[0],function(){return"Element arr["+s.join("][")+"] should have "+o[0]+" elements, but has "+a.length+" elements"});for(var u=o.slice(1),l=0;l<a.length;++l)i(a[l],u,s.concat(l))}(e,r,[]),r}function yX(e,t,n,r){if(e!=null&&(e!=="numeric"&&e!==t||e==="numeric"&&t==="string"))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+e+" tensor, but got "+t+" tensor")}function j(e,t,n,r){if(r===void 0&&(r="numeric"),e instanceof Ht)return yX(r,e.dtype,t,n),e;var i=wm(e);if(i!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),yX(r,i,t,n),e==null||!Ni(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){var a=e==null?"null":e.constructor.name;throw new Error("Argument '"+t+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+a+"'")}var o=ju(e,i);Ni(e)||Array.isArray(e)||(e=[e]);var s=i!=="string"?FF(e,i,pe().getBool("DEBUG")):tc(e,[],!0);return J.makeTensor(s,o,i)}function ib(e,t,n,r){if(r===void 0&&(r="numeric"),!Array.isArray(e))throw new Error("Argument "+t+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return e.map(function(i,a){return j(i,t+"["+a+"]",n)},r)}function QF(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function bX(e,t,n){for(var r=e.length+t.length,i=[],a=0,o=0,s=0;s<r;s++)n.indexOf(s)===-1?i.push(e[a++]):i.push(t[o++]);return i}function Di(e,t){for(var n=[],r=e.length,i=0;i<r;i++)t.indexOf(i)===-1&&n.push(e[i]);return[n,t.map(function(a){return e[a]})]}function ya(e,t){return bX(e,t.map(function(n){return 1}),t)}function Qa(e,t,n){U(QF(t,n),function(){return e+" supports only inner-most axes for now. Got axes "+t+" and rank-"+n+" input."})}function js(e,t){if(QF(e,t))return null;for(var n=[],r=0;r<t;++r)e.indexOf(r)===-1&&n.push(r);return e.forEach(function(i){return n.push(i)}),n}function kS(e){return e.map(function(t,n){return[n,t]}).sort(function(t,n){return t[1]-n[1]}).map(function(t){return t[0]})}function Us(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}function xX(e,t){var n=e[0].length;e.forEach(function(i,a){U(i.length===n,function(){return"Error in concat"+n+"D: rank of tensors["+a+"] must be the same as the rank of the rest ("+n+")"})}),U(t>=0&&t<n,function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."});var r=e[0];e.forEach(function(i,a){for(var o=0;o<n;o++)U(o===t||i[o]===r[o],function(){return"Error in concat"+n+"D: Shape of tensors["+a+"] ("+i+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+a+"."})})}function Dh(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}function Q(e){var t=Object.keys(e);if(t.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var i=function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];J.startScope(n);try{var s=r.apply(void 0,a);return s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),J.endScope(s),s}catch(u){throw J.endScope(null),u}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}Ct.registerFlag("HAS_WEBGL",function(){return Ct.getNumber("WEBGL_VERSION")>0}),Ct.registerFlag("WEBGL_VERSION",function(){return ZF(2)?2:ZF(1)?1:0}),Ct.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return Ct.get("WEBGL_VERSION")===2}),Ct.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),Ct.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),Ct.registerFlag("WEBGL_PACK",function(){return Ct.getBool("HAS_WEBGL")}),Ct.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return Ct.getBool("WEBGL_PACK")}),Ct.registerFlag("WEBGL_PACK_CLIP",function(){return Ct.getBool("WEBGL_PACK")}),Ct.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),Ct.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return Ct.getBool("WEBGL_PACK")}),Ct.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return Ct.getBool("WEBGL_PACK")}),Ct.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return Ct.getBool("WEBGL_PACK")}),Ct.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return Ct.getBool("WEBGL_PACK")}),Ct.registerFlag("WEBGL_PACK_REDUCE",function(){return Ct.getBool("WEBGL_PACK")}),Ct.registerFlag("WEBGL_LAZILY_UNPACK",function(){return Ct.getBool("WEBGL_PACK")}),Ct.registerFlag("WEBGL_CONV_IM2COL",function(){return Ct.getBool("WEBGL_PACK")}),Ct.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return fX(Ct.getNumber("WEBGL_VERSION"))}),Ct.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return dX(Ct.getNumber("WEBGL_VERSION"))}),Ct.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var e=Ct.getNumber("WEBGL_VERSION");return e===0?0:hX(e)}),Ct.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return Ct.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(e=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))));var e}),Ct.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return pX(Ct.getNumber("WEBGL_VERSION"))}),Ct.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!Ct.getBool("WEBGL_FORCE_F16_TEXTURES")&&Ct.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),Ct.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return gX(Ct.getNumber("WEBGL_VERSION"))}),Ct.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return mX(Ct.getNumber("WEBGL_VERSION"))}),Ct.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return Ct.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),UK=ES;var ri=Q({complex_:function(e,t){var n=j(e,"real","complex"),r=j(t,"imag","complex");return ln(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),J.runKernelFunc(function(i){return i.complex(n,r)},{$real:n,$imag:r})}}),eo=Q({real_:function(e){var t=j(e,"input","real");return J.runKernelFunc(function(n){return n.real(t)},{$input:t})}}),is=Q({imag_:function(e){var t=j(e,"input","imag");return J.runKernelFunc(function(n){return n.imag(t)},{$input:t})}});function Rr(e,t,n){return Of(e,t,ju(e,n),n)}function Of(e,t,n,r){if(r==null&&(r=wm(e)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Ni(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){$F(t);var i=et(t),a=et(n);U(i===a,function(){return"Based on the provided shape, ["+t+"], the tensor should have "+i+" values but has "+a});for(var o=0;o<n.length;++o){var s=n[o],u=o!==n.length-1||s!==et(t.slice(o));U(n[o]===t[o]||!u,function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+t+"). "})}}return Ni(e)||Array.isArray(e)||(e=[e]),t=t||n,e=r!=="string"?FF(e,r,pe().getBool("DEBUG")):tc(e,[],!0),J.makeTensor(e,t,r)}function Ve(e,t){if((Ni(e)&&t!=="string"||Array.isArray(e))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&Ni(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Of(e,[],[],t)}function ba(e,t){Th(e);var n=ju(e,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Of(e,null,n,t)}function Uu(e,t,n){if(Th(e),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var r=ju(e,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Of(e,t,r,n)}function TS(e,t,n){if(Th(e),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var r=ju(e,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Of(e,t,r,n)}function If(e,t,n){if(Th(e),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var r=ju(e,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Of(e,t,r,n)}function wX(e,t,n){if(Th(e),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var r=ju(e,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Of(e,t,r,n)}function _X(e,t,n){if(Th(e),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var r=ju(e,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return Of(e,t=t||r,r,n)}function e3(e,t,n,r){return t===void 0&&(t=!0),J.makeVariable(e,t,n,r)}function Wu(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var n=Wu(e,"float32"),r=Tn(e,"float32");return ri(n,r)}var i=PF(et(e),t);return J.makeTensor(i,e,t)}function Tn(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var n=Tn(e,"float32"),r=Tn(e,"float32");return ri(n,r)}var i=_m(et(e),t);return J.makeTensor(i,e,t)}function Em(e,t,n){return J.runKernelFunc(function(r){return r.fill(e,t,n)},{})}function t3(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");return J.runKernelFunc(function(r){return r.linspace(e,t,n)},{})}function Cm(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n===0)throw new Error("Cannot have a step of zero");if(e===t||e<t&&n<0||t<e&&n>1)return Tn([0],r);var i=_m(Math.abs(Math.ceil((t-e)/n)),r);t<e&&n===1&&(n=-1),i[0]=e;for(var a=1;a<i.length;a++)i[a]=i[a-1]+n;return ba(i,r)}var No=Q({onesLike_:function(e){var t=j(e,"x","onesLike");if(t.dtype==="complex64"){var n=No(eo(t)),r=en(is(t));return ri(n,r)}return J.runKernelFunc(function(i){return i.onesLike(t)},{x:t},function(i,a){return{x:function(){return en(i)}}},"OnesLike")}}),en=Q({zerosLike_:function(e){var t=j(e,"x","zerosLike");return J.runKernelFunc(function(n){return n.zerosLike(t)},{x:t},function(n,r){return{x:function(){return en(n)}}},"ZerosLike")}}),Hi=Q({concat_:function(e,t){t===void 0&&(t=0),U(e.length>=1,function(){return"Pass at least one tensor to concat"});var n=ib(e,"tensors","concat");n[0].dtype==="complex64"&&n.forEach(function(s){if(s.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+s.dtype+". ")}),t=Wr(t,n[0].shape)[0];var r=Dh(n.map(function(s){return s.shape}),t);if(et(r)===0)return Rr([],r);if((n=n.filter(function(s){return s.size>0})).length===1)return n[0];var i=n.map(function(s){return s.shape});xX(i,t);var a=n,o={axis:t};return J.runKernelFunc(function(s){return s.concat(n,t)},a,function(s){var u=i.map(function(l){return l[t]});return ic(s,u,t).map(function(l){return function(){return l}})},"Concat",o)}}),n3=Q({concat1d_:function(e){return Hi(e,0)}}),r3=Q({concat2d_:function(e,t){return Hi(e,t)}}),i3=Q({concat3d_:function(e,t){return Hi(e,t)}}),a3=Q({concat4d_:function(e,t){return Hi(e,t)}}),ic=Q({split_:function(e,t,n){n===void 0&&(n=0);var r,i=j(e,"x","split");return n=Wr(n,i.shape)[0],typeof t=="number"?(U(i.shape[n]%t==0,function(){return"Number of splits must evenly divide the axis."}),r=new Array(t).fill(i.shape[n]/t)):(U(i.shape[n]===t.reduce(function(a,o){return a+o}),function(){return"The sum of sizes must match the size of the axis dimension."}),r=t),J.runKernelFunc(function(a){return a.split(i,r,n)},{$x:i},function(a){return{$x:function(){return Hi(a,n)}}})}});function Ot(e,t,n){return t===void 0&&(t="float32"),t=t||"float32",$F(e),new Sm(e,t,n)}function SX(e,t){t===void 0&&(t=!1),console.log(e.toString(t))}var OS=Q({batchToSpaceND_:function(e,t,n){var r=j(e,"x","batchToSpaceND"),i=t.reduce(function(a,o){return a*o});return U(r.rank>=1+t.length,function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+t.length}),U(n.length===t.length,function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+t.length}),U(r.shape[0]%i==0,function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+i}),J.runKernelFunc(function(a){return a.batchToSpaceND(r,t,n)},{$x:r},function(a){return{$x:function(){return a.spaceToBatchND(t,n)}}})}}),IS=Q({cast_:function(e,t){var n=j(e,"x","cast");if(!FK(t))throw new Error("Failed to cast to unknown dtype "+t);if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");var r={dtype:t};return J.runKernelFunc(function(i){return i.cast(n,t)},{x:n},function(i){return{x:function(){return i.clone()}}},"Cast",r)}}),EX=Q({cumsum_:function(e,t,n,r){t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1);var i=j(e,"x","cumsum"),a=js([t|=0],i.rank),o=i;a!=null&&(o=i.transpose(a));var s=Us(1,i.rank)[0],u=J.runKernelFunc(function(l){return l.cumsum(o,s,n,r)},{permutedX:o},function(l){return{permutedX:function(){return l.cumsum(t,n,!r)}}});return a!=null&&(u=u.transpose(a)),u}}),o3=Q({depthToSpace_:function(e,t,n){n===void 0&&(n="NHWC");var r=j(e,"x","depthToSpace"),i=n==="NHWC"?r.shape[1]:r.shape[2],a=n==="NHWC"?r.shape[2]:r.shape[3],o=n==="NHWC"?r.shape[3]:r.shape[1];return U(i*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+i+" and "+t+`  for depthToSpace with input shape
      `+r.shape}),U(a*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+a+" and "+t+` for depthToSpace with input shape
          `+r.shape}),U(o%(t*t)==0,function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+o+" for depthToSpace with input shape "+r.shape}),J.runKernelFunc(function(s){return s.depthToSpace(r,t,n)},{$x:r})}}),Do=Q({expandDims_:function(e,t){t===void 0&&(t=0);var n=j(e,"x","expandDims",null);U(t<=n.rank,function(){return"Axis must be <= rank of the tensor"});var r=n.shape.slice();return t<0&&(U(-(n.rank+1)<=t,function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"}),t=n.rank+t+1),r.splice(t,0,1),Ws(n,r)}}),Ws=Q({reshape_:function(e,t){var n=j(e,"x","reshape",null);t=DK(t,n.size),U(n.size===et(t),function(){return"new shape and old shape must have the same number of elements."});var r={shape:t};return J.runKernelFunc(function(i){return i.reshape(n,t)},{x:n},function(i){return{x:function(){return i.reshape(n.shape)}}},"Reshape",r)}}),NS=Q({spaceToBatchND_:function(e,t,n){var r=j(e,"x","spaceToBatchND");return U(r.rank>=1+t.length,function(){return"input rank "+r.rank+" should be > than [blockShape] "+t.length}),U(n.length===t.length,function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+t.length}),U(r.shape.reduce(function(i,a,o){return o>0&&o<=t.length?i&&(a+n[o-1][0]+n[o-1][1])%t[o-1]==0:i},!0),function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+t.toString()}),J.runKernelFunc(function(i){return i.spaceToBatchND(r,t,n)},{$x:r},function(i){return{$x:function(){return i.batchToSpaceND(t,n)}}})}}),ab=Q({squeeze_:function(e,t){var n=j(e,"x","squeeze");return Ws(n,Af(n.shape,t).newShape)}}),as=Q({stack_:function(e,t){t===void 0&&(t=0);var n=ib(e,"tensors","stack");if(U(n.length>=1,function(){return"Pass at least one tensor to tf.stack"}),n.length===1)return n[0].expandDims(t);var r=n[0].rank,i=n[0].shape,a=n[0].dtype;U(t<=r,function(){return"Axis must be <= rank of the tensor"}),n.forEach(function(s){ln(i,s.shape,"All tensors passed to stack must have matching shapes")}),n.forEach(function(s){U(a===s.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var o=n.map(function(s){return s.expandDims(t)});return Hi(o,t)}}),Nf=Q({unstack_:function(e,t){t===void 0&&(t=0),t=t||0;var n=j(e,"x","unstack");U(t>=-n.shape.length&&t<n.shape.length,function(){return"Axis = "+t+" is not in [-"+n.shape.length+", "+n.shape.length+")"}),t<0&&(t+=n.shape.length);var r={axis:t};return J.runKernelFunc(function(i){return i.unstack(n,t)},{x:n},function(i){return{x:function(){return as(i,t)}}},"Unpack",r)}}),s3=function(e,t){return tt(this,void 0,void 0,function(){var n,r,i,a,o,s,u,l,c,f;return nt(this,function(d){switch(d.label){case 0:return n=j(e,"x","setdiff1d"),r=j(t,"y","setdiff1d"),U(n.dtype===r.dtype,function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."}),U(n.rank===1,function(){return"x should be 1D tensor, but got x ("+n.shape+")."}),U(r.rank===1,function(){return"y should be 1D tensor, but got y ("+r.shape+")."}),[4,n.data()];case 1:return i=d.sent(),[4,r.data()];case 2:for(a=d.sent(),o=new Set(a),s=0,c=0;c<i.length;c++)o.has(i[c])||s++;for(u=new Sm([s],n.dtype),l=new Sm([s],"int32"),c=0,f=0;c<i.length;c++)o.has(i[c])||(u.values[f]=i[c],l.values[f]=c,f++);return[2,[u.toTensor(),l.toTensor()]]}})})};function DS(e,t,n,r){r===void 0&&(r=!0);var i=[];if(r)(i=i.concat(t.slice(0))).push(e[0]/n),i=i.concat(e.slice(1));else{i=i.concat(e[0]);for(var a=t.length,o=0;o<a;++o)i=i.concat([e[o+1]/t[o],t[o]]);i=i.concat(e.slice(a+1))}return i}function RS(e,t,n){n===void 0&&(n=!0);var r=[];if(n){r.push(t);for(var i=t+1;i<e;++i)i<=2*t?(r.push(i),r.push(i-(t+1))):r.push(i)}else{var a=[],o=[];for(i=1;i<e;++i)i>=2*t+1||i%2==1?o.push(i):a.push(i);r.push.apply(r,a),r.push(0),r.push.apply(r,o)}return r}function FS(e,t,n,r){r===void 0&&(r=!0);var i=[];r?i.push(e[0]/n):i.push(e[0]*n);for(var a=1;a<e.length;++a)a<=t.length?r?i.push(t[a-1]*e[a]):i.push(e[a]/t[a-1]):i.push(e[a]);return i}function CX(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function AX(e,t,n){for(var r=e.slice(0,1),i=0;i<n;++i)r.push(e[i+1]-t[i][0]-t[i][1]);return r}var u3="Add",K3e="AddN",ob="Div",X3e="FusedBatchNorm",sb="SquaredDifference",Y3e="Square",Z3e="Transpose",J3e="NonMaxSuppressionV5",l3="BroadcastTo",c3="OneHot",f3="Identity",d3="Tile",h3="PadV2",Q3e="FromPixels",eMe="MaxPoolWithArgmax",Wt=Q({add_:function(e,t){var n,r=j(e,"a","add"),i=j(t,"b","add");n=ur(r,i),r=n[0],i=n[1];var a={a:r,b:i};return J.runKernelFunc(function(o,s){var u=o.add(r,i);return s([r,i]),u},a,null,u3)}});function ac(e,t){for(var n=e.length,r=[],i=0;i<n;i++){var a=n-1-i,o=e[a]||1;(t[t.length-1-i]||1)>1&&o===1&&r.unshift(a)}return r}function Vr(e,t){for(var n=[],r=0;r<t.length;r++){var i=e[e.length-r-1],a=t.length-r-1,o=t[a];(i==null||i===1&&o>1)&&n.unshift(a)}return n}function Qt(e,t){for(var n=[],r=Math.max(e.length,t.length),i=0;i<r;i++){var a=e[e.length-i-1];a==null&&(a=1);var o=t[t.length-i-1];if(o==null&&(o=1),a===1)n.unshift(o);else if(o===1)n.unshift(a);else{if(a!==o)throw Error("Operands could not be broadcast together with shapes "+e+" and "+t+".");n.unshift(a)}}return n}var Df=Q({abs_:function(e){var t=j(e,"x","abs");return t.dtype==="complex64"?J.runKernelFunc(function(n){return n.complexAbs(t)},{$x:t}):J.runKernelFunc(function(n,r){var i=n.abs(t);return r([t]),i},{x:t},function(n,r){var i=r[0];return{x:function(){return n.mul(i.toFloat().step(-1))}}},"Abs")}}),p3=Q({acos_:function(e){var t=j(e,"x","acos");return J.runKernelFunc(function(n,r){var i=n.acos(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.divStrict(Ve(1).sub(i.toFloat().square()).sqrt()).neg()}}})}}),g3=Q({acosh_:function(e){var t=j(e,"x","acosh");return J.runKernelFunc(function(n,r){var i=n.acosh(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.divStrict(i.toFloat().square().sub(1).sqrt())}}})}}),m3=Q({asin_:function(e){var t=j(e,"x","asin");return J.runKernelFunc(function(n,r){var i=n.asin(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.divStrict(Ve(1).sub(i.toFloat().square()).sqrt())}}})}}),v3=Q({asinh_:function(e){var t=j(e,"x","asinh");return J.runKernelFunc(function(n,r){var i=n.asinh(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.divStrict(Ve(1).add(i.toFloat().square()).sqrt())}}})}}),y3=Q({atan_:function(e){var t=j(e,"x","atan");return J.runKernelFunc(function(n,r){var i=n.atan(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(i.toFloat().square().add(1))}}})}}),b3=Q({atanh_:function(e){var t=j(e,"x","atanh");return J.runKernelFunc(function(n,r){var i=n.atanh(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(Ve(1).sub(i.toFloat().square()))}}})}}),x3=Q({ceil_:function(e){var t=j(e,"x","ceil");return J.runKernelFunc(function(n){return n.ceil(t)},{$x:t},function(n){return{$x:function(){return en(n)}}})}}),xa=Q({clipByValue_:function(e,t,n){var r=j(e,"x","clipByValue");U(t<=n,function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+n+")."});var i=[r],a={min:t,max:n};return J.runKernelFunc(function(o,s){var u=o.clip(r,t,n);return s([r]),u},{x:r},function(o,s){var u=s[0];return{x:function(){return o.where(u.greaterEqual(t).logicalAnd(u.lessEqual(n)),en(o))}}},"ClipByValue",a,i)}}),w3=Q({cos_:function(e){var t=j(e,"x","cos"),n=[t];return J.runKernelFunc(function(r,i){var a=r.cos(t);return i([t]),a},{x:t},function(r,i){var a=i[0];return{x:function(){return a.toFloat().sin().neg().mul(r)}}},"Cos",{},n)}}),_3=Q({cosh_:function(e){var t=j(e,"x","cosh");return J.runKernelFunc(function(n,r){var i=n.cosh(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return i.toFloat().sinh().mulStrict(n)}}})}}),S3=Q({erf_:function(e){var t=j(e,"x","erf");return U(t.dtype==="int32"||t.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),t.dtype==="int32"&&(t=t.toFloat()),J.runKernelFunc(function(n,r){var i=n.erf(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.mul(i.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),E3=Q({exp_:function(e){var t=j(e,"x","exp");return J.runKernelFunc(function(n,r){var i=n.exp(t);return r([i]),i},{x:t},function(n,r){return{x:function(){return n.mulStrict(r[0])}}},"Exp",{},[],[!0])}}),C3=Q({expm1_:function(e){var t=j(e,"x","expm1");return J.runKernelFunc(function(n,r){var i=n.expm1(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.mul(i.exp())}}})}}),MS=Q({floor_:function(e){var t=j(e,"x","floor");return J.runKernelFunc(function(n){return n.floor(t)},{$x:t},function(n){return{$x:function(){return en(n)}}})}}),oc=Q({log_:function(e){var t=j(e,"x","log"),n=[t];return J.runKernelFunc(function(r,i){var a=r.log(t);return i([t]),a},{x:t},function(r,i){var a=i[0];return{x:function(){return r.div(a.toFloat())}}},"Log",{},n)}}),A3=Q({log1p_:function(e){var t=j(e,"x","log1p");return J.runKernelFunc(function(n,r){var i=n.log1p(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(i.add(1))}}})}}),kX=Q({logSigmoid_:function(e){var t=j(e,"x","logSigmoid");return J.runKernelFunc(function(n,r){var i=n.softplus(t.neg()).neg();return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.mul(i.neg().sigmoid())}}})}}),Rf=Q({neg_:function(e){var t=j(e,"x","neg"),n=[t];return J.runKernelFunc(function(r){return r.neg(t)},{x:t},function(r){return{x:function(){return r.neg()}}},"Neg",{},n)}}),k3=Q({reciprocal_:function(e){var t=j(e,"x","reciprocal");return J.runKernelFunc(function(n,r){var i=n.reciprocal(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(i.square().neg())}}})}}),T3=Q({round_:function(e){var t=j(e,"x","round");return J.runKernelFunc(function(n){return n.round(t)},{$x:t},function(n){return{$x:function(){return en(n)}}})}}),PS=Q({rsqrt_:function(e){var t=j(e,"x","rsqrt"),n=[t];return J.runKernelFunc(function(r,i){var a=r.rsqrt(t);return i([t]),a},{x:t},function(r,i){var a=i[0];return{x:function(){return r.div(a.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},n)}}),$S=Q({sigmoid_:function(e){var t=j(e,"x","sigmoid");return J.runKernelFunc(function(n,r){var i=n.sigmoid(t);return r([i]),i},{x:t},function(n,r){var i=r[0];return{x:function(){return n.mul(i.mul(Ve(1).sub(i)))}}},"Sigmoid")}}),O3=Q({sign_:function(e){var t=j(e,"x","sign");return J.runKernelFunc(function(n){return n.sign(t)},{$x:t},function(n){return{$x:function(){return en(n)}}})}}),TX=Q({isNaN_:function(e){var t=j(e,"x","isNaN");return J.runKernelFunc(function(n){return n.isNaN(t)},{$x:t},function(n){return{$x:function(){return en(n)}}})}}),OX=Q({isInf_:function(e){var t=j(e,"x","isInf");return J.runKernelFunc(function(n){return n.isInf(t)},{$x:t},function(n){return{$x:function(){return en(n)}}})}}),IX=Q({isFinite_:function(e){var t=j(e,"x","isFinite");return J.runKernelFunc(function(n){return n.isFinite(t)},{$x:t},function(n){return{$x:function(){return en(n)}}})}}),I3=Q({sin_:function(e){var t=j(e,"x","sin"),n=[t];return J.runKernelFunc(function(r,i){var a=r.sin(t);return i([t]),a},{x:t},function(r,i){var a=i[0];return{x:function(){return a.toFloat().cos().mul(r)}}},"Sin",{},n)}}),N3=Q({sinh_:function(e){var t=j(e,"x","sinh");return J.runKernelFunc(function(n,r){var i=n.sinh(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return i.toFloat().cosh().mulStrict(n)}}})}}),ub=Q({softplus_:function(e){var t=j(e,"x","softplus");return J.runKernelFunc(function(n,r){var i=n.softplus(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.mul(i.sigmoid())}}})}}),lb=Q({sqrt_:function(e){var t=j(e,"x","sqrt");return J.runKernelFunc(function(n,r){var i=n.sqrt(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(i.toFloat().sqrt().mul(2))}}})}}),NX=Q({step_:function(e,t){t===void 0&&(t=0);var n=j(e,"x","step");return J.runKernelFunc(function(r){return r.step(n,t)},{$x:n},function(r){return{$x:function(){return en(r)}}})}}),D3=Q({tan_:function(e){var t=j(e,"x","tan");return J.runKernelFunc(function(n,r){var i=n.tan(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return n.div(i.cos().square())}}})}}),LS=Q({tanh_:function(e){var t=j(e,"x","tanh");return J.runKernelFunc(function(n,r){var i=n.tanh(t);return r([i]),i},{x:t},function(n,r){var i=r[0];return{x:function(){return Ve(1).sub(i.square()).mulStrict(n)}}},"Tanh",{},null,[!0])}}),DX=Q({addStrict_:function(e,t){var n=j(e,"a","addStrict"),r=j(t,"b","addStrict");return ln(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),R3=Q({atan2_:function(e,t){var n,r=j(e,"a","atan2"),i=j(t,"b","atan2");n=ur(r,i),r=n[0],i=n[1];var a=Qt(r.shape,i.shape);return J.runKernelFunc(function(o,s){var u=o.atan2(r,i);return s([r,i]),u},{$a:r,$b:i},function(o,s){var u=s[0],l=s[1];return{$a:function(){var c=Wt(u.square(),l.square()),f=o.mul(l.div(c)),d=Vr(u.shape,a);return d.length>0&&(f=f.sum(d)),f.reshape(u.shape)},$b:function(){var c=Wt(u.square(),l.square()),f=Rf(o.mul(u.div(c))),d=Vr(l.shape,a);return d.length>0&&(f=f.sum(d)),f.reshape(l.shape)}}})}}),RX=Q({divStrict_:function(e,t){var n=j(e,"a","div"),r=j(t,"b","div");return ln(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),BS=Q({floorDiv_:function(e,t){var n,r=j(e,"a","floorDiv"),i=j(t,"b","floorDiv");n=ur(r,i),r=n[0],i=n[1];var a=Qt(r.shape,i.shape);return J.runKernelFunc(function(o,s){var u=o.floorDiv(r,i);return s([r,i]),u},{a:r,b:i},function(o,s){var u=s[0],l=s[1];return{a:function(){var c=o.div(l.toFloat()),f=Vr(u.shape,a);return f.length>0?c.sum(f).reshape(u.shape):c},b:function(){var c=o.mul(u.toFloat()),f=Vr(l.shape,a);f.length>0&&(c=c.sum(f).reshape(l.shape));var d=l.square();return c.div(d.toFloat()).neg()}}},"FloorDiv")}}),Vu=Q({maximum_:function(e,t){var n,r=j(e,"a","maximum"),i=j(t,"b","maximum");return n=ur(r,i),r=n[0],i=n[1],r.dtype==="bool"&&(r=r.toInt(),i=i.toInt()),Qt(r.shape,i.shape),J.runKernelFunc(function(a,o){var s=a.maximum(r,i);return o([r,i]),s},{a:r,b:i},function(a,o){var s=o[0],u=o[1];return{a:function(){return a.mul(s.greaterEqual(u).toFloat())},b:function(){return a.mul(s.less(u).toFloat())}}},"Maximum")}}),FX=Q({maximumStrict_:function(e,t){var n=j(e,"a","maximumStrict"),r=j(t,"b","maximumStrict");return ln(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),Am=Q({minimum_:function(e,t){var n,r=j(e,"a","minimum"),i=j(t,"b","minimum");return n=ur(r,i),r=n[0],i=n[1],r.dtype==="bool"&&(r=r.toInt(),i=i.toInt()),Qt(r.shape,i.shape),J.runKernelFunc(function(a,o){var s=a.minimum(r,i);return o([r,i]),s},{a:r,b:i},function(a,o){var s=o[0],u=o[1];return{a:function(){return a.mul(s.lessEqual(u).toFloat())},b:function(){return a.mul(s.greater(u).toFloat())}}},"Minimum")}}),MX=Q({minimumStrict_:function(e,t){var n=j(e,"a","minimumStrict"),r=j(t,"b","minimumStrict");return ln(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),F3=Q({mod_:function(e,t){var n,r=j(e,"a","mod"),i=j(t,"b","mod");n=ur(r,i),r=n[0],i=n[1];var a=Qt(r.shape,i.shape);return J.runKernelFunc(function(o,s){var u=o.mod(r,i);return s([r,i]),u},{$a:r,$b:i},function(o,s){var u=s[0],l=s[1];return{$a:function(){var c=Vr(u.shape,a);return c.length>0?o.sum(c).reshape(u.shape):o},$b:function(){var c=o.mul(u.div(l).floor().neg()),f=Vr(l.shape,a);return f.length>0?c.sum(f).reshape(l.shape):c}}})}}),PX=Q({modStrict_:function(e,t){var n=j(e,"a","modStrict"),r=j(t,"b","modStrict");return ln(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),rt=Q({mul_:function(e,t){var n,r=j(e,"a","mul"),i=j(t,"b","mul");n=ur(r,i),r=n[0],i=n[1];var a=Qt(r.shape,i.shape);return J.runKernelFunc(function(o,s){var u=o.multiply(r,i);return s([r,i]),u},{a:r,b:i},function(o,s){var u=s[0],l=s[1];return{a:function(){var c=o.mul(l.toFloat()),f=Vr(u.shape,a);return f.length>0?c.sum(f).reshape(u.shape):c},b:function(){var c=o.mul(u.toFloat()),f=Vr(l.shape,a);return f.length>0?c.sum(f).reshape(l.shape):c}}},"Mul")}}),zS=Q({mulStrict_:function(e,t){var n=j(e,"a","mul"),r=j(t,"b","mul");return ln(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),km=Q({pow_:function(e,t){var n,r=j(e,"base","pow"),i=j(t,"exp","pow");n=ur(r,i),r=n[0],i=n[1];var a=Qt(r.shape,i.shape),o=[r,i];return J.runKernelFunc(function(s,u){var l=s.pow(r,i);return u([r,i,l]),l},{a:r,b:i},function(s,u){var l=u[0],c=u[1],f=u[2];return{a:function(){var d=c.toFloat(),h=s.mul(d.mul(l.pow(d.sub(Ve(1))))),p=Vr(l.shape,a);return p.length>0&&(h=h.sum(p)),h.reshape(l.shape)},b:function(){var d=l.greater(0),h=l.log().where(d,en(l)),p=s.mul(f.mul(h)),g=Vr(c.shape,a);return g.length>0&&(p=p.sum(g)),p.reshape(c.shape)}}},"Pow",{},o,[!0])}}),$X=Q({powStrict_:function(e,t){return ln(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}}),LX=Q({squaredDifferenceStrict_:function(e,t){var n=j(e,"a","squaredDifferenceStrict"),r=j(t,"b","squaredDifferenceStrict");return ln(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),Er=Q({sub_:function(e,t){var n,r=j(e,"a","sub"),i=j(t,"b","sub");n=ur(r,i),r=n[0],i=n[1];var a=Qt(r.shape,i.shape);return J.runKernelFunc(function(o){return o.subtract(r,i)},{a:r,b:i},function(o){return{a:function(){var s=o,u=Vr(r.shape,a);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=o,u=Vr(i.shape,a);return u.length>0&&(s=s.sum(u)),s.neg().reshape(i.shape)}}},"Sub")}}),BX=Q({subStrict_:function(e,t){var n=j(e,"a","subStrict"),r=j(t,"b","subStrict");return ln(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),Cr=Q({div_:function(e,t){var n,r=j(e,"a","div"),i=j(t,"b","div");if(n=ur(r,i),r=n[0],i=n[1],r.dtype==="int32"&&i.dtype==="int32")return BS(r,i);var a={a:r,b:i};return J.runKernelFunc(function(o,s){var u=o.realDivide(r,i);return s([r,i]),u},a,null,ob,{})}});function M3(e,t){if(e.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(t.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>e.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+e.rank);if(e.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+e.shape+".");for(var n=t.shape,r=n[n.length-1],i=1,a=0;a<n.length-1;++a)i*=n[a];var o=e.shape,s=n.slice();s.pop();var u=1;for(a=r;a<e.rank;++a)u*=o[a],s.push(o[a]);var l=Ja(e.shape).map(function(c){return c/u}).concat([1]).slice(0,r);return[s,i,u,l]}var tMe=Object.freeze({prepareAndValidate:M3}),P3=30;function jS(e){return e<=P3?e:pS(e,Math.floor(Math.sqrt(e)))}function zX(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,i=t.rank>1?t.rank-1:1,a="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+t.shape+", shape: "+e+", sliceDim: "+r+", and batchDim: "+i+".";if(n.rank<i)throw new Error(a+" update.rank < "+i+". ");if(e.length<r+(n.rank-i))throw new Error(a+" Output shape length < "+(r+(n.rank-i)));if(n.rank!==i+e.length-r)throw new Error(a+" update.rank != "+(i+e.length-r));for(var o=0;o<i;++o)if(n.shape[o]!==t.shape[o])throw new Error(a+" updates.shape["+o+"] ("+n.shape[o]+") != indices.shape["+o+"] ("+t.shape[o]+").");for(o=0;o<n.rank-i;++o)if(n.shape[o+i]!==e[o+r])throw new Error(a+" updates.shape["+(o+i)+"] ("+n.shape[o+i]+") != shape["+(o+i)+"] ("+e[o+i]+")")}function jX(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+e.rank+".");if(t.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(n.length===0){if(t.size===0)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(e.size===0)throw new Error("Updates specified for empty output. updates shape: "+e.shape)}zX(n,t,e)}function cb(e,t,n){for(var r=t.shape.length,i=r>1?t.shape[r-1]:1,a=n.length,o=1,s=i;s<a;++s)o*=n[s];var u=i<1?1:i;return{sliceRank:i,numUpdates:et(t.shape)/u,sliceSize:o,strides:Ja(n.slice(0,i)).concat([1]),outputSize:et(n)}}var nMe=Object.freeze({validateUpdateShape:zX,validateInput:jX,calculateShapes:cb});function UX(e,t,n){U(e.rank===t.length,function(){return"Error in slice"+e.rank+"D: Length of begin "+t+" must match the rank of the array ("+e.rank+")."}),U(e.rank===n.length,function(){return"Error in slice"+e.rank+"D: Length of size "+n+" must match the rank of the array ("+e.rank+")."});for(var r=function(a){U(t[a]+n[a]<=e.shape[a],function(){return"Error in slice"+e.rank+"D: begin["+a+"] + size["+a+"] ("+(t[a]+n[a])+") would overflow input.shape["+a+"] ("+e.shape[a]+")"})},i=0;i<e.rank;++i)r(i)}function $3(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function US(e,t,n){for(var r=[],i=0;i<e.length;i++)r[i]=Math.ceil((t[i]-e[i])/n[i]);return r}function WX(e,t,n,r,i){var a=t[i],o=n[i]||1;(e&1<<i||a==null)&&(a=o>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[i];return a<0&&(a+=s),a=dS(0,a,s-1)}function VX(e,t,n,r,i){var a=t[i],o=n[i]||1;(e&1<<i||a==null)&&(a=o>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[i];return a<0&&(a+=s),a=o>0?dS(0,a,s):dS(-1,a,s-1)}function L3(e,t,n){for(var r=n.length,i=0;i<n.length;i++)if(n[i]>1){r=i;break}for(i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function B3(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}var rMe=Object.freeze({assertParamsValid:UX,maskToAxes:$3,computeOutShape:US,startForAxis:WX,stopForAxis:VX,isSliceContinous:L3,computeFlatOffset:B3});function iMe(e){return U(Tf(e),function(){return"The f passed in grad(f) must be a function"}),function(t,n){var r=j(t,"x","tf.grad",null),i=n!=null?j(n,"dy","tf.grad"):null;return J.tidy(function(){var a=J.gradients(function(){return e(r)},[r],i),o=a.value,s=a.grads;return i!=null&&ln(o.shape,i.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),WS(s),s[0]})}}function aMe(e){return U(Tf(e),function(){return"The f passed in grads(f) must be a function"}),function(t,n){U(Array.isArray(t),function(){return"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s"});var r=ib(t,"args","tf.grads",null),i=n!=null?j(n,"dy","tf.grads"):null;return J.tidy(function(){var a=J.gradients(function(){return e.apply(void 0,r)},r,i),o=a.value,s=a.grads;return i!=null&&ln(o.shape,i.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),WS(s),s})}}function oMe(e){return U(Tf(e),function(){return"The f passed in valueAndGrad(f) must be a function"}),function(t,n){U(t instanceof Ht,function(){return"The x passed in valueAndGrad(f)(x) must be a tensor"}),U(n==null||n instanceof Ht,function(){return"The dy passed in valueAndGrad(f)(x, dy) must be a tensor"});var r=J.gradients(function(){return e(t)},[t],n),i=r.grads,a=r.value;return WS(i),{grad:i[0],value:a}}}function sMe(e){return U(Tf(e),function(){return"The f passed in valueAndGrads(f) must be a function"}),function(t,n){U(Array.isArray(t)&&t.every(function(i){return i instanceof Ht}),function(){return"The args passed in valueAndGrads(f)(args) must be array of tensors"}),U(n==null||n instanceof Ht,function(){return"The dy passed in valueAndGrads(f)(args, dy) must be a tensor"});var r=J.gradients(function(){return e.apply(void 0,t)},t,n);return n!=null&&ln(r.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),WS(r.grads),r}}function qX(e,t){U(Tf(e),function(){return"The f passed in variableGrads(f) must be a function"}),U(t==null||Array.isArray(t)&&t.every(function(c){return c instanceof Xy}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var n=t!=null;if(!n)for(var r in t=[],J.registeredVariables)t.push(J.registeredVariables[r]);var i=n?t.filter(function(c){return!c.trainable}):null,a=t.length;U((t=t.filter(function(c){return c.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+a+" variables is trainable."});var o=J.gradients(e,t,null,!0),s=o.value,u=o.grads;U(u.some(function(c){return c!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),U(s.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"});var l={};return t.forEach(function(c,f){u[f]!=null&&(l[c.name]=u[f])}),i!=null&&i.forEach(function(c){return l[c.name]=null}),{value:s,grads:l}}function fb(e){return J.customGrad(e)}function WS(e){if(e.filter(function(t){return t==null}).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}var Rh=Q({softmax_:function(e,t){t===void 0&&(t=-1);var n=j(e,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+t);return J.runKernelFunc(function(r,i){var a=r.softmax(n,t);return i([a]),a},{logits:n},function(r,i){var a=i[0],o=r.mul(a);return{logits:function(){return o.sub(o.sum([t],!0).mul(a))}}},"Softmax",{dim:t},[],[!0])}}),VS=Q({logSoftmax_:function(e,t){t===void 0&&(t=-1);var n=j(e,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+t);return fb(function(r,i){var a=r.max(t,!0),o=r.sub(a),s=o.toFloat().sub(o.exp().sum(t,!0).log());return i([s]),{value:s,gradFunc:function(u,l){var c=l[0].exp();return u.sub(u.sum(t,!0).mul(c))}}})(n)}}),cn=Q({transpose_:function(e,t){var n=j(e,"x","transpose");if(t==null&&(t=n.shape.map(function(i,a){return a}).reverse()),U(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+t+"."}),t.forEach(function(i){U(i>=0&&i<n.rank,function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+t})}),n.rank<=1)return n.clone();var r={perm:t};return J.runKernelFunc(function(i){return i.transpose(n,t)},{x:n},null,"Transpose",r)}}),z3=function(){function e(t,n){this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return e.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},e.prototype.set=function(t,n){this.dataIdsCount++,this.data.set(t,n)},e.prototype.has=function(t){return this.data.has(t)},e.prototype.delete=function(t){return this.dataIdsCount--,this.data.delete(t)},e.prototype.numDataIds=function(){return this.dataIdsCount},e}(),j3=function(){function e(){}return e.prototype.time=function(t){return fe("time")},e.prototype.read=function(t){return fe("read")},e.prototype.readSync=function(t){return fe("readSync")},e.prototype.numDataIds=function(){return fe("numDataIds")},e.prototype.disposeData=function(t){return fe("disposeData")},e.prototype.write=function(t,n,r){return fe("write")},e.prototype.move=function(t,n,r,i){return fe("move")},e.prototype.memory=function(){return fe("memory")},e.prototype.floatPrecision=function(){return fe("floatPrecision")},e.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},e.prototype.batchMatMul=function(t,n,r,i){return fe("batchMatMul")},e.prototype.fusedBatchMatMul=function(t){return t.a,t.b,t.transposeA,t.transposeB,t.bias,t.activation,t.preluActivationWeights,fe("fusedBatchMatMul")},e.prototype.slice=function(t,n,r){return fe("slice")},e.prototype.stridedSlice=function(t,n,r,i){return fe("stridedSlice")},e.prototype.unstack=function(t,n){return fe("unstack")},e.prototype.reverse=function(t,n){return fe("reverse")},e.prototype.concat=function(t,n){return fe("concat")},e.prototype.neg=function(t){return fe("neg")},e.prototype.add=function(t,n){return fe("add")},e.prototype.addN=function(t){return fe("addN")},e.prototype.subtract=function(t,n){return fe("subtract")},e.prototype.multiply=function(t,n){return fe("multiply")},e.prototype.realDivide=function(t,n){return fe("realDivide")},e.prototype.floorDiv=function(t,n){return fe("floorDiv")},e.prototype.sum=function(t,n){return fe("sum")},e.prototype.prod=function(t,n){return fe("prod")},e.prototype.unsortedSegmentSum=function(t,n,r){return fe("unsortedSegmentSum")},e.prototype.argMin=function(t,n){return fe("argMin")},e.prototype.argMax=function(t,n){return fe("argMax")},e.prototype.equal=function(t,n){return fe("equal")},e.prototype.notEqual=function(t,n){return fe("notEqual")},e.prototype.less=function(t,n){return fe("less")},e.prototype.lessEqual=function(t,n){return fe("lessEqual")},e.prototype.greater=function(t,n){return fe("greater")},e.prototype.greaterEqual=function(t,n){return fe("greaterEqual")},e.prototype.logicalNot=function(t){return fe("logicalNot")},e.prototype.logicalAnd=function(t,n){return fe("logicalAnd")},e.prototype.logicalOr=function(t,n){return fe("logicalOr")},e.prototype.where=function(t){return fe("where")},e.prototype.select=function(t,n,r){return fe("select")},e.prototype.topk=function(t,n,r){return fe("topk")},e.prototype.min=function(t,n){return fe("min")},e.prototype.minimum=function(t,n){return fe("minimum")},e.prototype.mod=function(t,n){return fe("mod")},e.prototype.max=function(t,n){return fe("max")},e.prototype.maximum=function(t,n){return fe("maximum")},e.prototype.all=function(t,n){return fe("all")},e.prototype.any=function(t,n){return fe("any")},e.prototype.squaredDifference=function(t,n){return fe("squaredDifference")},e.prototype.ceil=function(t){return fe("ceil")},e.prototype.floor=function(t){return fe("floor")},e.prototype.round=function(t){return fe("round")},e.prototype.sign=function(t){return fe("sign")},e.prototype.isNaN=function(t){return fe("isNaN")},e.prototype.isInf=function(t){return fe("isInf")},e.prototype.isFinite=function(t){return fe("isFinite")},e.prototype.pow=function(t,n){return fe("pow")},e.prototype.exp=function(t){return fe("exp")},e.prototype.expm1=function(t){return fe("expm1")},e.prototype.softmax=function(t,n){return fe("softmax")},e.prototype.log=function(t){return fe("log")},e.prototype.log1p=function(t){return fe("log1p")},e.prototype.sqrt=function(t){return fe("sqrt")},e.prototype.rsqrt=function(t){return fe("rsqrt")},e.prototype.square=function(t){return fe("square")},e.prototype.reciprocal=function(t){return fe("reciprocal")},e.prototype.relu=function(t){return fe("relu")},e.prototype.relu6=function(t){return fe("relu6")},e.prototype.prelu=function(t,n){return fe("prelu")},e.prototype.elu=function(t){return fe("elu")},e.prototype.eluDer=function(t,n){return fe("eluDer")},e.prototype.selu=function(t){return fe("selu")},e.prototype.int=function(t){return fe("int")},e.prototype.clip=function(t,n,r){return fe("clip")},e.prototype.abs=function(t){return fe("abs")},e.prototype.complexAbs=function(t){return fe("complexAbs")},e.prototype.sigmoid=function(t){return fe("sigmoid")},e.prototype.softplus=function(t){return fe("softplus")},e.prototype.sin=function(t){return fe("sin")},e.prototype.cos=function(t){return fe("cos")},e.prototype.tan=function(t){return fe("tan")},e.prototype.asin=function(t){return fe("asin")},e.prototype.acos=function(t){return fe("acos")},e.prototype.atan=function(t){return fe("atan")},e.prototype.atan2=function(t,n){return fe("atan2")},e.prototype.sinh=function(t){return fe("sinh")},e.prototype.cosh=function(t){return fe("cosh")},e.prototype.tanh=function(t){return fe("tanh")},e.prototype.asinh=function(t){return fe("asinh")},e.prototype.acosh=function(t){return fe("acosh")},e.prototype.atanh=function(t){return fe("atanh")},e.prototype.erf=function(t){return fe("erf")},e.prototype.step=function(t,n){return fe("step")},e.prototype.fusedConv2d=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,fe("fusedConv2d")},e.prototype.conv2d=function(t,n,r){return fe("conv2d")},e.prototype.conv2dDerInput=function(t,n,r){return fe("conv2dDerInput")},e.prototype.conv2dDerFilter=function(t,n,r){return fe("conv2dDerFilter")},e.prototype.fusedDepthwiseConv2D=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,fe("fusedDepthwiseConv2D")},e.prototype.depthwiseConv2D=function(t,n,r){return fe("depthwiseConv2D")},e.prototype.depthwiseConv2DDerInput=function(t,n,r){return fe("depthwiseConv2DDerInput")},e.prototype.depthwiseConv2DDerFilter=function(t,n,r){return fe("depthwiseConv2DDerFilter")},e.prototype.conv3d=function(t,n,r){return fe("conv3d")},e.prototype.conv3dDerInput=function(t,n,r){return fe("conv3dDerInput")},e.prototype.conv3dDerFilter=function(t,n,r){return fe("conv3dDerFilter")},e.prototype.maxPool=function(t,n){return fe("maxPool")},e.prototype.maxPoolBackprop=function(t,n,r,i){return fe("maxPoolBackprop")},e.prototype.avgPool=function(t,n){return fe("avgPool")},e.prototype.avgPoolBackprop=function(t,n,r){return fe("avgPoolBackprop")},e.prototype.avgPool3d=function(t,n){return fe("avgPool3d")},e.prototype.avgPool3dBackprop=function(t,n,r){return fe("avgPool3dBackprop")},e.prototype.maxPool3d=function(t,n){return fe("maxPool3d")},e.prototype.maxPool3dBackprop=function(t,n,r,i){return fe("maxPool3dBackprop")},e.prototype.reshape=function(t,n){return fe("reshape")},e.prototype.cast=function(t,n){return fe("cast")},e.prototype.tile=function(t,n){return fe("tile")},e.prototype.pad=function(t,n,r){return fe("pad")},e.prototype.transpose=function(t,n){return fe("transpose")},e.prototype.gather=function(t,n,r){return fe("gather")},e.prototype.gatherND=function(t,n){return fe("gatherND")},e.prototype.scatterND=function(t,n,r){return fe("scatterND")},e.prototype.batchToSpaceND=function(t,n,r){return fe("batchToSpaceND")},e.prototype.spaceToBatchND=function(t,n,r){return fe("spaceToBatchND")},e.prototype.resizeBilinear=function(t,n,r,i){return fe("resizeBilinear")},e.prototype.resizeBilinearBackprop=function(t,n,r){return fe("resizeBilinearBackprop")},e.prototype.resizeNearestNeighbor=function(t,n,r,i){return fe("resizeNearestNeighbor")},e.prototype.resizeNearestNeighborBackprop=function(t,n,r){return fe("resizeNearestNeighborBackprop")},e.prototype.batchNormalization=function(t,n,r,i,a,o){return fe("batchNormalization")},e.prototype.localResponseNormalization4D=function(t,n,r,i,a){return fe("localResponseNormalization4D")},e.prototype.LRNGrad=function(t,n,r,i,a,o,s){return fe("LRNGrad")},e.prototype.multinomial=function(t,n,r,i){return fe("multinomial")},e.prototype.oneHot=function(t,n,r,i){return fe("oneHot")},e.prototype.cumsum=function(t,n,r,i){return fe("cumsum")},e.prototype.nonMaxSuppression=function(t,n,r,i,a){return fe("nonMaxSuppression")},e.prototype.fft=function(t){return fe("fft")},e.prototype.ifft=function(t){return fe("ifft")},e.prototype.complex=function(t,n){return fe("complex")},e.prototype.real=function(t){return fe("real")},e.prototype.imag=function(t){return fe("imag")},e.prototype.cropAndResize=function(t,n,r,i,a,o){return fe("cropAndResize")},e.prototype.depthToSpace=function(t,n,r){return fe("depthToSpace")},e.prototype.split=function(t,n,r){return fe("split")},e.prototype.sparseToDense=function(t,n,r,i){return fe("sparseToDense")},e.prototype.diag=function(t){return fe("diag")},e.prototype.fill=function(t,n,r){return fe("fill")},e.prototype.onesLike=function(t){return fe("onesLike")},e.prototype.zerosLike=function(t){return fe("zerosLike")},e.prototype.linspace=function(t,n,r){return fe("linspace")},e.prototype.dispose=function(){return fe("dispose")},e}();function fe(e){throw new Error("'"+e+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function Ff(e,t,n,r,i,a,o){o===void 0&&(o="channelsLast");var s,u=qS(t),l=u[0],c=u[1];if(o==="channelsLast")s=[l,c,e[3],e[3]];else{if(o!=="channelsFirst")throw new Error("Unknown dataFormat "+o);s=[l,c,e[1],e[1]]}return Mf(e,s,n,r,i,a,!1,o)}function db(e,t,n,r,i,a,o){o===void 0&&(o="NDHWC");var s,u,l=W3(t),c=l[0],f=l[1],d=l[2];if(o==="NDHWC")u="channelsLast",s=[c,f,d,e[4],e[4]];else{if(o!=="NCDHW")throw new Error("Unknown dataFormat "+o);u="channelsFirst",s=[c,f,d,e[1],e[1]]}return hb(e,s,n,r,i,!1,u,a)}function Mf(e,t,n,r,i,a,o,s){o===void 0&&(o=!1),s===void 0&&(s="channelsLast");var u=[-1,-1,-1,-1],l=u[0],c=u[1],f=u[2],d=u[3];if(s==="channelsLast")l=e[0],c=e[1],f=e[2],d=e[3];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);l=e[0],d=e[1],c=e[2],f=e[3]}var h,p=t[0],g=t[1],m=t[3],v=qS(n),y=v[0],b=v[1],x=qS(r),w=x[0],S=x[1],C=Tm(p,w),_=Tm(g,S),E=function(N,O,D,L,W,G,K,ee){var ce,he,Oe;if(typeof N=="number"){ce={top:N,bottom:N,left:N,right:N,type:N===0?"VALID":"NUMBER"};var Te=function(ae,Y,M,B,R){B==null&&(B=U3(ae,Y,M));var X=ae[0],ge=ae[1],xe=pb((X-Y+2*B)/M+1,R);U(gr(xe),function(){return"The output # of rows ("+xe+") must be an integer. Change the stride and/or zero pad parameters"});var ze=pb((ge-Y+2*B)/M+1,R);return U(gr(ze),function(){return"The output # of columns ("+ze+") must be an integer. Change the stride and/or zero pad parameters"}),[xe,ze]}([O,D],G,L,N,ee);he=Te[0],Oe=Te[1]}else if(N==="same"){he=Math.ceil(O/L),Oe=Math.ceil(D/W);var De=Math.max(0,(he-1)*L+G-O),me=Math.max(0,(Oe-1)*W+K-D),P=Math.floor(De/2),F=De-P,V=Math.floor(me/2);ce={top:P,bottom:F,left:V,right:me-V,type:"SAME"}}else{if(N!=="valid")throw Error("Unknown padding parameter: "+N);ce={top:0,bottom:0,left:0,right:0,type:"VALID"},he=Math.ceil((O-G+1)/L),Oe=Math.ceil((D-K+1)/W)}return{padInfo:ce,outHeight:he,outWidth:Oe}}(i,c,f,y,b,C,_,a),A=E.padInfo,k=E.outHeight,T=E.outWidth,I=o?m*d:m;return s==="channelsFirst"?h=[l,I,k,T]:s==="channelsLast"&&(h=[l,k,T,I]),{batchSize:l,dataFormat:s,inHeight:c,inWidth:f,inChannels:d,outHeight:k,outWidth:T,outChannels:I,padInfo:A,strideHeight:y,strideWidth:b,filterHeight:p,filterWidth:g,effectiveFilterHeight:C,effectiveFilterWidth:_,dilationHeight:w,dilationWidth:S,inShape:e,outShape:h,filterShape:t}}function hb(e,t,n,r,i,a,o,s){a===void 0&&(a=!1),o===void 0&&(o="channelsLast");var u=[-1,-1,-1,-1,-1],l=u[0],c=u[1],f=u[2],d=u[3],h=u[4];if(o==="channelsLast")l=e[0],c=e[1],f=e[2],d=e[3],h=e[4];else{if(o!=="channelsFirst")throw new Error("Unknown dataFormat "+o);l=e[0],h=e[1],c=e[2],f=e[3],d=e[4]}var p,g=t[0],m=t[1],v=t[2],y=t[4],b=W3(n),x=b[0],w=b[1],S=b[2],C=W3(r),_=C[0],E=C[1],A=C[2],k=Tm(g,_),T=Tm(m,E),I=Tm(v,A),N=function(K,ee,ce,he,Oe,Te,De,me,P,F,V){var ae,Y,M,B;if(typeof K=="number"){ae={top:K,bottom:K,left:K,right:K,front:K,back:K,type:K===0?"VALID":"NUMBER"};var R=function(Zt,mn,Hn,ti,er,Dn){er==null&&(er=U3(Zt,mn,ti));var Jo=Zt[0],Ka=Zt[1],jl=Zt[2],Ts=pb((Jo-mn+2*er)/ti+1,Dn);U(gr(Ts),function(){return"The output # of depths ("+Ts+") must be an integer. Change the stride and/or zero pad parameters"});var Os=pb((Ka-mn+2*er)/ti+1,Dn);U(gr(Os),function(){return"The output # of rows ("+Os+") must be an integer. Change the stride and/or zero pad parameters"});var Ul=pb((jl-mn+2*er)/ti+1,Dn);return U(gr(Ul),function(){return"The output # of columns ("+Ul+") must be an integer. Change the stride and/or zero pad parameters"}),[Ts,Os,Ul,Hn]}([ee,ce,he,1],me,1,Oe,K,V);Y=R[0],M=R[1],B=R[2]}else if(K==="same"){Y=Math.ceil(ee/Oe),M=Math.ceil(ce/Te),B=Math.ceil(he/De);var X=(Y-1)*Oe+me-ee,ge=(M-1)*Te+P-ce,xe=(B-1)*De+F-he,ze=Math.floor(X/2),Ke=X-ze,Ze=Math.floor(ge/2),Bt=ge-Ze,Je=Math.floor(xe/2);ae={top:Ze,bottom:Bt,left:Je,right:xe-Je,front:ze,back:Ke,type:"SAME"}}else{if(K!=="valid")throw Error("Unknown padding parameter: "+K);ae={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},Y=Math.ceil((ee-me+1)/Oe),M=Math.ceil((ce-P+1)/Te),B=Math.ceil((he-F+1)/De)}return{padInfo:ae,outDepth:Y,outHeight:M,outWidth:B}}(i,c,f,d,x,w,S,k,T,I,s),O=N.padInfo,D=N.outDepth,L=N.outHeight,W=N.outWidth,G=a?y*h:y;return o==="channelsFirst"?p=[l,G,D,L,W]:o==="channelsLast"&&(p=[l,D,L,W,G]),{batchSize:l,dataFormat:o,inDepth:c,inHeight:f,inWidth:d,inChannels:h,outDepth:D,outHeight:L,outWidth:W,outChannels:G,padInfo:O,strideDepth:x,strideHeight:w,strideWidth:S,filterDepth:g,filterHeight:m,filterWidth:v,effectiveFilterDepth:k,effectiveFilterHeight:T,effectiveFilterWidth:I,dilationDepth:_,dilationHeight:E,dilationWidth:A,inShape:e,outShape:p,filterShape:t}}function U3(e,t,n,r){r===void 0&&(r=1);var i=Tm(t,r);return Math.floor((e[0]*(n-1)-n+i)/2)}function qS(e){return typeof e=="number"?[e,e,e]:e.length===2?[e[0],e[1],1]:e}function W3(e){return typeof e=="number"?[e,e,e]:e}function Tm(e,t){return t<=1?e:e+(e-1)*(t-1)}function pb(e,t){if(!t)return e;switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode "+t)}}function Fh(e){var t=qS(e),n=t[0],r=t[1],i=t[2];return n===1&&r===1&&i===1}function Gi(e,t){return Fh(e)||Fh(t)}function HS(e){if(e==="NHWC")return"channelsLast";if(e==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+e)}function V3(e,t,n){if(t==="complex64"){if(e.dtype==="complex64")return e.clone();var r=Tn(e.shape),i=e.toFloat(),a=n.complex(i,r);return r.dispose(),i.dispose(),a}if(!MK(e.dtype,t))return J.makeTensorFromDataId(e.dataId,e.shape,t);if(e.dtype==="complex64"){var o=n.real(e);return a=o.cast(t),o.dispose(),a}if(t==="int32")return n.int(e);if(t==="bool"){var s=Ve(0,e.dtype);return a=n.notEqual(e,s),s.dispose(),a}throw new Error("Error in Cast: failed to cast "+e.dtype+" to "+t)}function GS(e,t){return J.makeTensorFromDataId(e.dataId,t,e.dtype)}function q3(e,t,n){var r=(t-e)/(n-1),i=_m(n,"float32");i[0]=e;for(var a=1;a<i.length;a++)i[a]=i[a-1]+r;return ba(i,"float32")}var uMe=Object.freeze({castTensor:V3,reshapeTensor:GS,linspaceImpl:q3,upcastType:yi,axesAreInnerMostDims:QF,combineLocations:bX,computeOutAndReduceShapes:Di,expandShapeToKeepDim:ya,assertAxesAreInnerMostDims:Qa,getAxesPermutation:js,getUndoAxesPermutation:kS,getInnerMostAxes:Us,getBroadcastDims:ac,getReductionAxes:Vr,assertAndGetBroadcastShape:Qt,assertParamsConsistent:xX,computeOutShape:Dh,computePool2DInfo:Ff,computePool3DInfo:db,computeConv2DInfo:Mf,computeConv3DInfo:hb,computeDefaultPad:U3,tupleValuesAreOne:Fh,eitherStridesOrDilationsAreOne:Gi,convertConv2DDataFormat:HS,PARALLELIZE_THRESHOLD:P3,computeOptimalWindowSize:jS});function H3(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+e.length+", imag: "+t.length+".");for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function HX(e,t){return{real:e[2*t],imag:e[2*t+1]}}function lMe(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function cMe(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}function fMe(e,t,n){var r=function(a,o,s){return function(u,l,c){for(var f=0,d=u.length,h=0,p=!1;f<d;){var g=c(l,u[h=f+(d-f>>>1)]);g>0?f=h+1:(d=h,p=!g)}return p?f:-f-1}(a,o,s||dMe)}(e,t,n),i=r<0?-(r+1):r;e.splice(i,0,t)}function dMe(e,t){return e>t?1:e<t?-1:0}function G3(e,t,n,r,i){return GX(e,t,n,r,i,0).selectedIndices}function K3(e,t,n,r,i,a){var o=GX(e,t,n,r,i,a);return o.numValidOutputs.dispose(),{selectedIndices:o.selectedIndices,selectedScores:o.selectedScores}}function GX(e,t,n,r,i,a,o,s){s===void 0&&(s=!1);for(var u=Array.from(t).map(function(x,w){return{score:x,boxIndex:w,suppressBeginIndex:0}}).filter(function(x){return x.score>i}).sort(KX),l=a>0?-.5/a:0,c=[],f=[];c.length<n&&u.length>0;){var d=u.pop(),h=d.score,p=d.boxIndex,g=d.suppressBeginIndex;if(h<i)break;for(var m=!1,v=c.length-1;v>=g;--v){var y=hMe(e,p,c[v]);if(y>=r){m=!0;break}if(d.score=d.score*pMe(r,l,y),d.score<=i)break}d.suppressBeginIndex=c.length,m||(d.score===h?(c.push(p),f.push(d.score)):d.score>i&&fMe(u,d,KX))}var b=c.length;return s&&(c.fill(0,b),f.fill(0,b)),{selectedIndices:ba(c,"int32"),selectedScores:ba(f,"float32"),numValidOutputs:Ve(b,"int32")}}function hMe(e,t,n){var r=e.subarray(4*t,4*t+4),i=e.subarray(4*n,4*n+4),a=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),l=Math.min(i[0],i[2]),c=Math.min(i[1],i[3]),f=Math.max(i[0],i[2]),d=Math.max(i[1],i[3]),h=(s-a)*(u-o),p=(f-l)*(d-c);if(h<=0||p<=0)return 0;var g=Math.max(a,l),m=Math.max(o,c),v=Math.min(s,f),y=Math.min(u,d),b=Math.max(v-g,0)*Math.max(y-m,0);return b/(h+p-b)}function pMe(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function KX(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function XX(e,t,n){var r=new Array(e.rank).fill(0),i=e.shape.slice();return t.map(function(a){i[n]=a;var o=e.slice(r,i);return r[n]+=a,o})}function YX(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];var i=Ot(n,e.dtype);for(r=0;r<i.values.length;++r){for(var a=i.indexToLoc(r),o=new Array(e.rank),s=0;s<o.length;s++)o[s]=a[s]%e.shape[s];var u=e.locToIndex(o);i.values[r]=e.values[u]}return i.toTensor()}function ZX(e,t,n,r,i){for(var a=t[t.length-1],o=[e.length/a,a],s=o[0],u=o[1],l=Ih(n,s*r),c=Ih("int32",s*r),f=0;f<s;f++){for(var d=f*u,h=e.subarray(d,d+u),p=[],g=0;g<h.length;g++)p.push({value:h[g],index:g});p.sort(function(x,w){return w.value-x.value});var m=f*r,v=l.subarray(m,m+r),y=c.subarray(m,m+r);for(g=0;g<r;g++)v[g]=p[g].value,y[g]=p[g].index}var b=t.slice();return b[b.length-1]=r,[Rr(l,b,n),Rr(c,b,"int32")]}function X3(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);var i=Ot(e,"int32"),a=Ot([n.length,e.length],"int32");for(r=0;r<n.length;r++){var o=i.indexToLoc(n[r]),s=r*e.length;a.values.set(o,s)}return a.toTensor()}var gMe=function(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map(function(i,a){return"T"+a});var n=[];this.variableNames.forEach(function(i){n.push("float v"+i+" = get"+i+"AtOutCoords();")});var r=this.variableNames.map(function(i){return"v"+i}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        float result = `+r+`;
        setOutput(result);
      }
    `},mMe=function(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map(function(i,a){return"T"+a});var n=[];this.variableNames.forEach(function(i){n.push("vec4 v"+i+" = get"+i+"AtOutCoords();")});var r=this.variableNames.map(function(i){return"v"+i}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        vec4 result = `+r+`;
        setOutput(result);
      }
    `},vMe=function(e,t,n){this.variableNames=["A"];var r=e.windowSize,i=e.batchSize,a=e.inSize,o=Math.ceil(a/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];var s=t==="max"?">":"<",u=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+r+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+r+`; i++) {
          int inIdx = `+u+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+s+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function JX(e,t){return["x","y","z","w","u","v"].slice(0,t).map(function(n){return e+"."+n})}function to(e,t){return t===1?[e]:JX(e,t)}function Ki(){var e,t,n,r,i,a,o,s,u,l;return pe().getNumber("WEBGL_VERSION")===2?(e="#version 300 es",t="in",n="out",r="in",i="texture",a="outputColor",o="out vec4 outputColor;",s=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,u="",l=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(e="",t="attribute",n="varying",r="varying",i="texture2D",a="gl_FragColor",o="",s=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,u=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,l=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:i,output:a,defineOutput:o,defineSpecialNaN:s,defineSpecialInf:u,defineRound:l}}function Mh(e,t,n){n===void 0&&(n="index");var r=Ja(t);return r.map(function(i,a){return"int "+e[a]+" = "+n+" / "+i+"; "+(a===r.length-1?"int "+e[a+1]+" = "+n+" - "+e[a]+" * "+i:"index -= "+e[a]+" * "+i)+";"}).join("")}function Y3(e){var t=Ja(e).map(function(n){return n.toString()});return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+t[0]+" + coords.y * "+t[1]+` + coords.z;
  }
`}var QX=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function yMe(e,t,n,r){var i=[];e.forEach(function(h){var p=et(h.shapeInfo.logicalShape);h.shapeInfo.isUniform?i.push("uniform float "+h.name+(p>1?"["+p+"]":"")+";"):(i.push("uniform sampler2D "+h.name+";"),i.push("uniform int offset"+h.name+";"))});var a,o,s=i.join(`
`),u=e.map(function(h){return function(p,g,m){m===void 0&&(m=!1);var v="";v+=m?eY(p):Om(p);var y=p.shapeInfo.logicalShape,b=g.logicalShape;return y.length<=b.length&&(v+=m?function(x,w){var S,C=x.name,_=C.charAt(0).toUpperCase()+C.slice(1),E="get"+_+"AtOutCoords",A=x.shapeInfo.logicalShape.length,k=w.logicalShape.length,T=ac(x.shapeInfo.logicalShape,w.logicalShape),I=Zn(k),N=k-A,O=["x","y","z","w","u","v"];S=A===0?"":k<2&&T.length>=1?"coords = 0;":T.map(function(ce){return"coords."+O[ce+N]+" = 0;"}).join(`
`);var D="";D=k<2&&A>0?"coords":x.shapeInfo.logicalShape.map(function(ce,he){return"coords."+O[he+N]}).join(", ");var L="return outputValue;",W=et(x.shapeInfo.logicalShape)===1,G=et(w.logicalShape)===1;if(A!==1||W||G){if(W&&!G)L=k===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(T.length){var K=A-2,ee=A-1;T.indexOf(K)>-1&&T.indexOf(ee)>-1?L="return vec4(outputValue.x);":T.indexOf(K)>-1?L="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":T.indexOf(ee)>-1&&(L="return vec4(outputValue.xx, outputValue.zz);")}}else L=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+E+`() {
      `+I+` coords = getOutputCoords();
      `+S+`
      vec4 outputValue = get`+_+"("+D+`);
      `+L+`
    }
  `}(p,g):function(x,w){var S=x.name,C=S.charAt(0).toUpperCase()+S.slice(1),_="get"+C+"AtOutCoords",E=w.texShape,A=x.shapeInfo.texShape,k=x.shapeInfo.logicalShape.length,T=w.logicalShape.length;if(!x.shapeInfo.isUniform&&k===T&&x.shapeInfo.flatOffset==null&&Ur(A,E))return`
      float `+_+`() {
        return sampleTexture(`+S+`, resultUV);
      }
    `;var I,N=Zn(T),O=ac(x.shapeInfo.logicalShape,w.logicalShape),D=T-k,L=["x","y","z","w","u","v"];I=k===0?"":T<2&&O.length>=1?"coords = 0;":O.map(function(G){return"coords."+L[G+D]+" = 0;"}).join(`
`);var W="";return W=T<2&&k>0?"coords":x.shapeInfo.logicalShape.map(function(G,K){return"coords."+L[K+D]}).join(", "),`
    float `+_+`() {
      `+N+` coords = getOutputCoords();
      `+I+`
      return get`+C+"("+W+`);
    }
  `}(p,g)),v}(h,t,r)}).join(`
`),l=t.texShape,c=Ki(),f=function(h){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+h.texture2D+`(textureSampler, uv).r;
    }
  `}(c),d=function(h){return h.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+h.varyingFs+` vec2 resultUV;
    `+h.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+h.defineSpecialNaN+`
    `+h.defineSpecialInf+`
    `+h.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+bMe+`
    `+xMe+`
    `+wMe+`
  `}(c);return t.isPacked?(a=function(h,p){switch(h.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(x,w){var S=[Math.ceil(w[0]/2),Math.ceil(w[1]/2)];return S[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+S[1]+`.0);
      }
    `:S[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+S[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+S[0]+", "+S[1]+`));
      return 2 * (resTexRC.x * `+S[1]+` + resTexRC.y);
    }
  `}(0,p);case 2:return function(x,w){var S=[Math.ceil(w[0]/2),Math.ceil(w[1]/2)];if(Ur(x,w))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+S[0]+", "+S[1]+`));
      }
    `;var C=Math.ceil(x[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+S[0]+", "+S[1]+`));

      int index = resTexRC.x * `+S[1]+` + resTexRC.y;
      int r = 2 * (index / `+C+`);
      int c = imod(index, `+C+`) * 2;

      return ivec2(r, c);
    }
  `}(h,p);case 3:return g=h,m=p,v=[Math.ceil(m[0]/2),Math.ceil(m[1]/2)],y=Math.ceil(g[2]/2),b=y*Math.ceil(g[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+v[0]+", "+v[1]+`));
      int index = resTexRC.x * `+v[1]+` + resTexRC.y;

      int b = index / `+b+`;
      index -= b * `+b+`;

      int r = 2 * (index / `+y+`);
      int c = imod(index, `+y+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return function(x,w){for(var S=[Math.ceil(w[0]/2),Math.ceil(w[1]/2)],C=Math.ceil(x[x.length-1]/2),_=C*Math.ceil(x[x.length-2]/2),E=_,A="",k="b, r, c",T=2;T<x.length-1;T++)E*=x[x.length-T-1],A=`
      int b`+T+" = index / "+E+`;
      index -= b`+T+" * "+E+`;
    `+A,k="b"+T+", "+k;return`
    ivec`+x.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+S[0]+", "+S[1]+`));
      int index = resTexRC.x * `+S[1]+` + resTexRC.y;

      `+A+`

      int b = index / `+_+`;
      index -= b * `+_+`;

      int r = 2 * (index / `+C+`);
      int c = imod(index, `+C+`) * 2;

      return ivec`+x.length+"("+k+`);
    }
  `}(h,p)}var g,m,v,y,b}(t.logicalShape,l),o=function(h){return`
    void setOutput(vec4 val) {
      `+h.output+` = val;
    }
  `}(c)):(a=function(h,p){switch(h.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(v,y){return y[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+y[1]+`.0);
      }
    `:y[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+y[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      return resTexRC.x * `+y[1]+` + resTexRC.y;
    }
  `}(0,p);case 2:return function(v,y){return Ur(v,y)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+y[0]+", "+y[1]+`));
      }
    `:v[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+y[0]+", "+y[1]+`));
        int index = resTexRC.x * `+y[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:v[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+y[0]+", "+y[1]+`));
        int index = resTexRC.x * `+y[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      int r = index / `+v[1]+`;
      int c = index - r * `+v[1]+`;
      return ivec2(r, c);
    }
  `}(h,p);case 3:return g=p,m=Mh(["r","c","d"],h),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+g[0]+", "+g[1]+`));
      int index = resTexRC.x * `+g[1]+` + resTexRC.y;
      `+m+`
      return ivec3(r, c, d);
    }
  `;case 4:return function(v,y){var b=Mh(["r","c","d","d2"],v);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      `+b+`
      return ivec4(r, c, d, d2);
    }
  `}(h,p);case 5:return function(v,y){var b=Mh(["r","c","d","d2","d3"],v);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+y[0]+`,
                             `+y[1]+`));

      int index = resTexRC.x * `+y[1]+` + resTexRC.y;

      `+b+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}(h,p);case 6:return function(v,y){var b=Mh(["r","c","d","d2","d3","d4"],v);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;

      `+b+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}(h,p);default:throw new Error(h.length+"-D output sampling is not yet supported")}var g,m}(t.logicalShape,l),o=function(h){return`
    void setOutput(float val) {
      `+h.output+` = vec4(val, 0, 0, 0);
    }
  `}(c)),r&&(d+=_Me),[d,f,o,s,a,u,n].join(`
`)}function Om(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(n){var r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return"float "+i+"() {return "+r+";}";var a=n.shapeInfo.texShape,o=a[0],s=a[1];if(o===1&&s===1)return`
      float `+i+`() {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=n.shapeInfo.texShape,l=u[0],c=u[1],f=Ph(r);return`
    float `+i+`() {
      vec2 uv = uvFromFlat(`+l+", "+c+", "+f+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);case 1:return function(n){var r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return`
      float `+i+`(int index) {
        `+Im(n)+`
      }
    `;var a=n.shapeInfo.texShape,o=a[0],s=a[1];if(s===1&&o===1)return`
      float `+i+`(int index) {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=Ph(r);return s===1?`
      float `+i+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+u+") + 0.5) / "+o+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `:o===1?`
      float `+i+`(int index) {
        vec2 uv = vec2((float(index + `+u+") + 0.5) / "+s+`.0, 0.5);
        return sampleTexture(`+r+`, uv);
      }
    `:`
    float `+i+`(int index) {
      vec2 uv = uvFromFlat(`+o+", "+s+", index + "+u+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);case 2:return function(n){var r=n.shapeInfo.logicalShape,i=n.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=n.shapeInfo.texShape;if(o!=null&&Ur(r,o)){var s=o[0],u=o[1];return`
    float `+a+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+u+".0, "+s+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `}var l=Af(r),c=l.newShape,f=l.keptDims,d=c;if(d.length<r.length){var h=Nm(n,d);return`
      `+Om(h)+`
      float `+a+`(int row, int col) {
        return `+a+"("+Dm(["row","col"],f)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+a+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+r[1]+`, 1)));
        `+Im(n)+`
      }
    `;var p=o[0],g=o[1],m=Ph(i);return g===1?`
    float `+a+`(int row, int col) {
      float index = dot(vec3(row, col, `+m+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+p+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `:p===1?`
    float `+a+`(int row, int col) {
      float index = dot(vec3(row, col, `+m+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+g+`.0, 0.5);
      return sampleTexture(`+i+`, uv);
    }
  `:`
  float `+a+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+r[1]+" + col + "+m+`;
    vec2 uv = uvFromFlat(`+p+", "+g+`, index);
    return sampleTexture(`+i+`, uv);
  }
`}(e);case 3:return function(n){var r=n.shapeInfo.logicalShape,i=n.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=r[1]*r[2],s=r[2],u=Af(r),l=u.newShape,c=u.keptDims,f=l;if(f.length<r.length){var d=Nm(n,f);return`
        `+Om(d)+`
        float `+a+`(int row, int col, int depth) {
          return `+a+"("+Dm(["row","col","depth"],c)+`);
        }
      `}if(n.shapeInfo.isUniform)return`
      float `+a+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+o+", "+s+`, 1)));
        `+Im(n)+`
      }
    `;var h=n.shapeInfo.texShape,p=h[0],g=h[1],m=n.shapeInfo.flatOffset;if(g===o&&m==null)return`
        float `+a+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+s+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+g+".0, "+p+`.0);
          return sampleTexture(`+i+`, uv);
        }
      `;if(g===s&&m==null)return`
    float `+a+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+r[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+g+".0, "+p+`.0);
      return sampleTexture(`+i+`, uv);
    }
  `;var v=Ph(i);return`
      float `+a+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+o+" + col * "+s+" + depth + "+v+`;
        vec2 uv = uvFromFlat(`+p+", "+g+`, index);
        return sampleTexture(`+i+`, uv);
      }
  `}(e);case 4:return function(n){var r=n.shapeInfo.logicalShape,i=n.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=r[3],s=r[2]*o,u=r[1]*s,l=Af(r),c=l.newShape,f=l.keptDims;if(c.length<r.length){var d=Nm(n,c);return`
      `+Om(d)+`
      float `+a+`(int row, int col, int depth, int depth2) {
        return `+a+"("+Dm(["row","col","depth","depth2"],f)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+a+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+u+", "+s+", "+o+`, 1)));
        `+Im(n)+`
      }
    `;var h=n.shapeInfo.flatOffset,p=n.shapeInfo.texShape,g=p[0],m=p[1];if(m===u&&h==null)return`
      float `+a+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+s+", "+o+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+m+".0, "+g+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(m===o&&h==null)return`
      float `+a+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+r[1]*r[2]+", "+r[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+m+".0, "+g+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var v=Ph(i);return`
    float `+a+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+u+" + col * "+s+` +
          depth * `+o+` + depth2;
      vec2 uv = uvFromFlat(`+g+", "+m+", index + "+v+`);
      return sampleTexture(`+i+`, uv);
    }
  `}(e);case 5:return function(n){var r=n.shapeInfo.logicalShape,i=n.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=r[4],s=r[3]*o,u=r[2]*s,l=r[1]*u,c=Af(r),f=c.newShape,d=c.keptDims;if(f.length<r.length){var h=Nm(n,f);return`
      `+Om(h)+`
      float `+a+`(int row, int col, int depth, int depth2, int depth3) {
        return `+a+"("+Dm(["row","col","depth","depth2","depth3"],d)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+a+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+l+", "+u+", "+s+", "+o+`)) +
          depth3;
        `+Im(n)+`
      }
    `;var p=n.shapeInfo.flatOffset,g=n.shapeInfo.texShape,m=g[0],v=g[1];if(v===l&&p==null)return`
      float `+a+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+u+", "+s+", "+o+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+v+".0, "+m+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(v===o&&p==null)return`
      float `+a+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]+`,
               `+r[2]*r[3]+", "+r[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+v+".0, "+m+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var y=Ph(i);return`
    float `+a+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+l+" + col * "+u+" + depth * "+s+` +
          depth2 * `+o+" + depth3 + "+y+`;
      vec2 uv = uvFromFlat(`+m+", "+v+`, index);
      return sampleTexture(`+i+`, uv);
    }
  `}(e);case 6:return function(n){var r=n.shapeInfo.logicalShape,i=n.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),o=Af(r),s=o.newShape,u=o.keptDims;if(s.length<r.length){var l=Nm(n,s);return`
      `+Om(l)+`
      float `+a+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+a+"("+Dm(["row","col","depth","depth2","depth3","depth4"],u)+`);
      }
    `}var c=r[5],f=r[4]*c,d=r[3]*f,h=r[2]*d,p=r[1]*h;if(n.shapeInfo.isUniform)return`
      float `+a+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+p+", "+h+", "+d+", "+f+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+c+`, 1)));
        `+Im(n)+`
      }
    `;var g=n.shapeInfo.flatOffset,m=n.shapeInfo.texShape,v=m[0],y=m[1];if(y===p&&g==null)return`
      float `+a+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+h+", "+d+", "+f+", "+c+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+y+".0, "+v+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;if(y===c&&g==null)return`
      float `+a+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]*r[4]+`,
               `+r[2]*r[3]*r[4]+`,
               `+r[3]*r[4]+`,
               `+r[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+y+".0, "+v+`.0);
        return sampleTexture(`+i+`, uv);
      }
    `;var b=Ph(i);return`
    float `+a+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+p+" + col * "+h+" + depth * "+d+` +
          depth2 * `+f+" + depth3 * "+c+" + depth4 + "+b+`;
      vec2 uv = uvFromFlat(`+v+", "+y+`, index);
      return sampleTexture(`+i+`, uv);
    }
  `}(e);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function eY(e){var t,n,r;switch(e.shapeInfo.logicalShape.length){case 0:return t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=Ki(),`
    vec4 `+n+`() {
      return `+r.texture2D+"("+t+`, halfCR);
    }
  `;case 1:return function(i){var a=i.name,o="get"+a.charAt(0).toUpperCase()+a.slice(1),s=i.shapeInfo.texShape,u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],l=Ki();return`
    vec4 `+o+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+u[0]+", "+u[1]+`, index);
      return `+l.texture2D+"("+a+`, uv);
    }
  `}(e);case 2:return function(i){var a=i.shapeInfo.logicalShape,o=i.name,s="get"+o.charAt(0).toUpperCase()+o.slice(1),u=i.shapeInfo.texShape,l=u[0],c=u[1],f=Ki();if(u!=null&&Ur(a,u))return`
      vec4 `+s+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+c+".0, "+l+`.0);

        return `+f.texture2D+"("+o+`, uv);
      }
    `;var d=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],h=Math.ceil(a[1]/2);return`
    vec4 `+s+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+h+", "+d[0]+", "+d[1]+`, row, col);
      return `+f.texture2D+"("+o+`, uv);
    }
  `}(e);case 3:return function(i){var a=i.shapeInfo.logicalShape,o=i.name,s="get"+o.charAt(0).toUpperCase()+o.slice(1),u=i.shapeInfo.texShape,l=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];if(a[0]===1){var c=a.slice(1),f=Nm(i,c);return`
        `+eY(f)+`
        vec4 `+s+`(int b, int row, int col) {
          return `+s+"("+Dm(["b","row","col"],[1,2])+`);
        }
      `}var d=l[0],h=l[1],p=Math.ceil(a[2]/2),g=p*Math.ceil(a[1]/2),m=Ki();return`
    vec4 `+s+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+d+", "+h+", "+g+", "+p+`, b, row, col);
      return `+m.texture2D+"("+o+`, uv);
    }
  `}(e);default:return function(i){for(var a=i.shapeInfo.logicalShape,o=a.length,s=i.name,u="get"+s.charAt(0).toUpperCase()+s.slice(1),l=i.shapeInfo.texShape,c=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],f=c[0],d=c[1],h=Math.ceil(a[o-1]/2),p=h*Math.ceil(a[o-2]/2),g="int b, int row, int col",m="b * "+p+" + (row / 2) * "+h+" + (col / 2)",v=2;v<o-1;v++)g="int b"+v+", "+g,p*=a[o-v-1],m="b"+v+" * "+p+" + "+m;var y=Ki();return`
    vec4 `+u+"("+g+`) {
      int index = `+m+`;
      int texR = index / `+d+`;
      int texC = index - texR * `+d+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+d+", "+f+`);
      return `+y.texture2D+"("+s+`, uv);
    }
  `}(e)}}var bMe=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,xMe=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,wMe=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,_Me=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function Ph(e){return"offset"+e}function Im(e){var t=e.name,n=et(e.shapeInfo.logicalShape);return n<2?"return "+t+";":`
    for (int i = 0; i < `+n+`; i++) {
      if (i == index) {
        return `+t+`[i];
      }
    }
  `}function Zn(e){if(e<=1)return"int";if(e===2)return"ivec2";if(e===3)return"ivec3";if(e===4)return"ivec4";if(e===5)return"ivec5";if(e===6)return"ivec6";throw Error("GPU for rank "+e+" is not yet supported")}function Nm(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function Dm(e,t){return t.map(function(n){return e[n]}).join(", ")}var SMe=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,U(e.length>2,function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."});var i=e[e.length-1],a=Math.ceil(i/t);this.outputShape=e.slice(0,-1),a>1&&this.outputShape.push(a),r||this.variableNames.push("bestIndicesA");var o,s,u=this.outputShape,l=u.length,c=Zn(l),f=to("coords",l);if(a===1){var d=Zn(s=l+1);o=`
        `+d+" sourceLocR = "+d+"("+f.join()+`, 0);
        ++`+f[l-1]+`;
        `+d+" sourceLocG = "+d+"("+f.join()+`, 0);
        ++`+f[l-2]+`;
        `+d+" sourceLocA = "+d+"("+f.join()+`, 0);
        --`+f[l-1]+`;
        `+d+" sourceLocB = "+d+"("+f.join()+`, 0);
        --`+f[l-2]+";"}else s=l,o=`
        `+c+` sourceLocR = coords;
        ++`+f[l-1]+`;
        `+c+` sourceLocG = coords;
        ++`+f[l-2]+`;
        `+c+` sourceLocA = coords;
        --`+f[l-1]+`;
        `+c+` sourceLocB = coords;
        --`+f[l-2]+";";var h=["x","y","z","w","u","v"].slice(0,s),p="."+h[s-1],g=h.map(function(_){return"int "+_}),m=to("sourceLocR",s-1).concat("inIdx.r"),v=to("sourceLocG",s-1).concat("inIdx.g"),y=to("sourceLocB",s-1).concat("inIdx.b"),b=to("sourceLocA",s-1).concat("inIdx.a"),x=n==="max"?"greaterThan":"lessThan",w=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+m.join()+`),
                             getBestIndicesAChannel(`+v.join()+`),
                             getBestIndicesAChannel(`+y.join()+`),
                             getBestIndicesAChannel(`+b.join()+")));",S=`vec4(
            getAChannel(`+m.join()+`),
            hasNextCol ? getAChannel(`+v.join()+`) : 0.,
            hasNextRow ? getAChannel(`+y.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+b.join()+") : 0.)",C=r?"":`
      float getBestIndicesAChannel(`+g.join()+`) {
        return getChannel(getBestIndicesA(`+h.join()+`),
                                          vec2(`+h.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+g.join()+`) {
        return getChannel(getA(`+h.join()+`),
                               vec2(`+h.slice(-2).join()+`));
      }
      `+C+`
      void main() {
        `+c+` coords = getOutputCoords();
        bool hasNextCol = `+f[l-1]+" < "+(u[l-1]-1)+`;
        bool hasNextRow = `+f[l-2]+" < "+(u[l-2]-1)+`;
        `+o+`
        ivec4 srcIdx = ivec4(sourceLocR`+p+", sourceLocG"+p+`,
          sourceLocB`+p+", sourceLocA"+p+") * "+t+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+S+`;

        for (int i = 0; i < `+t+`; i++) {
          inIdx = srcIdx;
          `+w+`
          vec4 candidate = `+S+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+x+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},EMe=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,a=e.dilationHeight,o=e.dilationWidth,s=e.effectiveFilterHeight,u=e.effectiveFilterWidth,l=s-1-e.padInfo.top,c=u-1-e.padInfo.left,f=1/(t*n);this.userCode=`
      const ivec2 pads = ivec2(`+l+", "+c+`);
      const float avgMultiplier = float(`+f+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+s+`;
            wR += `+a+`) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+u+`;
            wC+= `+o+`) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},CMe=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,f=e.effectiveFilterHeight,d=e.effectiveFilterWidth,h=c-1-e.padInfo.front,p=f-1-e.padInfo.top,g=d-1-e.padInfo.left,m=1/(t*n*r);this.userCode=`
      const ivec3 pads = ivec3(`+h+", "+p+", "+g+`);
      const float avgMultiplier = float(`+m+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+c+`;
            wD += `+s+`) {
          float dyD = float(dyDCorner + wD) / `+i+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+f+`;
              wR += `+u+`) {
            float dyR = float(dyRCorner + wR) / `+a+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+d+`;
                wC += `+l+`) {
              float dyC = float(dyCCorner + wC) / `+o+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},AMe=function(e,t,n,r,i,a){this.outputShape=[],this.variableNames=["x","mean","variance"],Qt(e,t),Qt(e,n);var o="0.0";r!=null&&(Qt(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var s="1.0";i!=null&&(Qt(e,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+o+`;
        float scale = `+s+`;
        float inv = scale * inversesqrt(variance + float(`+a+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},kMe=function(e,t,n,r,i,a){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Qt(e,t),Qt(e,n);var o="vec4(0.0)";r!=null&&(Qt(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var s="vec4(1.0)";i!=null&&(Qt(e,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = `+o+`;
        vec4 scale = `+s+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+a+`));

        setOutput((x - mean) * inv + offset);
      }
    `},TMe="return areal * breal - aimag * bimag;",OMe="return areal * bimag + aimag * breal;",tY=function(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Qt(t,n),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+e+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},Z3="return a + b;",J3="return a - b;",nY="return a * b;",IMe=`
if (a == b) {
  return 1.0;
};
return a / b;`,rY="return (a < 0.) ? b * a : a;",Ar=function(e,t,n){this.variableNames=["A","B"],this.outputShape=Qt(t,n),this.userCode=`
      float binaryOperation(float a, float b) {
        `+e+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},NMe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,iY=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,qu=function(e,t,n,r){r===void 0&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Qt(t,n);var i=this.outputShape.length,a="";if(r)if(i===0||et(this.outputShape)===1)a=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(a=`
          `+Zn(i)+` coords = getOutputCoords();
        `,i===1)a+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var o=to("coords",i);a+=`
            bool nextRowOutOfBounds =
              (`+o[i-2]+" + 1) >= "+this.outputShape[i-2]+`;
            bool nextColOutOfBounds =
              (`+o[i-1]+" + 1) >= "+this.outputShape[i-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+e+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+a+`

        setOutput(result);
      }
    `},DMe=function(){function e(t){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,n){var r=this;return function(i,a){r.minLoc==null&&(r.minLoc=i.getUniformLocationNoThrow(a,"minVal"),r.maxLoc=i.getUniformLocationNoThrow(a,"maxVal")),i.gl.uniform1f(r.minLoc,t),i.gl.uniform1f(r.maxLoc,n)}},e}(),RMe=function(){function e(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,n){var r=this;return function(i,a){r.minLoc==null&&(r.minLoc=i.getUniformLocationNoThrow(a,"minVal"),r.maxLoc=i.getUniformLocationNoThrow(a,"maxVal")),i.gl.uniform1f(r.minLoc,t),i.gl.uniform1f(r.maxLoc,n)}},e}(),FMe=function(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},MMe=function(e){this.outputShape=[],this.outputShape=Dh(e,1),this.variableNames=e.map(function(s,u){return"T"+u});var t=new Array(e.length-1);t[0]=e[0][1];for(var n=1;n<t.length;n++)t[n]=t[n-1]+e[n][1];var r=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<t.length;n++){var i=t[n-1];r.push("else if (yC < "+t[n]+") setOutput(getT"+n+"(yR, yC-"+i+"));")}var a=t.length,o=t[t.length-1];r.push("else setOutput(getT"+a+"(yR, yC-"+o+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+r.join(`
        `)+`
      }
    `},PMe=function(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Dh(e,t);var n=this.outputShape,r=n.length,i=Zn(r),a=to("coords",r),o=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map(function(m,v){return"T"+v});var s=new Array(e.length-1);s[0]=e[0][t];for(var u=1;u<s.length;u++)s[u]=s[u-1]+e[u][t];var l=o[t],c=o.slice(-2),f=o.join(),d="if ("+l+" < "+s[0]+`) {
        return getChannel(
            getT0(`+f+"), vec2("+c.join()+`));
        }`;for(u=1;u<s.length;u++){var h=s[u-1];d+=`
        if (`+l+" < "+s[u]+"  && "+l+" >= "+s[u-1]+`) {
          return getChannel(
            getT`+u+"("+KS(o,l,h)+`),
            vec2(`+KS(c,l,h)+`));
        }`}var p=s.length,g=s[s.length-1];d+=`
        return getChannel(
          getT`+p+"("+KS(o,l,g)+`),
          vec2(`+KS(c,l,g)+"));",this.userCode=`
      float getValue(`+o.map(function(m){return"int "+m})+`) {
        `+d+`
      }

      void main() {
        `+i+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+a+`), 0., 0., 0.);

        `+a[r-1]+" = "+a[r-1]+` + 1;
        if (`+a[r-1]+" < "+n[r-1]+`) {
          result.g = getValue(`+a+`);
        }

        `+a[r-2]+" = "+a[r-2]+` + 1;
        if (`+a[r-2]+" < "+n[r-2]+`) {
          result.a = getValue(`+a+`);
        }

        `+a[r-1]+" = "+a[r-1]+` - 1;
        if (`+a[r-2]+" < "+n[r-2]+` &&
            `+a[r-1]+" < "+n[r-1]+`) {
          result.b = getValue(`+a+`);
        }
        setOutput(result);
      }
    `};function KS(e,t,n){var r=e.indexOf(t);return e.map(function(i,a){return a===r?i+" - "+n:i}).join()}var $Me=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,a=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+i+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              if (`+a+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},LMe=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,a=e.dataFormat==="channelsLast",o=t-1-e.padInfo.top,s=n-1-e.padInfo.left,u=a?1:2,l=a?2:3,c=a?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+o+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+c+`];

        ivec2 dyCorner = ivec2(coords[`+u+"], coords["+l+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {

              if (`+a+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},BMe=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,i=e.padInfo.front,a=e.padInfo.top,o=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yF = 0; yF < `+e.outDepth+`; yF++) {
            int xF = wF + yF * `+t+" - "+i+`;

            if (xF < 0 || xF >= `+e.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+e.outHeight+`; yR++) {
              int xR = wR + yR * `+n+" - "+a+`;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+e.outWidth+`; yC++) {
                int xC = wC + yC * `+r+" - "+o+`;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},zMe=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,s=t-1-e.padInfo.front,u=n-1-e.padInfo.top,l=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+s+", "+u+", "+l+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+t+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+i+`.0;

          if (dyF < 0.0 || dyF >= `+e.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+t+` - 1 - wF;

          for (int wR = 0; wR < `+n+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+a+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+n+` - 1 - wR;

            for (int wC = 0; wC < `+r+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+o+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+r+` - 1 - wC;

              for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},jMe=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,a=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+a+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+i+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},UMe=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,a=t-1-e.padInfo.top,o=n-1-e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+a+", "+o+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+i+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+s+`; dm++) {
              int d2 = d1 * `+s+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},aY=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var i=e.padInfo.top,a=e.padInfo.left,o=e.strideHeight,s=e.strideWidth,u=e.dilationHeight,l=e.dilationWidth,c=e.filterHeight,f=e.filterWidth,d=4*Math.floor(e.inChannels/4),h=e.inChannels%4,p=e.dataFormat==="channelsLast",g=p?1:2,m=p?2:3,v=p?3:1,y="",b="";n&&(y=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,b="result = activation(result);");var x=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+y+`

      const ivec2 strides = ivec2(`+o+", "+s+`);
      const ivec2 pads = ivec2(`+i+", "+a+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+v+`];

        ivec2 xRCCorner =
            ivec2(coords[`+g+"], coords["+m+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+c+`; wR++) {
          int xR = xRCorner + wR * `+u+`;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+f+`; wC++) {
            int xC = xCCorner + wC * `+l+`;

            if (xC < 0 || xC >= `+e.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+d+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+p+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(h===1)+`) {

              if (`+p+`) {
                dotProd +=
                    getX(batch, xR, xC, `+d+`) *
                    getW(wR, wC, `+d+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+d+`, xR, xC) *
                    getW(wR, wC, `+d+`, d2);
              }

            } else if (`+(h===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+d+`, d2),
                getW(wR, wC, `+d+` + 1, d2)
              );

              if (`+p+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+d+`),
                  getX(batch, xR, xC, `+d+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+d+`, xR, xC),
                  getX(batch, `+d+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(h===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+d+`, d2),
                getW(wR, wC, `+d+` + 1, d2),
                getW(wR, wC, `+d+` + 2, d2)
              );

              if (`+p+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+d+`),
                  getX(batch, xR, xC, `+d+` + 1),
                  getX(batch, xR, xC, `+d+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+d+`, xR, xC),
                  getX(batch, `+d+` + 1, xR, xC),
                  getX(batch, `+d+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+x+`
        `+b+`
        setOutput(result);
      }
    `},WMe=function(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.filterDepth,f=e.filterHeight,d=e.filterWidth,h=4*Math.floor(e.inChannels/4),p=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+i+", "+a+", "+o+`);
      const ivec3 pads = ivec3(`+t+", "+n+", "+r+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+c+`; wF++) {
          int xF = xFCorner + wF * `+s+`;

          if (xF < 0 || xF >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+f+`; wR++) {
            int xR = xRCorner + wR * `+u+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+d+`; wC++) {
              int xC = xCCorner + wC * `+l+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+h+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(p===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+h+`) *
                  getW(wF, wR, wC, `+h+`, d2);
              } else if (`+(p===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+h+`),
                  getX(batch, xF, xR, xC, `+h+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+h+`, d2),
                  getW(wF, wR, wC, `+h+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(p===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+h+`),
                  getX(batch, xF, xR, xC, `+h+` + 1),
                  getX(batch, xF, xR, xC, `+h+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+h+`, d2),
                  getW(wF, wR, wC, `+h+` + 1, d2),
                  getW(wF, wR, wC, `+h+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},oY=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var i=e.inHeight,a=e.inWidth,o=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,f=e.dilationWidth,d=e.filterHeight,h=e.filterWidth,p=e.outChannels/e.inChannels,g="",m="";n&&(g=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,m="result = activation(result);");var v=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+g+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+o+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+p+`;
        int q = d2 - d1 * `+p+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+d+`; wR++) {
          int xR = xRCorner + wR * `+c+`;

          if (xR < 0 || xR >= `+i+`) {
            continue;
          }

          for (int wC = 0; wC < `+h+`; wC++) {
            int xC = xCCorner + wC * `+f+`;

            if (xC < 0 || xC >= `+a+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+v+`
        `+m+`
        setOutput(result);
      }
    `},sY=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.outShape;for(var i=e.inHeight,a=e.inWidth,o=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,f=e.dilationWidth,d=e.filterHeight,h=e.filterWidth,p=h,g="int xR; int xC; int xCOffset;",m=0;m<d;m++)for(var v=0;v<h;v++)g+=`
          vec4 xTexelR`+m+"C"+2*v+` = vec4(0.);
          vec4 wR`+m+"C"+v+` = vec4(0.);
          vec4 xR`+m+"C"+v+" = vec4(0.);";for(m=0;m<d;m++)for(var y=0;y<p;y++){if(g+=`
          xR = xRCorner + `+m*c+`;
          xC = xCCorner + `+(v=2*y)*f+`;
        `,l===1){if(v<h&&(g+=s%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+i+" && xCOffset >= 0 && xCOffset < "+a+`) {
                  xTexelR`+m+"C"+v+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+a+`) {
                    xTexelR`+m+"C"+v+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+m+"C"+v+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+i+" && xCOffset >= 0 && xCOffset < "+a+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+a+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+m+"C"+v+" = vec4(previous.zw, xTexelR"+m+"C"+v+`.xy);
                } else {
                  xR`+m+"C"+v+" = vec4(0, 0, xTexelR"+m+"C"+v+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+i+" && xC >= 0 && xC < "+a+`) {
                  xTexelR`+m+"C"+v+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+m+"C"+v+` = vec4(0.);
                }

                xR`+m+"C"+v+" = xTexelR"+m+"C"+v+`;
              `,v+1<h)){var b=s%2==0?NF(f):f;f%2==0&&s%2==1||f%2!=0&&s%2!=1?(g+=`
                  xCOffset = xC + `+s%2+" + "+b+`;

                  if(xR >= 0 && xR < `+i+` &&
                    xCOffset >= 0 && xCOffset < `+a+`) {
                    xTexelR`+m+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,f>1&&(g+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+i+` &&
                      xCOffset >= 0 && xCOffset < `+a+`) {
                      xTexelR`+m+"C"+v+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+m+"C"+v+` = vec4(0.);
                    }
                  `),g+=`
                  xR`+m+"C"+(v+1)+` = vec4(
                    xTexelR`+m+"C"+v+".zw, xTexelR"+m+"C"+(v+2)+`.xy);
                `):g+=`
                  xCOffset = xC + `+b+`;

                  if(xR >= 0 && xR < `+i+` &&
                    xCOffset >= 0 && xCOffset < `+a+`) {
                    xTexelR`+m+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+m+"C"+(v+1)+" = xTexelR"+m+"C"+(v+2)+`;
                `}}else v<h&&(g+=`
              if(xR >= 0 && xR < `+i+`) {
            `,s%2==1?(g+=`
                xCOffset = xC + 1 - `+l+`;
                if(xCOffset >= 0 && xCOffset < `+a+`) {
                  xTexelR`+m+"C"+v+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+m+"C"+v+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+a+`) {
                  xTexelR`+m+"C"+(v+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+m+"C"+(v+2)+` = vec4(0.);
                }

                xR`+m+"C"+v+` = vec4(
                  xTexelR`+m+"C"+v+".zw, xTexelR"+m+"C"+(v+2)+`.zw);
              `,v+1<h&&(g+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+l+`;
                  if(xCOffset >= 0 && xCOffset < `+a+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+m+"C"+(v+1)+" = vec4(xTexelR"+m+"C"+(v+2)+`.xy, final.xy);
                `)):(g+=`
                if(xC >= 0 && xC < `+a+`) {
                  xTexelR`+m+"C"+v+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+m+"C"+v+` = vec4(0.);
                }

                xCOffset = xC + `+l+`;
                if(xCOffset >= 0 && xCOffset < `+a+`) {
                  xTexelR`+m+"C"+(v+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+m+"C"+(v+2)+` = vec4(0.);
                }

                xR`+m+"C"+v+` = vec4(
                  xTexelR`+m+"C"+v+".xy, xTexelR"+m+"C"+(v+2)+`.xy);
              `,v+1<h&&(g+=`
                  xR`+m+"C"+(v+1)+` = vec4(
                    xTexelR`+m+"C"+v+".zw, xTexelR"+m+"C"+(v+2)+`.zw);
                `)),g+="}");v<h&&(g+=`
            vec4 wTexelR`+m+"C"+v+" = getW("+m+", "+v+`, d1, q);
            wR`+m+"C"+v+" = vec4(wTexelR"+m+"C"+v+".xz, wTexelR"+m+"C"+v+`.xz);
          `,v+1<h&&(g+=`
              vec4 wTexelR`+m+"C"+(v+1)+" = getW("+m+", "+(v+1)+`, d1, q);
              wR`+m+"C"+(v+1)+` =
                vec4(wTexelR`+m+"C"+(v+1)+".xz, wTexelR"+m+"C"+(v+1)+".xz);"))}for(m=0;m<d;m++)for(v=0;v<h;v++)g+="dotProd += xR"+m+"C"+v+" * wR"+m+"C"+v+";";var x="",w="";n&&(x=r?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`vec4 activation(vec4 x) {
          `+n+`
        }`,w="result = activation(result);");var S=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+x+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+o+", "+s+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+g+`

        vec4 result = dotProd;
        `+S+`
        `+w+`
        setOutput(result);
      }
    `},VMe=function(e,t,n,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var a=e[0],o=e[1],s=e[2],u=e[3],l=t[0],c=n[0],f=n[1];this.outputShape=[l,c,f,u];var d=r==="bilinear"?1:0,h=[o-1+".0",s-1+".0"],p=h[0],g=h[1],m=c>1?[""+(o-1)/(c-1),"(y2-y1) * height_ratio","y1*"+p+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+p],v=m[0],y=m[1],b=m[2],x=f>1?[""+(s-1)/(f-1),"(x2-x1) * width_ratio","x1*"+g+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+g],w=x[0],S=x[1],C=x[2];this.userCode=`
      const float height_ratio = float(`+v+`);
      const float width_ratio = float(`+w+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+a+`) {
          return;
        }

        float height_scale = `+y+`;
        float width_scale = `+S+`;

        float in_y = `+b+`;
        if( in_y < 0.0 || in_y > `+p+` ) {
          setOutput(float(`+i+`));
          return;
        }
        float in_x = `+C+`;
        if( in_x < 0.0 || in_x > `+g+` ) {
          setOutput(float(`+i+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+d+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},qMe=function(e,t,n){this.variableNames=["x"],this.outputShape=e;var r=e.length,i=e[e.length-1],a=n?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(n?"return "+i+" -i - 1;":"return i;")+`
      }

      void main() {
        `+Zn(r)+` coords = getOutputCoords();
        int end = `+uY(r,"coords")+`;
        float val = 0.0;
        for (int i = `+i+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+a+` end) {
            continue;
          }
          if (idx == end && `+t+`) {
            continue;
          }
          `+uY(r,"coords")+` = idx;
          val += getX(`+function(o,s){if(o===1)return""+s;if(o===2)return s+".x, "+s+".y";if(o===3)return s+".x, "+s+".y, "+s+".z";if(o===4)return s+".x, "+s+".y, "+s+".z, "+s+".w";throw Error("Cumulative sum for rank "+o+" is not yet supported")}(r,"coords")+`);
        }
        setOutput(val);
      }
    `};function uY(e,t){if(e===1)return""+t;if(e===2)return t+".y";if(e===3)return t+".z";if(e===4)return t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}var HMe=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Yy.DENSE;var t=Zy(e),n=Ki();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Mh(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+n.output+` = result;
      }
    `},GMe=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Yy.DENSE;var t=Zy(e),n=Ki();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Mh(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+n.output+` = result;
      }
    `},KMe=function(){function e(t,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+n+`;
      int offset_h = imod(h, `+n+`);
      int in_w = w / `+n+`;
      int offset_w = imod(w, `+n+`);
      int offset_d = (offset_h * `+n+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return e.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},e.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},e.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},e.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},e.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},e}(),XMe=function(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},YMe=function(e){this.variableNames=["A"],this.outTexUsage=To.DOWNLOAD;var t=Ki();this.outputShape=e,this.userCode=`
      `+QX+`

      void main() {
        float x = getAAtOutCoords();
        `+t.output+` = encode_float(x);
      }
    `},ZMe=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=To.DOWNLOAD;var t=Ki();this.outputShape=e,this.userCode=`
      `+QX+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+t.output+` = encode_float(x);
      }
    `},JMe=function(e,t,n){n===void 0&&(n=!1),this.variableNames=["A"];var r=Ki(),i=t[0],a=t[1];this.outputShape=e;var o="result";n&&(o="floor(result * 255. + 0.5)"),this.userCode=`
      `+Y3(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+a+`;
        int c = imod(flatIndex, `+a+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+a+".0, "+i+`.0);
        vec4 values = `+r.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+r.output+" = vec4("+o+`, 0., 0., 0.);
      }
    `},QMe=function(e,t,n){n===void 0&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=Ki(),i=t[0],a=t[1];this.outputShape=e;var o="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var l=0;l<=1;l++){var c=2*u+l;o+=`
          localCoords = coords;
          if(localCoords[2] + `+l+" < "+e[2]+`) {
            localCoords[2] += `+l+`;
            if(localCoords[1] + `+u+" < "+e[1]+`) {
              localCoords[1] += `+u+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+a+`;
              c = imod(flatIndex, `+a+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+a+".0, "+i+`.0);
              values = `+r.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+c+`] = values[0];
              } else if(offset == 1) {
                result[`+c+`] = values[1];
              } else if(offset == 2) {
                result[`+c+`] = values[2];
              } else {
                result[`+c+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+Y3(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+o+`

        `+r.output+" = "+s+`;
      }
    `},ePe="return real * expR - imag * expI;",tPe="return real * expI + imag * expR;",lY=function(e,t,n){this.variableNames=["real","imag"];var r=t[1];this.outputShape=t;var i=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,a=n?r+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+i+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+e+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+r+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+r+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+a+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},nPe=function(){function e(t,n){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;return function(r,i){n.valueLoc==null&&(n.valueLoc=r.getUniformLocationNoThrow(i,"value")),r.gl.uniform1f(n.valueLoc,t)}},e}(),rPe=function(e,t,n){this.variableNames=["A","indices"];var r=e.slice();r[n]=t,this.outputShape=r,this.rank=r.length;var i=Zn(this.rank),a=function(o,s){var u=o.length;if(u>4)throw Error("Gather for rank "+u+" is not yet supported");if(u===1)return"int(getIndices(resRC))";for(var l=["resRC.x","resRC.y","resRC.z","resRC.w"],c=[],f=0;f<o.length;f++)f===s?c.push("int(getIndices("+l[f]+"))"):c.push(""+l[f]);return c.join()}(e,n);this.userCode=`
      void main() {
        `+i+` resRC = getOutputCoords();
        setOutput(getA(`+a+`));
      }
    `},iPe=function(e,t,n){this.sliceDim=e,this.strides=t,this.variableNames=["x","indices"],this.outputShape=n;var r=Zn(t.length),i=Zn(n.length),a=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+r+" strides = "+r+"("+this.strides+`);
         void main() {
          `+i+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+a+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function cY(e,t){var n=Ki();return XK(e,t,n.version+`
    precision highp float;
    `+n.attribute+` vec3 clipSpacePos;
    `+n.attribute+` vec2 uv;
    `+n.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function fY(e,t){return QK(e,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function dY(e,t){return eX(e,t,new Uint16Array([0,1,2,2,1,3]))}function gb(e,t,n,r,i,a,o){nX(n,r);var s=tX(e,t),u=e.TEXTURE_2D;return Qe(e,t,function(){return e.bindTexture(u,s)}),Qe(e,t,function(){return e.texParameteri(u,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)}),Qe(e,t,function(){return e.texParameteri(u,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}),Qe(e,t,function(){return e.texParameteri(u,e.TEXTURE_MIN_FILTER,e.NEAREST)}),Qe(e,t,function(){return e.texParameteri(u,e.TEXTURE_MAG_FILTER,e.NEAREST)}),Qe(e,t,function(){return e.texImage2D(u,0,i,n,r,0,a,o,null)}),Qe(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)}),s}function hY(e,t,n,r,i){var a=vS(n,r);return gb(e,t,a[0],a[1],i.internalFormatFloat,i.textureFormatFloat,e.FLOAT)}function pY(e,t,n,r,i){var a=vS(n,r);return gb(e,t,a[0],a[1],i.internalFormatHalfFloat,i.textureFormatFloat,i.textureTypeHalfFloat)}function gY(e,t,n,r,i){var a=vS(n,r);return gb(e,t,a[0],a[1],e.RGBA,e.RGBA,e.UNSIGNED_BYTE)}function mY(e,t,n,r,i){var a=Jy(n,r);return gb(e,t,a[0],a[1],i.internalFormatPackedFloat,e.RGBA,e.FLOAT)}function vY(e,t,n,r,i){var a=Jy(n,r);return gb(e,t,a[0],a[1],i.internalFormatPackedHalfFloat,e.RGBA,i.textureTypeHalfFloat)}function yY(e,t,n,r){return Qe(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),XF(e,t,n,"clipSpacePos",r,3,20,0)&&XF(e,t,n,"uv",r,2,20,12)}function bY(e,t,n,r,i,a,o){var s,u,l;Qe(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),a instanceof Uint8Array?(s=new Uint8Array(r*i*4),u=e.UNSIGNED_BYTE,l=e.RGBA):(s=new Float32Array(r*i*4),u=e.FLOAT,l=o.internalFormatPackedFloat),s.set(a),Qe(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,l,r,i,0,e.RGBA,u,s)}),Qe(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function xY(e,t,n,r){Qe(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),r.data instanceof Uint8Array?Qe(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r.width,r.height,0,e.RGBA,e.UNSIGNED_BYTE,r.data)}):Qe(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r)}),Qe(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function wY(e,t,n,r,i){var a=e.createBuffer();Qe(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,a)});var o=16*n*r;return Qe(e,t,function(){return e.bufferData(e.PIXEL_PACK_BUFFER,o,e.STREAM_READ)}),Qe(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,0)}),Qe(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}),a}function _Y(e,t,n){var r=e,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function SY(e,t,n,r,i){var a=vS(n,r),o=a[0],s=a[1],u=new Uint8Array(n*r*4);return Qe(e,t,function(){return e.readPixels(0,0,o,s,i.downloadTextureFormat,e.UNSIGNED_BYTE,u)}),new Float32Array(u.buffer)}function EY(e,t,n,r,i,a,o,s){var u=e,l=new Float32Array(function(c,f){var d=Jy(c,f);return d[0]*d[1]*4}(a,o));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}function CY(e,t,n,r){var i=new Float32Array(n*r*4);return Qe(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,i)}),i}var aPe=Object.freeze({createVertexShader:cY,createVertexBuffer:fY,createIndexBuffer:dY,createFloat32MatrixTexture:hY,createFloat16MatrixTexture:pY,createUnsignedBytesMatrixTexture:gY,createPackedMatrixTexture:mY,createFloat16PackedMatrixTexture:vY,bindVertexProgramAttributeStreams:yY,uploadDenseMatrixToTexture:bY,uploadPixelDataToTexture:xY,createBufferFromOutputTexture:wY,downloadFloat32MatrixFromBuffer:_Y,downloadByteEncodedFloatMatrixFromOutputTexture:SY,downloadPackedMatrixFromBuffer:EY,downloadMatrixFromPackedOutputTexture:CY}),AY=function(){function e(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var n=pe().getNumber("WEBGL_VERSION");t!=null?(this.gl=t,HK(n,t)):this.gl=Bu(n);var r="WEBGL_color_buffer_float";if(pe().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=Qy(this.gl,this.debug,"OES_texture_float"),Io(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=Qy(this.gl,this.debug,"OES_texture_half_float");else if(pe().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Io(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=Qy(this.gl,this.debug,"EXT_color_buffer_half_float");else if(pe().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Io(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!Io(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=fY(this.gl,this.debug),this.indexBuffer=dY(this.gl,this.debug),this.framebuffer=rX(this.gl,this.debug),this.textureConfig=KF(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(e.prototype,"debug",{get:function(){return pe().getBool("DEBUG")},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var t=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var n=this.gl;Qe(n,this.debug,function(){return n.finish()}),Qe(n,this.debug,function(){return n.bindFramebuffer(n.FRAMEBUFFER,null)}),Qe(n,this.debug,function(){return n.deleteFramebuffer(t.framebuffer)}),Qe(n,this.debug,function(){return n.bindBuffer(n.ARRAY_BUFFER,null)}),Qe(n,this.debug,function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null)}),Qe(n,this.debug,function(){return n.deleteBuffer(t.indexBuffer)}),this.disposed=!0}},e.prototype.createFloat32MatrixTexture=function(t,n){return this.throwIfDisposed(),hY(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createFloat16MatrixTexture=function(t,n){return this.throwIfDisposed(),pY(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createUnsignedBytesMatrixTexture=function(t,n){return this.throwIfDisposed(),gY(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.uploadPixelDataToTexture=function(t,n){this.throwIfDisposed(),xY(this.gl,this.debug,t,n)},e.prototype.uploadDenseMatrixToTexture=function(t,n,r,i){this.throwIfDisposed(),bY(this.gl,this.debug,t,n,r,i,this.textureConfig)},e.prototype.createFloat16PackedMatrixTexture=function(t,n){return this.throwIfDisposed(),vY(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createPackedMatrixTexture=function(t,n){return this.throwIfDisposed(),mY(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.deleteMatrixTexture=function(t){var n=this;this.throwIfDisposed(),this.outputTexture===t&&(YF(this.gl,this.debug,this.framebuffer),this.outputTexture=null),Qe(this.gl,this.debug,function(){return n.gl.deleteTexture(t)})},e.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,n,r){var i=this;return this.downloadMatrixDriver(t,function(){return SY(i.gl,i.debug,n,r,i.textureConfig)})},e.prototype.downloadPackedMatrixFromBuffer=function(t,n,r,i,a,o){return EY(this.gl,t,0,0,0,a,o,this.textureConfig)},e.prototype.downloadFloat32MatrixFromBuffer=function(t,n){return _Y(this.gl,t,n)},e.prototype.createBufferFromTexture=function(t,n,r){this.bindTextureToFrameBuffer(t);var i=wY(this.gl,this.debug,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),i},e.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},e.prototype.createFence=function(t){var n,r,i=this;if(pe().getBool("WEBGL_FENCE_API_ENABLED")){var a=t,o=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),r=function(){var s=a.clientWaitSync(o,0,0);return s===a.ALREADY_SIGNALED||s===a.CONDITION_SATISFIED},n=o}else pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=function(){return i.isQueryAvailable(n,pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):r=function(){return!0};return{query:n,isFencePassed:r}},e.prototype.downloadMatrixFromPackedTexture=function(t,n,r){var i=this;return this.downloadMatrixDriver(t,function(){return CY(i.gl,i.debug,n,r)})},e.prototype.createProgram=function(t){this.throwIfDisposed();var n=this.gl,r=YK(n,this.debug,t),i=cY(n,this.debug),a=ZK(n,this.debug);return Qe(n,this.debug,function(){return n.attachShader(a,i)}),Qe(n,this.debug,function(){return n.attachShader(a,r)}),JK(n,this.debug,a),this.debug&&xS(n,this.debug,a),this.vertexAttrsAreBound||(this.setProgram(a),this.vertexAttrsAreBound=yY(n,this.debug,this.program,this.vertexBuffer)),a},e.prototype.deleteProgram=function(t){var n=this;this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&Qe(this.gl,this.debug,function(){return n.gl.deleteProgram(t)})},e.prototype.setProgram=function(t){var n=this;this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&xS(this.gl,this.debug,this.program),Qe(this.gl,this.debug,function(){return n.gl.useProgram(t)})},e.prototype.getUniformLocation=function(t,n,r){return r===void 0&&(r=!0),this.throwIfDisposed(),r?aX(this.gl,this.debug,t,n):oX(this.gl,t,n)},e.prototype.getAttributeLocation=function(t,n){var r=this;return this.throwIfDisposed(),Qe(this.gl,this.debug,function(){return r.gl.getAttribLocation(t,n)})},e.prototype.getUniformLocationNoThrow=function(t,n){return this.throwIfDisposed(),this.gl.getUniformLocation(t,n)},e.prototype.setInputMatrixTexture=function(t,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),sX(this.gl,this.debug,this.program,t,n,r)},e.prototype.setOutputMatrixTexture=function(t,n,r){this.setOutputMatrixTextureDriver(t,r,n)},e.prototype.setOutputPackedMatrixTexture=function(t,n,r){this.throwIfDisposed();var i=Jy(n,r),a=i[0],o=i[1];this.setOutputMatrixTextureDriver(t,a,o)},e.prototype.setOutputMatrixWriteRegion=function(t,n,r,i){this.setOutputMatrixWriteRegionDriver(r,t,i,n)},e.prototype.setOutputPackedMatrixWriteRegion=function(t,n,r,i){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},e.prototype.debugValidate=function(){this.program!=null&&xS(this.gl,this.debug,this.program),eb(this.gl)},e.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),Qe(t,this.debug,function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)})},e.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),Qe(this.gl,this.debug,function(){return t.gl.finish()})},e.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Qy(this.gl,this.debug,pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},e.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},e.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},e.prototype.beginQuery=function(){if(pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var t=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=t.createQuery();return t.beginQuery(n.TIME_ELAPSED_EXT,r),r}var i=this.getQueryTimerExtensionWebGL1(),a=i.createQueryEXT();return i.beginQueryEXT(i.TIME_ELAPSED_EXT,a),a},e.prototype.endQuery=function(){if(pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT)}},e.prototype.waitForQueryAndGetTime=function(t){return tt(this,void 0,void 0,function(){var n=this;return nt(this,function(r){switch(r.label){case 0:return[4,DF(function(){return n.disposed||n.isQueryAvailable(t,pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return r.sent(),[2,this.getQueryTime(t,pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},e.prototype.getQueryTime=function(t,n){if(n===0)return null;if(n===2){var r=this.gl;return r.getQueryParameter(t,r.QUERY_RESULT)/1e6}var i=this.getQueryTimerExtensionWebGL1();return i.getQueryObjectEXT(t,i.QUERY_RESULT_EXT)/1e6},e.prototype.isQueryAvailable=function(t,n){if(n===0)return!0;if(n===2){var r=this.gl,i=this.getQueryTimerExtensionWebGL2(),a=r.getQueryParameter(t,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),a&&!this.disjoint}return a=(i=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,i.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),a&&!this.disjoint},e.prototype.pollFence=function(t){var n=this;return new Promise(function(r){n.addItemToPoll(function(){return t.isFencePassed()},function(){return r()})})},e.prototype.pollItems=function(){for(var t=function(r){for(var i=0;i<r.length&&r[i]();++i);return i-1}(this.itemsToPoll.map(function(r){return r.isDoneFn})),n=0;n<=t;++n)(0,this.itemsToPoll[n].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},e.prototype.addItemToPoll=function(t,n){var r=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:n}),this.itemsToPoll.length>1||DF(function(){return r.pollItems(),r.itemsToPoll.length===0})},e.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),wS(this.gl,this.debug,t,this.framebuffer),this.debug&&eb(this.gl)},e.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(wS(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&eb(this.gl)):YF(this.gl,this.debug,this.framebuffer)},e.prototype.downloadMatrixDriver=function(t,n){this.bindTextureToFrameBuffer(t);var r=n();return this.unbindTextureToFrameBuffer(),r},e.prototype.setOutputMatrixTextureDriver=function(t,n,r){this.throwIfDisposed();var i=this.gl;wS(i,this.debug,t,this.framebuffer),this.debug&&eb(i),this.outputTexture=t,Qe(i,this.debug,function(){return i.viewport(0,0,n,r)}),Qe(i,this.debug,function(){return i.scissor(0,0,n,r)})},e.prototype.setOutputMatrixWriteRegionDriver=function(t,n,r,i){var a=this;this.throwIfDisposed(),Qe(this.gl,this.debug,function(){return a.gl.scissor(t,n,r,i)})},e.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},e.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},e}();function kY(e,t){if(e.length!==t.length)throw Error("Binary was compiled with "+e.length+" inputs, but was executed with "+t.length+" inputs");e.forEach(function(n,r){var i=n.logicalShape,a=t[r],o=a.shape;if(!Ur(i,o))throw Error("Binary was compiled with different shapes than the current args. Shapes "+i+" and "+o+" must match");if(!n.isUniform||!a.isUniform){var s=n.texShape,u=a.isUniform?null:a.texData.texShape;if(!Ur(s,u))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+s+" and "+u+" must match")}})}var oPe=function(e,t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var r=n.filterWidth,i=n.inChannels,a=n.strideWidth,o=n.strideHeight,s=n.padInfo,u=n.outWidth,l=n.dilationWidth,c=n.dilationHeight,f=n.dataFormat,d=s.left,h=s.top,p=i*r,g=Ki(),m=f==="channelsLast",v=m?0:1,y=m?1:2,b="",x=0;x<=1;x++)for(var w=0;w<=1;w++)b+=`
          blockIndex = rc.y + `+w+`;
          pos = rc.x + `+x+`;

          if(blockIndex < `+e[1]+" && pos < "+e[0]+`) {
            offsetY = int(blockIndex / (`+u+")) * "+o+" - "+h+`;
            d0 = offsetY + `+c+" * (pos / "+p+`);

            if(d0 < `+t[v]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+u+".) * "+a+". - "+d+`.);
              d1 = offsetX + `+l+" * (int(mod(float(pos), "+p+".) / "+i+`.));

              if(d1 < `+t[y]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+i+`.));

                if (`+m+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*x+w)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*x+w)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+b+`

        `+g.output+` = result;
      }
    `},sPe=function(e,t,n,r,i){this.variableNames=["x"],this.outputShape=[];var a,o=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";a=i===.5?"inversesqrt("+u+")":i===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+i+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+o+"; j <= "+o+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+s+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+a+`;
        setOutput(val);
      }
    `},uPe=function(e,t,n,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+t+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+t+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+r+") * norm + float("+n+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+r+`)
                * float(`+i+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+i+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},lPe=function(e,t,n,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var a,o=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";a=i===.5?"inversesqrt("+u+")":i===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+i+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+o+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+o+"; j <= "+o+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+s+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+a+`;
        setOutput(result);
      }
    `},cPe=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,i=e.effectiveFilterHeight,a=e.effectiveFilterWidth,o=i-1-e.padInfo.top,s=a-1-e.padInfo.left,u=i*a-1;this.userCode=`
      const ivec2 pads = ivec2(`+o+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+i+`;
          wR += `+r+`) {
          float dyR = float(dyRCorner + wR) / `+t+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+a+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+n+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+u+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+a+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},fPe=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,i=e.dilationDepth,a=e.dilationHeight,o=e.dilationWidth,s=e.effectiveFilterDepth,u=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=s-1-e.padInfo.front,f=u-1-e.padInfo.top,d=l-1-e.padInfo.left,h=s*u*l-1;this.userCode=`
      const ivec3 pads = ivec3(`+c+", "+f+", "+d+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+s+`;
           wD += `+i+`) {
          float dyD = float(dyDCorner + wD) / `+t+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+u+`;
              wR += `+a+`) {
            float dyR = float(dyRCorner + wR) / `+n+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+l+`;
                wC += `+o+`) {
              float dyC = float(dyCCorner + wC) / `+r+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+h+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+u+" * "+l+` +
                  wR * `+l+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},Q3=function(e,t,n,r,i,a,o){n===void 0&&(n=!1),r===void 0&&(r=!1),i===void 0&&(i=!1),a===void 0&&(a=null),o===void 0&&(o=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var s=n?e[1]:e[2],u=Math.ceil(s/2),l=n?"i * 2, rc.y":"rc.y, i * 2",c=r?"rc.z, i * 2":"i * 2, rc.z",f=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],d=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],h="",p="";a&&(h=o?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+a+`
        }`:`vec4 activation(vec4 x) {
          `+a+`
        }`,p="result = activation(result);");var g=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+h+`

      const float sharedDimension = `+u+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+u+`; i++) {
          vec4 a = getMatrixA(rc.x, `+l+`);
          vec4 b = getMatrixB(rc.x, `+c+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+f[0]+" * "+d[0]+`);
          result += (`+f[1]+" * "+d[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+g+`

        `+p+`

        setOutput(result);
      }
    `},dPe=function(){function e(t,n,r){this.variableNames=["probs"],this.outputShape=[t,r],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(n-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(n-1)+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;return function(r,i){n.seedLoc==null&&(n.seedLoc=r.getUniformLocation(i,"seed")),r.gl.uniform1f(n.seedLoc,t)}},e}(),hPe=function(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+r+"), float("+n+`),
                      float(index == coords.y)));
      }
    `},pPe=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e;var t=e.length;if(t===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var n=to("rc",t),r=Zn(t),i=function(s,u,l){if(s===1)return"rc > "+u[0];for(var c="",f=s-2;f<s;f++)c+=l[f]+" >= "+u[f],f<s-1&&(c+="||");return c}(t,e,n),a=function(s,u,l,c){if(s===1)return"";var f=c.slice(-2);return`
    int r = `+f[0]+`;
    int c = `+f[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+u+`;
    bool rEdge = rp1 >= `+l+`;
  `}(t,e[e.length-1],e[e.length-2],n),o=function(s,u){var l=s.length,c=function(f,d){for(var h=[],p=0;p<=1;p++)for(var g=0;g<=1;g++){for(var m=(p===0?"r":"rp1")+", "+(g===0?"c":"cp1"),v=2;v<f;v++)m=d[d.length-1-v]+","+m;h.push(m)}return h}(l,u);return l===1?`getA(rc),
            rc + 1 >= `+s[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+c[0]+`),
          cEdge ? 0. : getA(`+c[1]+`),
          rEdge ? 0. : getA(`+c[2]+`),
          rEdge || cEdge ? 0. : getA(`+c[3]+")"}(e,n);this.userCode=`
        void main() {
          `+r+` rc = getOutputCoords();

          if(`+i+`) {
            setOutput(vec4(0));
          } else {
            `+a+`

            setOutput(vec4(`+o+`));
          }
        }
      `}},gPe=function(e,t,n){this.variableNames=["x"],this.outputShape=t.map(function(u,l){return u[0]+e[l]+u[1]});var r=e.length,i=Zn(r),a=t.map(function(u){return u[0]}).join(","),o=t.map(function(u,l){return u[0]+e[l]}).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=r!==1?`
      `+i+" start = "+i+"("+a+`);
      `+i+" end = "+i+"("+o+`);

      void main() {
        `+i+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+n+`));
        } else {
          `+i+` coords = outC - start;
          setOutput(getX(`+s+`));
        }
      }
    `:`
        int start = `+a+`;
        int end = `+o+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+n+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},mPe=function(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(function(m,v){return m[0]+e[v]+m[1]});for(var r=e.length,i=Zn(r),a=t.map(function(m){return m[0]}).join(","),o=t.map(function(m,v){return m[0]+e[v]}).join(","),s=to("rc",r),u=to("source",r),l=s[r-1]+" < "+this.outputShape[r-1],c=r===1?"source":"vec2("+u.slice(-2).join()+")",f=[i+" rc = outputLoc;",s[r-1]+` += 1;
       if(`+l+`) {
      `,r===1?"":`}
       rc = outputLoc;
       `+s[r-2]+` += 1;
       if(`+s[r-2]+" < "+this.outputShape[r-2]+") {",r===1?"":"  "+s[r-1]+` += 1;
         if(`+l+") {"],d=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",h="",p=0,g=r===1?2:4;p<g;p++)h+=`
        `+f[p]+`
        if (`+d+`) {
          result[`+p+"] = float("+n+`);
        } else {
          `+i+` source = rc - start;
          result[`+p+"] = getChannel(getX("+u.join()+"), "+c+`);
        }
      `;h+=r===1?"} ":"}}",this.userCode=`
      const `+i+" start = "+i+"("+a+`);
      const `+i+" end = "+i+"("+o+`);

      void main() {
        `+i+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+h+`
        setOutput(result);
      }
    `},mb=function(e,t,n,r,i){if(r===void 0&&(r=!1),i===void 0&&(i=!1),this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var a=e.filterWidth,o=e.strideHeight,s=e.strideWidth,u=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterHeight,f=e.effectiveFilterWidth,d=e.padInfo.top,h=e.padInfo.left;this.outputShape=e.outShape;var p=t==="avg",g="((batch  * "+e.inHeight+" + xR) * "+e.inWidth+" + xC) * "+e.inChannels+" + d",m="(xR * "+e.inWidth+" + xC) * "+e.inChannels+" + d",v="0.0";if(p||(v="-1.0 / 1e-20"),n)this.userCode=`
        const ivec2 strides = ivec2(`+o+", "+s+`);
        const ivec2 pads = ivec2(`+d+", "+h+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+c+`;
              wR += `+u+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+f+`;
                wC += `+l+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = `+(r?i?g:m:"wR * "+f+" + wC")+`;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var y=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(y="avgValue / count");var b=4*Math.floor(a/4),x=a%4,w=`
      if (`+p+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+o+", "+s+`);
      const ivec2 pads = ivec2(`+d+", "+h+`);
      const float initializationValue = `+v+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+v+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+c+`;
            wR += `+u+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+b+`; wC += 4) {
            int xC = xCCorner + wC * `+l+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              getValue(batch, xR, xC + 2 * `+l+`, d),
              getValue(batch, xR, xC + 3 * `+l+`, d)
            );

            `+w+`
          }

          int xC = xCCorner + `+b+`;
          if (`+(x===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+w+`
          } else if (`+(x===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              initializationValue,
              initializationValue
            );

            `+w+`
          } else if (`+(x===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+l+`, d),
              getValue(batch, xR, xC + 2 * `+l+`, d),
              initializationValue
            );

            `+w+`
          }
        }
        setOutput(`+y+`);
      }
    `}},eM=function(e,t,n,r,i){if(r===void 0&&(r=!1),i===void 0&&(i=!1),this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var a=e.filterWidth,o=e.strideDepth,s=e.strideHeight,u=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,f=e.dilationWidth,d=e.effectiveFilterDepth,h=e.effectiveFilterHeight,p=e.effectiveFilterWidth,g=e.padInfo.front,m=e.padInfo.top,v=e.padInfo.left;this.outputShape=e.outShape;var y=t==="avg",b="0.0";if(y||(b="-1.0 / 1e-20"),n)this.userCode=`
        const ivec3 strides =
            ivec3(`+o+", "+s+", "+u+`);
        const ivec3 pads = ivec3(`+g+", "+m+", "+v+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+d+`;
              wD += `+l+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+e.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+h+`;
                wR += `+c+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+p+`;
                  wC += `+f+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = `+(r?i?"(((batch * "+e.inDepth+" + xD) * "+e.inHeight+" + xR) * "+e.inWidth+" + xC) * "+e.inChannels+" + ch":"((xD * "+e.inHeight+" + xR) * "+e.inWidth+" + xC) * "+e.inChannels+" + ch":"wD * "+h+" * "+p+` +
                      wR * `+p+" + wC")+`;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var x=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(x="avgValue / count");var w=4*Math.floor(a/4),S=a%4,C=`
      if (`+y+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+o+", "+s+", "+u+`);
      const ivec3 pads = ivec3(`+g+", "+m+", "+v+`);
      const float initializationValue = `+b+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+b+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+d+`;
            wD += `+l+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+h+`;
            wR += `+c+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+w+`; wC += 4) {
              int xC = xCCorner + wC * `+f+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+f+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+f+`, ch)
              );

              `+C+`
            }

            int xC = xCCorner + `+w+`;
            if (`+(S===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+C+`
            } else if (`+(S===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                initializationValue,
                initializationValue
              );

              `+C+`
            } else if (`+(S===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+f+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+f+`, ch),
                initializationValue
              );

              `+C+`
            }
          }
          setOutput(`+x+`);
        }
      }
    `}},vPe=function(e,t){this.variableNames=["x"];var n=e.windowSize,r=e.batchSize,i=e.inSize,a=Math.ceil(i/n);this.outputShape=[r,a];var o="0.0",s="";t==="prod"?o="1.0":t==="min"?(o="1.0 / 1e-20",s="min"):t==="max"&&(o="-1.0 / 1e-20",s="max");var u=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="sum"?u="sumValue":t==="prod"?u="prodValue":t==="all"?u="allValue":t==="any"&&(u="anyValue");var l=4*Math.floor(n/4),c=n%4,f=`
      if (`+(t==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(t==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+s+`(values, minMaxValue);
      }
    `,d="vec4";t==="all"?(o="1.0",f=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,d="bvec4"):t==="any"&&(o="0.0",f=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,d="bvec4");var h="";i%n>0&&(h=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+o+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+h+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+n+`;

        vec4 minMaxValue = vec4(`+o+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+l+`; i += 4) {
          int inIdx = inOffset + i;
          `+d+" values = "+d+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+f+`
        }

        int inIdx = inOffset + `+l+`;
        if (`+(c===1)+`) {
          `+d+" values = "+d+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+f+`
        } else if (`+(c===2)+`) {
          `+d+" values = "+d+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+f+`
        } else if (`+(c===3)+`) {
          `+d+" values = "+d+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+f+`
        }
        setOutput(`+u+`);
      }
    `},yPe=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var n="",r=0;r<4;r++){var i="thisRC = rc;";r%2==1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),n+=`
        `+i+`
        `+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+r+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(r>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+Mh(["r","c","d"],t)+`
      return ivec3(r, c, d);
    }
  
      `+Y3(e)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+e[1]+`;
        int cols = `+e[2]+`;

        `+n+`

        setOutput(result);
      }
    `},bPe=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,i=r[1],a=r[2],o=e.shape,s=o[1],u=o[2],l=[n&&s>1?i-1:i,n&&u>1?a-1:a],c=[n&&s>1?s-1:s,n&&u>1?u-1:u],f=l[0]/c[0],d=l[1]/c[1],h=1/f,p=1/d,g=2*Math.ceil(h)+2,m=2*Math.ceil(p)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+f+`);
        const float widthScale = float(`+d+`);

        const float invHeightScale = float(`+h+`);
        const float invWidthScale = float(`+p+`);

        const int winHeight = int(`+g+`);
        const int winWidth = int(`+m+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(i-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(a-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},xPe=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var i=e[0],a=e[1],o=e[2],s=e[3];this.outputShape=[i,t,n,s];var u=[r&&t>1?a-1:a,r&&n>1?o-1:o],l=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+a+".0, "+o+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},wPe=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var i=e[0],a=e[1],o=e[2],s=e[3];this.outputShape=[i,t,n,s];var u=[r&&t>1?a-1:a,r&&n>1?o-1:o],l=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`,
          `+u[1]/l[1]+`);
      const vec3 inputShapeRC = vec3(`+a+".0, "+o+`.0,
                                     `+o+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(s-1)+`;
        bool hasNextRow = coords.z < `+(n-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},_Pe=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,i=r[1],a=r[2],o=e.shape,s=o[1],u=o[2],l=[n&&s>1?i-1:i,n&&u>1?a-1:a],c=[n&&s>1?s-1:s,n&&u>1?u-1:u],f=l[0]/c[0],d=l[1]/c[1],h=1/f,p=1/d,g=2*Math.ceil(h)+2,m=2*Math.ceil(p)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+f+`);
        const float widthScale = float(`+d+`);

        const float invHeightScale = float(`+h+`);
        const float invWidthScale = float(`+p+`);

        const int winHeight = int(`+g+`);
        const int winWidth = int(`+m+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float sourceFracRow =
              float(`+l[0]+`) *
                (float(dyR) / float(`+c[0]+`));

            float sourceFracCol =
                float(`+l[1]+`) *
                  (float(dyC) / float(`+c[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+i+`) - 1),
                `+n+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+a+`) - 1),
                `+n+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},SPe=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var i=e[0],a=e[1],o=e[2],s=e[3];this.outputShape=[i,t,n,s];var u=[r&&t>1?a-1:a,r&&n>1?o-1:o],l=[r&&t>1?t-1:t,r&&n>1?n-1:n],c=r?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+a+".0, "+o+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+c+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},EPe=function(e,t){this.variableNames=["x"];var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=e,n!==1){var r=e.map(function(a,o){return function(s){return t.indexOf(s)!==-1&&e[s]!==1?e[s]+" - coords["+s+"] - 1":"coords["+s+"]"}(o)}).join(","),i=Zn(n);this.userCode=`
      void main() {
        `+i+` coords = getOutputCoords();
        setOutput(getX(`+r+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+e[0]+` - coord - 1));
        }
      `},CPe=function(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=e;var r=to("rc",n),i=r[n-1]+" + 1 < "+this.outputShape[n-1],a=r[n-2]+" + 1 < "+this.outputShape[n-2],o=Zn(n);function s(u){var l=e.map(function(c,f){return function(d,h){return t.indexOf(d)!==-1&&e[d]!==1?e[d]+" - "+h[d]+" - 1":""+h[d]}(f,u)});return"getChannel(getX("+l.join(",")+"), vec2("+l.slice(-2).join(",")+"))"}this.userCode=n===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+e[0]+` - rc - 1),
            `+e[0]+` - rc - 1);
          if(`+i+`){
              result.g = getChannel(getX(`+e[0]+` - (rc  + 1) - 1),
                `+e[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+o+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+function(u){return s(u)}(r.slice())+`;
          if(`+i+`){
            result.g = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",s(u)}(r.slice())+`;
          }
          if(`+a+`) {
            result.b = `+function(u){return u[n-2]="("+u[n-2]+" + 1)",s(u)}(r.slice())+`;
            if(`+i+`) {
              result.a = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",u[n-2]="("+u[n-2]+" + 1)",s(u)}(r.slice())+`;
            }
          }
          setOutput(result);
        }
    `},TY=function(e,t,n,r,i,a,o){this.variableNames=["updates","indices","defaultValue"],this.outputShape=a;var s=Zn(i.length),u=Zn(a.length),l="";n===1?l="i":n===2&&(l="i, j");var c="getIndices("+l+")",f="";r===1?f="i":r===2&&(f="i, coords[1]");var d="getUpdates("+f+")",h=t>1?"strides[j]":"strides";this.userCode=`
        `+s+" strides = "+s+"("+i+`);

        void main() {
          `+u+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+e+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+t+`; j++) {
              int index = round(`+c+`);
              flattenedIndex += index * `+h+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+d+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},APe=function(e,t){this.variableNames=["x","segmentIds"];var n=e.windowSize,r=e.batchSize,i=e.inSize,a=e.numSegments,o=a*Math.ceil(i/n);this.outputShape=[r,o];var s=4*Math.floor(n/4),u=n%4,l=`
        sumValue += dot(values, segFilter);
    `,c="";i%n>0&&(c=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return initializationValue;
        }
      `);var f="";i%n>0&&(f=`
        if (inIdx < 0 || inIdx >= `+i+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+c+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+f+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+a+")) * float("+n+`));
        int currentSeg = int(mod(float(outIdx), float(`+a+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+s+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+l+`
        }

        int inIdx = inOffset + `+s+`;
        if (`+(u===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+l+`
        } else if (`+(u===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+l+`
        } else if (`+(u===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+l+`
        }
        setOutput(sumValue);
      }
    `},kPe=function(e,t,n){var r,i;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank "+n+" is not yet supported");if(n===1)i="resRC",r="resRC";else{for(var a=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],s=[],u=0;u<t.length;u++)s.push(""+a[u]),u<e&&o.push(""+a[u]);r=o.join(),i=s.join()}var l=Zn(n);this.userCode=`
      void main() {
        `+l+` resRC = getOutputCoords();
        float cVal = getC(`+r+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+i+`));
        } else {
          setOutput(getB(`+i+`));
        }
      }
    `},TPe=function(){function e(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var n,r=Zn(this.rank),i="uniform int start["+this.rank+"];",a=function(o){if(o===1)return"sourceLoc";if(o<=6)return tM.slice(0,o).map(function(s){return"sourceLoc."+s}).join(",");throw Error("Slicing for rank "+o+" is not yet supported")}(this.rank);n=`
        `+r+` sourceLoc;
        `+r+` coords = getOutputCoords();
        `+t.map(function(o,s){return"sourceLoc."+tM[s]+" = start["+s+"] + coords."+tM[s]+";"}).join(`
`)+`
      `,this.userCode=`
      `+i+`
      void main() {
        `+n+`
        setOutput(getSource(`+a+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,i){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(i,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,t)}},e}(),tM=["x","y","z","w","u","v"],OPe=function(){function e(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var n=Zn(this.rank),r=to("coords",this.rank),i=to("sourceLoc",this.rank),a=this.rank===1?"sourceLoc":"vec2("+i.slice(-2).join()+")",o="getChannel(getSource("+i.join()+"), "+a+")",s=`
      result.x = `+o+`;
      if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
        ++`+i[this.rank-1]+`;
        result.y = `+o+`;
        --`+i[this.rank-1]+`;
      }
    `,u=this.rank===1?"":`
      --`+r[this.rank-1]+`;
      if (++`+r[this.rank-2]+" < "+t[this.rank-2]+`) {
        ++`+i[this.rank-2]+`;
        result.z = `+o+`;
        if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
          ++`+i[this.rank-1]+`;
          result.w = `+o+`;
        }
      }
    `,l=this.rank<=4?`sourceLoc = coords +
            `+n+"("+t.map(function(c,f){return"start["+f+"]"}).join()+");":t.map(function(c,f){return i[f]+" = "+r[f]+" + start["+f+"];"}).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+n+` coords = getOutputCoords();
        `+n+` sourceLoc;
        `+l+`
        vec4 result = vec4(0.);
        `+s+`
        `+u+`
        setOutput(result);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,i){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(i,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,t)}},e}(),IPe=function(e,t,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,i=Zn(n.length),a=Zn(n.length),o="";if(r===1)o="coords * strides + begin";else{var s=0;o=n.map(function(u,l){return s++,n.length===1?"coords * strides["+l+"] + begin["+l+"]":"coords["+(s-1)+"] * strides["+l+"] + begin["+l+"]"}).join(",")}this.userCode=`
      `+i+" begin = "+i+"("+e+`);
      `+i+" strides = "+i+"("+t+`);

      void main() {
        `+a+` coords = getOutputCoords();
        setOutput(getX(`+o+`));
      }
    `},NPe=function(){function e(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return e.prototype.acquireTexture=function(t,n,r){var i,a=OY(n,r),o=IY(t,a,r);if(o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]),this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var s=this.freeTextures[o].shift();return this.usedTextures[o].push(s),s}return this.numUsedTextures++,this.log(),a===Oo.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):a===Oo.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):a===Oo.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):a===Oo.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):a===Oo.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[o].push(i),i},e.prototype.releaseTexture=function(t,n,r,i){if(this.freeTextures!=null){var a=IY(n,OY(r,i),i);a in this.freeTextures||(this.freeTextures[a]=[]),this.freeTextures[a].push(t),this.numFreeTextures++,this.numUsedTextures--;var o=this.usedTextures[a],s=o.indexOf(t);if(s<0)throw new Error("Cannot release a texture that was never provided by this texture manager");o.splice(s,1),this.log()}},e.prototype.log=function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+t+")")}},e.prototype.getNumUsedTextures=function(){return this.numUsedTextures},e.prototype.getNumFreeTextures=function(){return this.numFreeTextures},e.prototype.dispose=function(){var t=this;if(this.freeTextures!=null){for(var n in this.freeTextures)this.freeTextures[n].forEach(function(r){t.gpgpu.deleteMatrixTexture(r)});for(var n in this.usedTextures)this.usedTextures[n].forEach(function(i){t.gpgpu.deleteMatrixTexture(i)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},e}();function OY(e,t){if(e===To.UPLOAD)return Oo.PACKED_2X2_FLOAT32;if(e===To.RENDER||e==null)return function(n){return pe().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?Oo.PACKED_2X2_FLOAT32:Oo.UNPACKED_FLOAT32:n?Oo.PACKED_2X2_FLOAT16:Oo.UNPACKED_FLOAT16}(t);if(e===To.DOWNLOAD||e===To.PIXELS)return Oo.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+e)}function IY(e,t,n){return e[0]+"_"+e[1]+"_"+t+"_"+n}var DPe=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[r]*t[r];this.outputShape=n,this.rank=n.length;var i=Zn(this.rank),a=function(o){var s=o.length;if(s>5)throw Error("Tile for rank "+s+" is not yet supported");if(s===1)return"imod(resRC, "+o[0]+")";for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],l=[],c=0;c<o.length;c++)l.push("imod("+u[c]+", "+o[c]+")");return l.join()}(e);this.userCode=`
      void main() {
        `+i+` resRC = getOutputCoords();
        setOutput(getA(`+a+`));
      }
    `},nM=1.7580993408473768,rM=1.0507009873554805,Pt=function(e,t){this.variableNames=["A"],this.outputShape=e,this.userCode=`
      float unaryOperation(float x) {
        `+t+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},Vs="if (isnan(x)) return x;",RPe="return x;",NY="return abs(x);",DY=Vs+`
  return (x < 0.0) ? 0.0 : x;
`,RY=Vs+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,FY="return (x >= 0.0) ? x : (exp(x) - 1.0);",FPe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+nM+`;
  float scale = `+rM+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,MY="return -x;",PY="return ceil(x);",$Y="return floor(x);",LY="return exp(x);",BY="return exp(x) - 1.0;",MPe=Vs+`
  return sin(x);
`,PPe=Vs+`
  return cos(x);
`,$Pe=Vs+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,LPe=Vs+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,BPe=Vs+`
  return atan(x);
`,zPe=Vs+"return log(x + sqrt(x * x + 1.0));",jPe=Vs+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,UPe=Vs+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,XS="return x;",WPe="return x;",zY=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,jY=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,UY=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,vb=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+t+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},VPe=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e;var t=e.length,n=to("rc",t),r=Zn(t),i=function(s,u){if(s===1)return"rc";for(var l="",c=0;c<s;c++)l+=u[c],c<s-1&&(l+=",");return l}(t,n),a=n.slice(-2),o=t<=1?"rc":"vec2("+a.join(",")+")";this.userCode=`
      void main() {
        `+r+` rc = getOutputCoords();
        vec4 packedInput = getA(`+i+`);

        setOutput(getChannel(packedInput, `+o+`));
      }
    `},YS={};function ZS(e,t){if(t===void 0&&(t=!1),e==="linear")return t?WPe:RPe;if(e==="relu")return t?zY:DY;if(e==="elu")return t?UY:FY;if(e==="relu6")return t?jY:RY;if(e==="prelu")return t?iY:rY;throw new Error("Activation "+e+" has not been implemented for the WebGL backend.")}var qPe=600,WY=function(e){function t(n){var r,i=e.call(this)||this;if(i.pendingRead=new WeakMap,i.pendingDisposal=new WeakSet,i.dataRefCount=new WeakMap,i.numBytesInGPU=0,i.uploadWaitMs=0,i.downloadWaitMs=0,i.warnedAboutMemory=!1,i.pendingDeletes=0,i.disposed=!1,!pe().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(n==null){var a=Bu(pe().getNumber("WEBGL_VERSION"));i.binaryCache=((r=pe().getNumber("WEBGL_VERSION"))in YS||(YS[r]={}),YS[r]),i.gpgpu=new AY(a),i.canvas=a.canvas,i.gpgpuCreatedLocally=!0}else i.gpgpu=n,i.binaryCache={},i.gpgpuCreatedLocally=!1,i.canvas=n.gl.canvas;return i.textureManager=new NPe(i.gpgpu),i.numMBBeforeWarning=pe().global.screen==null?1024:pe().global.screen.height*pe().global.screen.width*window.devicePixelRatio*qPe/1024/1024,i.texData=new z3(i,J),i}return Bs(t,e),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.write=function(n,r,i){if(pe().getBool("DEBUG")&&this.checkNumericalProblems(n),i==="complex64"&&n!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var a={};return this.texData.set(a,{shape:r,dtype:i,values:n,usage:To.UPLOAD}),a},t.prototype.move=function(n,r,i,a){if(pe().getBool("DEBUG")&&this.checkNumericalProblems(r),a==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(n,{shape:i,dtype:a,values:r,usage:To.UPLOAD})},t.prototype.readSync=function(n){var r=this.texData.get(n),i=r.values,a=r.dtype,o=r.complexTensors,s=r.slice,u=r.shape,l=r.isPacked;if(s!=null){var c=void 0;c=l?new vb(u,XS):new Pt(u,XS);var f=this.runWebGLProgram(c,[{dataId:n,shape:u,dtype:a}],a),d=this.readSync(f.dataId);return this.disposeData(f.dataId),d}if(i!=null)return this.convertAndCacheOnCPU(n);if(a==="string")return i;var h,p,g=this.activeTimers!=null;return g&&(h=zs()),a==="complex64"?p=H3(o.real.dataSync(),o.imag.dataSync()):p=this.getValuesFromTexture(n),g&&(this.downloadWaitMs+=zs()-h),this.convertAndCacheOnCPU(n,p)},t.prototype.read=function(n){return tt(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f,d,h,p,g,m,v,y,b,x,w,S,C,_;return nt(this,function(E){switch(E.label){case 0:if(this.pendingRead.has(n))return r=this.pendingRead.get(n),[2,new Promise(function(A){return r.push(A)})];if(i=this.texData.get(n),a=i.values,o=i.shape,s=i.slice,u=i.dtype,l=i.complexTensors,c=i.isPacked,s!=null)return f=void 0,f=c?new vb(o,XS):new Pt(o,XS),d=this.runWebGLProgram(f,[{dataId:n,shape:o,dtype:u}],u),h=this.read(d.dataId),this.disposeData(d.dataId),[2,h];if(a!=null)return[2,this.convertAndCacheOnCPU(n)];if(!pe().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&pe().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return p=null,u!=="complex64"&&pe().get("WEBGL_BUFFER_SUPPORTED")&&(g=this.decode(n),m=this.texData.get(g.dataId),p=(_=this.gpgpu).createBufferFromTexture.apply(_,[m.texture].concat(Zy(o)))),this.pendingRead.set(n,[]),u==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:E.sent(),E.label=2;case 2:return u!=="complex64"?[3,4]:[4,Promise.all([l.real.data(),l.imag.data()])];case 3:return y=E.sent(),b=y[0],x=y[1],v=H3(b,x),[3,5];case 4:p==null?v=this.getValuesFromTexture(n):(w=et(o),v=this.gpgpu.downloadFloat32MatrixFromBuffer(p,w)),E.label=5;case 5:return g!=null&&this.disposeData(g.dataId),S=this.convertAndCacheOnCPU(n,v),C=this.pendingRead.get(n),this.pendingRead.delete(n),C.forEach(function(A){return A(S)}),this.pendingDisposal.has(n)&&(this.pendingDisposal.delete(n),this.disposeData(n),this.pendingDeletes--),[2,S]}})})},t.prototype.checkNumericalProblems=function(n){if(n!=null)for(var r=0;r<n.length;r++){var i=n[r];if(!GK(i))throw pe().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+i+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+i+" cannot be represented on this device.")}},t.prototype.getValuesFromTexture=function(n){var r,i=this.texData.get(n),a=i.shape,o=i.dtype,s=i.isPacked,u=et(a);if(pe().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var l=this.decode(n),c=this.texData.get(l.dataId),f=(r=this.gpgpu).downloadMatrixFromPackedTexture.apply(r,[c.texture].concat(Zy(a))).subarray(0,u);return this.disposeData(l.dataId),f}var d=pe().getBool("WEBGL_PACK")&&s===!0,h=d?_S(a):a,p=d?new ZMe(h):new YMe(h),g=this.runWebGLProgram(p,[{shape:h,dtype:o,dataId:n}],"float32"),m=this.texData.get(g.dataId),v=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(m.texture,m.texShape[0],m.texShape[1]).subarray(0,u);return this.disposeData(g.dataId),v},t.prototype.time=function(n){return tt(this,void 0,void 0,function(){var r,i,a,o,s,u,l;return nt(this,function(c){switch(c.label){case 0:return r=this.activeTimers,i=[],a=!1,this.programTimersStack==null?(this.programTimersStack=i,a=!0):this.activeTimers.push(i),this.activeTimers=i,n(),o=tc(this.activeTimers.map(function(f){return f.query})).filter(function(f){return f!=null}),s=tc(this.activeTimers.map(function(f){return f.name})).filter(function(f){return f!=null}),this.activeTimers=r,a&&(this.programTimersStack=null),u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(o)]:[3,2];case 1:return l=c.sent(),u.kernelMs=IK(l),u.getExtraProfileInfo=function(){return l.map(function(f,d){return{name:s[d],ms:f}}).map(function(f){return f.name+": "+f.ms}).join(", ")},[3,3];case 2:u.kernelMs={error:"WebGL query timers are not supported in this environment."},c.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,u]}})})},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:zs(),endMs:null}},t.prototype.endTimer=function(n){return pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),n):(n.endMs=zs(),n)},t.prototype.getQueryTime=function(n){return tt(this,void 0,void 0,function(){var r;return nt(this,function(i){return pe().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(n)]:[2,(r=n).endMs-r.startMs]})})},t.prototype.disposeData=function(n){if(!this.pendingDisposal.has(n)){if(this.pendingRead.has(n))return this.pendingDisposal.add(n),void this.pendingDeletes++;if(this.texData.has(n)){this.releaseGPUData(n);var r=this.texData.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.texData.delete(n)}}},t.prototype.releaseGPUData=function(n){var r=this.texData.get(n),i=r.texture,a=r.dtype,o=r.texShape,s=r.usage,u=r.isPacked,l=r.slice,c=l&&l.origDataId||n,f=this.dataRefCount.get(c);f>1?this.dataRefCount.set(c,f-1):(this.dataRefCount.delete(c),i!=null&&(this.numBytesInGPU-=this.computeBytes(o,a),this.textureManager.releaseTexture(i,o,s,u)));var d=this.texData.get(n);d.texture=null,d.texShape=null,d.isPacked=!1,d.slice=null},t.prototype.getTexture=function(n){return this.uploadToGPU(n),this.texData.get(n).texture},t.prototype.getDataInfo=function(n){return this.texData.get(n)},t.prototype.getCPUBackend=function(){return pe().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=J.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(n,r){var i=this;return r===void 0&&(r=128),this.getCPUBackend()!=null&&n.every(function(a){return i.texData.get(a.dataId).texture==null&&et(a.shape)<r})},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(n,r){var i=this.makeOutput(n.shape,"complex64");return this.texData.get(i.dataId).complexTensors={real:J.keep(n.clone()),imag:J.keep(r.clone())},i},t.prototype.real=function(n){return this.texData.get(n.dataId).complexTensors.real.clone()},t.prototype.imag=function(n){return this.texData.get(n.dataId).complexTensors.imag.clone()},t.prototype.slice=function(n,r,i){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.slice(n,r,i);if(et(i)===0)return Rr([],i,n.dtype);var a=this.texData.get(n.dataId).isPacked,o=L3(n.shape,r,i);if(a||!o){var s=pe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new OPe(i):new TPe(i),u=s.getCustomSetupFunc(r);return this.compileAndRun(s,[n],null,u)}return this.uploadToGPU(n.dataId),this.shallowSlice(n,r,i)},t.prototype.shallowSlice=function(n,r,i){var a=this.texData.get(n.dataId),o=this.makeOutput(i,n.dtype),s=this.texData.get(o.dataId);Object.assign(s,a),s.shape=i,s.dtype=n.dtype;var u=B3(r,n.strides);a.slice&&(u+=a.slice.flatOffset),s.slice={flatOffset:u,origDataId:a.slice&&a.slice.origDataId||n.dataId};var l=this.dataRefCount.get(s.slice.origDataId)||1;return this.dataRefCount.set(s.slice.origDataId,l+1),o},t.prototype.stridedSlice=function(n,r,i,a){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.stridedSlice(n,r,i,a);var o=US(r,i,a);if(o.some(function(u){return u===0}))return Rr([],o);var s=new IPe(r,a,o);return this.compileAndRun(s,[n])},t.prototype.reverse=function(n,r){var i=pe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new CPe(n.shape,r):new EPe(n.shape,r);return this.compileAndRun(i,[n])},t.prototype.concat=function(n,r){if(n[0].dtype==="complex64"){var i=n.map(function(h){return eo(h)}),a=n.map(function(h){return is(h)});return ri(this.concat(i,r),this.concat(a,r))}if(this.shouldExecuteOnCPU(n))return this.cpuBackend.concat(n,r);if(n.length===1)return n[0];if(n.length>pe().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var o=Math.floor(n.length/2),s=this.concat(n.slice(0,o),r),u=this.concat(n.slice(o),r);return this.concat([s,u],r)}if(pe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&n[0].rank>1){var l=new PMe(n.map(function(h){return h.shape}),r);return this.compileAndRun(l,n)}var c=Dh(n.map(function(h){return h.shape}),r),f=n.map(function(h){return h.as2D(-1,et(h.shape.slice(r)))}),d=new MMe(f.map(function(h){return h.shape}));return this.compileAndRun(d,f).reshape(c)},t.prototype.neg=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.neg(n);if(pe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,MY,n.dtype);var r=new Pt(n.shape,MY);return this.compileAndRun(r,[n])},t.prototype.batchMatMul=function(n,r,i,a){var o=i?n.shape[2]:n.shape[1],s=a?r.shape[1]:r.shape[2],u=i?n.shape[1]:n.shape[2],l=n.shape[0];if((o===1||s===1)&&u>1e3){i&&(n=cn(n,[0,2,1])),a&&(r=cn(r,[0,2,1]));var c=s===1?n:n.as3D(l,u,1),f=s===1?2:1,d=s===1?r.as3D(l,1,u):r;return this.multiply(c,d).sum(f,!0)}var h=yi(n.dtype,r.dtype),p=new Q3(n.shape,[l,o,s],i,a);return this.compileAndRun(p,[n,r],h)},t.prototype.fusedBatchMatMul=function(n){var r=n.a,i=n.b,a=n.transposeA,o=n.transposeB,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=a?r.shape[2]:r.shape[1],f=o?i.shape[1]:i.shape[2],d=r.shape[0],h=yi(r.dtype,i.dtype),p=s!=null,g=l!=null,m=u?ZS(u,!0):null,v=new Q3(r.shape,[d,c,f],a,o,p,m,g),y=[r,i];return s&&y.push(s),l&&y.push(l),this.compileAndRun(v,y,h)},t.prototype.multiply=function(n,r){if(n.dtype==="complex64"){var i=this.texData.get(n.dataId),a=this.texData.get(r.dataId),o=new tY(TMe,n.shape,r.shape),s=new tY(OMe,n.shape,r.shape),u=[this.makeComplexComponentTensorInfo(n,i.complexTensors.real),this.makeComplexComponentTensorInfo(n,i.complexTensors.imag),this.makeComplexComponentTensorInfo(r,a.complexTensors.real),this.makeComplexComponentTensorInfo(r,a.complexTensors.imag)],l=this.compileAndRun(o,u),c=this.compileAndRun(s,u),f=this.complex(l,c);return l.dispose(),c.dispose(),f}if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.multiply(n,r);if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,nY,n.dtype);var d=new Ar(nY,n.shape,r.shape);return this.compileAndRun(d,[n,r],n.dtype)},t.prototype.batchNormalization=function(n,r,i,a,o,s){var u=[n,r,i],l=null;s!=null&&(l=s.shape,u.push(s));var c=null;if(o!=null&&(c=o.shape,u.push(o)),pe().getBool("WEBGL_PACK_NORMALIZATION")){var f=new kMe(n.shape,r.shape,i.shape,l,c,a);return this.compileAndRun(f,u)}var d=new AMe(n.shape,r.shape,i.shape,l,c,a);return this.compileAndRun(d,u)},t.prototype.localResponseNormalization4D=function(n,r,i,a,o){var s=pe().getBool("WEBGL_PACK_NORMALIZATION")?new lPe(n.shape,r,i,a,o):new sPe(n.shape,r,i,a,o);return this.compileAndRun(s,[n])},t.prototype.LRNGrad=function(n,r,i,a,o,s,u){var l=new uPe(r.shape,a,o,s,u);return this.compileAndRun(l,[r,i,n])},t.prototype.tile=function(n,r){if(n.dtype==="string"){var i=this.readSync(n.dataId).map(function(o){return qy(o)});return YX(Ot(n.shape,n.dtype,i),r)}var a=new DPe(n.shape,r);return this.compileAndRun(a,[n])},t.prototype.pad=function(n,r,i){var a=pe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new mPe(n.shape,r,i):new gPe(n.shape,r,i);return this.compileAndRun(a,[n])},t.prototype.gather=function(n,r,i){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.gather(n,r,i);var a=new rPe(n.shape,r.size,i);return this.compileAndRun(a,[n,r])},t.prototype.batchToSpaceND=function(n,r,i){U(n.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var a=r.reduce(function(f,d){return f*d}),o=DS(n.shape,r,a),s=RS(o.length,r.length),u=FS(n.shape,r,a),l=CX(i,r.length),c=AX(u,i,r.length);return cn(n.reshape(o),s).reshape(u).slice(l,c)},t.prototype.spaceToBatchND=function(n,r,i){U(n.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var a=r.reduce(function(d,h){return d*h}),o=[[0,0]];o.push.apply(o,i);for(var s=1+r.length;s<n.shape.length;++s)o.push([0,0]);var u=n.pad(o),l=DS(u.shape,r,a,!1),c=RS(l.length,r.length,!1),f=FS(u.shape,r,a,!1);return cn(u.reshape(l),c).reshape(f)},t.prototype.reduce=function(n,r,i){var a=n.shape[0],o=n.shape[1],s=jS(o),u=new vPe({windowSize:s,inSize:o,batchSize:a},r),l=this.compileAndRun(u,[n],i);return l.shape[1]===1?l:this.reduce(l,r,i)},t.prototype.argReduce=function(n,r,i){i===void 0&&(i=null);var a=n.shape[0],o=n.shape[1];i!=null&&(a=i.shape[0],o=i.shape[1]);var s=jS(o),u=new vMe({windowSize:s,inSize:o,batchSize:a},r,i==null),l=[n];i!=null&&l.push(i);var c=this.compileAndRun(u,l,"int32");return c.shape[1]===1?c:this.argReduce(n,r,c)},t.prototype.argReducePacked=function(n,r,i){i===void 0&&(i=null);var a=i!=null?i.shape:n.shape,o=jS(a[a.length-1]),s=new SMe(a,o,r,i==null),u=i==null?[n]:[n,i],l=this.compileAndRun(s,u,"int32");return l.rank===n.rank?this.argReducePacked(n,r,l):l},t.prototype.sum=function(n,r){Qa("sum",r,n.rank);var i=Di(n.shape,r),a=i[0],o=et(i[1]),s=n.as2D(-1,o),u=mS(n.dtype);return this.reduce(s,"sum",u).reshape(a)},t.prototype.prod=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.prod(n,r);var i=Di(n.shape,r),a=i[0],o=et(i[1]),s=n.as2D(-1,o),u=mS(n.dtype);return this.reduce(s,"prod",u).reshape(a)},t.prototype.unsortedSegmentSum=function(n,r,i){var a=0,o=js([a],n.rank),s=n;o!=null&&(s=cn(n,o),a=Us(1,n.rank)[0]);var u=function(h,p,g){for(var m=[],v=h.length,y=0;y<v;y++)y!==p?m.push(h[y]):m.push(g);return m}(s.shape,a,i),l=et([s.shape[a]]),c=s.as2D(-1,l),f=mS(n.dtype),d=this.segOpCompute(c,"unsortedSegmentSum",r,f,i).reshape(u);return o!=null&&(d=cn(d,kS(o))),d},t.prototype.segOpCompute=function(n,r,i,a,o){var s=n.shape[0],u=n.shape[1],l=function(d,h){var p,g=!1;for(d<=P3?(p=d,g=!0):p=pS(d,Math.floor(Math.sqrt(d)));!g;)p>h||p===d?g=!0:p=pS(d,p+1);return p}(u,o),c=new APe({windowSize:l,inSize:u,batchSize:s,numSegments:o},r),f=this.compileAndRun(c,[n,i],a);return f.shape[1]===o?f:(i=Cm(0,o).tile([u/l]),this.segOpCompute(f,r,i,a,o))},t.prototype.argMinMaxReduce=function(n,r,i){var a=[r];if(Qa("arg"+i.charAt(0).toUpperCase()+i.slice(1),a,n.rank),!pe().getBool("WEBGL_PACK_REDUCE")||n.rank<=2){var o=Di(n.shape,a),s=o[0],u=et(o[1]),l=n.as2D(-1,u);return this.argReduce(l,i).reshape(s)}return this.argReducePacked(n,i)},t.prototype.argMin=function(n,r){return this.argMinMaxReduce(n,r,"min")},t.prototype.argMax=function(n,r){return this.argMinMaxReduce(n,r,"max")},t.prototype.cumsum=function(n,r,i,a){if(r!==n.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(n.rank-1)+" but got axis="+r);var o=new qMe(n.shape,i,a);return this.compileAndRun(o,[n])},t.prototype.equal=function(n,r){if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(equal(a, b));
`,"bool");var i=new Ar("return float(a == b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.notEqual=function(n,r){if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(notEqual(a, b));
`,"bool");var i=new Ar("return float(a != b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.less=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.less(n,r);if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThan(a, b));
`,"bool");var i=new Ar("return float(a < b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.lessEqual=function(n,r){if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThanEqual(a, b));
`,"bool");var i=new Ar("return float(a <= b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.greater=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.greater(n,r);if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThan(a, b));
`,"bool");var i=new Ar("return float(a > b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.greaterEqual=function(n,r){if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var i=new Ar("return float(a >= b);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.logicalNot=function(n){var r=new Pt(n.shape,"return float(!(x >= 1.0));");return this.compileAndRun(r,[n])},t.prototype.logicalAnd=function(n,r){if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var i=new Ar("return float(a >= 1.0 && b >= 1.0);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.logicalOr=function(n,r){if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var i=new Ar("return float(a >= 1.0 || b >= 1.0);",n.shape,r.shape);return this.compileAndRun(i,[n,r],"bool")},t.prototype.select=function(n,r,i){var a=new kPe(n.rank,r.shape,r.rank);return this.compileAndRun(a,[n,r,i],yi(r.dtype,i.dtype))},t.prototype.where=function(n){AS("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var r=n.dataSync();return X3(n.shape,r)},t.prototype.topk=function(n,r,i){return ZX(n.dataSync(),n.shape,n.dtype,r)},t.prototype.min=function(n,r){Qa("min",r,n.rank);var i=Di(n.shape,r),a=i[0],o=et(i[1]),s=n.as2D(-1,o);return this.reduce(s,"min",s.dtype).reshape(a)},t.prototype.minimum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.minimum(n,r);var i=pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new qu(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Ar(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.mod=function(n,r){var i=pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new qu(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Ar(`if (b == 0.0) return NAN;
  return mod(a, b);`,n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.max=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.max(n,r);Qa("max",r,n.rank);var i=Di(n.shape,r),a=i[0],o=et(i[1]),s=n.as2D(-1,o);return this.reduce(s,"max",s.dtype).reshape(a)},t.prototype.maximum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.maximum(n,r);var i=pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new qu(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Ar(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.all=function(n,r){Qa("all",r,n.rank);var i=Di(n.shape,r),a=i[0],o=et(i[1]),s=n.as2D(-1,o);return this.reduce(s,"all",s.dtype).reshape(a)},t.prototype.any=function(n,r){Qa("any",r,n.rank);var i=Di(n.shape,r),a=i[0],o=et(i[1]),s=n.as2D(-1,o);return this.reduce(s,"any",s.dtype).reshape(a)},t.prototype.floorDiv=function(n,r){if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var i=new Ar(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,n.shape,r.shape);return this.compileAndRun(i,[n,r],"int32")},t.prototype.add=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,Z3);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.add(n,r);var i=yi(n.dtype,r.dtype);if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,Z3,i);var a=new Ar(Z3,n.shape,r.shape);return this.compileAndRun(a,[n,r],i)},t.prototype.packedUnaryOp=function(n,r,i){var a=new vb(n.shape,r);return this.compileAndRun(a,[n],i)},t.prototype.packedBinaryOp=function(n,r,i,a,o){o===void 0&&(o=!1);var s=new qu(i,n.shape,r.shape,o);return this.compileAndRun(s,[n,r],a)},t.prototype.complexSeparableBinaryOp=function(n,r,i){var a=this,o=this.texData.get(n.dataId),s=this.texData.get(r.dataId),u=[[o.complexTensors.real,s.complexTensors.real],[o.complexTensors.imag,s.complexTensors.imag]].map(function(d){var h=d[0],p=d[1],g=a.makeComplexComponentTensorInfo(n,h),m=a.makeComplexComponentTensorInfo(r,p),v=new Ar(i,n.shape,r.shape);return a.compileAndRun(v,[g,m],yi(h.dtype,p.dtype))}),l=u[0],c=u[1],f=this.complex(l,c);return l.dispose(),c.dispose(),f},t.prototype.makeComplexComponentTensorInfo=function(n,r){return{dataId:r.dataId,dtype:r.dtype,shape:n.shape}},t.prototype.addN=function(n){if(n.length===1)return n[0];if(n.length>pe().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var r=Math.floor(n.length/2),i=this.addN(n.slice(0,r)),a=this.addN(n.slice(r));return this.addN([i,a])}var o=n.map(function(l){return l.dtype}).reduce(function(l,c){return yi(l,c)}),s=n.map(function(l){return l.shape}),u=pe().getBool("WEBGL_PACK")?new mMe(n[0].shape,s):new gMe(n[0].shape,s);return this.compileAndRun(u,n,o)},t.prototype.subtract=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,J3);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.subtract(n,r);var i=yi(n.dtype,r.dtype);if(pe().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,J3,n.dtype);var a=new Ar(J3,n.shape,r.shape);return this.compileAndRun(a,[n,r],i)},t.prototype.pow=function(n,r){var i=pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new qu(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Ar(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,n.shape,r.shape),a=yi(n.dtype,r.dtype);return this.compileAndRun(i,[n,r],a)},t.prototype.ceil=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.ceil(n);if(pe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,PY,n.dtype);var r=new Pt(n.shape,PY);return this.compileAndRun(r,[n])},t.prototype.floor=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.floor(n);if(pe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,$Y,n.dtype);var r=new Pt(n.shape,$Y);return this.compileAndRun(r,[n])},t.prototype.sign=function(n){var r=new Pt(n.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(r,[n])},t.prototype.isNaN=function(n){var r=new Pt(n.shape,"return float(isnan(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.isInf=function(n){var r=new Pt(n.shape,"return float(isinf(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.isFinite=function(n){var r=new Pt(n.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.round=function(n){var r=new Pt(n.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(r,[n])},t.prototype.exp=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.exp(n);if(pe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,LY,n.dtype);var r=new Pt(n.shape,LY);return this.compileAndRun(r,[n])},t.prototype.expm1=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.expm1(n);if(pe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,BY,n.dtype);var r=new Pt(n.shape,BY);return this.compileAndRun(r,[n])},t.prototype.softmax=function(n,r){var i=Wr([r],n.shape),a=this.max(n,i),o=ya(a.shape,i),s=this.subtract(n,a.reshape(o)),u=this.exp(s),l=this.sum(u,i).reshape(o);return Cr(u,l)},t.prototype.log=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.log(n);if(pe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,n.dtype);var r=new Pt(n.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(r,[n])},t.prototype.log1p=function(n){var r=new Pt(n.shape,"return log(1.0 + x);");return this.compileAndRun(r,[n])},t.prototype.sqrt=function(n){var r=new Pt(n.shape,"return sqrt(x);");return this.compileAndRun(r,[n])},t.prototype.rsqrt=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.rsqrt(n);var r=new Pt(n.shape,"return inversesqrt(x);");return this.compileAndRun(r,[n])},t.prototype.reciprocal=function(n){var r=new Pt(n.shape,"return 1.0 / x;");return this.compileAndRun(r,[n])},t.prototype.relu=function(n){var r;return r=pe().getBool("WEBGL_PACK")?new vb(n.shape,zY):new Pt(n.shape,DY),this.compileAndRun(r,[n])},t.prototype.relu6=function(n){var r;return r=pe().getBool("WEBGL_PACK")?new vb(n.shape,jY):new Pt(n.shape,RY),this.compileAndRun(r,[n])},t.prototype.prelu=function(n,r){var i=pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new qu(iY,n.shape,r.shape):new Ar(rY,n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.elu=function(n){if(pe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,UY,n.dtype);var r=new Pt(n.shape,FY);return this.compileAndRun(r,[n])},t.prototype.eluDer=function(n,r){var i=pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new qu(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,n.shape,r.shape):new Ar("return (b >= 1.0) ? a : a * (b + 1.0);",n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.selu=function(n){var r=new Pt(n.shape,FPe);return this.compileAndRun(r,[n])},t.prototype.int=function(n){var r=new Pt(n.shape,"return float(int(x));");return this.compileAndRun(r,[n],"int32")},t.prototype.clip=function(n,r,i){var a,o=(a=pe().getBool("WEBGL_PACK_CLIP")?new RMe(n.shape):new DMe(n.shape)).getCustomSetupFunc(r,i);return this.compileAndRun(a,[n],null,o)},t.prototype.abs=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.abs(n);if(pe().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,NY,n.dtype);var r=new Pt(n.shape,NY);return this.compileAndRun(r,[n])},t.prototype.complexAbs=function(n){var r=this.texData.get(n.dataId),i=new FMe(n.shape),a=[this.makeComplexComponentTensorInfo(n,r.complexTensors.real),this.makeComplexComponentTensorInfo(n,r.complexTensors.imag)];return this.compileAndRun(i,a)},t.prototype.sigmoid=function(n){var r=new Pt(n.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(r,[n])},t.prototype.softplus=function(n){var r=new Pt(n.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(r,[n])},t.prototype.sin=function(n){var r=new Pt(n.shape,MPe);return this.compileAndRun(r,[n])},t.prototype.cos=function(n){var r=new Pt(n.shape,PPe);return this.compileAndRun(r,[n])},t.prototype.tan=function(n){var r=new Pt(n.shape,"return tan(x);");return this.compileAndRun(r,[n])},t.prototype.asin=function(n){var r=new Pt(n.shape,$Pe);return this.compileAndRun(r,[n])},t.prototype.acos=function(n){var r=new Pt(n.shape,LPe);return this.compileAndRun(r,[n])},t.prototype.atan=function(n){var r=new Pt(n.shape,BPe);return this.compileAndRun(r,[n])},t.prototype.atan2=function(n,r){var i=pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new qu(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new Ar(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,n.shape,r.shape);return this.compileAndRun(i,[n,r])},t.prototype.sinh=function(n){var r=new Pt(n.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},t.prototype.cosh=function(n){var r=new Pt(n.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},t.prototype.tanh=function(n){var r=new Pt(n.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(r,[n])},t.prototype.asinh=function(n){var r=new Pt(n.shape,zPe);return this.compileAndRun(r,[n])},t.prototype.acosh=function(n){var r=new Pt(n.shape,jPe);return this.compileAndRun(r,[n])},t.prototype.atanh=function(n){var r=new Pt(n.shape,UPe);return this.compileAndRun(r,[n])},t.prototype.erf=function(n){var r=new Pt(n.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(r,[n])},t.prototype.step=function(n,r){var i=new Pt(n.shape,function(a){return a===void 0&&(a=0),Vs+`
    return x > 0.0 ? 1.0 : float(`+a+`);
  `}(r));return this.compileAndRun(i,[n])},t.prototype.conv2dByMatMul=function(n,r,i,a,o,s){var u=n.shape,l=this.texData.get(n.dataId),c=i.inChannels,f=u[0]*u[1]*u[2],d=i.outChannels,h=i.dataFormat==="channelsLast",p=(f===1||d===1)&&c>1e3,g=u[2]%2!=0&&!!l.isPacked;if(p||!pe().getBool("WEBGL_LAZILY_UNPACK")||!pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!g){var m=h?u[0]*u[1]*u[2]:u[0]*u[2]*u[3],v=this.reshape(n,[1,m,i.inChannels]),y=this.reshape(r,[1,i.inChannels,i.outChannels]);return this.reshape(this.fusedBatchMatMul({a:v,b:y,transposeA:!1,transposeB:!1,bias:a,activation:o,preluActivationWeights:s}),i.outShape)}var b=h?u[0]*u[1]*(u[2]+1):u[0]*u[2]*(u[3]+1),x={dataId:n.dataId,shape:[1,b,i.inChannels],dtype:n.dtype},w=l.shape;l.shape=l.shape.slice(),l.shape[l.shape.length-2]++,U(rb(l.shape,x.shape),function(){return"packed reshape "+l.shape+" to "+x.shape+" isn't free"});var S=this.reshape(r,[1,i.inChannels,i.outChannels]),C=this.fusedBatchMatMul({a:x,b:S,transposeA:!1,transposeB:!1,bias:a,activation:o,preluActivationWeights:s}),_=this.texData.get(C.dataId);return U(_.isPacked,function(){return"batchMatMul result is expected to be packed"}),l.shape=w,_.shape=i.outShape,J.makeTensorFromDataId(C.dataId,i.outShape,C.dtype)},t.prototype.conv2dWithIm2Row=function(n,r,i,a,o,s){var u=i.filterWidth,l=i.filterHeight,c=i.inChannels,f=i.outWidth,d=i.outHeight,h=i.dataFormat==="channelsLast",p=u*l*c,g=d*f,m=[p,g],v=n.squeeze([0]),y=r.reshape([1,p,-1]),b=new oPe(m,v.shape,i),x=this.compileAndRun(b,[v]).reshape([1,m[0],m[1]]),w=a!=null,S=s!=null,C=o?ZS(o,!0):null,_=new Q3(x.shape,[1,g,i.outChannels],!0,!1,w,C,S),E=[x,y];a&&E.push(a),S&&E.push(s);var A=this.compileAndRun(_,E);return h?A.reshape([1,d,f,i.outChannels]):A.reshape([1,i.outChannels,d,f])},t.prototype.fusedConv2d=function(n){var r=n.input,i=n.filter,a=n.convInfo,o=n.bias,s=n.activation,u=n.preluActivationWeights;if(a.filterHeight===1&&a.filterWidth===1&&a.dilationHeight===1&&a.dilationWidth===1&&a.strideHeight===1&&a.strideWidth===1&&(a.padInfo.type==="SAME"||a.padInfo.type==="VALID"))return this.conv2dByMatMul(r,i,a,o,s,u);if(pe().getBool("WEBGL_CONV_IM2COL")&&r.shape[0]===1)return this.conv2dWithIm2Row(r,i,a,o,s,u);var l=o!=null,c=u!=null,f=s?ZS(s,!1):null,d=new aY(a,l,f,c),h=[r,i];return o&&h.push(o),u&&h.push(u),this.compileAndRun(d,h)},t.prototype.conv2d=function(n,r,i){if(i.filterHeight===1&&i.filterWidth===1&&i.dilationHeight===1&&i.dilationWidth===1&&i.strideHeight===1&&i.strideWidth===1&&(i.padInfo.type==="SAME"||i.padInfo.type==="VALID"))return this.conv2dByMatMul(n,r,i);if(pe().getBool("WEBGL_CONV_IM2COL")&&n.shape[0]===1)return this.conv2dWithIm2Row(n,r,i);var a=new aY(i);return this.compileAndRun(a,[n,r])},t.prototype.conv2dDerInput=function(n,r,i){var a=new LMe(i);return this.compileAndRun(a,[n,r])},t.prototype.conv2dDerFilter=function(n,r,i){var a=new $Me(i);return this.compileAndRun(a,[n,r])},t.prototype.fusedDepthwiseConv2D=function(n){var r,i=n.input,a=n.filter,o=n.convInfo,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=pe().getBool("WEBGL_PACK_DEPTHWISECONV")&&o.strideWidth<=2&&o.outChannels/o.inChannels==1,f=u?ZS(u,c):null,d=[i,a],h=s!=null,p=l!=null;return h&&d.push(s),p&&d.push(l),c?(r=new sY(o,h,f,p),this.compileAndRun(r,d)):(r=new oY(o,h,f,p),this.compileAndRun(r,d))},t.prototype.depthwiseConv2D=function(n,r,i){var a;return pe().getBool("WEBGL_PACK_DEPTHWISECONV")&&i.strideWidth<=2&&i.outChannels/i.inChannels==1?(a=new sY(i),this.compileAndRun(a,[n,r])):(a=new oY(i),this.compileAndRun(a,[n,r]))},t.prototype.depthwiseConv2DDerInput=function(n,r,i){var a=new UMe(i);return this.compileAndRun(a,[n,r])},t.prototype.depthwiseConv2DDerFilter=function(n,r,i){var a=new jMe(i);return this.compileAndRun(a,[n,r])},t.prototype.conv3d=function(n,r,i){var a=new WMe(i);return this.compileAndRun(a,[n,r])},t.prototype.conv3dDerInput=function(n,r,i){var a=new zMe(i);return this.compileAndRun(a,[n,r])},t.prototype.conv3dDerFilter=function(n,r,i){var a=new BMe(i);return this.compileAndRun(a,[n,r])},t.prototype.maxPool=function(n,r){var i=new mb(r,"max",!1);return this.compileAndRun(i,[n])},t.prototype.avgPool=function(n,r){var i=new mb(r,"avg",!1);return this.compileAndRun(i,[n],"float32")},t.prototype.maxPoolBackprop=function(n,r,i,a){var o=new mb(a,"max",!0),s=this.compileAndRun(o,[r]),u=new cPe(a),l=this.compileAndRun(u,[n,s],r.dtype);return s.dispose(),l},t.prototype.avgPoolBackprop=function(n,r,i){var a=new EMe(i);return this.compileAndRun(a,[n],r.dtype)},t.prototype.cast=function(n,r){return V3(n,r,this)},t.prototype.unstack=function(n,r){for(var i=n.shape[r],a=new Array(n.rank-1),o=0,s=0;s<n.rank;s++)s!==r&&(a[o++]=n.shape[s]);var u=new Array(n.rank).fill(0),l=n.shape.slice();l[r]=1;var c=new Array(i);for(s=0;s<c.length;s++)u[r]=s,c[s]=this.slice(n,u,l).reshape(a);return c},t.prototype.avgPool3d=function(n,r){var i=new eM(r,"avg",!1);return this.compileAndRun(i,[n],"float32")},t.prototype.avgPool3dBackprop=function(n,r,i){var a=new CMe(i);return this.compileAndRun(a,[n],r.dtype)},t.prototype.maxPool3d=function(n,r){var i=new eM(r,"max",!1);return this.compileAndRun(i,[n],"float32")},t.prototype.maxPool3dBackprop=function(n,r,i,a){var o=new eM(a,"max",!0),s=this.compileAndRun(o,[r]),u=new fPe(a),l=this.compileAndRun(u,[n,s],r.dtype);return s.dispose(),l},t.prototype.reshape=function(n,r){var i=this.texData.get(n.dataId);if(i.isPacked&&!rb(n.shape,r)&&(i.texture===null||!rb(i.shape,r))){var a=this.packedReshape(n,r);return J.makeTensorFromDataId(a.dataId,a.shape,a.dtype)}return GS(n,r)},t.prototype.resizeBilinear=function(n,r,i,a){var o=pe().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new wPe(n.shape,r,i,a):new xPe(n.shape,r,i,a);return this.compileAndRun(o,[n],"float32")},t.prototype.resizeBilinearBackprop=function(n,r,i){var a=new bPe(n,r,i);return this.compileAndRun(a,[n])},t.prototype.resizeNearestNeighbor=function(n,r,i,a){var o=new SPe(n.shape,r,i,a);return this.compileAndRun(o,[n])},t.prototype.resizeNearestNeighborBackprop=function(n,r,i){var a=new _Pe(n,r,i);return this.compileAndRun(a,[n])},t.prototype.multinomial=function(n,r,i,a){var o=r?n:Rh(n),s=o.shape[0],u=o.shape[1],l=new dPe(s,u,i),c=l.getCustomSetupFunc(a);return this.compileAndRun(l,[o],"int32",c)},t.prototype.oneHot=function(n,r,i,a){var o=new hPe(n.size,r,i,a);return this.compileAndRun(o,[n])},t.prototype.diag=function(n){var r=new XMe(n.size);return this.compileAndRun(r,[n])},t.prototype.nonMaxSuppression=function(n,r,i,a,o){return AS("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),G3(n.dataSync(),r.dataSync(),i,a,o)},t.prototype.cropAndResize=function(n,r,i,a,o,s){var u=new VMe(n.shape,r.shape,a,o,s);return this.compileAndRun(u,[n,r,i],"float32")},t.prototype.depthToSpace=function(n,r,i){U(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});var a=n.shape[0],o=i==="NHWC"?n.shape[1]:n.shape[2],s=i==="NHWC"?n.shape[2]:n.shape[3],u=i==="NHWC"?n.shape[3]:n.shape[1],l=o*r,c=s*r,f=u/(r*r),d=new KMe(i==="NHWC"?[a,l,c,f]:[a,f,l,c],r,i);return this.compileAndRun(d,[n])},t.prototype.split=function(n,r,i){return XX(n,r,i)},t.prototype.scatterND=function(n,r,i){var a=cb(0,n,i),o=a.sliceRank,s=a.numUpdates,u=a.sliceSize,l=a.strides,c=a.outputSize,f=[c/u,u],d=n.reshape([s,o]),h=r.reshape([s,u]);if(c===0)return GS(Rr([]),i);var p=Ve(0),g=new TY(s,o,d.rank,h.rank,l,f);return this.compileAndRun(g,[h,d,p]).reshape(i)},t.prototype.sparseToDense=function(n,r,i,a){var o=cb(0,n,i),s=o.sliceRank,u=o.numUpdates,l=o.strides,c=o.outputSize,f=new TY(u,s,n.rank,r.rank,l,[c,1],!1);return this.compileAndRun(f,[r,n,a]).reshape(i)},t.prototype.fft=function(n){return this.fftImpl(n,!1)},t.prototype.ifft=function(n){return this.fftImpl(n,!0)},t.prototype.fftImpl=function(n,r){var i=this.texData.get(n.dataId),a=new lY(ePe,n.shape,r),o=new lY(tPe,n.shape,r),s=[this.makeComplexComponentTensorInfo(n,i.complexTensors.real),this.makeComplexComponentTensorInfo(n,i.complexTensors.imag)],u=this.compileAndRun(a,s),l=this.compileAndRun(o,s),c=this.complex(u,l).as2D(n.shape[0],n.shape[1]);return u.dispose(),l.dispose(),c},t.prototype.gatherND=function(n,r){var i=r.shape,a=i[i.length-1],o=M3(n,r),s=o[0],u=o[1],l=o[2],c=o[3],f=r.reshape([u,a]),d=n.reshape([n.size/l,l]),h=new iPe(a,c,[u,l]);return this.compileAndRun(h,[d,f]).reshape(s)},t.prototype.fill=function(n,r,i){if((i=i||wm(r))==="string"){var a=Vy(i,et(n));return a.fill(r),J.makeTensor(a,n,i,this)}var o=new nPe(n,r),s=o.getCustomSetupFunc(r);return this.compileAndRun(o,[],i,s)},t.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(n.shape,1,n.dtype)},t.prototype.zerosLike=function(n){return this.fill(n.shape,n.dtype==="string"?"":0,n.dtype)},t.prototype.linspace=function(n,r,i){return q3(n,r,i)},t.prototype.makeTensorInfo=function(n,r){var i=this.write(null,n,r);return this.texData.get(i).usage=null,{dataId:i,shape:n,dtype:r}},t.prototype.makeOutput=function(n,r){var i=this.makeTensorInfo(n,r).dataId;return J.makeTensorFromDataId(i,n,r,this)},t.prototype.unpackTensor=function(n){var r=new VPe(n.shape);return this.runWebGLProgram(r,[n],n.dtype)},t.prototype.packTensor=function(n){var r=new pPe(n.shape);return this.runWebGLProgram(r,[n],n.dtype,null,!0)},t.prototype.packedReshape=function(n,r){var i=[tb(n.shape)].concat(nb(n.shape)),a={dtype:n.dtype,shape:i,dataId:n.dataId},o=[tb(r)].concat(nb(r)),s=new yPe(o,i),u=this.runWebGLProgram(s,[a],n.dtype,null,!0);return{dataId:u.dataId,shape:r,dtype:u.dtype}},t.prototype.decode=function(n){var r,i=this.texData.get(n),a=i.isPacked,o=i.shape,s=i.dtype,u=_S(o);return r=a?new GMe(u):new HMe(u),{dtype:s,shape:o,dataId:this.runWebGLProgram(r,[{shape:u,dtype:s,dataId:n}],s,null,!0).dataId}},t.prototype.runWebGLProgram=function(n,r,i,a,o){var s=this;o===void 0&&(o=!1);var u=this.makeTensorInfo(n.outputShape,i),l=this.texData.get(u.dataId);if(n.packedOutput&&(l.isPacked=!0),n.outPackingScheme===Yy.DENSE){var c=Zy(n.outputShape);l.texShape=c.map(function(b){return 2*b})}if(n.outTexUsage!=null&&(l.usage=n.outTexUsage),et(u.shape)===0)return l.values=Ih(u.dtype,0),u;var f=[],d=r.map(function(b){if(b.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var x=s.texData.get(b.dataId);if(x.texture==null){if(!n.packedInputs&&et(b.shape)<=pe().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:b.shape,texData:null,isUniform:!0,uniformValues:x.values};n.packedInputs&&(x.isPacked=!0,x.shape=b.shape)}else if(!!x.isPacked!=!!n.packedInputs)b=x.isPacked?s.unpackTensor(b):s.packTensor(b),f.push(b),x=s.texData.get(b.dataId);else if(x.isPacked&&!rb(x.shape,b.shape)){var w=b,S=b.shape;b.shape=x.shape,b=s.packedReshape(b,S),f.push(b),x=s.texData.get(b.dataId),w.shape=S}return s.uploadToGPU(b.dataId),{shape:b.shape,texData:x,isUniform:!1}});this.uploadToGPU(u.dataId);var h,p={shape:u.shape,texData:l,isUniform:!1},g=function(b,x,w){var S="";x.concat(w).forEach(function(E){var A=E.texData!=null&&E.texData.slice!=null&&E.texData.slice.flatOffset>0,k=E.isUniform?"uniform":E.texData.texShape;S+=E.shape+"_"+k+"_"+A});var C=b.userCode,_=b.constructor.name;return _+="_"+S+"_"+C}(n,d,p),m=this.getAndSaveBinary(g,function(){return function(b,x,w,S){var C=x.userCode,_=w.map(function(W,G){var K={logicalShape:W.shape,texShape:W.isUniform?null:W.texData.texShape,isUniform:W.isUniform,isPacked:!W.isUniform&&W.texData.isPacked,flatOffset:null};return W.texData!=null&&W.texData.slice!=null&&W.texData.slice.flatOffset>0&&(K.flatOffset=W.texData.slice.flatOffset),{name:x.variableNames[G],shapeInfo:K}}),E=_.map(function(W){return W.shapeInfo}),A={logicalShape:S.shape,texShape:S.texData.texShape,isUniform:!1,isPacked:S.texData.isPacked,flatOffset:null},k=yMe(_,A,C,x.packedInputs),T=b.createProgram(k),I=null,N=b.getUniformLocation(T,"NAN",!1);pe().getNumber("WEBGL_VERSION")===1&&(I=b.getUniformLocation(T,"INFINITY",!1));for(var O={},D=0;D<x.variableNames.length;D++){var L=x.variableNames[D];O[L]=b.getUniformLocation(T,L,!1),O["offset"+L]=b.getUniformLocation(T,"offset"+L,!1)}return{program:x,source:k,webGLProgram:T,uniformLocations:O,inShapeInfos:E,outShapeInfo:A,infLoc:I,nanLoc:N}}(s.gpgpu,n,d,p)}),v=this.activeTimers!=null;if(v&&(h=this.startTimer()),function(b,x,w,S,C){kY(x.inShapeInfos,w),kY([x.outShapeInfo],[S]);var _=S.texData.texture,E=S.texData.texShape;S.texData.isPacked?b.setOutputPackedMatrixTexture(_,E[0],E[1]):b.setOutputMatrixTexture(_,E[0],E[1]),b.setProgram(x.webGLProgram),pe().getNumber("WEBGL_VERSION")===1&&x.infLoc!==null&&b.gl.uniform1f(x.infLoc,1/0),x.nanLoc!==null&&b.gl.uniform1f(x.nanLoc,NaN),w.forEach(function(A,k){var T=x.program.variableNames[k],I=x.uniformLocations[T],N=x.uniformLocations["offset"+T];if(I!=null)if(A.isUniform)if(et(A.shape)<2)b.gl.uniform1f(I,A.uniformValues[0]);else{var O=A.uniformValues;O instanceof Float32Array||(O=new Float32Array(O)),b.gl.uniform1fv(I,O)}else A.texData.slice!=null&&N!=null&&b.gl.uniform1i(N,A.texData.slice.flatOffset),b.setInputMatrixTexture(A.texData.texture,I,k)}),C!=null&&C(b,x.webGLProgram),b.executeProgram()}(this.gpgpu,m,d,p,a),f.forEach(function(b){return s.disposeData(b.dataId)}),v&&(h=this.endTimer(h),this.activeTimers.push({name:n.constructor.name,query:this.getQueryTime(h)})),!pe().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&o===!1){var y=this.unpackTensor(u);return this.disposeData(u.dataId),y}return u},t.prototype.compileAndRun=function(n,r,i,a,o){o===void 0&&(o=!1),i=i||r[0].dtype;var s=this.runWebGLProgram(n,r,i,a,o);return J.makeTensorFromDataId(s.dataId,s.shape,s.dtype)},t.prototype.getAndSaveBinary=function(n,r){return n in this.binaryCache||(this.binaryCache[n]=r()),this.binaryCache[n]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){var n=this;this.disposed||(pe().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(r){n.gpgpu.deleteProgram(n.binaryCache[r].webGLProgram),delete n.binaryCache[r]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement!="undefined"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var n=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=le(function(){if(!pe().get("WEBGL_RENDER_FLOAT32_ENABLED")){var r=pe().getBool("DEBUG");pe().set("DEBUG",!1);var i=n.abs(Ve(1e-8)).dataSync()[0];if(pe().set("DEBUG",r),i>0)return 32}return 16})),this.floatPrecisionValue},t.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},t.prototype.uploadToGPU=function(n){var r,i=this.texData.get(n),a=i.shape,o=i.dtype,s=i.values,u=i.texture,l=i.usage,c=i.isPacked;if(u==null){var f,d=this.activeTimers!=null;d&&(f=zs());var h=i.texShape;if(h==null&&(h=cX(a,c),i.texShape=h),s!=null){var p=_S(a),g=void 0,m=h[1],v=h[0],y=s instanceof Uint8Array;c?(m=(r=Jy(h[0],h[1]))[0],v=r[1],g=new QMe(p,[v,m],y)):g=new JMe(p,[v,m],y);var b=this.makeTensorInfo([v,m],o);this.texData.get(b.dataId).usage=y?To.PIXELS:To.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(b.dataId),m,v,s);var x=this.runWebGLProgram(g,[b],o,null,!0),w=this.texData.get(x.dataId);i.texture=w.texture,i.texShape=w.texShape,i.isPacked=w.isPacked,i.usage=w.usage,this.disposeData(b.dataId),this.texData.delete(x.dataId),i.values=null,d&&(this.uploadWaitMs+=zs()-f)}else{var S=this.acquireTexture(h,l,o,c);i.texture=S}}},t.prototype.convertAndCacheOnCPU=function(n,r){var i=this.texData.get(n),a=i.dtype;return this.releaseGPUData(n),r!=null&&(i.values=function(o,s){if(s==="float32"||s==="complex64")return o;if(s==="int32"||s==="bool"){for(var u=s==="int32"?new Int32Array(o.length):new Uint8Array(o.length),l=0;l<u.length;++l)u[l]=Math.round(o[l]);return u}throw new Error("Unknown dtype "+s)}(r,a)),i.values},t.prototype.acquireTexture=function(n,r,i,a){if(this.numBytesInGPU+=this.computeBytes(n,i),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var o=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+o+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(n,r,a)},t.prototype.computeBytes=function(n,r){return n[0]*n[1]*RF(r)},t}(j3);qK()&&J.registerBackend("webgl",function(){return new WY},2);function $h(e,t){return e(t={exports:{}},t.exports),t.exports}var HPe=$h(function(e){(function(t,n,r){function i(s){var u,l=this,c=(u=4022871197,function(f){f=f.toString();for(var d=0;d<f.length;d++){var h=.02519603282416938*(u+=f.charCodeAt(d));h-=u=h>>>0,u=(h*=u)>>>0,u+=4294967296*(h-=u)}return 23283064365386963e-26*(u>>>0)});l.next=function(){var f=2091639*l.s0+23283064365386963e-26*l.c;return l.s0=l.s1,l.s1=l.s2,l.s2=f-(l.c=0|f)},l.c=1,l.s0=c(" "),l.s1=c(" "),l.s2=c(" "),l.s0-=c(s),l.s0<0&&(l.s0+=1),l.s1-=c(s),l.s1<0&&(l.s1+=1),l.s2-=c(s),l.s2<0&&(l.s2+=1),c=null}function a(s,u){return u.c=s.c,u.s0=s.s0,u.s1=s.s1,u.s2=s.s2,u}function o(s,u){var l=new i(s),c=u&&u.state,f=l.next;return f.int32=function(){return 4294967296*l.next()|0},f.double=function(){return f()+11102230246251565e-32*(2097152*f()|0)},f.quick=f,c&&(typeof c=="object"&&a(c,l),f.state=function(){return a(l,{})}),f}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.alea=o})(0,e,!1)}),GPe=$h(function(e){(function(t,n,r){function i(s){var u=this,l="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var f=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^f^f>>>8},s===(0|s)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=0|l.charCodeAt(c),u.next()}function a(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u}function o(s,u){var l=new i(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/(1<<21);while(d===0);return d},f.int32=l.next,f.quick=f,c&&(typeof c=="object"&&a(c,l),f.state=function(){return a(l,{})}),f}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.xor128=o})(0,e,!1)}),KPe=$h(function(e){(function(t,n,r){function i(s){var u=this,l="";u.next=function(){var f=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^f^f<<1)|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,s===(0|s)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=0|l.charCodeAt(c),c==l.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function a(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u.v=s.v,u.d=s.d,u}function o(s,u){var l=new i(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/(1<<21);while(d===0);return d},f.int32=l.next,f.quick=f,c&&(typeof c=="object"&&a(c,l),f.state=function(){return a(l,{})}),f}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.xorwow=o})(0,e,!1)}),XPe=$h(function(e){(function(t,n,r){function i(s){var u=this;u.next=function(){var l,c,f=u.x,d=u.i;return l=f[d],c=(l^=l>>>7)^l<<24,c^=(l=f[d+1&7])^l>>>10,c^=(l=f[d+3&7])^l>>>3,c^=(l=f[d+4&7])^l<<7,l=f[d+7&7],c^=(l^=l<<13)^l<<9,f[d]=c,u.i=d+1&7,c},function(l,c){var f,d=[];if(c===(0|c))d[0]=c;else for(c=""+c,f=0;f<c.length;++f)d[7&f]=d[7&f]<<15^c.charCodeAt(f)+d[f+1&7]<<13;for(;d.length<8;)d.push(0);for(f=0;f<8&&d[f]===0;++f);for(f==8?d[7]=-1:d[f],l.x=d,l.i=0,f=256;f>0;--f)l.next()}(u,s)}function a(s,u){return u.x=s.x.slice(),u.i=s.i,u}function o(s,u){s==null&&(s=+new Date);var l=new i(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/(1<<21);while(d===0);return d},f.int32=l.next,f.quick=f,c&&(c.x&&a(c,l),f.state=function(){return a(l,{})}),f}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.xorshift7=o})(0,e,!1)}),YPe=$h(function(e){(function(t,n,r){function i(s){var u=this;u.next=function(){var l,c,f=u.w,d=u.X,h=u.i;return u.w=f=f+1640531527|0,c=d[h+34&127],l=d[h=h+1&127],c^=c<<13,l^=l<<17,c^=c>>>15,l^=l>>>12,c=d[h]=c^l,u.i=h,c+(f^f>>>16)|0},function(l,c){var f,d,h,p,g,m=[],v=128;for(c===(0|c)?(d=c,c=null):(c+="\0",d=0,v=Math.max(v,c.length)),h=0,p=-32;p<v;++p)c&&(d^=c.charCodeAt((p+32)%c.length)),p===0&&(g=d),d^=d<<10,d^=d>>>15,d^=d<<4,d^=d>>>13,p>=0&&(g=g+1640531527|0,h=(f=m[127&p]^=d+g)==0?h+1:0);for(h>=128&&(m[127&(c&&c.length||0)]=-1),h=127,p=512;p>0;--p)d=m[h+34&127],f=m[h=h+1&127],d^=d<<13,f^=f<<17,d^=d>>>15,f^=f>>>12,m[h]=d^f;l.w=g,l.X=m,l.i=h}(u,s)}function a(s,u){return u.i=s.i,u.w=s.w,u.X=s.X.slice(),u}function o(s,u){s==null&&(s=+new Date);var l=new i(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/(1<<21);while(d===0);return d},f.int32=l.next,f.quick=f,c&&(c.X&&a(c,l),f.state=function(){return a(l,{})}),f}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.xor4096=o})(0,e,!1)}),ZPe=$h(function(e){(function(t,n,r){function i(s){var u=this,l="";u.next=function(){var f=u.b,d=u.c,h=u.d,p=u.a;return f=f<<25^f>>>7^d,d=d-h|0,h=h<<24^h>>>8^p,p=p-f|0,u.b=f=f<<20^f>>>12^d,u.c=d=d-h|0,u.d=h<<16^d>>>16^p,u.a=p-f|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,s===Math.floor(s)?(u.a=s/4294967296|0,u.b=0|s):l+=s;for(var c=0;c<l.length+20;c++)u.b^=0|l.charCodeAt(c),u.next()}function a(s,u){return u.a=s.a,u.b=s.b,u.c=s.c,u.d=s.d,u}function o(s,u){var l=new i(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/(1<<21);while(d===0);return d},f.int32=l.next,f.quick=f,c&&(typeof c=="object"&&a(c,l),f.state=function(){return a(l,{})}),f}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.tychei=o})(0,e,!1)}),Lh=$h(function(e){(function(t,n){var r,i=this,a=256,o=6,s="random",u=n.pow(a,o),l=n.pow(2,52),c=2*l,f=a-1;function d(v,y,b){var x=[],w=g(function _(E,A){var k,T=[],I=typeof E;if(A&&I=="object")for(k in E)try{T.push(_(E[k],A-1))}catch(N){}return T.length?T:I=="string"?E:E+"\0"}((y=y==1?{entropy:!0}:y||{}).entropy?[v,m(t)]:v??function(){try{var _;return r&&(_=r.randomBytes)?_=_(a):(_=new Uint8Array(a),(i.crypto||i.msCrypto).getRandomValues(_)),m(_)}catch(k){var E=i.navigator,A=E&&E.plugins;return[+new Date,i,A,i.screen,m(t)]}}(),3),x),S=new h(x),C=function(){for(var _=S.g(o),E=u,A=0;_<l;)_=(_+A)*a,E*=a,A=S.g(1);for(;_>=c;)_/=2,E/=2,A>>>=1;return(_+A)/E};return C.int32=function(){return 0|S.g(4)},C.quick=function(){return S.g(4)/4294967296},C.double=C,g(m(S.S),t),(y.pass||b||function(_,E,A,k){return k&&(k.S&&p(k,S),_.state=function(){return p(S,{})}),A?(n[s]=_,E):_})(C,w,"global"in y?y.global:this==n,y.state)}function h(v){var y,b=v.length,x=this,w=0,S=x.i=x.j=0,C=x.S=[];for(b||(v=[b++]);w<a;)C[w]=w++;for(w=0;w<a;w++)C[w]=C[S=f&S+v[w%b]+(y=C[w])],C[S]=y;(x.g=function(_){for(var E,A=0,k=x.i,T=x.j,I=x.S;_--;)E=I[k=f&k+1],A=A*a+I[f&(I[k]=I[T=f&T+E])+(I[T]=E)];return x.i=k,x.j=T,A})(a)}function p(v,y){return y.i=v.i,y.j=v.j,y.S=v.S.slice(),y}function g(v,y){for(var b,x=v+"",w=0;w<x.length;)y[f&w]=f&(b^=19*y[f&w])+x.charCodeAt(w++);return m(y)}function m(v){return String.fromCharCode.apply(0,v)}if(n["seed"+s]=d,g(n.random(),t),e.exports){e.exports=d;try{r=require("crypto")}catch(v){}}})([],Math)});Lh.alea=HPe,Lh.xor128=GPe,Lh.xorwow=KPe,Lh.xorshift7=XPe,Lh.xor4096=YPe,Lh.tychei=ZPe;var JS=Lh.alea,iM=Q({addN_:function(e){U(Array.isArray(e),function(){return"The argument passed to tf.addN() must be a list of tensors"}),U(e.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+e.length});var t=e.map(function(i,a){return j(i,"tensors"+a,"addN")}),n=t[0];t.forEach(function(i){if(i.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(function(i){if(!Ur(i.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var r=t;return J.runKernelFunc(function(i,a){return i.addN(t)},r,null,"AddN")}});function QS(){ES("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}function VY(e){return e.rank===0||e.rank===1?e.as4D(1,1,1,e.size):e.rank===2?e.as4D(1,1,e.shape[0],e.shape[1]):e.rank===3?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}function qY(e,t,n,r,i,a){a==null&&(a=.001);var o,s,u=j(e,"x","batchNorm"),l=j(t,"mean","batchNorm"),c=j(n,"variance","batchNorm");i!=null&&(o=j(i,"scale","batchNorm")),r!=null&&(s=j(r,"offset","batchNorm")),U(l.rank===c.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),U(s==null||l.rank===s.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),U(o==null||l.rank===o.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."});var f={x:u,scale:o,offset:s,mean:l,variance:c},d={varianceEpsilon:a};return J.runKernelFunc(function(h,p){var g=VY(u),m=h.batchNormalization(g,eE(l),eE(c),a,eE(o),eE(s));return p([u,l,c,o]),m},f,null,"FusedBatchNorm",d).reshape(u.shape)}function eE(e){return e==null?null:e.rank===0?e.as1D():e.rank===1?e:e.rank===2?e.as4D(1,1,e.shape[0],e.shape[1]):e.rank===3?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}var HY=Q({batchNormalization_:function(e,t,n,r,i,a){return r===void 0&&(r=.001),QS(),qY(e,t,n,a,i,r)}}),Bh=Q({batchNorm_:qY});function GY(e,t,n,r,i,a){var o,s,u=j(e,"x","batchNorm"),l=j(t,"mean","batchNorm"),c=j(n,"variance","batchNorm");return i!=null&&(o=j(i,"scale","batchNorm")),r!=null&&(s=j(r,"offset","batchNorm")),U(u.rank===2,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),U(l.rank===2||l.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+l.rank+"."}),U(c.rank===2||c.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+c.rank+"."}),o!=null&&U(o.rank===2||o.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+o.rank+"."}),s!=null&&U(s.rank===2||s.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."}),Bh(u,l,c,s,o,a)}var KY=Q({batchNormalization2d_:function(e,t,n,r,i,a){return r===void 0&&(r=.001),QS(),GY(e,t,n,a,i,r)}}),aM=Q({batchNorm2d_:GY});function XY(e,t,n,r,i,a){var o,s,u=j(e,"x","batchNorm"),l=j(t,"mean","batchNorm"),c=j(n,"variance","batchNorm");return i!=null&&(o=j(i,"scale","batchNorm")),r!=null&&(s=j(r,"offset","batchNorm")),U(u.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),U(l.rank===3||l.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+l.rank+"."}),U(c.rank===3||c.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+c.rank+"."}),o!=null&&U(o.rank===3||o.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+o.rank+"."}),s!=null&&U(s.rank===3||s.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."}),Bh(u,l,c,s,o,a)}var YY=Q({batchNormalization3d_:function(e,t,n,r,i,a){return r===void 0&&(r=.001),QS(),XY(e,t,n,a,i,r)}}),oM=Q({batchNorm3d_:XY});function ZY(e,t,n,r,i,a){var o,s,u=j(e,"x","batchNorm"),l=j(t,"mean","batchNorm"),c=j(n,"variance","batchNorm");return i!=null&&(o=j(i,"scale","batchNorm")),r!=null&&(s=j(r,"offset","batchNorm")),U(u.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."}),U(l.rank===4||l.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+l.rank+"."}),U(c.rank===4||c.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+c.rank+"."}),o!=null&&U(o.rank===4||o.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+o.rank+"."}),s!=null&&U(s.rank===4||s.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."}),Bh(u,l,c,s,o,a)}var JY=Q({batchNormalization4d_:function(e,t,n,r,i,a){return r===void 0&&(r=.001),QS(),ZY(e,t,n,a,i,r)}}),sM=Q({batchNorm4d_:ZY}),uM=Q({broadcastTo_:function(e,t){var n=j(e,"broadcastTo","x"),r=n.shape;if(t.some(function(f){return!(f>0)||f%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<n.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+n.rank+".");if(t.length>n.rank){for(var i=n.shape.slice();i.length<t.length;)i.unshift(1);n=n.reshape(i)}for(var a=n.shape,o=Array.from(t),s=t.length-1;s>=0;s--)if(a[s]===t[s])o[s]=1;else if(n.shape[s]!==1)throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+t+"].");var u=o.map(function(f,d){return f>1?d:-1}).filter(function(f){return f>=0});if(u.length===0)return n.clone();var l={x:n},c={shape:t,inputShape:a};return J.runKernelFunc(function(f){return f.tile(n,o)},l,function(f){return{x:function(){return f.sum(u,!0)}}},l3,c)}}),QY=Q({clone_:function(e){var t=j(e,"x","clone",null);return J.runKernelFunc(function(){return J.makeTensorFromDataId(t.dataId,t.shape,t.dtype)},{x:t},null,f3)}}),Hu=Q({logicalAnd_:function(e,t){var n=j(e,"a","logicalAnd","bool"),r=j(t,"b","logicalAnd","bool");return Qt(n.shape,r.shape),J.runKernelFunc(function(i){return i.logicalAnd(n,r)},{a:n,b:r},null,"LogicalAnd")}}),lM=Q({logicalNot_:function(e){var t=j(e,"x","logicalNot","bool");return J.runKernelFunc(function(n){return n.logicalNot(t)},{$x:t})}}),tE=Q({logicalOr_:function(e,t){var n=j(e,"a","logicalOr","bool"),r=j(t,"b","logicalOr","bool");return Qt(n.shape,r.shape),J.runKernelFunc(function(i){return i.logicalOr(n,r)},{$a:n,$b:r})}}),eZ=Q({logicalXor_:function(e,t){var n=j(e,"a","logicalXor","bool"),r=j(t,"b","logicalXor","bool");return Qt(n.shape,r.shape),tE(e,t).logicalAnd(Hu(e,t).logicalNot())}}),qs=Q({where_:function(e,t,n){var r=j(t,"a","where"),i=j(n,"b","where"),a=j(e,"condition","where","bool");return ln(r.shape,i.shape,"Error in where: "),a.rank===1?U(a.shape[0]===r.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):ln(a.shape,i.shape,"Error in where: "),J.runKernelFunc(function(o,s){var u=o.select(a,r,i);return s([a]),u},{$condition:a,$a:r,$b:i},function(o,s){var u=s[0];return{$condition:function(){return en(u).toFloat()},$a:function(){return o.mul(u.cast(o.dtype))},$b:function(){return o.mul(u.logicalNot().cast(o.dtype))}}})}}),nE=function(e){return tt(this,void 0,void 0,function(){var t,n,r;return nt(this,function(i){switch(i.label){case 0:return[4,(t=j(e,"condition","whereAsync","bool")).data()];case 1:return n=i.sent(),r=X3(t.shape,n),e!==t&&t.dispose(),[2,r]}})})},rE=Q({divNoNan_:function(e,t){var n,r=j(e,"a","div"),i=j(t,"b","div");r=(n=ur(r,i))[0],i=n[1];var a=Cr(r,i),o=en(a),s=i.equal(o);return qs(s,o,a)}}),sc=Q({tile_:function(e,t){var n=j(e,"x","tile",null);U(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+t+"."});var r=[n],i={x:n},a={reps:t};return J.runKernelFunc(function(o,s){var u=o.tile(n,t);return s([n]),u},i,null,d3,a,r)}}),iE=Q({eye_:function(e,t,n,r){r===void 0&&(r="float32"),t==null&&(t=e);for(var i=Ot([e,t],r),a=e<=t?e:t,o=0;o<a;++o)i.set(1,o,o);var s=i.toTensor().as2D(e,t);if(n==null)return s;if(n.length===1)return sc(Do(s,0),[n[0],1,1]);if(n.length===2)return sc(Do(Do(s,0),0),[n[0],n[1],1,1]);if(n.length===3)return sc(Do(Do(Do(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),cM=Q({multinomial_:function(e,t,n,r){r===void 0&&(r=!1);var i=j(e,"logits","multinomial"),a=i.size,o=i.rank;if(a<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+a+".");if(o>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+o);n=n||Math.random();var s=o===1?i.as2D(1,-1):i,u=J.runKernelFunc(function(l){return l.multinomial(s,r,t,n)},{logits2D:s});return o===1?u.as1D():u}}),zh=Q({oneHot_:function(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var i=j(e,"indices","oneHot","int32"),a=i.shape.concat([t]),o={indices:i=i.flatten()},s={depth:t,onValue:n,offValue:r};return J.runKernelFunc(function(u,l){return l([i]),u.oneHot(i,t,n,r)},o,null,c3,s).reshape(a)}}),Gu=Q({pad_:function(e,t,n){n===void 0&&(n=0);var r=j(e,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var i={paddings:t,constantValue:n},a={x:r};return J.runKernelFunc(function(o,s){return s([r]),o.pad(r,t,n)},a,null,h3,i)}}),tZ=Q({pad1d_:function(e,t,n){return n===void 0&&(n=0),U(t.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),Gu(e,[t],n)}}),nZ=Q({pad2d_:function(e,t,n){return n===void 0&&(n=0),U(t.length===2&&t[0].length===2&&t[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Gu(e,t,n)}}),rZ=Q({pad3d_:function(e,t,n){return n===void 0&&(n=0),U(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Gu(e,t,n)}}),iZ=Q({pad4d_:function(e,t,n){return n===void 0&&(n=0),U(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),Gu(e,t,n)}}),aZ=Q({rand_:function(e,t,n){var r=et(e),i=null;if(n==null||n==="float32")i=new Float32Array(r);else if(n==="int32")i=new Int32Array(r);else{if(n!=="bool")throw new Error("Unknown data type "+n);i=new Uint8Array(r)}for(var a=0;a<r;a++)i[a]=t();return J.makeTensor(i,e,n)}}),JPe=.001,oZ=.1;function fM(){return J.backend.floatPrecision()===32?JPe:oZ}function dM(e,t,n){var r=!0;if((Ni(e)||Ni(t))&&(r=!1),Ni(e)&&Ni(t)&&(r=!0),r){var i=e.constructor.name,a=t.constructor.name;if(i!==a)throw new Error("Arrays are of different type. Actual: "+i+". Expected: "+a)}if(Array.isArray(e)&&Array.isArray(t)){var o=ju(e),s=ju(t);if(!Ur(o,s))throw new Error("Arrays have different shapes. Actual: ["+o+"]. Expected: ["+s+"]")}var u=Ni(e)?e:tc(e),l=Ni(t)?t:tc(t);if(u.length!==l.length)throw new Error("Arrays have different lengths actual: "+u.length+" vs expected: "+l.length+`.
Actual:   `+u+`.
Expected: `+l+".");for(var c=0;c<l.length;++c){var f=u[c],d=l[c];if(!n(f,d))throw new Error("Arrays differ: actual["+c+"] = "+f+", expected["+c+"] = "+d+`.
Actual:   `+u+`.
Expected: `+l+".")}}function hM(e,t,n){return!isFinite(e)&&!isFinite(t)||!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}var QPe=Object.freeze({TEST_EPSILON_FLOAT16:oZ,expectArraysClose:function(e,t,n){return n==null&&(n=fM()),dM(e,t,function(r,i){return hM(r,i,n)})},testEpsilon:fM,expectPromiseToFail:function(e,t){e().then(function(){return t.fail()},function(){return t()})},expectArraysEqual:function(e,t){var n=typeof t=="string"||typeof t=="number"||typeof t=="boolean"?[t]:t;return kf(e)||kf(e[0])||kf(t)||kf(t[0])?dM(e,n,function(r,i){return r==i}):dM(e,t,function(r,i){return hM(r,i,0)})},expectNumbersClose:function(e,t,n){if(n==null&&(n=fM()),!hM(e,t,n))throw new Error("Numbers differ: actual === "+e+", expected === "+t)},expectValuesInRange:function(e,t,n){for(var r=0;r<e.length;r++)if(e[r]<t||e[r]>n)throw new Error("Value out of range:"+e[r]+" low: "+t+", high: "+n)},expectArrayBuffersEqual:function(e,t){expect(new Float32Array(e)).toEqual(new Float32Array(t))}}),pM=function(){function e(t,n,r,i,a){this.mean=t,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=i,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var o=a||Math.random();this.random=JS(o.toString())}return e.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var n,r,i=!1;!i;){var a=void 0,o=void 0,s=void 0;do s=(a=2*this.random()-1)*a+(o=2*this.random()-1)*o;while(s>=1||s===0);var u=Math.sqrt(-2*Math.log(s)/s);n=this.mean+this.stdDev*a*u,r=this.mean+this.stdDev*o*u,this.truncated&&!this.isValidTruncated(n)||(i=!0)}return this.truncated&&!this.isValidTruncated(r)||(this.nextVal=this.convertValue(r)),this.convertValue(n)},e.prototype.convertValue=function(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)},e.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},e}(),e$e=function(){function e(t,n,r,i){this.alpha=t,this.beta=1/n,this.dtype=r;var a=i||Math.random();this.randu=JS(a.toString()),this.randn=new pM(0,1,r,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return e.prototype.nextValue=function(){for(var t,n,r,i,a,o;;){do i=this.randn.nextValue(),o=1+this.c*i;while(o<=0);if(o*=o*o,n=1-.331*(t=i*i)*t,r=.5*t+this.d*(1-o+Math.log(o)),(a=this.randu())<n||Math.log(a)<r)break}return o=1/this.beta*this.d*o,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)},e.prototype.convertValue=function(t){return this.dtype==="float32"?t:Math.round(t)},e}(),t$e=function(){function e(t,n,r,i){var a=this;if(t===void 0&&(t=0),n===void 0&&(n=1),this.canReturnFloat=function(){return a.dtype==null||a.dtype==="float32"},this.min=t,this.range=n-t,this.dtype=r,i==null&&(i=Math.random()),typeof i=="number"&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+n+" <= 1 and dtype is not float");this.random=JS(i)}return e.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},e.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},e}(),sZ=Q({randomGamma_:function(e,t,n,r,i){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error("Unsupported data type "+r);for(var a=new e$e(t,n,r,i),o=Ot(e,r),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),gM=Q({randomNormal_:function(e,t,n,r,i){if(t===void 0&&(t=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var a=new pM(t,n,r,!1,i),o=Ot(e,r),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),jh=Q({randomUniform_:function(e,t,n,r,i){t===void 0&&(t=0),n===void 0&&(n=1),r===void 0&&(r="float32");for(var a=Ot(e,r),o=new t$e(t,n,null,i),s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}}),aE=Q({square_:function(e){var t=j(e,"x","square"),n=[t];return J.runKernelFunc(function(r,i){return i([t]),r.square(t)},{x:t},null,"Square",{},n,[])}}),oE=Q({squaredDifference_:function(e,t){var n,r=j(e,"a","squaredDifference"),i=j(t,"b","squaredDifference");n=ur(r,i),r=n[0],i=n[1],Qt(r.shape,i.shape);var a={a:r,b:i},o=[r,i];return J.runKernelFunc(function(s,u){var l=s.squaredDifference(r,i);return u([r,i]),l},a,function(s,u){var l=u[0],c=u[1],f=Ve(2);return{a:function(){return s.mul(l.sub(c).mul(f))},b:function(){return s.mul(c.sub(l).mul(f))}}},sb,{},o,[])}}),yb=Q({truncatedNormal_:function(e,t,n,r,i){if(t===void 0&&(t=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");for(var a=new pM(t,n,r,!0,i),o=Ot(e,r),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),Uh=Q({equal_:function(e,t){var n,r=j(e,"a","equal"),i=j(t,"b","equal");return n=ur(r,i),r=n[0],i=n[1],Qt(r.shape,i.shape),J.runKernelFunc(function(a){return a.equal(r,i)},{$a:r,$b:i})}}),uZ=Q({equalStrict_:function(e,t){var n=j(e,"a","equalStrict"),r=j(t,"b","equalStrict");return ln(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),Rm=Q({greater_:function(e,t){var n,r=j(e,"a","greater"),i=j(t,"b","greater");return n=ur(r,i),r=n[0],i=n[1],Qt(r.shape,i.shape),J.runKernelFunc(function(a){return a.greater(r,i)},{a:r,b:i},null,"Greater")}}),bb=Q({greaterEqual_:function(e,t){var n,r=j(e,"a","greaterEqual"),i=j(t,"b","greaterEqual");return n=ur(r,i),r=n[0],i=n[1],Qt(r.shape,i.shape),J.runKernelFunc(function(a,o){var s=a.greaterEqual(r,i);return o([r,i]),s},{a:r,b:i},function(a,o){var s=o[0],u=o[1];return{a:function(){return en(s)},b:function(){return en(u)}}},"GreaterEqual")}}),lZ=Q({greaterEqualStrict_:function(e,t){var n=j(e,"a","greaterEqualStrict"),r=j(t,"b","greaterEqualStrict");return ln(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),cZ=Q({greaterStrict_:function(e,t){var n=j(e,"a","greaterStrict"),r=j(t,"b","greaterStrict");return ln(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),mM=Q({less_:function(e,t){var n,r=j(e,"a","less"),i=j(t,"b","less");return n=ur(r,i),r=n[0],i=n[1],Qt(r.shape,i.shape),J.runKernelFunc(function(a){return a.less(r,i)},{a:r,b:i},null,"Less")}}),vM=Q({lessEqual_:function(e,t){var n,r=j(e,"a","lessEqual"),i=j(t,"b","lessEqual");return n=ur(r,i),r=n[0],i=n[1],Qt(r.shape,i.shape),J.runKernelFunc(function(a,o){var s=a.lessEqual(r,i);return o([r,i]),s},{a:r,b:i},null,"LessEqual")}}),fZ=Q({lessEqualStrict_:function(e,t){var n=j(e,"a","lessEqualStrict"),r=j(t,"b","lessEqualStrict");return ln(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),dZ=Q({lessStrict_:function(e,t){var n=j(e,"a","lessStrict"),r=j(t,"b","lessStrict");return ln(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),Fm=Q({notEqual_:function(e,t){var n,r=j(e,"a","notEqual"),i=j(t,"b","notEqual");return n=ur(r,i),r=n[0],i=n[1],Qt(r.shape,i.shape),J.runKernelFunc(function(a){return a.notEqual(r,i)},{a:r,b:i},null,"NotEqual")}}),hZ=Q({notEqualStrict_:function(e,t){var n=j(e,"a","notEqualStrict"),r=j(t,"b","notEqualStrict");return ln(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function pZ(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function gZ(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var Mm=Q({gather_:function(e,t,n){n===void 0&&(n=0);var r=j(e,"x","gather"),i=j(t,"indices","gather","int32");n=Wr(n,r.shape)[0];var a=function(o,s,u){for(var l=o.shape[u],c=[],f=1,d=1,h=0;h<u;h++)c.push(o.shape[h]),f*=o.shape[h];for(h=0;h<s.rank;h++)c.push(s.shape[h]);for(h=u+1;h<o.rank;h++)c.push(o.shape[h]),d*=o.shape[h];return{batchSize:f,sliceSize:d,dimSize:l,outputShape:c}}(r,i,n);return J.runKernelFunc(function(o,s){var u=o.gather(r,i.flatten(),n);return s([i]),u},{x:r,indices:i},function(o,s){var u=s[0];return{x:function(){var l=r.shape,c=u.size,f=l.slice(0,n),d=f.length,h=l.slice(n,l.length).slice(1),p=h.length,g=pZ(0,d),m=pZ(d+1,d+1+p),v=gZ([f,[c],h]),y=o.reshape(v),b=u.reshape([c]),x=gZ([[d],g,m]),w=y.transpose(x),S=yM(w,b,r.shape[n]),C=kS(x);return S=S.transpose(C)},indices:function(){return u}}},"Gather",{axis:n}).reshape(a.outputShape)}}),yM=Q({unsortedSegmentSum_:function(e,t,n){var r=j(e,"x","unsortedSegmentSum"),i=j(t,"segmentIds","unsortedSegmentSum","int32");return U(gr(n),function(){return"numSegments must be of dtype int"}),J.runKernelFunc(function(a,o){var s=a.unsortedSegmentSum(r,i,n);return o([i]),s},{$x:r},function(a,o){var s=o[0];return{$x:function(){return function(u,l){for(var c=Vu(l,en(l)),f=Mm(u,c),d=bb(l,Ve(0,"int32")),h=f.rank-d.rank,p=0;p<h;++p)d=Do(d,p+1);d=Hu(d,Wu(f.shape,"bool"));var g=en(f);return qs(d,f,g)}(a,s)}}})}}),mZ=function(e,t,n){return tt(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f,d,h,p,g;return nt(this,function(m){switch(m.label){case 0:for(r=j(e,"tensor","boolMask"),i=j(t,"mask","boolMask","bool"),a=n??0,o=i.rank,s=r.shape,U(o>0,function(){return"mask cannot be scalar"}),ln(s.slice(a,a+o),i.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,l=a;l<a+o;l++)u*=s[l];return c=s.slice(0,a).concat([u],s.slice(a+o)),f=r.reshape(c),d=i.reshape([-1]),[4,nE(d)];case 1:return h=m.sent(),p=h.squeeze([1]),g=Mm(f,p,a),e!==r&&r.dispose(),t!==i&&i.dispose(),p.dispose(),f.dispose(),d.dispose(),h.dispose(),[2,g]}})})};function vZ(e,t,n,r,i,a,o){a===void 0&&(a="NHWC"),U(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var s=e,u=t,l=!1;t.rank===3&&(l=!0,u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),s=[1,e[0],e[1],e[2]]),U(s.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."}),U(u.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank}),U(n.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank});var c=a==="NHWC"?s[3]:s[1],f=a==="NHWC"?u.shape[3]:u.shape[1];U(c===n.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+c+") must match input depth for filter "+n.shape[2]+"."}),U(f===n.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+f+") must match output depth for filter "+n.shape[3]+"."}),o!=null&&U(gr(i),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."});var d=HS(a),h=Mf(s,n.shape,r,1,i,o,!1,d),p=J.runKernelFunc(function(g,m){var v=g.conv2dDerInput(u,n,h);return m([n,u]),v},{dy4D:u,filter:n},function(g,m){var v=m[0],y=m[1];return{dy4D:function(){return Wh(g,v,r,i,a,1,o)},filter:function(){return xM(g,y,v.shape,r,i,a,o)}}});return l?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}function bM(e){var t=function(a){return typeof a=="number"?[a,a,a]:a.length===2?[a[0],a[1],1]:a}(e),n=t[0],r=t[1],i=t[2];return n===1&&r===1&&i===1}function yZ(e,t,n,r,i){U(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var a=e,o=t,s=!1;t.rank===4&&(s=!0,o=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),a=[1,e[0],e[1],e[2],e[3]]);var u=a[4],l=o.shape[4];U(a.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+a.length+"."}),U(o.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+o.rank}),U(n.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank}),U(u===n.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."}),U(l===n.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+l+") must match output depth for filter "+n.shape[4]+"."});var c=hb(a,n.shape,r,1,i),f=J.runKernelFunc(function(d){return d.conv3dDerInput(o,n,c)},{dy5D:o});return s?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}var sE=Q({conv1d_:function(e,t,n,r,i,a,o){i===void 0&&(i="NWC"),a===void 0&&(a=1);var s=j(e,"x","conv1d"),u=j(t,"filter","conv1d"),l=s,c=!1;s.rank===2&&(c=!0,l=s.as3D(1,s.shape[0],s.shape[1])),U(l.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+l.rank+"."}),U(u.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."}),o!=null&&U(gr(r),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."}),U(l.shape[2]===u.shape[1],function(){return"Error in conv1d: depth of input ("+l.shape[2]+") must match input depth for filter "+u.shape[1]+"."}),U(Gi(n,a),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+a+"'"}),U(i==="NWC",function(){return"Error in conv1d: got dataFormat of "+i+" but only NWC is currently supported."});var f=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),d=l.as4D(l.shape[0],1,l.shape[1],l.shape[2]),h=Wh(d,f,[1,n],r,"NHWC",[1,a],o);return c?h.as2D(h.shape[2],h.shape[3]):h.as3D(h.shape[0],h.shape[2],h.shape[3])}}),Wh=Q({conv2d_:function(e,t,n,r,i,a,o){i===void 0&&(i="NHWC"),a===void 0&&(a=[1,1]);var s=j(e,"x","conv2d"),u=j(t,"filter","conv2d"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),U(l.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+l.rank+"."}),U(u.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."}),o!=null&&U(gr(r),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var f=i==="NHWC"?l.shape[3]:l.shape[1];U(f===u.shape[2],function(){return"Error in conv2d: depth of input ("+f+") must match input depth for filter "+u.shape[2]+"."}),U(Gi(n,a),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"});var d=HS(i),h=Mf(l.shape,u.shape,n,a,r,o,!1,d),p=[u,l],g=J.runKernelFunc(function(m,v){var y=m.conv2d(l,u,h);return v([u,l]),y},{x:l,filter:u},function(m,v){var y=v,b=y[0],x=y[1];return U(Fh(a),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+a+"'"}),{x:function(){return bZ(x.shape,m,b,n,r,i)},filter:function(){return xM(x,m,b.shape,n,r,i)}}},"Conv2D",h,p);return c?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}}),uE=Q({conv3d_:function(e,t,n,r,i,a){i===void 0&&(i="NDHWC"),a===void 0&&(a=[1,1,1]);var o=j(e,"x","conv3d"),s=j(t,"filter","conv3d"),u=o,l=!1;o.rank===4&&(l=!0,u=o.as5D(1,o.shape[0],o.shape[1],o.shape[2],o.shape[3])),U(u.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."}),U(s.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."}),U(u.shape[4]===s.shape[3],function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."}),U(function(d,h){return bM(d)||bM(h)}(n,a),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),U(i==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+i+" but only NDHWC is currently supported."});var c=hb(u.shape,s.shape,n,a,r),f=J.runKernelFunc(function(d,h){var p=d.conv3d(u,s,c);return h([u,s]),p},{x:u,$filter:s},function(d,h){U(bM(a),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+a+"'"});var p=h[0],g=h[1];return{x:function(){return yZ(p.shape,d,g,n,r)},$filter:function(){return function(m,v,y,b,x){var w=m;m.rank===4&&(w=m.as5D(1,m.shape[0],m.shape[1],m.shape[2],m.shape[3]));var S=v;S.rank===4&&(S=v.as5D(1,v.shape[0],v.shape[1],v.shape[2],v.shape[3])),U(w.rank===5,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+w.shape+"."}),U(S.rank===5,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+S.shape+"."}),U(y.length===5,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+y+"."}),U(w.shape[4]===y[3],function(){return"Error in conv3dDerFilter: depth of input "+w.shape[4]+") must match input depth in filter ("+y[3]+"."}),U(S.shape[4]===y[4],function(){return"Error in conv3dDerFilter: depth of dy ("+S.shape[4]+") must match output depth for filter ("+y[4]+")."});var C=hb(w.shape,y,b,1,x);return J.runKernelFunc(function(_){return _.conv3dDerFilter(w,S,C)},{x5D:w,dy5D:S})}(p,d,g.shape,n,r)}}});return l?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),xM=Q({conv2dDerFilter_:function(e,t,n,r,i,a,o){a===void 0&&(a="NHWC");var s=e;e.rank===3&&(s=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var u=t;u.rank===3&&(u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),U(s.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."}),U(u.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."}),U(n.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."});var l=a==="NHWC"?s.shape[3]:s.shape[1],c=a==="NHWC"?u.shape[3]:u.shape[1];U(l===n[2],function(){return"Error in conv2dDerFilter: depth of input "+l+") must match input depth in filter ("+n[2]+"."}),U(c===n[3],function(){return"Error in conv2dDerFilter: depth of dy ("+c+") must match output depth for filter ("+n[3]+")."}),o!=null&&U(gr(i),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."});var f=HS(a),d=Mf(s.shape,n,r,1,i,o,!1,f);return J.runKernelFunc(function(h){return h.conv2dDerFilter(s,u,d)},{x4D:s,dy4D:u})}}),bZ=Q({conv2dDerInput_:vZ}),Pm=Q({depthwiseConv2d_:function(e,t,n,r,i,a,o){a===void 0&&(a=[1,1]);var s=j(e,"x","depthwiseConv2d"),u=j(t,"filter","depthwiseConv2d"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),U(l.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+l.rank+"."}),U(u.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."}),U(l.shape[3]===u.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+l.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."}),a==null&&(a=[1,1]),U(Gi(n,a),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),o!=null&&U(gr(r),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var f=Mf(l.shape,u.shape,n,a,r,o,!0),d=[l,u],h=J.runKernelFunc(function(p,g){var m=p.depthwiseConv2D(l,u,f);return g([l,u]),m},{x:l,filter:u},function(p,g){U(Fh(a),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+a+"'"});var m=g[0],v=g[1];return{x:function(){return xZ(m.shape,p,v,f)},filter:function(){return wZ(m,p,v.shape,f)}}},"DepthwiseConv2dNative",f,d);return c?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}}),xZ=Q({depthwiseConv2dDerInput_:function(e,t,n,r){var i=t,a=!1;t.rank===3&&(a=!0,i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var o=J.runKernelFunc(function(s){return s.depthwiseConv2DDerInput(i,n,r)},{dy4D:i});return a?o.as3D(o.shape[1],o.shape[2],o.shape[3]):o}}),wZ=Q({depthwiseConv2dDerFilter_:function(e,t,n,r){var i=e;e.rank===3&&(i=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var a=t;return a.rank===3&&(a=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),J.runKernelFunc(function(o){return o.depthwiseConv2DDerFilter(i,a,r)},{x4D:i,dy4D:a})}}),wM=Q({separableConv2d_:function(e,t,n,r,i,a,o){a===void 0&&(a=[1,1]),o===void 0&&(o="NHWC");var s=j(e,"x","separableConv2d"),u=j(t,"depthwiseFilter","separableConv2d"),l=j(n,"pointwiseFilter","separableConv2d"),c=s,f=!1;if(s.rank===3&&(f=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");U(c.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+c.rank+"."}),U(u.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."}),U(l.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."}),U(l.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+l.shape[0]+"."}),U(l.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+l.shape[1]+"."});var d=u.shape[2],h=u.shape[3];U(l.shape[2]===d*h,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+d*h+", but got "+l.shape[2]+"."});var p=Pm(c,u,r,i,o,a),g=Wh(p,l,1,"valid",o);return f?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}}),lE=Q({conv2dTranspose_:function(e,t,n,r,i,a){return vZ(n,j(e,"x","conv2dTranspose"),j(t,"filter","conv2dTranspose"),r,i,"NHWC",a)}}),_Z=Q({conv3dTranspose_:function(e,t,n,r,i){return yZ(n,j(e,"x","conv3dTranspose"),j(t,"filter","conv3dTranspose"),r,i)}}),cE=Q({matMul_:function(e,t,n,r){var i;n===void 0&&(n=!1),r===void 0&&(r=!1);var a=j(e,"a","matMul"),o=j(t,"b","matMul");i=ur(a,o),a=i[0],o=i[1];var s=n?a.shape[a.rank-2]:a.shape[a.rank-1],u=r?o.shape[o.rank-1]:o.shape[o.rank-2],l=n?a.shape[a.rank-1]:a.shape[a.rank-2],c=r?o.shape[o.rank-2]:o.shape[o.rank-1],f=a.shape.slice(0,-2),d=o.shape.slice(0,-2),h=et(f),p=et(d);U(a.rank>=2&&o.rank>=2&&a.rank===o.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+a.rank+" and "+o.rank+"."}),U(Ur(f,d),function(){return"Error in matMul: outer dimensions ("+f+") and ("+d+") of Tensors with shapes "+a.shape+" and "+o.shape+" must match."}),U(s===u,function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+a.shape+" and "+o.shape+" and transposeA="+n+" and transposeB="+r+" must match."});var g=a.shape.slice(0,-2).concat([l,c]),m=n?a.as3D(h,s,l):a.as3D(h,l,s),v=r?o.as3D(p,c,u):o.as3D(p,u,c),y={transposeA:n,transposeB:r};return J.runKernelFunc(function(b,x){var w=b.batchMatMul(m,v,n,r);return x([m,v]),w},{a:m,b:v},function(b,x){var w=x,S=w[0],C=w[1];return n||r?!n&&r?{a:function(){return b.matMul(C,!1,!1)},b:function(){return b.matMul(S,!0,!1)}}:n&&!r?{a:function(){return C.matMul(b,!1,!0)},b:function(){return S.matMul(b,!1,!1)}}:{a:function(){return C.matMul(b,!0,!0)},b:function(){return b.matMul(S,!0,!0)}}:{a:function(){return b.matMul(C,!1,!0)},b:function(){return S.matMul(b,!0,!1)}}},"BatchMatMul",y).reshape(g)}}),SZ=Q({dot_:function(e,t){var n=j(e,"t1","dot"),r=j(t,"t2","dot");U(!(n.rank!==1&&n.rank!==2||r.rank!==1&&r.rank!==2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."});var i=n.rank===1?n.size:n.shape[1],a=r.rank===1?r.size:r.shape[0];return U(i===a,function(){return"Error in dot: inner dimensions of inputs must match, but got "+i+" and "+a+"."}),n.rank===1&&r.rank===1?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():n.rank===1&&r.rank===2?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():n.rank===2&&r.rank===1?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),EZ=Q({outerProduct_:function(e,t){var n=j(e,"v1","outerProduct"),r=j(t,"v2","outerProduct");return U(n.rank===1&&r.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."}),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),Ku=Q({reverse_:function(e,t){var n=j(e,"x","reverse");if(n.rank===0)return n.clone();var r=Wr(t,n.shape);return J.runKernelFunc(function(i){return i.reverse(n,r)},{$x:n},function(i){return{$x:function(){return i.reverse(r)}}}).reshapeAs(n)}}),CZ=Q({reverse1d_:function(e){var t=j(e,"x","reverse");return U(t.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."}),Ku(t,0)}}),AZ=Q({reverse2d_:function(e,t){var n=j(e,"x","reverse");return U(n.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."}),Ku(n,t)}}),kZ=Q({reverse3d_:function(e,t){var n=j(e,"x","reverse");return U(n.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."}),Ku(n,t)}}),TZ=Q({reverse4d_:function(e,t){var n=j(e,"x","reverse");return U(n.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."}),Ku(n,t)}});function OZ(e,t,n,r,i,a){var o=j(e,"x","maxPool"),s=o,u=!1;o.rank===3&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),r==null&&(r=[1,1]),U(s.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."}),U(Gi(n,r),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}),a!=null&&U(gr(i),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+i+"."});var l=Ff(s.shape,t,n,r,i,a);if(l.filterWidth===1&&l.filterHeight===1&&Ur(l.inShape,l.outShape))return o.clone();var c=[s],f=J.runKernelFunc(function(d,h){var p=d.maxPool(s,l);return h([s,p]),p},{x:s},function(d,h){var p=h[0],g=h[1];return{x:function(){return function(m,v,y,b,x,w,S,C){var _=j(m,"dy","maxPoolBackprop"),E=j(v,"input","maxPoolBackprop"),A=j(y,"output","maxPoolBackprop");U(E.rank===_.rank,function(){return"Rank of input ("+E.rank+") does not match rank of dy ("+_.rank+")"}),w==null&&(w=[1,1]),U(Gi(x,w),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+x+" and dilations '"+w+"'"}),U(_.rank===4,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+_.rank+"."}),U(E.rank===4,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+E.rank+"."}),C!=null&&U(gr(S),function(){return"Error in maxPoolBackprop: pad must be an integer when using, dimRoundingMode "+C+" but got pad "+S+"."});var k=Ff(E.shape,b,x,w,S,C);return J.runKernelFunc(function(T){return T.maxPoolBackprop(_,E,A,k)},{$dy:_,$input:E})}(d,p,g,t,n,r,i)}}},"MaxPool",l,c);return u?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}function IZ(e,t,n,r,i,a){var o=j(e,"x","avgPool","float32");r==null&&(r=[1,1]),U(Gi(n,r),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"});var s=o,u=!1;o.rank===3&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),U(s.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."}),a!=null&&U(gr(i),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+i+"."});var l=Ff(s.shape,t,n,r,i,a);if(l.filterWidth===1&&l.filterHeight===1&&Ur(l.inShape,l.outShape))return o.clone();var c=J.runKernelFunc(function(f){return f.avgPool(s,l)},{x:s},function(f){return{x:function(){return function(d,h,p,g,m,v){var y=j(d,"dy","avgPoolBackprop"),b=j(h,"input","avgPoolBackprop");U(b.rank===y.rank,function(){return"Rank of input ("+b.rank+") does not match rank of dy ("+y.rank+")"}),m==null&&(m=[1,1]),U(Gi(g,m),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+g+" and dilations '"+m+"'"});var x=b,w=y,S=!1;b.rank===3&&(S=!0,x=b.as4D(1,b.shape[0],b.shape[1],b.shape[2]),w=y.as4D(1,y.shape[0],y.shape[1],y.shape[2])),U(w.rank===4,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+w.rank+"."}),U(x.rank===4,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+x.rank+"."});var C=Ff(x.shape,p,g,m,v),_=J.runKernelFunc(function(E){return E.avgPoolBackprop(w,x,C)},{dy4D:w,input4D:x});return S?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_}(f,s,t,n,r,i)}}},"AvgPool",l);return c=c.cast(o.dtype),u?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}var fE=Q({maxPool_:function(e,t,n,r,i){return OZ(e,t,n,1,r,i)}}),dE=Q({avgPool_:function(e,t,n,r,i){return IZ(e,t,n,1,r,i)}}),NZ=Q({pool_:function(e,t,n,r,i,a){i==null&&(i=[1,1]),a==null&&(a=1),r===0&&(r="valid");var o=j(e,"x","maxPool"),s=o,u=!1;o.rank===3&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),U(Gi(a,i),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+a+" and dilations '"+i+"'"});var l,c=Ff(s.shape,t,a,i,r),f=[c.dilationHeight,c.dilationWidth];l=r==="same"?function(x,w){var S=x.map(function(E,A){return E+(E-1)*(w[A]-1)}).map(function(E){return E-1}),C=S.map(function(E){return Math.floor(E/2)}),_=S.map(function(E,A){return E-C[A]});return S.map(function(E,A){return[C[A],_[A]]})}([c.filterHeight,c.filterWidth],f):[[0,0],[0,0]];var d=f[0]===1&&f[1]===1,h=function(x,w,S){var C=S.map(function(N){return N[0]}),_=S.map(function(N){return N[1]}),E=x.concat(C,_),A=w.map(function(N,O){return(N-E[O]%N)%N}),k=_.map(function(N,O){return N+A[O]}),T=w.map(function(N,O){return[C[O],k[O]]}),I=w.map(function(N,O){return[0,A[O]]});return[T,I]}([c.inHeight,c.inWidth],f,l),p=h[0],g=h[1],m=d?r:"valid",v=d?s:NS(s,f,p),y=(n==="avg"?function(){return IZ(v,t,a,1,m)}:function(){return OZ(v,t,a,1,m)})(),b=d?y:OS(y,f,g);return u?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),hE=Q({maxPool3d_:function(e,t,n,r,i,a,o){a===void 0&&(a="NDHWC");var s=j(e,"x","maxPool3d"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),o==null&&(o=[1,1,1]),U(u.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."}),U(a==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+a}),U(Gi(n,o),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"}),i!=null&&U(gr(r),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."});var c=db(u.shape,t,n,o,r,i,a),f=J.runKernelFunc(function(d,h){var p=d.maxPool3d(u,c);return h([u,p]),p},{x:u},function(d,h){var p=h[0],g=h[1];return{x:function(){return function(m,v,y,b,x,w,S,C){var _=j(m,"dy","maxPool3dBackprop"),E=j(v,"input","maxPool3dBackprop"),A=j(y,"output","maxPool3dBackprop"),k=_,T=E,I=A,N=!1;E.rank===4&&(N=!0,k=_.as5D(1,_.shape[0],_.shape[1],_.shape[2],_.shape[3]),T=E.as5D(1,E.shape[0],E.shape[1],E.shape[2],E.shape[3]),I=A.as5D(1,A.shape[0],A.shape[1],A.shape[2],A.shape[3])),U(k.rank===5,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+k.rank+"."}),U(T.rank===5,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+T.rank+"."}),U(I.rank===5,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+I.rank+"."}),w==null&&(w=[1,1,1]),U(Gi(x,w),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+x+" and dilations '"+w+"'"}),C!=null&&U(gr(S),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+C+" but got pad "+S+"."});var O=db(T.shape,b,x,w,S,C),D=J.runKernelFunc(function(L){return L.maxPool3dBackprop(k,T,I,O)},{dy5D:k,input5D:T});return N?D.as4D(D.shape[1],D.shape[2],D.shape[3],D.shape[4]):D}(d,p,g,t,n,o,r,i)}}});return l?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),pE=Q({avgPool3d_:function(e,t,n,r,i,a,o){a===void 0&&(a="NDHWC");var s=j(e,"x","avgPool3d","float32"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),o==null&&(o=[1,1,1]),U(u.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."}),U(a==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+a}),U(Gi(n,o),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"}),i!=null&&U(gr(r),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."});var c=db(u.shape,t,n,o,r,i,a),f=J.runKernelFunc(function(d){return d.avgPool3d(u,c)},{x:u},function(d){return{x:function(){return function(h,p,g,m,v,y,b){var x=j(h,"dy","avgPool3dBackprop"),w=j(p,"input","avgPool3dBackprop"),S=x,C=w,_=!1;w.rank===4&&(_=!0,S=x.as5D(1,x.shape[0],x.shape[1],x.shape[2],x.shape[3]),C=w.as5D(1,w.shape[0],w.shape[1],w.shape[2],w.shape[3])),U(S.rank===5,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+S.rank+"."}),U(C.rank===5,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+C.rank+"."}),v==null&&(v=[1,1,1]),U(Gi(m,v),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+m+" and dilations '"+v+"'"}),b!=null&&U(gr(y),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+b+" but got pad "+y+"."});var E=db(C.shape,g,m,v,y,b),A=J.runKernelFunc(function(k){return k.avgPool3dBackprop(S,C,E)},{dy5D:S,input5D:C});return _?A.as4D(A.shape[1],A.shape[2],A.shape[3],A.shape[4]):A}(d,u,t,n,o,r,i)}}});return f=f.cast(u.dtype),l?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),_M=Q({maxPoolWithArgmax_:function(e,t,n,r,i){i===void 0&&(i=!1);var a=j(e,"x","maxPoolWithArgmax"),o={filterSize:t,strides:n,pad:r,includeBatchInIndex:i},s=J.runKernel("MaxPoolWithArgmax",{x:a},o);return{result:s[0],indexes:s[1]}}}),Ro=Q({slice_:function(e,t,n){var r,i,a=j(e,"x","slice");if(a.rank===0)throw new Error("Slicing scalar is not possible");(r=typeof t=="number"?[t].concat(new Array(a.rank-1).fill(0)):t.length<a.rank?t.concat(new Array(a.rank-t.length).fill(0)):t.slice()).forEach(function(u){U(u!==-1,function(){return"slice() does not support negative begin indexing."})}),i=(i=n==null?new Array(a.rank).fill(-1):typeof n=="number"?[n].concat(new Array(a.rank-1).fill(-1)):n.length<a.rank?n.concat(new Array(a.rank-n.length).fill(-1)):n).map(function(u,l){return u>=0?u:(U(u===-1,function(){return"Negative size values should be exactly -1 but got "+u+" for the slice() size at index "+l+"."}),a.shape[l]-r[l])}),UX(a,r,i);var o=a.shape,s={begin:r,size:i};return J.runKernelFunc(function(u){return u.slice(a,r,i)},{x:a},function(u){for(var l=[],c=0;c<u.rank;c++)l.push([r[c],o[c]-r[c]-i[c]]);return{x:function(){return Gu(u,l)}}},"Slice",s)}}),xb=Q({slice1d_:function(e,t,n){var r=j(e,"x","slice1d");return U(r.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"}),Ro(r,[t],[n])}}),gE=Q({slice2d_:function(e,t,n){var r=j(e,"x","slice2d");return U(r.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"}),Ro(r,t,n)}}),wb=Q({slice3d_:function(e,t,n){var r=j(e,"x","slice3d");return U(r.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"}),Ro(r,t,n)}}),$m=Q({slice4d_:function(e,t,n){var r=j(e,"x","slice4d");return U(r.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"}),Ro(r,t,n)}});function DZ(e,t,n,r,i){return t.rank<n.rank&&(t=t.reshape(ya(t.shape,r))),e.rank<n.rank&&(e=e.reshape(ya(e.shape,r))),{x:function(){var a=e.mul(n.equal(t).cast(e.dtype));return i==null?a:a.transpose(i)}}}var mE=Q({all_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=j(e,"x","all","bool"),i=Wr(t,r.shape),a=i,o=js(a,r.rank);o!=null&&(r=r.transpose(o),a=Us(a.length,r.rank));var s=J.runKernelFunc(function(l){return l.all(r,a)},{$x:r});if(n){var u=ya(s.shape,i);return s.reshape(u)}return s}}),_b=Q({any_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=j(e,"x","any","bool"),i=Wr(t,r.shape),a=i,o=js(a,r.rank);o!=null&&(r=r.transpose(o),a=Us(a.length,r.rank));var s=J.runKernelFunc(function(l){return l.any(r,a)},{$x:r});if(n){var u=ya(s.shape,i);return s.reshape(u)}return s}}),Sb=Q({argMax_:function(e,t){t===void 0&&(t=0);var n=j(e,"x","argMax");t==null&&(t=0);var r=Wr(t,n.shape),i=js(r,n.rank);i!=null&&(n=n.transpose(i),r=Us(r.length,n.rank));var a={axis:r[0]},o=[n];return J.runKernelFunc(function(s,u){var l=s.argMax(n,r[0]);return u([n]),l},{x:n},function(s,u){var l=u[0];return{x:function(){return en(l)}}},"ArgMax",a,o)}}),SM=Q({argMin_:function(e,t){t===void 0&&(t=0);var n=j(e,"x","argMin");t==null&&(t=0);var r=Wr(t,n.shape),i=js(r,n.rank);return i!=null&&(n=n.transpose(i),r=Us(r.length,n.rank)),J.runKernelFunc(function(a,o){var s=a.argMin(n,r[0]);return o([n]),s},{$x:n},function(a,o){var s=o[0];return{$x:function(){return en(s)}}})}}),RZ=Q({logSumExp_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=j(e,"x","logSumExp"),i=Wr(t,r.shape),a=r.max(i,!0),o=r.sub(a).exp().sum(i).log(),s=a.reshape(o.shape).add(o);if(n){var u=ya(s.shape,i);return s.reshape(u)}return s}}),Pf=Q({max_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=j(e,"x","max"),i=r,a=Wr(t,r.shape),o=a,s=js(o,r.rank);s!=null&&(r=r.transpose(s),o=Us(o.length,r.rank));var u=[r],l=J.runKernelFunc(function(f,d){var h=f.max(r,o);return d([i,h]),h},{x:r},function(f,d){return DZ(f,d[1],d[0],a,s)},"Max",{axes:o},u,[!0]);if(n){var c=ya(l.shape,a);l=l.reshape(c)}return l}}),Fr=Q({mean_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=j(e,"x","mean"),i=Wr(t,r.shape),a=et(Di(r.shape,i)[1]);return fb(function(o){var s=Ve(a);return{value:(s.dtype===o.dtype?o:o.cast(s.dtype)).div(s).sum(t,n),gradFunc:function(u){var l=o.shape.slice();return i.forEach(function(c){l[c]=1}),u.reshape(l).mul(Wu(o.shape,"float32")).div(a)}}})(r)}}),vE=Q({min_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=j(e,"x","min"),i=r,a=Wr(t,r.shape),o=a,s=js(o,r.rank);s!=null&&(r=r.transpose(s),o=Us(o.length,r.rank));var u=[r],l=J.runKernelFunc(function(f,d){var h=f.min(r,o);return d([i,h]),h},{x:r},function(f,d){return DZ(f,d[1],d[0],a,s)},"Min",{axes:o},u,[!0]);if(n){var c=ya(l.shape,a);l=l.reshape(c)}return l}}),Eb=Q({moments_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=Wr(t,(e=j(e,"x","moments")).shape),i=e.mean(r,n),a=i.shape;n||(a=ya(i.shape,r));var o=e.toFloat().sub(i.reshape(a)).square();return{mean:i,variance:o.mean(r,n)}}}),qr=Q({sum_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=j(e,"x","sum");r.dtype==="bool"&&(r=r.toInt());var i=Wr(t,r.shape);return fb(function(a){var o=js(i,a.rank),s=i,u=a;o!=null&&(u=a.transpose(o),s=Us(s.length,a.rank));var l=function(h){var p=a.shape.slice();return i.forEach(function(g){p[g]=1}),h.reshape(p).mul(Wu(a.shape,"float32"))},c={axes:s},f=J.runKernelFunc(function(h){return h.sum(u,s)},{x:u},function(h){return{x:function(){return l(h)}}},"Sum",c);if(n){var d=ya(f.shape,i);f=f.reshape(d)}return{value:f,gradFunc:l}})(r)}}),yE=Q({prod_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=j(e,"x","prod");r.dtype==="bool"&&(r=r.toInt());var i=Wr(t,r.shape),a=js(i,r.rank),o=i,s=r;a!=null&&(s=r.transpose(a),o=Us(o.length,r.rank));var u=J.runKernelFunc(function(c){return c.prod(s,o)},{permutedX:s});if(n){var l=ya(u.shape,i);u=u.reshape(l)}return u}}),Lm=Q({elu_:function(e){var t=j(e,"x","elu");return J.runKernelFunc(function(n,r){var i=n.elu(t);return r([i]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){return J.runKernelFunc(function(a){return a.eluDer(n,i)},{dy:n,y:i})}}})}}),bE=Q({leakyRelu_:function(e,t){t===void 0&&(t=.2);var n=j(e,"x","leakyRelu");return Vu(Ve(t).mul(n),n)}}),Cb=Q({prelu_:function(e,t){var n=j(e,"x","prelu"),r=j(t,"alpha","prelu");return J.runKernelFunc(function(i,a){var o=i.prelu(n,r);return a([n,r]),o},{x:n,alpha:r},function(i,a){var o=a[0],s=a[1],u=o.greater(0);return{x:function(){return qs(u,i,i.mul(s))},alpha:function(){var l=qs(u,en(i),i.mul(o)),c=Vr(s.shape,i.shape);return c.length>0&&(l=l.sum(c)),l.reshape(s.shape)}}},"Prelu")}}),$f=Q({relu_:function(e){var t=j(e,"x","relu");return t.dtype==="bool"?t.toInt():J.runKernelFunc(function(n,r){var i=n.relu(t);return r([t]),i},{x:t},function(n,r){var i=r[0];return{x:function(){return n.mulStrict(i.step().toFloat())}}},"Relu")}}),EM=Q({relu6_:function(e){var t=j(e,"x","relu6");return t.dtype==="bool"?t.toInt():J.runKernelFunc(function(n,r){var i=n.relu6(t);return r([t]),i},{x:t},function(n,r){var i=r[0],a=i.lessEqual(6).mul(i.step());return{x:function(){return n.mulStrict(a.toFloat())}}},"Relu6")}}),xE=Q({selu_:function(e){var t=j(e,"x","selu");return J.runKernelFunc(function(n,r){var i=n.selu(t);return r([t]),i},{$x:t},function(n,r){var i=r[0];return{$x:function(){var a=i.greater(Ve(0)),o=Ve(nM),s=Ve(rM),u=n.mul(s),l=n.mul(o).mul(i.toFloat().exp());return qs(a,u,l)}}})}}),CM=Q({localResponseNormalization_:function(e,t,n,r,i){t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),i===void 0&&(i=.5);var a=j(e,"x","localResponseNormalization");U(a.rank===4||a.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+a.rank+"."}),U(gr(t),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."});var o=a,s=!1;a.rank===3&&(s=!0,o=a.as4D(1,a.shape[0],a.shape[1],a.shape[2]));var u=J.runKernelFunc(function(l,c){var f=l.localResponseNormalization4D(o,t,n,r,i);return c([o,f]),f},{x4D:o},function(l,c){var f=c[0],d=c[1];return{x4D:function(){return J.runKernelFunc(function(h){return h.LRNGrad(l,f,d,t,n,r,i)},{})}}});return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),AM=Q({norm_:function(e,t,n,r){t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1);var i=function s(u,l,c){if(c===void 0&&(c=null),u.rank===0)return u.abs();if(u.rank!==1&&c===null)return s(u.reshape([-1]),l,c);if(u.rank===1||typeof c=="number"||Array.isArray(c)&&c.length===1){if(l===1)return u.abs().sum(c);if(l===1/0)return u.abs().max(c);if(l===-1/0)return u.abs().min(c);if(l==="euclidean"||l===2)return u.abs().pow(Ve(2,"int32")).sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}if(Array.isArray(c)&&c.length===2){if(l===1)return u.abs().sum(c[0]).max(c[1]-1);if(l===1/0)return u.abs().sum(c[1]).max(c[0]);if(l===-1/0)return u.abs().sum(c[1]).min(c[0]);if(l==="fro"||l==="euclidean")return u.square().sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}throw new Error("Error in norm: invalid axis: "+c)}(e=j(e,"x","norm"),t,n),a=i.shape;if(r){var o=Wr(n,e.shape);a=ya(i.shape,o)}return i.reshape(a)}}),FZ=Q({basicLSTMCell_:function(e,t,n,r,i,a){var o=j(e,"forgetBias","basicLSTMCell"),s=j(t,"lstmKernel","basicLSTMCell"),u=j(n,"lstmBias","basicLSTMCell"),l=j(r,"data","basicLSTMCell"),c=j(i,"c","basicLSTMCell"),f=j(a,"h","basicLSTMCell"),d=l.concat(f,1).matMul(s).add(u),h=d.shape[0],p=d.shape[1]/4,g=[h,p],m=d.slice([0,0],g),v=d.slice([0,p],g),y=d.slice([0,2*p],g),b=d.slice([0,3*p],g),x=m.sigmoid().mulStrict(v.tanh()).addStrict(c.mulStrict(o.add(y).sigmoid())),w=x.tanh().mulStrict(b.sigmoid());return[x,w]}}),MZ=Q({multiRNNCell_:function(e,t,n,r){for(var i=j(t,"data","multiRNNCell"),a=ib(n,"c","multiRNNCell"),o=ib(r,"h","multiRNNCell"),s=i,u=[],l=0;l<e.length;l++){var c=e[l](s,a[l],o[l]);u.push(c[0]),u.push(c[1]),s=c[1]}var f=[],d=[];for(l=0;l<u.length;l+=2)f.push(u[l]),d.push(u[l+1]);return[f,d]}}),PZ=Q({movingAverage_:function(e,t,n,r,i){i===void 0&&(i=!0);var a=j(e,"v","movingAverage"),o=j(t,"x","movingAverage"),s=j(n,"decay","movingAverage");WK(a,o),U(Ur(a.shape,o.shape),function(){return"Shape mismatch in v and x"});var u=Ve(1),l=u.sub(s),c=o.sub(a).mul(l);if(i){U(r!=null,function(){return"When using zeroDebias: true, step is required."});var f=j(r,"step","movingAverage");c=c.div(u.sub(km(s,f)))}return a.add(c)}}),kM=Q({stridedSlice_:function(e,t,n,r,i,a,o,s,u){if(i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o=0),s===void 0&&(s=0),u===void 0&&(u=0),r==null&&(r=new Array(t.length)),o!==0)throw new Error("ellipsis mask is not yet supported");var l=j(e,"x","stridedSlice"),c=$3(s),f=l.shape.slice();c.forEach(function(m){t[m]=0,n[m]=1,f.splice(m,0,1)}),l=l.reshape(f);for(var d=0;d<l.rank;d++)t[d]=WX(i,t,r,l.shape,d),n[d]=VX(a,n,r,l.shape,d),r[d]=r[d]||1;var h=$3(u);h.forEach(function(m){n[m]=t[m]+1,r[m]=1});var p=US(t,n,r),g=p.filter(function(m,v){return h.indexOf(v)===-1});return r.every(function(m){return m===1})?Ro(l,t,p).reshape(g):J.runKernelFunc(function(m){return m.stridedSlice(l,t,n,r)},{$x:l}).reshape(g)}}),TM=Q({topk_:function(e,t,n){t===void 0&&(t=1),n===void 0&&(n=!0);var r=j(e,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var i=r.shape[r.shape.length-1];if(t>i)throw new Error("'k' passed to topk() must be <= the last dimension ("+i+") but got "+t);var a=J.runKernelFunc(function(o){return o.topk(r,t,n)},{$x:r});return{values:a[0],indices:a[1]}}}),OM=Q({scatterND_:function(e,t,n){var r=j(e,"indices","scatterND","int32"),i=j(t,"updates","scatterND");return jX(i,r,n),J.runKernelFunc(function(a){return a.scatterND(r,i,n)},{indices:r,updates:i},null,"ScatterNd",{shape:n})}}),Ab=Q({fft_:function(e){U(e.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return J.runKernelFunc(function(i){return i.fft(r)},{input:e}).reshape(e.shape)}}),Bm=Q({ifft_:function(e){U(e.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return J.runKernelFunc(function(i){return i.ifft(r)},{input:e}).reshape(e.shape)}}),kb=Q({rfft_:function(e,t){U(e.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+e.dtype});var n,r=e.shape[e.shape.length-1],i=e.size/r;if(t!=null&&t<r){var a=e.shape.map(function(v){return 0}),o=e.shape.map(function(v){return v});o[e.shape.length-1]=t,n=e.slice(a,o),r=t}else if(t!=null&&t>r){var s=e.shape.map(function(v){return v});s[e.shape.length-1]=t-r,n=e.concat(Tn(s),e.shape.length-1),r=t}else n=e;var u=n.zerosLike(),l=ri(n,u).as2D(i,r),c=Ab(l),f=Math.floor(r/2)+1,d=eo(c),h=is(c),p=d.split([f,r-f],d.shape.length-1),g=h.split([f,r-f],h.shape.length-1),m=n.shape.slice();return m[n.shape.length-1]=f,ri(p[0],g[0]).reshape(m)}}),wE=Q({irfft_:function(e){var t=e.shape[e.shape.length-1],n=e.size/t;if(t<=2){var r=e.as2D(n,t),i=Bm(r);return eo(i)}var a=[n,2*(t-1)],o=eo(e).as2D(n,t),s=is(e).as2D(n,t),u=o.slice([0,1],[n,t-2]).reverse(1),l=s.slice([0,1],[n,t-2]).reverse(1).mul(Ve(-1)),c=o.concat(u,1),f=s.concat(l,1);return r=ri(c,f).as2D(a[0],a[1]),i=Bm(r),eo(i)}}),$Z=Object.freeze({fft:Ab,ifft:Bm,rfft:kb,irfft:wE}),_E=Q({sparseToDense_:function(e,t,n,r){r===void 0&&(r=0);var i=j(e,"sparseIndices","sparseToDense","int32"),a=j(t,"sparseValues","sparseToDense"),o=j(r,"defaultValue","sparseToDense",a.dtype);return function(s,u,l,c){if(s.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+s.dtype+".");if(s.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+s.shape+".");var f=s.rank>0?s.shape[0]:1,d=s.rank>1?s.shape[1]:1;if(l.length!==d)throw new Error("outputShape has incorrect number of elements:, "+l.length+", should be: "+d+".");var h=u.size;if(u.rank!==0&&(u.rank!==1||h!==f))throw new Error("sparseValues has incorrect shape "+u.shape+", should be [] or ["+f+"]");if(u.dtype!==c.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(i,a,n,o),J.runKernelFunc(function(s){return s.sparseToDense(i,a,n,o)},{$sparseIndices:i,$sparseValues:a,$defaultValue:o})}}),IM=Q({gatherND_:function(e,t){var n=j(t,"indices","gatherND","int32"),r=j(e,"x","gatherND");return J.runKernelFunc(function(i){return i.gatherND(r,n)},{x:r,indices:n},null,"GatherNd")}}),LZ=Q({diag_:function(e){var t=j(e,"x","diag").flatten(),n=e.shape.concat(e.shape);return J.runKernelFunc(function(r){return r.diag(t)},{$x:t}).reshape(n)}}),NM=Q({dropout_:function(e,t,n,r){var i=j(e,"x","dropout");if(U(i.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+i.dtype+" tensor instead."}),U(t>=0&&t<1,function(){return"rate must be a float in the range [0, 1), but got "+t+"."}),t===0)return e instanceof Ht?i.clone():i;var a=function(u,l){if(l==null)return u.shape.slice();if(Ur(u.shape,l))return l;if(u.shape.length===l.length){for(var c=[],f=0;f<u.shape.length;f++)l[f]==null&&u.shape[f]!=null?c.push(u.shape[f]):c.push(l[f]);return c}return l}(i,n),o=1-t,s=jh(a,0,1,"float32",r).add(o).floor().div(o);return i.mul(s)}});function BZ(e,t,n){for(var r=1-e%2,i=new Float32Array(e),a=0;a<e;++a){var o=2*Math.PI*a/(e+r-1);i[a]=t-n*Math.cos(o)}return ba(i,"float32")}var SE=Q({hannWindow_:function(e){return BZ(e,.5,.5)}}),DM=Q({hammingWindow_:function(e){return BZ(e,.54,.46)}}),EE=Q({frame_:function(e,t,n,r,i){r===void 0&&(r=!1),i===void 0&&(i=0);for(var a=0,o=[];a+t<=e.size;)o.push(Ro(e,a,t)),a+=n;if(r)for(;a<e.size;){var s=a+t-e.size,u=Hi([Ro(e,a,t-s),Em([s],i)]);o.push(u),a+=n}return o.length===0?Uu([],[0,t]):Hi(o).as2D(o.length,t)}}),RM=Q({stft_:function(e,t,n,r,i){var a;i===void 0&&(i=SE),r==null&&(a=t,r=Math.floor(Math.pow(2,Math.ceil(Math.log(a)/Math.log(2)))));for(var o=EE(e,t,n),s=rt(o,i(t)),u=[],l=0;l<o.shape[0];l++)u.push(kb(s.slice([l,0],[1,t]),r));return Hi(u)}}),zZ=Object.freeze({hannWindow:SE,hammingWindow:DM,frame:EE,stft:RM}),Ri,jZ=function(e,t,n){return n===void 0&&(n=1),tt(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f,d,h,p,g,m;return nt(this,function(v){switch(v.label){case 0:return r=j(e,"predictions","inTopK"),i=j(t,"targets","inTopK"),U(r.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank}),U(r.rank-1===i.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+i.rank}),ln(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),a=r.shape[r.shape.length-1],U(n>0&&n<=a,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+a+"), but got "+n}),[4,r.data()];case 1:return o=v.sent(),[4,i.data()];case 2:for(s=v.sent(),u=[o.length/a,a],c=u[1],f=Ih("bool",l=u[0]),d=0;d<l;d++){for(h=d*c,p=o.subarray(h,h+c),g=[],m=0;m<p.length;m++)g.push({value:p[m],index:m});for(g.sort(function(y,b){return b.value-y.value}),f[d]=0,m=0;m<n;m++)if(g[m].index===s[d]){f[d]=1;break}}return e!==r&&r.dispose(),t!==i&&i.dispose(),[2,Rr(f,i.shape,"bool")]}})})};(function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Ri||(Ri={}));var n$e=Q({absoluteDifference_:function(e,t,n,r){r===void 0&&(r=Ri.SUM_BY_NONZERO_WEIGHTS);var i=j(e,"labels","absoluteDifference"),a=j(t,"predictions","absoluteDifference"),o=null;n!=null&&(o=j(n,"weights","absoluteDifference")),ln(i.shape,a.shape,"Error in absoluteDifference: ");var s=i.sub(a).abs();return uc(s,o,r)}}),uc=Q({computeWeightedLoss_:function(e,t,n){n===void 0&&(n=Ri.SUM_BY_NONZERO_WEIGHTS);var r=j(e,"losses","computeWeightedLoss"),i=null;t!=null&&(i=j(t,"weights","computeWeightedLoss"));var a=i==null?r:r.mul(i);if(n===Ri.NONE)return a;if(n===Ri.SUM)return a.sum();if(n===Ri.MEAN){if(i==null)return a.mean();var o=r.size/i.size,s=a.sum().div(i.sum());return o>1?s.div(Ve(o)):s}if(n===Ri.SUM_BY_NONZERO_WEIGHTS){if(i==null)return a.sum().div(Ve(r.size));var u=i.mul(Wu(r.shape)).notEqual(Ve(0)).sum().toFloat();return a.sum().div(u)}throw Error("Unknown reduction: "+n)}}),r$e=Q({cosineDistance_:function(e,t,n,r,i){i===void 0&&(i=Ri.SUM_BY_NONZERO_WEIGHTS);var a=j(e,"labels","cosineDistance"),o=j(t,"predictions","cosineDistance"),s=null;r!=null&&(s=j(r,"weights","cosineDistance")),ln(a.shape,o.shape,"Error in cosineDistance: ");var u=Ve(1).sub(a.mul(o).sum(n,!0));return uc(u,s,i)}}),i$e=Q({hingeLoss_:function(e,t,n,r){r===void 0&&(r=Ri.SUM_BY_NONZERO_WEIGHTS);var i=j(e,"labels","hingeLoss"),a=j(t,"predictions","hingeLoss"),o=null;n!=null&&(o=j(n,"weights","hingeLoss")),ln(i.shape,a.shape,"Error in hingeLoss: ");var s=Ve(1);i=Ve(2).mul(i).sub(s);var u=s.sub(i.mul(a)).relu();return uc(u,o,r)}}),a$e=Q({huberLoss_:function(e,t,n,r,i){r===void 0&&(r=1),i===void 0&&(i=Ri.SUM_BY_NONZERO_WEIGHTS);var a=j(e,"labels","huberLoss"),o=j(t,"predictions","huberLoss"),s=null;n!=null&&(s=j(n,"weights","huberLoss")),ln(a.shape,o.shape,"Error in huberLoss: ");var u=Ve(r),l=o.sub(a).abs(),c=Am(l,u),f=l.sub(c),d=Ve(.5).mul(c.square()).add(u.mul(f));return uc(d,s,i)}}),o$e=Q({logLoss_:function(e,t,n,r,i){r===void 0&&(r=1e-7),i===void 0&&(i=Ri.SUM_BY_NONZERO_WEIGHTS);var a=j(e,"labels","logLoss"),o=j(t,"predictions","logLoss"),s=null;n!=null&&(s=j(n,"weights","logLoss")),ln(a.shape,o.shape,"Error in logLoss: ");var u=Ve(1),l=Ve(r),c=a.mul(o.add(l).log()).neg().sub(u.sub(a).mul(u.sub(o).add(l).log()));return uc(c,s,i)}}),s$e=Q({meanSquaredError_:function(e,t,n,r){r===void 0&&(r=Ri.SUM_BY_NONZERO_WEIGHTS);var i=j(e,"labels","meanSquaredError"),a=j(t,"predictions","meanSquaredError"),o=null;n!=null&&(o=j(n,"weights","meanSquaredError")),ln(i.shape,a.shape,"Error in meanSquaredError: ");var s=i.squaredDifference(a);return uc(s,o,r)}}),u$e=Q({sigmoidCrossEntropy_:function(e,t,n,r,i){r===void 0&&(r=0),i===void 0&&(i=Ri.SUM_BY_NONZERO_WEIGHTS);var a=j(e,"multiClassLabels","sigmoidCrossEntropy"),o=j(t,"logits","sigmoidCrossEntropy"),s=null;if(n!=null&&(s=j(n,"weights","sigmoidCrossEntropy")),ln(a.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=Ve(r),l=Ve(1),c=Ve(.5);a=a.mul(l.sub(u)).add(c.mul(u))}var f=function(d,h){var p=j(d,"labels","sigmoidCrossEntropyWithLogits"),g=j(h,"logits","sigmoidCrossEntropyWithLogits");ln(p.shape,g.shape,"Error in sigmoidCrossEntropyWithLogits: ");var m=g.relu(),v=g.mul(p),y=g.abs().neg().exp().log1p();return m.sub(v).add(y)}(a,o);return uc(f,s,i)}}),l$e=Q({softmaxCrossEntropy_:function(e,t,n,r,i){r===void 0&&(r=0),i===void 0&&(i=Ri.SUM_BY_NONZERO_WEIGHTS);var a=j(e,"onehotLabels","softmaxCrossEntropy"),o=j(t,"logits","softmaxCrossEntropy"),s=null;if(n!=null&&(s=j(n,"weights","softmaxCrossEntropy")),ln(a.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){var u=Ve(r),l=Ve(1),c=Ve(a.shape[1]);a=a.mul(l.sub(u)).add(u.div(c))}var f=function(d,h,p){if(p===void 0&&(p=-1),p===-1&&(p=h.rank-1),p!==h.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+h.rank+" and dim was "+p);return fb(function(g,m,v){var y=m.logSumExp([p],!0),b=m.toFloat().sub(y);return v([g,b]),{value:b.mul(g).neg().sum([p]),gradFunc:function(x,w){var S=w[0],C=w[1],_=ya(x.shape,[p]);return[x.reshape(_).mul(S.toFloat().sub(C.exp())),x.reshape(_).mul(C.exp().sub(S.toFloat()))]}}})(d,h)}(a,o);return uc(f,s,i)}}),UZ=Object.freeze({get Reduction(){return Ri},absoluteDifference:n$e,computeWeightedLoss:uc,cosineDistance:r$e,hingeLoss:i$e,huberLoss:a$e,logLoss:o$e,meanSquaredError:s$e,sigmoidCrossEntropy:u$e,softmaxCrossEntropy:l$e});function WZ(e,t){return t===void 0&&(t=!1),J.tidy(function(){if(e.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+e.shape.length+"D Tensor.");for(var n=e.shape[0],r=e.shape[1],i=iE(n),a=e.clone(),o=Uu([[1]],[1,1]),s=o.clone(),u=n>=r?r:n,l=function(f){var d,h=a,p=s,g=i;d=J.tidy(function(){var m=a.slice([f,f],[n-f,1]),v=m.norm(),y=a.slice([f,f],[1,1]),b=Uu([[-1]]).where(y.greater(0),Uu([[1]])),x=y.sub(b.mul(v)),w=m.div(x);s=w.shape[0]===1?o.clone():o.concat(w.slice([1,0],[w.shape[0]-1,w.shape[1]]),0);var S=b.matMul(x).div(v).neg(),C=a.slice([f,0],[n-f,r]),_=S.mul(s),E=s.transpose();if(f===0)a=C.sub(_.matMul(E.matMul(C)));else{var A=C.sub(_.matMul(E.matMul(C)));a=a.slice([0,0],[f,r]).concat(A,0)}var k=_.transpose(),T=i.slice([0,f],[n,i.shape[1]-f]);if(f===0)i=T.sub(T.matMul(s).matMul(k));else{var I=T.sub(T.matMul(s).matMul(k));i=i.slice([0,0],[n,f]).concat(I,1)}return[s,a,i]}),s=d[0],a=d[1],i=d[2],Ut([h,p,g])},c=0;c<u;++c)l(c);return!t&&n>r&&(i=i.slice([0,0],[n,r]),a=a.slice([0,0],[r,r])),[i,a]})}var c$e=Q({bandPart_:function(e,t,n){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+n+".");var r=j(e,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var i=r.shape,a=r.shape.slice(-2),o=a[0],s=a[1];if(!(t<=o))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+o+").");if(!(n<=s))throw new Error("bandPart(): numUpper ("+n+") must not be greater than the number of columns ("+s+").");t<0&&(t=o),n<0&&(n=s);var u=Cm(0,o,1,"int32").reshape([-1,1]),l=Cm(0,s,1,"int32"),c=Er(u,l),f=Hu(c.lessEqual(Ve(+t,"int32")),c.greaterEqual(Ve(-n,"int32"))),d=Tn([o,s],r.dtype);return as(Nf(r.reshape([-1,o,s])).map(function(h){return qs(f,h,d)})).reshape(i)}}),f$e=Q({gramSchmidt_:function(e){var t;if(Array.isArray(e)){t=!1,U(e!=null&&e.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var n=e[0].shape[0],r=function(u){U(e[u].shape[0]===n,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+e[u].shape[0]+" vs. "+n+")"})},i=1;i<e.length;++i)r(i)}else t=!0,e=ic(e,e.shape[0],0).map(function(u){return ab(u,[0])});U(e.length<=e[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+e.length+") exceeds number of dimensions ("+e[0].shape[0]+")."});var a=[],o=e,s=function(u){a.push(J.tidy(function(){var l=o[u];if(u>0)for(var c=0;c<u;++c){var f=qr(a[c].mulStrict(l)).mul(a[c]);l=l.sub(f)}return l.div(AM(l,"euclidean"))}))};for(i=0;i<e.length;++i)s(i);return t?as(a,0):a}}),d$e=Q({qr_:function(e,t){if(t===void 0&&(t=!1),e.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+e.rank);if(e.rank===2)return WZ(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce(function(o,s){return o*s}),r=Nf(e.reshape([n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),i=[],a=[];return r.forEach(function(o){var s=WZ(o,t),u=s[0],l=s[1];i.push(u),a.push(l)}),[as(i,0).reshape(e.shape),as(a,0).reshape(e.shape)]}}),FM=Object.freeze({bandPart:c$e,gramSchmidt:f$e,qr:d$e});function CE(e,t,n,r,i,a){r==null&&(r=.5),i==null&&(i=Number.NEGATIVE_INFINITY),a==null&&(a=0);var o=e.shape[0];return n=Math.min(n,o),U(0<=r&&r<=1,function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"}),U(e.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+e.rank+"'"}),U(e.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+e.shape[1]}),U(t.rank===1,function(){return"scores must be a 1D tensor"}),U(t.shape[0]===o,function(){return"scores has incompatible shape with boxes. Expected "+o+", but was "+t.shape[0]}),U(0<=a&&a<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+a+"'"}),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:a}}var h$e=Q({resizeBilinear_:function(e,t,n){n===void 0&&(n=!1);var r=j(e,"images","resizeBilinear");U(r.rank===3||r.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."}),U(t.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."});var i=r,a=!1;r.rank===3&&(a=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=t[0],s=t[1],u=J.runKernelFunc(function(l,c){return c([i]),l.resizeBilinear(i,o,s,n)},{x:i},function(l,c){return{x:function(){return J.runKernelFunc(function(f){return f.resizeBilinearBackprop(l,c[0],n)},{})}}},"ResizeBilinear",{alignCorners:n,newHeight:o,newWidth:s});return a?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),p$e=Q({resizeNearestNeighbor_:function(e,t,n){n===void 0&&(n=!1);var r=j(e,"images","resizeNearestNeighbor");U(r.rank===3||r.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."}),U(t.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."}),U(r.dtype==="float32"||r.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"});var i=r,a=!1;r.rank===3&&(a=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=t[0],s=t[1],u=J.runKernelFunc(function(l,c){return c([i]),l.resizeNearestNeighbor(i,o,s,n)},{batchImages:i},function(l,c){return{batchImages:function(){return J.runKernelFunc(function(f){return f.resizeNearestNeighborBackprop(l,c[0],n)},{})}}});return a?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),g$e=Q({nonMaxSuppression_:function(e,t,n,r,i){r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY);var a=j(e,"boxes","nonMaxSuppression"),o=j(t,"scores","nonMaxSuppression"),s=CE(a,o,n,r,i);n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold;var u={maxOutputSize:n,iouThreshold:r,scoreThreshold:i};return J.runKernelFunc(function(l){return l.nonMaxSuppression(a,o,n,r,i)},{boxes:a,scores:o},null,"NonMaxSuppressionV3",u)}}),m$e=function(e,t,n,r,i){return r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY),tt(this,void 0,void 0,function(){var a,o,s,u,l,c,f;return nt(this,function(d){switch(d.label){case 0:return a=j(e,"boxes","nonMaxSuppressionAsync"),o=j(t,"scores","nonMaxSuppressionAsync"),s=CE(a,o,n,r,i),n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold,[4,Promise.all([a.data(),o.data()])];case 1:return u=d.sent(),l=u[0],c=u[1],f=G3(l,c,n,r,i),a!==e&&a.dispose(),o!==t&&o.dispose(),[2,f]}})})},v$e=Q({nonMaxSuppressionWithScore_:function(e,t,n,r,i,a){r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY),a===void 0&&(a=0);var o=j(e,"boxes","nonMaxSuppression"),s=j(t,"scores","nonMaxSuppression"),u=CE(o,s,n,r,i,a),l={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:i=u.scoreThreshold,softNmsSigma:a=u.softNmsSigma},c=J.runKernel("NonMaxSuppressionV5",{boxes:o,scores:s},l);return{selectedIndices:c[0],selectedScores:c[1]}}}),y$e=function(e,t,n,r,i,a){return r===void 0&&(r=.5),i===void 0&&(i=Number.NEGATIVE_INFINITY),a===void 0&&(a=0),tt(this,void 0,void 0,function(){var o,s,u,l,c,f,d;return nt(this,function(h){switch(h.label){case 0:return o=j(e,"boxes","nonMaxSuppressionAsync"),s=j(t,"scores","nonMaxSuppressionAsync"),u=CE(o,s,n,r,i,a),n=u.maxOutputSize,r=u.iouThreshold,i=u.scoreThreshold,a=u.softNmsSigma,[4,Promise.all([o.data(),s.data()])];case 1:return l=h.sent(),c=l[0],f=l[1],d=K3(c,f,n,r,i,a),o!==e&&o.dispose(),s!==t&&s.dispose(),[2,d]}})})},b$e=Q({cropAndResize_:function(e,t,n,r,i,a){var o=j(e,"image","cropAndResize"),s=j(t,"boxes","cropAndResize","float32"),u=j(n,"boxInd","cropAndResize","int32");i=i||"bilinear",a=a||0;var l=s.shape[0];return U(o.rank===4,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+o.rank+"."}),U(s.rank===2&&s.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+l+",4] but had shape "+s.shape+"."}),U(u.rank===1&&u.shape[0]===l,function(){return"Error in cropAndResize: boxInd must be have size ["+l+"] but had shape "+s.shape+"."}),U(r.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."}),U(r[0]>=1&&r[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+r}),U(i==="bilinear"||i==="nearest",function(){return"method must be bilinear or nearest, but was "+i}),J.runKernelFunc(function(c,f){return c.cropAndResize(o,s,u,r,i,a)},{images:o,boxes:s,boxInd:u},null,"CropAndResize",{method:i,extrapolationValue:a,cropSize:r})}}),Lf=Object.freeze({resizeBilinear:h$e,resizeNearestNeighbor:p$e,nonMaxSuppression:g$e,nonMaxSuppressionAsync:m$e,nonMaxSuppressionWithScore:v$e,nonMaxSuppressionWithScoreAsync:y$e,cropAndResize:b$e}),MM=function(e,t){return!(e>0)||t==="linear"},PM=function(e,t,n){if(n==null||n==="linear")return e;if(n==="relu")return e.mul(t.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")},$M=function(e,t){var n=t,r=Vr(e.shape,t.shape);return r.length>0&&(n=n.sum(r)),n.reshape(e.shape)},LM=function(e,t,n){if(t==="linear")return e;if(t==="relu")return $f(e);if(t==="elu")return Lm(e);if(t==="relu6")return EM(e);if(t==="prelu")return Cb(e,n);throw new Error("Unknown fused activation "+t+".")},x$e=Q({fusedMatMul_:function(e){var t,n=e.a,r=e.b,i=e.transposeA,a=i!==void 0&&i,o=e.transposeB,s=o!==void 0&&o,u=e.bias,l=e.activation,c=l===void 0?"linear":l,f=e.preluActivationWeights;if(MM(J.state.gradientDepth,c)===!1){var d=cE(n,r,a,s);return u!=null&&(d=Wt(d,u)),LM(d,c,f)}var h=j(n,"a","fused matMul"),p=j(r,"b","fused matMul");t=ur(h,p),h=t[0],p=t[1];var g=a?h.shape[h.rank-2]:h.shape[h.rank-1],m=s?p.shape[p.rank-1]:p.shape[p.rank-2],v=a?h.shape[h.rank-1]:h.shape[h.rank-2],y=s?p.shape[p.rank-2]:p.shape[p.rank-1],b=h.shape.slice(0,-2),x=p.shape.slice(0,-2),w=et(b),S=et(x);U(h.rank>=2&&p.rank>=2&&h.rank===p.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+h.rank+" and "+p.rank+"."}),U(Ur(b,x),function(){return"Error in fused matMul: outer dimensions ("+b+") and ("+x+") of Tensors with shapes "+h.shape+" and "+p.shape+" must match."}),U(g===m,function(){return"Error in fused matMul: inner shapes ("+g+") and ("+m+") of Tensors with shapes "+h.shape+" and "+p.shape+" and transposeA="+a+" and transposeB="+s+" must match."});var C,_,E=h.shape.slice(0,-2).concat([v,y]),A=a?h.as3D(w,g,v):h.as3D(w,v,g),k=s?p.as3D(S,y,m):p.as3D(S,m,y);u!=null&&Qt(E,(C=ur(C=j(u,"bias","fused matMul"),h)[0]).shape),f!=null&&(_=j(f,"prelu weights","fused matMul"));var T={a:A,b:k};u!=null&&(T.bias=C),f!=null&&(T.preluActivationWeights=_);var I=[A,k];return J.runKernelFunc(function(N,O){var D=N.fusedBatchMatMul({a:A,b:k,transposeA:a,transposeB:s,bias:C,activation:c,preluActivationWeights:_});return O([A,k,D]),D},T,function(N,O){var D=O[0],L=O[1],W=O[2],G=PM(N,W,c),K={};return u!=null&&(K={bias:function(){return $M(C,G)}}),Object.assign(a||s?!a&&s?{a:function(){return G.matMul(L,!1,!1)},b:function(){return G.matMul(D,!0,!1)}}:a&&!s?{a:function(){return L.matMul(G,!1,!0)},b:function(){return D.matMul(G,!1,!1)}}:{a:function(){return L.matMul(G,!0,!0)},b:function(){return G.matMul(D,!0,!0)}}:{a:function(){return G.matMul(L,!1,!0)},b:function(){return D.matMul(G,!0,!1)}},K)},"_FusedMatMul",{transposeA:a,transposeB:s,activation:c},I,[!0]).reshape(E)}}),w$e=Q({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,i=e.pad,a=e.dataFormat,o=a===void 0?"NHWC":a,s=e.dilations,u=s===void 0?[1,1]:s,l=e.dimRoundingMode,c=e.bias,f=e.activation,d=f===void 0?"linear":f,h=e.preluActivationWeights;if(d=d||"linear",MM(J.state.gradientDepth,d)===!1){var p=Wh(t,n,r,i,o,u,l);return c!=null&&(p=Wt(p,c)),LM(p,d,h)}var g=j(t,"x","conv2d"),m=j(n,"filter","conv2d"),v=g,y=!1;g.rank===3&&(y=!0,v=g.as4D(1,g.shape[0],g.shape[1],g.shape[2])),U(v.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+v.rank+"."}),U(m.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+m.rank+"."}),l!=null&&U(gr(i),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+l+" but got pad "+i+"."}),U(v.shape[3]===m.shape[2],function(){return"Error in conv2d: depth of input ("+v.shape[3]+") must match input depth for filter "+m.shape[2]+"."}),U(Gi(r,u),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),U(o==="NHWC",function(){return"Error in conv2d: got dataFormat of "+o+" but only NHWC is currently supported."});var b,x,w=Mf(v.shape,m.shape,r,u,i,l);c!=null&&(b=ur(b=j(c,"bias","fused conv2d"),g)[0],Qt(w.outShape,b.shape)),h!=null&&(x=j(h,"prelu weights","fused conv2d"));var S={x:v,filter:m};c!=null&&(S.bias=b),h!=null&&(S.preluActivationWeights=x);var C=[m,v],_=J.runKernelFunc(function(E,A){var k=E.fusedConv2d({input:v,filter:m,convInfo:w,bias:b,activation:d,preluActivationWeights:x});return A([m,v,k]),k},S,function(E,A){var k=A,T=k[0],I=k[1],N=k[2],O=PM(E,N,d);U(Fh(u),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"});var D={};return c!=null&&(D={bias:function(){return $M(b,O)}}),Object.assign({x:function(){return bZ(I.shape,O,T,r,i)},filter:function(){return xM(I,O,T.shape,r,i)}},D)},"FusedConv2D",{convInfo:w,activation:d},C,[!0]);return y?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_}}),_$e=Q({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,i=e.pad,a=e.dataFormat,o=a===void 0?"NHWC":a,s=e.dilations,u=s===void 0?[1,1]:s,l=e.dimRoundingMode,c=e.bias,f=e.activation,d=f===void 0?"linear":f,h=e.preluActivationWeights;if(MM(J.state.gradientDepth,d)===!1){var p=Pm(t,n,r,i,o,u,l);return c!=null&&(p=Wt(p,c)),LM(p,d,h)}var g=j(t,"x","depthwiseConv2d"),m=j(n,"filter","depthwiseConv2d"),v=g,y=!1;g.rank===3&&(y=!0,v=g.as4D(1,g.shape[0],g.shape[1],g.shape[2])),U(v.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+v.rank+"."}),U(m.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+m.rank+"."}),U(v.shape[3]===m.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+v.shape[3]+") must match the inChannels dimension in filter "+m.shape[2]+"."}),u==null&&(u=[1,1]),U(Gi(r,u),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),l!=null&&U(gr(i),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+l+" but got pad "+i+"."});var b,x,w=Mf(v.shape,m.shape,r,u,i,l,!0);c!=null&&(b=ur(b=j(c,"bias","fused conv2d"),g)[0],Qt(w.outShape,b.shape)),h!=null&&(x=j(h,"prelu weights","fused depthwiseConv2d"));var S={x:v,filter:m};c!=null&&(S.bias=b),h!=null&&(S.preluActivationWeights=x);var C=[m,v],_=J.runKernelFunc(function(E,A){var k=E.fusedDepthwiseConv2D({input:v,filter:m,convInfo:w,bias:b,activation:d,preluActivationWeights:x});return A([m,v,k]),k},S,function(E,A){U(Fh(u),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"});var k=A[0],T=A[1],I=A[2],N=PM(E,I,d),O={};return c!=null&&(O={bias:function(){return $M(b,N)}}),Object.assign({x:function(){return xZ(T.shape,N,k,w)},filter:function(){return wZ(T,N,k.shape,w)}},O)},"FusedDepthwiseConv2D",{convInfo:w,activation:d},C,[!0]);return y?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_}}),Bf=Object.freeze({matMul:x$e,conv2d:w$e,depthwiseConv2d:_$e}),S$e=Object.freeze({image:Lf,linalg:FM,losses:UZ,spectral:$Z,fused:Bf,signal:zZ,add:Wt,addN:iM,batchNorm:Bh,batchNormalization:HY,batchNorm2d:aM,batchNormalization2d:KY,batchNorm3d:oM,batchNormalization3d:YY,batchNorm4d:sM,batchNormalization4d:JY,broadcastTo:uM,clone:QY,div:Cr,divNoNan:rE,eye:iE,multinomial:cM,oneHot:zh,pad:Gu,pad1d:tZ,pad2d:nZ,pad3d:rZ,pad4d:iZ,rand:aZ,randomGamma:sZ,randomNormal:gM,randomUniform:jh,square:aE,squaredDifference:oE,tile:sc,truncatedNormal:yb,conv1d:sE,conv2d:Wh,conv3d:uE,depthwiseConv2d:Pm,separableConv2d:wM,conv2dTranspose:lE,conv3dTranspose:_Z,op:Q,booleanMaskAsync:mZ,complex:ri,real:eo,imag:is,concat:Hi,concat1d:n3,concat2d:r3,concat3d:i3,concat4d:a3,split:ic,matMul:cE,dot:SZ,outerProduct:EZ,reverse:Ku,reverse1d:CZ,reverse2d:AZ,reverse3d:kZ,reverse4d:TZ,maxPool:fE,avgPool:dE,pool:NZ,maxPool3d:hE,avgPool3d:pE,maxPoolWithArgmax:_M,slice:Ro,slice1d:xb,slice2d:gE,slice3d:wb,slice4d:$m,abs:Df,acos:p3,acosh:g3,asin:m3,asinh:v3,atan:y3,atanh:b3,ceil:x3,clipByValue:xa,cos:w3,cosh:_3,erf:S3,exp:E3,expm1:C3,floor:MS,log:oc,log1p:A3,logSigmoid:kX,neg:Rf,reciprocal:k3,round:T3,rsqrt:PS,sigmoid:$S,sign:O3,isNaN:TX,isInf:OX,isFinite:IX,sin:I3,sinh:N3,softplus:ub,sqrt:lb,step:NX,tan:D3,tanh:LS,all:mE,any:_b,argMax:Sb,argMin:SM,logSumExp:RZ,max:Pf,mean:Fr,min:vE,moments:Eb,sum:qr,prod:yE,equal:Uh,equalStrict:uZ,greater:Rm,greaterEqual:bb,greaterEqualStrict:lZ,greaterStrict:cZ,less:mM,lessEqual:vM,lessEqualStrict:fZ,lessStrict:dZ,notEqual:Fm,notEqualStrict:hZ,addStrict:DX,atan2:R3,divStrict:RX,floorDiv:BS,maximum:Vu,maximumStrict:FX,minimum:Am,minimumStrict:MX,mod:F3,modStrict:PX,mul:rt,mulStrict:zS,pow:km,powStrict:$X,squaredDifferenceStrict:LX,sub:Er,subStrict:BX,elu:Lm,leakyRelu:bE,prelu:Cb,relu:$f,relu6:EM,selu:xE,logicalAnd:Hu,logicalNot:lM,logicalOr:tE,logicalXor:eZ,where:qs,whereAsync:nE,buffer:Ot,print:SX,batchToSpaceND:OS,cast:IS,cumsum:EX,depthToSpace:o3,expandDims:Do,reshape:Ws,spaceToBatchND:NS,squeeze:ab,stack:as,unstack:Nf,setdiff1dAsync:s3,fill:Em,linspace:t3,ones:Wu,range:Cm,scalar:Ve,tensor:Rr,tensor1d:ba,tensor2d:Uu,tensor3d:TS,tensor4d:If,tensor5d:wX,tensor6d:_X,variable:e3,zeros:Tn,onesLike:No,zerosLike:en,transpose:cn,softmax:Rh,logSoftmax:VS,localResponseNormalization:CM,norm:AM,gather:Mm,unsortedSegmentSum:yM,basicLSTMCell:FZ,multiRNNCell:MZ,movingAverage:PZ,stridedSlice:kM,topk:TM,scatterND:OM,fft:Ab,ifft:Bm,rfft:kb,irfft:wE,sparseToDense:_E,gatherND:IM,diag:LZ,dropout:NM,hannWindow:SE,hammingWindow:DM,frame:EE,stft:RM,inTopKAsync:jZ});function ke(e,t){Array.isArray(e)||(e=[e]),e.forEach(function(n){n!=null&&U(n.dtype!=="complex64",function(){return t+" does not support complex64 tensors."})})}function BM(e,t,n,r,i,a){for(var o=i.strideHeight,s=i.strideWidth,u=i.dilationHeight,l=i.dilationWidth,c=i.effectiveFilterHeight,f=i.effectiveFilterWidth,d=i.padInfo.top,h=i.padInfo.left,p=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=Ot(i.outShape,n),m=g.values,v=i.outShape[1]*i.outShape[2]*i.outShape[3],y=i.outShape[2]*i.outShape[3],b=i.outShape[3],x=0;x<i.batchSize;++x)for(var w=x*v,S=x*r[0],C=0;C<i.inChannels;++C)for(var _=0;_<i.outHeight;++_)for(var E=_*o-d,A=Math.max(0,E),k=Math.min(i.inHeight,c+E),T=w+_*y,I=0;I<i.outWidth;++I){for(var N=I*s-h,O=Math.max(0,N),D=Math.min(i.inWidth,f+N),L=p,W=0,G=0,K=A;K<k;K+=u){for(var ee=S+K*r[1],ce=O;ce<D;ce+=l){var he=e[ee+ce*r[2]+C];a==="max"&&he>L?L=he:a==="avg"&&(W+=he,G++)}if(isNaN(L))break}m[T+I*b+C]=a==="avg"?W/G:L}return g}function VZ(e,t,n,r,i,a){i===void 0&&(i=!1),a===void 0&&(a=!1);for(var o=Ot(r.outShape,"int32"),s=r.strideHeight,u=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterHeight,d=r.effectiveFilterWidth,h=r.padInfo.top,p=r.padInfo.left,g=Ot(t,n,e),m=0;m<r.batchSize;++m)for(var v=0;v<r.inChannels;++v)for(var y=0;y<r.outHeight;++y){for(var b=y*s-h,x=b;x<0;)x+=l;for(var w=Math.min(r.inHeight,f+b),S=0;S<r.outWidth;++S){for(var C=S*u-p,_=C;_<0;)_+=c;for(var E=Math.min(r.inWidth,d+C),A=Number.NEGATIVE_INFINITY,k=-1,T=x;T<w;T+=l)for(var I=T-b,N=_;N<E;N+=c){var O=N-C,D=g.get(m,T,N,v);D>A&&(A=D,k=i?a?((m*r.inHeight+T)*r.inWidth+N)*r.inChannels+v:(T*r.inWidth+N)*r.inChannels+v:I*d+O)}o.set(k,m,y,S,v)}}return o}function zM(e,t,n,r){if(n==="linear")return e.linear(t);if(n==="relu")return e.relu(t);if(n==="elu")return e.elu(t);if(n==="relu6")return e.relu6(t);if(n==="prelu")return e.prelu(t,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var E$e=function(e){function t(){var n=e.call(this)||this;return n.blockSize=48,n.firstUse=!0,n.data=new z3(n,J),n}return Bs(t,e),t.prototype.write=function(n,r,i){this.firstUse&&(this.firstUse=!1,pe().get("IS_NODE")&&AS(`
============================
Hi there \u{1F44B}. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var a={};return this.data.set(a,{values:n,dtype:i}),a},t.prototype.move=function(n,r,i,a){this.data.set(n,{values:r,dtype:a})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.read=function(n){return tt(this,void 0,void 0,function(){return nt(this,function(r){return[2,this.readSync(n)]})})},t.prototype.readSync=function(n){var r=this.data.get(n),i=r.dtype,a=r.complexTensors;return i==="complex64"?H3(this.readSync(a.real.dataId),this.readSync(a.imag.dataId)):this.data.get(n).values},t.prototype.bufferSync=function(n){var r=this.readSync(n.dataId),i=r;if(n.dtype==="string")try{i=r.map(function(a){return qy(a)})}catch(a){throw new Error("Failed to decode encoded string bytes into utf-8")}return Ot(n.shape,n.dtype,i)},t.prototype.makeOutput=function(n,r,i){var a=this.write(n,r,i);return J.makeTensorFromDataId(a,r,i,this)},t.prototype.disposeData=function(n){if(this.data.has(n)){var r=this.data.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.data.delete(n)}},t.prototype.time=function(n){return tt(this,void 0,void 0,function(){var r;return nt(this,function(i){return r=zs(),n(),[2,{kernelMs:zs()-r}]})})},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(n,r){var i=this.makeOutput(null,n.shape,"complex64");return this.data.get(i.dataId).complexTensors={real:J.keep(n.clone()),imag:J.keep(r.clone())},i},t.prototype.real=function(n){return this.data.get(n.dataId).complexTensors.real.clone()},t.prototype.imag=function(n){return this.data.get(n.dataId).complexTensors.imag.clone()},t.prototype.slice=function(n,r,i){if(ke(n,"slice"),L3(n.shape,r,i)){var a=B3(r,n.strides),o=et(i);return Rr(this.readSync(n.dataId).subarray(a,a+o),i,n.dtype)}for(var s=Ot(i,n.dtype),u=this.bufferSync(n),l=0;l<s.size;++l){var c=s.indexToLoc(l).map(function(f,d){return f+r[d]});s.values[l]=u.get.apply(u,c)}return s.toTensor()},t.prototype.stridedSlice=function(n,r,i,a){ke(n,"stridedSlice");var o=US(r,i,a);if(o.some(function(h){return h===0}))return Rr([],o);for(var s=Ot(o,n.dtype),u=this.bufferSync(n),l=0;l<s.size;l++){for(var c=s.indexToLoc(l),f=new Array(c.length),d=0;d<f.length;d++)f[d]=c[d]*a[d]+r[d];s.set.apply(s,[u.get.apply(u,f)].concat(c))}return s.toTensor()},t.prototype.diag=function(n){for(var r=this.readSync(n.dataId),i=Ot([n.size,n.size],n.dtype),a=i.values,o=0;o<r.length;o++)a[o*n.size+o]=r[o];return i.toTensor()},t.prototype.unstack=function(n,r){for(var i=n.shape[r],a=new Array(n.rank-1),o=0,s=0;s<n.rank;s++)s!==r&&(a[o++]=n.shape[s]);var u=new Array(n.rank).fill(0),l=n.shape.slice();l[r]=1;var c=new Array(i);for(s=0;s<c.length;s++)u[r]=s,c[s]=this.slice(n,u,l).reshape(a);return c},t.prototype.reverse=function(n,r){ke(n,"reverse");for(var i=Ot(n.shape,n.dtype),a=this.bufferSync(n),o=function(u){var l=i.indexToLoc(u),c=l.slice();r.forEach(function(f){return c[f]=n.shape[f]-1-c[f]}),i.set.apply(i,[a.get.apply(a,c)].concat(l))},s=0;s<i.size;s++)o(s);return i.toTensor()},t.prototype.concat=function(n,r){var i=this;if(n[0].dtype==="complex64"){var a=n.map(function(h){return eo(h)}),o=n.map(function(h){return is(h)});return ri(this.concat(a,r),this.concat(o,r))}var s=n.map(function(h){var p=et(h.shape.slice(r));return h.as2D(-1,p)}),u=Dh(s.map(function(h){return h.shape}),1),l=Ot(u,n[0].dtype).values;if(s[0].shape[0]===1){var c=0;s.forEach(function(h){l.set(i.readSync(h.dataId),c),c+=h.size})}else{var f=0;s.forEach(function(h){for(var p=i.readSync(h.dataId),g=0,m=0;m<h.shape[0];++m)for(var v=m*u[1]+f,y=0;y<h.shape[1];++y)l[v+y]=p[g++];f+=h.shape[1]})}var d=Dh(n.map(function(h){return h.shape}),r);return Rr(l,d,n[0].dtype)},t.prototype.neg=function(n){return ke(n,"neg"),this.multiply(Ve(-1),n)},t.prototype.add=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(i,a,o,s){return{real:i+o,imag:a+s}}):this.broadcastedBinaryOp(n,r,yi(n.dtype,r.dtype),function(i,a){return i+a})},t.prototype.addN=function(n){var r=this;ke(n,"addN");for(var i=n.map(function(c){return r.readSync(c.dataId)}),a=Ot(n[0].shape,n[0].dtype),o=a.values,s=0;s<n.length;s++)for(var u=i[s],l=0;l<o.length;l++)o[l]+=u[l];return a.toTensor()},t.prototype.softmax=function(n,r){var i=Wr([r],n.shape),a=this.max(n,i),o=ya(a.shape,i),s=this.subtract(n,a.reshape(o)),u=this.exp(s),l=this.sum(u,i).reshape(o);return Cr(u,l)},t.prototype.subtract=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(i,a,o,s){return{real:i-o,imag:a-s}}):this.broadcastedBinaryOp(n,r,yi(n.dtype,r.dtype),function(i,a){return i-a})},t.prototype.pow=function(n,r){return ke([n,r],"pow"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){return Math.pow(i,a)})},t.prototype.batchMatMul=function(n,r,i,a){ke([n,r],"matMul");for(var o=i?n.shape[1]:n.shape[2],s=i?n.shape[2]:n.shape[1],u=a?r.shape[1]:r.shape[2],l=n.shape[0],c=this.readSync(n.dataId),f=this.readSync(r.dataId),d=i?[n.strides[0],1,n.strides[1]]:[n.strides[0],n.strides[1],1],h=d[0],p=d[1],g=d[2],m=a?[1,r.strides[1],r.strides[0]]:[r.strides[1],1,r.strides[0]],v=m[0],y=m[1],b=m[2],x=s*u,w=Ot([l,s,u],n.dtype),S=w.values,C=this.blockSize,_=0;_<l;_++)for(var E=0;E<s;E+=C)for(var A=0;A<u;A+=C)for(var k=0;k<o;k+=C)for(var T=Math.min(E+C,s),I=Math.min(A+C,u),N=Math.min(k+C,o),O=E;O<T;O++)for(var D=A;D<I;D++){for(var L=0,W=k;W<N;W++)L+=c[_*h+O*p+W*g]*f[W*v+D*y+_*b];S[_*x+(O*u+D)]+=L}return w.toTensor()},t.prototype.fusedBatchMatMul=function(n){var r=n.a,i=n.b,a=n.transposeA,o=n.transposeB,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=this.batchMatMul(r,i,a,o);return s&&(c=this.add(c,s)),u&&(c=zM(this,c,u,l)),c},t.prototype.multiply=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(i,a,o,s){return{real:i*o-a*s,imag:i*s+a*o}}):this.broadcastedBinaryOp(n,r,yi(n.dtype,r.dtype),function(i,a){return i*a})},t.prototype.floorDiv=function(n,r){return ke([n,r],"floorDiv"),this.broadcastedBinaryOp(n,r,"int32",function(i,a){return Math.floor(i/a)})},t.prototype.sum=function(n,r){ke(n,"sum"),Qa("sum",r,n.rank);for(var i=Di(n.shape,r),a=i[0],o=i[1],s=Tn(a,yi(n.dtype,"int32")),u=et(o),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=0,p=0;p<u;++p)h+=c[d+p];l[f]=h}return s},t.prototype.prod=function(n,r){ke(n,"sum");for(var i=Di(n.shape,r),a=i[0],o=i[1],s=Tn(a,yi(n.dtype,"int32")),u=et(o),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=1,p=0;p<u;++p)h*=c[d+p];l[f]=h}return s},t.prototype.unsortedSegmentSum=function(n,r,i){ke(n,"unsortedSegmentSum");for(var a=[],o=n.rank-r.rank,s=0;s<o;++s)r=r.expandDims(s+1);for(s=0;s<i;++s){var u=Ve(s,"int32"),l=Uh(u,r).asType("float32").mul(n).sum(0);a.push(l)}return as(a)},t.prototype.argMin=function(n,r){ke(n,"argMin");var i=[r];Qa("argMin",i,n.rank);for(var a=Di(n.shape,i),o=a[0],s=a[1],u=Tn(o,"int32"),l=et(s),c=this.readSync(u.dataId),f=this.readSync(n.dataId),d=0;d<c.length;++d){for(var h=d*l,p=f[h],g=0,m=0;m<l;++m){var v=f[h+m];v<p&&(p=v,g=m)}c[d]=g}return u},t.prototype.argMax=function(n,r){ke(n,"argMax");var i=[r];Qa("argMax",i,n.rank);for(var a=Di(n.shape,i),o=a[0],s=a[1],u=Tn(o,"int32"),l=et(s),c=this.readSync(u.dataId),f=this.readSync(n.dataId),d=0;d<c.length;++d){for(var h=d*l,p=f[h],g=0,m=0;m<l;++m){var v=f[h+m];v>p&&(p=v,g=m)}c[d]=g}return u},t.prototype.cumsum=function(n,r,i,a){if(ke(n,"cumsum"),r!==n.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(n.rank-1)+" but got axis="+r);for(var o=yi(n.dtype,"int32"),s=Tn(n.shape,o),u=this.readSync(s.dataId),l=this.readSync(n.dataId),c=n.shape[n.rank-1],f=a?function(m,v){return m+c-v-1}:function(m,v){return m+v},d=0;d<l.length;d+=c)for(var h=0;h<c;h++){var p=f(d,h);if(h===0)u[p]=i?0:l[p];else{var g=f(d,h-1);u[p]=i?l[g]+u[g]:l[p]+u[g]}}return s},t.prototype.equal=function(n,r){return ke([n,r],"equal"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i===a?1:0})},t.prototype.notEqual=function(n,r){return ke([n,r],"notEqual"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i!==a?1:0})},t.prototype.less=function(n,r){return ke([n,r],"less"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i<a?1:0})},t.prototype.lessEqual=function(n,r){return ke([n,r],"lessEqual"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i<=a?1:0})},t.prototype.greater=function(n,r){return ke([n,r],"greater"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i>a?1:0})},t.prototype.greaterEqual=function(n,r){return ke([n,r],"greaterEqual"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i>=a?1:0})},t.prototype.logicalNot=function(n){ke(n,"logicalNot");for(var r=this.readSync(n.dataId),i=new Uint8Array(r.length),a=0;a<r.length;++a)i[a]=r[a]?0:1;return this.makeOutput(i,n.shape,"bool")},t.prototype.logicalAnd=function(n,r){return ke([n,r],"logicalAnd"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i&&a})},t.prototype.logicalOr=function(n,r){return ke([n,r],"logicalOr"),this.broadcastedBinaryOp(n,r,"bool",function(i,a){return i||a})},t.prototype.select=function(n,r,i){ke([n,r,i],"select");for(var a=this.readSync(n.dataId),o=this.readSync(r.dataId),s=this.readSync(i.dataId),u=Tn(r.shape,yi(r.dtype,i.dtype)),l=this.readSync(u.dataId),c=0,f=n.rank===0||n.rank>1||r.rank===1?1:et(r.shape.slice(1)),d=0;d<a.length;d++)for(var h=0;h<f;h++)a[d]===1?l[c++]=o[d]:l[c++]=s[d];return u},t.prototype.where=function(n){ke([n],"where");var r=this.readSync(n.dataId);return X3(n.shape,r)},t.prototype.topk=function(n,r,i){return ke(n,"topk"),ZX(this.readSync(n.dataId),n.shape,n.dtype,r)},t.prototype.min=function(n,r){ke(n,"min"),Qa("min",r,n.rank);for(var i=Di(n.shape,r),a=i[0],o=i[1],s=Tn(a,n.dtype),u=et(o),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=c[d],p=0;p<u;++p){var g=c[d+p];g<h&&(h=g)}l[f]=h}return s},t.prototype.minimum=function(n,r){return ke([n,r],"minimum"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){return Math.min(i,a)})},t.prototype.mod=function(n,r){return ke([n,r],"mod"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){var o=i%a;return i<0&&a<0||i>=0&&a>=0?o:(o+a)%a})},t.prototype.max=function(n,r){ke(n,"max"),Qa("max",r,n.rank);for(var i=Di(n.shape,r),a=i[0],o=i[1],s=Tn(a,n.dtype),u=et(o),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=c[d],p=0;p<u;++p){var g=c[d+p];g>h&&(h=g)}l[f]=h}return s},t.prototype.maximum=function(n,r){return ke([n,r],"maximum"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){return Math.max(i,a)})},t.prototype.all=function(n,r){ke(n,"all"),Qa("all",r,n.rank);for(var i=Di(n.shape,r),a=i[0],o=i[1],s=Tn(a,n.dtype),u=et(o),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=c[d],p=0;p<u;++p){var g=c[d+p];h=h&&g}l[f]=h}return s},t.prototype.any=function(n,r){ke(n,"any"),Qa("any",r,n.rank);for(var i=Di(n.shape,r),a=i[0],o=i[1],s=Tn(a,n.dtype),u=et(o),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=c[d],p=0;p<u;++p){var g=c[d+p];h=h||g}l[f]=h}return s},t.prototype.squaredDifference=function(n,r){return ke([n,r],"squaredDifference"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){var o=i-a;return o*o})},t.prototype.ceil=function(n){ke(n,"ceil");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a)i[a]=Math.ceil(r[a]);return this.makeOutput(i,n.shape,"float32")},t.prototype.floor=function(n){ke(n,"floor");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a)i[a]=Math.floor(r[a]);return this.makeOutput(i,n.shape,"float32")},t.prototype.sign=function(n){ke(n,"x");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a)r[a]<0?i[a]=-1:r[a]>0?i[a]=1:i[a]=0;return this.makeOutput(i,n.shape,"float32")},t.prototype.isNaN=function(n){ke(n,"x");for(var r=this.readSync(n.dataId),i=new Uint8Array(r.length),a=0;a<r.length;++a)Number.isNaN(r[a])&&(i[a]=1);return this.makeOutput(i,n.shape,"bool")},t.prototype.isInf=function(n){ke(n,"x");for(var r=this.readSync(n.dataId),i=new Uint8Array(r.length),a=0;a<r.length;++a)Math.abs(r[a])===1/0&&(i[a]=1);return this.makeOutput(i,n.shape,"bool")},t.prototype.isFinite=function(n){ke(n,"x");for(var r=this.readSync(n.dataId),i=new Uint8Array(r.length),a=0;a<r.length;++a)Number.isFinite(r[a])&&(i[a]=1);return this.makeOutput(i,n.shape,"bool")},t.prototype.round=function(n){ke(n,"round");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a){var o=Math.floor(r[a]);r[a]-o<.5?i[a]=Math.floor(r[a]):r[a]-o>.5?i[a]=Math.ceil(r[a]):i[a]=o%2==0?o:o+1}return this.makeOutput(i,n.shape,"float32")},t.prototype.exp=function(n){ke(n,"exp");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a)i[a]=Math.exp(r[a]);return this.makeOutput(i,n.shape,"float32")},t.prototype.expm1=function(n){ke(n,"expm1");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a)i[a]=Math.expm1(r[a]);return this.makeOutput(i,n.shape,"float32")},t.prototype.log=function(n){ke(n,"log");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a){var o=r[a];i[a]=Math.log(o)}return this.makeOutput(i,n.shape,"float32")},t.prototype.log1p=function(n){ke(n,"log1p");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a){var o=r[a];i[a]=Math.log1p(o)}return this.makeOutput(i,n.shape,"float32")},t.prototype.sqrt=function(n){ke(n,"sqrt");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a){var o=r[a];i[a]=Math.sqrt(o)}return this.makeOutput(i,n.shape,"float32")},t.prototype.rsqrt=function(n){ke(n,"rsqrt");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a){var o=r[a];i[a]=1/Math.sqrt(o)}return this.makeOutput(i,n.shape,"float32")},t.prototype.reciprocal=function(n){ke(n,"reciprocal");for(var r=this.readSync(n.dataId),i=new Float32Array(r.length),a=0;a<r.length;++a)i[a]=1/r[a];return this.makeOutput(i,n.shape,"float32")},t.prototype.linear=function(n){return n},t.prototype.relu=function(n){ke(n,"relu");for(var r=Tn(n.shape,n.dtype),i=this.readSync(r.dataId),a=this.readSync(n.dataId),o=0;o<a.length;++o)i[o]=Math.max(0,a[o]);return r},t.prototype.relu6=function(n){ke(n,"relu");for(var r=Tn(n.shape,n.dtype),i=this.readSync(r.dataId),a=this.readSync(n.dataId),o=0;o<a.length;++o)i[o]=Math.min(Math.max(0,a[o]),6);return r},t.prototype.prelu=function(n,r){return ke([n,r],"prelu"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){return i<0?a*i:i})},t.prototype.elu=function(n){ke(n,"elu");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a){var o=i[a];r[a]=o>=0?o:Math.exp(o)-1}return this.makeOutput(r,n.shape,"float32")},t.prototype.eluDer=function(n,r){ke([n,r],"eluDer");for(var i=new Float32Array(r.size),a=this.readSync(r.dataId),o=this.readSync(n.dataId),s=0;s<a.length;++s){var u=a[s];i[s]=u>=1?o[s]:o[s]*(u+1)}return this.makeOutput(i,r.shape,"float32")},t.prototype.selu=function(n){ke(n,"selu");for(var r=nM,i=rM,a=new Float32Array(n.size),o=this.readSync(n.dataId),s=0;s<o.length;++s){var u=o[s];a[s]=u>=0?i*u:r*(Math.exp(u)-1)}return this.makeOutput(a,n.shape,"float32")},t.prototype.clip=function(n,r,i){ke(n,"clip");for(var a=new Float32Array(n.size),o=this.readSync(n.dataId),s=0;s<o.length;++s){var u=o[s];a[s]=u>i?i:u<r?r:u}return this.makeOutput(a,n.shape,"float32")},t.prototype.abs=function(n){for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.abs(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.complexAbs=function(n){for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<n.size;++a){var o=i[2*a],s=i[2*a+1];r[a]=Math.hypot(o,s)}return this.makeOutput(r,n.shape,"float32")},t.prototype.int=function(n){ke(n,"int");for(var r=new Int32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=i[a];return this.makeOutput(r,n.shape,"int32")},t.prototype.sigmoid=function(n){ke(n,"sigmoid");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=1/(1+Math.exp(-i[a]));return this.makeOutput(r,n.shape,"float32")},t.prototype.softplus=function(n){ke(n,"softplus");for(var r=Math.log(11920928955078125e-23)+2,i=new Float32Array(n.size),a=this.readSync(n.dataId),o=0;o<a.length;++o){var s=a[o]>-r,u=a[o]<r,l=Math.exp(a[o]),c=void 0;c=u?l:s?a[o]:Math.log(1+l),i[o]=c}return this.makeOutput(i,n.shape,"float32")},t.prototype.sin=function(n){ke(n,"sin");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.sin(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.cos=function(n){ke(n,"cos");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.cos(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.tan=function(n){ke(n,"tan");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.tan(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.asin=function(n){ke(n,"asin");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.asin(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.acos=function(n){ke(n,"acos");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.acos(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atan=function(n){ke(n,"atan");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.atan(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atan2=function(n,r){return ke([n,r],"atan2"),this.broadcastedBinaryOp(n,r,n.dtype,function(i,a){return Math.atan2(i,a)})},t.prototype.sinh=function(n){ke(n,"sinh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.sinh(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.cosh=function(n){ke(n,"cosh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.cosh(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.tanh=function(n){ke(n,"tanh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=NK(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.asinh=function(n){ke(n,"asinh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.asinh(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.acosh=function(n){ke(n,"acosh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.acosh(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atanh=function(n){ke(n,"atanh");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a)r[a]=Math.atanh(i[a]);return this.makeOutput(r,n.shape,"float32")},t.prototype.erf=function(n){ke(n,"erf");for(var r=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a){var o=Math.sign(i[a]),s=Math.abs(i[a]),u=1/(1+.3275911*s);r[a]=o*(1-((((1.061405429*u-1.453152027)*u+1.421413741)*u-.284496736)*u+.254829592)*u*Math.exp(-s*s))}return this.makeOutput(r,n.shape,"float32")},t.prototype.step=function(n,r){r===void 0&&(r=0),ke(n,"step");for(var i=new Float32Array(n.size),a=this.readSync(n.dataId),o=0;o<a.length;++o){var s=a[o];isNaN(s)?i[o]=NaN:i[o]=s>0?1:r}return this.makeOutput(i,n.shape,"float32")},t.prototype.fusedConv2d=function(n){var r=n.input,i=n.filter,a=n.convInfo,o=n.bias,s=n.activation,u=n.preluActivationWeights,l=this.conv2d(r,i,a);return o&&(l=this.add(l,o)),s&&(l=zM(this,l,s,u)),l},t.prototype.conv2d=function(n,r,i){ke([n,r],"conv2d");for(var a=i.filterHeight,o=i.filterWidth,s=i.dilationHeight,u=i.dilationWidth,l=i.padInfo.left,c=i.padInfo.top,f=i.dataFormat==="channelsLast",d=Ot(i.outShape,n.dtype),h=n.strides[0],p=f?n.strides[1]:n.strides[2],g=f?n.strides[2]:1,m=f?1:n.strides[1],v=d.strides[0],y=f?d.strides[1]:d.strides[2],b=f?d.strides[2]:1,x=f?1:d.strides[1],w=this.readSync(n.dataId),S=this.readSync(r.dataId),C=d.values,_=0;_<i.batchSize;++_)for(var E=_*h,A=_*v,k=0;k<i.outHeight;++k)for(var T=A+k*y,I=k*i.strideHeight-c,N=0;N<a;N++){var O=I+N*s;if(!(O<0||O>=i.inHeight))for(var D=N*r.strides[0],L=E+O*p,W=0;W<i.outWidth;++W)for(var G=T+W*b,K=W*i.strideWidth-l,ee=0;ee<o;ee++){var ce=K+ee*u;if(!(ce<0||ce>=i.inWidth))for(var he=L+ce*g,Oe=D+ee*r.strides[1],Te=0;Te<i.inChannels;++Te){for(var De=w[he+Te*m],me=0;me<i.outChannels;++me)C[G+me*x]+=De*S[Oe+me];Oe+=i.outChannels}}}return d.toTensor()},t.prototype.conv3d=function(n,r,i){for(var a=i.filterDepth,o=i.filterHeight,s=i.filterWidth,u=i.dilationDepth,l=i.dilationHeight,c=i.dilationWidth,f=i.padInfo.front,d=i.padInfo.left,h=i.padInfo.top,p=Ot(i.outShape,n.dtype),g=this.readSync(n.dataId),m=this.readSync(r.dataId),v=p.values,y=0;y<i.batchSize;++y)for(var b=y*n.strides[0],x=y*p.strides[0],w=0;w<i.outDepth;++w)for(var S=x+w*p.strides[1],C=w*i.strideDepth-f,_=0;_<a;_++){var E=C+_*u;if(!(E<0||E>=i.inDepth))for(var A=_*r.strides[0],k=b+E*n.strides[1],T=0;T<i.outHeight;++T)for(var I=S+T*p.strides[2],N=T*i.strideHeight-h,O=0;O<o;O++){var D=N+O*l;if(!(D<0||D>=i.inHeight))for(var L=A+O*r.strides[1],W=k+D*n.strides[2],G=0;G<i.outWidth;++G)for(var K=I+G*i.outChannels,ee=G*i.strideWidth-d,ce=0;ce<s;ce++){var he=ee+ce*c;if(!(he<0||he>=i.inWidth))for(var Oe=L+ce*r.strides[2],Te=W+he*i.inChannels,De=Oe,me=0;me<i.inChannels;++me){for(var P=g[Te+me],F=0;F<i.outChannels;++F)v[K+F]+=P*m[De+F];De+=i.outChannels}}}}return p.toTensor()},t.prototype.conv2dDerInput=function(n,r,i){ke([n,r],"conv2dDerInput");for(var a=Ot(i.inShape,"float32"),o=a.values,s=this.readSync(n.dataId),u=this.readSync(r.dataId),l=r.strides,c=l[0],f=l[1],d=l[2],h=i.batchSize,p=i.filterHeight,g=i.filterWidth,m=i.inChannels,v=i.inHeight,y=i.inWidth,b=i.outChannels,x=i.outHeight,w=i.outWidth,S=i.strideHeight,C=i.strideWidth,_=i.dataFormat,E=p-1-i.padInfo.top,A=g-1-i.padInfo.left,k=_==="channelsLast",T=a.strides[0],I=k?a.strides[1]:a.strides[2],N=k?a.strides[2]:1,O=k?1:a.strides[1],D=n.strides[0],L=k?n.strides[1]:n.strides[2],W=k?n.strides[2]:1,G=k?1:n.strides[1],K=0;K<h;++K)for(var ee=0;ee<m;++ee)for(var ce=0;ce<v;++ce)for(var he=ce-E,Oe=Math.max(0,Math.ceil(he/S)),Te=Math.min(x,(p+he)/S),De=0;De<y;++De){for(var me=De-A,P=Math.max(0,Math.ceil(me/C)),F=Math.min(w,(g+me)/C),V=0,ae=Oe;ae<Te;++ae)for(var Y=ae*S-he,M=P;M<F;++M)for(var B=D*K+L*ae+W*M,R=c*(p-1-Y)+f*(g-1-(M*C-me))+d*ee,X=0;X<b;++X)V+=s[B+G*X]*u[R+X];o[T*K+I*ce+N*De+O*ee]=V}return a.toTensor()},t.prototype.conv3dDerInput=function(n,r,i){for(var a=Ot(i.inShape,"float32"),o=a.values,s=a.strides,u=s[0],l=s[1],c=s[2],f=s[3],d=this.readSync(n.dataId),h=n.strides,p=h[0],g=h[1],m=h[2],v=h[3],y=this.readSync(r.dataId),b=r.strides,x=b[0],w=b[1],S=b[2],C=b[3],_=i.batchSize,E=i.filterDepth,A=i.filterHeight,k=i.filterWidth,T=i.inChannels,I=i.inDepth,N=i.inHeight,O=i.inWidth,D=i.outChannels,L=i.outDepth,W=i.outHeight,G=i.outWidth,K=i.strideDepth,ee=i.strideHeight,ce=i.strideWidth,he=E-1-i.padInfo.front,Oe=A-1-i.padInfo.top,Te=k-1-i.padInfo.left,De=0;De<_;++De)for(var me=0;me<T;++me)for(var P=0;P<I;++P)for(var F=P-he,V=Math.max(0,Math.ceil(F/K)),ae=Math.min(L,(E+F)/K),Y=0;Y<N;++Y)for(var M=Y-Oe,B=Math.max(0,Math.ceil(M/ee)),R=Math.min(W,(A+M)/ee),X=0;X<O;++X){for(var ge=X-Te,xe=Math.max(0,Math.ceil(ge/ce)),ze=Math.min(G,(k+ge)/ce),Ke=0,Ze=V;Ze<ae;++Ze)for(var Bt=Ze*K-F,Je=B;Je<R;++Je)for(var Zt=Je*ee-M,mn=xe;mn<ze;++mn)for(var Hn=p*De+g*Ze+m*Je+v*mn,ti=x*(E-1-Bt)+w*(A-1-Zt)+S*(k-1-(mn*ce-ge))+C*me,er=0;er<D;++er)Ke+=d[Hn+er]*y[ti+er];o[u*De+l*P+c*Y+f*X+me]=Ke}return a.toTensor()},t.prototype.conv2dDerFilter=function(n,r,i){ke([n,r],"conv2dDerFilter");for(var a=i.strideHeight,o=i.strideWidth,s=i.filterHeight,u=i.filterWidth,l=i.dataFormat==="channelsLast",c=Ot(i.filterShape,"float32"),f=i.padInfo.left,d=i.padInfo.top,h=this.bufferSync(n),p=this.bufferSync(r),g=0;g<s;++g)for(var m=Math.max(0,Math.ceil((d-g)/a)),v=Math.min(i.outHeight,(i.inHeight+d-g)/a),y=0;y<u;++y)for(var b=Math.max(0,Math.ceil((f-y)/o)),x=Math.min(i.outWidth,(i.inWidth+f-y)/o),w=0;w<i.inChannels;++w)for(var S=0;S<i.outChannels;++S){for(var C=0,_=0;_<i.batchSize;++_)for(var E=m;E<v;++E)for(var A=g+E*a-d,k=b;k<x;++k){var T=y+k*o-f;C+=l?h.get(_,A,T,w)*p.get(_,E,k,S):h.get(_,w,A,T)*p.get(_,S,E,k)}c.set(C,g,y,w,S)}return c.toTensor()},t.prototype.conv3dDerFilter=function(n,r,i){for(var a=i.strideDepth,o=i.strideHeight,s=i.strideWidth,u=i.filterDepth,l=i.filterHeight,c=i.filterWidth,f=Ot(i.filterShape,"float32"),d=f.values,h=f.strides,p=h[0],g=h[1],m=h[2],v=h[3],y=this.readSync(r.dataId),b=r.strides,x=b[0],w=b[1],S=b[2],C=b[3],_=this.readSync(n.dataId),E=n.strides,A=E[0],k=E[1],T=E[2],I=E[3],N=i.padInfo.front,O=i.padInfo.left,D=i.padInfo.top,L=0;L<u;++L)for(var W=Math.max(0,Math.ceil((N-L)/a)),G=Math.min(i.outDepth,(i.inDepth+N-L)/a),K=L*p,ee=0;ee<l;++ee)for(var ce=Math.max(0,Math.ceil((D-ee)/o)),he=Math.min(i.outHeight,(i.inHeight+D-ee)/o),Oe=ee*g+K,Te=0;Te<c;++Te)for(var De=Math.max(0,Math.ceil((O-Te)/s)),me=Math.min(i.outWidth,(i.inWidth+O-Te)/s),P=Te*m+Oe,F=0;F<i.inChannels;++F)for(var V=F*v+P,ae=0;ae<i.outChannels;++ae){for(var Y=0,M=0;M<i.batchSize;++M)for(var B=M*A,R=M*x,X=W;X<G;++X)for(var ge=(L+X*a-N)*k+B,xe=X*w+R,ze=ce;ze<he;++ze)for(var Ke=(ee+ze*o-D)*T+ge,Ze=ze*S+xe,Bt=De;Bt<me;++Bt){var Je=Bt*C+Ze;Y+=_[(Te+Bt*s-O)*I+Ke+F]*y[Je+ae]}d[V+ae]=Y}return f.toTensor()},t.prototype.fusedDepthwiseConv2D=function(n){var r=n.input,i=n.filter,a=n.convInfo,o=n.bias,s=n.activation,u=n.preluActivationWeights,l=this.depthwiseConv2D(r,i,a);return o&&(l=this.add(l,o)),s&&(l=zM(this,l,s,u)),l},t.prototype.depthwiseConv2D=function(n,r,i){ke([n,r],"depthwiseConv2D");for(var a=i.filterHeight,o=i.filterWidth,s=i.dilationHeight,u=i.dilationWidth,l=i.padInfo.left,c=i.padInfo.top,f=i.outChannels/i.inChannels,d=Ot(i.outShape,n.dtype),h=this.readSync(n.dataId),p=this.readSync(r.dataId),g=d.values,m=0;m<i.batchSize;++m)for(var v=m*n.strides[0],y=m*d.strides[0],b=0;b<i.outHeight;++b)for(var x=y+b*d.strides[1],w=b*i.strideHeight-l,S=0;S<a;++S){var C=w+S*s;if(!(C<0||C>=i.inHeight))for(var _=S*r.strides[0],E=v+C*n.strides[1],A=0;A<i.outWidth;++A)for(var k=x+A*d.strides[2],T=A*i.strideWidth-c,I=0;I<o;++I){var N=T+I*u;if(!(N<0||N>=i.inWidth))for(var O=_+I*r.strides[1],D=E+N*i.inChannels,L=k,W=O,G=0;G<i.inChannels;++G){for(var K=h[D+G],ee=0;ee<f;++ee)g[L+ee]+=K*p[W+ee];L+=f,W+=f}}}return d.toTensor()},t.prototype.depthwiseConv2DDerInput=function(n,r,i){ke([n,r],"depthwiseConv2DDerInput");for(var a=Ot(i.inShape,"float32"),o=a.values,s=a.strides,u=s[0],l=s[1],c=s[2],f=this.readSync(n.dataId),d=n.strides,h=d[0],p=d[1],g=d[2],m=this.readSync(r.dataId),v=r.strides,y=v[0],b=v[1],x=v[2],w=i.batchSize,S=i.filterHeight,C=i.filterWidth,_=i.inChannels,E=i.inHeight,A=i.inWidth,k=i.outChannels,T=i.outHeight,I=i.outWidth,N=i.strideHeight,O=i.strideWidth,D=S-1-i.padInfo.top,L=C-1-i.padInfo.left,W=k/_,G=0;G<w;++G)for(var K=0;K<_;++K)for(var ee=0;ee<E;++ee)for(var ce=ee-D,he=Math.max(0,Math.ceil(ce/N)),Oe=Math.min(T,(S+ce)/N),Te=0;Te<A;++Te){for(var De=Te-L,me=Math.max(0,Math.ceil(De/O)),P=Math.min(I,(C+De)/O),F=0,V=he;V<Oe;++V)for(var ae=V*N-ce,Y=me;Y<P;++Y)for(var M=h*G+p*V+g*Y,B=y*(S-1-ae)+b*(C-1-(Y*O-De))+x*K,R=0;R<W;++R)F+=f[M+(K*W+R)]*m[B+R];o[u*G+l*ee+c*Te+K]=F}return a.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(n,r,i){ke([n,r],"depthwiseConv2DDerFilter");for(var a=i.strideHeight,o=i.strideWidth,s=i.filterHeight,u=i.filterWidth,l=Ot(i.filterShape,"float32"),c=i.padInfo.left,f=i.padInfo.top,d=i.outChannels/i.inChannels,h=this.bufferSync(n),p=this.bufferSync(r),g=0;g<s;++g)for(var m=Math.max(0,Math.ceil((f-g)/a)),v=Math.min(i.outHeight,(i.inHeight+f-g)/a),y=0;y<u;++y)for(var b=Math.max(0,Math.ceil((c-y)/o)),x=Math.min(i.outWidth,(i.inWidth+c-y)/o),w=0;w<i.outChannels;++w){for(var S=Math.trunc(w/d),C=w%d,_=0,E=0;E<i.batchSize;++E)for(var A=m;A<v;++A)for(var k=g+A*a-f,T=b;T<x;++T){var I=y+T*o-c;_+=h.get(E,k,I,S)*p.get(E,A,T,w)}l.set(_,g,y,S,C)}return l.toTensor()},t.prototype.tile=function(n,r){return ke(n,"tile"),YX(this.bufferSync(n),r)},t.prototype.pad=function(n,r,i){ke(n,"pad");var a=r.map(function(d,h){return d[0]+n.shape[h]+d[1]}),o=r.map(function(d){return d[0]}),s=this.bufferSync(n),u=Ot(a,n.dtype);i!==0&&u.values.fill(i);for(var l=0;l<n.size;l++){var c=s.indexToLoc(l),f=c.map(function(d,h){return d+o[h]});u.set.apply(u,[s.get.apply(s,c)].concat(f))}return u.toTensor()},t.prototype.gather=function(n,r,i){ke([n,r],"gather");var a=n.shape.slice(),o=this.readSync(r.dataId);a[i]=o.length;for(var s=Ot(a,n.dtype),u=this.bufferSync(n),l=0;l<s.size;++l){var c=s.indexToLoc(l),f=c.slice();f[i]=o[c[i]];var d=u.locToIndex(f);s.values[l]=u.values[d]}return s.toTensor()},t.prototype.batchToSpaceND=function(n,r,i){ke([n],"batchToSpaceND");var a=r.reduce(function(f,d){return f*d}),o=DS(n.shape,r,a),s=RS(o.length,r.length),u=FS(n.shape,r,a),l=CX(i,r.length),c=AX(u,i,r.length);return cn(n.reshape(o),s).reshape(u).slice(l,c)},t.prototype.spaceToBatchND=function(n,r,i){ke([n],"spaceToBatchND");var a=r.reduce(function(d,h){return d*h}),o=[[0,0]];o.push.apply(o,i);for(var s=1+r.length;s<n.shape.length;++s)o.push([0,0]);var u=n.pad(o),l=DS(u.shape,r,a,!1),c=RS(l.length,r.length,!1),f=FS(u.shape,r,a,!1);return cn(u.reshape(l),c).reshape(f)},t.prototype.maxPool=function(n,r){return ke(n,"maxPool"),BM(this.readSync(n.dataId),n.shape,n.dtype,n.strides,r,"max").toTensor()},t.prototype.maxPoolBackprop=function(n,r,i,a){ke([r,i],"maxPoolBackprop");for(var o=this.readSync(r.dataId),s=Ot(a.outShape,r.dtype,VZ(o,r.shape,r.dtype,a).values),u=a.strideHeight,l=a.strideWidth,c=a.dilationHeight,f=a.dilationWidth,d=a.effectiveFilterHeight,h=a.effectiveFilterWidth,p=h-1-a.padInfo.left,g=d-1-a.padInfo.top,m=Ot(r.shape,"float32"),v=this.bufferSync(n),y=0;y<a.batchSize;++y)for(var b=0;b<a.inChannels;++b)for(var x=0;x<a.inHeight;++x)for(var w=0;w<a.inWidth;++w){for(var S=x-g,C=w-p,_=0,E=0;E<d;E+=c){var A=(S+E)/u;if(!(A<0||A>=a.outHeight||Math.floor(A)!==A))for(var k=0;k<h;k+=f){var T=(C+k)/l;if(!(T<0||T>=a.outWidth||Math.floor(T)!==T)){var I=d*h-1-s.get(y,A,T,b)===E*h+k?1:0;I!==0&&(_+=v.get(y,A,T,b)*I)}}}m.set(_,y,x,w,b)}return m.toTensor()},t.prototype.avgPoolBackprop=function(n,r,i){ke([n,r],"avgPoolBackprop");for(var a=i.strideHeight,o=i.strideWidth,s=i.filterHeight,u=i.filterWidth,l=i.dilationHeight,c=i.dilationWidth,f=i.effectiveFilterHeight,d=i.effectiveFilterWidth,h=d-1-i.padInfo.left,p=f-1-i.padInfo.top,g=Ot(r.shape,"float32"),m=1/(s*u),v=this.bufferSync(n),y=0;y<i.batchSize;++y)for(var b=0;b<i.inChannels;++b)for(var x=0;x<i.inHeight;++x)for(var w=0;w<i.inWidth;++w){for(var S=x-p,C=w-h,_=0,E=0;E<f;E+=l){var A=(S+E)/a;if(!(A<0||A>=i.outHeight||Math.floor(A)!==A))for(var k=0;k<d;k+=c){var T=(C+k)/o;T<0||T>=i.outWidth||Math.floor(T)!==T||(_+=v.get(y,A,T,b))}}g.set(_*m,y,x,w,b)}return g.toTensor()},t.prototype.pool3d=function(n,r,i){ke(n,"pool3d");for(var a=r.strideDepth,o=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterDepth,d=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=r.padInfo.front,g=r.padInfo.top,m=r.padInfo.left,v=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,y=this.readSync(n.dataId),b=Ot(r.outShape,n.dtype),x=b.values,w=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],S=r.outShape[2]*r.outShape[3]*r.outShape[4],C=r.outShape[3]*r.outShape[4],_=r.outShape[4],E=0;E<r.batchSize;++E)for(var A=E*w,k=E*n.strides[0],T=0;T<r.inChannels;++T)for(var I=0;I<r.outDepth;++I){for(var N=I*a-p,O=N;O<0;)O+=u;for(var D=Math.min(r.inDepth,f+N),L=A+I*S,W=0;W<r.outHeight;++W){for(var G=W*o-g,K=G;K<0;)K+=l;for(var ee=Math.min(r.inHeight,d+G),ce=L+W*C,he=0;he<r.outWidth;++he){for(var Oe=he*s-m,Te=Oe;Te<0;)Te+=c;for(var De=Math.min(r.inWidth,h+Oe),me=ce+he*_,P=v,F=0,V=0,ae=O;ae<D;ae+=u){for(var Y=k+ae*n.strides[1],M=K;M<ee;M+=l){for(var B=Y+M*n.strides[2],R=Te;R<De;R+=c){var X=y[B+R*n.strides[3]+T];if(i==="max"&&X>P?P=X:i==="avg"&&(F+=X,V++),isNaN(P))break}if(isNaN(P))break}if(isNaN(P))break}x[me+T]=i==="avg"?F/V:P}}}return b.toTensor()},t.prototype.avgPool3d=function(n,r){return ke(n,"avgPool3d"),this.pool3d(n,r,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(n,r,i){ke([n,r],"avgPool3dBackprop");for(var a=i.strideDepth,o=i.strideHeight,s=i.strideWidth,u=i.filterDepth,l=i.filterHeight,c=i.filterWidth,f=i.dilationDepth,d=i.dilationHeight,h=i.dilationWidth,p=i.effectiveFilterDepth,g=i.effectiveFilterHeight,m=i.effectiveFilterWidth,v=p-1-i.padInfo.front,y=m-1-i.padInfo.left,b=g-1-i.padInfo.top,x=Ot(r.shape,"float32"),w=1/(u*l*c),S=this.bufferSync(n),C=0;C<i.batchSize;++C)for(var _=0;_<i.inChannels;++_)for(var E=0;E<i.inDepth;++E)for(var A=0;A<i.inHeight;++A)for(var k=0;k<i.inWidth;++k){for(var T=E-v,I=A-b,N=k-y,O=0,D=0;D<p;D+=f){var L=(T+D)/a;if(!(L<0||L>=i.outDepth||Math.floor(L)!==L))for(var W=0;W<g;W+=d){var G=(I+W)/o;if(!(G<0||G>=i.outHeight||Math.floor(G)!==G))for(var K=0;K<m;K+=h){var ee=(N+K)/s;ee<0||ee>=i.outWidth||Math.floor(ee)!==ee||(O+=S.get(C,L,G,ee,_))}}}x.set(O*w,C,E,A,k,_)}return x.toTensor()},t.prototype.maxPool3d=function(n,r){return ke(n,"maxPool3d"),this.pool3d(n,r,"max").toFloat()},t.prototype.maxPool3dPositions=function(n,r){for(var i=Ot(r.outShape,"int32"),a=r.strideDepth,o=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterDepth,d=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=r.padInfo.front,g=r.padInfo.top,m=r.padInfo.left,v=this.bufferSync(n),y=0;y<r.batchSize;++y)for(var b=0;b<r.inChannels;++b)for(var x=0;x<r.outDepth;++x){for(var w=x*a-p,S=w;S<0;)S+=u;for(var C=Math.min(r.inDepth,f+w),_=0;_<r.outHeight;++_){for(var E=_*o-g,A=E;A<0;)A+=l;for(var k=Math.min(r.inHeight,d+E),T=0;T<r.outWidth;++T){for(var I=T*s-m,N=I;N<0;)N+=c;for(var O=Math.min(r.inWidth,h+I),D=Number.NEGATIVE_INFINITY,L=-1,W=S;W<C;W+=u)for(var G=W-w,K=A;K<k;K+=l)for(var ee=K-E,ce=N;ce<O;ce+=c){var he=ce-I,Oe=v.get(y,W,K,ce,b);Oe>=D&&(D=Oe,L=G*d*h+ee*d+he)}i.set(L,y,x,_,T,b)}}}return i.toTensor()},t.prototype.maxPool3dBackprop=function(n,r,i,a){ke([r,i],"maxPool3dBackprop");for(var o=this.maxPool3dPositions(r,a),s=a.strideDepth,u=a.strideHeight,l=a.strideWidth,c=a.dilationDepth,f=a.dilationHeight,d=a.dilationWidth,h=a.effectiveFilterDepth,p=a.effectiveFilterHeight,g=a.effectiveFilterWidth,m=h-1-a.padInfo.front,v=g-1-a.padInfo.left,y=p-1-a.padInfo.top,b=Ot(r.shape,"float32"),x=this.bufferSync(o),w=this.bufferSync(n),S=0;S<a.batchSize;++S)for(var C=0;C<a.inChannels;++C)for(var _=0;_<a.inDepth;++_)for(var E=0;E<a.inHeight;++E)for(var A=0;A<a.inWidth;++A){for(var k=_-m,T=E-y,I=A-v,N=0,O=0;O<h;O+=c){var D=(k+O)/s;if(!(D<0||D>=a.outDepth||Math.floor(D)!==D))for(var L=0;L<p;L+=f){var W=(T+L)/u;if(!(W<0||W>=a.outHeight||Math.floor(W)!==W))for(var G=0;G<g;G+=d){var K=(I+G)/l;if(!(K<0||K>=a.outWidth||Math.floor(K)!==K)){var ee=h*p*g-1-x.get(S,D,W,K,C)===O*p*g+L*g+G?1:0;ee!==0&&(N+=w.get(S,D,W,K,C)*ee)}}}}b.set(N,S,_,E,A,C)}return b.toTensor()},t.prototype.cast=function(n,r){return V3(n,r,this)},t.prototype.reshape=function(n,r){return GS(n,r)},t.prototype.avgPool=function(n,r){return ke(n,"avgPool"),ke(n,"maxPool"),BM(this.readSync(n.dataId),n.shape,n.dtype,n.strides,r,"avg").toTensor().toFloat()},t.prototype.resizeBilinear=function(n,r,i,a){ke(n,"resizeBilinear");for(var o=n.shape,s=o[0],u=o[1],l=o[2],c=o[3],f=this.readSync(n.dataId),d=new Float32Array(et([s,r,i,c])),h=[a&&r>1?u-1:u,a&&i>1?l-1:l],p=[a&&r>1?r-1:r,a&&i>1?i-1:i],g=0,m=h[0]/p[0],v=h[1]/p[1],y=0;y<s;y++)for(var b=0;b<r;b++)for(var x=m*b,w=Math.floor(x),S=x-w,C=Math.min(u-1,Math.ceil(x)),_=y*n.strides[0]+w*n.strides[1],E=y*n.strides[0]+C*n.strides[1],A=0;A<i;A++)for(var k=v*A,T=Math.floor(k),I=k-T,N=Math.min(l-1,Math.ceil(k)),O=_+T*n.strides[2],D=E+T*n.strides[2],L=_+N*n.strides[2],W=E+N*n.strides[2],G=0;G<c;G++){var K=f[O+G],ee=f[D+G],ce=K+(f[L+G]-K)*I,he=ce+(ee+(f[W+G]-ee)*I-ce)*S;d[g++]=he}return Rr(d,[s,r,i,c])},t.prototype.resizeBilinearBackprop=function(n,r,i){ke([n,r],"resizeBilinearBackprop");for(var a=r.shape,o=a[0],s=a[1],u=a[2],l=a[3],c=n.shape,f=c[1],d=c[2],h=new Float32Array(o*s*u*l),p=[i&&f>1?s-1:s,i&&d>1?u-1:u],g=[i&&f>1?f-1:f,i&&d>1?d-1:d],m=p[0]/g[0],v=p[1]/g[1],y=this.readSync(n.dataId),b=0,x=0;x<o;x++)for(var w=x*r.strides[0],S=0;S<f;S++)for(var C=S*m,_=Math.floor(C),E=Math.min(Math.ceil(C),s-1),A=w+_*r.strides[1],k=w+E*r.strides[1],T=C-_,I=1-T,N=0;N<d;N++)for(var O=N*v,D=Math.floor(O),L=Math.min(Math.ceil(O),u-1),W=O-D,G=1-W,K=A+D*r.strides[2],ee=A+L*r.strides[2],ce=k+D*r.strides[2],he=k+L*r.strides[2],Oe=I*G,Te=I*W,De=T*G,me=T*W,P=0;P<l;P++){var F=y[b++];h[K+P]+=F*Oe,h[ee+P]+=F*Te,h[ce+P]+=F*De,h[he+P]+=F*me}return If(h,[o,u,s,l],r.dtype)},t.prototype.resizeNearestNeighbor=function(n,r,i,a){ke(n,"resizeNearestNeighbor");for(var o=n.shape,s=o[0],u=o[1],l=o[2],c=o[3],f=this.readSync(n.dataId),d=new Float32Array(s*r*i*c),h=[a&&r>1?u-1:u,a&&i>1?l-1:l],p=[a&&r>1?r-1:r,a&&i>1?i-1:i],g=h[0]/p[0],m=h[1]/p[1],v=0,y=0;y<s;y++)for(var b=y*n.strides[0],x=0;x<r;x++)for(var w=g*x,S=b+Math.min(u-1,a?Math.round(w):Math.floor(w))*n.strides[1],C=0;C<i;C++)for(var _=m*C,E=S+Math.min(l-1,a?Math.round(_):Math.floor(_))*n.strides[2],A=0;A<c;A++){var k=f[E+A];d[v++]=k}return Rr(d,[s,r,i,c],n.dtype)},t.prototype.resizeNearestNeighborBackprop=function(n,r,i){ke([n,r],"resizeNearestNeighborBackprop");for(var a=r.shape,o=a[0],s=a[1],u=a[2],l=a[3],c=n.shape,f=c[1],d=c[2],h=new Float32Array(o*s*u*l),p=this.readSync(n.dataId),g=[i&&f>1?s-1:s,i&&d>1?u-1:u],m=[i&&f>1?f-1:f,i&&d>1?d-1:d],v=g[0]/m[0],y=g[1]/m[1],b=1/v,x=1/y,w=2*Math.ceil(b)+2,S=2*Math.ceil(x)+2,C=0;C<o;C++)for(var _=C*r.strides[0],E=0;E<s;E++)for(var A=_+E*r.strides[1],k=Math.floor(E*b),T=Math.floor(k-w/2),I=0;I<u;I++)for(var N=A+I*r.strides[2],O=Math.floor(I*x),D=Math.floor(O-S/2),L=0;L<l;L++){for(var W=0,G=0;G<w;G++){var K=G+T;if(!(K<0||K>=f)){var ee=_+K*n.strides[1],ce=K*v;if(E===Math.min(s-1,i?Math.round(ce):Math.floor(ce)))for(var he=0;he<S;he++){var Oe=he+D;if(!(Oe<0||Oe>=d)){var Te=ee+Oe*n.strides[2],De=Oe*y;I===Math.min(u-1,i?Math.round(De):Math.floor(De))&&(W+=p[Te+L])}}}}h[N+L]=W}return If(h,r.shape,r.dtype)},t.prototype.batchNormalization=function(n,r,i,a,o,s){ke([n,r,i,o,s],"batchNorm");for(var u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=this.readSync(i.dataId),f=o?this.readSync(o.dataId):new Float32Array([1]),d=s?this.readSync(s.dataId):new Float32Array([0]),h=new Float32Array(u.length),p=d.length,g=f.length,m=c.length,v=l.length,y=0,b=0,x=0,w=0,S=0;S<u.length;++S)h[S]=d[y++]+(u[S]-l[b++])*f[x++]/Math.sqrt(c[w++]+a),y>=p&&(y=0),b>=v&&(b=0),x>=g&&(x=0),w>=m&&(w=0);return If(h,n.shape)},t.prototype.localResponseNormalization4D=function(n,r,i,a,o){ke(n,"localResponseNormalization4D");var s=n.shape[3],u=s-1,l=this.readSync(n.dataId),c=n.size,f=new Float32Array(c);function d(m){for(var v=m%s,y=m-v+Math.max(0,v-r),b=m-v+Math.min(v+r,u),x=0;y<=b;y++){var w=l[y];x+=w*w}return x}for(var h=0;h<c;h++){var p=d(h),g=l[h]*Math.pow(i+a*p,-o);f[h]=g}return If(f,n.shape)},t.prototype.LRNGrad=function(n,r,i,a,o,s,u){ke(n,"LRNGrad");for(var l=n.shape[3],c=this.readSync(n.dataId),f=this.readSync(r.dataId),d=this.readSync(i.dataId),h=new Float32Array(n.size),p=n.size,g=0;g<p;g++){for(var m=g%l,v=g-m+Math.max(0,m-a),y=g-m+Math.min(l,m+a+1),b=0,x=v;x<y;x++)b+=Math.pow(f[x],2);for(b=s*b+o,x=v;x<y;x++){var w=-2*s*u*f[x]*d[g]/b;g===x&&(w+=Math.pow(b,-u)),w*=c[g],h[x]+=w}}return If(h,n.shape)},t.prototype.multinomial=function(n,r,i,a){ke(n,"multinomial");for(var o=r?n:Rh(n),s=o.shape[0],u=o.shape[1],l=Tn([s,i],"int32"),c=this.readSync(l.dataId),f=this.readSync(o.dataId),d=0;d<s;++d){var h=d*u,p=new Float32Array(u-1);p[0]=f[h];for(var g=1;g<p.length;++g)p[g]=p[g-1]+f[h+g];for(var m=JS(a.toString()),v=d*i,y=0;y<i;++y){var b=m();c[v+y]=p.length;for(var x=0;x<p.length;x++)if(b<p[x]){c[v+y]=x;break}}}return l},t.prototype.oneHot=function(n,r,i,a){ke(n,"oneHot");var o=new Float32Array(n.size*r);o.fill(a);for(var s=this.readSync(n.dataId),u=0;u<n.size;++u)s[u]>=0&&s[u]<r&&(o[u*r+s[u]]=i);return Uu(o,[n.size,r],"int32")},t.prototype.nonMaxSuppression=function(n,r,i,a,o){return ke(n,"nonMaxSuppression"),G3(this.readSync(n.dataId),this.readSync(r.dataId),i,a,o)},t.prototype.fft=function(n){return this.fftBatch(n,!1)},t.prototype.ifft=function(n){return this.fftBatch(n,!0)},t.prototype.fftBatch=function(n,r){for(var i=n.shape[0],a=n.shape[1],o=Ot(n.shape,"float32"),s=Ot(n.shape,"float32"),u=eo(n).as2D(i,a),l=is(n).as2D(i,a),c=0;c<i;c++)for(var f=u.slice([c,0],[1,a]),d=l.slice([c,0],[1,a]),h=ri(f,d),p=this.readSync(this.fftImpl(h,r).dataId),g=0;g<a;g++){var m=HX(p,g);o.values[c*a+g]=m.real,s.values[c*a+g]=m.imag}return ri(o.toTensor(),s.toTensor()).as2D(i,a)},t.prototype.fftImpl=function(n,r){var i=n.as1D(),a=i.size;if(this.isExponentOf2(a)){var o=this.fftRadix2(i,a,r).as2D(n.shape[0],n.shape[1]);return r&&(o=ri(eo(o).div(Ve(a)),is(o).div(Ve(a)))),o}var s=this.readSync(n.dataId),u=function(l){for(var c=new Float32Array(l.length/2),f=new Float32Array(l.length/2),d=0;d<l.length;d+=2)c[d/2]=l[d],f[d/2]=l[d+1];return{real:c,imag:f}}(this.fourierTransformByMatmul(s,a,r));return ri(u.real,u.imag).as2D(n.shape[0],n.shape[1])},t.prototype.isExponentOf2=function(n){return(n&n-1)==0},t.prototype.fftRadix2=function(n,r,i){if(r===1)return n;var a=this.readSync(n.dataId),o=r/2,s=function(v){for(var y=Math.ceil(v.length/4),b=new Float32Array(y),x=new Float32Array(y),w=0;w<v.length;w+=4)b[Math.floor(w/4)]=v[w],x[Math.floor(w/4)]=v[w+1];return{real:b,imag:x}}(a),u=ri(s.real,s.imag).as1D(),l=function(v){for(var y=Math.floor(v.length/4),b=new Float32Array(y),x=new Float32Array(y),w=2;w<v.length;w+=4)b[Math.floor(w/4)]=v[w],x[Math.floor(w/4)]=v[w+1];return{real:b,imag:x}}(a),c=ri(l.real,l.imag).as1D();u=this.fftRadix2(u,o,i),c=this.fftRadix2(c,o,i);var f=function(v,y){for(var b=new Float32Array(v/2),x=new Float32Array(v/2),w=0;w<Math.ceil(v/2);w++){var S=(y?2:-2)*Math.PI*(w/v);b[w]=Math.cos(S),x[w]=Math.sin(S)}return{real:b,imag:x}}(r,i),d=ri(f.real,f.imag).mul(c),h=u.add(d),p=u.sub(d),g=eo(h).concat(eo(p)),m=is(h).concat(is(p));return ri(g,m).as1D()},t.prototype.fourierTransformByMatmul=function(n,r,i){for(var a=new Float32Array(2*r),o=0;o<r;o++){for(var s=0,u=0,l=0;l<r;l++){var c=cMe(o*l,r,i),f=HX(n,l);s+=f.real*c.real-f.imag*c.imag,u+=f.real*c.imag+f.imag*c.real}i&&(s/=r,u/=r),lMe(a,s,u,o)}return a},t.prototype.depthToSpace=function(n,r,i){U(i==="NHWC",function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+i}),U(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});for(var a=n.shape[0],o=n.shape[1],s=n.shape[2],u=n.shape[3],l=o*r,c=s*r,f=u/(r*r),d=this.readSync(n.dataId),h=new Float32Array(a*l*c*f),p=0,g=0;g<a;++g)for(var m=0;m<l;++m)for(var v=Math.floor(m/r),y=m%r,b=0;b<c;++b)for(var x=Math.floor(b/r),w=(y*r+b%r)*f,S=0;S<f;++S){var C=S+w+u*(x+s*(v+o*g));h[p++]=d[C]}return If(h,[a,l,c,f])},t.prototype.broadcastedBinaryOp=function(n,r,i,a){var o=Qt(n.shape,r.shape),s=Ot(o,i),u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=ac(n.shape,o),f=ac(r.shape,o),d=s.values;if(c.length+f.length===0)for(var h=0;h<d.length;++h)d[h]=a(u[h%u.length],l[h%l.length]);else{var p=this.bufferSync(n),g=this.bufferSync(r),m=function(v){var y=s.indexToLoc(v),b=y.slice(-n.rank);c.forEach(function(C){return b[C]=0});var x=p.locToIndex(b),w=y.slice(-r.rank);f.forEach(function(C){return w[C]=0});var S=g.locToIndex(w);d[v]=a(u[x],l[S])};for(h=0;h<d.length;++h)m(h)}return s.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(n,r,i){var a=Qt(n.shape,r.shape),o=Ot(a,"float32"),s=Ot(a,"float32"),u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=ac(n.shape,a),f=ac(r.shape,a),d=o.values,h=s.values;if(c.length+f.length===0)for(var p=0;p<d.length;p++){var g=p%u.length,m=p%l.length,v=i(u[2*g],u[2*g+1],l[2*m],l[2*m+1]);d[p]=v.real,h[p]=v.imag}else{var y=this.bufferSync(this.data.get(n.dataId).complexTensors.real),b=this.bufferSync(this.data.get(r.dataId).complexTensors.real),x=function(w){var S=o.indexToLoc(w),C=S.slice(-n.rank);c.forEach(function(T){return C[T]=0});var _=y.locToIndex(C),E=S.slice(-r.rank);f.forEach(function(T){return E[T]=0});var A=b.locToIndex(E),k=i(u[2*_],u[2*_+1],l[2*A],l[2*A+1]);d[w]=k.real,h[w]=k.imag};for(p=0;p<d.length;p++)x(p)}return this.complex(o.toTensor(),s.toTensor())},t.prototype.split=function(n,r,i){return XX(n,r,i)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(n,r,i,a,o,s){for(var u=n.shape,l=u[0],c=u[1],f=u[2],d=u[3],h=r.shape[0],p=a[0],g=a[1],m=Ot([h,p,g,d],"float32"),v=this.readSync(r.dataId),y=this.readSync(i.dataId),b=this.readSync(n.dataId),x=n.strides,w=m.strides,S=0;S<h;S++){var C=4*S,_=v[C],E=v[C+1],A=v[C+2],k=v[C+3],T=y[S];if(!(T>=l))for(var I=p>1?(A-_)*(c-1)/(p-1):0,N=g>1?(k-E)*(f-1)/(g-1):0,O=0;O<p;O++){var D=p>1?_*(c-1)+O*I:.5*(_+A)*(c-1);if(D<0||D>c-1)for(var L=0;L<g;L++)for(var W=0;W<d;W++){var G=W+L*w[2]+O*w[1]+S*w[0];m.values[G]=s}else if(o==="bilinear"){var K=Math.floor(D),ee=Math.ceil(D),ce=D-K;for(L=0;L<g;L++)if((ae=g>1?E*(f-1)+L*N:.5*(E+k)*(f-1))<0||ae>f-1)for(W=0;W<d;W++)G=W+L*w[2]+O*w[1]+S*w[0],m.values[G]=s;else{var he=Math.floor(ae),Oe=Math.ceil(ae),Te=ae-he;for(W=0;W<d;W++){var De=b[G=W+he*x[2]+K*x[1]+T*x[0]],me=b[G=W+Oe*x[2]+K*x[1]+T*x[0]],P=b[G=W+he*x[2]+ee*x[1]+T*x[0]],F=De+(me-De)*Te,V=P+(b[G=W+Oe*x[2]+ee*x[1]+T*x[0]]-P)*Te;G=W+L*w[2]+O*w[1]+S*w[0],m.values[G]=F+(V-F)*ce}}}else for(L=0;L<g;++L){var ae;if((ae=g>1?E*(f-1)+L*N:.5*(E+k)*(f-1))<0||ae>f-1)for(W=0;W<d;W++)G=W+L*w[2]+O*w[1]+S*w[0],m.values[G]=s;else{var Y=Math.round(ae),M=Math.round(D);for(W=0;W<d;W++){var B=W+Y*x[2]+M*x[1]+T*x[0],R=W+L*w[2]+O*w[1]+S*w[0];m.values[R]=b[B]}}}}}return m.toTensor()},t.prototype.sparseToDense=function(n,r,i,a){var o=cb(0,n,i),s=o.sliceRank,u=o.numUpdates,l=o.sliceSize,c=o.strides,f=o.outputSize;return this.scatter(n,r,i,f,l,u,s,c,a,!1)},t.prototype.gatherND=function(n,r){var i=r.shape,a=i[i.length-1],o=M3(n,r),s=o[0],u=o[1],l=o[2],c=o[3];if(u===0)return Rr([],s,n.dtype);for(var f=new Sm([u,l],n.dtype),d=this.readSync(r.dataId),h=this.readSync(n.dataId),p=0;p<u;p++){for(var g=[],m=0,v=0;v<a;v++){var y=d[p*a+v];m+=y*c[v],g.push(y)}if(m<0||m>=n.size/l)throw new Error("Invalid indices: "+g+" does not index into "+n.shape);for(var b=0;b<l;b++)f.values[p*l+b]=h[m*l+b]}return f.toTensor().reshape(s)},t.prototype.scatterND=function(n,r,i){var a=cb(0,n,i),o=a.sliceRank,s=a.numUpdates,u=a.sliceSize,l=a.strides,c=a.outputSize,f=Ve(0);return this.scatter(n,r,i,c,u,s,o,l,f,!0)},t.prototype.fill=function(n,r,i){var a=Vy(i=i||wm(r),et(n));return a.fill(r),J.makeTensor(a,n,i,this)},t.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(n.shape,1,n.dtype)},t.prototype.zerosLike=function(n){var r=Vy(n.dtype,et(n.shape));return this.makeOutput(r,n.shape,n.dtype)},t.prototype.linspace=function(n,r,i){return q3(n,r,i)},t.prototype.scatter=function(n,r,i,a,o,s,u,l,c,f){var d=[a/o,o],h=this.readSync(n.dataId),p=this.readSync(r.dataId);if(a===0)return Rr([],i,r.dtype);var g=new Sm(d,r.dtype);g.values.fill(this.readSync(c.dataId)[0]);for(var m=0;m<s;m++){for(var v=[],y=0,b=0;b<u;b++){var x=h[m*u+b];v.push(x),y+=x*l[b]}if(y<0||y>=a/o)throw new Error("Invalid indices: "+v+" does not index into "+i);for(var w=0;w<o;w++)f?g.values[y*o+w]+=p[m*o+w]:g.values[y*o+w]=r.rank===0?p[0]:p[m*o+w]}return g.toTensor().reshape(i)},t}(j3);function qZ(e,t){return{kernelName:e,backendName:"cpu",kernelFunc:function(n){var r=n.inputs,i=n.backend,a=r,o=a.a,s=a.b,u=i;ke([o,s],e);var l=u.data.get(o.dataId).values,c=u.data.get(s.dataId).values,f=t(o.shape,s.shape,l,c,o.dtype),d=f[0],h=f[1];return{dataId:u.write(d,h,o.dtype),shape:h,dtype:o.dtype}}}}function HZ(e){return function(t,n,r,i,a){var o=Qt(t,n),s=o.length,u=Ja(o),l=Ih(a,et(o)),c=t.length,f=n.length,d=Ja(t),h=Ja(n),p=ac(t,o),g=ac(n,o);if(p.length+g.length===0)for(var m=0;m<l.length;++m)l[m]=e(r[m%r.length],i[m%i.length]);else{var v=function(y){var b=LF(y,s,u),x=b.slice(-c);p.forEach(function(_){return x[_]=0});var w=gS(x,c,d),S=b.slice(-f);g.forEach(function(_){return S[_]=0});var C=gS(S,f,h);l[y]=e(r[w],i[C])};for(m=0;m<l.length;++m)v(m)}return[l,o]}}J.registerBackend("cpu",function(){return new E$e},1);var C$e=HZ(function(e,t){return e/t}),A$e=qZ(ob,C$e),k$e={kernelName:"MaxPoolWithArgmax",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,i=t.x,a=n,o=a.filterSize,s=a.strides,u=a.pad,l=a.includeBatchInIndex,c=r;ke(i,"MaxPoolWithArgmax");var f=c.data.get(i.dataId).values,d=Ff(i.shape,o,s,[1,1],u),h=function(y,b,x,w,S){var C=BM(y,0,x,Ja(b),S,"max"),_=VZ(y,b,x,S,!0,w);return[C.values,_.values]}(f,i.shape,i.dtype,l,d),p=h[0],g=h[1],m=c.write(p,d.outShape,i.dtype),v=c.write(g,d.outShape,i.dtype);return[{dataId:m,shape:d.outShape,dtype:i.dtype},{dataId:v,shape:d.outShape,dtype:"int32"}]}},T$e={kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t,a=i.boxes,o=i.scores,s=r,u=s.maxOutputSize,l=s.iouThreshold,c=s.scoreThreshold,f=s.softNmsSigma,d=n;ke(a,"NonMaxSuppressionWithScore");var h=K3(d.data.get(a.dataId).values,d.data.get(o.dataId).values,u,l,c,f);return[h.selectedIndices,h.selectedScores]}},O$e={kernelName:"Square",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,i=n;ke(r,"square");for(var a=i.data.get(r.dataId).values,o=new Float32Array(a.length),s=0;s<a.length;++s){var u=a[s];o[s]=u*u}return{dataId:i.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},I$e=HZ(function(e,t){var n=e-t;return n*n});function GZ(e,t,n,r,i){for(var a=et(t),o=t.length,s=Ja(t),u=Ja(i),l=Ih(n,et(i)),c=0;c<a;++c){for(var f=LF(c,o,s),d=new Array(f.length),h=0;h<d.length;h++)d[h]=f[r[h]];l[gS(d,o,u)]=e[c]}return l}for(var jM=0,KZ=[T$e,O$e,qZ(sb,I$e),A$e,{kernelName:"Transpose",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,i=t.x,a=n.perm,o=r;ke(i,"transpose");for(var s=i.shape.length,u=new Array(s),l=0;l<u.length;l++)u[l]=i.shape[a[l]];var c=GZ(o.data.get(i.dataId).values,i.shape,i.dtype,a,u);return{dataId:o.write(c,u,i.dtype),shape:u,dtype:i.dtype}}},k$e];jM<KZ.length;jM++)OF(KZ[jM]);for(var zm,N$e=function(e){this.variableNames=["A"];var t=Ki(),n=e[0],r=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+r+".0, "+n+`.0);

        vec4 values = `+t.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},D$e=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=Ki(),n=e[0],r=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+r+".0, "+n+`.0);
            vec4 values = `+t.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+t.output+` = result;
      }
    `},R$e=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];this.outputShape=n,this.rank=n.length;var i=Zn(this.rank),a=function(o){var s=o.length;if(s>6)throw Error("Transpose for rank "+s+" is not yet supported");for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],l=new Array(s),c=0;c<o.length;c++)l[o[c]]=u[c];return l.join()}(t);this.userCode=`
    void main() {
      `+i+` resRC = getOutputCoords();
      setOutput(getA(`+a+`));
    }
    `},F$e=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var i=Zn(this.rank),a=JX("rc",this.rank),o=new Array(this.rank);for(r=0;r<t.length;r++)o[t[r]]=a[r];var s="vec2("+o.slice(-2).join()+")",u="++"+a[this.rank-1]+" < "+n[this.rank-1],l="getChannel(getA("+o.join()+"), "+s+")";this.userCode=`
    void main() {
      `+i+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+l+`;
      if(`+u+`) {
        result[1] = `+l+`;
      }
      --`+a[this.rank-1]+`;
      if(++`+a[this.rank-2]+" < "+n[this.rank-2]+`) {
        result[2] = `+l+`;
        if(`+u+`) {
          result[3] = `+l+`;
        }
      }
      setOutput(result);
    }
    `},UM=0,XZ=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.pixels,a=r.numChannels,o=typeof HTMLVideoElement!="undefined"&&i instanceof HTMLVideoElement,s=typeof HTMLImageElement!="undefined"&&i instanceof HTMLImageElement,u=o?[i.videoWidth,i.videoHeight]:[i.width,i.height],l=u[0],c=u[1],f=[c,l],d=[c,l,a];(s||o)&&(zm==null&&(zm=document.createElement("canvas").getContext("2d")),zm.canvas.width=l,zm.canvas.height=c,zm.drawImage(i,0,0,l,c),i=zm.canvas);var h=n.makeTensorInfo(f,"int32");n.texData.get(h.dataId).usage=To.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),i);var p=pe().getBool("WEBGL_PACK")?new D$e(d):new N$e(d),g=n.runWebGLProgram(p,[h],"int32");return n.disposeData(h.dataId),g}},{kernelName:ob,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t;return function(i,a,o){var s=new Ar(IMe,i.shape,a.shape);return pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&(s=new qu(NMe,i.shape,a.shape,!0)),o.runWebGLProgram(s,[i,a],"float32")}(r.a,r.b,n)}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;AS("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var i=t,a=i.boxes,o=i.scores,s=r,u=s.maxOutputSize,l=s.iouThreshold,c=s.scoreThreshold,f=s.softNmsSigma,d=n,h=K3(d.readSync(a.dataId),d.readSync(o.dataId),u,l,c,f);return[h.selectedIndices,h.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,i=n,a=new Pt(r.shape,"return x * x;");return i.runWebGLProgram(a,[r],r.dtype)}},{kernelName:sb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,i=r.a,a=r.b,o=n,s=pe().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new qu("return (a - b) * (a - b);",i.shape,a.shape):new Ar("return (a - b) * (a - b);",i.shape,a.shape);return o.compileAndRun(s,[i,a])}},{kernelName:"Transpose",backendName:"webgl",kernelFunc:function(e){for(var t,n=e.inputs,r=e.attrs,i=e.backend,a=n.x,o=r.perm,s=i,u=a.shape.length,l=new Array(u),c=0;c<l.length;c++)l[c]=a.shape[o[c]];if(s.shouldExecuteOnCPU([a])){var f=GZ(s.texData.get(a.dataId).values,a.shape,a.dtype,o,l);t=s.makeTensorInfo(l,a.dtype),s.texData.get(t.dataId).values=f}else t=function(d,h,p){var g=pe().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new F$e(d.shape,h):new R$e(d.shape,h);return p.runWebGLProgram(g,[d],d.dtype)}(a,o,s);return t}},{kernelName:"MaxPoolWithArgmax",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,i=t.x,a=n,o=a.filterSize,s=a.strides,u=a.pad,l=a.includeBatchInIndex,c=r;U(i.shape.length===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+i.shape.length+"."});var f=[1,1];U(Gi(s,f),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+s+" and dilations '"+f+"'"});var d=Ff(i.shape,o,s,f,u),h=function(p,g,m,v){var y=new mb(m,"max",!1),b=v.runWebGLProgram(y,[p],"float32");return y=new mb(m,"max",!0,!0,g),[b,v.runWebGLProgram(y,[p],"float32")]}(i,l,d,c);return[h[0],h[1]]}}];UM<XZ.length;UM++)OF(XZ[UM]);for(var WM=0,YZ=[{kernelName:u3,inputsToSave:["a","b"],gradFunc:function(e,t){var n=t[0],r=t[1],i=Qt(n.shape,r.shape);return{a:function(){var a=e,o=Vr(n.shape,i);return o.length>0&&(a=a.sum(o)),a.reshape(n.shape)},b:function(){var a=e,o=Vr(r.shape,i);return o.length>0&&(a=a.sum(o)),a.reshape(r.shape)}}}},{kernelName:"AddN",saveAllInputs:!0,gradFunc:function(e,t){var n={};return t.forEach(function(r,i){n[i]=function(){return e.clone()}}),n}},{kernelName:l3,gradFunc:function(e,t,n){for(var r=n,i=r.inputShape,a=r.shape,o=Array.from(a),s=i.length-1;s>=0;s--)if(i[s]===a[s])o[s]=1;else if(i[s]!==1)throw new Error("broadcastTo(): ["+i+"] cannot be broadcast to ["+a+"].");var u=[];for(s=0;s<o.length;s++)o[s]>1&&u.push(s);return{x:function(){return e.sum(u,!0)}}}},{kernelName:ob,inputsToSave:["a","b"],gradFunc:function(e,t){var n=t[0],r=t[1],i=Qt(n.shape,r.shape);return{a:function(){var a=Cr(e,r.toFloat()),o=Vr(n.shape,i);return o.length>0?qr(a,o).reshape(n.shape):a},b:function(){var a=e.mul(n.toFloat()),o=Vr(r.shape,i);o.length>0&&(a=qr(a,o).reshape(r.shape));var s=aE(r);return Rf(Cr(a,s.toFloat()))}}}},{kernelName:"FusedBatchNorm",inputsToSave:["x","mean","variance","scale"],gradFunc:function(e,t,n){var r=n.varianceEpsilon,i=t[0],a=t[1],o=t[2],s=t[3],u=VY(i),l=s??Ve(1),c=Vr(a.shape,u.shape),f=[];if(a.rank===1){for(var d=0;d<u.shape.length-1;++d)f.push(u.shape[d]);f.push(1)}var h=Er(i,a),p=rt(e,l),g=PS(Wt(o,Ve(r))),m=rt(rt(rt(g,g),g),Ve(-.5));return{x:function(){return a.rank===1?Ws(rt(rt(e,sc(g.as4D(1,1,1,a.shape[0]),f)),l),i.shape):Ws(rt(rt(e,g),l),i.shape)},mean:function(){var v=rt(rt(g,Ve(-1)),p);return a.rank===1&&(v=qr(v,c)),Ws(v,a.shape)},variance:function(){var v=rt(rt(m,h),p);return a.rank===1&&(v=qr(v,c)),Ws(v,a.shape)},scale:function(){var v=rt(h,g),y=rt(e,v);return a.rank===1&&(y=qr(y,c)),Ws(y,a.shape)},offset:function(){var v=e;return a.rank===1&&(v=qr(v,c)),Ws(v,a.shape)}}}},{kernelName:f3,gradFunc:function(e){return{x:function(){return e.toFloat()}}}},{kernelName:c3,inputsToSave:["indices"],gradFunc:function(e,t){var n=t[0];return{indices:function(){return Tn(n.shape,"float32")}}}},{kernelName:h3,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],i=n.paddings.map(function(a){return a[0]});return{x:function(){return e.slice(i,r.shape)}}}},{kernelName:"Square",inputsToSave:["x"],gradFunc:function(e,t){var n=t[0];return{x:function(){return e.mul(n.toFloat().mul(2))}}}},{kernelName:sb,inputsToSave:["a","b"],gradFunc:function(e,t){var n=t[0],r=t[1],i=Ve(2);return{a:function(){return rt(e,rt(i,Er(n,r)))},b:function(){return rt(e,rt(i,Er(r,n)))}}}},{kernelName:d3,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],i=n.reps;return{x:function(){var a=en(r);if(r.rank===1)for(var o=0;o<i[0];++o)a=a.add(e.slice([o*r.shape[0]],[r.shape[0]]));else if(r.rank===2)for(o=0;o<i[0];++o)for(var s=0;s<i[1];++s)a=a.add(e.slice([o*r.shape[0],s*r.shape[1]],[r.shape[0],r.shape[1]]));else if(r.rank===3)for(o=0;o<i[0];++o)for(s=0;s<i[1];++s)for(var u=0;u<i[2];++u)a=a.add(e.slice([o*r.shape[0],s*r.shape[1],u*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(r.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+r.rank+" tensors yet.");for(o=0;o<i[0];++o)for(s=0;s<i[1];++s)for(u=0;u<i[2];++u)for(var l=0;l<i[3];++l)a=a.add(e.slice([o*r.shape[0],s*r.shape[1],u*r.shape[2],l*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return a}}}},{kernelName:"Transpose",gradFunc:function(e,t,n){var r=kS(n.perm);return{x:function(){return cn(e,r)}}}}];WM<YZ.length;WM++)TK(YZ[WM]);var M$e=function(){function e(){}return e.prototype.fetch=function(t,n){return fetch(t,n)},e.prototype.now=function(){return performance.now()},e.prototype.encode=function(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+n);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},e.prototype.decode=function(t,n){return new TextDecoder(n).decode(t)},e}();pe().get("IS_BROWSER")&&pe().setPlatform("browser",new M$e);var VM,P$e=function(){return require("node-fetch")},$$e=function(){function e(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return e.prototype.fetch=function(t,n){return pe().global.fetch!=null?pe().global.fetch(t,n):(VM==null&&(VM=P$e()),VM(t,n))},e.prototype.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6},e.prototype.encode=function(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+n);return this.textEncoder.encode(t)},e.prototype.decode=function(t,n){return t.length===0?"":new this.util.TextDecoder(n).decode(t)},e}();pe().get("IS_NODE")&&pe().setPlatform("node",new $$e);var qM={float32:4,int32:4,uint16:2,uint8:1,bool:1},AE=4;function ZZ(e,t){for(var n={},r=0,i=function(s){var u=s.name,l=s.dtype,c=s.shape,f=et(c),d=void 0;if("quantization"in s){var h=s.quantization;if(h.dtype!=="uint8"&&h.dtype!=="uint16")throw new Error("Weight "+s.name+" has unknown quantization dtype "+h.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var p=qM[h.dtype],g=e.slice(r,r+f*p),m=h.dtype==="uint8"?new Uint8Array(g):new Uint16Array(g);if(l==="float32")d=Float32Array.from(m,function(S){return S*h.scale+h.min});else{if(l!=="int32")throw new Error("Unsupported dtype in weight '"+u+"': "+l);d=Int32Array.from(m,function(S){return Math.round(S*h.scale+h.min)})}r+=f*p}else if(l==="string"){var v=et(s.shape);d=[];for(var y=0;y<v;y++){var b=new Uint32Array(e.slice(r,r+AE))[0];r+=AE;var x=new Uint8Array(e.slice(r,r+b));d.push(x),r+=b}}else{var w=qM[l];if(g=e.slice(r,r+f*w),l==="float32")d=new Float32Array(g);else if(l==="int32")d=new Int32Array(g);else{if(l!=="bool")throw new Error("Unsupported dtype in weight '"+u+"': "+l);d=new Uint8Array(g)}r+=f*w}n[u]=Rr(d,c,l)},a=0,o=t;a<o.length;a++)i(o[a]);return n}function L$e(e){if(e===null)throw new Error("Invalid input value: "+JSON.stringify(e));var t=0,n=[];e.forEach(function(a){if(t+=a.byteLength,n.push(a.byteLength===a.buffer.byteLength?a:new a.constructor(a)),!(a instanceof Float32Array||a instanceof Int32Array||a instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+a.constructor.name)});var r=new Uint8Array(t),i=0;return n.forEach(function(a){r.set(new Uint8Array(a.buffer),i),i+=a.byteLength}),r.buffer}var HM=typeof Buffer!="undefined"&&(typeof Blob=="undefined"||typeof atob=="undefined"||typeof btoa=="undefined");function JZ(e){return HM?Buffer.byteLength(e):new Blob([e]).size}function GM(e){var t=0;e.forEach(function(i){t+=i.byteLength});var n=new Uint8Array(t),r=0;return e.forEach(function(i){n.set(new Uint8Array(i),r),r+=i.byteLength}),n.buffer}function QZ(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function Tb(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:e.modelTopology==null?0:JZ(JSON.stringify(e.modelTopology)),weightSpecsBytes:e.weightSpecs==null?0:JZ(JSON.stringify(e.weightSpecs)),weightDataBytes:e.weightData==null?0:e.weightData.byteLength}}var Fo=function(){function e(){this.saveRouters=[],this.loadRouters=[]}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerSaveRouter=function(t){e.getInstance().saveRouters.push(t)},e.registerLoadRouter=function(t){e.getInstance().loadRouters.push(t)},e.getSaveHandlers=function(t){return e.getHandlers(t,"save")},e.getLoadHandlers=function(t,n){return e.getHandlers(t,"load",n)},e.getHandlers=function(t,n,r){var i=[];return(n==="load"?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach(function(a){var o=a(t,r);o!==null&&i.push(o)}),i},e}(),jm="://",zf=function(){function e(){this.managers={}}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerManager=function(t,n){U(t!=null,function(){return"scheme must not be undefined or null."}),t.endsWith(jm)&&(t=t.slice(0,t.indexOf(jm))),U(t.length>0,function(){return"scheme must not be an empty string."});var r=e.getInstance();U(r.managers[t]==null,function(){return"A model store manager is already registered for scheme '"+t+"'."}),r.managers[t]=n},e.getManager=function(t){var n=this.getInstance().managers[t];if(n==null)throw new Error("Cannot find model manager for scheme '"+t+"'");return n},e.getSchemes=function(){return Object.keys(this.getInstance().managers)},e}();function kE(e){if(e.indexOf(jm)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+zf.getSchemes().join(","));return{scheme:e.split(jm)[0],path:e.split(jm)[1]}}function eJ(e,t,n){return n===void 0&&(n=!1),tt(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f;return nt(this,function(d){switch(d.label){case 0:return U(e!==t,function(){return"Old path and new path are the same: '"+e+"'"}),U((r=Fo.getLoadHandlers(e)).length>0,function(){return"Copying failed because no load handler is found for source URL "+e+"."}),U(r.length<2,function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+e+"."}),i=r[0],U((a=Fo.getSaveHandlers(t)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+t+"."}),U(a.length<2,function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+t+"."}),o=a[0],s=kE(e).scheme,u=kE(e).path,l=s===kE(e).scheme,[4,i.load()];case 1:return c=d.sent(),n&&l?[4,zf.getManager(s).removeModel(u)]:[3,3];case 2:d.sent(),d.label=3;case 3:return[4,o.save(c)];case 4:return f=d.sent(),!n||l?[3,6]:[4,zf.getManager(s).removeModel(u)];case 5:d.sent(),d.label=6;case 6:return[2,f.modelArtifactsInfo]}})})}var Vh="models_store",jf="model_info_store";function tJ(){if(!pe().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e=window||self,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function KM(e){var t=e.result;t.createObjectStore(Vh,{keyPath:"modelPath"}),t.createObjectStore(jf,{keyPath:"modelPath"})}var Um=function(){function e(t){if(this.indexedDB=tJ(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return e.prototype.save=function(t){return tt(this,void 0,void 0,function(){return nt(this,function(n){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]})})},e.prototype.load=function(){return tt(this,void 0,void 0,function(){return nt(this,function(t){return[2,this.databaseAction(this.modelPath)]})})},e.prototype.databaseAction=function(t,n){var r=this;return new Promise(function(i,a){var o=r.indexedDB.open("tensorflowjs",1);o.onupgradeneeded=function(){return KM(o)},o.onsuccess=function(){var s=o.result;if(n==null){var u=s.transaction(Vh,"readonly"),l=u.objectStore(Vh).get(r.modelPath);l.onsuccess=function(){if(l.result==null)return s.close(),a(new Error("Cannot find model with path '"+r.modelPath+"' in IndexedDB."));i(l.result.modelArtifacts)},l.onerror=function(g){return s.close(),a(l.error)},u.oncomplete=function(){return s.close()}}else{var c,f=Tb(n),d=s.transaction(jf,"readwrite"),h=d.objectStore(jf),p=h.put({modelPath:r.modelPath,modelArtifactsInfo:f});p.onsuccess=function(){var g=(c=s.transaction(Vh,"readwrite")).objectStore(Vh).put({modelPath:r.modelPath,modelArtifacts:n,modelArtifactsInfo:f});g.onsuccess=function(){return i({modelArtifactsInfo:f})},g.onerror=function(m){var v=(h=d.objectStore(jf)).delete(r.modelPath);v.onsuccess=function(){return s.close(),a(g.error)},v.onerror=function(y){return s.close(),a(g.error)}}},p.onerror=function(g){return s.close(),a(p.error)},d.oncomplete=function(){c==null?s.close():c.oncomplete=function(){return s.close()}}}},o.onerror=function(s){return a(o.error)}})},e.URL_SCHEME="indexeddb://",e}(),nJ=function(e){return pe().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Um.URL_SCHEME)?(t=e.slice(Um.URL_SCHEME.length),new Um(t)):null;var t};Fo.registerSaveRouter(nJ),Fo.registerLoadRouter(nJ);var B$e=function(){function e(){this.indexedDB=tJ()}return e.prototype.listModels=function(){return tt(this,void 0,void 0,function(){var t=this;return nt(this,function(n){return[2,new Promise(function(r,i){var a=t.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return KM(a)},a.onsuccess=function(){var o=a.result,s=o.transaction(jf,"readonly"),u=s.objectStore(jf).getAll();u.onsuccess=function(){for(var l={},c=0,f=u.result;c<f.length;c++){var d=f[c];l[d.modelPath]=d.modelArtifactsInfo}r(l)},u.onerror=function(l){return o.close(),i(u.error)},s.oncomplete=function(){return o.close()}},a.onerror=function(o){return i(a.error)}})]})})},e.prototype.removeModel=function(t){return tt(this,void 0,void 0,function(){var n=this;return nt(this,function(r){var i;return t=(i=t).startsWith(Um.URL_SCHEME)?i.slice(Um.URL_SCHEME.length):i,[2,new Promise(function(a,o){var s=n.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return KM(s)},s.onsuccess=function(){var u,l=s.result,c=l.transaction(jf,"readwrite"),f=c.objectStore(jf),d=f.get(t);d.onsuccess=function(){if(d.result==null)return l.close(),o(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var h=f.delete(t),p=function(){var g=(u=l.transaction(Vh,"readwrite")).objectStore(Vh).delete(t);g.onsuccess=function(){return a(d.result.modelArtifactsInfo)},g.onerror=function(m){return o(d.error)}};h.onsuccess=p,h.onerror=function(g){return p(),l.close(),o(d.error)}},d.onerror=function(h){return l.close(),o(d.error)},c.oncomplete=function(){u==null?l.close():u.oncomplete=function(){return l.close()}}},s.onerror=function(u){return o(s.error)}})]})})},e}();if(pe().getBool("IS_BROWSER"))try{zf.registerManager(Um.URL_SCHEME,new B$e)}catch(e){}var lc="/",Wm="tensorflowjs_models",rJ="info",z$e="model_topology",j$e="weight_specs",U$e="weight_data",W$e="model_metadata";function iJ(e){return{info:[Wm,e,rJ].join(lc),topology:[Wm,e,z$e].join(lc),weightSpecs:[Wm,e,j$e].join(lc),weightData:[Wm,e,U$e].join(lc),modelMetadata:[Wm,e,W$e].join(lc)}}function V$e(e){var t=e.split(lc);if(t.length<3)throw new Error("Invalid key format: "+e);return t.slice(1,t.length-1).join(lc)}var Vm=function(){function e(t){if(!pe().getBool("IS_BROWSER")||typeof window=="undefined"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=iJ(this.modelPath)}return e.prototype.save=function(t){return tt(this,void 0,void 0,function(){var n,r,i;return nt(this,function(a){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),i=Tb(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(i)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(o){if(HM)return Buffer.from(o).toString("base64");for(var s=new Uint8Array(o),u="",l=0,c=s.length;l<c;l++)u+=String.fromCharCode(s[l]);return btoa(u)}(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),[2,{modelArtifactsInfo:i}]}catch(o){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+i.modelTopologyBytes+", weightSpecsBytes="+i.weightSpecsBytes+", weightDataBytes="+i.weightDataBytes+".")}return[2]})})},e.prototype.load=function(){return tt(this,void 0,void 0,function(){var t,n,r,i,a,o,s;return nt(this,function(u){if((t=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(n={},(r=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(n.modelTopology=r,(i=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(n.weightSpecs=i,(a=this.LS.getItem(this.keys.modelMetadata))!=null&&(o=JSON.parse(a),n.format=o.format,n.generatedBy=o.generatedBy,n.convertedBy=o.convertedBy,n.userDefinedMetadata=o.userDefinedMetadata),(s=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return n.weightData=function(l){if(HM){var c=Buffer.from(l,"base64");return c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength)}for(var f=atob(l),d=new Uint8Array(f.length),h=0;h<f.length;++h)d.set([f.charCodeAt(h)],h);return d.buffer}(s),[2,n]})})},e.URL_SCHEME="localstorage://",e}(),aJ=function(e){return pe().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Vm.URL_SCHEME)?(t=e.slice(Vm.URL_SCHEME.length),new Vm(t)):null;var t};Fo.registerSaveRouter(aJ),Fo.registerLoadRouter(aJ);var q$e=function(){function e(){U(pe().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),U(typeof window=="undefined"||window.localStorage!==void 0,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return e.prototype.listModels=function(){return tt(this,void 0,void 0,function(){var t,n,r,i,a,o;return nt(this,function(s){for(t={},n=Wm+lc,r=lc+rJ,i=0;i<this.LS.length;++i)(a=this.LS.key(i)).startsWith(n)&&a.endsWith(r)&&(o=V$e(a),t[o]=JSON.parse(this.LS.getItem(a)));return[2,t]})})},e.prototype.removeModel=function(t){return tt(this,void 0,void 0,function(){var n,r;return nt(this,function(i){var a;if(t=(a=t).startsWith(Vm.URL_SCHEME)?a.slice(Vm.URL_SCHEME.length):a,n=iJ(t),this.LS.getItem(n.info)==null)throw new Error("Cannot find model at path '"+t+"'");return r=JSON.parse(this.LS.getItem(n.info)),this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),[2,r]})})},e}();if(pe().getBool("IS_BROWSER"))try{zf.registerManager(Vm.URL_SCHEME,new q$e)}catch(e){}var H$e="model",G$e=".json",K$e=".weights.bin";function oJ(e){return new Promise(function(t){return setTimeout(t)}).then(e)}var XM=function(){function e(t){if(!pe().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),t!=null&&t.length!==0||(t=H$e),this.modelTopologyFileName=t+G$e,this.weightDataFileName=t+K$e}return e.prototype.save=function(t){return tt(this,void 0,void 0,function(){var n,r,i,a,o,s;return nt(this,function(u){switch(u.label){case 0:if(typeof document=="undefined")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(n=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],i={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:r},a=window.URL.createObjectURL(new Blob([JSON.stringify(i)],{type:"application/json"})),(o=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,o.href=a,[4,oJ(function(){return o.dispatchEvent(new MouseEvent("click"))})];case 2:return u.sent(),t.weightData==null?[3,4]:((s=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,s.href=n,[4,oJ(function(){return s.dispatchEvent(new MouseEvent("click"))})]);case 3:u.sent(),u.label=4;case 4:return[2,{modelArtifactsInfo:Tb(t)}]}})})},e.URL_SCHEME="downloads://",e}(),X$e=function(){function e(t){if(t==null||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return e.prototype.load=function(){return tt(this,void 0,void 0,function(){var t,n,r=this;return nt(this,function(i){return t=this.files[0],n=this.files.slice(1),[2,new Promise(function(a,o){var s=new FileReader;s.onload=function(u){var l=JSON.parse(u.target.result),c=l.modelTopology;if(c!=null){n.length===0&&a({modelTopology:c});var f=l.weightsManifest;if(f!=null){var d;try{d=r.checkManifestAndWeightFiles(f,n)}catch(m){return void o(m)}var h=[],p=[],g=[];f.forEach(function(m){m.paths.forEach(function(v){p.push(v),g.push(null)}),h.push.apply(h,m.weights)}),f.forEach(function(m){m.paths.forEach(function(v){var y=new FileReader;y.onload=function(b){var x=b.target.result,w=p.indexOf(v);g[w]=x,g.indexOf(null)===-1&&a({modelTopology:c,weightSpecs:h,weightData:GM(g),format:l.format,generatedBy:l.generatedBy,convertedBy:l.convertedBy,userDefinedMetadata:l.userDefinedMetadata})},y.onerror=function(b){return o("Failed to weights data from file of path '"+v+"'.")},y.readAsArrayBuffer(d[v])})})}else o(new Error("weightManifest field is missing from file "+t.name))}else o(new Error("modelTopology field is missing from file "+t.name))},s.onerror=function(u){return o("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},s.readAsText(t)})]})})},e.prototype.checkManifestAndWeightFiles=function(t,n){for(var r=[],i=n.map(function(u){return QZ(u.name)}),a={},o=0,s=t;o<s.length;o++)s[o].paths.forEach(function(u){var l=QZ(u);if(r.indexOf(l)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+l+"'");if(r.push(l),i.indexOf(l)===-1)throw new Error("Weight file with basename '"+l+"' is not provided.");a[u]=n[i.indexOf(l)]});if(r.length!==n.length)throw new Error("Mismatch in the number of files in weights manifest ("+r.length+") and the number of weight files provided ("+n.length+").");return a},e}();function sJ(e,t,n,r){(function(a){U(a!=null&&Array.isArray(a)&&a.length>0,function(){return"promises must be a none empty array"})})(e),function(a,o){U(a>=0&&a<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+a}),U(o>=0&&o<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+o}),U(o>=a,function(){return"startFraction must be no more than endFraction, but got startFraction "+a+" and endFraction "+o})}(n=n??0,r=r??1);var i=0;return Promise.all(e.map(function(a){return a.then(function(o){var s=n+ ++i/e.length*(r-n);return t(s),o}),a}))}function uJ(e,t){return tt(this,void 0,void 0,function(){var n,r,i,a,o,s,u,l,c;return nt(this,function(f){switch(f.label){case 0:return t==null&&(t={}),n=t.fetchFunc==null?pe().platform.fetch:t.fetchFunc,r=e.map(function(d){return n(d,t.requestInit,{isBinary:!0})}),i=0,a=.5,t.onProgress!=null?[3,2]:[4,Promise.all(r)];case 1:return o=f.sent(),[3,4];case 2:return[4,sJ(r,t.onProgress,i,a)];case 3:o=f.sent(),f.label=4;case 4:return s=o.map(function(d){return d.arrayBuffer()}),u=.5,l=1,t.onProgress!=null?[3,6]:[4,Promise.all(s)];case 5:return c=f.sent(),[3,8];case 6:return[4,sJ(s,t.onProgress,u,l)];case 7:c=f.sent(),f.label=8;case 8:return[2,c]}})})}function lJ(e){var t=this;return function(n,r,i){return r===void 0&&(r=""),tt(t,void 0,void 0,function(){var a,o,s,u,l,c,f,d,h,p;return nt(this,function(g){switch(g.label){case 0:if(a=n.map(function(){return!1}),o={},s=i!=null?i.map(function(){return!1}):[],u=[],n.forEach(function(m,v){var y=0;m.weights.forEach(function(b){var x="quantization"in b?b.quantization.dtype:b.dtype,w=qM[x]*et(b.shape),S=function(){a[v]=!0,o[v]==null&&(o[v]=[]),o[v].push({manifestEntry:b,groupOffset:y,sizeBytes:w})};i!=null?i.forEach(function(C,_){C===b.name&&(S(),s[_]=!0)}):S(),u.push(b.name),y+=w})}),!s.every(function(m){return m}))throw l=i.filter(function(m,v){return!s[v]}),new Error("Could not find weights in manifest with names: "+l.join(", ")+`. 
Manifest JSON has weights with names: `+u.join(", ")+".");return c=a.reduce(function(m,v,y){return v&&m.push(y),m},[]),f=[],c.forEach(function(m){n[m].paths.forEach(function(v){var y=r+(r.endsWith("/")?"":"/")+v;f.push(y)})}),[4,e(f)];case 1:return d=g.sent(),h={},p=0,c.forEach(function(m){for(var v=n[m].paths.length,y=0,b=0;b<v;b++)y+=d[p+b].byteLength;for(var x=new ArrayBuffer(y),w=new Uint8Array(x),S=0,C=0;C<v;C++){var _=new Uint8Array(d[p+C]);w.set(_,S),S+=_.byteLength}o[m].forEach(function(E){var A=ZZ(x.slice(E.groupOffset,E.groupOffset+E.sizeBytes),[E.manifestEntry]);for(var k in A)h[k]=A[k]}),p+=v}),[2,h]}})})}}Fo.registerSaveRouter(function(e){return pe().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(XM.URL_SCHEME)?function(t){return t===void 0&&(t="model"),new XM(t)}(e.slice(XM.URL_SCHEME.length)):null});var cJ=function(){function e(t,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,n.fetchFunc!=null?(U(typeof n.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=n.fetchFunc):this.fetch=pe().platform.fetch,U(t!=null&&t.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(t)&&U(t.length===2,function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."}),this.path=t,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return e.prototype.save=function(t){return tt(this,void 0,void 0,function(){var n,r,i,a;return nt(this,function(o){switch(o.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],i={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:r},n.body.append("model.json",new Blob([JSON.stringify(i)],{type:"application/json"}),"model.json"),t.weightData!=null&&n.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,n)];case 1:if((a=o.sent()).ok)return[2,{modelArtifactsInfo:Tb(t),responses:[a]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+a.status+".")}})})},e.prototype.load=function(){return tt(this,void 0,void 0,function(){var t,n,r,i,a,o,s,u,l,c,f,d;return nt(this,function(h){switch(h.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=h.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");h.label=2;case 2:return h.trys.push([2,4,,5]),[4,t.json()];case 3:return n=h.sent(),[3,5];case 4:throw h.sent(),r="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 5:if(i=n.modelTopology,a=n.weightsManifest,o=n.generatedBy,s=n.convertedBy,u=n.format,l=n.userDefinedMetadata,i==null&&a==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return a==null?[3,7]:[4,this.loadWeights(a)];case 6:d=h.sent(),c=d[0],f=d[1],h.label=7;case 7:return[2,{modelTopology:i,weightSpecs:c,weightData:f,userDefinedMetadata:l,generatedBy:o,convertedBy:s,format:u}]}})})},e.prototype.loadWeights=function(t){return tt(this,void 0,void 0,function(){var n,r,i,a,o,s,u,l,c,f,d;return nt(this,function(h){switch(h.label){case 0:for(n=Array.isArray(this.path)?this.path[1]:this.path,r=function(p){var g=p.lastIndexOf("/"),m=p.lastIndexOf("?"),v=p.substring(0,g),y=m>g?p.substring(m):"";return[v+"/",y]}(n),i=r[0],a=r[1],o=this.weightPathPrefix||i,s=[],u=0,l=t;u<l.length;u++)c=l[u],s.push.apply(s,c.weights);return f=[],t.forEach(function(p){p.paths.forEach(function(g){f.push(o+g+a)})}),[4,uJ(f,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return d=h.sent(),[2,[s,GM(d)]]}})})},e.URL_SCHEME_REGEX=/^https?:\/\//,e}();function YM(e){return e.match(cJ.URL_SCHEME_REGEX)!=null}var fJ=function(e,t){return typeof fetch=="undefined"?null:(Array.isArray(e)?e.every(function(n){return YM(n)}):YM(e))?ZM(e,{onProgress:t}):null};function ZM(e,t){return new cJ(e,t)}Fo.registerSaveRouter(fJ),Fo.registerLoadRouter(fJ);var JM=function(){function e(t){this.modelArtifacts=t}return e.prototype.load=function(){return tt(this,void 0,void 0,function(){return nt(this,function(t){return[2,this.modelArtifacts]})})},e}(),Y$e=function(){function e(t){this.saveHandler=t}return e.prototype.save=function(t){return tt(this,void 0,void 0,function(){return nt(this,function(n){return[2,this.saveHandler(t)]})})},e}(),wa=Object.freeze({browserFiles:function(e){return new X$e(e)},browserHTTPRequest:function(e,t){return ZM(e,t)},concatenateArrayBuffers:GM,decodeWeights:ZZ,encodeWeights:function(e,t){return tt(this,void 0,void 0,function(){var n,r,i,a,o,s=this;return nt(this,function(u){switch(u.label){case 0:for(n=[],r=[],i=Array.isArray(e)?e.map(function(l){return l.name}):Object.keys(e),a=function(l){var c=i[l],f=Array.isArray(e)?e[l].tensor:e[c];if(f.dtype!=="float32"&&f.dtype!=="int32"&&f.dtype!=="bool"&&f.dtype!=="string")throw new Error("Unsupported dtype in weight '"+c+"': "+f.dtype);var d={name:c,shape:f.shape,dtype:f.dtype};if(f.dtype==="string"){var h=new Promise(function(p){return tt(s,void 0,void 0,function(){var g,m,v,y,b,x,w;return nt(this,function(S){switch(S.label){case 0:return[4,f.bytes()];case 1:for(g=S.sent(),m=g.reduce(function(C,_){return C+_.length},0)+AE*g.length,v=new Uint8Array(m),y=0,b=0;b<g.length;b++)x=g[b],w=new Uint8Array(new Uint32Array([x.length]).buffer),v.set(w,y),y+=AE,v.set(x,y),y+=x.length;return p(v),[2]}})})});r.push(h)}else r.push(f.data());t!=null&&(d.group=t),n.push(d)},o=0;o<i.length;++o)a(o);return[4,Promise.all(r)];case 1:return[2,{data:L$e(u.sent()),specs:n}]}})})},fromMemory:function(e,t,n,r){return arguments.length===1?e.modelTopology!=null||e.weightSpecs!=null?new JM(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new JM({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new JM({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))},getLoadHandlers:function(e,t){return Fo.getLoadHandlers(e,t)},getModelArtifactsInfoForJSON:Tb,getSaveHandlers:function(e){return Fo.getSaveHandlers(e)},http:ZM,isHTTPScheme:YM,loadWeights:function(e,t,n,r){return t===void 0&&(t=""),tt(this,void 0,void 0,function(){return nt(this,function(i){return[2,lJ(function(a){return uJ(a,{requestInit:r})})(e,t,n)]})})},registerLoadRouter:function(e){return Fo.registerLoadRouter(e)},registerSaveRouter:function(e){return Fo.registerSaveRouter(e)},weightsLoaderFactory:lJ,withSaveHandler:function(e){return new Y$e(e)},copyModel:function(e,t){return tt(this,void 0,void 0,function(){return nt(this,function(n){return[2,eJ(e,t,!1)]})})},listModels:function(){return tt(this,void 0,void 0,function(){var e,t,n,r,i,a,o;return nt(this,function(s){switch(s.label){case 0:e=zf.getSchemes(),t={},n=0,r=e,s.label=1;case 1:return n<r.length?(i=r[n],[4,zf.getManager(i).listModels()]):[3,4];case 2:for(o in a=s.sent())t[i+jm+o]=a[o];s.label=3;case 3:return n++,[3,1];case 4:return[2,t]}})})},moveModel:function(e,t){return tt(this,void 0,void 0,function(){return nt(this,function(n){return[2,eJ(e,t,!0)]})})},removeModel:function(e){return tt(this,void 0,void 0,function(){var t;return nt(this,function(n){return t=kE(e),[2,zf.getManager(t.scheme).removeModel(t.path)]})})}}),qm,Z$e=Q({confusionMatrix_:function(e,t,n){var r=j(e,"labels","confusionMatrix"),i=j(t,"predictions","confusionMatrix");U(n==null||n>0&&Number.isInteger(n),function(){return"If provided, numClasses must be a positive integer, but got "+n}),U(r.rank===1,function(){return"Expected the rank of labels to be 1, but got "+r.rank}),U(i.rank===1,function(){return"Expected the rank of predictions to be 1, but got "+i.rank}),U(r.shape[0]===i.shape[0],function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+i.shape[0]+". Labels and predictions should have the same number of elements."}),U(n>0&&Number.isInteger(n),function(){return"numClasses is required to be a positive integer, but got "+n});var a=zh(r.asType("int32"),n),o=zh(i.asType("int32"),n);return a.transpose().matMul(o).asType("int32")}}),J$e=Object.freeze({confusionMatrix:Z$e}),Q$e=Q({fromPixels_:function(e,t){if(t===void 0&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,i=!1,a=!1,o=!1;if(e.data instanceof Uint8Array)n=!0;else if(typeof ImageData!="undefined"&&e instanceof ImageData)r=!0;else if(typeof HTMLVideoElement!="undefined"&&e instanceof HTMLVideoElement)i=!0;else if(typeof HTMLImageElement!="undefined"&&e instanceof HTMLImageElement)a=!0;else{if(e.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);o=!0}if(i&&i&&e.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(AF("FromPixels",J.backendName)!=null)return J.runKernel("FromPixels",{pixels:e},{numChannels:t});var s,u,l=i?[e.videoWidth,e.videoHeight]:[e.width,e.height],c=l[0],f=l[1];if(o?s=e.getContext("2d").getImageData(0,0,c,f).data:r||n?s=e.data:(a||i)&&(qm==null&&(qm=document.createElement("canvas").getContext("2d")),qm.canvas.width=c,qm.canvas.height=f,qm.drawImage(e,0,0,c,f),s=qm.getImageData(0,0,c,f).data),t===4)u=new Int32Array(s);else{var d=c*f;u=new Int32Array(d*t);for(var h=0;h<d;h++)for(var p=0;p<t;++p)u[h*t+p]=s[4*h+p]}return TS(u,[f,c,t],"int32")}}),dJ=Object.freeze({toPixels:function(e,t){return tt(this,void 0,void 0,function(){var n,r,i,a,o,s,u,l,c,f,d,h,p,g,m,v,y,b,x,w,S,C,_;return nt(this,function(E){switch(E.label){case 0:if(n=j(e,"img","toPixels"),e instanceof Ht||(n=n.toInt()),n.rank!==2&&n.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),i=r[0],a=r[1],(o=n.rank===2?1:n.shape[2])>4||o===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+o);return[4,n.data()];case 1:return s=E.sent(),u=n.min(),l=n.max(),[4,Promise.all([u.data(),l.data()])];case 2:if(c=E.sent(),f=c[0],d=c[1],h=f[0],p=d[0],u.dispose(),l.dispose(),n.dtype==="float32"){if(h<0||p>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+h+" - "+p+"].")}else{if(n.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(h<0||p>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+h+" - "+p+"].")}for(g=n.dtype==="float32"?255:1,m=new Uint8ClampedArray(a*i*4),v=0;v<i*a;++v)y=void 0,b=void 0,x=void 0,w=void 0,o===1?(y=s[v]*g,b=s[v]*g,x=s[v]*g,w=255):o===3?(y=s[3*v]*g,b=s[3*v+1]*g,x=s[3*v+2]*g,w=255):o===4&&(y=s[4*v]*g,b=s[4*v+1]*g,x=s[4*v+2]*g,w=s[4*v+3]*g),m[(S=4*v)+0]=Math.round(y),m[S+1]=Math.round(b),m[S+2]=Math.round(x),m[S+3]=Math.round(w);return t!=null&&(t.width=a,t.height=i,C=t.getContext("2d"),_=new ImageData(m,a,i),C.putImageData(_,0,0)),n!==e&&n.dispose(),[2,m]}})})},fromPixels:Q$e}),hJ=function(){function e(){}return e.prototype.getClassName=function(){return this.constructor.className},e.fromConfig=function(t,n){return new t(n)},e}(),pJ=function(){function e(){this.classNameMap={}}return e.getMap=function(){return e.instance==null&&(e.instance=new e),e.instance},e.register=function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]},e}();function Uf(e){U(e.className!=null,function(){return"Class being registered does not have the static className property defined."}),U(typeof e.className=="string",function(){return"className is required to be a string, but got type "+typeof e.className}),U(e.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),pJ.register(e)}var Ne=Object.freeze({Serializable:hJ,SerializationMap:pJ,registerClass:Uf}),e4e="1.7.4",t4e=Object.freeze({gpgpu_util:aPe,webgl_util:D3e,forceHalfFloat:function(){pe().set("WEBGL_FORCE_F16_TEXTURES",!0)},MathBackendWebGL:WY,setWebGLContext:HK,GPGPUContext:AY}),cc=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Bs(t,e),t.prototype.minimize=function(n,r,i){r===void 0&&(r=!1);var a=this.computeGradients(n,i),o=a.value,s=a.grads;if(i!=null){var u=i.map(function(l){return{name:l.name,tensor:s[l.name]}});this.applyGradients(u)}else this.applyGradients(s);return Ut(s),r?o:(o.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(n,r){return qX(n,r)},t.prototype.dispose=function(){this.iterations_!=null&&Ut(this.iterations_)},t.prototype.saveIterations=function(){return tt(this,void 0,void 0,function(){return nt(this,function(n){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:Ve(this.iterations_,"int32")}]})})},t.prototype.getWeights=function(){return tt(this,void 0,void 0,function(){return nt(this,function(n){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},t.prototype.setWeights=function(n){return tt(this,void 0,void 0,function(){return nt(this,function(r){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},t.prototype.extractIterations=function(n){return tt(this,void 0,void 0,function(){var r;return nt(this,function(i){switch(i.label){case 0:return r=this,[4,n[0].tensor.data()];case 1:return r.iterations_=i.sent()[0],[2,n.slice(1)]}})})},t}(hJ);Object.defineProperty(cc,Symbol.hasInstance,{value:function(e){return e.minimize!=null&&e.computeGradients!=null&&e.applyGradients!=null}});var QM=function(e){function t(n,r,i){i===void 0&&(i=null);var a=e.call(this)||this;return a.learningRate=n,a.rho=r,a.epsilon=i,a.accumulatedGrads=[],a.accumulatedUpdates=[],i==null&&(a.epsilon=J.backend.epsilon()),a}return Bs(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n)).forEach(function(i,a){var o=J.registeredVariables[i];r.accumulatedGrads[a]==null&&(r.accumulatedGrads[a]={originalName:i+"/accum_grad",variable:le(function(){return en(o).variable(!1)})}),r.accumulatedUpdates[a]==null&&(r.accumulatedUpdates[a]={originalName:i+"/accum_var",variable:le(function(){return en(o).variable(!1)})});var s=Array.isArray(n)?n[a].tensor:n[i];if(s!=null){var u=r.accumulatedGrads[a].variable,l=r.accumulatedUpdates[a].variable;le(function(){var c=u.mul(r.rho).add(s.square().mul(1-r.rho)),f=l.add(r.epsilon).sqrt().div(u.add(r.epsilon).sqrt()).mul(s),d=l.mul(r.rho).add(f.square().mul(1-r.rho));u.assign(c),l.assign(d);var h=f.mul(-r.learningRate).add(o);o.assign(h)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedUpdates!=null&&(Ut(this.accumulatedGrads.map(function(n){return n.variable})),Ut(this.accumulatedUpdates.map(function(n){return n.variable})))},t.prototype.getWeights=function(){return tt(this,void 0,void 0,function(){var n;return nt(this,function(r){switch(r.label){case 0:return n=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(i){return{name:i.originalName,tensor:i.variable}}))]}})})},t.prototype.setWeights=function(n){return tt(this,void 0,void 0,function(){var r;return nt(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(n)];case 1:return n=i.sent(),r=n.length/2,this.accumulatedGrads=n.slice(0,r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.accumulatedUpdates=n.slice(r,2*r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(n,r){return new n(r.learningRate,r.rho,r.epsilon)},t.className="Adadelta",t}(cc);Uf(QM);var eP=function(e){function t(n,r){r===void 0&&(r=.1);var i=e.call(this)||this;return i.learningRate=n,i.initialAccumulatorValue=r,i.accumulatedGrads=[],i}return Bs(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n)).forEach(function(i,a){var o=J.registeredVariables[i];r.accumulatedGrads[a]==null&&(r.accumulatedGrads[a]={originalName:i+"/accumulator",variable:le(function(){return Em(o.shape,r.initialAccumulatorValue).variable(!1)})});var s=Array.isArray(n)?n[a].tensor:n[i];if(s!=null){var u=r.accumulatedGrads[a].variable;le(function(){var l=u.add(s.square());u.assign(l);var c=s.div(l.add(J.backend.epsilon()).sqrt()).mul(-r.learningRate).add(o);o.assign(c)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedGrads!=null&&Ut(this.accumulatedGrads.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return tt(this,void 0,void 0,function(){return nt(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulatedGrads.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return tt(this,void 0,void 0,function(){return nt(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulatedGrads=n.map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(n,r){return new n(r.learningRate,r.initialAccumulatorValue)},t.className="Adagrad",t}(cc);Uf(eP);var tP=function(e){function t(n,r,i,a){a===void 0&&(a=null);var o=e.call(this)||this;return o.learningRate=n,o.beta1=r,o.beta2=i,o.epsilon=a,o.accumulatedFirstMoment=[],o.accumulatedSecondMoment=[],le(function(){o.accBeta1=Ve(r).variable(),o.accBeta2=Ve(i).variable()}),a==null&&(o.epsilon=J.backend.epsilon()),o}return Bs(t,e),t.prototype.applyGradients=function(n){var r=this,i=Array.isArray(n)?n.map(function(a){return a.name}):Object.keys(n);le(function(){var a=Er(1,r.accBeta1),o=Er(1,r.accBeta2);i.forEach(function(s,u){var l=J.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:le(function(){return en(l).variable(!1)})}),r.accumulatedSecondMoment[u]==null&&(r.accumulatedSecondMoment[u]={originalName:s+"/v",variable:le(function(){return en(l).variable(!1)})});var c=Array.isArray(n)?n[u].tensor:n[s];if(c!=null){var f=r.accumulatedFirstMoment[u].variable,d=r.accumulatedSecondMoment[u].variable,h=f.mul(r.beta1).add(c.mul(1-r.beta1)),p=d.mul(r.beta2).add(c.square().mul(1-r.beta2)),g=h.div(a),m=p.div(o);f.assign(h),d.assign(p);var v=g.div(m.sqrt().add(r.epsilon)).mul(-r.learningRate).add(l);l.assign(v)}}),r.accBeta1.assign(r.accBeta1.mul(r.beta1)),r.accBeta2.assign(r.accBeta2.mul(r.beta2))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Ut(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedSecondMoment!=null&&Ut(this.accumulatedSecondMoment.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return tt(this,void 0,void 0,function(){var n;return nt(this,function(r){switch(r.label){case 0:return n=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(i){return{name:i.originalName,tensor:i.variable}}))]}})})},t.prototype.setWeights=function(n){return tt(this,void 0,void 0,function(){var r,i=this;return nt(this,function(a){switch(a.label){case 0:return[4,this.extractIterations(n)];case 1:return n=a.sent(),le(function(){i.accBeta1.assign(km(i.beta1,i.iterations_+1)),i.accBeta2.assign(km(i.beta2,i.iterations_+1))}),r=n.length/2,this.accumulatedFirstMoment=n.slice(0,r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),this.accumulatedSecondMoment=n.slice(r,2*r).map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon)},t.className="Adam",t}(cc);Uf(tP);var nP=function(e){function t(n,r,i,a,o){a===void 0&&(a=null),o===void 0&&(o=0);var s=e.call(this)||this;return s.learningRate=n,s.beta1=r,s.beta2=i,s.epsilon=a,s.decay=o,s.accumulatedFirstMoment=[],s.accumulatedWeightedInfNorm=[],le(function(){s.iteration=Ve(0).variable(),s.accBeta1=Ve(r).variable()}),a==null&&(s.epsilon=J.backend.epsilon()),s}return Bs(t,e),t.prototype.applyGradients=function(n){var r=this,i=Array.isArray(n)?n.map(function(a){return a.name}):Object.keys(n);le(function(){var a=Er(1,r.accBeta1),o=Cr(-r.learningRate,r.iteration.mul(r.decay).add(1));i.forEach(function(s,u){var l=J.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:en(l).variable(!1)}),r.accumulatedWeightedInfNorm[u]==null&&(r.accumulatedWeightedInfNorm[u]={originalName:s+"/v",variable:en(l).variable(!1)});var c=Array.isArray(n)?n[u].tensor:n[s];if(c!=null){var f=r.accumulatedFirstMoment[u].variable,d=r.accumulatedWeightedInfNorm[u].variable,h=f.mul(r.beta1).add(c.mul(1-r.beta1)),p=d.mul(r.beta2),g=c.abs(),m=p.maximum(g);f.assign(h),d.assign(m);var v=o.div(a).mul(h.div(m.add(r.epsilon))).add(l);l.assign(v)}}),r.iteration.assign(r.iteration.add(1)),r.accBeta1.assign(r.accBeta1.mul(r.beta1))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Ut(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedWeightedInfNorm!=null&&Ut(this.accumulatedWeightedInfNorm.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return tt(this,void 0,void 0,function(){return nt(this,function(n){throw new Error("getWeights() is not implemented for Adamax yet.")})})},t.prototype.setWeights=function(n){return tt(this,void 0,void 0,function(){return nt(this,function(r){throw new Error("setWeights() is not implemented for Adamax yet.")})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon,r.decay)},t.className="Adamax",t}(cc);Uf(nP);var TE=function(e){function t(n){var r=e.call(this)||this;return r.learningRate=n,r.setLearningRate(n),r}return Bs(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n)).forEach(function(i,a){var o=Array.isArray(n)?n[a].tensor:n[i];if(o!=null){var s=J.registeredVariables[i];le(function(){var u=r.c.mul(o).add(s);s.assign(u)})}}),this.incrementIterations()},t.prototype.setLearningRate=function(n){this.learningRate=n,this.c!=null&&this.c.dispose(),this.c=zu(Ve(-n))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return tt(this,void 0,void 0,function(){return nt(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()]]}})})},t.prototype.setWeights=function(n){return tt(this,void 0,void 0,function(){return nt(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:if((n=r.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(n,r){return new n(r.learningRate)},t.className="SGD",t}(cc);Uf(TE);var rP=function(e){function t(n,r,i){i===void 0&&(i=!1);var a=e.call(this,n)||this;return a.learningRate=n,a.momentum=r,a.useNesterov=i,a.accumulations=[],a.m=Ve(a.momentum),a}return Bs(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n)).forEach(function(i,a){var o=J.registeredVariables[i];r.accumulations[a]==null&&(r.accumulations[a]={originalName:i+"/momentum",variable:le(function(){return en(o).variable(!1)})});var s=r.accumulations[a].variable,u=Array.isArray(n)?n[a].tensor:n[i];u!=null&&le(function(){var l,c=r.m.mul(s).add(u);l=r.useNesterov?r.c.mul(u.add(c.mul(r.m))).add(o):r.c.mul(c).add(o),s.assign(c),o.assign(l)})}),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&Ut(this.accumulations.map(function(n){return n.variable}))},t.prototype.setMomentum=function(n){this.momentum=n},t.prototype.getWeights=function(){return tt(this,void 0,void 0,function(){return nt(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulations.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return tt(this,void 0,void 0,function(){return nt(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulations=n.map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(n,r){return new n(r.learningRate,r.momentum,r.useNesterov)},t.className="Momentum",t}(TE);Uf(rP);var iP=function(e){function t(n,r,i,a,o){r===void 0&&(r=.9),i===void 0&&(i=0),a===void 0&&(a=null),o===void 0&&(o=!1);var s=e.call(this)||this;if(s.learningRate=n,s.decay=r,s.momentum=i,s.epsilon=a,s.accumulatedMeanSquares=[],s.accumulatedMoments=[],s.accumulatedMeanGrads=[],s.centered=o,a==null&&(s.epsilon=J.backend.epsilon()),n==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return s}return Bs(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n)).forEach(function(i,a){var o=J.registeredVariables[i];r.accumulatedMeanSquares[a]==null&&(r.accumulatedMeanSquares[a]={originalName:i+"/rms",variable:le(function(){return en(o).variable(!1)})}),r.accumulatedMoments[a]==null&&(r.accumulatedMoments[a]={originalName:i+"/momentum",variable:le(function(){return en(o).variable(!1)})}),r.accumulatedMeanGrads[a]==null&&r.centered&&(r.accumulatedMeanGrads[a]={originalName:i+"/mg",variable:le(function(){return en(o).variable(!1)})});var s=Array.isArray(n)?n[a].tensor:n[i];if(s!=null){var u=r.accumulatedMeanSquares[a].variable,l=r.accumulatedMoments[a].variable;le(function(){var c=u.mul(r.decay).add(s.square().mul(1-r.decay));if(r.centered){var f=r.accumulatedMeanGrads[a].variable,d=f.mul(r.decay).add(s.mul(1-r.decay)),h=l.mul(r.momentum).add(s.mul(r.learningRate).div(c.sub(d.square().add(r.epsilon)).sqrt()));u.assign(c),f.assign(d),l.assign(h);var p=o.sub(h);o.assign(p)}else{var g=u.mul(r.decay).add(s.square().mul(1-r.decay));h=l.mul(r.momentum).add(s.mul(r.learningRate).div(g.add(r.epsilon).sqrt())),u.assign(g),l.assign(h),p=o.sub(h),o.assign(p)}})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&Ut(this.accumulatedMeanSquares.map(function(n){return n.variable})),this.accumulatedMeanGrads!=null&&this.centered&&Ut(this.accumulatedMeanGrads.map(function(n){return n.variable})),this.accumulatedMoments!=null&&Ut(this.accumulatedMoments.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return tt(this,void 0,void 0,function(){var n;return nt(this,function(r){switch(r.label){case 0:return n=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&n.push.apply(n,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(i){return{name:i.originalName,tensor:i.variable}}))]}})})},t.prototype.setWeights=function(n){return tt(this,void 0,void 0,function(){var r;return nt(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(n)];case 1:return n=i.sent(),r=this.centered?n.length/3:n.length/2,this.accumulatedMeanSquares=n.slice(0,r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.accumulatedMoments=n.slice(r,2*r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=n.slice(2*r,3*r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}})),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(n,r){return new n(r.learningRate,r.decay,r.momentum,r.epsilon,r.centered)},t.className="RMSProp",t}(cc);Uf(iP);var qh=function(){function e(){}return e.sgd=function(t){return new TE(t)},e.momentum=function(t,n,r){return r===void 0&&(r=!1),new rP(t,n,r)},e.rmsprop=function(t,n,r,i,a){return n===void 0&&(n=.9),r===void 0&&(r=0),i===void 0&&(i=null),a===void 0&&(a=!1),new iP(t,n,r,i,a)},e.adam=function(t,n,r,i){return t===void 0&&(t=.001),n===void 0&&(n=.9),r===void 0&&(r=.999),i===void 0&&(i=null),new tP(t,n,r,i)},e.adadelta=function(t,n,r){return t===void 0&&(t=.001),n===void 0&&(n=.95),r===void 0&&(r=null),new QM(t,n,r)},e.adamax=function(t,n,r,i,a){return t===void 0&&(t=.002),n===void 0&&(n=.9),r===void 0&&(r=.999),i===void 0&&(i=null),a===void 0&&(a=0),new nP(t,n,r,i,a)},e.adagrad=function(t,n){return n===void 0&&(n=.1),new eP(t,n)},e}(),Wf={sgd:qh.sgd,momentum:qh.momentum,adadelta:qh.adadelta,adagrad:qh.adagrad,rmsprop:qh.rmsprop,adamax:qh.adamax,adam:qh.adam},n4e=typeof requestAnimationFrame!="undefined"?requestAnimationFrame:typeof setImmediate!="undefined"?setImmediate:function(e){return e()};function OE(){return new Promise(function(e){return n4e(function(){return e()})})}Ht.prototype.add=function(e){return Wt(this,e)},Ht.prototype.broadcastTo=function(e){return uM(this,e)},Ht.prototype.div=function(e){return Cr(this,e)},Ht.prototype.divNoNan=function(e){return rE(this,e)},Ht.prototype.squaredDifference=function(e){return oE(this,e)},Ht.prototype.tile=function(e){return sc(this,e)},Ht.prototype.oneHot=function(e,t,n){return t===void 0&&(t=1),n===void 0&&(n=0),zh(this,e,t,n)},Ht.prototype.transpose=function(e){return cn(this,e)},Ht.prototype.pad=function(e,t){return Gu(this,e,t)},Ht.prototype.batchNorm=function(e,t,n,r,i){return Bh(this,e,t,n,r,i)},ye=S$e;var r4e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",AdadeltaOptimizer:QM,AdagradOptimizer:eP,AdamOptimizer:tP,AdamaxOptimizer:nP,Add:u3,AddN:K3e,BroadcastTo:l3,DataStorage:z3,Div:ob,get ENV(){return CF},Environment:kK,FromPixels:Q3e,FusedBatchNorm:X3e,Identity:f3,KernelBackend:j3,MaxPoolWithArgmax:eMe,MomentumOptimizer:rP,NonMaxSuppressionV5:J3e,OneHot:c3,Optimizer:cc,PadV2:h3,RMSPropOptimizer:iP,get Rank(){return zF},get Reduction(){return Ri},SGDOptimizer:TE,Square:Y3e,SquaredDifference:sb,Tensor:Ht,TensorBuffer:Sm,Tile:d3,Transpose:Z3e,Variable:Xy,abs:Df,acos:p3,acosh:g3,add:Wt,addN:iM,addStrict:DX,all:mE,any:_b,argMax:Sb,argMin:SM,asin:m3,asinh:v3,atan:y3,atan2:R3,atanh:b3,avgPool:dE,avgPool3d:pE,backend:vX,backend_util:uMe,basicLSTMCell:FZ,batchNorm:Bh,batchNorm2d:aM,batchNorm3d:oM,batchNorm4d:sM,batchNormalization:HY,batchNormalization2d:KY,batchNormalization3d:YY,batchNormalization4d:JY,batchToSpaceND:OS,booleanMaskAsync:mZ,broadcastTo:uM,browser:dJ,buffer:Ot,cast:IS,ceil:x3,clipByValue:xa,clone:QY,complex:ri,concat:Hi,concat1d:n3,concat2d:r3,concat3d:i3,concat4d:a3,conv1d:sE,conv2d:Wh,conv2dTranspose:lE,conv3d:uE,conv3dTranspose:_Z,cos:w3,cosh:_3,cumsum:EX,customGrad:fb,deprecationWarn:ES,depthToSpace:o3,depthwiseConv2d:Pm,diag:LZ,disableDeprecationWarnings:M3e,dispose:Ut,disposeVariables:P3e,div:Cr,divNoNan:rE,divStrict:RX,dot:SZ,dropout:NM,elu:Lm,enableDebugMode:F3e,enableProdMode:R3e,engine:$3e,env:pe,equal:Uh,equalStrict:uZ,erf:S3,exp:E3,expandDims:Do,expm1:C3,eye:iE,fft:Ab,fill:Em,findBackend:V3e,findBackendFactory:q3e,floor:MS,floorDiv:BS,frame:EE,fused:Bf,gather:Mm,gatherND:IM,gather_util:tMe,getBackend:U3e,getGradient:kF,getKernel:AF,getKernelsForBackend:TF,grad:iMe,grads:aMe,greater:Rm,greaterEqual:bb,greaterEqualStrict:lZ,greaterStrict:cZ,hammingWindow:DM,hannWindow:SE,ifft:Bm,imag:is,image:Lf,inTopKAsync:jZ,io:wa,irfft:wE,isFinite:IX,isInf:OX,isNaN:TX,keep:zu,leakyRelu:bE,less:mM,lessEqual:vM,lessEqualStrict:fZ,lessStrict:dZ,linalg:FM,linspace:t3,localResponseNormalization:CM,log:oc,log1p:A3,logSigmoid:kX,logSoftmax:VS,logSumExp:RZ,logicalAnd:Hu,logicalNot:lM,logicalOr:tE,logicalXor:eZ,losses:UZ,matMul:cE,math:J$e,max:Pf,maxPool:fE,maxPool3d:hE,maxPoolWithArgmax:_M,maximum:Vu,maximumStrict:FX,mean:Fr,memory:CS,min:vE,minimum:Am,minimumStrict:MX,mod:F3,modStrict:PX,moments:Eb,movingAverage:PZ,mul:rt,mulStrict:zS,multiRNNCell:MZ,multinomial:cM,neg:Rf,nextFrame:OE,norm:AM,notEqual:Fm,notEqualStrict:hZ,oneHot:zh,ones:Wu,onesLike:No,op:Q,outerProduct:EZ,pad:Gu,pad1d:tZ,pad2d:nZ,pad3d:rZ,pad4d:iZ,pool:NZ,pow:km,powStrict:$X,prelu:Cb,print:SX,prod:yE,profile:L3e,rand:aZ,randomGamma:sZ,randomNormal:gM,randomUniform:jh,range:Cm,ready:j3e,real:eo,reciprocal:k3,registerBackend:H3e,registerGradient:TK,registerKernel:OF,relu:$f,relu6:EM,removeBackend:W3e,reshape:Ws,reverse:Ku,reverse1d:CZ,reverse2d:AZ,reverse3d:kZ,reverse4d:TZ,rfft:kb,round:T3,rsqrt:PS,scalar:Ve,scatterND:OM,scatter_util:nMe,selu:xE,separableConv2d:wM,serialization:Ne,setBackend:z3e,setPlatform:G3e,setdiff1dAsync:s3,sigmoid:$S,sign:O3,signal:zZ,sin:I3,sinh:N3,slice:Ro,slice1d:xb,slice2d:gE,slice3d:wb,slice4d:$m,slice_util:rMe,softmax:Rh,softplus:ub,spaceToBatchND:NS,sparseToDense:_E,spectral:$Z,split:ic,sqrt:lb,square:aE,squaredDifference:oE,squaredDifferenceStrict:LX,squeeze:ab,stack:as,step:NX,stft:RM,stridedSlice:kM,sub:Er,subStrict:BX,sum:qr,sumOutType:mS,tan:D3,tanh:LS,tensor:Rr,tensor1d:ba,tensor2d:Uu,tensor3d:TS,tensor4d:If,tensor5d:wX,tensor6d:_X,tensor_util:Lu,test_util:QPe,tidy:le,tile:sc,time:B3e,topk:TM,train:Wf,transpose:cn,truncatedNormal:yb,unregisterGradient:S3e,unregisterKernel:_3e,unsortedSegmentSum:yM,unstack:Nf,util:pt,valueAndGrad:oMe,valueAndGrads:sMe,variable:e3,variableGrads:qX,version_core:e4e,webgl:t4e,where:qs,whereAsync:nE,zeros:Tn,zerosLike:en});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var gJ=function(e,t){return(gJ=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])})(e,t)};function Ee(e,t){function n(){this.constructor=e}gJ(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var aP,Ob=function(){return(Ob=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function At(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})}function St(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(u){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){o=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(c[0]===6&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(f){c=[6,f],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}function Hr(){return aP==null&&(aP=vX().epsilon()),aP}function Hs(){return"channelsLast"}var Hh=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Ee(t,e),t}(Error),Xu=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Ee(t,e),t}(Error),ie=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Ee(t,e),t}(Error),$t=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Ee(t,e),t}(Error),i4e=function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Ee(t,e),t}(Error);(function(e){function t(n){var r=e.call(this,n)||this;return Object.setPrototypeOf(r,t.prototype),r}return Ee(t,e),t})(Error);function Gh(e,t){if(Array.isArray(e)){for(var n=[],r=0;r<t;r++)n=n.concat(e);return n}return(n=new Array(t)).fill(e),n}function Yu(e,t){if(!e)throw new i4e(t)}function mJ(e,t){for(var n=0,r=0,i=e;r<i.length;r++)i[r]===t&&n++;return n}function _a(e){return e.length===1?e[0]:e}function Jn(e){return Array.isArray(e)?e:[e]}function fc(e){var t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return t[0]!=="_"?t:"private"+t}function Kh(e){return e.length<=1||e.indexOf("_")===-1?e:e.replace(/[_]+(\w|$)/g,function(t,n){return n.toUpperCase()})}var os={};function oP(e){if(e==null)return null;var t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function sP(e){if(e!=null&&typeof e=="object")if(Array.isArray(e))e.forEach(function(a){return sP(a)});else for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t],i=e[r];i!=null&&typeof i=="object"&&(Array.isArray(i)||i.type!=="ndarray"||typeof i.value!="number"?sP(i):e[r]=i.value)}}function Ib(e,t,n,r,i){var a,o,s;if(t===void 0&&(t={}),n===void 0&&(n={}),r===void 0&&(r="object"),i===void 0&&(i=!1),typeof e=="string"){var u=e,l=void 0;if(u in n)l=n[u];else if(u in os)l=os[u];else if((l=t[u])==null)throw new ie("Unknown "+r+": "+e+`. This may be due to one of the following reasons:
1. The `+r+` is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom `+r+" is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().");return l}var c=e;if(c.className==null||c.config==null)throw new ie(r+": Improper config format: "+JSON.stringify(c)+`.
'className' and 'config' must set.`);var f=c.className,d=void 0,h=void 0;if(f in n?(d=(a=n[f])[0],h=a[1]):f in os?(d=(o=os.className)[0],h=o[1]):f in t&&(d=(s=t[f])[0],h=s[1]),d==null)throw new ie("Unknown "+r+": "+f+`. This may be due to one of the following reasons:
1. The `+r+` is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom `+r+" is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().");if(h!=null){for(var p={},g=0,m=Object.keys(os);g<m.length;g++)p[S=m[g]]=os[S];for(var v=0,y=Object.keys(n);v<y.length;v++)p[S=y[v]]=n[S];c.config.customObjects=p;for(var b=Ob({},os),x=0,w=Object.keys(n);x<w.length;x++){var S=w[x];os[S]=n[S]}sP(c.config);var C=h(d,c.config,n,i);return os=Ob({},b),C}b=Ob({},os);for(var _=0,E=Object.keys(n);_<E.length;_++)S=E[_],os[S]=n[S];return C=new d(c.config),os=Ob({},b),C}function a4e(e,t){return e<t?-1:e>t?1:0}function IE(e,t){return-1*a4e(e,t)}function Vf(e){if(e==null)return e;for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];t.indexOf(i)===-1&&t.push(i)}return t}function o4e(e){if(e==null)throw new ie("Invalid value in obj: "+JSON.stringify(e));for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function Hm(e,t,n){if(n!=null&&e.indexOf(n)<0)throw new ie(n+" is not a valid "+t+".  Valid values are "+e+" or null/undefined.")}function uP(e,t,n,r){return n===void 0&&(n=0),r===void 0&&(r=1/0),Yu(n>=0),Yu(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every(function(i){return typeof i===t})}function Sa(e,t){Array.isArray(e)?(pt.assert(e.length>0,function(){return t+" is unexpectedly an empty array."}),e.forEach(function(n,r){return Sa(n,"element "+(r+1)+" of "+t)})):pt.assert(Number.isInteger(e)&&e>0,function(){return"Expected "+t+" to be a positive integer, but got "+vJ(e)+"."})}function vJ(e){return e===null?"null":Array.isArray(e)?"["+e.map(function(t){return vJ(t)}).join(",")+"]":typeof e=="string"?'"'+e+'"':""+e}function s4e(e,t){var n,r=pt.now();return function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var o=pt.now();return o-r<t?n:(r=o,n=e.apply(void 0,i))}}function yJ(e){return e==="relu"?"relu":e==="linear"?"linear":e==="elu"?"elu":null}function lP(e,t){return le(function(){return lb(qr(zS(e,e),t,!0))})}var Nb=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.getConfig=function(){return{}},t}(Ne.Serializable),bJ=function(e){function t(n){var r=e.call(this)||this;return r.defaultMaxValue=2,r.defaultAxis=0,r.maxValue=n.maxValue!=null?n.maxValue:r.defaultMaxValue,r.axis=n.axis!=null?n.axis:r.defaultAxis,r}return Ee(t,e),t.prototype.apply=function(n){var r=this;return le(function(){var i=lP(n,r.axis),a=xa(i,0,r.maxValue);return rt(n,Cr(a,Wt(Hr(),i)))})},t.prototype.getConfig=function(){return{maxValue:this.maxValue,axis:this.axis}},t.className="MaxNorm",t}(Nb);Ne.registerClass(bJ);var xJ=function(e){function t(n){var r=e.call(this)||this;return r.defaultAxis=0,r.axis=n.axis!=null?n.axis:r.defaultAxis,r}return Ee(t,e),t.prototype.apply=function(n){var r=this;return le(function(){return Cr(n,Wt(Hr(),lP(n,r.axis)))})},t.prototype.getConfig=function(){return{axis:this.axis}},t.className="UnitNorm",t}(Nb);Ne.registerClass(xJ);var wJ=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return $f(n)},t.className="NonNeg",t}(Nb);Ne.registerClass(wJ);var _J=function(e){function t(n){var r=e.call(this)||this;return r.defaultMinValue=0,r.defaultMaxValue=1,r.defaultRate=1,r.defaultAxis=0,r.minValue=n.minValue!=null?n.minValue:r.defaultMinValue,r.maxValue=n.maxValue!=null?n.maxValue:r.defaultMaxValue,r.rate=n.rate!=null?n.rate:r.defaultRate,r.axis=n.axis!=null?n.axis:r.defaultAxis,r}return Ee(t,e),t.prototype.apply=function(n){var r=this;return le(function(){var i=lP(n,r.axis),a=Wt(rt(r.rate,xa(i,r.minValue,r.maxValue)),rt(1-r.rate,i));return rt(n,Cr(a,Wt(Hr(),i)))})},t.prototype.getConfig=function(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}},t.className="MinMaxNorm",t}(Nb);Ne.registerClass(_J);var SJ={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Ln(e){return oP(e)}function EJ(e,t){return t===void 0&&(t={}),Ib(e,Ne.SerializationMap.getMap().classNameMap,t,"constraint")}function Gr(e){return e==null?null:typeof e=="string"?EJ({className:e in SJ?SJ[e]:e,config:{}}):e instanceof Nb?e:EJ(e)}function u4e(e){return new bJ(e)}function l4e(e){return new xJ(e)}function c4e(){return new wJ}function f4e(e){return new _J(e)}Object.freeze({maxNorm:u4e,unitNorm:l4e,nonNeg:c4e,minMaxNorm:f4e});var d4e=["channelsFirst","channelsLast"],h4e=["valid","same","causal"],p4e=["max","avg"],g4e=["sum","mul","concat","ave"],Gm=new Map;function Kr(e){Hm(d4e,"DataFormat",e)}function ss(e){Hm(h4e,"PaddingMode",e)}function CJ(e){Hm(p4e,"PoolMode",e)}var Db=[],AJ="/";function Xh(e,t){Db.push(e);try{var n=t();return Db.pop(),n}catch(r){throw Db.pop(),r}}function m4e(){return Db.length===0?"":Db.join(AJ)+AJ}function kJ(e){if(!OJ(e))throw new Error("Not a valid tensor name: '"+e+"'");return m4e()+e}function TJ(e){if(!OJ(e))throw new Error("Not a valid tensor name: '"+e+"'");Gm.has(e)||Gm.set(e,0);var t=Gm.get(e);if(Gm.set(e,Gm.get(e)+1),t>0){var n=e+"_"+t;return Gm.set(n,1),n}return e}var v4e=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function OJ(e){return!!e.match(v4e)}function y4e(e){return e===parseInt(e.toString(),10)}function qf(e,t,n){t==null&&(t=0),n==null&&(n=e.length);for(var r=1,i=t;i<n;++i)r*=e[i];return r}function IJ(e){return e=Array.isArray(e)?new Float32Array(e):e,ba(e)}function Km(e){return vE(IJ(e)).dataSync()[0]}function Hf(e){return Pf(IJ(e)).dataSync()[0]}function Gs(e,t){if(t<e)throw new ie("end ("+t+") < begin ("+e+") is forbidden.");for(var n=[],r=e;r<t;++r)n.push(r);return n}function Rb(e,t){return e.asType(t)}function Fb(e,t){t===void 0&&(t=-1);var n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),e.reshape(n)}function b4e(e,t){return le(function(){if(e.shape.length!==2)throw new ie("repeat() expects a rank-2 tensor, but received a rank-"+e.shape.length+" tensor.");return fP(Fb(e,1),[1,t,1])})}function x4e(e){var t=[qf(e.shape)];return e.reshape(t)}function w4e(e){if(e.rank<=1)throw new ie("batchFlatten requires a minimum rank of 2. Got rank: "+e.rank+".");var t=[e.shape[0],qf(e.shape,1)];return e.reshape(t)}function Yh(e,t,n){return le(function(){switch(e.rank){case 1:return xb(e,t,n);case 2:return gE(e,[t,0],[n,e.shape[1]]);case 3:return wb(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return $m(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return Ro(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return Ro(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new ie("sliceAlongFirstAxis() received an unsupported tensor rank: "+e.rank)}})}function cP(e,t,n){return le(function(){switch(e.rank){case 1:return xb(e,t,n);case 2:return gE(e,[0,t],[e.shape[0],n]);case 3:return wb(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return $m(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new ie("sliceAlongLastAxis() received an unsupported tensor rank: "+e.rank)}})}function NE(e,t,n,r){return le(function(){switch(e.rank){case 1:return xb(e,t,n);case 2:switch(r){case 1:return Yh(e,t,n);case 2:return cP(e,t,n);default:throw new ie("The axis is not within the rank of the tensor "+r)}case 3:switch(r){case 1:return Yh(e,t,n);case 2:return wb(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return cP(e,t,n);default:throw new ie("The axis is not within the rank of the tensor "+r)}case 4:switch(r){case 1:return Yh(e,t,n);case 2:return $m(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return $m(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return cP(e,t,n);default:throw new ie("The axis is not within the rank of the tensor "+r)}default:throw new ie("sliceAlongLastAxis() received an unsupported tensor rank: "+e.rank)}})}function NJ(e,t){var n;return t===void 0&&(t=-1),t<0&&(t=(n=e[0].rank)!==0?n:0),t===e[0].rank&&(t=-1),Hi(e,t)}function DJ(e,t){switch(e.rank){case 1:return n3([e,t]);case 2:return r3([e,t],0);case 3:return i3([e,t],0);case 4:return a3([e,t],0);default:throw new ie("concatAlongFirstAxis() received an unsupported tensor rank: "+e.rank)}}function fP(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new ie("The length of input n ("+t.length+") does not match the number of dimensions in input x ("+e.rank+")");return sc(e,t)}function DE(e,t,n,r,i){return t===void 0&&(t=0),n===void 0&&(n=1),gM(e,t,n,r,i)}function dc(e,t,n,r){if(e.rank<2||t.rank<2)throw new $t("dot requires both inputs to be rank >= 2 but got x shape = "+e.shape+" and y shape = "+t.shape);if(t.rank>=3&&e.shape.slice(-1)[0]!==(c=t.shape.slice(-2)[0]))throw new $t("If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = "+e.shape+" and  y shape = "+t.shape);if(e.rank===2&&t.rank===2){var i=!1,a=!1;return Bf.matMul({a:e,b:t,transposeA:i,transposeB:a,bias:r?dP(e.rank,r,Hs()):null,activation:n})}var o=e.shape.slice(),s=o.pop();e=e.reshape([-1,s]);var u=t.shape.slice(),l=u.pop(),c=u.pop(),f=u.concat([l]),d=Array.from({length:t.rank},function(p,g){return g===0?t.rank-2:g<=t.rank-2?g-1:g});t=t.transpose(d).reshape([c,-1]);var h=o.concat(f);return i=!1,a=!1,Bf.matMul({a:e,b:t,transposeA:i,transposeB:a,bias:r?dP(e.rank,r,Hs()):null,activation:n}).reshape(h)}function RJ(e,t,n){return le(function(){return t=Array.isArray(t)?ba(t,"int32"):t.toInt(),Mm(e,t,n)})}function Mb(e){return zS(e,e)}function dP(e,t,n){var r=t.shape;if(t.rank!==1&&t.rank!==e)throw new ie("Unexpected bias dimensions: "+t.rank+"; expected it to be 1 or "+e);if(e===5){if(n==="channelsFirst")return r.length===1?t.reshape([1,r[0],1,1,1]):t.reshape([1,r[3],r[0],r[1],r[2]]);if(n==="channelsLast")return r.length===1?t.reshape([1,1,1,1,r[0]]):t.reshape([1].concat(r))}else if(e===4){if(n==="channelsFirst")return r.length===1?t.reshape([1,r[0],1,1]):t.reshape([1,r[2],r[0],r[1]]);if(n==="channelsLast")return r.length===1?t.reshape([1,1,1,r[0]]):t.reshape([1].concat(r))}else if(e===3){if(n==="channelsFirst")return r.length===1?t.reshape([1,r[0],1]):t.reshape([1,r[1],r[0]]);if(n==="channelsLast")return r.length===1?t.reshape([1,1,r[0]]):t.reshape([1].concat(r))}else if(e<3)return t;throw new ie("Unsupported input rank by biasAdd: "+t.rank)}function hc(e,t,n){return le(function(){return n==null&&(n=Hs()),Kr(n),e.add(dP(e.rank,t,n))})}function _4e(e,t){if(t===void 0&&(t=1),t!==1)throw new $t("Support for alpha values other than 1 ("+t+") is not implemented yet.");return Lm(e)}function S4e(e){return le(function(){return Cr(e,Df(e).add(1))})}function FJ(e,t,n,r){return le(function(){return NM(e,t,n,r)})}function E4e(e){return le(function(){var t=Wt(.5,rt(.2,e));return xa(t,0,1)})}function Xm(e,t,n){return n===void 0&&(n=!1),n?e():t()}var C4e=["fanIn","fanOut","fanAvg"],A4e=["normal","uniform","truncatedNormal"];function k4e(e){Hm(C4e,"FanMode",e)}function T4e(e){Hm(A4e,"Distribution",e)}var Ks=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.fromConfigUsesCustomObjects=function(){return!1},t.prototype.getConfig=function(){return{}},t}(Ne.Serializable),MJ=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n,r){return Tn(n,r)},t.className="Zeros",t}(Ks);Ne.registerClass(MJ);var hP=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n,r){return Wu(n,r)},t.className="Ones",t}(Ks);Ne.registerClass(hP);var PJ=function(e){function t(n){var r=e.call(this)||this;if(typeof n!="object")throw new ie("Expected argument of type ConstantConfig but got "+n);if(n.value===void 0)throw new ie("config must have value set but got "+n);return r.value=n.value,r}return Ee(t,e),t.prototype.apply=function(n,r){var i=this;return le(function(){return rt(Ve(i.value),Wu(n,r))})},t.prototype.getConfig=function(){return{value:this.value}},t.className="Constant",t}(Ks);Ne.registerClass(PJ);var $J=function(e){function t(n){var r=e.call(this)||this;return r.DEFAULT_MINVAL=-.05,r.DEFAULT_MAXVAL=.05,r.minval=n.minval||r.DEFAULT_MINVAL,r.maxval=n.maxval||r.DEFAULT_MAXVAL,r.seed=n.seed,r}return Ee(t,e),t.prototype.apply=function(n,r){return jh(n,this.minval,this.maxval,r)},t.prototype.getConfig=function(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}},t.className="RandomUniform",t}(Ks);Ne.registerClass($J);var LJ=function(e){function t(n){var r=e.call(this)||this;return r.DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=n.mean||r.DEFAULT_MEAN,r.stddev=n.stddev||r.DEFAULT_STDDEV,r.seed=n.seed,r}return Ee(t,e),t.prototype.apply=function(n,r){if((r=r||"float32")!=="float32"&&r!=="int32")throw new $t("randomNormal does not support dType "+r+".");return DE(n,this.mean,this.stddev,r,this.seed)},t.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},t.className="RandomNormal",t}(Ks);Ne.registerClass(LJ);var BJ=function(e){function t(n){var r=e.call(this)||this;return r.DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=n.mean||r.DEFAULT_MEAN,r.stddev=n.stddev||r.DEFAULT_STDDEV,r.seed=n.seed,r}return Ee(t,e),t.prototype.apply=function(n,r){if((r=r||"float32")!=="float32"&&r!=="int32")throw new $t("truncatedNormal does not support dType "+r+".");return yb(n,this.mean,this.stddev,r,this.seed)},t.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},t.className="TruncatedNormal",t}(Ks);Ne.registerClass(BJ);var zJ=function(e){function t(n){var r=e.call(this)||this;return r.gain=n.gain!=null?n.gain:1,r}return Ee(t,e),t.prototype.apply=function(n,r){var i=this;return le(function(){if(n.length!==2||n[0]!==n[1])throw new ie("Identity matrix initializer can only be used for 2D square matrices.");return rt(i.gain,iE(n[0]))})},t.prototype.getConfig=function(){return{gain:this.gain}},t.className="Identity",t}(Ks);function O4e(e,t){var n,r;if(t===void 0&&(t="channelsLast"),Kr(t),e.length===2)n=e[0],r=e[1];else if([3,4,5].indexOf(e.length)!==-1)if(t==="channelsFirst"){var i=qf(e,2);n=e[1]*i,r=e[0]*i}else t==="channelsLast"&&(i=qf(e,0,e.length-2),n=e[e.length-2]*i,r=e[e.length-1]*i);else{var a=qf(e);n=Math.sqrt(a),r=Math.sqrt(a)}return[n,r]}Ne.registerClass(zJ);var no=function(e){function t(n){var r=e.call(this)||this;if(n.scale<0)throw new ie("scale must be a positive float. Got: "+n.scale);return r.scale=n.scale==null?1:n.scale,r.mode=n.mode==null?"fanIn":n.mode,k4e(r.mode),r.distribution=n.distribution==null?"normal":n.distribution,T4e(r.distribution),r.seed=n.seed,r}return Ee(t,e),t.prototype.apply=function(n,r){var i=O4e(n),a=i[0],o=i[1],s=this.scale;if(this.mode==="fanIn"?s/=Math.max(1,a):this.mode==="fanOut"?s/=Math.max(1,o):s/=Math.max(1,(a+o)/2),this.distribution==="normal"){var u=Math.sqrt(s);if((r=r||"float32")!=="float32"&&r!=="int32")throw new $t(this.getClassName()+" does not support dType "+r+".");return yb(n,0,u,r,this.seed)}var l=Math.sqrt(3*s);return jh(n,-l,l,r)},t.prototype.getConfig=function(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}},t.className="VarianceScaling",t}(Ks);Ne.registerClass(no);var pP=function(e){function t(n){return e.call(this,{scale:1,mode:"fanAvg",distribution:"uniform",seed:n==null?null:n.seed})||this}return Ee(t,e),t.prototype.getClassName=function(){return no.className},t.className="GlorotUniform",t}(no);Ne.registerClass(pP);var gP=function(e){function t(n){return e.call(this,{scale:1,mode:"fanAvg",distribution:"normal",seed:n==null?null:n.seed})||this}return Ee(t,e),t.prototype.getClassName=function(){return no.className},t.className="GlorotNormal",t}(no);Ne.registerClass(gP);var mP=function(e){function t(n){return e.call(this,{scale:2,mode:"fanIn",distribution:"normal",seed:n==null?null:n.seed})||this}return Ee(t,e),t.prototype.getClassName=function(){return no.className},t.className="HeNormal",t}(no);Ne.registerClass(mP);var vP=function(e){function t(n){return e.call(this,{scale:2,mode:"fanIn",distribution:"uniform",seed:n==null?null:n.seed})||this}return Ee(t,e),t.prototype.getClassName=function(){return no.className},t.className="HeUniform",t}(no);Ne.registerClass(vP);var yP=function(e){function t(n){return e.call(this,{scale:1,mode:"fanIn",distribution:"normal",seed:n==null?null:n.seed})||this}return Ee(t,e),t.prototype.getClassName=function(){return no.className},t.className="LeCunNormal",t}(no);Ne.registerClass(yP);var bP=function(e){function t(n){return e.call(this,{scale:1,mode:"fanIn",distribution:"uniform",seed:n==null?null:n.seed})||this}return Ee(t,e),t.prototype.getClassName=function(){return no.className},t.className="LeCunNormal",t}(no);Ne.registerClass(bP);var jJ=function(e){function t(n){var r=e.call(this)||this;if(r.DEFAULT_GAIN=1,r.gain=n.gain==null?r.DEFAULT_GAIN:n.gain,r.seed=n.seed,r.seed!=null)throw new $t("Random seed is not implemented for Orthogonal Initializer yet.");return r}return Ee(t,e),t.prototype.apply=function(n,r){var i=this;return le(function(){if(n.length!==2)throw new $t("The Orthogonal Initializer does not support non-2D shapes yet.");n[0]*n[1]>2e3&&console.warn("Orthogonal initializer is being called on a matrix with more than 2000 ("+n[0]*n[1]+") elements: Slowness may result.");var a=DE(n[0]>n[1]?[n[1],n[0]]:n,0,1,"float32"),o=FM.gramSchmidt(a);return n[0]>n[1]&&(o=o.transpose()),rt(i.gain,o)})},t.prototype.getConfig=function(){return{gain:this.gain,seed:this.seed}},t.className="Orthogonal",t}(Ks);Ne.registerClass(jJ);var UJ={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function WJ(e,t){return t===void 0&&(t={}),Ib(e,Ne.SerializationMap.getMap().classNameMap,t,"initializer")}function vn(e){return oP(e)}function nr(e){if(typeof e=="string"){var t=e in UJ?UJ[e]:e;if(t==="GlorotNormal")return new gP;if(t==="GlorotUniform")return new pP;if(t==="HeNormal")return new mP;if(t==="HeUniform")return new vP;if(t==="LeCunNormal")return new yP;if(t==="LeCunUniform")return new bP;var n={};return n.className=t,n.config={},WJ(n)}return e instanceof Ks?e:WJ(e)}function I4e(){return new MJ}function N4e(){return new hP}function D4e(e){return new PJ(e)}function R4e(e){return new $J(e)}function F4e(e){return new LJ(e)}function M4e(e){return new BJ(e)}function P4e(e){return new zJ(e)}function $4e(e){return new no(e)}function L4e(e){return new pP(e)}function B4e(e){return new gP(e)}function z4e(e){return new mP(e)}function j4e(e){return new vP(e)}function U4e(e){return new yP(e)}function W4e(e){return new bP(e)}function V4e(e){return new jJ(e)}Object.freeze({zeros:I4e,ones:N4e,constant:D4e,randomUniform:R4e,randomNormal:F4e,truncatedNormal:M4e,identity:P4e,varianceScaling:$4e,glorotUniform:L4e,glorotNormal:B4e,heNormal:z4e,heUniform:j4e,leCunNormal:U4e,leCunUniform:W4e,orthogonal:V4e});var q4e=0;function VJ(){return q4e++}var RE={};function FE(e){return e===void 0&&(e=""),e in RE||(RE[e]=0),RE[e]+=1,e+RE[e].toString()}function xP(e){return Array.isArray(e)&&Array.isArray(e[0])}function ME(e){return e.length===0?[]:Array.isArray(e[0])?e:[e]}function Dt(e){var t;if(Array.isArray(e)){if(e.length!==1)throw new ie("Expected Tensor length to be 1; got "+e.length);t=e[0]}else t=e;return t}function Kn(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(e.length===1)return(e=e)[0];throw new ie("Expected exactly 1 Shape; got "+e.length)}return e}function PE(e){for(var t=0,n=0,r=e;n<r.length;n++){var i=r[n];i.shape.length===0?t+=1:t+=i.shape.reduce(function(a,o){return a*o})}return t}var qJ="Variable",H4e=function(){function e(t,n,r,i,a){n===void 0&&(n="float32"),r===void 0&&(r=qJ),i===void 0&&(i=!0),a===void 0&&(a=null),this.dtype=n??"float32",this.shape=t.shape,this.id=VJ(),r=r??qJ,this.originalName=kJ(r),this.name=TJ(this.originalName),this.trainable_=i,this.constraint=a,this.val=e3(t,this.trainable_,this.name,this.dtype)}return e.prototype.read=function(){return this.assertNotDisposed(),this.val},e.prototype.write=function(t){return this.assertNotDisposed(),G4e(this.val,t),this.val.id!==t.id&&(this.val.assign(t),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this},e.prototype.dispose=function(){this.assertNotDisposed(),this.val.dispose()},e.prototype.assertNotDisposed=function(){if(this.val.isDisposed)throw new Error("LayersVariable "+this.name+" is already disposed.")},Object.defineProperty(e.prototype,"trainable",{get:function(){return this.trainable_},set:function(t){this.trainable_=t,this.val.trainable=t},enumerable:!0,configurable:!0}),e}();function G4e(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}function wP(e){return e.map(function(t){return t.read()})}function _P(e){e.forEach(function(t){t[0].write(t[1])})}var Fi=function(){return function(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}(),Zu=function(){return function(e,t,n,r,i,a,o){this.dtype=e,this.shape=t,this.sourceLayer=n,this.inputs=r,this.callArgs=i,this.outputTensorIndex=o,this.id=VJ(),a!=null&&(this.originalName=kJ(a),this.name=TJ(this.originalName)),this.rank=t.length}}(),K4e=0,$E=function(){function e(t,n){this.callArgs=n,this.id=K4e++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(var r=0,i=t.inboundLayers;r<i.length;r++){var a=i[r];a!=null&&a.outboundNodes.push(this)}t.outboundLayer.inboundNodes.push(this)}return e.prototype.getConfig=function(){for(var t=[],n=0,r=this.inboundLayers;n<r.length;n++){var i=r[n];i!=null?t.push(i.name):t.push(null)}return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}},e}(),X4e=0,tn=function(e){function t(n){var r=e.call(this)||this;r._callHook=null,r._addedWeightNames=[],r._stateful=!1,r.id=X4e++,r.activityRegularizer=null,r.inputSpec=null,r.supportsMasking=!1,r._trainableWeights=[],r._nonTrainableWeights=[],r._losses=[],r._updates=[],r._built=!1,r.inboundNodes=[],r.outboundNodes=[];var i=n.name;if(!i){var a=r.getClassName();i=fc(a)+"_"+FE(a)}if(r.name=i,r.trainable_=n.trainable==null||n.trainable,n.inputShape!=null||n.batchInputShape!=null){var o=void 0;if(n.batchInputShape!=null)o=n.batchInputShape;else if(n.inputShape!=null){var s=null;n.batchSize!=null&&(s=n.batchSize),o=[s].concat(n.inputShape)}r.batchInputShape=o;var u=n.dtype;u==null&&(u=n.inputDType),u==null&&(u="float32"),r.dtype=u}return n.weights!=null?r.initialWeights=n.weights:r.initialWeights=null,r._refCount=null,r.fastWeightInitDuringBuild=!1,r}return Ee(t,e),t.nodeKey=function(n,r){return n.name+"_ib-"+r.toString()},t.prototype.getNodeAtIndex=function(n,r){if(this.inboundNodes.length===0)throw new Xu("The layer has never been called and thus has no defined "+r+".");if(this.inboundNodes.length<=n)throw new ie("Asked to get "+r+" at node "+n+", but the layer has only "+this.inboundNodes.length+" inbound nodes.");return this.inboundNodes[n]},t.prototype.getInputAt=function(n){return _a(this.getNodeAtIndex(n,"input").inputTensors)},t.prototype.getOutputAt=function(n){return _a(this.getNodeAtIndex(n,"output").outputTensors)},Object.defineProperty(t.prototype,"input",{get:function(){if(this.inboundNodes.length>1)throw new Hh("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(this.inboundNodes.length===0)throw new Hh("Layer "+this.name+" is not connected, no input to return.");return _a(this.getNodeAtIndex(0,"input").inputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"output",{get:function(){if(this.inboundNodes.length===0)throw new Hh("Layer "+this.name+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new Hh("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return _a(this.getNodeAtIndex(0,"output").outputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"losses",{get:function(){return this._losses},enumerable:!0,configurable:!0}),t.prototype.calculateLosses=function(){return this.losses.map(function(n){return n()})},Object.defineProperty(t.prototype,"updates",{get:function(){return this._updates},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"built",{get:function(){return this._built},set:function(n){this._built=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trainable",{get:function(){return this.trainable_},set:function(n){this._trainableWeights.forEach(function(r){return r.trainable=n}),this.trainable_=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.trainable_?this._trainableWeights.filter(function(n){return n.trainable}):[]},set:function(n){this._trainableWeights=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this._trainableWeights.filter(function(n){return!n.trainable}).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)},set:function(n){this._nonTrainableWeights=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stateful",{get:function(){return this._stateful},enumerable:!0,configurable:!0}),t.prototype.resetStates=function(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")},t.prototype.assertInputCompatibility=function(n){if(n=Jn(n),this.inputSpec!=null&&this.inputSpec.length!==0){var r=Jn(this.inputSpec);if(n.length!==r.length)throw new ie("Layer "+this.name+" expects "+r.length+" inputs, but it received "+n.length+" input tensors. Input received: "+n);for(var i=0;i<n.length;i++){var a=n[i],o=r[i];if(o!=null){var s=a.rank;if(o.ndim!=null&&s!==o.ndim)throw new ie("Input "+i+" is incompatible with layer "+this.name+": expected ndim="+o.ndim+", found ndim="+s);if(o.maxNDim!=null&&s>o.maxNDim)throw new ie("Input "+i+" is incompatible with layer "+this.name+": expected max_ndim="+o.maxNDim+", found ndim="+s);if(o.minNDim!=null&&s<o.minNDim)throw new ie("Input "+i+" is incompatible with layer "+this.name+": expected min_ndim="+o.minNDim+", found ndim="+s+".");if(o.dtype!=null&&a.dtype!==o.dtype)throw new ie("Input "+i+" is incompatible with layer "+this.name+" : expected dtype="+o.dtype+", found dtype="+a.dtype+".");if(o.axes){var u=a.shape;for(var l in o.axes){var c=Number(l),f=o.axes[l],d=c>=0?u[c]:u[u.length+c];if(f!=null&&[f,null].indexOf(d)===-1)throw new ie("Input "+i+" is incompatible with layer "+this.name+": expected axis "+c+" of input shape to have value "+f+" but got shape "+u+".")}}if(o.shape!=null)for(var h=0;h<o.shape.length;++h){var p=o.shape[h],g=a.shape[h];if(p!=null&&g!=null&&p!==g)throw new ie("Input "+i+" is incompatible with layer "+this.name+": expected shape="+o.shape+", found shape="+a.shape+".")}}}}},t.prototype.call=function(n,r){return n},t.prototype.invokeCallHook=function(n,r){this._callHook!=null&&this._callHook(n,r)},t.prototype.setCallHook=function(n){this._callHook=n},t.prototype.clearCallHook=function(){this._callHook=null},t.prototype.apply=function(n,r){var i=this;r=r||{},this.assertNotDisposed();for(var a=Jn(n),o=!0,s=0,u=a;s<u.length;s++)if(!(u[s]instanceof Zu)){o=!1;break}for(var l=!0,c=0,f=a;c<f.length;c++)if(f[c]instanceof Zu){l=!1;break}if(o===l)throw new ie("Arguments to apply() must be all SymbolicTensors or all Tensors");return Xh(this.name,function(){if(!i.built){i.assertInputCompatibility(n);for(var d=[],h=0,p=Jn(n);h<p.length;h++){var g=p[h];d.push(g.shape)}i.build(_a(d)),i.built=!0,i.initialWeights&&i.setWeights(i.initialWeights),i._refCount===null&&l&&(i._refCount=1)}if(i.assertInputCompatibility(n),l){for(var m=[],v=0,y=Jn(S=i.call(n,r));v<y.length;v++){var b=y[v];a.indexOf(b)!==-1&&(b=b.clone()),m.push(b)}if(S=_a(m),i.activityRegularizer!=null)throw new $t("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return S}var x=Y4e(n),w=i.computeOutputShape(x),S=void 0,C=Z4e(n);if(i.warnOnIncompatibleInputShape(Array.isArray(n)?x[0]:x),S=w!=null&&w.length>0&&Array.isArray(w[0])?w.map(function(_,E){return new Zu(C,_,i,Jn(n),r,i.name,E)}):new Zu(C,w,i,Jn(n),r,i.name),i.addInboundNode(n,S,null,null,x,w,r),i._refCount++,i.activityRegularizer!=null)throw new $t("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return S})},t.prototype.warnOnIncompatibleInputShape=function(n){if(this.batchInputShape!=null)if(n.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+JSON.stringify(n)+") does not match that of the batchInputShape ("+JSON.stringify(this.batchInputShape)+") of the layer "+this.name);else{var r=!1;this.batchInputShape.forEach(function(i,a){i!=null&&n[a]!=null&&n[a]!==i&&(r=!0)}),r&&console.warn("The shape of the input tensor ("+JSON.stringify(n)+") does not match the expectation of layer "+this.name+": "+JSON.stringify(this.batchInputShape))}},Object.defineProperty(t.prototype,"outputShape",{get:function(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new Hh("The layer "+this.name+" has never been called and thus has no defined output shape.");for(var n=[],r=0,i=this.inboundNodes;r<i.length;r++){var a=i[r],o=JSON.stringify(a.outputShapes);n.indexOf(o)===-1&&n.push(o)}if(n.length===1){var s=this.inboundNodes[0].outputShapes;return Array.isArray(s)&&Array.isArray(s[0])&&s.length===1?s[0]:s}throw new Hh("The layer "+this.name+' has multiple inbound nodes with different output shapes. Hence the notion of "outut shape" is ill-defined for the layer.')},enumerable:!0,configurable:!0}),t.prototype.countParams=function(){if(!this.built)throw new Xu("You tried to call countParams() on "+this.name+", but the layer is not built yet. Build it first by calling build(batchInputShape).");return PE(this.weights)},t.prototype.build=function(n){this.built=!0},t.prototype.getWeights=function(n){return n===void 0&&(n=!1),wP(n?this.trainableWeights:this.weights)},t.prototype.setWeights=function(n){var r=this;le(function(){var i=r.weights;if(i.length!==n.length)throw new ie('You called setWeights(weights) on layer "'+r.name+'" with a weight list of length '+n.length+", but the layer was expecting "+i.length+" weights. Provided weights: "+n+"...");if(i.length!==0){for(var a=[],o=wP(i),s=0;s<o.length;++s){var u=o[s],l=i[s],c=n[s];if(!pt.arraysEqual(u.shape,c.shape))throw new ie("Layer weight shape "+u.shape+" not compatible with provided weight shape "+c.shape);a.push([l,c])}_P(a)}})},t.prototype.addWeight=function(n,r,i,a,o,s,u){if(this._addedWeightNames.indexOf(n)!==-1)throw new ie("Duplicate weight name "+n+" for layer "+this.name);this._addedWeightNames.push(n),i==null&&(i="float32"),this.fastWeightInitDuringBuild&&(a=nr("zeros"));var l=a.apply(r,i),c=new H4e(l,i,n,s,u);return l.dispose(),o!=null&&this.addLoss(function(){return o.apply(c.read())}),s==null&&(s=!0),s?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c},t.prototype.setFastWeightInitDuringBuild=function(n){this.fastWeightInitDuringBuild=n},t.prototype.addLoss=function(n){var r;n==null||Array.isArray(n)&&n.length===0||(n=Jn(n),this._losses!==void 0&&this._losses!==null&&(r=this.losses).push.apply(r,n))},t.prototype.computeOutputShape=function(n){return n},t.prototype.computeMask=function(n,r){var i=this;if(!this.supportsMasking){if(r!=null){if(!Array.isArray(r))throw new TypeError("Layer "+this.name+" does not support masking, but was passed an inputMask.");r.forEach(function(a){if(a!=null)throw new TypeError("Layer "+i.name+" does not support masking, but was passed an inputMask.")})}return null}return r},t.prototype.addInboundNode=function(n,r,i,a,o,s,u){u===void 0&&(u=null);var l=Jn(n);r=Jn(r),i=Jn(i),a=Jn(a),o=ME(o),s=ME(s);for(var c=[],f=[],d=[],h=0,p=l;h<p.length;h++){var g=p[h];c.push(g.sourceLayer),f.push(g.nodeIndex),d.push(g.tensorIndex)}new $E({outboundLayer:this,inboundLayers:c,nodeIndices:f,tensorIndices:d,inputTensors:l,outputTensors:r,inputMasks:i,outputMasks:a,inputShapes:o,outputShapes:s},u);for(var m=0;m<r.length;m++)r[m].sourceLayer=this,r[m].nodeIndex=this.inboundNodes.length-1,r[m].tensorIndex=m},t.prototype.getConfig=function(){var n={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(n.batchInputShape=this.batchInputShape),this.dtype!=null&&(n.dtype=this.dtype),n},t.prototype.disposeWeights=function(){return this.weights.forEach(function(n){return n.dispose()}),this.weights.length},t.prototype.assertNotDisposed=function(){if(this._refCount===0)throw new Error("Layer '"+this.name+"' is already disposed.")},t.prototype.dispose=function(){if(!this.built)throw new Error("Cannot dispose Layer "+this.name+" because it has not been built yet.");if(this._refCount===null)throw new Error("Cannot dispose Layer "+this.name+" because it has not been used yet.");this.assertNotDisposed();var n=0;return--this._refCount==0&&(n=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:n}},t}(Ne.Serializable);function Y4e(e){for(var t=[],n=0,r=e=Jn(e);n<r.length;n++){var i=r[n];t.push(i.shape)}return _a(t)}function Z4e(e){return"float32"}function HJ(e,t,n){if((t==null||n!=null&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),t.inboundNodes.length===0)return[e];var r=t.inboundNodes[n];if(r.inboundLayers.length===0)return r.inputTensors;for(var i=[],a=0;a<r.inboundLayers.length;a++)for(var o=0,s=HJ(r.inputTensors[a],r.inboundLayers[a],r.nodeIndices[a]);o<s.length;o++){var u=s[o];i.indexOf(u)===-1&&i.push(u)}return i}var GJ,Pb=function(e){function t(n){var r=e.call(this,{dtype:n.dtype,name:n.name!=null?n.name:FE("input").toString()})||this;if(n.batchSize==null&&(n.batchSize=null),n.sparse==null&&(n.sparse=!1),r.trainable=!1,r.built=!0,r.sparse=n.sparse,n.inputShape!=null&&n.batchInputShape!=null)throw new ie("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");var i=n.batchInputShape;if(i==null){if(n.inputShape==null)throw new ie("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");i=[n.batchSize].concat(n.inputShape)}else if(n.batchSize!=null)throw new ie("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");var a=n.dtype||"float32";r.batchInputShape=i,r.dtype=a,r.inputSpec=[{shape:i}];var o=new Zu(r.dtype,r.batchInputShape,r,[],{},r.name);return o.nodeIndex=0,o.tensorIndex=0,new $E({outboundLayer:r,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[o],outputTensors:[o],inputMasks:[null],outputMasks:[null],inputShapes:[i],outputShapes:[i]}),r}return Ee(t,e),t.prototype.apply=function(n,r){throw new ie("Cannot pass any input to an InputLayer's apply() method. InputLayer name: "+this.name)},t.prototype.dispose=function(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}},t.prototype.getConfig=function(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}},t.className="InputLayer",t}(tn);function KJ(e){if(e.batchShape==null&&e.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(e.batchShape!=null&&e.shape!=null)throw new ie("Please provide either a `shape` or `batchShape` argument to Input, but not both.");var t=e.batchShape;e.shape!=null&&t==null&&(t=[null].concat(e.shape));var n=e.dtype;return n==null&&(n="float32"),new Pb({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}function Gf(e){return At(this,void 0,void 0,function(){var t,n,r,i,a,o,s,u;return St(this,function(l){switch(l.label){case 0:if(e==null)return[2];for(i in t=[],n=[],r=[],e)typeof(a=e[i])!="number"&&(o=a,t.push(o.data()),n.push(i),r.push(o));return t.length>0?[4,Promise.all(t)]:[3,2];case 1:for(s=l.sent(),u=0;u<s.length;++u)e[n[u]]=s[u][0];Ut(r),l.label=2;case 2:return[2]}})})}function XJ(e){if(e!=null)for(var t in e){var n=e[t];typeof n!="number"&&n.dispose()}}Ne.registerClass(Pb),function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"}(GJ||(GJ={}));var J4e=125,Ym=function(){function e(){this.validationData=null}return e.prototype.setParams=function(t){this.params=t},e.prototype.onEpochBegin=function(t,n){return At(this,void 0,void 0,function(){return St(this,function(r){return[2]})})},e.prototype.onEpochEnd=function(t,n){return At(this,void 0,void 0,function(){return St(this,function(r){return[2]})})},e.prototype.onBatchBegin=function(t,n){return At(this,void 0,void 0,function(){return St(this,function(r){return[2]})})},e.prototype.onBatchEnd=function(t,n){return At(this,void 0,void 0,function(){return St(this,function(r){return[2]})})},e.prototype.onTrainBegin=function(t){return At(this,void 0,void 0,function(){return St(this,function(n){return[2]})})},e.prototype.onTrainEnd=function(t){return At(this,void 0,void 0,function(){return St(this,function(n){return[2]})})},e.prototype.setModel=function(t){},e}(),Q4e=function(){function e(t,n){n===void 0&&(n=10),t==null&&(t=[]),this.callbacks=t,this.queueLength=n}return e.prototype.append=function(t){this.callbacks.push(t)},e.prototype.setParams=function(t){for(var n=0,r=this.callbacks;n<r.length;n++)r[n].setParams(t)},e.prototype.setModel=function(t){for(var n=0,r=this.callbacks;n<r.length;n++)r[n].setModel(t)},e.prototype.onEpochBegin=function(t,n){return At(this,void 0,void 0,function(){var r,i;return St(this,function(a){switch(a.label){case 0:n==null&&(n={}),r=0,i=this.callbacks,a.label=1;case 1:return r<i.length?[4,i[r].onEpochBegin(t,n)]:[3,4];case 2:a.sent(),a.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},e.prototype.onEpochEnd=function(t,n){return At(this,void 0,void 0,function(){var r,i;return St(this,function(a){switch(a.label){case 0:n==null&&(n={}),r=0,i=this.callbacks,a.label=1;case 1:return r<i.length?[4,i[r].onEpochEnd(t,n)]:[3,4];case 2:a.sent(),a.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},e.prototype.onBatchBegin=function(t,n){return At(this,void 0,void 0,function(){var r,i;return St(this,function(a){switch(a.label){case 0:n==null&&(n={}),r=0,i=this.callbacks,a.label=1;case 1:return r<i.length?[4,i[r].onBatchBegin(t,n)]:[3,4];case 2:a.sent(),a.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},e.prototype.onBatchEnd=function(t,n){return At(this,void 0,void 0,function(){var r,i;return St(this,function(a){switch(a.label){case 0:n==null&&(n={}),r=0,i=this.callbacks,a.label=1;case 1:return r<i.length?[4,i[r].onBatchEnd(t,n)]:[3,4];case 2:a.sent(),a.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},e.prototype.onTrainBegin=function(t){return At(this,void 0,void 0,function(){var n,r;return St(this,function(i){switch(i.label){case 0:t==null&&(t={}),n=0,r=this.callbacks,i.label=1;case 1:return n<r.length?[4,r[n].onTrainBegin(t)]:[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},e.prototype.onTrainEnd=function(t){return At(this,void 0,void 0,function(){var n,r;return St(this,function(i){switch(i.label){case 0:t==null&&(t={}),n=0,r=this.callbacks,i.label=1;case 1:return n<r.length?[4,r[n].onTrainEnd(t)]:[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},e}(),eLe=function(e){function t(){return e.call(this)||this}return Ee(t,e),t.prototype.onEpochBegin=function(n){return At(this,void 0,void 0,function(){return St(this,function(r){return this.seen=0,this.totals={},[2]})})},t.prototype.onBatchEnd=function(n,r){return At(this,void 0,void 0,function(){var i,a,o,s,u=this;return St(this,function(l){for(s in r==null&&(r={}),i=r.size==null?0:r.size,this.seen+=i,a=function(c){var f=r[c];if(typeof f=="number")o.totals.hasOwnProperty(c)||(o.totals[c]=0),o.totals[c]=o.totals[c]+f*i;else{var d=void 0;c in o.totals?d=o.totals[c]:o.totals[c]=0;var h=le(function(){return Wt(u.totals[c],rt(f,i))});o.totals[c]=h,d!=null&&d.dispose()}},o=this,r)a(s);return[2]})})},t.prototype.onEpochEnd=function(n,r){return At(this,void 0,void 0,function(){var i,a,o,s,u,l=this;return St(this,function(c){if(r!=null)for(i=function(f){if(a.totals[f]==null)return"continue";typeof a.totals[f]=="number"?r[f]=a.totals[f]/a.seen:le(function(){var d=rt(Cr(1,l.seen),l.totals[f]);r[f]=d,l.totals[f].dispose(),zu(r[f])})},a=this,o=0,s=this.params.metrics;o<s.length;o++)u=s[o],i(u);return[2]})})},t}(Ym),tLe=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.onTrainBegin=function(n){return At(this,void 0,void 0,function(){return St(this,function(r){return this.epoch=[],this.history={},[2]})})},t.prototype.onEpochEnd=function(n,r){return At(this,void 0,void 0,function(){var i;return St(this,function(a){for(i in r==null&&(r={}),this.epoch.push(n),r)this.history[i]==null&&(this.history[i]=[]),this.history[i].push(r[i]);return[2]})})},t.prototype.syncData=function(){return At(this,void 0,void 0,function(){var n,r,i,a,o,s,u,l,c;return St(this,function(f){switch(f.label){case 0:for(a in n=[],r=[],i=[],this.history)for(o=this.history[a],s=0;s<o.length;++s)typeof o[s]!="number"&&(u=o[s],n.push(u.data()),r.push(a),i.push(s));return[4,Promise.all(n)];case 1:for(l=f.sent(),c=0;c<l.length;++c)this.history[r[c]][i[c]].dispose(),this.history[r[c]][i[c]]=l[c][0];return[2]}})})},t}(Ym),nLe=function(e){function t(n,r){var i=e.call(this)||this;if(i.currentEpoch=0,i.yieldEvery=r||"auto",i.yieldEvery==="auto"&&(i.yieldEvery=J4e),i.yieldEvery==="never"&&n.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");return pt.isNumber(i.yieldEvery)&&(i.maybeWait=s4e(i.maybeWait.bind(i),i.yieldEvery)),i.trainBegin=n.onTrainBegin,i.trainEnd=n.onTrainEnd,i.epochBegin=n.onEpochBegin,i.epochEnd=n.onEpochEnd,i.batchBegin=n.onBatchBegin,i.batchEnd=n.onBatchEnd,i.yield=n.onYield,i}return Ee(t,e),t.prototype.maybeWait=function(n,r,i){return At(this,void 0,void 0,function(){var a;return St(this,function(o){switch(o.label){case 0:return a=[],this.yield==null?[3,2]:[4,Gf(i)];case 1:o.sent(),a.push(this.yield(n,r,i)),o.label=2;case 2:return a.push(OE()),[4,Promise.all(a)];case 3:return o.sent(),[2]}})})},t.prototype.onEpochBegin=function(n,r){return At(this,void 0,void 0,function(){return St(this,function(i){switch(i.label){case 0:return this.currentEpoch=n,this.epochBegin==null?[3,3]:[4,Gf(r)];case 1:return i.sent(),[4,this.epochBegin(n,r)];case 2:i.sent(),i.label=3;case 3:return[2]}})})},t.prototype.onEpochEnd=function(n,r){return At(this,void 0,void 0,function(){var i;return St(this,function(a){switch(a.label){case 0:return i=[],this.epochEnd==null?[3,2]:[4,Gf(r)];case 1:a.sent(),i.push(this.epochEnd(n,r)),a.label=2;case 2:return this.yieldEvery==="epoch"&&i.push(OE()),[4,Promise.all(i)];case 3:return a.sent(),[2]}})})},t.prototype.onBatchBegin=function(n,r){return At(this,void 0,void 0,function(){return St(this,function(i){switch(i.label){case 0:return this.batchBegin==null?[3,3]:[4,Gf(r)];case 1:return i.sent(),[4,this.batchBegin(n,r)];case 2:i.sent(),i.label=3;case 3:return[2]}})})},t.prototype.onBatchEnd=function(n,r){return At(this,void 0,void 0,function(){var i;return St(this,function(a){switch(a.label){case 0:return i=[],this.batchEnd==null?[3,2]:[4,Gf(r)];case 1:a.sent(),i.push(this.batchEnd(n,r)),a.label=2;case 2:return this.yieldEvery==="batch"?i.push(OE()):pt.isNumber(this.yieldEvery)&&i.push(this.maybeWait(this.currentEpoch,n,r)),[4,Promise.all(i)];case 3:return a.sent(),[2]}})})},t.prototype.onTrainBegin=function(n){return At(this,void 0,void 0,function(){return St(this,function(r){switch(r.label){case 0:return this.trainBegin==null?[3,3]:[4,Gf(n)];case 1:return r.sent(),[4,this.trainBegin(n)];case 2:r.sent(),r.label=3;case 3:return[2]}})})},t.prototype.onTrainEnd=function(n){return At(this,void 0,void 0,function(){return St(this,function(r){switch(r.label){case 0:return this.trainEnd==null?[3,3]:[4,Gf(n)];case 1:return r.sent(),[4,this.trainEnd(n)];case 2:r.sent(),r.label=3;case 3:return[2]}})})},t}(Ym);function YJ(e,t){return e==null&&(e={}),e instanceof Ym?[e]:Array.isArray(e)&&e[0]instanceof Ym?e:Jn(e).map(function(n){return new nLe(n,t)})}var rLe=function(){function e(){}return e.registerCallbackConstructor=function(t,n){pt.assert(t>=0&&Number.isInteger(t),function(){return"Verbosity level is expected to be an integer >= 0, but got "+t}),e.checkForDuplicate(n),e.constructors[t]==null&&(e.constructors[t]=[]),e.constructors[t].push(n)},e.checkForDuplicate=function(t){for(var n in e.constructors)e.constructors[+n].forEach(function(r){if(r===t)throw new ie("Duplicate callback constructor.")})},e.clear=function(){e.constructors={}},e.createCallbacks=function(t){var n=[];for(var r in e.constructors){var i=+r;t>=i&&n.push.apply(n,e.constructors[i])}return n.map(function(a){return new a})},e.constructors={},e}();function ZJ(e,t,n,r,i,a,o,s,u){var l=new tLe,c=[new eLe].concat(rLe.createCallbacks(t));e!=null&&c.push.apply(c,e),c.push(l);var f=new Q4e(c);return f.setParams({epochs:n,initialEpoch:r,samples:i,steps:a,batchSize:o,verbose:t,doValidation:s,metrics:u}),{callbackList:f,history:l}}function Xs(e,t,n){return t===void 0&&(t={}),n===void 0&&(n=!1),Ib(e,Ne.SerializationMap.getMap().classNameMap,t,"layer",n)}function LE(e,t){return le(function(){e.dtype!=="float32"&&(e=e.asType("float32"));var n=qr(Mb(e),t,!0),r=Em(n.shape,Hr()),i=lb(Vu(n,r));return Cr(e,i)})}function Zh(e,t){return le(function(){return Fr(Mb(Er(t,e)),-1)})}function BE(e,t){return le(function(){return Fr(Df(Er(t,e)),-1)})}function Zm(e,t){return le(function(){var n=Er(e,t),r=xa(Df(e),Hr(),Number.MAX_VALUE),i=Df(Cr(n,r));return rt(100,Fr(i,-1))})}function iLe(e,t){return le(function(){var n=xa(t,Hr(),Number.MAX_VALUE),r=oc(Wt(1,n)),i=xa(e,Hr(),Number.MAX_VALUE),a=oc(Wt(1,i));return Fr(Mb(Er(r,a)),-1)})}function aLe(e,t){return le(function(){var n=Vu(0,Er(1,rt(e,t)));return Fr(Mb(n),-1)})}function oLe(e,t){return le(function(){var n=Vu(0,Er(1,rt(e,t)));return Fr(n,-1)})}function sLe(e,t){return le(function(){var n=qr(rt(e,t),-1),r=Pf(rt(Er(1,e),t),-1);return Vu(0,Wt(1,Er(r,n)))})}function uLe(e,t){return le(function(){var n=Math.log(2),r=Er(t,e),i=Er(Wt(r,ub(rt(-2,r))),n);return Fr(i,-1)})}function $b(e,t,n){return n===void 0&&(n=!1),le(function(){if(n)t=Rh(t);else{var r=qr(t,t.shape.length-1,!0);t=Cr(t,r)}return t=xa(t,Hr(),1-Hr()),Rf(qr(rt(e.toFloat(),oc(t)),t.shape.length-1))})}function zE(e,t){return le(function(){var n=MS(x4e(e)).toInt(),r=(t=xa(t,Hr(),1-Hr())).shape;return $b(zh(n,r[r.length-1]).reshape(r),t,!1)})}function lLe(e,t){if(!pt.arraysEqual(e.shape,t.shape))throw new ie("logits and labels must have the same shape, but got shapes "+JSON.stringify(e.shape)+" and "+JSON.stringify(t.shape));return le(function(){var n=t.relu(),r=t.abs().neg();return n.sub(t.mul(e)).add(r.exp().log1p())})}function jE(e,t){return le(function(){var n;return n=xa(t,Hr(),1-Hr()),n=oc(Cr(n,Er(1,n))),Fr(lLe(e,n),-1)})}function cLe(e,t){return le(function(){var n=xa(e,Hr(),1),r=xa(t,Hr(),1);return qr(rt(e,oc(Cr(n,r))),-1)})}function fLe(e,t){return le(function(){var n=oc(Wt(Hr(),t));return Fr(Er(t,rt(e,n)),-1)})}function SP(e,t){return le(function(){var n=LE(e,-1),r=LE(t,-1),i=rt(n,r);return Rf(qr(i,-1))})}var UE={meanSquaredError:Zh,meanAbsoluteError:BE,meanAbsolutePercentageError:Zm,meanSquaredLogarithmicError:iLe,squaredHinge:aLe,hinge:oLe,categoricalHinge:sLe,logcosh:uLe,categoricalCrossentropy:$b,sparseCategoricalCrossentropy:zE,binaryCrossentropy:jE,kullbackLeiblerDivergence:cLe,poisson:fLe,cosineProximity:SP};function EP(e){if(typeof e=="string"){if(e in UE)return UE[e];var t="Unknown loss "+e;throw e.toLowerCase().includes("softmaxcrossentropy")&&(t="Unknown loss "+e+'. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new ie(t)}return e}function CP(e,t){return le(function(){var n=rt(.5,No(t)),r=Rb(Rm(t,n),e.dtype);return Fr(Uh(e,r),-1)})}function AP(e,t){return le(function(){return Rb(Uh(Sb(e,-1),Sb(t,-1)),"float32")})}function JJ(e,t){return le(function(){return Hu(e.equal(1),t.equal(1)).sum().cast("float32")})}function dLe(e,t){return le(function(){return Hu(e.equal(1),t.equal(0)).sum().cast("float32")})}function hLe(e,t){return le(function(){return Hu(e.equal(0),t.equal(1)).sum().cast("float32")})}function QJ(e,t){return le(function(){var n=JJ(e,t),r=hLe(e,t),i=n.add(r);return qs(Rm(i,0),n.div(i),0).cast("float32")})}function pLe(e,t){return le(function(){var n=JJ(e,t),r=dLe(e,t),i=n.add(r);return qs(Rm(i,0),n.div(i),0).cast("float32")})}function eQ(e,t){return jE(e,t)}function tQ(e,t){return e.rank===t.rank&&(e=e.squeeze([e.rank-1])),(t=t.argMax(-1)).dtype!==e.dtype&&(t=t.asType(e.dtype)),Uh(e,t).asType("float32")}var gLe=Zh,mLe=Zh,vLe=BE,yLe=BE,bLe=Zm,xLe=Zm,kP=$b,wLe=SP,nQ=zE,WE={binaryAccuracy:CP,categoricalAccuracy:AP,precision:QJ,categoricalCrossentropy:kP,sparseCategoricalCrossentropy:nQ,mse:gLe,MSE:mLe,mae:vLe,MAE:yLe,mape:bLe,MAPE:xLe,cosine:wLe};function _Le(e){if(typeof e=="string"&&e in WE)return WE[e];if(typeof e!="string"&&e!=null)return e;throw new ie("Unknown metric "+e)}function VE(e){if(Yu(e!==null,"Unknown LossOrMetricFn "+e),typeof e=="string")return e;for(var t=void 0,n=0,r=Object.keys(UE);n<r.length;n++){var i=r[n];if(UE[i]===e){t=i;break}}if(t!==void 0)return t;for(var a=0,o=Object.keys(WE);a<o.length;a++)if(i=o[a],WE[i]===e){t=i;break}return t!==void 0?t:e.name}function SLe(e){var t={Adagrad:function(){return Wf.adagrad(.01)},Adadelta:function(){return Wf.adadelta(1,.95,Hr())},Adam:function(){return Wf.adam(.001,.9,.999,Hr())},Adamax:function(){return Wf.adamax(.002,.9,.999,Hr(),0)},RMSProp:function(){return Wf.rmsprop(.001,.9,0,Hr())},SGD:function(){return Wf.sgd(.01)}};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new ie("Unknown Optimizer "+e)}var rQ=1048576;function iQ(e,t,n){if(n===void 0&&(n=!1),e==null||typeof e!="object"||Object.getPrototypeOf(e)!==Object.prototype||!TP(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){var r=JSON.stringify(e);r.length>rQ&&console.warn('User-defined metadata of model "'+t+'" is too large in size (length='+r.length+" when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= "+rQ+".")}}function TP(e){if(e===null)return!0;if(typeof e=="object"){if(Object.getPrototypeOf(e)===Object.prototype){for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t];if(typeof r!="string"||!TP(e[r]))return!1}return!0}if(Array.isArray(e)){for(var i=0,a=e;i<a.length;i++)if(!TP(a[i]))return!1;return!0}return!1}var o=typeof e;return o==="string"||o==="number"||o==="boolean"}function ELe(e,t,n,r){r===void 0&&(r=console.log);var i,a=ALe(e),o=["Layer (type)","Output shape","Param #"];if(a?(t=t||65,n=n||[.45,.85,1]):(t=t||98,n=n||[.33,.55,.67,1]),n[n.length-1]<=1&&(n=n.map(function(d){return Math.floor(t*d)})),!a)for(var s in o.push("Receives inputs"),i=[],e.nodesByDepth)i.push.apply(i,e.nodesByDepth[s]);r("_".repeat(t)),qE(o,n,r),r("=".repeat(t));for(var u=e.layers,l=0;l<u.length;++l)a?kLe(u[l],n,r):TLe(u[l],n,i,r),r((l===u.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();var c=CLe(e),f=PE(e.nonTrainableWeights);r("Total params: "+(c+f)),r("Trainable params: "+c),r("Non-trainable params: "+f),r("_".repeat(t))}function CLe(e){return e.collectedTrainableWeights!=null?PE(e.collectedTrainableWeights):PE(e.trainableWeights)}function ALe(e){var t=!0,n=[],r=[];for(var i in e.nodesByDepth)n.push(e.nodesByDepth[i]);for(var a=0,o=n;a<o.length;a++){var s=o[a];if(s.length>1||s.length===1&&s[0].inboundLayers.length>1){t=!1;break}r.push.apply(r,s)}if(t)for(var u=0,l=e.layers;u<l.length;u++){for(var c=!1,f=0,d=l[u].inboundNodes;f<d.length;f++){var h=d[f];if(r.indexOf(h)!==-1){if(c){t=!1;break}c=!0}}if(!t)break}return t}function qE(e,t,n){n===void 0&&(n=console.log);for(var r="",i=0;i<e.length;++i)i>0&&(r=r.slice(0,r.length-1)+" "),r=(r+=e[i]).slice(0,t[i]),r+=" ".repeat(t[i]-r.length);n(r)}function kLe(e,t,n){var r;try{r=JSON.stringify(e.outputShape)}catch(i){r="multiple"}qE([e.name+" ("+e.getClassName()+")",r,e.countParams().toString()],t,n)}function TLe(e,t,n,r){var i;try{i=JSON.stringify(e.outputShape)}catch(m){i="multiple"}for(var a=[],o=0,s=e.inboundNodes;o<s.length;o++){var u=s[o];if(!(n!=null&&n.length>0&&n.indexOf(u)===-1))for(var l=0;l<u.inboundLayers.length;++l){var c=u.inboundLayers[l].name,f=u.nodeIndices[l],d=u.tensorIndices[l];a.push(c+"["+f+"]["+d+"]")}}var h=e.name,p=e.getClassName(),g=a.length===0?"":a[0];for(qE([h+" ("+p+")",i,e.countParams().toString(),g],t,r),l=1;l<a.length;++l)qE(["","","",a[l]],t,r)}function aQ(e,t,n){return(e==="inboundNodes"||e==="outputLayers"||e==="inputLayers")&&t===0&&typeof n=="string"}function Lb(e,t){if(e===null)return null;if(typeof e=="string")return Kh(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){for(var n=[],r=e.length,i=0;i<r;++i){var a=e[i];aQ(t,i,a)?n.push(a):n.push(Lb(a,t))}return n}for(var o={},s=0,u=Object.keys(e);s<u.length;s++){var l=u[s],c=e[l];if(l==="name"&&typeof c=="string")o[l]=c;else{var f=Kh(l);o[f]=Lb(c,f)}}return o}function OP(e,t){if(e==null)return null;if(typeof e=="string")return fc(e);if(typeof e=="number"||typeof e=="boolean")return e;if(e instanceof Array){for(var n=[],r=e.length,i=0;i<r;++i){var a=e[i];aQ(t,i,a)?n.push(a):n.push(OP(a,t))}return n}for(var o={},s=0,u=Object.keys(e);s<u.length;s++){var l=u[s],c=e[l],f=fc(l);o[f]=l!=="name"&&l!=="className"||typeof c!="string"?OP(c,l):c}return o}var oQ="1.7.4";function OLe(e,t){if(e.dtype==null||e.dtype===t.dtype)return t;try{return IS(t,e.dtype)}catch(n){throw new ie("The dtype of the feed ("+t.dtype+") can not be cast to the dtype of the key '"+e.name+"' ("+e.dtype+").")}}var Jm=function(){function e(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof e)for(var n in t.id2Value)this.id2Value[n]=t.id2Value[n],n in t.id2Mask&&(this.id2Mask[n]=t.id2Mask[n]);else{if(t==null)return;for(var r=0,i=t;r<i.length;r++){var a=i[r];this.add(a.key,a.value)}}}return e.prototype.add=function(t,n,r){if(this.id2Value[t.id]!=null)throw new ie("Duplicate key: name="+t.name+", id="+t.id);return this.id2Value[t.id]=OLe(t,n),this.name2Id[t.name]=t.id,r!=null&&(this.id2Mask[t.id]=r),this},e.prototype.addFeed=function(t){this.add(t.key,t.value)},e.prototype.hasKey=function(t){return this.id2Value[t.id]!=null},e.prototype.names=function(){return Object.keys(this.name2Id)},e.prototype.getValue=function(t){if(t instanceof Zu){if(this.id2Value[t.id]==null)throw new ie("Nonexistent key: "+t.name);return this.id2Value[t.id]}var n=this.name2Id[t];if(n==null)throw new ie("Feed dict has no SymbolicTensor name: "+t);return this.id2Value[n]},e.prototype.getMask=function(t){if(t instanceof Zu){if(this.id2Value[t.id]==null)throw new ie("Nonexistent key: "+t.name);return this.id2Mask[t.id]}var n=this.name2Id[t];if(n==null)throw new ie("Feed dict has no SymbolicTensor name: "+t);return this.id2Mask[n]},e.prototype.disposeMasks=function(){this.id2Mask!=null&&Ut(this.id2Mask)},e}(),IP={},sQ={};function Bb(e,t,n,r){for(var i=n!=null&&n.training,a=Array.isArray(e),o=a?e:[e],s=o.map(function(ee){return ee.name}),u=[],l=t.names(),c=0,f=s;c<f.length;c++){var d=f[c];l.indexOf(d)!==-1?u.push(t.getValue(d)):u.push(null)}r!=null&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);var h,p,g=s.join(",")+"|"+t.names().join(",");if(IP[g]==null){var m=ILe(o,t);h=m.sorted,p=m.recipientCounts,IP[g]=h,sQ[g]=p}h=IP[g],p={},i||Object.assign(p,sQ[g]);for(var v=new Jm(t),y=0;y<h.length;++y){if(r!=null){var b=CS().numTensors;b>r.maxNumTensors&&(r.maxNumTensors=b),b<r.minNumTensors&&(r.minNumTensors=b)}var x=h[y],w=x.sourceLayer;if(!(w instanceof Pb)){for(var S=[],C=[],_=[],E=!1,A=0,k=x.inputs;A<k.length;A++){var T=k[A],I=v.getValue(T),N=v.getMask(T);S.push(I),C.push(N),N!=null&&(E=!0),i||(p[T.name]--,p[T.name]!==0||t.hasKey(T)||s.indexOf(T.name)!==-1||I.isDisposed||T.sourceLayer.stateful===!0||_.push(I))}E&&((n=n||{}).mask=C[0]);var O=Jn(w.apply(S,n)),D=null;w.supportsMasking&&(D=w.computeMask(S,C));for(var L=DLe(x),W=Array.isArray(L)?L:[L],G=0;G<W.length;++G){v.hasKey(W[G])||v.add(W[G],O[G],Array.isArray(D)?D[0]:D);var K=s.indexOf(W[G].name);K!==-1&&(u[K]=O[G])}i||Ut(_)}}return v.disposeMasks(),a?u:u[0]}function ILe(e,t){pt.assert(e!=null&&e.length>0,function(){return"Expected at least one fetch, got none"});var n=[],r={};if(e.length===1){var i=uQ(e[0],t);n=i.sorted,r=i.recipientMap}else for(var a=new Set,o=0,s=e;o<s.length;o++){for(var u=uQ(s[o],t),l=u.sorted,c=u.recipientMap,f=0,d=l;f<d.length;f++){var h=d[f];a.has(h.name)||(n.push(h),a.add(h.name))}var p=function(m){r[m]==null&&(r[m]=new Set),c[m].forEach(function(v){return r[m].add(v)})};for(var g in c)p(g)}return{sorted:n,recipientCounts:NLe(r)}}function NLe(e){var t={};for(var n in e)t[n]=e[n].size;return t}function uQ(e,t){for(var n=new Set,r=[],i={},a=0,o=t.names();a<o.length;a++){var s=o[a];n.add(s)}var u=[],l=[];for(u.push(e);u.length>0;){var c=u[u.length-1];if(n.has(c.name))u.pop();else{var f=l[l.length-1]===u.length-1;if(c.inputs.length===0||f)u.pop(),r.push(c),n.add(c.name),f&&l.pop();else{l.push(u.length-1);for(var d=0,h=c.inputs;d<h.length;d++){var p=h[d];i[p.name]==null&&(i[p.name]=new Set),i[p.name].add(c.name),n.has(p.name)||u.push(p)}}}}return{sorted:r,recipientMap:i}}function DLe(e){var t;if(e.sourceLayer.inboundNodes.length===1)t=e.sourceLayer.output;else{for(var n=null,r=0;r<e.sourceLayer.inboundNodes.length;++r)for(var i=0,a=e.sourceLayer.inboundNodes[r].outputTensors;i<a.length;i++)if(a[i].id===e.id){n=r;break}t=e.sourceLayer.getOutputAt(n)}return t}var RLe=function(e){function t(n){var r=e.call(this,{})||this;if(r.containerNodes=new Set,r.name=n.name,r.name==null){var i=r.getClassName().toLowerCase();r.name=FE(i)}if(r.supportsMasking=!1,r.trainable_=!0,Array.isArray(n.inputs)?r.inputs=n.inputs.slice():r.inputs=[n.inputs],Array.isArray(n.outputs)?r.outputs=n.outputs.slice():r.outputs=[n.outputs],Vf(r.inputs).length!==r.inputs.length)throw new ie("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+r.inputs.map(function(Je){return Je.name}));Vf(r.outputs).length!==r.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+r.outputs.map(function(Je){return Je.name})),r.inputLayers=[],r.inputLayersNodeIndices=[],r.inputLayersTensorIndices=[],r.outputLayers=[],r.outputLayersNodeIndices=[],r.outputLayersTensorIndices=[],r.layers=[],r.internalContainerRefs=[];for(var a=0,o=r.outputs;a<o.length;a++){var s=(A=o[a]).sourceLayer,u=A.nodeIndex,l=A.tensorIndex;r.outputLayers.push(s),r.outputLayersNodeIndices.push(u),r.outputLayersTensorIndices.push(l)}for(var c=0,f=r.inputs;c<f.length;c++)s=(A=f[c]).sourceLayer,u=A.nodeIndex,l=A.tensorIndex,Yu(u===0,"input layer has >1 nodes"),Yu(l===0,"input layer has >1 tensors"),r.inputLayers.push(s),r.inputLayersNodeIndices.push(u),r.inputLayersTensorIndices.push(l);r.inputNames=[],r.outputNames=[],r.feedInputShapes=[],r.feedInputNames=[],r.feedOutputNames=[];for(var d=0;d<r.inputLayers.length;d++){if(!((s=r.inputLayers[d])instanceof Pb))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. Received inputs: "+n.inputs+". Input "+d+" (0-based) originates from layer type "+s.getClassName()+".");r.inputNames.push(s.name),r.feedInputShapes.push(s.batchInputShape),r.feedInputNames.push(s.name)}for(var h=0,p=r.outputLayers;h<p.length;h++)s=p[h],r.outputNames.push(s.name);r.internalInputShapes=r.inputs.map(function(Je){return Je.shape}),r.internalOutputShapes=r.outputs.map(function(Je){return Je.shape});for(var g={},m={},v={},y={},b={},x=[],w=function(Je,Zt,mn,Hn,ti,er){Hn!=null&&ti!=null&&er!=null||(Hn=Je.sourceLayer,ti=Je.nodeIndex,er=Je.tensorIndex);var Dn=Hn.inboundNodes[ti];if(mn.indexOf(Dn)!==-1)throw new Xu("The tensor "+Je.name+' at layer "'+Hn.name+'" is part of a cycle.');if(Zt.indexOf(Dn)===-1){r.containerNodes.add(t.nodeKey(Hn,ti)),Hn.id in b||(b[Hn.id]=Object.keys(b).length),mn.indexOf(Dn)===-1&&mn.push(Dn);for(var Jo=Dn.inboundLayers.length,Ka=0;Ka<Jo;Ka++){var jl=Dn.inputTensors[Ka],Ts=Dn.inboundLayers[Ka],Os=Dn.nodeIndices[Ka],Ul=Dn.tensorIndices[Ka];w(jl,Zt,mn,Ts,Os,Ul)}for(Zt.push(Dn);mn.indexOf(Dn)>=0;)mn.splice(mn.indexOf(Dn),1);x.push(Dn)}},S=[],C=[],_=0,E=r.outputs;_<E.length;_++){var A=E[_];w(A,S,C)}for(var k=0,T=x.slice().reverse();k<T.length;k++){m[(B=T[k]).id]=B,B.id in g||(g[B.id]=0);var I=g[B.id],N=v[B.outboundLayer.id]==null?0:v[B.outboundLayer.id];for(I=Math.max(I,N),v[B.outboundLayer.id]=I,y[B.outboundLayer.id]=B.outboundLayer,g[B.id]=I,d=0;d<B.inboundLayers.length;d++){var O=B.inboundLayers[d],D=(u=B.nodeIndices[d],O.inboundNodes[u]),L=g[D.id]==null?0:g[D.id];g[D.id]=Math.max(I+1,L),m[D.id]=D}}var W={};for(var G in g)(I=g[G])in W||(W[I]=[]),W[I].push(m[G]);var K={};for(var ee in v)(I=v[ee])in K||(K[I]=[]),K[I].push(y[ee]);var ce=Object.keys(K).map(function(Je){return parseInt(Je,10)}).sort(IE);r.layers=[];for(var he=0,Oe=ce;he<Oe.length;he++){var Te=K[I=Oe[he]];Te.sort(function(Je,Zt){var mn=b[Je.id],Hn=b[Zt.id];return mn<Hn?-1:mn>Hn?1:0});for(var De=0,me=Te;De<me.length;De++)(s=me[De])instanceof t&&r.internalContainerRefs.push(s),r.layers.push(s)}r.layersByDepth=K,ce=Object.keys(W).map(function(Je){return parseInt(Je,10)}).sort(IE);for(var P=r.inputs.slice(),F=[],V=0,ae=ce;V<ae.length;V++)for(var Y=0,M=W[I=ae[V]];Y<M.length;Y++){var B;if((s=(B=M[Y]).outboundLayer)!=null){for(var R=0,X=B.inputTensors;R<X.length;R++)if(A=X[R],P.indexOf(A)===-1)throw new Xu("Graph disconnected: cannot obtain value for tensor "+A+' at layer "'+s.name+'". The following previous layers were accessed without issue: '+F);for(var ge=0,xe=B.outputTensors;ge<xe.length;ge++)A=xe[ge],P.push(A);F.push(s.name)}}r.nodesByDepth=W;for(var ze=r.layers.map(function(Je){return Je.name}),Ke=function(Je){var Zt=ze.filter(function(mn){return mn===Je}).length;if(Zt!==1)throw new Xu('The name "'+Je+'" is used '+Zt+" times in the model. All layer names should be unique. Layer names: "+JSON.stringify(ze))},Ze=0,Bt=ze;Ze<Bt.length;Ze++)Ke(Bt[Ze]);return r.outboundNodes=[],r.inboundNodes=[],new $E({outboundLayer:r,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:r.inputs,outputTensors:r.outputs,inputMasks:r.inputs.map(function(Je){return null}),outputMasks:r.outputs.map(function(Je){return null}),inputShapes:r.inputs.map(function(Je){return Je.shape}),outputShapes:r.outputs.map(function(Je){return Je.shape})}),r.built=!0,r._refCount=1,r}return Ee(t,e),t.prototype.assertNotDisposed=function(){if(this._refCount===0)throw new Error("Container '"+this.name+"' is already disposed.")},t.prototype.dispose=function(){this.assertNotDisposed();var n={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount==0){for(var r=0,i=this.layers;r<i.length;r++){var a=i[r];n.numDisposedVariables+=a.dispose().numDisposedVariables}for(var o=0,s=this.internalContainerRefs;o<s.length;o++){var u=s[o];n.numDisposedVariables+=u.dispose().numDisposedVariables}}return n.refCountAfterDispose=this._refCount,n},Object.defineProperty(t.prototype,"trainable",{get:function(){return this.trainable_},set:function(n){this.layers.forEach(function(r){r._trainableWeights.forEach(function(i){return i.trainable=n})}),this.trainable_=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trainableWeights",{get:function(){if(this._trainableWeights.length>0)throw new ie("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];for(var n=[],r=0,i=this.layers;r<i.length;r++){var a=i[r];n=n.concat(a.trainableWeights)}return n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){for(var n=[],r=0,i=this.layers;r<i.length;r++){var a=i[r];n.push.apply(n,a.nonTrainableWeights)}if(!this.trainable){for(var o=[],s=0,u=this.layers;s<u.length;s++)a=u[s],o.push.apply(o,a.trainableWeights);return o.concat(n)}return n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),t.prototype.loadWeights=function(n,r){r===void 0&&(r=!0);for(var i={},a=0,o=0,s=this.layers;o<s.length;o++)for(var u=0,l=s[o].weights;u<l.length;u++){var c=l[u];if(i[c.originalName]!=null)throw new ie("Duplicate weight name: "+c.originalName);i[c.originalName]=c,a++}var f=[];for(var d in n){if(i[d]!=null)f.push([i[d],n[d]]);else if(r)throw new ie("Provided weight data has no target variable: "+d);delete i[d]}if(r){var h=[];for(var p in i)h.push(p);if(h.length>0)throw new ie(h.length+" of "+a+" weights are not set: "+h)}_P(f)},t.prototype.updatedConfig=function(){var n=this.getConfig(),r={};return r.className=this.getClassName(),r.config=n,r.kerasVersion="tfjs-layers "+oQ,r.backend="TensorFlow.js",r},t.prototype.toJSON=function(n,r){r===void 0&&(r=!0);var i=OP(this.updatedConfig());return r?JSON.stringify(i):i},t.prototype.call=function(n,r){var i=this;return le(function(){n=Jn(n);for(var a=new Jm,o=0;o<i.inputs.length;++o)a.add(i.inputs[o],n[o]);return Bb(i.outputs,a,r)})},t.prototype.computeMask=function(n,r){var i=this;return le(function(){var a;return n=Jn(n),a=r==null?Gh(null,n.length):Jn(r),i.runInternalGraph(n,a)[1]})},t.prototype.computeOutputShape=function(n){var r=ME(n);if(r.length!==this.inputLayers.length)throw new ie("Invalid inputShape argument "+n+": model has "+this.inputLayers.length+" tensor inputs.");for(var i={},a=0;a<r.length;a++){var o=this.inputLayers[a],s=r[a];i[E=o.name+"_0_0"]=s}var u=Object.keys(this.nodesByDepth).map(function(k){return parseInt(k,10)}).sort(IE);if(u.length>1)for(var l=0,c=u;l<c.length;l++)for(var f=c[l],d=0,h=this.nodesByDepth[f];d<h.length;d++){var p=h[d];if(o=p.outboundLayer,this.inputLayers.map(function(k){return k.id}).indexOf(o.id)===-1){for(var g=[],m=0;m<p.inboundLayers.length;m++){var v=p.inboundLayers[m],y=p.nodeIndices[m],b=p.tensorIndices[m],x=i[E=v.name+"_"+y+"_"+b];g.push(x)}var w=ME(o.computeOutputShape(_a(g))),S=o.inboundNodes.indexOf(p);for(m=0;m<w.length;m++)i[E=o.name+"_"+S+"_"+m]=w[m]}}var C=[],_=[];for(a=0;a<this.outputLayers.length;a++){o=this.outputLayers[a],S=this.outputLayersNodeIndices[a],b=this.outputLayersTensorIndices[a];var E=o.name+"_"+S+"_"+b;_.push(E)}for(a=0;a<_.length;a++){var A=_[a];Yu(A in i),C.push(i[A])}return _a(C)},t.prototype.runInternalGraph=function(n,r){r==null&&(r=Gh(null,n.length));for(var i={},a=0;a<this.inputs.length;++a){var o=this.inputs[a],s=n[a],u=r[a];i[o.id]=[s,u]}for(var l=0,c=Object.keys(this.nodesByDepth).map(function(K){return parseInt(K,10)}).sort(IE);l<c.length;l++)for(var f=c[l],d=0,h=this.nodesByDepth[f];d<h.length;d++){for(var p=h[d],g=p.outboundLayer,m=p.inputTensors,v=p.outputTensors,y=new Array,b=0,x=m;b<x.length;b++)(o=x[b]).id in i&&y.push(i[o.id]);if(y.length===m.length){var w={},S=void 0,C=void 0,_=void 0,E=void 0;if(p.callArgs!=null&&(w=p.callArgs),y.length===1){var A=y[0],k=A[0],T=A[1];w.mask==null&&(w.mask=T),_=Jn(g.call(k,w)),E=Jn(g.computeMask(k,T)),S=[k],C=[T]}else S=y.map(function(K){return K[0]}),C=y.map(function(K){return K[1]}),w.mask==null&&(w.mask=C),_=Jn(g.call(S,w)),E=Jn(g.computeMask(S,C));if(g.activityRegularizer)throw new $t("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(a=0;a<v.length;++a)o=v[a],s=_[a],u=E[a],i[o.id]=[s,u]}}for(var I=[],N=[],O=[],D=0,L=this.outputs;D<L.length;D++){Yu((o=L[D]).id in i,"Could not compute output "+o.name+" : "+o.id);var W=i[o.id],G=W[0];u=W[1],O.push(G.shape),I.push(G),N.push(u)}return[I,N,O]},t.prototype.buildNodeConversionMap=function(n){for(var r,i={},a=0,o=this.layers;a<o.length;a++){var s=o[a];r=s instanceof t?1:0;for(var u=0;u<s.inboundNodes.length;u++){var l=t.nodeKey(s,u);this.containerNodes.has(l)&&(i[l]=r,r+=1)}}return i},t.prototype.getLayer=function(n,r){if(r!=null){if(this.layers.length<=r)throw new ie("Was asked to retrieve layer at index "+r+", but model only has "+this.layers.length+" layer(s).");return this.layers[r]}if(n==null)throw new ie("Provide either a layer name or layer index");for(var i=0,a=this.layers;i<a.length;i++){var o=a[i];if(o.name===n)return o}throw new ie("No such layer: "+n)},t.prototype.calculateLosses=function(){var n=this;return le(function(){for(var r=[],i=0,a=n.layers;i<a.length;i++)for(var o=a[i],s=0;s<o.inboundNodes.length;++s){var u=t.nodeKey(o,s);n.containerNodes.has(u)&&r.push.apply(r,o.calculateLosses())}return r})},t.prototype.getConfig=function(){for(var n={name:this.name},r=this.buildNodeConversionMap(this.layers),i=[],a=0,o=this.layers;a<o.length;a++){for(var s=(w=o[a]).getClassName(),u=w.getConfig(),l=[],c=0;c<w.inboundNodes.length;c++){var f=w.inboundNodes[c],d=t.nodeKey(w,c),h={};if(this.containerNodes.has(d)){if(f.callArgs)try{JSON.stringify(f.callArgs),h=f.callArgs}catch(_){console.warn("Layer "+w.name+" was passed non-serializable keyword arguments: "+f.callArgs+". They will not be included in the serialized model (and thus will be missing at deserialization time)."),h={}}if(f.inboundLayers.length>0){for(var p=[],g=0;g<f.inboundLayers.length;g++){var m=f.inboundLayers[g],v=f.nodeIndices[g],y=f.tensorIndices[g];(C=r[t.nodeKey(m,v)])==null&&(C=0),p.push([m.name,C,y,h])}l.push(p)}}}var b={};b.name=w.name,b.className=s,b.config=u,b.inboundNodes=l,i.push(b)}n.layers=i;var x=[];for(g=0;g<this.inputLayers.length;g++){var w=this.inputLayers[g];v=this.inputLayersNodeIndices[g],d=t.nodeKey(w,v),this.containerNodes.has(d)&&((C=r[d])!==null&&C!==void 0||(C=0),y=this.inputLayersTensorIndices[g],x.push([w.name,C,y]))}n.inputLayers=x;var S=[];for(g=0;g<this.outputLayers.length;g++)if(w=this.outputLayers[g],v=this.outputLayersNodeIndices[g],d=t.nodeKey(w,v),this.containerNodes.has(d)){var C;(C=r[d])!==null&&C!==void 0||(C=0),y=this.outputLayersTensorIndices[g],S.push([w.name,C,y])}return n.outputLayers=S,n},t.fromConfig=function(n,r,i,a){a===void 0&&(a=!1);var o={},s={};function u(D,L){D.name in s?s[D.name].push(L):s[D.name]=[L]}function l(D,L){for(var W,G=[],K=0,ee=L;K<ee.length;K++){var ce=ee[K],he=ce[0],Oe=ce[1],Te=ce[2];if(W=ce[3]==null?{}:ce[3],!(he in o))return void u(D,L);var De=o[he];if(De.inboundNodes.length<=Oe)return void u(D,L);var me=De.inboundNodes[Oe];G.push(me.outputTensors[Te])}G.length>0&&D.apply(_a(G),W)}function c(D){var L=D.name,W=Xs(D,r.customObjects!=null?r.customObjects:{});W.setFastWeightInitDuringBuild(a),o[L]=W,D.inboundNodes.forEach(function(G){if(!(G instanceof Array))throw new ie("Corrupted configuration, expected array for nodeData: "+G);u(W,G)})}for(var f=r.name,d=r.layers,h=0,p=d;h<p.length;h++)c(v=p[h]);for(;!o4e(s);)for(var g=0,m=d;g<m.length;g++){var v=m[g];if((O=o[v.name]).name in s){var y=s[O.name];delete s[O.name];for(var b=0,x=y;b<x.length;b++)l(O,x[b])}}for(var w=[],S=[],C=0,_=r.inputLayers;C<_.length;C++){var E=(v=_[C])[0],A=v[1],k=v[2];Yu(E in o);var T=(O=o[E]).inboundNodes[A].outputTensors;w.push(T[k])}for(var I=0,N=r.outputLayers;I<N.length;I++){E=(v=N[I])[0],A=v[1],k=v[2],Yu(E in o);var O;T=(O=o[E]).inboundNodes[A].outputTensors,S.push(T[k])}return new n({inputs:w,outputs:S,name:f})},Object.defineProperty(t.prototype,"stateful",{get:function(){if(this._stateful)throw new ie("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(var n=0,r=this.layers;n<r.length;n++)if(r[n].stateful)return!0;return!1},enumerable:!0,configurable:!0}),t.prototype.resetStates=function(){var n=this;le(function(){n.layers.forEach(function(r){r.stateful&&r.resetStates()})})},t}(tn);function FLe(e,t,n){var r=t.length;if(e==null||Array.isArray(e)&&e.length===0)return t.map(function(a){return null});if(r===1)return Array.isArray(e)&&e.length===1?e:typeof e=="object"&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw new Error("Provided "+n+" is an array of "+e.length+" element(s), but the model has "+r+" outputs. Make sure a set of weights is provided for each model output.");return e}if(typeof e=="object"&&Object.keys(e).length>0&&typeof e[Object.keys(e)[0]]=="object"){var i=[];return t.forEach(function(a){a in e?i.push(e[a]):i.push(null)}),i}throw new Error("The model has multiple ("+r+") outputs, so "+n+" must be either an array with "+r+" elements or an object with "+t+" keys. Provided "+n+" not understood: "+JSON.stringify(e))}function lQ(e,t){return FLe(e,t,"classWeight")}function cQ(e,t,n,r){return At(this,void 0,void 0,function(){var i,a,o,s,u;return St(this,function(l){switch(l.label){case 0:if(t!=null||r!=null)throw new Error("Support sampleWeight is not implemented yet");return n==null?[3,2]:(i=le(function(){if(e.shape.length===1)return e.clone();if(e.shape.length===2){if(e.shape[1]>1)return e.argMax(1);if(e.shape[1]===1)return e.reshape([e.shape[0]]);throw new Error("Encountered unexpected last-dimension size ("+e.shape[1]+") during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor ("+e.rank+") during handling of class weights. The rank is expected to be 1 or 2.")}),s=(o=Array).from,[4,i.data()]);case 1:return a=s.apply(o,[l.sent()]),Ut(i),u=[],a.forEach(function(c){if(n[c]==null)throw new Error("classWeight must contain all classes in the training data. The class "+c+" exists in the data but not in classWeight");u.push(n[c])}),[2,ba(u,"float32")];case 2:return[2,null]}})})}function MLe(e,t){return rt(e,t)}var PLe=32;function fQ(e,t){var n,r,i=t;n=i.xs,r=i.ys,pt.assert(n!=null&&r!=null,function(){return"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+t});var a=dQ("input",e.inputNames,n),o=dQ("output",e.outputNames,r),s=a[0].shape[0];pt.assert(a.length===e.inputs.length,function(){return"LayersModel has "+e.inputs.length+" inputs, but the dataset provides "+a.length+" inputs.  (Expected input keys: "+JSON.stringify(e.inputNames)+")"}),pt.assert(o.length===e.outputs.length,function(){return"LayersModel has "+e.outputs.length+" outputs, but the dataset provides "+o.length+" outputs.  (Expected output keys: "+JSON.stringify(e.outputNames)+")"});for(var u=function(d){pt.assert(a[d].shape[0]===s,function(){return"Batch size mismatch: input "+e.inputNames[d]+" has "+a[d].shape[0]+"; expected  "+s+" based on input "+e.inputNames[0]+"."})},l=0;l<a.length;l++)u(l);for(var c=function(d){pt.assert(o[d].shape[0]===s,function(){return"Batch size mismatch: output "+e.outputNames[d]+" has "+o[d].shape[0]+"; expected  "+s+" based on input "+e.inputNames[0]+"."})},f=0;f<o.length;f++)c(f);return{xs:a,ys:o}}function dQ(e,t,n){if(n instanceof Ht)return[n];if(Array.isArray(n))return pt.assert(n.length===t.length,function(){return"Received an array of "+n.length+" Tensors, but expected "+t.length+" to match the "+e+" keys "+t+"."}),n;for(var r=[],i=0,a=t;i<a.length;i++){var o=a[i];if(n[o]==null)throw new ie("The feature data generated by the dataset lacks the required "+e+" key '"+o+"'.");r.push(n[o])}return r}function $Le(e){if(e.length===3)throw new $t("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}function LLe(e,t,n){return At(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f,d,h,p,g,m,v,y,b,x,w,S,C,_,E,A,k,T,I,N,O,D,L,W,G,K;return St(this,function(ee){switch(ee.label){case 0:if(r=n.batchesPerEpoch!=null,pt.assert(e.optimizer!=null,function(){return"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."}),pt.assert(n!=null,function(){return"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."}),pt.assert(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),function(){return"For fitDataset(), config.epochs is expected to be a positive integer, but got "+n.epochs}),pt.assert(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),function(){return"For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got "+n.batchesPerEpoch}),pt.assert(n.validationSplit==null,function(){return"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."}),e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0,ee.label=1;case 1:return ee.trys.push([1,,26,27]),i=n.validationData!=null,a=void 0,o=void 0,i&&(hQ(n.validationData)?pt.assert(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),function(){return"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got "+n.validationBatches}):(s=$Le(n.validationData),a=s.xs,o=s.ys)),u=e.makeTrainFunction(),l=e.getDedupedMetricsNames(),c=void 0,c=i?l.slice().concat(l.map(function(ce){return"val_"+ce})):l.slice(),f=YJ(n.callbacks,n.yieldEvery),d=n.verbose==null?1:n.verbose,h=ZJ(f,d,n.epochs,null,null,BLe(t,n),null,i,c),p=h.callbackList,g=h.history,p.setModel(e),e.history=g,[4,p.onTrainBegin()];case 2:return ee.sent(),e.stopTraining_=!1,m=n.initialEpoch==null?0:n.initialEpoch,[4,t.iterator()];case 3:v=ee.sent(),ee.label=4;case 4:return m<n.epochs?(y={},[4,p.onEpochBegin(m)]):[3,23];case 5:return ee.sent(),b=0,x=0,r?[3,7]:[4,t.iterator()];case 6:v=ee.sent(),ee.label=7;case 7:return!r||b<n.batchesPerEpoch?[4,v.next()]:[3,21];case 8:return w=ee.sent(),r&&w.done?(console.warn("You provided `batchesPerEpoch` as "+n.batchesPerEpoch+", but your dataset iterator ran out of data after "+b+" batches; interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+n.batchesPerEpoch*n.epochs+" batches). You may need to use the repeat() function when building your dataset."),[3,21]):w.value==null?[3,15]:(S=fQ(e,w.value),C=S.xs,_=S.ys,(E={}).batch=x,E.size=C[0].shape[0],[4,p.onBatchBegin(x,E)]);case 9:if(ee.sent(),A=[],n.classWeight==null)return[3,13];k=lQ(n.classWeight,e.outputNames),K=0,ee.label=10;case 10:return K<k.length?(I=(T=A).push,[4,cQ(_[K],null,k[K])]):[3,13];case 11:I.apply(T,[ee.sent()]),ee.label=12;case 12:return++K,[3,10];case 13:for(N=C.concat(_).concat(A),O=u(N),Ut(N),K=0;K<l.length;++K)D=l[K],L=O[K],E[D]=L,zu(L);return[4,p.onBatchEnd(x,E)];case 14:ee.sent(),XJ(E),x++,b++,ee.label=15;case 15:return(r?b>=n.batchesPerEpoch:w.done)?i?(W=void 0,hQ(n.validationData)?(G=Jn,[4,e.evaluateDataset(n.validationData,{batches:n.validationBatches})]):[3,17]):[3,19]:[3,20];case 16:return W=G.apply(void 0,[ee.sent()]),[3,18];case 17:W=Jn(e.evaluate(a,o,{batchSize:n.validationBatchSize==null?PLe:n.validationBatchSize,verbose:0})),ee.label=18;case 18:for(K=0;K<e.metricsNames.length;++K)y["val_"+e.metricsNames[K]]=W[K];ee.label=19;case 19:return[3,21];case 20:return e.stopTraining_?[3,21]:[3,7];case 21:return[4,p.onEpochEnd(m,y)];case 22:return ee.sent(),m++,e.stopTraining_?[3,23]:[3,4];case 23:return[4,p.onTrainEnd()];case 24:return ee.sent(),[4,e.history.syncData()];case 25:return ee.sent(),[2,e.history];case 26:return e.isTraining=!1,[7];case 27:return[2]}})})}function BLe(e,t){var n=null;return t.batchesPerEpoch!=null?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size),n}function hQ(e){return typeof e.iterator=="function"}function zLe(e){return typeof e.next=="function"}function jLe(e,t,n){return At(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f,d;return St(this,function(h){switch(h.label){case 0:if(r=(n=n||{}).batches!=null,i=e.testFunction,a=[],n.verbose>0)throw new $t("Verbose mode is not implemented yet.");return pt.assert(!r||n.batches>0&&Number.isInteger(n.batches),function(){return"Test loop expects `batches` to be a positive integer, but received "+JSON.stringify(n.batches)}),zLe(t)?(s=t,[3,3]):[3,1];case 1:return[4,t.iterator()];case 2:s=h.sent(),h.label=3;case 3:o=s,u=0,l=0,c=function(){var p;return St(this,function(g){switch(g.label){case 0:return[4,o.next()];case 1:return p=g.sent(),a=le(function(){if(p.value){var m=fQ(e,p.value),v=m.xs,y=m.ys,b=v.concat(y),x=le(function(){return i(b)});if(Ut(b),l===0)for(var w=0;w<x.length;++w)a.push(Ve(0));var S=b[0].shape[0],C=function(_){var E=x[_],A=a[_];a[_]=le(function(){return Wt(a[_],rt(S,E))}),l>0&&Ut(A)};for(w=0;w<x.length;++w)C(w);Ut(x),u+=S,++l}return a}),p.done?(r&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` batches (in this case, "+n.batches+" batches). You may need to use the repeat() function when building your dataset."),[2,"break"]):[2]}})},h.label=4;case 4:return!r||l<n.batches?[5,c()]:[3,6];case 5:return h.sent()==="break"?[3,6]:[3,4];case 6:for(f=0;f<a.length;++f)d=a[f],a[f]=Cr(a[f],u),Ut(d);return[2,_a(a)]}})})}function NP(e){pt.assert(e>0&&Number.isInteger(e),function(){return"batchSize is required to be a positive integer, but got "+e})}function zb(e,t,n){return e==null?[null]:Array.isArray(e)?e.map(function(r){return Yh(r,t,n-t)}):Yh(e,t,n-t)}function DP(e,t){return le(function(){return e==null?null:Array.isArray(e)?e.map(function(n){return DP(n,t)}):RJ(e,t.dtype==="int32"?t:t.toInt())})}function RP(e,t){for(var n=[],r=0,i=null;r<e;)(i=r+t)>=e&&(i=e),n.push([r,i]),r=i;return n}function ULe(e,t,n,r,i,a,o,s,u,l,c,f,d,h,p){return At(this,void 0,void 0,function(){var g,m,v,y,b,x,w,S;return St(this,function(C){switch(C.label){case 0:if(i==null&&(i=32),a==null&&(a=1),c==null&&(c=!0),d==null&&(d=0),g=!1,u!=null&&l!=null&&(g=!0),p!=null&&(g=!0,h==null))throw new ie("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");return(m=e.checkNumSamples(n,i,h,"steps_per_epoch"))!=null&&(v=Gs(0,m)),o==null&&(o=1),y=ZJ(s,o,a,d,m,h,i,g,f),b=y.callbackList,x=y.history,b.setModel(e),e.history=x,[4,b.onTrainBegin()];case 1:C.sent(),e.stopTraining_=!1,w=function(_){var E,A,k,T,I;return St(this,function(N){switch(N.label){case 0:return[4,b.onEpochBegin(_)];case 1:if(N.sent(),E={},h==null)return[3,2];throw new $t("stepsPerEpoch mode is not implemented yet.");case 2:if(c==="batch")throw new $t("batch shuffling is not implemneted yet");c&&pt.shuffle(v),A=ba(v),k=RP(m,i),T=function(O){var D;return St(this,function(L){switch(L.label){case 0:return D={},[4,b.onBatchBegin(O,D)];case 1:return L.sent(),le(function(){var W=k[O][0],G=k[O][1],K=Yh(A,W,G-W);D.batch=O,D.size=G-W;for(var ee=DP(n,K),ce=t(ee),he=0;he<r.length;++he){var Oe=r[he],Te=ce[he];D[Oe]=Te,zu(Te)}if(O===k.length-1&&g){var De=e.testLoop(u,l,i);for(he=0;he<r.length;++he)Oe=r[he],Te=De[he],zu(Te),E["val_"+Oe]=Te}}),[4,b.onBatchEnd(O,D)];case 2:return L.sent(),XJ(D),e.stopTraining_?[2,"break"]:[2]}})},I=0,N.label=3;case 3:return I<k.length?[5,T(I)]:[3,6];case 4:if(N.sent()==="break")return[3,6];N.label=5;case 5:return++I,[3,3];case 6:A.dispose(),N.label=7;case 7:return[4,b.onEpochEnd(_,E)];case 8:return N.sent(),e.stopTraining_?[2,"break"]:[2]}})},S=d,C.label=2;case 2:return S<a?[5,w(S)]:[3,5];case 3:if(C.sent()==="break")return[3,5];C.label=4;case 4:return++S,[3,2];case 5:return[4,b.onTrainEnd()];case 6:return C.sent(),[4,e.history.syncData()];case 7:return C.sent(),[2,e.history]}})})}function WLe(e,t,n,r){return r===void 0&&(r={}),At(this,void 0,void 0,function(){var i,a,o,s,u,l,c,f,d,h,p,g,m,v,y,b,x,w,S,C,_,E;return St(this,function(A){switch(A.label){case 0:if(e.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");e.isTraining=!0,A.label=1;case 1:return A.trys.push([1,,7,8]),NP(f=r.batchSize==null?32:r.batchSize),d=!1,[4,e.standardizeUserData(t,n,r.sampleWeight,r.classWeight,d,f)];case 2:if(h=A.sent(),i=h[0],a=h[1],c=h[2],p=!1,g=void 0,!(r.validationData!=null&&r.validationData.length>0))return[3,4];if(p=!0,r.validationData.length!==2)throw r.validationData.length===3?new $t("validationData including sample weights is not supported yet."):new ie("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+r.validationData+" is invalid.");return o=r.validationData[0],s=r.validationData[1],m=!0,[4,e.standardizeUserData(o,s,null,null,m,f)];case 3:return v=A.sent(),u=v[0],l=v[1],g=u.concat(l),[3,5];case 4:r.validationSplit!=null&&r.validationSplit>0&&r.validationSplit<1?(p=!0,y=Math.floor(i[0].shape[0]*(1-r.validationSplit)),b=i[0].shape[0],u=zb(i,y,b),i=zb(i,0,y),l=zb(a,y,b),a=zb(a,0,y),g=u.concat(l)):r.validationSteps!=null&&(p=!0),A.label=5;case 5:return x=i.concat(a).concat(c),e.checkTrainableWeightsConsistency(),w=e.makeTrainFunction(),S=e.getDedupedMetricsNames(),C=void 0,_=void 0,p?(e.makeTestFunction(),C=e.testFunction,_=S.slice().concat(S.map(function(k){return"val_"+k}))):(C=null,g=[],_=S.slice()),E=YJ(r.callbacks,r.yieldEvery),[4,ULe(e,w,x,S,f,r.epochs,r.verbose,E,C,g,r.shuffle,_,r.initialEpoch,null,null)];case 6:return[2,A.sent()];case 7:return e.isTraining=!1,Jh(i,t),Jh(a,n),Jh(u,o),Jh(l,s),c!=null&&Ut(c),[7];case 8:return[2]}})})}function pQ(e){var t=[];e instanceof Ht&&(e=[e]);for(var n=0;n<e.length;++n){var r=e[n];if(r.rank===1)t.push(Fb(r,1));else{if(r.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function Jh(e,t){if(e!=null){var n=[];if(t instanceof Ht)n.push(t.id);else if(Array.isArray(t))t.forEach(function(u){return n.push(u.id)});else if(t!=null)for(var r in t){var i=t[r];n.push(i.id)}var a=[];if(e instanceof Ht)n.indexOf(e.id)===-1&&a.push(e);else if(Array.isArray(e))e.forEach(function(u){n.indexOf(u.id)===-1&&a.push(u)});else if(e!=null)for(var o in e){var s=e[o];n.indexOf(s.id)===-1&&a.push(s)}a.forEach(function(u){u.isDisposed||u.dispose()})}}function VLe(e){return e instanceof Ht}function FP(e){return Array.isArray(e)}function gQ(e){return!VLe(e)&&!FP(e)}function mQ(e,t,n,r,i){if(r===void 0&&(r=!0),i===void 0&&(i=""),t==null||t.length===0){if(e!=null){var a=!1;if(FP(e)&&e.length>0)a=!0;else if(gQ(e)){for(var o in e)if(e.hasOwnProperty(o)){a=!0;break}}else a=!0;if(a)throw new ie("Error when checking model "+i+" expected no data, but got "+e)}return[]}if(e==null)return t.map(function(m){return null});var s;if(gQ(e)){e=e,s=[];for(var u=0,l=t;u<l.length;u++){var c=l[u];if(e[c]==null)throw new ie('No data provided for "'+c+'". Need data for each key in: '+t);s.push(e[c])}}else if(FP(e)){if((e=e).length!==t.length)throw new ie("Error when checking model "+i+": the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see "+t.length+" Tensor(s), but instead got the following list of Tensor(s): "+e);s=e}else{if(e=e,t.length>1)throw new ie("The model "+i+" expects "+t.length+" Tensor(s), but only received one Tensor. Found: Tensor with shape "+e.shape);s=[e]}if(s=pQ(s),n!=null){for(var f=0;f<t.length;++f)if(n[f]!=null){var d=s[f];if(d.shape.length!==n[f].length)throw new ie("Error when checking "+i+": expected "+t[f]+" to have "+n[f].length+" dimension(s). but got array with shape "+d.shape);for(var h=0;h<n[f].length;++h)if(h!==0||r){var p=d.shape[h],g=n[f][h];if(g!=null&&g>=0&&p!==g)throw new ie("Error when checking "+i+": expected "+t[f]+" to have shape ["+n[f]+"], but got array with shape ["+d.shape+"].")}}}return s}function qLe(e,t,n){var r=Vf(e.map(function(a){return a.shape[0]}));r.sort();var i=Vf(t.map(function(a){return a.shape[0]}));if(i.sort(),r.length>1)throw new ie("All input Tensors (x) should have the same number of samples. Got array shapes: "+JSON.stringify(e.map(function(a){return a.shape})));if(i.length>1)throw new ie("All target Tensors (y) should have the same number of samples. Got array shapes: "+JSON.stringify(t.map(function(a){return a.shape})));if(r.length>0&&i.length>0&&!pt.arraysEqual(r,i))throw new ie("Input Tensors should have the same number of samples as target Tensors. Found "+r[0]+" input sample(s) and "+i[0]+" target sample(s).")}function HLe(e,t,n){for(var r=[Zh,jE,$b],i=0;i<e.length;++i){var a=e[i],o=t[i],s=n[i];if(o!=null){if(o===$b&&a.shape[a.shape.length-1]===1)throw new ie("You are passing a target array of shape "+a.shape+" while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(r.indexOf(o)!==-1)for(var u=a.shape.slice(1),l=s.slice(1),c=0;c<u.length;++c){var f=u[c],d=l[c];if(d!=null&&f!==d)throw new ie("A target Tensor with shape "+a.shape+" was passed for an output of shape "+s+", while using a loss function that expects targets to have the same shape as the output.")}}}}function vQ(e,t,n,r,i){var a;if(r===void 0&&(r=!0),i===void 0&&(i=""),Array.isArray(e)){if(e.length!==t.length)throw new ie("Error when checking model "+i+": the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see "+t.length+" Tensor(s), but instead got "+e.length+" Tensors(s).");a=e}else{if(t.length>1)throw new ie("The model expects "+t.length+" "+i+" Tensors, but only received one Tensor. Found: array with shape "+JSON.stringify(e.shape)+".");a=[e]}if(n!=null){for(var o=0;o<t.length;++o)if(n[o]!=null){var s=a[o];if(s.shape.length!==n[o].length)throw new ie("Error when checking "+i+": expected "+t[o]+" to have "+n[o].length+" dimension(s), but got array with shape "+JSON.stringify(s.shape));for(var u=0;u<n[o].length;++u)if(u!==0||r){var l=s.shape[u],c=n[o][u];if(c!=null&&c!==l)throw new ie("Error when checking "+i+": expected "+t[o]+" to have shape "+JSON.stringify(n[o])+" but got array with shape "+JSON.stringify(s.shape)+".")}}}}function GLe(e,t){if(e==null||Array.isArray(e)&&e.length===0)return t.map(function(u){return[]});var n;if(typeof e=="string"||typeof e=="function")n=[e];else{if(!Array.isArray(e)&&typeof e!="object")throw new TypeError("Type of metrics argument not understood. Expected an string,function, Array, or Object, found: "+e);n=e}if(Array.isArray(n))return t.map(function(u){return n});for(var r=[],i=0,a=t;i<a.length;i++){var o=a[i],s=n.hasOwnProperty(o)?n[o]:[];Array.isArray(s)||(s=[s]),r.push(s)}return r}var KLe="layers-model",jb=function(e){function t(n){var r=e.call(this,n)||this;return r.isTraining=!1,r}return Ee(t,e),t.prototype.summary=function(n,r,i){if(i===void 0&&(i=console.log),!this.built)throw new ie("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");ELe(this,n,r,i)},t.prototype.compile=function(n){var r=this;if(n.loss==null&&(n.loss=[]),this.loss=n.loss,typeof n.optimizer=="string")this.optimizer_=SLe(n.optimizer),this.isOptimizerOwned=!0;else{if(!(n.optimizer instanceof cc))throw new ie("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=n.optimizer,this.isOptimizerOwned=!1}var i=[];if(Array.isArray(n.loss)||typeof n.loss=="string"||typeof n.loss=="function")if(Array.isArray(n.loss)){if(n.loss.length!==this.outputs.length)throw new ie("When passing an Array as loss, it should have one entry per model output. The model has "+this.outputs.length+" output(s), but you passed loss="+n.loss+".");var a=n.loss;i=a.map(function(m){return EP(m)})}else{var o=EP(n.loss);this.outputs.forEach(function(m){i.push(o)})}else{for(var s in n.loss=n.loss,n.loss)if(this.outputNames.indexOf(s)===-1)throw new ie('Unknown entry in loss dictionary: "'+s+'". Only expected the following keys: '+this.outputNames);for(var u=0,l=this.outputNames;u<l.length;u++){var c=l[u];n.loss[c]==null&&console.warn('Output "'+c+'" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to '+c+" during training"),i.push(EP(n.loss[c]))}}this.lossFunctions=i,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(var f=0;f<this.outputs.length;++f){var d=this.internalOutputShapes[f],h=this.outputNames[f];this.feedOutputNames.push(h),this.feedOutputShapes.push(d),this.feedLossFns.push(this.lossFunctions[f])}var p=[];this.metrics=n.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Xh("loss",function(){for(var m=0;m<r.outputs.length;++m)if(p.indexOf(m)===-1){var v=r.lossFunctions[m];r.outputs.length>1&&(r.metricsTensors.push([v,m]),r.metricsNames.push(r.outputNames[m]+"_loss"))}});var g=GLe(n.metrics,this.outputNames);Xh("metric",function(){for(var m=function(y){if(p.indexOf(y)!==-1)return"continue";(function(b){for(var x,w,S,C=function(A){if(typeof A=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(A)!==-1){var k=r.internalOutputShapes[y];k[k.length-1]===1||r.lossFunctions[y]===jE?["accuracy","acc"].indexOf(A)!==-1?w=CP:["crossentropy","ce"].indexOf(A)!==-1&&(w=eQ):r.lossFunctions[y]===zE?["accuracy","acc"].indexOf(A)!==-1?w=tQ:["crossentropy","ce"].indexOf(A)!==-1&&(w=nQ):["accuracy","acc"].indexOf(A)!==-1?w=AP:["crossentropy","ce"].indexOf(A)!==-1&&(w=kP);var T=void 0;["accuracy","acc"].indexOf(A)!==-1?T="acc":["crossentropy","ce"].indexOf(A)!==-1&&(T="ce"),S=w,x=""+T}else{var I=_Le(A);S=I,x=""+VE(A)}var N;Xh(x,function(){N=S}),function(O,D,L){r.outputNames.length>1&&(D=r.outputNames[O]+"_"+D),r.metricsNames.push(D),r.metricsTensors.push([L,O])}(y,x,N)},_=0,E=b;_<E.length;_++)C(E[_])})(g[y])},v=0;v<r.outputs.length;++v)m(v)}),this.collectedTrainableWeights=this.trainableWeights},t.prototype.checkTrainableWeightsConsistency=function(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")},t.prototype.evaluate=function(n,r,i){i===void 0&&(i={});var a=i.batchSize==null?32:i.batchSize;NP(a);var o=this.standardizeUserDataXY(n,r,!0,a);try{var s=o[0].concat(o[1]);this.makeTestFunction();var u=this.testFunction;return _a(this.testLoop(u,s,a,i.verbose,i.steps))}finally{Jh(o[0],n),Jh(o[1],r)}},t.prototype.evaluateDataset=function(n,r){return At(this,void 0,void 0,function(){return St(this,function(i){return this.makeTestFunction(),[2,jLe(this,n,r)]})})},t.prototype.checkNumSamples=function(n,r,i,a){var o;if(a===void 0&&(a="steps"),i!=null){if(o=null,r!=null)throw new ie("If "+a+" is set, batchSize must be null or undefined.Got batchSize = "+r)}else{if(n==null)throw new ie("Either the input data should have a defined shape, or "+a+" shoud be specified.");o=Array.isArray(n)?n[0].shape[0]:n.shape[0]}return o},t.prototype.execute=function(n,r){if(Array.isArray(r)&&r.length===0)throw new ie("`outputs` is an empty Array, which is not allowed.");var i=Array.isArray(r),a=i?r:[r],o=this.retrieveSymbolicTensors(a),s=new Jm;if(n instanceof Ht&&(n=[n]),Array.isArray(n)){if(n.length!==this.inputs.length)throw new ie("The number of inputs provided ("+n.length+") does not match the number of inputs of this model ("+this.inputs.length+").");for(var u=0;u<this.inputs.length;++u)s.add(this.inputs[u],n[u])}else for(var l=0,c=this.inputs;l<c.length;l++){var f=c[l],d=n[f.name];if(d==null)throw new ie("No value is provided for the model's input "+f.name);s.add(f,d)}var h=Bb(o,s);return i?h:h[0]},t.prototype.retrieveSymbolicTensors=function(n){for(var r=Gh(null,n.length),i=n.length,a=0,o=this.layers;a<o.length;a++){for(var s=o[a],u=Array.isArray(s.output)?s.output:[s.output],l=u.map(function(h){return h.name}),c=0;c<n.length;++c){var f=l.indexOf(n[c]);if(f!==-1&&(r[c]=u[f],i--),i===0)break}if(i===0)break}if(i>0){var d=[];throw r.forEach(function(h,p){h==null&&d.push(n[p])}),new ie("Cannot find SymbolicTensors for output name(s): "+JSON.stringify(d))}return r},t.prototype.predictLoop=function(n,r,i){var a=this;return r===void 0&&(r=32),i===void 0&&(i=!1),le(function(){var o=a.checkNumSamples(n);if(i)throw new $t("Verbose predictLoop() is not implemented yet.");for(var s=RP(o,r),u=a.outputs.map(function(f){return[]}),l=function(f){le(function(){var d=s[f][0],h=s[f][1],p=zb(n,d,h),g=[];if(Array.isArray(p))for(var m=0;m<p.length;++m)g.push({key:a.inputs[m],value:p[m]});else g.push({key:a.inputs[0],value:p});var v=new Jm(g);return Bb(a.outputs,v)}).forEach(function(d,h){return u[h].push(d)})},c=0;c<s.length;++c)l(c);return _a(u.map(function(f){return Hi(f,0)}))})},t.prototype.predict=function(n,r){r===void 0&&(r={});var i=pQ(n);vQ(i,this.inputNames,this.feedInputShapes,!1);try{var a=r.batchSize==null?32:r.batchSize;return NP(a),this.predictLoop(i,a)}finally{Jh(i,n)}},t.prototype.predictOnBatch=function(n){vQ(n,this.inputNames,this.feedInputShapes,!0);var r=(Array.isArray(n)?n[0]:n).shape[0];return this.predictLoop(n,r)},t.prototype.standardizeUserDataXY=function(n,r,i,a){if(this.optimizer_==null)throw new Xu("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");for(var o=[],s=0;s<this.feedOutputShapes.length;++s){var u=this.feedOutputShapes[s];this.feedLossFns[s]===zE?o.push(u.slice(0,u.length-1).concat([1])):o.push(u)}if(qLe(n=mQ(n,this.feedInputNames,this.feedInputShapes,!1,"input"),r=mQ(r,this.feedOutputNames,o,!1,"target")),HLe(r,this.feedLossFns,this.feedOutputShapes),this.stateful&&a!=null&&a>0&&n[0].shape[0]%a!=0)throw new ie("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+a+". Found: "+n[0].shape[0]+" sample(s).");return[n,r]},t.prototype.standardizeUserData=function(n,r,i,a,o,s){return o===void 0&&(o=!0),At(this,void 0,void 0,function(){var u,l,c,f,d,h,p,g;return St(this,function(m){switch(m.label){case 0:if(u=this.standardizeUserDataXY(n,r,o,s),l=u[0],c=u[1],i!=null)throw new Error("sample weight is not supported yet.");if(f=null,a==null)return[3,4];d=lQ(a,this.outputNames),f=[],h=0,m.label=1;case 1:return h<d.length?(g=(p=f).push,[4,cQ(c[h],null,d[h])]):[3,4];case 2:g.apply(p,[m.sent()]),m.label=3;case 3:return++h,[3,1];case 4:return[2,[l,c,f]]}})})},t.prototype.testLoop=function(n,r,i,a,o){var s=this;return a===void 0&&(a=0),le(function(){var u=s.checkNumSamples(r,i,o,"steps"),l=[];if(a>0)throw new $t("Verbose mode is not implemented yet.");if(o!=null)throw new $t("steps mode in testLoop() is not implemented yet");for(var c=RP(u,i),f=ba(Gs(0,u)),d=0;d<c.length;++d){var h=c[d][0],p=c[d][1],g=Yh(f,h,p-h),m=DP(r,g),v=n(m);if(d===0)for(var y=0;y<v.length;++y)l.push(Ve(0));for(y=0;y<v.length;++y){var b=v[y];l[y]=Wt(l[y],rt(p-h,b))}}for(y=0;y<l.length;++y)l[y]=Cr(l[y],u);return l})},t.prototype.getDedupedMetricsNames=function(){for(var n=this.metricsNames,r=[],i=0;i<n.length;++i){var a=n[i],o=a;mJ(n,a)>1&&(o+="_"+mJ(n.slice(0,i),a)),r.push(o)}return r},t.prototype.makeTrainFunction=function(){var n=this;return function(r){var i=[],a=r.slice(0,n.inputs.length),o=r.slice(n.inputs.length,n.inputs.length+n.outputs.length),s=r.slice(n.inputs.length+n.outputs.length,n.inputs.length+2*n.outputs.length),u=[],l=n.collectedTrainableWeights.map(function(c){return c.read()});return[n.optimizer_.minimize(function(){for(var c=[],f=0;f<n.inputs.length;++f)c.push({key:n.inputs[f],value:a[f]});var d,h=new Jm(c),p=Bb(n.outputs,h,{training:!0});for(f=0;f<n.lossFunctions.length;++f){var g=(0,n.lossFunctions[f])(o[f],p[f]);s[f]!=null&&(g=MLe(g,s[f]));var m=Fr(g);i.push(m),d=f===0?g:Wt(d,g)}for(f=0;f<n.metricsTensors.length;++f){var v=void 0;if(n.outputs.length>1&&f<n.outputs.length)v=i[f];else{var y=n.metricsTensors[f][0],b=n.metricsTensors[f][1];v=Fr(y(o[b],p[b]))}zu(v),u.push(v)}return d=Fr(d),n.calculateLosses().forEach(function(x){d=Wt(d,x)}),d},!0,l)].concat(u)}},t.prototype.makeTestFunction=function(){var n=this;this.testFunction=function(r){return le(function(){for(var i,a=[],o=r.slice(0,n.inputs.length),s=r.slice(n.inputs.length,n.inputs.length+n.outputs.length),u=[],l=0;l<n.inputs.length;++l)u.push({key:n.inputs[l],value:o[l]});var c=new Jm(u),f=Bb(n.outputs,c);for(l=0;l<n.lossFunctions.length;++l){var d=n.lossFunctions[l],h=Fr(d(s[l],f[l]));i=l===0?h:Wt(i,h),a.push(i)}for(l=0;l<n.metricsTensors.length;++l){var p=n.metricsTensors[l][0],g=n.metricsTensors[l][1],m=Fr(p(s[g],f[g]));a.push(m)}return a})}},t.prototype.fit=function(n,r,i){return i===void 0&&(i={}),At(this,void 0,void 0,function(){return St(this,function(a){return[2,WLe(this,n,r,i)]})})},t.prototype.fitDataset=function(n,r){return At(this,void 0,void 0,function(){return St(this,function(i){return[2,LLe(this,n,r)]})})},t.prototype.trainOnBatch=function(n,r){return At(this,void 0,void 0,function(){var i,a,o,s,u,l,c,f,d;return St(this,function(h){switch(h.label){case 0:return[4,this.standardizeUserData(n,r)];case 1:i=h.sent(),a=i[0],o=i[1],s=this.makeTrainFunction(),u=s(a.concat(o)),l=[],c=0,f=u,h.label=2;case 2:return c<f.length?[4,f[c].data()]:[3,5];case 3:d=h.sent(),l.push(d[0]),h.label=4;case 4:return c++,[3,2];case 5:return Ut(u),[2,_a(l)]}})})},t.prototype.getNamedWeights=function(n){for(var r=[],i=n!=null&&n.trainableOnly,a=i?this.trainableWeights:this.weights,o=this.getWeights(i),s=0;s<a.length;++s)i&&!a[s].trainable||r.push({name:a[s].originalName,tensor:o[s]});return r},Object.defineProperty(t.prototype,"stopTraining",{get:function(){return this.stopTraining_},set:function(n){this.stopTraining_=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"optimizer",{get:function(){return this.optimizer_},set:function(n){this.optimizer_!==n&&(this.optimizer_=n,this.isOptimizerOwned=!1)},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){var n=e.prototype.dispose.call(this);if(n.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){var r=CS().numTensors;this.optimizer_.dispose(),n.numDisposedVariables+=r-CS().numTensors}return n},t.prototype.getLossIdentifiers=function(){var n;if(typeof this.loss=="string")n=fc(this.loss);else if(Array.isArray(this.loss)){for(var r=0,i=this.loss;r<i.length;r++)if(typeof i[r]!="string")throw new Error("Serialization of non-string loss is not supported.");n=this.loss.map(function(c){return fc(c)})}else{var a=Object.keys(this.loss);n={};for(var o=this.loss,s=0,u=a;s<u.length;s++){var l=u[s];if(typeof o[l]!="string")throw new Error("Serialization of non-string loss is not supported.");n[l]=fc(o[l])}}return n},t.prototype.getMetricIdentifiers=function(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[fc(VE(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(function(i){return fc(VE(i))});var n={};for(var r in this.metrics)n[r]=fc(VE(this.metrics[r]));return n},t.prototype.getTrainingConfig=function(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}},t.prototype.loadTrainingConfig=function(n){if(n.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(n.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(n.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");var r,i,a=Xs(Lb(n.optimizer_config));if(typeof n.loss=="string")r=Kh(n.loss);else if(Array.isArray(n.loss))r=n.loss.map(function(s){return Kh(s)});else if(n.loss!=null)for(var o in r={},n.loss)r[o]=Kh(n.loss[o]);if(Array.isArray(n.metrics))i=n.metrics.map(function(s){return Kh(s)});else if(n.metrics!=null)for(var o in i={},n.metrics)i[o]=Kh(n.metrics[o]);this.compile({loss:r,metrics:i,optimizer:a})},t.prototype.save=function(n,r){return At(this,void 0,void 0,function(){var i,a,o,s,u,l,c,f,d,h,p,g,m,v;return St(this,function(y){switch(y.label){case 0:if(typeof n=="string"){if((i=wa.getSaveHandlers(n)).length===0)throw new ie("Cannot find any save handlers for URL '"+n+"'");if(i.length>1)throw new ie("Found more than one ("+i.length+") save handlers for URL '"+n+"'");n=i[0]}if(n.save==null)throw new ie("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return[4,wa.encodeWeights(this.getNamedWeights(r))];case 1:return a=y.sent(),o=!1,s=null,u=this.toJSON(s,o),l={modelTopology:u,format:KLe,generatedBy:"TensorFlow.js tfjs-layers v"+oQ,convertedBy:null},r!=null&&r.includeOptimizer&&this.optimizer!=null?(l.trainingConfig=this.getTrainingConfig(),c="optimizer",g=(p=wa).encodeWeights,[4,this.optimizer.getWeights()]):[3,4];case 2:return[4,g.apply(p,[y.sent(),c])];case 3:f=y.sent(),d=f.data,h=f.specs,(v=a.specs).push.apply(v,h),a.data=wa.concatenateArrayBuffers([a.data,d]),y.label=4;case 4:return this.userDefinedMetadata!=null&&(m=!0,iQ(this.userDefinedMetadata,this.name,m),l.userDefinedMetadata=this.userDefinedMetadata),l.weightData=a.data,l.weightSpecs=a.specs,[2,n.save(l)]}})})},t.prototype.setUserDefinedMetadata=function(n){iQ(n,this.name),this.userDefinedMetadata=n},t.prototype.getUserDefinedMetadata=function(){return this.userDefinedMetadata},t.className="Model",t}(RLe);function XLe(e,t){return At(this,void 0,void 0,function(){var n,r,i,a,o,s,u,l;return St(this,function(c){switch(c.label){case 0:return"modelTopology"in e||(e={modelTopology:e}),(n=(e=e).modelTopology).model_config!=null&&(n=n.model_config),r=Lb(n),i=Xs(r,t),e.weightsManifest==null?[3,2]:[4,wa.loadWeights(e.weightsManifest,e.pathPrefix,i.weights.map(function(f){return f.originalName}))];case 1:for(a=c.sent(),o={},s=0,u=i.weights;s<u.length;s++)l=u[s],o[l.originalName]=a[l.originalName];i.loadWeights(o),Ut(a),c.label=2;case 2:return[2,i]}})})}function YLe(e,t){return At(this,void 0,void 0,function(){var n;return St(this,function(r){if(t==null&&(t={}),typeof e=="string"){if((n=wa.getLoadHandlers(e,t.onProgress)).length===0)n.push(wa.browserHTTPRequest(e,t));else if(n.length>1)throw new ie("Found more than one ("+n.length+") load handlers for URL '"+e+"'");e=n[0]}return[2,ZLe(e,void 0,t)]})})}function ZLe(e,t,n){return At(this,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f;return St(this,function(d){switch(d.label){case 0:if(n==null&&(n={}),e.load==null)throw new ie("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return[4,e.load()];case 1:if(r=d.sent(),(i=r.modelTopology).model_config!=null&&(i=i.model_config),a=n.strict==null||n.strict,o=r.weightData!=null&&r.weightSpecs!=null&&a,s=Xs(Lb(i),t,o),(u=r.trainingConfig)!=null&&s.loadTrainingConfig(u),r.userDefinedMetadata!=null&&s.setUserDefinedMetadata(r.userDefinedMetadata),r.weightData==null)return[3,4];if(r.weightSpecs==null)throw new ie("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");return l=JLe(r.weightData,r.weightSpecs),c=l.modelWeights,f=l.optimizerWeights,s.loadWeights(c,a),s.optimizer!=null&&f.length>0?[4,s.optimizer.setWeights(f)]:[3,3];case 2:d.sent(),d.label=3;case 3:Ut(c),Ut(f.map(function(h){return h.tensor})),d.label=4;case 4:return[2,s]}})})}function JLe(e,t){var n=wa.decodeWeights(e,t),r={},i=[];return t.forEach(function(a){a.group==="optimizer"?i.push({name:a.name,tensor:n[a.name]}):r[a.name]=n[a.name]}),{modelWeights:r,optimizerWeights:i}}Ne.registerClass(jb);var yQ=function(e){function t(n){var r=e.call(this,{inputs:[],outputs:[]})||this;if(n=n||{},r.trainable=!0,r.built=!1,r.name=n.name!=null?n.name:FE("sequential_"),n.layers!=null)for(var i=0,a=n.layers;i<a.length;i++){var o=a[i];r.add(o)}return r}return Ee(t,e),t.prototype.checkShape=function(n){if(n.inboundNodes[0].outputTensors[0].shape.some(function(r){return r<0}))throw new ie("Negative dimension size caused by adding layer "+n.name+" with input shape ["+n.inboundNodes[0].inputTensors[0].shape+"]")},t.prototype.add=function(n){var r,i=n instanceof t||n instanceof jb;if(i){if((r=n).outputs.length!==1)throw new ie("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(r.inputs.length!==1)throw new ie("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(n.inboundNodes.length===0){if(n.batchInputShape==null)throw new ie("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");var a=KJ({batchShape:n.batchInputShape,dtype:n.dtype,name:n.name+"_input"});n.apply(a)}if(i)this.outputs=r.outputs,this.inputs=r.inputs;else{if(n.inboundNodes.length!==1)throw new ie("A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer "+n.name+" which has "+n.inboundNodes.length+" pre-existing inbound connections.");if(n.inboundNodes[0].outputTensors.length!==1)throw new ie("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(n),this.outputs=[n.inboundNodes[0].outputTensors[0]],this.inputs=HJ(this.outputs[0])}this.inboundNodes=[],new $E({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Gh(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(function(s){return s.shape}),outputShapes:this.outputs[0].shape})}else{var o=n.apply(this.outputs[0]);if(Array.isArray(o))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(n),this.outputs=[o],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(n),this.built=!1},t.prototype.pop=function(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{var n=this.layers.length-1;this.layers[n].outboundNodes=[],this.outputs=[this.layers[n].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}},t.prototype.call=function(n,r){return this.model==null&&this.build(),this.model.call(n,r)},t.prototype.build=function(n){if(Kn(n),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new jb({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0},t.prototype.countParams=function(){return this.built||this.build(),e.prototype.countParams.call(this)},t.prototype.summary=function(n,r,i){i===void 0&&(i=console.log),this.built||this.build(),e.prototype.summary.call(this,n,r,i)},t.prototype.setWeights=function(n){this.model==null&&this.build(),this.model.setWeights(n)},t.prototype.evaluate=function(n,r,i){if(i===void 0&&(i={}),!this.built)throw new Xu("The model needs to be compiled before being used.");return this.model.evaluate(n,r,i)},t.prototype.evaluateDataset=function(n,r){return At(this,void 0,void 0,function(){return St(this,function(i){if(!this.built)throw new Xu("The model needs to be compiled before being used.");return[2,this.model.evaluateDataset(n,r)]})})},t.prototype.predict=function(n,r){return r===void 0&&(r={}),this.model==null&&this.build(),this.model.predict(n,r)},t.prototype.predictOnBatch=function(n){return this.model==null&&this.build(),this.model.predictOnBatch(n)},t.prototype.compile=function(n){this.build(),this.model.compile(n),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames},Object.defineProperty(t.prototype,"optimizer",{get:function(){return this.model==null?void 0:this.model.optimizer},set:function(n){this.model.optimizer=n},enumerable:!0,configurable:!0}),t.prototype.fit=function(n,r,i){return i===void 0&&(i={}),At(this,void 0,void 0,function(){return St(this,function(a){if(!this.built)throw new Xu("The model needs to be compiled before being used.");return[2,this.model.fit(n,r,i)]})})},t.prototype.fitDataset=function(n,r){return At(this,void 0,void 0,function(){return St(this,function(i){if(!this.built)throw new Xu("The model needs to be compiled before being used.");return[2,this.model.fitDataset(n,r)]})})},t.prototype.trainOnBatch=function(n,r){return At(this,void 0,void 0,function(){return St(this,function(i){return[2,this.model.trainOnBatch(n,r)]})})},t.fromConfig=function(n,r,i,a){var o;a===void 0&&(a=!1);var s={};if(r instanceof Array){if(r[0].className==null||r[0].className==="Merge")throw new ie("Legacy serialization format not supported yet.");o=r}else pt.assert(r.layers!=null,function(){return"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."}),o=r.layers,delete r.layers,s=r;var u=new n(s);if(!(u instanceof t))throw new $t("Sequential.fromConfig called on non-Sequential input: "+u);for(var l=0,c=o;l<c.length;l++){var f=Xs(c[l],void 0,a);a&&f.setFastWeightInitDuringBuild(!0),u.add(f)}return u},Object.defineProperty(t.prototype,"stopTraining",{get:function(){if(this.model==null)throw new ie("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining},set:function(n){if(this.model==null)throw new ie("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=n},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){for(var n=[],r=0,i=this.layers;r<i.length;r++){var a=i[r],o={};o.className=a.getClassName(),o.config=a.getConfig(),n.push(o)}return{name:this.name,layers:n}},t.className="Sequential",t}(jb);function QLe(e){return new yQ(e)}function eBe(e,t){return t==null&&(t={}),YLe(e,t)}function tBe(e){return KJ(e)}Ne.registerClass(yQ);var Mo=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.getConfig=function(){return{}},t}(Ne.Serializable),nBe=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n,r){return r===void 0&&(r=1),_4e(n,r)},t.className="elu",t}(Mo);Ne.registerClass(nBe);var rBe=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return xE(n)},t.className="selu",t}(Mo);Ne.registerClass(rBe);var iBe=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return $f(n)},t.className="relu",t}(Mo);Ne.registerClass(iBe);var aBe=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return le(function(){return Am(6,$f(n))})},t.className="relu6",t}(Mo);Ne.registerClass(aBe);var oBe=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return n},t.className="linear",t}(Mo);Ne.registerClass(oBe);var sBe=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return $S(n)},t.className="sigmoid",t}(Mo);Ne.registerClass(sBe);var uBe=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return E4e(n)},t.className="hardSigmoid",t}(Mo);Ne.registerClass(uBe);var lBe=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return ub(n)},t.className="softplus",t}(Mo);Ne.registerClass(lBe);var cBe=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return S4e(n)},t.className="softsign",t}(Mo);Ne.registerClass(cBe);var fBe=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n){return LS(n)},t.className="tanh",t}(Mo);Ne.registerClass(fBe);var bQ=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n,r){return r===void 0&&(r=-1),Rh(n,r)},t.className="softmax",t}(Mo);Ne.registerClass(bQ);var dBe=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.apply=function(n,r){return r===void 0&&(r=-1),VS(n,r)},t.className="logSoftmax",t}(Mo);function Po(e){return e.getClassName()}function MP(e,t){return t===void 0&&(t={}),Ib(e,Ne.SerializationMap.getMap().classNameMap,t,"activation")}function Kf(e){var t;return e==null?MP(t={className:"linear",config:{}}):typeof e=="string"?((t={}).className=e,t.config={},MP(t)):e instanceof Mo?e:MP(e)}function PP(e){if(e!=null&&typeof e!="object")throw new Error("Argument to L1L2 regularizer's constructor is expected to be an object, but received: "+e)}Ne.registerClass(dBe);var xQ=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t}(Ne.Serializable),HE=function(e){function t(n){var r=e.call(this)||this;return PP(n),r.l1=n==null||n.l1==null?.01:n.l1,r.l2=n==null||n.l2==null?.01:n.l2,r.hasL1=r.l1!==0,r.hasL2=r.l2!==0,r}return Ee(t,e),t.prototype.apply=function(n){var r=this;return le(function(){var i=Tn([1]);return r.hasL1&&(i=Wt(i,qr(rt(r.l1,Df(n))))),r.hasL2&&(i=Wt(i,qr(rt(r.l2,Mb(n))))),i.asScalar()})},t.prototype.getConfig=function(){return{l1:this.l1,l2:this.l2}},t.fromConfig=function(n,r){return new n({l1:r.l1,l2:r.l2})},t.className="L1L2",t}(xQ);function hBe(e){return PP(e),new HE({l1:e!=null?e.l1:null,l2:0})}function pBe(e){return PP(e),new HE({l2:e!=null?e.l2:null,l1:0})}Ne.registerClass(HE);var wQ={l1l2:"L1L2"};function Vt(e){return oP(e)}function _Q(e,t){return t===void 0&&(t={}),Ib(e,Ne.SerializationMap.getMap().classNameMap,t,"regularizer")}function rr(e){return e==null?null:typeof e=="string"?_Q({className:e in wQ?wQ[e]:e,config:{}}):e instanceof xQ?e:_Q(e)}var SQ=function(e){function t(n){var r=e.call(this,n??{})||this;return r.supportsMasking=!0,n!=null&&(r.maxValue=n.maxValue),r}return Ee(t,e),t.prototype.call=function(n,r){n=Dt(n);var i=$f(n);return this.maxValue!=null&&(i=xa(i,0,this.maxValue)),i},t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n={maxValue:this.maxValue},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="ReLU",t}(tn);Ne.registerClass(SQ);var EQ=function(e){function t(n){var r=e.call(this,n??{})||this;return r.DEFAULT_ALPHA=.3,n==null&&(n={}),r.alpha=n.alpha==null?r.DEFAULT_ALPHA:n.alpha,r}return Ee(t,e),t.prototype.call=function(n,r){var i=Dt(n);return bE(i,this.alpha)},t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n={alpha:this.alpha},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="LeakyReLU",t}(tn);Ne.registerClass(EQ);var CQ=function(e){function t(n){var r=e.call(this,n??{})||this;if(r.DEFAULT_ALPHA_INITIALIZER="zeros",n==null&&(n={}),r.supportsMasking=!0,r.alphaInitializer=nr(n.alphaInitializer||r.DEFAULT_ALPHA_INITIALIZER),r.alphaRegularizer=rr(n.alphaRegularizer),r.alphaConstraint=Gr(n.alphaConstraint),n.sharedAxes==null)r.sharedAxes=null;else if(Array.isArray(n.sharedAxes))r.sharedAxes=n.sharedAxes;else{if(typeof n.sharedAxes!="number")throw new ie("Expected sharedAxes to be a number or an array of numbers, but got "+n.sharedAxes);r.sharedAxes=[n.sharedAxes]}return r}return Ee(t,e),t.prototype.build=function(n){var r=(n=Kn(n)).slice(1);if(this.sharedAxes!=null)for(var i=0,a=this.sharedAxes;i<a.length;i++)r[(s=a[i])-1]=1;this.alpha=this.addWeight("alpha",r,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);var o={};if(this.sharedAxes!=null)for(var s=1;s<n.length;++s)o[s]=n[s];this.inputSpec=[new Fi({ndim:n.length,axes:o})],this.built=!0},t.prototype.call=function(n,r){return n=Dt(n),Cb(n,this.alpha.read())},t.prototype.getConfig=function(){var n={alphaInitializer:vn(this.alphaInitializer),alphaRegularizer:Vt(this.alphaRegularizer),alphaConstraint:Ln(this.alphaConstraint),sharedAxes:this.sharedAxes},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="PReLU",t}(tn);Ne.registerClass(CQ);var AQ=function(e){function t(n){var r=e.call(this,n??{})||this;if(r.DEFAULT_ALPHA=1,n==null&&(n={}),n.alpha!=null&&n.alpha!==r.DEFAULT_ALPHA)throw new $t("Non-default alpha value ("+n.alpha+") is not supported by the ELU layer yet.");return r.alpha=n.alpha==null?r.DEFAULT_ALPHA:n.alpha,r}return Ee(t,e),t.prototype.call=function(n,r){var i=Dt(n);return Lm(i)},t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n={alpha:this.alpha},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="ELU",t}(tn);Ne.registerClass(AQ);var kQ=function(e){function t(n){var r=e.call(this,n??{})||this;return r.DEFAULT_THETA=1,n==null&&(n={}),r.theta=n.theta==null?r.DEFAULT_THETA:n.theta,r}return Ee(t,e),t.prototype.call=function(n,r){var i=Dt(n);return i.mul(Rb(i.greater(this.theta),"float32"))},t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n={theta:this.theta},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="ThresholdedReLU",t}(tn);Ne.registerClass(kQ);var TQ=function(e){function t(n){var r=e.call(this,n??{})||this;return r.DEFAULT_AXIS=1,n==null&&(n={}),r.softmax=new bQ().apply,r.axis=n.axis==null?r.DEFAULT_AXIS:n.axis,r}return Ee(t,e),t.prototype.call=function(n,r){var i=Dt(n);return this.softmax(i,this.axis)},t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n={axis:this.axis},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Softmax",t}(tn);function $P(e,t,n){if(typeof e=="number")return Gh(e,t);if(e.length!==t)throw new ie("The "+n+" argument must be an integer or tuple of "+t+" integers. Received: "+e.length+" elements.");for(var r=0;r<t;++r){var i=e[r];if(!y4e(i))throw new ie("The "+n+" argument must be an integer or tuple of "+t+" integers. Received: "+JSON.stringify(e)+" including a non-integer number "+i)}return e}function pc(e,t,n,r,i){return i===void 0&&(i=1),e==null?e:(a=n==="same"?e:e-(t+(t-1)*(i-1))+1,Math.floor((a+r-1)/r));var a}function GE(e,t,n,r){if(e==null)return null;if(r==="valid")e=e*t+Hf([n-t,0]);else{if(r!=="same")throw new ie("Unsupport padding mode: "+r+".");e*=t}return e}function LP(e,t){return le(function(){return Kr(t),t==="channelsFirst"?cn(e,[0,2,3,1]):e})}function OQ(e,t){return le(function(){return Kr(t),t==="channelsFirst"?cn(e,[0,2,3,4,1]):e})}function gBe(e,t,n,r,i,a,o){return r===void 0&&(r=1),i===void 0&&(i="valid"),o===void 0&&(o=1),le(function(){if(a==null&&(a=Hs()),Kr(a),e.shape.length!==3)throw new ie("The input of a conv1dWithBias operation should be 3, but is "+e.shape.length+" instead.");if(t.shape.length!==3)throw new ie("The kernel for a conv1dWithBias operation should be 3, but is "+t.shape.length+" instead");if(n!=null&&n.shape.length!==1)throw new ie("The bias for a conv1dWithBias operation should be 1, but is "+t.shape.length+" instead");if(a==="channelsFirst"&&(e=cn(e,[0,2,1])),i==="causal")throw new $t("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");var s=sE(e,t,r,i==="same"?"same":"valid","NWC",o);return n!=null&&(s=hc(s,n)),s})}function IQ(e,t,n,r,i,a,o,s){return r===void 0&&(r=[1,1]),i===void 0&&(i="valid"),s===void 0&&(s=null),le(function(){if(a==null&&(a=Hs()),Kr(a),e.rank!==3&&e.rank!==4)throw new ie("conv2dWithBiasActivation expects input to be of rank 3 or 4, but received "+e.rank+".");if(t.rank!==3&&t.rank!==4)throw new ie("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received "+e.rank+".");var u=LP(e,a);if(i==="causal")throw new $t("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return u=Bf.conv2d({x:u,filter:t,strides:r,pad:i==="same"?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:s}),a==="channelsFirst"&&(u=cn(u,[0,3,1,2])),u})}function mBe(e,t,n,r,i,a,o){return r===void 0&&(r=[1,1,1]),i===void 0&&(i="valid"),le(function(){if(a==null&&(a=Hs()),Kr(a),e.rank!==4&&e.rank!==5)throw new ie("conv3dWithBias expects input to be of rank 4 or 5, but received "+e.rank+".");if(t.rank!==4&&t.rank!==5)throw new ie("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+e.rank+".");var s=OQ(e,a);if(i==="causal")throw new $t("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return s=uE(s,t,r,i==="same"?"same":"valid","NDHWC",o),n!=null&&(s=hc(s,n)),a==="channelsFirst"&&(s=cn(s,[0,4,1,2,3])),s})}Ne.registerClass(TQ);var NQ=function(e){function t(n,r){var i=e.call(this,r)||this;if(i.bias=null,i.DEFAULT_KERNEL_INITIALIZER="glorotNormal",i.DEFAULT_BIAS_INITIALIZER="zeros",t.verifyArgs(r),i.rank=n,Sa(i.rank,"rank"),i.rank!==1&&i.rank!==2&&i.rank!==3)throw new $t("Convolution layer for rank other than 1, 2, or 3 ("+i.rank+") is not implemented yet.");if(i.kernelSize=$P(r.kernelSize,n,"kernelSize"),i.strides=$P(r.strides==null?1:r.strides,n,"strides"),i.padding=r.padding==null?"valid":r.padding,ss(i.padding),i.dataFormat=r.dataFormat==null?"channelsLast":r.dataFormat,Kr(i.dataFormat),i.activation=Kf(r.activation),i.useBias=r.useBias==null||r.useBias,i.biasInitializer=nr(r.biasInitializer||i.DEFAULT_BIAS_INITIALIZER),i.biasConstraint=Gr(r.biasConstraint),i.biasRegularizer=rr(r.biasRegularizer),i.activityRegularizer=rr(r.activityRegularizer),i.dilationRate=$P(r.dilationRate==null?1:r.dilationRate,n,"dilationRate"),i.rank===1&&Array.isArray(i.dilationRate)&&i.dilationRate.length!==1)throw new ie("dilationRate must be a number or an array of a single number for 1D convolution, but received "+JSON.stringify(i.dilationRate));if(i.rank===2){if(typeof i.dilationRate=="number")i.dilationRate=[i.dilationRate,i.dilationRate];else if(i.dilationRate.length!==2)throw new ie("dilationRate must be a number or array of two numbers for 2D convolution, but received "+JSON.stringify(i.dilationRate))}else if(i.rank===3){if(typeof i.dilationRate=="number")i.dilationRate=[i.dilationRate,i.dilationRate,i.dilationRate];else if(i.dilationRate.length!==3)throw new ie("dilationRate must be a number or array of three numbers for 3D convolution, but received "+JSON.stringify(i.dilationRate))}return i}return Ee(t,e),t.verifyArgs=function(n){if(Yu("kernelSize"in n,"required key 'kernelSize' not in config"),typeof n.kernelSize!="number"&&!uP(n.kernelSize,"number",1,3))throw new ie("BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received "+JSON.stringify(n.kernelSize)+".")},t.prototype.getConfig=function(){var n={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Po(this.activation),useBias:this.useBias,biasInitializer:vn(this.biasInitializer),biasRegularizer:Vt(this.biasRegularizer),activityRegularizer:Vt(this.activityRegularizer),biasConstraint:Ln(this.biasConstraint)},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t}(tn),KE=function(e){function t(n,r){var i=e.call(this,n,r)||this;return i.kernel=null,t.verifyArgs(r),i.filters=r.filters,Sa(i.filters,"filters"),i.kernelInitializer=nr(r.kernelInitializer||i.DEFAULT_KERNEL_INITIALIZER),i.kernelConstraint=Gr(r.kernelConstraint),i.kernelRegularizer=rr(r.kernelRegularizer),i}return Ee(t,e),t.prototype.build=function(n){var r;n=Kn(n);var i=this.dataFormat==="channelsFirst"?1:n.length-1;if(n[i]==null)throw new ie("The channel dimension of the input should be defined. Found "+n[i]);var a=n[i],o=this.kernelSize.concat([a,this.filters]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:(r={},r[i]=a,r)}],this.built=!0},t.prototype.call=function(n,r){var i=this;return le(function(){var a;n=Dt(n);var o=i.bias==null?null:i.bias.read(),s=yJ(i.activation.getClassName());if(s!=null&&i.rank===2)a=IQ(n,i.kernel.read(),o,i.strides,i.padding,i.dataFormat,i.dilationRate,s);else{if(i.rank===1)a=gBe(n,i.kernel.read(),o,i.strides[0],i.padding,i.dataFormat,i.dilationRate[0]);else if(i.rank===2)a=IQ(n,i.kernel.read(),o,i.strides,i.padding,i.dataFormat,i.dilationRate);else{if(i.rank!==3)throw new $t("convolutions greater than 3D are not implemented yet.");a=mBe(n,i.kernel.read(),o,i.strides,i.padding,i.dataFormat,i.dilationRate)}i.activation!=null&&(a=i.activation.apply(a))}return a})},t.prototype.computeOutputShape=function(n){n=Kn(n);for(var r=[],i=this.dataFormat==="channelsLast"?n.slice(1,n.length-1):n.slice(2),a=0;a<i.length;++a){var o=pc(i[a],this.kernelSize[a],this.padding,this.strides[a],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[a]);r.push(o)}var s=[n[0]];return this.dataFormat==="channelsLast"?(s=s.concat(r)).push(this.filters):(s.push(this.filters),s=s.concat(r)),s},t.prototype.getConfig=function(){var n={filters:this.filters,kernelInitializer:vn(this.kernelInitializer),kernelRegularizer:Vt(this.kernelRegularizer),kernelConstraint:Ln(this.kernelConstraint)},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.verifyArgs=function(n){if(!("filters"in n)||typeof n.filters!="number"||n.filters<1)throw new ie("Convolution layer expected config.filters to be a 'number' > 0 but got "+JSON.stringify(n.filters))},t}(NQ),BP=function(e){function t(n){var r=e.call(this,2,n)||this;return t.verifyArgs(n),r}return Ee(t,e),t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this);return delete n.rank,n},t.verifyArgs=function(n){if(typeof n.kernelSize!="number"&&!uP(n.kernelSize,"number",1,2))throw new ie("Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received "+JSON.stringify(n.kernelSize)+".")},t.className="Conv2D",t}(KE);Ne.registerClass(BP);var DQ=function(e){function t(n){var r=e.call(this,3,n)||this;return t.verifyArgs(n),r}return Ee(t,e),t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this);return delete n.rank,n},t.verifyArgs=function(n){if(typeof n.kernelSize!="number"&&(!Array.isArray(n.kernelSize)||n.kernelSize.length!==1&&n.kernelSize.length!==3))throw new ie("Conv3D expects config.kernelSize to be number or [number, number, number], but received "+JSON.stringify(n.kernelSize)+".")},t.className="Conv3D",t}(KE);Ne.registerClass(DQ);var RQ=function(e){function t(n){var r=e.call(this,n)||this;if(r.inputSpec=[new Fi({ndim:4})],r.padding!=="same"&&r.padding!=="valid")throw new ie("Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode "+r.padding);return r}return Ee(t,e),t.prototype.build=function(n){var r;if((n=Kn(n)).length!==4)throw new ie("Input should have rank 4; Received input shape: "+JSON.stringify(n));var i=this.dataFormat==="channelsFirst"?1:n.length-1;if(n[i]==null)throw new ie("The channel dimension of the inputs should be defined. Found `None`.");var a=n[i],o=this.kernelSize.concat([this.filters,a]);this.kernel=this.addWeight("kernel",o,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Fi({ndim:4,axes:(r={},r[i]=a,r)})],this.built=!0},t.prototype.call=function(n,r){var i=this;return le(function(){var a=Dt(n);if(a.shape.length!==4)throw new ie("Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-"+a.shape.length);var o,s,u=a.shape,l=u[0];i.dataFormat==="channelsFirst"?(o=2,s=3):(o=1,s=2);var c=u[o],f=u[s],d=i.kernelSize[0],h=i.kernelSize[1],p=i.strides[0],g=i.strides[1],m=[l,GE(c,p,d,i.padding),GE(f,g,h,i.padding),i.filters];i.dataFormat!=="channelsLast"&&(a=cn(a,[0,2,3,1]));var v=lE(a,i.kernel.read(),m,i.strides,i.padding);return i.dataFormat!=="channelsLast"&&(v=cn(v,[0,3,1,2])),i.bias!=null&&(v=hc(v,i.bias.read(),i.dataFormat)),i.activation!=null&&(v=i.activation.apply(v)),v})},t.prototype.computeOutputShape=function(n){var r,i,a,o=(n=Kn(n)).slice();this.dataFormat==="channelsFirst"?(r=1,i=2,a=3):(r=3,i=1,a=2);var s=this.kernelSize[0],u=this.kernelSize[1],l=this.strides[0],c=this.strides[1];return o[r]=this.filters,o[i]=GE(o[i],l,s,this.padding),o[a]=GE(o[a],c,u,this.padding),o},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this);return delete n.dilationRate,n},t.className="Conv2DTranspose",t}(BP);Ne.registerClass(RQ);var vBe=function(e){function t(n,r){var i=e.call(this,n,r)||this;if(i.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",i.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",i.depthwiseKernel=null,i.pointwiseKernel=null,r.filters==null)throw new ie("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(r.kernelInitializer!=null||r.kernelRegularizer!=null||r.kernelConstraint!=null)throw new ie("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(r.padding!=null&&r.padding!=="same"&&r.padding!=="valid")throw new ie("SeparableConv"+i.rank+"D supports only padding modes: 'same' and 'valid', but received "+JSON.stringify(r.padding));return i.depthMultiplier=r.depthMultiplier==null?1:r.depthMultiplier,i.depthwiseInitializer=nr(r.depthwiseInitializer||i.DEFAULT_DEPTHWISE_INITIALIZER),i.depthwiseRegularizer=rr(r.depthwiseRegularizer),i.depthwiseConstraint=Gr(r.depthwiseConstraint),i.pointwiseInitializer=nr(r.depthwiseInitializer||i.DEFAULT_POINTWISE_INITIALIZER),i.pointwiseRegularizer=rr(r.pointwiseRegularizer),i.pointwiseConstraint=Gr(r.pointwiseConstraint),i}return Ee(t,e),t.prototype.build=function(n){var r;if((n=Kn(n)).length<this.rank+2)throw new ie("Inputs to SeparableConv"+this.rank+"D should have rank "+(this.rank+2)+", but received input shape: "+JSON.stringify(n));var i=this.dataFormat==="channelsFirst"?1:n.length-1;if(n[i]==null||n[i]<0)throw new ie("The channel dimension of the inputs should be defined, but found "+JSON.stringify(n[i]));for(var a=n[i],o=this.kernelSize.concat([a,this.depthMultiplier]),s=[],u=0;u<this.rank;++u)s.push(1);s.push(a*this.depthMultiplier,this.filters),this.depthwiseKernel=this.addWeight("depthwise_kernel",o,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",s,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,!0,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.inputSpec=[new Fi({ndim:this.rank+2,axes:(r={},r[i]=a,r)})],this.built=!0},t.prototype.call=function(n,r){var i=this;return le(function(){var a;if(n=Dt(n),i.rank===1)throw new $t("1D separable convolution is not implemented yet.");return i.rank===2&&(i.dataFormat==="channelsFirst"&&(n=cn(n,[0,2,3,1])),a=wM(n,i.depthwiseKernel.read(),i.pointwiseKernel.read(),i.strides,i.padding,i.dilationRate,"NHWC")),i.useBias&&(a=hc(a,i.bias.read(),i.dataFormat)),i.activation!=null&&(a=i.activation.apply(a)),i.dataFormat==="channelsFirst"&&(a=cn(a,[0,3,1,2])),a})},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this);return delete n.rank,delete n.kernelInitializer,delete n.kernelRegularizer,delete n.kernelConstraint,n.depthwiseInitializer=vn(this.depthwiseInitializer),n.pointwiseInitializer=vn(this.pointwiseInitializer),n.depthwiseRegularizer=Vt(this.depthwiseRegularizer),n.pointwiseRegularizer=Vt(this.pointwiseRegularizer),n.depthwiseConstraint=Ln(this.depthwiseConstraint),n.pointwiseConstraint=Ln(this.pointwiseConstraint),n},t.className="SeparableConv",t}(KE),FQ=function(e){function t(n){return e.call(this,2,n)||this}return Ee(t,e),t.className="SeparableConv2D",t}(vBe);Ne.registerClass(FQ);var MQ=function(e){function t(n){var r=e.call(this,1,n)||this;return t.verifyArgs(n),r.inputSpec=[{ndim:3}],r}return Ee(t,e),t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this);return delete n.rank,delete n.dataFormat,n},t.verifyArgs=function(n){if(typeof n.kernelSize!="number"&&!uP(n.kernelSize,"number",1,1))throw new ie("Conv1D expects config.kernelSize to be number or number[] with length 1, but received "+JSON.stringify(n.kernelSize)+".")},t.className="Conv1D",t}(KE);Ne.registerClass(MQ);var PQ=function(e){function t(n){var r=e.call(this,n)||this;return typeof n.cropping=="number"?r.cropping=[[n.cropping,n.cropping],[n.cropping,n.cropping]]:typeof n.cropping[0]=="number"?r.cropping=[[n.cropping[0],n.cropping[0]],[n.cropping[1],n.cropping[1]]]:r.cropping=n.cropping,r.dataFormat=n.dataFormat===void 0?"channelsLast":n.dataFormat,r.inputSpec=[{ndim:4}],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){return this.dataFormat==="channelsFirst"?[n[0],n[1],n[2]-this.cropping[0][0]-this.cropping[0][1],n[3]-this.cropping[1][0]-this.cropping[1][1]]:[n[0],n[1]-this.cropping[0][0]-this.cropping[0][1],n[2]-this.cropping[1][0]-this.cropping[1][1],n[3]]},t.prototype.call=function(n,r){var i=this;return le(function(){return n=Dt(n),i.dataFormat==="channelsLast"?NE(NE(n,i.cropping[0][0],n.shape[1]-i.cropping[0][0]-i.cropping[0][1],2),i.cropping[1][0],n.shape[2]-i.cropping[1][1]-i.cropping[1][0],3):NE(NE(n,i.cropping[0][0],n.shape[2]-i.cropping[0][0]-i.cropping[0][1],3),i.cropping[1][0],n.shape[3]-i.cropping[1][1]-i.cropping[1][0],4)})},t.prototype.getConfig=function(){var n={cropping:this.cropping,dataFormat:this.dataFormat},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Cropping2D",t}(tn);Ne.registerClass(PQ);var $Q=function(e){function t(n){var r=e.call(this,n)||this;return r.DEFAULT_SIZE=[2,2],r.inputSpec=[{ndim:4}],r.size=n.size==null?r.DEFAULT_SIZE:n.size,r.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,r}return Ee(t,e),t.prototype.computeOutputShape=function(n){if(this.dataFormat==="channelsFirst"){var r=n[2]==null?null:this.size[0]*n[2],i=n[3]==null?null:this.size[1]*n[3];return[n[0],n[1],r,i]}return r=n[1]==null?null:this.size[0]*n[1],i=n[2]==null?null:this.size[1]*n[2],[n[0],r,i,n[3]]},t.prototype.call=function(n,r){var i=this;return le(function(){var a=Dt(n),o=a.shape;if(i.dataFormat==="channelsFirst"){a=cn(a,[0,2,3,1]);var s=i.size[0]*o[2],u=i.size[1]*o[3],l=a.resizeNearestNeighbor([s,u]);return cn(l,[0,3,1,2])}return s=i.size[0]*o[1],u=i.size[1]*o[2],a.resizeNearestNeighbor([s,u])})},t.prototype.getConfig=function(){var n={size:this.size,dataFormat:this.dataFormat},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="UpSampling2D",t}(tn);function yBe(e,t,n,r,i,a){return n===void 0&&(n=[1,1]),r===void 0&&(r="valid"),le(function(){i==null&&(i=Hs()),Kr(i);var o=LP(e,i);if(e.rank!==4)throw new ie("Input for depthwiseConv2d is required to be 4-D, but is instead "+e.rank+"-D");if(t.rank!==4)throw new ie("depthwiseKernel is required to be 4-D, but is instead "+t.rank+"-D");return o=Pm(o,t,n,r==="same"?"same":"valid","NHWC",a),i==="channelsFirst"&&(o=cn(o,[0,3,1,2])),o})}Ne.registerClass($Q);var LQ=function(e){function t(n){var r=e.call(this,2,n)||this;return r.depthwiseKernel=null,r.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,r.depthwiseInitializer=nr(n.depthwiseInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.depthwiseConstraint=Gr(n.depthwiseConstraint),r.depthwiseRegularizer=rr(n.depthwiseRegularizer),r}return Ee(t,e),t.prototype.build=function(n){if((n=Kn(n)).length<4)throw new ie("Inputs to DepthwiseConv2D should have rank 4. Received input shape: "+JSON.stringify(n)+".");var r=this.dataFormat==="channelsFirst"?1:3;if(n[r]==null||n[r]<0)throw new ie("The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not ("+n[r]+").");var i=n[r],a=[this.kernelSize[0],this.kernelSize[1],i,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",a,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[i*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},t.prototype.call=function(n,r){var i=this;return le(function(){var a=yBe(n=Dt(n),i.depthwiseKernel.read(),i.strides,i.padding,i.dataFormat,null);return i.useBias&&(a=hc(a,i.bias.read(),i.dataFormat)),i.activation!=null&&(a=i.activation.apply(a)),a})},t.prototype.computeOutputShape=function(n){n=Kn(n);var r=this.dataFormat==="channelsFirst"?n[2]:n[1],i=this.dataFormat==="channelsFirst"?n[3]:n[2],a=this.dataFormat==="channelsFirst"?n[1]*this.depthMultiplier:n[3]*this.depthMultiplier,o=pc(r,this.kernelSize[0],this.padding,this.strides[0]),s=pc(i,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[n[0],a,o,s]:[n[0],o,s,a]},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this);return n.depthMultiplier=this.depthMultiplier,n.depthwiseInitializer=vn(this.depthwiseInitializer),n.depthwiseRegularizer=Vt(this.depthwiseRegularizer),n.depthwiseConstraint=Ln(this.depthwiseRegularizer),n},t.className="DepthwiseConv2D",t}(NQ);Ne.registerClass(LQ);var zP=function(e){function t(n){var r=e.call(this,n)||this;return r.rate=Math.max(Math.min(n.rate,1),0),r.noiseShape=n.noiseShape,r.seed=n.seed,r.supportsMasking=!0,r}return Ee(t,e),t.prototype.getNoiseShape=function(n){if(this.noiseShape==null)return this.noiseShape;for(var r=n.shape,i=[],a=0;a<this.noiseShape.length;++a)i.push(this.noiseShape[a]==null?r[a]:this.noiseShape[a]);return i},t.prototype.call=function(n,r){var i=this;return le(function(){i.invokeCallHook(n,r);var a=Dt(n);if(0<i.rate&&i.rate<1){var o=r.training!=null&&r.training,s=i.getNoiseShape(a);return Xm(function(){return FJ(a,i.rate,s,i.seed)},function(){return a},o)}return n})},t.prototype.getConfig=function(){var n={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.prototype.dispose=function(){return e.prototype.dispose.call(this)},t.className="Dropout",t}(tn);Ne.registerClass(zP);var BQ=function(e){function t(n){var r=e.call(this,n)||this;return r.inputSpec=[{ndim:3}],r}return Ee(t,e),t.prototype.getNoiseShape=function(n){var r=n.shape;return[r[0],1,r[2]]},t.className="SpatialDropout1D",t}(zP);Ne.registerClass(BQ);var zQ=function(e){function t(n){var r=e.call(this,n)||this;if(r.activation=null,r.useBias=!0,r.kernel=null,r.bias=null,r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_BIAS_INITIALIZER="zeros",n.batchInputShape==null&&n.inputShape==null&&n.inputDim!=null){var i=null;n.batchSize!=null&&(i=n.batchSize),r.batchInputShape=[i,n.inputDim]}return r.units=n.units,Sa(r.units,"units"),r.activation=Kf(n.activation),n.useBias!=null&&(r.useBias=n.useBias),r.kernelInitializer=nr(n.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.biasInitializer=nr(n.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelConstraint=Gr(n.kernelConstraint),r.biasConstraint=Gr(n.biasConstraint),r.kernelRegularizer=rr(n.kernelRegularizer),r.biasRegularizer=rr(n.biasRegularizer),r.activityRegularizer=rr(n.activityRegularizer),r.supportsMasking=!0,r.inputSpec=[{minNDim:2}],r}return Ee(t,e),t.prototype.build=function(n){var r,i=(n=Kn(n))[n.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[i,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:(r={},r[-1]=i,r)}],this.built=!0},t.prototype.computeOutputShape=function(n){var r=(n=Kn(n)).slice();return r[r.length-1]=this.units,r},t.prototype.call=function(n,r){var i=this;return le(function(){i.invokeCallHook(n,r);var a,o=Dt(n),s=yJ(i.activation.getClassName());return s!=null?a=dc(o,i.kernel.read(),s,i.bias?i.bias.read():null):(a=dc(o,i.kernel.read()),i.bias!=null&&(a=hc(a,i.bias.read())),i.activation!=null&&(a=i.activation.apply(a))),a})},t.prototype.getConfig=function(){var n={units:this.units,activation:Po(this.activation),useBias:this.useBias,kernelInitializer:vn(this.kernelInitializer),biasInitializer:vn(this.biasInitializer),kernelRegularizer:Vt(this.kernelRegularizer),biasRegularizer:Vt(this.biasRegularizer),activityRegularizer:Vt(this.activityRegularizer),kernelConstraint:Ln(this.kernelConstraint),biasConstraint:Ln(this.biasConstraint)},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Dense",t}(tn);Ne.registerClass(zQ);var jQ=function(e){function t(n){var r=this;return n=n||{},(r=e.call(this,n)||this).inputSpec=[{minNDim:3}],r.dataFormat=n.dataFormat,r}return Ee(t,e),t.prototype.computeOutputShape=function(n){for(var r=0,i=(n=Kn(n)).slice(1);r<i.length;r++)if(i[r]==null)throw new ie('The shape of the input to "Flatten" is not fully defined (got '+n.slice(1)+'). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.');return[n[0],qf(n,1)]},t.prototype.call=function(n,r){var i=this;return le(function(){i.invokeCallHook(n,r);var a=Dt(n);if(i.dataFormat==="channelsFirst"&&a.rank>1){for(var o=[0],s=2;s<a.rank;++s)o.push(s);o.push(1),a=a.transpose(o)}return w4e(a)})},t.prototype.getConfig=function(){var n={};this.dataFormat!=null&&(n.dataFormat=this.dataFormat);var r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Flatten",t}(tn);Ne.registerClass(jQ);var UQ=function(e){function t(n){var r=e.call(this,n)||this;return r.supportsMasking=!0,r.activation=Kf(n.activation),r}return Ee(t,e),t.prototype.call=function(n,r){var i=this;return le(function(){i.invokeCallHook(n,r);var a=Dt(n);return i.activation.apply(a)})},t.prototype.getConfig=function(){var n={activation:Po(this.activation)},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Activation",t}(tn);Ne.registerClass(UQ);var WQ=function(e){function t(n){var r=e.call(this,n)||this;return r.n=n.n,r.inputSpec=[{ndim:2}],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){return[n[0],this.n,n[1]]},t.prototype.call=function(n,r){var i=this;return le(function(){return b4e(n=Dt(n),i.n)})},t.prototype.getConfig=function(){var n={n:this.n},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="RepeatVector",t}(tn);Ne.registerClass(WQ);var VQ=function(e){function t(n){var r=e.call(this,n)||this;r.targetShape=n.targetShape;for(var i=0;i<r.targetShape.length;++i)r.isUnknown(r.targetShape[i])&&(r.targetShape[i]=null);return r}return Ee(t,e),t.prototype.isUnknown=function(n){return n<0||n==null},t.prototype.fixUnknownDimension=function(n,r){for(var i="Total size of new array must be unchanged.",a=r.slice(),o=1,s=null,u=0;u<a.length;++u){var l=a[u];if(this.isUnknown(l)){if(s!==null)throw new ie("Can only specifiy one unknown dimension.");s=u}else o*=l}var c=qf(n);if(s!==null){if(o===0||c%o!=0)throw new ie(i);a[s]=c/o}else if(c!==o)throw new ie(i);return a},t.prototype.computeOutputShape=function(n){for(var r=!1,i=0;i<n.length;++i)if(this.isUnknown(n[i])){r=!0;break}return r?n.slice(0,1).concat(this.targetShape):n.slice(0,1).concat(this.fixUnknownDimension(n.slice(1),this.targetShape))},t.prototype.call=function(n,r){var i=this;return le(function(){i.invokeCallHook(n,r);var a=Dt(n),o=a.shape,s=o.slice(0,1).concat(i.fixUnknownDimension(o.slice(1),i.targetShape));return a.reshape(s)})},t.prototype.getConfig=function(){var n={targetShape:this.targetShape},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Reshape",t}(tn);Ne.registerClass(VQ);var qQ=function(e){function t(n){var r=e.call(this,n)||this;if(n.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(n.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+n.dims+" instead.");var i=Gs(1,n.dims.length+1);if(!pt.arraysEqual(n.dims.slice().sort(),i))throw new Error("Invalid permutation `dims`: "+JSON.stringify(n.dims)+" `dims` must contain consecutive integers starting from 1.");return r.dims=n.dims,r.dimsIncludingBatch=[0].concat(r.dims),r.inputSpec=[new Fi({ndim:r.dims.length+1})],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){var r=(n=Kn(n)).slice();return this.dims.forEach(function(i,a){r[a+1]=n[i]}),r},t.prototype.call=function(n,r){return cn(Dt(n),this.dimsIncludingBatch)},t.prototype.getConfig=function(){var n={dims:this.dims},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Permute",t}(tn);Ne.registerClass(qQ);var HQ=function(e){function t(n){var r=e.call(this,n??{})||this;return r.supportsMasking=!0,r.maskValue=n!=null?n.maskValue==null?0:n.maskValue:0,r}return Ee(t,e),t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this),r={maskValue:this.maskValue};return Object.assign(r,n),r},t.prototype.computeMask=function(n,r){var i=Dt(n);return _b(Fm(i,this.maskValue),-1)},t.prototype.call=function(n,r){var i=this;return le(function(){i.invokeCallHook(n,r);var a=Dt(n),o=_b(Fm(a,i.maskValue),-1,!0);return a.mul(o.asType(a.dtype))})},t.className="Masking",t}(tn);Ne.registerClass(HQ);var GQ=function(e){function t(n){var r=e.call(this,n)||this;if(r.embeddings=null,r.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",n.batchInputShape==null&&n.inputShape==null){var i=null;n.batchSize!=null&&(i=n.batchSize),n.inputLength==null?r.batchInputShape=[i,null]:r.batchInputShape=[i].concat(Jn(n.inputLength))}return r.inputDim=n.inputDim,Sa(r.inputDim,"inputDim"),r.outputDim=n.outputDim,Sa(r.outputDim,"outputDim"),r.embeddingsInitializer=nr(n.embeddingsInitializer||r.DEFAULT_EMBEDDINGS_INITIALIZER),r.embeddingsRegularizer=rr(n.embeddingsRegularizer),r.activityRegularizer=rr(n.activityRegularizer),r.embeddingsConstraint=Gr(n.embeddingsConstraint),r.maskZero=n.maskZero,r.supportsMasking=n.maskZero,r.inputLength=n.inputLength,r}return Ee(t,e),t.prototype.build=function(n){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0},t.prototype.warnOnIncompatibleInputShape=function(n){},t.prototype.computeMask=function(n,r){var i=this;return le(function(){return i.maskZero?(n=Dt(n),Fm(n,en(n))):null})},t.prototype.computeOutputShape=function(n){if(n=Kn(n),this.inputLength==null)return n.concat([this.outputDim]);var r=Jn(this.inputLength);if(r.length!==n.length-1)throw new ie('"inputLength" is '+this.inputLength+", but received input shape has shape "+n);for(var i=0,a=0;a<r.length;++a){var o=r[a],s=n[a+1];if(o!=null&&s!=null&&o!==s)throw new ie('"inputLength" is '+this.inputLength+", but received input shape has shape "+n);o==null&&(r[i]=s),i++}return[n[0]].concat(r,[this.outputDim])},t.prototype.call=function(n,r){var i=this;return le(function(){i.invokeCallHook(n,r);var a=Dt(n);return a.dtype!=="int32"&&(a=Rb(a,"int32")),RJ(i.embeddings.read(),a.as1D()).reshape(Kn(i.computeOutputShape(a.shape)))})},t.prototype.getConfig=function(){var n={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:vn(this.embeddingsInitializer),embeddingsRegularizer:Vt(this.embeddingsRegularizer),activityRegularizer:Vt(this.activityRegularizer),embeddingsConstraint:Ln(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Embedding",t}(tn);Ne.registerClass(GQ);var Qh=function(e){function t(n){var r=e.call(this,n||{})||this;return r.supportsMasking=!0,r}return Ee(t,e),t.prototype.mergeFunction=function(n){throw new $t},t.prototype.computeElementwiseOpOutputShape=function(n,r){if(n==null||r==null)return null;if(n.length<r.length)return this.computeElementwiseOpOutputShape(r,n);if(r.length===0)return n;for(var i=n.slice(0,n.length-r.length),a=0;a<r.length;++a){var o=n[n.length-r.length+a],s=r[a];if(o==null||s==null||o<0||s<0)i.push(null);else if(o===1)i.push(s);else if(s===1)i.push(o);else{if(o!==s)throw new ie("Operands could not be broadcast together with shapes "+JSON.stringify(n)+" "+JSON.stringify(r));i.push(o)}}return i},t.prototype.build=function(n){if(Array.isArray(n)&&!Array.isArray(n[0])&&(n=[Kn(n)]),(n=n).length<2)throw new ie("A merge layer should be called on an Array of at least 2 inputs. Got "+n.length+" input(s).");for(var r=[],i=0,a=n;i<a.length;i++)(u=a[i])!=null&&u[0]!==null&&r.push(u[0]);if((r=Vf(r)).length>1)throw new ie("Can not merge tensors with different batch sizes. Got tensors with shapes: "+JSON.stringify(n)+".");for(var o=n[0]==null?null:n[0].slice(1),s=1;s<n.length;++s){var u=n[s]==null?null:n[s].slice(1);o=this.computeElementwiseOpOutputShape(o,u)}var l=n.map(function(c){return c.length});n.indexOf(null)===-1&&Vf(l).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0},t.prototype.call=function(n,r){var i=this;return le(function(){if(n=n,i.reshapeRequired){var a=[],o=n.map(function(_){return _.rank});if(o.indexOf(null)===-1){for(var s=Hf(o),u=0,l=n;u<l.length;u++){for(var c=(g=l[u]).rank,f=0;f<s-c;++f)g=Fb(g,1);a.push(g)}return i.mergeFunction(a)}for(var d=!1,h=0,p=n;h<p.length;h++){var g;if((c=(g=p[h]).rank)==null){var m=g.shape,v=m[0],y=m.slice(1).concat([v]),b=g.reshape([v].concat(qf(m.slice(1))));b=(b=cn(b,[1,0])).reshape(y),a.push(b),d=!0}else if(c>1){var x=Gs(1,c).concat([0]);a.push(cn(g,x)),d=!0}else a.push(g)}var w=i.mergeFunction(a),S=w.rank;if(d)if(S==null){var C=w.shape;y=[v=C[C.length-1]].concat(C.slice(0,C.length-1)),w=cn(w.reshape([-1,v]),[1,0]).reshape(y)}else S>1&&(x=[S-1].concat(Gs(0,S-1)),w=cn(w,x));return w}return i.mergeFunction(n)})},t.prototype.computeOutputShape=function(n){var r;r=(n=n)[0]==null?null:n[0].slice(1);for(var i=1;i<n.length;++i){var a=n[i]==null?null:n[i].slice(1);r=this.computeElementwiseOpOutputShape(r,a)}for(var o=[],s=0,u=n;s<u.length;s++)(a=u[s])!=null&&a[0]!==null&&o.push(a[0]);return r=(o=Vf(o)).length===1?o.concat(r):[null].concat(r)},t.prototype.computeMask=function(n,r){return le(function(){if(r==null)return null;if(!Array.isArray(r))throw new ie("`mask` should be an Array");if(!Array.isArray(n))throw new ie("`inputs` should be an Array");if(r.length!==n.length)throw new ie("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths ("+n.length+" vs "+r.length+")");if(r.every(function(o){return o==null}))return null;for(var i=(r=r.map(function(o){return o==null?o:Do(o,0)}))[0],a=1;a<r.length-1;++a)i=Hu(i,r[a]);return i})},t}(tn),KQ=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.mergeFunction=function(n){return le(function(){for(var r=n[0].clone(),i=1;i<n.length;++i)r=Wt(r,n[i]);return r})},t.className="Add",t}(Qh);Ne.registerClass(KQ);var XQ=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.mergeFunction=function(n){return le(function(){for(var r=n[0].clone(),i=1;i<n.length;++i)r=rt(r,n[i]);return r})},t.className="Multiply",t}(Qh);Ne.registerClass(XQ);var YQ=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.mergeFunction=function(n){return le(function(){for(var r=n[0].clone(),i=1;i<n.length;++i)r=Wt(r,n[i]);return rt(1/n.length,r)})},t.className="Average",t}(Qh);Ne.registerClass(YQ);var ZQ=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.mergeFunction=function(n){return le(function(){for(var r=n[0],i=1;i<n.length;++i)r=Vu(r,n[i]);return r})},t.className="Maximum",t}(Qh);Ne.registerClass(ZQ);var JQ=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.mergeFunction=function(n){return le(function(){for(var r=n[0],i=1;i<n.length;++i)r=Am(r,n[i]);return r})},t.className="Minimum",t}(Qh);Ne.registerClass(JQ);var QQ=function(e){function t(n){var r=e.call(this,n)||this;return r.DEFAULT_AXIS=-1,n==null&&(n={}),r.axis=n.axis==null?r.DEFAULT_AXIS:n.axis,r.supportsMasking=!0,r.reshapeRequired=!1,r}return Ee(t,e),t.prototype.build=function(n){if(!Array.isArray(n)||!Array.isArray(n[0])||n.length===1)throw new ie("A `Concatenate` layer should be called on a list of at least 2 inputs");for(var r=!0,i=0,a=n=n;i<a.length;i++)if((d=a[i])!=null){r=!1;break}if(!r){for(var o=[],s=0;s<n.length;++s){var u=n[s].slice();u.splice(this.axis,1);for(var l=!1,c=0,f=o;c<f.length;c++){var d=f[c];if(pt.arraysEqual(d,u)){l=!0;break}}l||o.push(u)}if(o.length>1)throw new ie("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(n))}},t.prototype.mergeFunction=function(n){var r=this;return le(function(){return NJ(n,r.axis)})},t.prototype.computeOutputShape=function(n){if(!Array.isArray(n)||!Array.isArray(n[0]))throw new ie("A `Concatenate` layer should be called on a list of inputs.");for(var r=n,i=r[0].slice(),a=this.axis<0?i.length+this.axis:this.axis,o=0,s=r.slice(1);o<s.length;o++){var u=s[o];if(i[a]==null||u[a]==null){i[a]=null;break}i[a]+=u[a]}return i},t.prototype.computeMask=function(n,r){var i=this;if(r==null)return null;if(!Array.isArray(r))throw new ie("`mask` should be an array for Concatenate");if(!Array.isArray(n))throw new ie("`inputs` should be an array for Concatenate");if(r.length!==n.length)throw new ie("Mismatch in the length of mask ("+r.length+") and the legnth of inputs ("+n.length+")");return le(function(){var a=!0;if(r.forEach(function(l){l==null||(a=!1)}),a)return null;for(var o=[],s=0;s<n.length;++s)r[s]==null?o.push(No(n[s]).asType("bool")):r[s].rank<n[s].rank?o.push(Do(r[s],-1)):o.push(r[s]);var u=Hi(o,i.axis);return mE(u,-1,!1)})},t.prototype.getConfig=function(){var n={axis:this.axis},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Concatenate",t}(Qh);function Ub(e,t){for(;e<0;)e+=t;return e}function bBe(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new $t("batchDot is not implemented for tensors of 4D or higher rank yet");if(pt.assert(e.shape.length>=2,function(){return"batchDot requires the rank of x to be >= 2, but got "+e.shape.length}),pt.assert(e.shape.length>=2,function(){return"batchDot requires the rank of y to be >= 2, but got "+t.shape.length}),typeof n=="number"&&(n=[n,n]),e.dtype==="complex64"||t.dtype==="complex64")throw new $t("batchDot is not implemented for complex64-type Tensors yet.");var r=e.shape.length,i=t.shape.length;n==null&&(n=[r-1,i-2]);var a=n;return le(function(){var o,s;if(r>i){o=r-i;for(var u=[],l=0;l<o;++l)u.push(1);t=t.reshape(t.shape.concat(u))}else if(i>r){for(o=i-r,u=[],l=0;l<o;++l)u.push(1);e=e.reshape(e.shape.concat(u))}else o=0;if(e.shape.length===2&&t.shape.length===2)s=a[0]===a[1]?e.mulStrict(t).sum(a[0]):e.transpose([1,0]).mulStrict(t).sum(a[1]);else{var c=a[0]!==e.shape.length-1,f=a[1]===t.shape.length-1;s=e.matMul(t,c,f)}if(o>0){var d=void 0,h=[];for(l=d=r>i?r+i-3:r-1;l<d+o;++l)h.push(l);s=s.squeeze(h)}return s.shape.length===1&&(s=s.expandDims(1)),s})}Ne.registerClass(QQ);var eee=function(e){function t(n){var r=e.call(this,n)||this;return r.axes=n.axes,r.normalize=n.normalize!=null&&n.normalize,r.supportsMasking=!0,r.reshapeRequired=!1,r}return Ee(t,e),t.prototype.build=function(n){pt.assert(Array.isArray(n)&&n.length===2&&Array.isArray(n[0])&&Array.isArray(n[1]),function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."});var r=n[0],i=n[1];if(r.length>3||i.length>3)throw new $t("Dot layer does not support tensors of 4D or higher rank yet.");var a=this.interpretAxes(r,i);if(r[a[0]]!==i[a[1]])throw new ie("Dimension incompatibility: "+r[a[0]]+" !== "+i[a[1]])},t.prototype.mergeFunction=function(n){if(n.length!==2)throw new ie("A `Dot` layer must be called on exactly 2 inputs, but received "+n.length+" input(s).");var r,i=n[0],a=n[1];return r=Array.isArray(this.axes)?this.axes.map(function(o,s){return Ub(o,n[s].shape.length)}):[Ub(this.axes,i.shape.length),Ub(this.axes,a.shape.length)],this.normalize&&(i=LE(i,r[0]),a=LE(a,r[1])),bBe(i,a,r)},t.prototype.interpretAxes=function(n,r){return Array.isArray(this.axes)?this.axes:[Ub(this.axes,n.length),Ub(this.axes,r.length)]},t.prototype.computeOutputShape=function(n){pt.assert(Array.isArray(n)&&n.length===2&&Array.isArray(n[0])&&Array.isArray(n[1]),function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."});var r=n[0].slice(),i=n[1].slice();if(r.length>3||i.length>3)throw new $t("Dot layer does not support tensors of 4D or higher rank yet.");var a=this.interpretAxes(r,i);r.splice(a[0],1),i.splice(a[1],1),i.splice(0,1);var o=r.concat(i);return o.length===1&&o.push(1),o},t.prototype.computeMask=function(n,r){return null},t.prototype.getConfig=function(){var n={axes:this.axes,normalize:this.normalize},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="Dot",t}(Qh);Ne.registerClass(eee);var tee=function(e){function t(n){var r=e.call(this,n)||this;return r.supportsMasking=!0,r.stddev=n.stddev,r}return Ee(t,e),t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this),r={stddev:this.stddev};return Object.assign(r,n),r},t.prototype.call=function(n,r){var i=this;return le(function(){i.invokeCallHook(n,r);var a=Dt(n);return Xm(function(){return DE(a.shape,0,i.stddev).add(a)},function(){return a},r.training||!1)})},t.className="GaussianNoise",t}(tn);Ne.registerClass(tee);var nee=function(e){function t(n){var r=e.call(this,n)||this;return r.supportsMasking=!0,r.rate=n.rate,r}return Ee(t,e),t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this),r={rate:this.rate};return Object.assign(r,n),r},t.prototype.call=function(n,r){var i=this;return le(function(){i.invokeCallHook(n,r);var a=Dt(n);return i.rate>0&&i.rate<1?Xm(function(){var o=Math.sqrt(i.rate/(1-i.rate));return a.mul(DE(a.shape,1,o))},function(){return a},r.training||!1):a})},t.className="GaussianDropout",t}(tn);Ne.registerClass(nee);var ree=function(e){function t(n){var r=e.call(this,n)||this;return r.supportsMasking=!0,r.rate=n.rate,r.noiseShape=n.noiseShape,r}return Ee(t,e),t.prototype._getNoiseShape=function(n){return this.noiseShape||Dt(n).shape},t.prototype.computeOutputShape=function(n){return n},t.prototype.getConfig=function(){var n=e.prototype.getConfig.call(this),r={rate:this.rate};return Object.assign(r,n),r},t.prototype.call=function(n,r){var i=this;return le(function(){if(i.rate<1&&i.rate>0){var a=i._getNoiseShape(n);return Xm(function(){var o=Dt(n),s=-1.7580993408473766,u=bb(jh(a),i.rate);u=Rb(u,"float32");var l=Math.pow((1-i.rate)*(1+i.rate*Math.pow(s,2)),-.5),c=-l*s*i.rate;return o.mul(u).add(u.add(-1).mul(s)).mul(l).add(c)},function(){return Dt(n)},r.training||!1)}return n})},t.className="AlphaDropout",t}(tn);function Wb(e,t,n,r,i,a){var o;if(a===void 0&&(a=.001),e.rank===2)o=aM(e,t,n,r,i,a);else if(e.rank===3)o=oM(e,t,n,r,i,a);else{if(e.rank!==4)throw new $t("batchNormalization is not implemented for array of rank "+e.rank+" yet");o=sM(e,t,n,r,i,a)}return o}function xBe(e,t,n,r,i){return i===void 0&&(i=.001),le(function(){var a=Eb(e,r),o=a.mean,s=a.variance;return[Wb(e,o,s,n,t,i),o,s]})}function wBe(e,t,n,r,i){return i===void 0&&(i=.001),le(function(){for(var a=Eb(e,r),o=a.mean,s=a.variance,u=[],l=0,c=Gs(0,e.rank);l<c.length;l++){var f=c[l];r.indexOf(f)!==-1?u.push(1):u.push(e.shape[f])}var d=o.reshape(u),h=s.reshape(u),p=t==null?null:t.reshape(u),g=n==null?null:n.reshape(u);return[Wb(e,d,h,g,p,i),o,s]})}function _Be(e,t,n,r,i){return i===void 0&&(i=.001),pt.arraysEqual(r.slice().sort(),Gs(0,e.rank-1))?xBe(e,t,n,r,i):wBe(e,t,n,r,i)}Ne.registerClass(ree);var iee=function(e){function t(n){var r=this;return n==null&&(n={}),(r=e.call(this,n)||this).supportsMasking=!0,r.axis=n.axis==null?-1:n.axis,r.momentum=n.momentum==null?.99:n.momentum,r.epsilon=n.epsilon==null?.001:n.epsilon,r.center=n.center==null||n.center,r.scale=n.scale==null||n.scale,r.betaInitializer=nr(n.betaInitializer||"zeros"),r.gammaInitializer=nr(n.gammaInitializer||"ones"),r.movingMeanInitializer=nr(n.movingMeanInitializer||"zeros"),r.movingVarianceInitializer=nr(n.movingVarianceInitializer||"ones"),r.betaConstraint=Gr(n.betaConstraint),r.gammaConstraint=Gr(n.gammaConstraint),r.betaRegularizer=rr(n.betaRegularizer),r.gammaRegularizer=rr(n.gammaRegularizer),r}return Ee(t,e),t.prototype.build=function(n){var r;n=Kn(n);var i=this.axis>=0?this.axis:this.axis+n.length,a=n[i];if(a==null)throw new ie("Axis "+i+" of input tensor should have a defined dimension but the layer received an input with shape "+JSON.stringify(n)+".");this.inputSpec=[new Fi({ndim:n.length,axes:(r={},r[i]=a,r)})];var o=[a];this.scale&&(this.gamma=this.addWeight("gamma",o,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",o,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",o,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",o,null,this.movingVarianceInitializer,null,!1),this.built=!0},t.prototype.call=function(n,r){var i=this;return le(function(){var a=r.training!=null&&r.training,o=Dt(n),s=o.shape,u=s.length,l=Gs(0,u),c=i.axis>=0?i.axis:i.axis+u;l.splice(c,1);var f=Gh(1,u);f[c]=s[c];var d=l.slice();d.sort();var h=!pt.arraysEqual(d,Gs(0,u).slice(0,u-1));if(!a)return function(){if(h){var b=i.movingMean.read().reshape(f),x=i.movingVariance.read().reshape(f),w=i.center?i.beta.read().reshape(f):null,S=i.scale?i.gamma.read().reshape(f):null;return Wb(o,b,x,w,S,i.epsilon)}return Wb(o,i.movingMean.read(),i.movingVariance.read(),i.beta==null?null:i.beta.read(),i.gamma==null?null:i.gamma.read(),i.epsilon)}();var p=_Be(o,i.gamma.read(),i.beta.read(),l,i.epsilon),g=p[0],m=p[1],v=p[2],y=function(b,x,w){le(function(){var S=1-w,C=b.read(),_=C.sub(x).mul(S);b.write(C.sub(_))})};return y(i.movingMean,m,i.momentum),y(i.movingVariance,v,i.momentum),g})},t.prototype.getConfig=function(){var n={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:vn(this.betaInitializer),gammaInitializer:vn(this.gammaInitializer),movingMeanInitializer:vn(this.movingMeanInitializer),movingVarianceInitializer:vn(this.movingVarianceInitializer),betaRegularizer:Vt(this.betaRegularizer),gammaRegularizer:Vt(this.gammaRegularizer),betaConstraint:Ln(this.betaConstraint),gammaConstraint:Ln(this.gammaConstraint)},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="BatchNormalization",t}(tn);Ne.registerClass(iee);var aee=function(e){function t(n){var r=this;if(n==null&&(n={}),(r=e.call(this,n)||this).axis=n.axis==null?-1:n.axis,typeof r.axis=="number"){if(!Number.isInteger(r.axis))throw new Error("Expected axis to be an integer, but received "+r.axis)}else{if(!Array.isArray(r.axis))throw new Error("Expected axis to be an integer or an array of integers, but received "+JSON.stringify(r.axis));for(var i=0,a=r.axis;i<a.length;i++){var o=a[i];if(!Number.isInteger(o))throw new Error("Expected axis to be an array of integers, but received "+JSON.stringify(r.axis))}}return r.epsilon=n.epsilon==null?.001:n.epsilon,r.center=n.center==null||n.center,r.scale=n.scale==null||n.scale,r.betaInitializer=nr(n.betaInitializer||"zeros"),r.gammaInitializer=nr(n.gammaInitializer||"ones"),r.betaRegularizer=rr(n.betaRegularizer),r.gammaRegularizer=rr(n.gammaRegularizer),r.supportsMasking=!0,r}return Ee(t,e),t.prototype.build=function(n){var r=(n=Kn(n)).length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(var i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=r);for(var a=0,o=this.axis;a<o.length;a++){var s=o[a];if(s<0||s>=r)throw new Error("Invalid axis: "+s)}if(this.axis.length!==Vf(this.axis).length)throw new Error("Found duplicate axes in: "+this.axis);var u=this.axis.map(function(l){return n[l]});this.scale?this.gamma=this.addWeight("gamma",u,"float32",this.gammaInitializer,this.gammaRegularizer,!0):this.gamma=null,this.center?this.beta=this.addWeight("beta",u,"float32",this.betaInitializer,this.betaRegularizer,!0):this.beta=null,this.built=!0},t.prototype.call=function(n,r){var i=this,a=Dt(n),o=a.shape,s=o.length;return le(function(){for(var u=Eb(a,i.axis,!0),l=u.mean,c=u.variance,f=Gh(1,s),d=0,h=i.axis;d<h.length;d++){var p=h[d];f[p]=o[p]}for(var g=function(w){return w!=null&&w.shape.length!==s&&i.axis!==[s-1]?w.reshape(f):w},m=g(i.gamma.read()),v=g(i.beta.read()),y=[],b=[],x=0;x<s;++x)i.axis.indexOf(x)!==-1?(y.push(o[x]),b.push(1)):(y.push(1),b.push(o[x]));return l=l.tile(y),c=c.tile(y),m=m.tile(b),v=v.tile(b),Wb(a,l,c,v,m,i.epsilon)})},t.prototype.getConfig=function(){var n={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:vn(this.betaInitializer),gammaInitializer:vn(this.gammaInitializer),betaRegularizer:Vt(this.betaRegularizer),gammaRegularizer:Vt(this.gammaRegularizer)},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="LayerNormalization",t}(tn);function SBe(e,t,n){return le(function(){if(e.rank!==4)throw new ie("temporalPadding expects input tensor to be 4-D, but received a "+e.rank+"-D tensor.");if(t==null&&(t=[[1,1],[1,1]]),t.length!==2||t[0].length!==2||t[1].length!==2)throw new ie("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=Hs()),n!=="channelsLast"&&n!=="channelsFirst")throw new ie("Unknown data format: "+n+". Supported data formats are 'channelsLast' and 'channelsFirst.");var r;return r=n==="channelsFirst"?[[0,0],[0,0],t[0],t[1]]:[[0,0],t[0],t[1],[0,0]],Gu(e,r)})}Ne.registerClass(aee);var oee=function(e){function t(n){var r=this;if(n==null&&(n={}),(r=e.call(this,n)||this).dataFormat=n.dataFormat==null?Hs():n.dataFormat,n.padding==null)r.padding=[[1,1],[1,1]];else if(typeof n.padding=="number")r.padding=[[n.padding,n.padding],[n.padding,n.padding]];else{if(n.padding=n.padding,n.padding.length!==2)throw new ie("ZeroPadding2D expects padding to be a length-2 array, but received a length-"+n.padding.length+" array.");var i=void 0,a=void 0;if(typeof n.padding[0]=="number")i=[n.padding[0],n.padding[0]],a=[n.padding[1],n.padding[1]];else{if(n.padding=n.padding,n.padding[0].length!==2)throw new ie("ZeroPadding2D expects height padding to be a length-2 array, but received a length-"+n.padding[0].length+" array.");if(i=n.padding[0],n.padding[1].length!==2)throw new ie("ZeroPadding2D expects width padding to be a length-2 array, but received a length-"+n.padding[1].length+" array.");a=n.padding[1]}r.padding=[i,a]}return r.inputSpec=[new Fi({ndim:4})],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){var r,i;return n=Kn(n),this.dataFormat==="channelsFirst"?(r=n[2]!=null&&n[2]>=0?n[2]+this.padding[0][0]+this.padding[0][1]:null,i=n[3]!=null&&n[3]>=0?n[3]+this.padding[1][0]+this.padding[1][1]:null,[n[0],n[1],r,i]):(r=n[1]!=null&&n[1]>=0?n[1]+this.padding[0][0]+this.padding[0][1]:null,i=n[2]!=null&&n[2]>=0?n[2]+this.padding[1][0]+this.padding[1][1]:null,[n[0],r,i,n[3]])},t.prototype.call=function(n,r){var i=this;return le(function(){return SBe(Dt(n),i.padding,i.dataFormat)})},t.prototype.getConfig=function(){var n={padding:this.padding,dataFormat:this.dataFormat},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="ZeroPadding2D",t}(tn);function XE(e,t,n,r,i,a){return le(function(){var o;Kr(i),CJ(a),ss(r),n==null&&(n=[1,1]),r==null&&(r="valid"),i==null&&(i=Hs()),a==null&&(a="max"),e=LP(e,i);var s=r==="same"?"same":"valid";return o=a==="max"?fE(e,t,n,s):dE(e,t,n,s),i==="channelsFirst"&&(o=cn(o,[0,3,1,2])),o})}function see(e,t,n,r,i,a){return le(function(){var o;Kr(i),CJ(a),ss(r),n==null&&(n=[1,1,1]),r==null&&(r="valid"),i==null&&(i=Hs()),a==null&&(a="max"),e=OQ(e,i);var s=r==="same"?"same":"valid";return o=a==="max"?hE(e,t,n,s):pE(e,t,n,s),i==="channelsFirst"&&(o=cn(o,[0,4,1,2,3])),o})}Ne.registerClass(oee);var uee=function(e){function t(n){var r=this;if(n.poolSize==null&&(n.poolSize=2),r=e.call(this,n)||this,typeof n.poolSize=="number")r.poolSize=[n.poolSize];else{if(!Array.isArray(n.poolSize)||n.poolSize.length!==1||typeof n.poolSize[0]!="number")throw new ie("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(n.poolSize));r.poolSize=n.poolSize}if(Sa(r.poolSize,"poolSize"),n.strides==null)r.strides=r.poolSize;else if(typeof n.strides=="number")r.strides=[n.strides];else{if(!Array.isArray(n.strides)||n.strides.length!==1||typeof n.strides[0]!="number")throw new ie("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(n.strides));r.strides=n.strides}return Sa(r.strides,"strides"),r.padding=n.padding==null?"valid":n.padding,ss(r.padding),r.inputSpec=[new Fi({ndim:3})],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){var r=pc((n=Kn(n))[1],this.poolSize[0],this.padding,this.strides[0]);return[n[0],r,n[2]]},t.prototype.call=function(n,r){var i=this;return le(function(){i.invokeCallHook(n,r),n=Fb(Dt(n),2);var a=i.poolingFunction(Dt(n),[i.poolSize[0],1],[i.strides[0],1],i.padding,"channelsLast");return ab(a,[2])})},t.prototype.getConfig=function(){var n={poolSize:this.poolSize,padding:this.padding,strides:this.strides},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t}(tn),lee=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.poolingFunction=function(n,r,i,a,o){return Kr(o),ss(a),XE(n,r,i,a,o,"max")},t.className="MaxPooling1D",t}(uee);Ne.registerClass(lee);var cee=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.poolingFunction=function(n,r,i,a,o){return Kr(o),ss(a),XE(n,r,i,a,o,"avg")},t.className="AveragePooling1D",t}(uee);Ne.registerClass(cee);var fee=function(e){function t(n){var r=this;if(n.poolSize==null&&(n.poolSize=[2,2]),(r=e.call(this,n)||this).poolSize=Array.isArray(n.poolSize)?n.poolSize:[n.poolSize,n.poolSize],n.strides==null)r.strides=r.poolSize;else if(Array.isArray(n.strides)){if(n.strides.length!==2)throw new ie("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+n.strides.length+".");r.strides=n.strides}else r.strides=[n.strides,n.strides];return Sa(r.poolSize,"poolSize"),Sa(r.strides,"strides"),r.padding=n.padding==null?"valid":n.padding,r.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Kr(r.dataFormat),ss(r.padding),r.inputSpec=[new Fi({ndim:4})],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){n=Kn(n);var r=this.dataFormat==="channelsFirst"?n[2]:n[1],i=this.dataFormat==="channelsFirst"?n[3]:n[2];return r=pc(r,this.poolSize[0],this.padding,this.strides[0]),i=pc(i,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[n[0],n[1],r,i]:[n[0],r,i,n[3]]},t.prototype.call=function(n,r){var i=this;return le(function(){return i.invokeCallHook(n,r),i.poolingFunction(Dt(n),i.poolSize,i.strides,i.padding,i.dataFormat)})},t.prototype.getConfig=function(){var n={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t}(tn),dee=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.poolingFunction=function(n,r,i,a,o){return Kr(o),ss(a),XE(n,r,i,a,o,"max")},t.className="MaxPooling2D",t}(fee);Ne.registerClass(dee);var hee=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.poolingFunction=function(n,r,i,a,o){return Kr(o),ss(a),XE(n,r,i,a,o,"avg")},t.className="AveragePooling2D",t}(fee);Ne.registerClass(hee);var pee=function(e){function t(n){var r=this;if(n.poolSize==null&&(n.poolSize=[2,2,2]),(r=e.call(this,n)||this).poolSize=Array.isArray(n.poolSize)?n.poolSize:[n.poolSize,n.poolSize,n.poolSize],n.strides==null)r.strides=r.poolSize;else if(Array.isArray(n.strides)){if(n.strides.length!==3)throw new ie("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+n.strides.length+".");r.strides=n.strides}else r.strides=[n.strides,n.strides,n.strides];return Sa(r.poolSize,"poolSize"),Sa(r.strides,"strides"),r.padding=n.padding==null?"valid":n.padding,r.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Kr(r.dataFormat),ss(r.padding),r.inputSpec=[new Fi({ndim:5})],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){n=Kn(n);var r=this.dataFormat==="channelsFirst"?n[2]:n[1],i=this.dataFormat==="channelsFirst"?n[3]:n[2],a=this.dataFormat==="channelsFirst"?n[4]:n[3];return r=pc(r,this.poolSize[0],this.padding,this.strides[0]),i=pc(i,this.poolSize[1],this.padding,this.strides[1]),a=pc(a,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[n[0],n[1],r,i,a]:[n[0],r,i,a,n[4]]},t.prototype.call=function(n,r){var i=this;return le(function(){return i.invokeCallHook(n,r),i.poolingFunction(Dt(n),i.poolSize,i.strides,i.padding,i.dataFormat)})},t.prototype.getConfig=function(){var n={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t}(tn),gee=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.poolingFunction=function(n,r,i,a,o){return Kr(o),ss(a),see(n,r,i,a,o,"max")},t.className="MaxPooling3D",t}(pee);Ne.registerClass(gee);var mee=function(e){function t(n){return e.call(this,n)||this}return Ee(t,e),t.prototype.poolingFunction=function(n,r,i,a,o){return Kr(o),ss(a),see(n,r,i,a,o,"avg")},t.className="AveragePooling3D",t}(pee);Ne.registerClass(mee);var vee=function(e){function t(n){var r=e.call(this,n)||this;return r.inputSpec=[new Fi({ndim:3})],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){return[n[0],n[2]]},t.prototype.call=function(n,r){throw new $t},t}(tn),yee=function(e){function t(n){return e.call(this,n||{})||this}return Ee(t,e),t.prototype.call=function(n,r){return le(function(){var i=Dt(n);return Fr(i,1)})},t.className="GlobalAveragePooling1D",t}(vee);Ne.registerClass(yee);var bee=function(e){function t(n){return e.call(this,n||{})||this}return Ee(t,e),t.prototype.call=function(n,r){return le(function(){var i=Dt(n);return Pf(i,1)})},t.className="GlobalMaxPooling1D",t}(vee);Ne.registerClass(bee);var xee=function(e){function t(n){var r=e.call(this,n)||this;return r.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Kr(r.dataFormat),r.inputSpec=[new Fi({ndim:4})],r}return Ee(t,e),t.prototype.computeOutputShape=function(n){return n=n,this.dataFormat==="channelsLast"?[n[0],n[3]]:[n[0],n[1]]},t.prototype.call=function(n,r){throw new $t},t.prototype.getConfig=function(){var n={dataFormat:this.dataFormat},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t}(tn),wee=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.call=function(n,r){var i=this;return le(function(){var a=Dt(n);return i.dataFormat==="channelsLast"?Fr(a,[1,2]):Fr(a,[2,3])})},t.className="GlobalAveragePooling2D",t}(xee);Ne.registerClass(wee);var _ee=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t.prototype.call=function(n,r){var i=this;return le(function(){var a=Dt(n);return i.dataFormat==="channelsLast"?Pf(a,[1,2]):Pf(a,[2,3])})},t.className="GlobalMaxPooling2D",t}(xee);function See(e,t,n,r){if(Array.isArray(e)){if(t!=null||n!=null)throw new ie("When inputs is an array, neither initialState or constants should be provided");r!=null&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function i(a){return a==null||Array.isArray(a)?a:[a]}return{inputs:e,initialState:t=i(t),constants:n=i(n)}}function Eee(e,t,n,r,i,a,o,s){return r===void 0&&(r=!1),o===void 0&&(o=!1),s===void 0&&(s=!1),le(function(){var u=t.shape.length;if(u<3)throw new ie("Input should be at least 3D, but is "+u+"D.");var l=[1,0].concat(Gs(2,u));if(t=cn(t,l),a!=null)throw new $t("The rnn() functoin of the deeplearn.js backend does not support constants yet.");o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),i!=null&&((i=i.asType("bool").asType("float32")).rank===u-1&&(i=Do(i,-1)),i=cn(i,l)),r&&(t=Ku(t,0),i!=null&&(i=Ku(i,0)));var c,f,d=[],h=n,p=t.shape[0],g=Nf(t);i!=null&&(f=Nf(i));for(var m,v=function(b){var x=g[b],w=le(function(){return e(x,h)});if(i==null)c=w[0],h=w[1];else{var S=le(function(){var C=f[b],_=No(C).sub(C);return{output:w[0].mul(C).addStrict(h[0].mul(_)),newStates:h.map(function(E,A){return w[1][A].mul(C).addStrict(E.mul(_))})}});c=S.output,h=S.newStates}s&&d.push(c)},y=0;y<p;++y)v(y);return s&&(m=as(d,1)),[c,m,h]})}Ne.registerClass(_ee);var Qm=function(e){function t(n){var r,i=e.call(this,n)||this;if(n.cell==null)throw new ie("cell property is missing for the constructor of RNN.");if((r=Array.isArray(n.cell)?new VP({cells:n.cell}):n.cell).stateSize==null)throw new ie("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");return i.cell=r,i.returnSequences=n.returnSequences!=null&&n.returnSequences,i.returnState=n.returnState!=null&&n.returnState,i.goBackwards=n.goBackwards!=null&&n.goBackwards,i._stateful=n.stateful!=null&&n.stateful,i.unroll=n.unroll!=null&&n.unroll,i.supportsMasking=!0,i.inputSpec=[new Fi({ndim:3})],i.stateSpec=null,i.states_=null,i.numConstants=null,i.keptStates=[],i}return Ee(t,e),t.prototype.getStates=function(){return this.states_==null?Gs(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map(function(n){return null}):this.states_},t.prototype.setStates=function(n){this.states_=n},t.prototype.computeOutputShape=function(n){xP(n)&&(n=n[0]),n=n;var r=this.cell.stateSize;Array.isArray(r)||(r=[r]);var i,a=r[0];if(i=this.returnSequences?[n[0],n[1],a]:[n[0],a],this.returnState){for(var o=[],s=0,u=r;s<u.length;s++){var l=u[s];o.push([n[0],l])}return[i].concat(o)}return i},t.prototype.computeMask=function(n,r){var i=this;return le(function(){Array.isArray(r)&&(r=r[0]);var a=i.returnSequences?r:null;if(i.returnState){var o=i.states.map(function(s){return null});return[a].concat(o)}return a})},Object.defineProperty(t.prototype,"states",{get:function(){if(this.states_==null){for(var n=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,r=[],i=0;i<n;++i)r.push(null);return r}return this.states_},set:function(n){this.states_=n},enumerable:!0,configurable:!0}),t.prototype.build=function(n){if(this.numConstants!=null)throw new $t("Constants support is not implemented in RNN yet.");xP(n)&&(n=n[0]),n=n;var r=this.stateful?n[0]:null,i=n[n.length-1];this.inputSpec[0]=new Fi({shape:[r,null,i]});var a,o=[n[0]].concat(n.slice(2));if(this.cell.build(o),a=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],this.stateSpec!=null){if(!pt.arraysEqual(this.stateSpec.map(function(s){return s.shape[s.shape.length-1]}),a))throw new ie("An initialState was passed that is not compatible with cell.stateSize. Received stateSpec="+this.stateSpec+"; However cell.stateSize is "+this.cell.stateSize)}else this.stateSpec=a.map(function(s){return new Fi({shape:[null,s]})});this.stateful&&this.resetStates()},t.prototype.resetStates=function(n,r){var i=this;r===void 0&&(r=!1),le(function(){if(!i.stateful)throw new Hh("Cannot call resetStates() on an RNN Layer that is not stateful.");var a=i.inputSpec[0].shape[0];if(a==null)throw new ie("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(i.states_==null)Array.isArray(i.cell.stateSize)?i.states_=i.cell.stateSize.map(function(c){return Tn([a,c])}):i.states_=[Tn([a,i.cell.stateSize])];else if(n==null)Ut(i.states_),i.keptStates!=null&&(Ut(i.keptStates),i.keptStates=[]),Array.isArray(i.cell.stateSize)?i.states_=i.cell.stateSize.map(function(c){return Tn([a,c])}):i.states_[0]=Tn([a,i.cell.stateSize]);else{if(Array.isArray(n)||(n=[n]),n.length!==i.states_.length)throw new ie("Layer "+i.name+" expects "+i.states_.length+" state(s), but it received "+n.length+" state value(s). Input received: "+n);r===!0?i.keptStates.push(i.states_.slice()):Ut(i.states_);for(var o=0;o<i.states_.length;++o){var s=n[o],u=Array.isArray(i.cell.stateSize)?i.cell.stateSize[o]:i.cell.stateSize,l=[a,u];if(!pt.arraysEqual(s.shape,l))throw new ie("State "+o+" is incompatible with layer "+i.name+": expected shape="+l+", received shape="+s.shape);i.states_[o]=s}}i.states_=i.states_.map(function(c){return zu(c.clone())})})},t.prototype.apply=function(n,r){var i=r==null?null:r.initialState,a=r==null?null:r.constants;r==null&&(r={});var o=See(n,i,a,this.numConstants);n=o.inputs,i=o.initialState,a=o.constants;var s=[],u=[];if(i!=null){r.initialState=i,s=s.concat(i),this.stateSpec=[];for(var l=0,c=i;l<c.length;l++){var f=c[l];this.stateSpec.push(new Fi({shape:f.shape}))}u=u.concat(this.stateSpec)}if(a!=null&&(r.constants=a,s=s.concat(a),this.numConstants=a.length),s[0]instanceof Zu){var d=[n].concat(s),h=this.inputSpec.concat(u),p=this.inputSpec;this.inputSpec=h;var g=e.prototype.apply.call(this,d,r);return this.inputSpec=p,g}return e.prototype.apply.call(this,n,r)},t.prototype.call=function(n,r){var i=this;return le(function(){var a=r==null?null:r.mask,o=r==null?null:r.training,s=r==null?null:r.initialState;n=Dt(n),s==null&&(s=i.stateful?i.states_:i.getInitialState(n));var u=Array.isArray(i.cell.stateSize)?i.cell.stateSize.length:1;if(s.length!==u)throw new ie("RNN Layer has "+u+" state(s) but was passed "+s.length+" initial state(s).");i.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");var l={training:o},c=Eee(function(g,m){var v=i.cell.call([g].concat(m),l);return[v[0],v.slice(1)]},n,s,i.goBackwards,a,null,i.unroll,i.returnSequences),f=c[0],d=c[1],h=c[2];i.stateful&&i.resetStates(h,o);var p=i.returnSequences?d:f;return i.returnState?[p].concat(h):p})},t.prototype.getInitialState=function(n){var r=this;return le(function(){var i=Tn(n.shape);return i=Fb(i=qr(i,[1,2])),Array.isArray(r.cell.stateSize)?r.cell.stateSize.map(function(a){return a>1?fP(i,[1,a]):i}):r.cell.stateSize>1?[fP(i,[1,r.cell.stateSize])]:[i]})},Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.trainable?this.cell.trainableWeights:[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights},enumerable:!0,configurable:!0}),t.prototype.setFastWeightInitDuringBuild=function(n){e.prototype.setFastWeightInitDuringBuild.call(this,n),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(n)},t.prototype.getConfig=function(){var n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);var r=this.cell.getConfig();n.cell={className:this.cell.getClassName(),config:r};var i=e.prototype.getConfig.call(this);return Object.assign(n,i),n},t.fromConfig=function(n,r,i){i===void 0&&(i={});var a=Xs(r.cell,i);return new n(Object.assign(r,{cell:a}))},t.className="RNN",t}(tn);Ne.registerClass(Qm);var Vb=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return Ee(t,e),t}(tn),jP=function(e){function t(n){var r=e.call(this,n)||this;return r.DEFAULT_ACTIVATION="tanh",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=n.units,Sa(r.units,"units"),r.activation=Kf(n.activation==null?r.DEFAULT_ACTIVATION:n.activation),r.useBias=n.useBias==null||n.useBias,r.kernelInitializer=nr(n.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=nr(n.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=nr(n.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=rr(n.kernelRegularizer),r.recurrentRegularizer=rr(n.recurrentRegularizer),r.biasRegularizer=rr(n.biasRegularizer),r.kernelConstraint=Gr(n.kernelConstraint),r.recurrentConstraint=Gr(n.recurrentConstraint),r.biasConstraint=Gr(n.biasConstraint),r.dropout=Km([1,Hf([0,n.dropout==null?0:n.dropout])]),r.recurrentDropout=Km([1,Hf([0,n.recurrentDropout==null?0:n.recurrentDropout])]),r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return Ee(t,e),t.prototype.build=function(n){n=Kn(n),this.kernel=this.addWeight("kernel",[n[n.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},t.prototype.call=function(n,r){var i=this;return le(function(){if((n=n).length!==2)throw new ie("SimpleRNNCell expects 2 input Tensors, got "+n.length+".");var a=n[1];n=n[0];var o,s=r.training!=null&&r.training;0<i.dropout&&i.dropout<1&&i.dropoutMask==null&&(i.dropoutMask=ev(function(){return No(n)},i.dropout,s)),0<i.recurrentDropout&&i.recurrentDropout<1&&i.recurrentDropoutMask==null&&(i.recurrentDropoutMask=ev(function(){return No(a)},i.recurrentDropout,s));var u=i.dropoutMask,l=i.recurrentDropoutMask;o=dc(u!=null?rt(n,u):n,i.kernel.read()),i.bias!=null&&(o=hc(o,i.bias.read())),l!=null&&(a=rt(a,l));var c=Wt(o,dc(a,i.recurrentKernel.read()));return i.activation!=null&&(c=i.activation.apply(c)),[c,c]})},t.prototype.getConfig=function(){var n={units:this.units,activation:Po(this.activation),useBias:this.useBias,kernelInitializer:vn(this.kernelInitializer),recurrentInitializer:vn(this.recurrentInitializer),biasInitializer:vn(this.biasInitializer),kernelRegularizer:Vt(this.kernelRegularizer),recurrentRegularizer:Vt(this.recurrentRegularizer),biasRegularizer:Vt(this.biasRegularizer),activityRegularizer:Vt(this.activityRegularizer),kernelConstraint:Ln(this.kernelConstraint),recurrentConstraint:Ln(this.recurrentConstraint),biasConstraint:Ln(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="SimpleRNNCell",t}(Vb);Ne.registerClass(jP);var Cee=function(e){function t(n){return n.cell=new jP(n),e.call(this,n)||this}return Ee(t,e),t.prototype.call=function(n,r){var i=this;return le(function(){i.cell.dropoutMask!=null&&(Ut(i.cell.dropoutMask),i.cell.dropoutMask=null),i.cell.recurrentDropoutMask!=null&&(Ut(i.cell.recurrentDropoutMask),i.cell.recurrentDropoutMask=null);var a=r==null?null:r.mask,o=r==null?null:r.training,s=r==null?null:r.initialState;return e.prototype.call.call(i,n,{mask:a,training:o,initialState:s})})},Object.defineProperty(t.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){var n={units:this.units,activation:Po(this.activation),useBias:this.useBias,kernelInitializer:vn(this.kernelInitializer),recurrentInitializer:vn(this.recurrentInitializer),biasInitializer:vn(this.biasInitializer),kernelRegularizer:Vt(this.kernelRegularizer),recurrentRegularizer:Vt(this.recurrentRegularizer),biasRegularizer:Vt(this.biasRegularizer),activityRegularizer:Vt(this.activityRegularizer),kernelConstraint:Ln(this.kernelConstraint),recurrentConstraint:Ln(this.recurrentConstraint),biasConstraint:Ln(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},r=e.prototype.getConfig.call(this);return delete r.cell,Object.assign(n,r),n},t.fromConfig=function(n,r){return new n(r)},t.className="SimpleRNN",t}(Qm);Ne.registerClass(Cee);var UP=function(e){function t(n){var r=e.call(this,n)||this;return r.DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=n.units,Sa(r.units,"units"),r.activation=Kf(n.activation===void 0?r.DEFAULT_ACTIVATION:n.activation),r.recurrentActivation=Kf(n.recurrentActivation===void 0?r.DEFAULT_RECURRENT_ACTIVATION:n.recurrentActivation),r.useBias=n.useBias==null||n.useBias,r.kernelInitializer=nr(n.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=nr(n.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=nr(n.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=rr(n.kernelRegularizer),r.recurrentRegularizer=rr(n.recurrentRegularizer),r.biasRegularizer=rr(n.biasRegularizer),r.kernelConstraint=Gr(n.kernelConstraint),r.recurrentConstraint=Gr(n.recurrentConstraint),r.biasConstraint=Gr(n.biasConstraint),r.dropout=Km([1,Hf([0,n.dropout==null?0:n.dropout])]),r.recurrentDropout=Km([1,Hf([0,n.recurrentDropout==null?0:n.recurrentDropout])]),r.implementation=n.implementation,r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return Ee(t,e),t.prototype.build=function(n){var r=(n=Kn(n))[n.length-1];this.kernel=this.addWeight("kernel",[r,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0},t.prototype.call=function(n,r){var i=this;return le(function(){if((n=n).length!==2)throw new ie("GRUCell expects 2 input Tensors (inputs, h, c), got "+n.length+".");var a=r.training!=null&&r.training,o=n[1];n=n[0],0<i.dropout&&i.dropout<1&&i.dropoutMask==null&&(i.dropoutMask=ev(function(){return No(n)},i.dropout,a,3)),0<i.recurrentDropout&&i.recurrentDropout<1&&i.recurrentDropoutMask==null&&(i.recurrentDropoutMask=ev(function(){return No(o)},i.recurrentDropout,a,3));var s,u,l,c=i.dropoutMask,f=i.recurrentDropoutMask;0<i.dropout&&i.dropout<1&&(n=rt(n,c[0]));var d=dc(n,i.kernel.read());i.useBias&&(d=hc(d,i.bias.read())),0<i.recurrentDropout&&i.recurrentDropout<1&&(o=rt(o,f[0]));var h=i.recurrentKernel.read(),p=ic(h,[2*i.units,i.units],h.rank-1),g=p[0],m=p[1],v=dc(o,g),y=ic(d,3,d.rank-1),b=y[0],x=y[1],w=y[2],S=ic(v,2,v.rank-1),C=S[0],_=S[1];s=i.recurrentActivation.apply(Wt(b,C)),u=i.recurrentActivation.apply(Wt(x,_));var E=dc(rt(u,o),m);l=i.activation.apply(Wt(w,E));var A=Wt(rt(s,o),rt(Wt(1,Rf(s)),l));return[A,A]})},t.prototype.getConfig=function(){var n={units:this.units,activation:Po(this.activation),recurrentActivation:Po(this.recurrentActivation),useBias:this.useBias,kernelInitializer:vn(this.kernelInitializer),recurrentInitializer:vn(this.recurrentInitializer),biasInitializer:vn(this.biasInitializer),kernelRegularizer:Vt(this.kernelRegularizer),recurrentRegularizer:Vt(this.recurrentRegularizer),biasRegularizer:Vt(this.biasRegularizer),activityRegularizer:Vt(this.activityRegularizer),kernelConstraint:Ln(this.kernelConstraint),recurrentConstraint:Ln(this.recurrentConstraint),biasConstraint:Ln(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="GRUCell",t}(Vb);Ne.registerClass(UP);var Aee=function(e){function t(n){return n.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),n.cell=new UP(n),e.call(this,n)||this}return Ee(t,e),t.prototype.call=function(n,r){var i=this;return le(function(){i.cell.dropoutMask!=null&&(Ut(i.cell.dropoutMask),i.cell.dropoutMask=null),i.cell.recurrentDropoutMask!=null&&(Ut(i.cell.recurrentDropoutMask),i.cell.recurrentDropoutMask=null);var a=r==null?null:r.mask,o=r==null?null:r.training,s=r==null?null:r.initialState;return e.prototype.call.call(i,n,{mask:a,training:o,initialState:s})})},Object.defineProperty(t.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentActivation",{get:function(){return this.cell.recurrentActivation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){var n={units:this.units,activation:Po(this.activation),recurrentActivation:Po(this.recurrentActivation),useBias:this.useBias,kernelInitializer:vn(this.kernelInitializer),recurrentInitializer:vn(this.recurrentInitializer),biasInitializer:vn(this.biasInitializer),kernelRegularizer:Vt(this.kernelRegularizer),recurrentRegularizer:Vt(this.recurrentRegularizer),biasRegularizer:Vt(this.biasRegularizer),activityRegularizer:Vt(this.activityRegularizer),kernelConstraint:Ln(this.kernelConstraint),recurrentConstraint:Ln(this.recurrentConstraint),biasConstraint:Ln(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},r=e.prototype.getConfig.call(this);return delete r.cell,Object.assign(n,r),n},t.fromConfig=function(n,r){return r.implmentation===0&&(r.implementation=1),new n(r)},t.className="GRU",t}(Qm);Ne.registerClass(Aee);var WP=function(e){function t(n){var r=e.call(this,n)||this;return r.DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=n.units,Sa(r.units,"units"),r.activation=Kf(n.activation===void 0?r.DEFAULT_ACTIVATION:n.activation),r.recurrentActivation=Kf(n.recurrentActivation===void 0?r.DEFAULT_RECURRENT_ACTIVATION:n.recurrentActivation),r.useBias=n.useBias==null||n.useBias,r.kernelInitializer=nr(n.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=nr(n.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=nr(n.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.unitForgetBias=n.unitForgetBias,r.kernelRegularizer=rr(n.kernelRegularizer),r.recurrentRegularizer=rr(n.recurrentRegularizer),r.biasRegularizer=rr(n.biasRegularizer),r.kernelConstraint=Gr(n.kernelConstraint),r.recurrentConstraint=Gr(n.recurrentConstraint),r.biasConstraint=Gr(n.biasConstraint),r.dropout=Km([1,Hf([0,n.dropout==null?0:n.dropout])]),r.recurrentDropout=Km([1,Hf([0,n.recurrentDropout==null?0:n.recurrentDropout])]),r.implementation=n.implementation,r.stateSize=[r.units,r.units],r.dropoutMask=null,r.recurrentDropoutMask=null,r}return Ee(t,e),t.prototype.build=function(n){var r,i,a=(n=Kn(n))[n.length-1];if(this.kernel=this.addWeight("kernel",[a,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){var o=this.biasInitializer,s=this.units;i=new((r=function(u){function l(){return u!==null&&u.apply(this,arguments)||this}return Ee(l,u),l.prototype.apply=function(c,f){var d=o.apply([s]),h=new hP().apply([s]),p=o.apply([2*s]);return DJ(DJ(d,h),p)},l}(Ks)).className="CustomInit",r)}else i=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,i,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0},t.prototype.call=function(n,r){var i=this;return le(function(){var a=r.training!=null&&r.training;if((n=n).length!==3)throw new ie("LSTMCell expects 3 input Tensors (inputs, h, c), got "+n.length+".");var o=n[1],s=n[2];n=n[0],0<i.dropout&&i.dropout<1&&i.dropoutMask==null&&(i.dropoutMask=ev(function(){return No(n)},i.dropout,a,4)),0<i.recurrentDropout&&i.recurrentDropout<1&&i.recurrentDropoutMask==null&&(i.recurrentDropoutMask=ev(function(){return No(o)},i.recurrentDropout,a,4));var u,l,c,f,d=i.dropoutMask,h=i.recurrentDropoutMask;0<i.dropout&&i.dropout<1&&(n=rt(n,d[0]));var p=dc(n,i.kernel.read());0<i.recurrentDropout&&i.recurrentDropout<1&&(o=rt(o,h[0])),p=Wt(p,dc(o,i.recurrentKernel.read())),i.useBias&&(p=hc(p,i.bias.read()));var g=ic(p,4,p.rank-1),m=g[0],v=g[1],y=g[2],b=g[3];u=i.recurrentActivation.apply(m),l=i.recurrentActivation.apply(v),c=Wt(rt(l,s),rt(u,i.activation.apply(y))),f=i.recurrentActivation.apply(b);var x=rt(f,i.activation.apply(c));return[x,x,c]})},t.prototype.getConfig=function(){var n={units:this.units,activation:Po(this.activation),recurrentActivation:Po(this.recurrentActivation),useBias:this.useBias,kernelInitializer:vn(this.kernelInitializer),recurrentInitializer:vn(this.recurrentInitializer),biasInitializer:vn(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Vt(this.kernelRegularizer),recurrentRegularizer:Vt(this.recurrentRegularizer),biasRegularizer:Vt(this.biasRegularizer),activityRegularizer:Vt(this.activityRegularizer),kernelConstraint:Ln(this.kernelConstraint),recurrentConstraint:Ln(this.recurrentConstraint),biasConstraint:Ln(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.className="LSTMCell",t}(Vb);Ne.registerClass(WP);var kee=function(e){function t(n){return n.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),n.cell=new WP(n),e.call(this,n)||this}return Ee(t,e),t.prototype.call=function(n,r){var i=this;return le(function(){i.cell.dropoutMask!=null&&(Ut(i.cell.dropoutMask),i.cell.dropoutMask=null),i.cell.recurrentDropoutMask!=null&&(Ut(i.cell.recurrentDropoutMask),i.cell.recurrentDropoutMask=null);var a=r==null?null:r.mask,o=r==null?null:r.training,s=r==null?null:r.initialState;return e.prototype.call.call(i,n,{mask:a,training:o,initialState:s})})},Object.defineProperty(t.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentActivation",{get:function(){return this.cell.recurrentActivation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"unitForgetBias",{get:function(){return this.cell.unitForgetBias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),t.prototype.getConfig=function(){var n={units:this.units,activation:Po(this.activation),recurrentActivation:Po(this.recurrentActivation),useBias:this.useBias,kernelInitializer:vn(this.kernelInitializer),recurrentInitializer:vn(this.recurrentInitializer),biasInitializer:vn(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Vt(this.kernelRegularizer),recurrentRegularizer:Vt(this.recurrentRegularizer),biasRegularizer:Vt(this.biasRegularizer),activityRegularizer:Vt(this.activityRegularizer),kernelConstraint:Ln(this.kernelConstraint),recurrentConstraint:Ln(this.recurrentConstraint),biasConstraint:Ln(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},r=e.prototype.getConfig.call(this);return delete r.cell,Object.assign(n,r),n},t.fromConfig=function(n,r){return r.implmentation===0&&(r.implementation=1),new n(r)},t.className="LSTM",t}(Qm);Ne.registerClass(kee);var VP=function(e){function t(n){var r=e.call(this,n)||this;return r.cells=n.cells,r}return Ee(t,e),Object.defineProperty(t.prototype,"stateSize",{get:function(){for(var n=[],r=0,i=this.cells.slice().reverse();r<i.length;r++){var a=i[r];Array.isArray(a.stateSize)?n.push.apply(n,a.stateSize):n.push(a.stateSize)}return n},enumerable:!0,configurable:!0}),t.prototype.call=function(n,r){var i=this;return le(function(){for(var a=(n=n).slice(1),o=[],s=0,u=i.cells.slice().reverse();s<u.length;s++){var l=u[s];Array.isArray(l.stateSize)?o.push(a.splice(0,l.stateSize.length)):o.push(a.splice(0,1))}o.reverse();for(var c,f=[],d=0;d<i.cells.length;++d)l=i.cells[d],a=o[d],c=d===0?[n[0]].concat(a):[c[0]].concat(a),c=l.call(c,r),f.push(c.slice(1));a=[];for(var h=0,p=f.slice().reverse();h<p.length;h++){var g=p[h];a.push.apply(a,g)}return[c[0]].concat(a)})},t.prototype.build=function(n){var r;xP(n)&&(n=n[0]),n=n,this.cells.forEach(function(i,a){Xh("RNNCell_"+a,function(){i.build(n),r=Array.isArray(i.stateSize)?i.stateSize[0]:i.stateSize,n=[n[0],r]})}),this.built=!0},t.prototype.getConfig=function(){for(var n=[],r=0,i=this.cells;r<i.length;r++){var a=i[r];n.push({className:a.getClassName(),config:a.getConfig()})}var o={cells:n},s=e.prototype.getConfig.call(this);return Object.assign(o,s),o},t.fromConfig=function(n,r,i){i===void 0&&(i={});for(var a=[],o=0,s=r.cells;o<s.length;o++){var u=s[o];a.push(Xs(u,i))}return new n({cells:a})},Object.defineProperty(t.prototype,"trainableWeights",{get:function(){if(!this.trainable)return[];for(var n=[],r=0,i=this.cells;r<i.length;r++){var a=i[r];n.push.apply(n,a.trainableWeights)}return n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){for(var n=[],r=0,i=this.cells;r<i.length;r++){var a=i[r];n.push.apply(n,a.nonTrainableWeights)}if(!this.trainable){for(var o=[],s=0,u=this.cells;s<u.length;s++)a=u[s],o.push.apply(o,a.trainableWeights);return o.concat(n)}return n},enumerable:!0,configurable:!0}),t.prototype.getWeights=function(){for(var n=[],r=0,i=this.cells;r<i.length;r++){var a=i[r];n.push.apply(n,a.weights)}return wP(n)},t.prototype.setWeights=function(n){for(var r=[],i=0,a=this.cells;i<a.length;i++)for(var o=a[i],s=o.weights.length,u=n.splice(s),l=0;l<o.weights.length;++l)r.push([o.weights[l],u[l]]);_P(r)},t.className="StackedRNNCells",t}(Vb);function ev(e,t,n,r){function i(){return FJ(e(),t)}if(n===void 0&&(n=null),r===void 0&&(r=1),r>1){for(var a=[],o=0;o<r;o++)a.push(Xm(i,e,n));return a.map(function(s){return zu(s.clone())})}return zu(Xm(i,e,n).clone())}Ne.registerClass(VP);var Tee=function(e){function t(n){var r=e.call(this,n)||this;return r.layer=n.layer,r}return Ee(t,e),t.prototype.build=function(n){this.built=!0},Object.defineProperty(t.prototype,"trainable",{get:function(){return this.layer!=null&&this.layer.trainable},set:function(n){this.layer!=null&&(this.layer.trainable=n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.layer.trainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.layer.nonTrainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updates",{get:function(){return this.layer._updates},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"losses",{get:function(){return this.layer.losses},enumerable:!0,configurable:!0}),t.prototype.getWeights=function(){return this.layer.getWeights()},t.prototype.setWeights=function(n){this.layer.setWeights(n)},t.prototype.getConfig=function(){var n={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.prototype.setFastWeightInitDuringBuild=function(n){e.prototype.setFastWeightInitDuringBuild.call(this,n),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(n)},t.fromConfig=function(n,r,i){i===void 0&&(i={});var a=Xs(r.layer,i);delete r.layer;var o={layer:a};return Object.assign(o,r),new n(o)},t}(tn),Oee=function(e){function t(n){var r=e.call(this,n)||this;return r.supportsMasking=!0,r}return Ee(t,e),t.prototype.build=function(n){if((n=Kn(n)).length<3)throw new ie("TimeDistributed layer expects an input shape >= 3D, but received input shape "+JSON.stringify(n));this.inputSpec=[{shape:n}];var r=[n[0]].concat(n.slice(2));this.layer.built||(this.layer.build(r),this.layer.built=!0),e.prototype.build.call(this,n)},t.prototype.computeOutputShape=function(n){var r=[(n=Kn(n))[0]].concat(n.slice(2)),i=this.layer.computeOutputShape(r),a=n[1];return[i[0],a].concat(i.slice(1))},t.prototype.call=function(n,r){var i=this;return le(function(){return Eee(function(a,o){return[Dt(i.layer.call(a,r)),[]]},n=Dt(n),[],!1,null,null,!1,!0)[1]})},t.className="TimeDistributed",t}(Tee);function EBe(e){Hm(g4e,"BidirectionalMergeMode",e)}Ne.registerClass(Oee);var CBe="concat",Iee=function(e){function t(n){var r=e.call(this,n)||this,i=n.layer.getConfig(),a={};a.className=n.layer.getClassName(),a.config=i,r.forwardLayer=Xs(a),i.goBackwards=i.goBackwards!==!0;var o={};if(o.className=n.layer.getClassName(),o.config=i,r.backwardLayer=Xs(o),r.forwardLayer.name="forward_"+r.forwardLayer.name,r.backwardLayer.name="backward_"+r.backwardLayer.name,r.mergeMode=n.mergeMode===void 0?CBe:n.mergeMode,EBe(r.mergeMode),n.weights)throw new $t("weights support is not implemented for Bidirectional layer yet.");return r._stateful=n.layer.stateful,r.returnSequences=n.layer.returnSequences,r.returnState=n.layer.returnState,r.supportsMasking=!0,r._trainable=!0,r.inputSpec=n.layer.inputSpec,r.numConstants=null,r}return Ee(t,e),Object.defineProperty(t.prototype,"trainable",{get:function(){return this._trainable},set:function(n){this._trainable=n,this.forwardLayer!=null&&(this.forwardLayer.trainable=n),this.backwardLayer!=null&&(this.backwardLayer.trainable=n)},enumerable:!0,configurable:!0}),t.prototype.getWeights=function(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())},t.prototype.setWeights=function(n){var r=n.length,i=Math.floor(r/2);this.forwardLayer.setWeights(n.slice(0,i)),this.backwardLayer.setWeights(n.slice(i))},t.prototype.computeOutputShape=function(n){var r,i,a,o=this.forwardLayer.computeOutputShape(n);return Array.isArray(o)&&Array.isArray(o[0])||(o=[o]),o=o,this.returnState&&(a=o.slice(1)),r=o[0],r=r,this.mergeMode==="concat"?(r[r.length-1]*=2,i=[r]):i=this.mergeMode==null?[r,r.slice()]:[r],this.returnState?this.mergeMode==null?i.concat(a).concat(a.slice()):[r].concat(a).concat(a.slice()):_a(i)},t.prototype.apply=function(n,r){var i=r==null?null:r.initialState,a=r==null?null:r.constants;r==null&&(r={});var o=See(n,i,a,this.numConstants);if(n=o.inputs,i=o.initialState,a=o.constants,Array.isArray(n)&&(i=n.slice(1),n=n[0]),(i==null||i.length===0)&&a==null)return e.prototype.apply.call(this,n,r);var s=[],u=[];if(i!=null){var l=i.length;if(l%2>0)throw new ie("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");r.initialState=i,s.push.apply(s,i);var c=i.map(function(y){return new Fi({shape:y.shape})});this.forwardLayer.stateSpec=c.slice(0,l/2),this.backwardLayer.stateSpec=c.slice(l/2),u.push.apply(u,c)}if(a!=null)throw new $t("Support for constants in Bidirectional layers is not implemented yet.");for(var f=s[0]instanceof Zu,d=0,h=s;d<h.length;d++)if(h[d]instanceof Zu!==f)throw new ie("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(f){var p=[n].concat(s),g=this.inputSpec.concat(u),m=this.inputSpec;this.inputSpec=g;var v=e.prototype.apply.call(this,p,r);return this.inputSpec=m,v}return e.prototype.apply.call(this,n,r)},t.prototype.call=function(n,r){var i=this;return le(function(){var a,o,s,u,l=r.initialState;if(l==null)a=i.forwardLayer.call(n,r),o=i.backwardLayer.call(n,r);else{var c=l.slice(0,l.length/2),f=l.slice(l.length/2);a=i.forwardLayer.call(n,Object.assign(r,{initialState:c})),o=i.backwardLayer.call(n,Object.assign(r,{initialState:f}))}return i.returnState&&(Array.isArray(a)&&(s=a.slice(1).concat(o.slice(1))),a=a[0],o=o[0]),i.returnSequences&&(o=Ku(o,1)),i.mergeMode==="concat"?u=NJ([a,o]):i.mergeMode==="sum"?u=Wt(a,o):i.mergeMode==="ave"?u=rt(.5,Wt(a,o)):i.mergeMode==="mul"?u=rt(a,o):i.mergeMode==null&&(u=[a,o]),i.returnState?i.mergeMode==null?u.concat(s):[u].concat(s):u})},t.prototype.resetStates=function(n){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()},t.prototype.build=function(n){var r=this;Xh(this.forwardLayer.name,function(){r.forwardLayer.build(n)}),Xh(this.backwardLayer.name,function(){r.backwardLayer.build(n)}),this.built=!0},t.prototype.computeMask=function(n,r){var i;if(Array.isArray(r)&&(r=r[0]),i=this.returnSequences?this.mergeMode==null?[r,r]:r:this.mergeMode==null?[null,null]:null,this.returnState){var a=this.forwardLayer.states.map(function(o){return null});return Array.isArray(i)?i.concat(a).concat(a):[i].concat(a).concat(a)}return i},Object.defineProperty(t.prototype,"trainableWeights",{get:function(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nonTrainableWeights",{get:function(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)},enumerable:!0,configurable:!0}),t.prototype.setFastWeightInitDuringBuild=function(n){e.prototype.setFastWeightInitDuringBuild.call(this,n),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(n),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(n)},t.prototype.getConfig=function(){var n={mergeMode:this.mergeMode},r=e.prototype.getConfig.call(this);return Object.assign(n,r),n},t.fromConfig=function(n,r){var i=Xs(r.layer);if(delete r.layer,r.numConstants!=null)throw new $t("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");var a=r;return a.layer=i,new n(a)},t.className="Bidirectional",t}(Tee);function ABe(e){return new Pb(e)}function kBe(e){return new AQ(e)}function TBe(e){return new SQ(e)}function OBe(e){return new EQ(e)}function IBe(e){return new CQ(e)}function NBe(e){return new TQ(e)}function DBe(e){return new kQ(e)}function RBe(e){return new MQ(e)}function FBe(e){return new BP(e)}function MBe(e){return new RQ(e)}function PBe(e){return new DQ(e)}function $Be(e){return new FQ(e)}function LBe(e){return new PQ(e)}function BBe(e){return new $Q(e)}function zBe(e){return new LQ(e)}function jBe(e){return new UQ(e)}function UBe(e){return new zQ(e)}function WBe(e){return new zP(e)}function VBe(e){return new BQ(e)}function qBe(e){return new jQ(e)}function HBe(e){return new WQ(e)}function GBe(e){return new VQ(e)}function KBe(e){return new qQ(e)}function XBe(e){return new GQ(e)}function YBe(e){return new KQ(e)}function ZBe(e){return new YQ(e)}function JBe(e){return new QQ(e)}function QBe(e){return new ZQ(e)}function eze(e){return new JQ(e)}function tze(e){return new XQ(e)}function nze(e){return new eee(e)}function rze(e){return new iee(e)}function ize(e){return new aee(e)}function aze(e){return new oee(e)}function qP(e){return new cee(e)}function oze(e){return qP(e)}function sze(e){return qP(e)}function HP(e){return new hee(e)}function uze(e){return HP(e)}function lze(e){return HP(e)}function GP(e){return new mee(e)}function cze(e){return GP(e)}function fze(e){return GP(e)}function dze(e){return new yee(e)}function hze(e){return new wee(e)}function Nee(e){return new bee(e)}function Dee(e){return new _ee(e)}function Ree(e){return new lee(e)}function Fee(e){return new dee(e)}function pze(e){return new gee(e)}function gze(e){return new Aee(e)}function mze(e){return new UP(e)}function vze(e){return new kee(e)}function yze(e){return new WP(e)}function bze(e){return new Cee(e)}function xze(e){return new jP(e)}function wze(e){return new Qm(e)}function _ze(e){return new VP(e)}function Sze(e){return new Iee(e)}function Eze(e){return new Oee(e)}Ne.registerClass(Iee);var Cze=Nee,Aze=Dee,kze=Ree,Tze=Fee;function Oze(e){return new tee(e)}function Ize(e){return new nee(e)}function Nze(e){return new ree(e)}function Dze(e){return new HQ(e)}var Rze=Object.freeze({inputLayer:ABe,elu:kBe,reLU:TBe,leakyReLU:OBe,prelu:IBe,softmax:NBe,thresholdedReLU:DBe,conv1d:RBe,conv2d:FBe,conv2dTranspose:MBe,conv3d:PBe,separableConv2d:$Be,cropping2D:LBe,upSampling2d:BBe,depthwiseConv2d:zBe,activation:jBe,dense:UBe,dropout:WBe,spatialDropout1d:VBe,flatten:qBe,repeatVector:HBe,reshape:GBe,permute:KBe,embedding:XBe,add:YBe,average:ZBe,concatenate:JBe,maximum:QBe,minimum:eze,multiply:tze,dot:nze,batchNormalization:rze,layerNormalization:ize,zeroPadding2d:aze,averagePooling1d:qP,avgPool1d:oze,avgPooling1d:sze,averagePooling2d:HP,avgPool2d:uze,avgPooling2d:lze,averagePooling3d:GP,avgPool3d:cze,avgPooling3d:fze,globalAveragePooling1d:dze,globalAveragePooling2d:hze,globalMaxPooling1d:Nee,globalMaxPooling2d:Dee,maxPooling1d:Ree,maxPooling2d:Fee,maxPooling3d:pze,gru:gze,gruCell:mze,lstm:vze,lstmCell:yze,simpleRNN:bze,simpleRNNCell:xze,rnn:wze,stackedRNNCells:_ze,bidirectional:Sze,timeDistributed:Eze,globalMaxPool1d:Cze,globalMaxPool2d:Aze,maxPool1d:kze,maxPool2d:Tze,Layer:tn,RNN:Qm,RNNCell:Vb,input:tBe,gaussianNoise:Oze,gaussianDropout:Ize,alphaDropout:Nze,masking:Dze});function Fze(e,t){return CP(e,t)}function Mze(e,t){return eQ(e,t)}function Pze(e,t){return tQ(e,t)}function $ze(e,t){return AP(e,t)}function Lze(e,t){return kP(e,t)}function Bze(e,t){return QJ(e,t)}function zze(e,t){return pLe(e,t)}function jze(e,t){return SP(e,t)}function Uze(e,t){return BE(e,t)}function Wze(e,t){return Zm(e,t)}function Vze(e,t){return Zm(e,t)}function qze(e,t){return Zm(e,t)}function Hze(e,t){return Zh(e,t)}function Gze(e,t){return Zh(e,t)}function Kze(e,t){return Zh(e,t)}Object.freeze({binaryAccuracy:Fze,binaryCrossentropy:Mze,sparseCategoricalAccuracy:Pze,categoricalAccuracy:$ze,categoricalCrossentropy:Lze,precision:Bze,recall:zze,cosineProximity:jze,meanAbsoluteError:Uze,meanAbsolutePercentageError:Wze,MAPE:Vze,mape:qze,meanSquaredError:Hze,MSE:Gze,mse:Kze}),Object.freeze({modelFromJSON:XLe});function Xze(e){return new HE(e)}function Yze(e){return hBe(e)}function Zze(e){return pBe(e)}Object.freeze({l1l2:Xze,l1:Yze,l2:Zze});var Jze=function(e){function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.model=null,n}return Ee(t,e),t.prototype.setModel=function(n){if(!(n instanceof jb))throw new Error("model must be a LayersModel, not some other Container");this.model=n},t}(Ym);function YE(e,t){return e<t}function Mee(e,t){return e>t}(function(e){function t(n){var r=e.call(this)||this;if(n==null&&(n={}),n.restoreBestWeights)throw new $t("restoreBestWeights = True is not implemented in EarlyStopping yet.");return r.monitor=n.monitor||"val_loss",r.minDelta=Math.abs(n.minDelta||0),r.patience=n.patience||0,r.verbose=n.verbose||0,r.mode=n.mode||"auto",r.baseline=n.baseline,["auto","min","max"].indexOf(r.mode)===-1&&(console.warn("EarlyStopping mode '"+r.mode+"' is invalid. Falling back to mode 'auto'."),r.mode="auto"),r.mode==="min"?r.monitorFunc=YE:r.mode==="max"||r.monitor.indexOf("acc")!==-1?r.monitorFunc=Mee:r.monitorFunc=YE,r.monitorFunc===YE&&(r.minDelta*=-1),r}return Ee(t,e),t.prototype.onTrainBegin=function(n){return At(this,void 0,void 0,function(){return St(this,function(r){return this.wait=0,this.stoppedEpoch=0,this.baseline!=null?this.best=this.baseline:this.best=this.monitorFunc===YE?1/0:-1/0,[2]})})},t.prototype.onEpochEnd=function(n,r){return At(this,void 0,void 0,function(){var i;return St(this,function(a){switch(a.label){case 0:return[4,Gf(r)];case 1:return a.sent(),(i=this.getMonitorValue(r))==null?[2]:(this.monitorFunc(i-this.minDelta,this.best)?(this.best=i,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=n,this.model.stopTraining=!0)),[2])}})})},t.prototype.onTrainEnd=function(n){return At(this,void 0,void 0,function(){return St(this,function(r){return this.stoppedEpoch>0&&this.verbose&&console.log("Epoch "+this.stoppedEpoch+": early stopping."),[2]})})},t.prototype.getMonitorValue=function(n){n==null&&(n={});var r=n[this.monitor];return r==null&&console.warn("Metric for EarlyStopping "+this.monitor+" is not available. Available metrics are: "+Object.keys(n)),r},t})(Jze);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ys,Pee,KP=function(){return(KP=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function ep(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})}function tp(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(u){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){o=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(c[0]===6&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(f){c=[6,f],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}(function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"})(Ys||(Ys={})),function(e){(function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"})(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))}(Pee||(Pee={}));var Qze={};function $ee(e){return Qze[e]}function $(e,t,n,r){var i=t.inputParams[e];if(i&&i.inputIndexStart!==void 0){var a=i.inputIndexStart,o=i.inputIndexEnd===0?void 0:i.inputIndexEnd===void 0?a+1:i.inputIndexEnd;if(i.type==="tensor")return Ea(t.inputNames[i.inputIndexStart],n,r);if(i.type==="tensors")return t.inputNames.slice(a,o).map(function(l){return Ea(l,n,r)});var s=Array.prototype.slice.call(Ea(t.inputNames.slice(a)[0],n,r).dataSync());return i.type==="number"?s[0]:s}var u=t.attrParams[e];return u&&u.value}function Ea(e,t,n){var r=$o(e),i=r[0],a=r[1],o=n.currentContextIds.find(function(s){return!!t[ZE(i,s)]});return o!==void 0?t[ZE(i,o)][a]:void 0}function e5e(e,t,n){return t[ZE(e,n.currentContextId)]}function tv(e,t){var n=$o(e),r=n[0],i=n[1];return[ZE(r,t&&t.currentContextId),i]}function ZE(e,t){return t?e+"-"+t:e}function $o(e){var t=e.lastIndexOf(":");return t===-1?[e,0]:[e.substring(0,t),Number(e.substring(t+1))]}function XP(e,t){for(var n=[],r=0;r<e.length;r+=t)n.push(e.slice(r,r+t));return n}var t5e=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],n5e=Object.freeze({json:t5e}),r5e=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"clip_value_min",name:"clipValueMin",type:"number"},{tfName:"clip_value_max",name:"clipValueMax",type:"number"}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"clipValueMin",name:"clipValueMin",type:"number",defaultValue:0},{tfName:"clipValueMax",name:"clipValueMax",type:"number",defaultValue:6}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],i5e=Object.freeze({json:r5e}),a5e=[{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"}]}],o5e=Object.freeze({json:a5e}),s5e=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]}],u5e=Object.freeze({json:s5e}),l5e=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],c5e=Object.freeze({json:l5e}),f5e=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],d5e=Object.freeze({json:f5e}),h5e=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]}],p5e=Object.freeze({json:h5e}),g5e=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],m5e=Object.freeze({json:g5e}),v5e=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}],y5e=Object.freeze({json:v5e}),b5e=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],x5e=Object.freeze({json:b5e}),w5e=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],_5e=Object.freeze({json:w5e}),S5e=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],E5e=Object.freeze({json:S5e}),C5e=[{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]}],A5e=Object.freeze({json:C5e}),k5e=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool",notSupported:!0}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],T5e=Object.freeze({json:k5e}),O5e=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],I5e=Object.freeze({json:O5e}),N5e=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]}],D5e=Object.freeze({json:N5e}),R5e=function(){function e(){var t=[n5e,i5e,o5e,u5e,c5e,d5e,p5e,x5e,y5e,m5e,_5e,E5e,A5e,T5e,I5e,D5e],n=[].concat.apply([],t.map(function(r){return r.json}));this.opMappers=n.reduce(function(r,i){return r[i.tfOpName]=i,r},{})}return Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),e.prototype.transformGraph=function(t,n){var r=this;n===void 0&&(n={});var i=[],a=[],o=t.node.reduce(function(d,h){return d[h.name]=r.mapNode(h),h.op.startsWith("Placeholder")&&i.push(d[h.name]),h.op==="Const"&&a.push(d[h.name]),d},{}),s=[],u=[],l={},c={};n!=null&&(l=this.mapSignatureEntries(n.inputs),c=this.mapSignatureEntries(n.outputs));var f=Object.keys(o);return f.forEach(function(d){var h=o[d];h.inputNames.forEach(function(p){var g=tv(p)[0];h.inputs.push(o[g]),o[g].children.push(h)})}),Object.keys(c).length===0?f.forEach(function(d){var h=o[d];h.children.length===0&&u.push(h)}):Object.keys(c).forEach(function(d){var h=tv(d)[0],p=o[h];p!=null&&(p.signatureKey=c[d],u.push(p))}),Object.keys(l).length>0?Object.keys(l).forEach(function(d){var h=tv(d)[0],p=o[h];p&&(p.signatureKey=l[d],s.push(p))}):s=i,{nodes:o,inputs:s,outputs:u,weights:a,placeholders:i,signature:n}},e.prototype.mapSignatureEntries=function(t){return Object.keys(t||{}).reduce(function(n,r){return n[t[r].name]=r,n},{})},e.prototype.mapNode=function(t){var n=$ee(t.op)||this.opMappers[t.op]||{};t.attr==null&&(t.attr={});var r={name:t.name,op:t.op,category:n.category,inputNames:(t.input||[]).map(function(i){return i.startsWith("^")?i.substr(1):i}),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr};return n.inputs!=null&&(r.inputParams=n.inputs.reduce(function(i,a){return i[a.name]={type:a.type,inputIndexStart:a.start,inputIndexEnd:a.end},i},{})),n.attrs!=null&&(r.attrParams=n.attrs.reduce(function(i,a){var o=a.type,s=void 0;switch(a.type){case"string":(s=YP(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=YP(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"string[]":(s=r$(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=r$(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"number":(s=JP(t.attr,a.tfName,a.defaultValue||0))===void 0&&a.tfDeprecatedName&&(s=JP(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"number[]":(s=n$(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=n$(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool":(s=ZP(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=ZP(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool[]":(s=a$(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=a$(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape":(s=t$(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=t$(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape[]":(s=i$(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=i$(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype":(s=QP(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=QP(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype[]":(s=e$(t.attr,a.tfName,a.defaultValue))===void 0&&a.tfDeprecatedName&&(s=e$(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: "+a.type+" for op: "+t.op)}return i[a.name]={value:s,type:o},i},{})),r},e}();function F5e(e){var t=pe().global;if(t.atob!==void 0)return t.atob(e);if(typeof Buffer!="undefined")return new Buffer(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function Lee(e,t){var n=Array.isArray(e)?String.fromCharCode.apply(null,e):F5e(e);return t?n:n.toLowerCase()}function YP(e,t,n,r){r===void 0&&(r=!1);var i=e[t];return i!=null?Lee(i.s,r):n}function ZP(e,t,n){var r=e[t];return r?r.b:n}function JP(e,t,n){var r=e[t]||{},i=r.i!=null?r.i:r.f!=null?r.f:n;return typeof i=="number"?i:parseInt(i,10)}function Bee(e){switch(typeof e=="string"&&(e=Ys[e]),e){case Ys.DT_FLOAT:return"float32";case Ys.DT_INT32:case Ys.DT_INT64:case Ys.DT_INT8:case Ys.DT_UINT8:return"int32";case Ys.DT_BOOL:return"bool";case Ys.DT_DOUBLE:return"float32";case Ys.DT_STRING:return"string";default:return null}}function QP(e,t,n){var r=e[t];return r&&r.type?Bee(r.type):n}function e$(e,t,n){var r=e[t];return r&&r.list&&r.list.type?r.list.type.map(function(i){return Bee(i)}):n}function zee(e){if(!e.unknownRank)return e.dim!=null?e.dim.map(function(t){return typeof t.size=="number"?t.size:parseInt(t.size,10)}):[]}function t$(e,t,n){var r=e[t];return r&&r.shape?zee(r.shape):n}function n$(e,t,n){var r=e[t];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(function(i){return typeof i=="number"?i:parseInt(i,10)}):n}function r$(e,t,n,r){r===void 0&&(r=!1);var i=e[t];return i&&i.list&&i.list.s?i.list.s.map(function(a){return Lee(a,r)}):n}function i$(e,t,n){var r=e[t];return r&&r.list&&r.list.shape?r.list.shape.map(function(i){return zee(i)}):n}function a$(e,t,n){var r=e[t];return r&&r.list&&r.list.b?r.list.b:n}var M5e=function(){function e(t,n,r){var i=this;this.node=t,this.tensorMap=n,this.context=r,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map(function(a){return i.getInput(a)}),t.rawAttrs!=null&&(this.attrs=Object.keys(t.rawAttrs).reduce(function(a,o){return a[o]=i.getAttr(o),a},{}))}return e.prototype.getInput=function(t){return Ea(t,this.tensorMap,this.context)},e.prototype.getAttr=function(t,n){var r=this.node.rawAttrs[t];if(r.tensor!=null)return Ea(t,this.tensorMap,this.context);if(r.i!=null||r.f!=null)return JP(this.node.rawAttrs,t,n);if(r.s!=null)return YP(this.node.rawAttrs,t,n);if(r.b!=null)return ZP(this.node.rawAttrs,t,n);if(r.shape!=null)return t$(this.node.rawAttrs,t,n);if(r.type!=null)return QP(this.node.rawAttrs,t,n);if(r.list!=null){if(r.list.i!=null||r.list.f!=null)return n$(this.node.rawAttrs,t,n);if(r.list.s!=null)return r$(this.node.rawAttrs,t,n);if(r.list.shape!=null)return i$(this.node.rawAttrs,t,n);if(r.list.b!=null)return a$(this.node.rawAttrs,t,n);if(r.list.type!=null)return e$(this.node.rawAttrs,t,n)}return n},e}(),P5e=function(e,t,n){switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[Wt($("a",e,t,n),$("b",e,t,n))];case"AddN":return[iM($("tensors",e,t,n))];case"FloorMod":case"Mod":return[F3($("a",e,t,n),$("b",e,t,n))];case"Mul":return[rt($("a",e,t,n),$("b",e,t,n))];case"RealDiv":case"Div":return[Cr($("a",e,t,n),$("b",e,t,n))];case"DivNoNan":return[rE($("a",e,t,n),$("b",e,t,n))];case"FloorDiv":return[BS($("a",e,t,n),$("b",e,t,n))];case"Sub":return[Er($("a",e,t,n),$("b",e,t,n))];case"Minimum":return[Am($("a",e,t,n),$("b",e,t,n))];case"Maximum":return[Vu($("a",e,t,n),$("b",e,t,n))];case"Pow":return[km($("a",e,t,n),$("b",e,t,n))];case"SquaredDifference":return[oE($("a",e,t,n),$("b",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},$5e=function(e,t,n){switch(e.op){case"Abs":case"ComplexAbs":return[Df($("x",e,t,n))];case"Acos":return[p3($("x",e,t,n))];case"Acosh":return[g3($("x",e,t,n))];case"Asin":return[m3($("x",e,t,n))];case"Asinh":return[v3($("x",e,t,n))];case"Atan":return[y3($("x",e,t,n))];case"Atan2":return[R3($("x",e,t,n),$("y",e,t,n))];case"Atanh":return[b3($("x",e,t,n))];case"Ceil":return[x3($("x",e,t,n))];case"Complex":return[ri($("real",e,t,n),$("imag",e,t,n))];case"Cos":return[w3($("x",e,t,n))];case"Cosh":return[_3($("x",e,t,n))];case"Elu":return[Lm($("x",e,t,n))];case"Erf":return[S3($("x",e,t,n))];case"Exp":return[E3($("x",e,t,n))];case"Expm1":return[C3($("x",e,t,n))];case"Floor":return[MS($("x",e,t,n))];case"Log":return[oc($("x",e,t,n))];case"Log1p":return[A3($("x",e,t,n))];case"Imag":return[is($("x",e,t,n))];case"Neg":return[Rf($("x",e,t,n))];case"Reciprocal":return[k3($("x",e,t,n))];case"Real":return[eo($("x",e,t,n))];case"Relu":return[$f($("x",e,t,n))];case"Round":return[T3($("x",e,t,n))];case"Selu":return[xE($("x",e,t,n))];case"Sigmoid":return[$S($("x",e,t,n))];case"Sin":return[I3($("x",e,t,n))];case"Sign":return[O3($("x",e,t,n))];case"Sinh":return[N3($("x",e,t,n))];case"Softplus":return[ub($("x",e,t,n))];case"Sqrt":return[lb($("x",e,t,n))];case"Square":return[aE($("x",e,t,n))];case"Tanh":return[LS($("x",e,t,n))];case"Tan":return[D3($("x",e,t,n))];case"Relu6":case"ClipByValue":return[xa($("x",e,t,n),$("clipValueMin",e,t,n),$("clipValueMax",e,t,n))];case"Rsqrt":return[PS(Ea(e.inputNames[0],t,n))];case"Prod":return[yE($("x",e,t,n),$("axes",e,t,n))];case"LeakyRelu":return[bE($("x",e,t,n),$("alpha",e,t,n))];case"Prelu":return[Cb($("x",e,t,n),$("alpha",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},L5e=function(){function e(t,n,r,i,a,o,s){this.name=t,this.dtype=n,this.maxSize=r,this.elementShape=i,this.identicalElementShapes=a,this.dynamicSize=o,this.clearAfterRead=s,this.tensors=[],this.closed_=!1,this.id=e.nextId++}return Object.defineProperty(e.prototype,"closed",{get:function(){return this.closed_},enumerable:!0,configurable:!0}),e.prototype.clearAndClose=function(){this.tensors.forEach(function(t){return t.tensor.dispose()}),this.tensors=[],this.closed_=!0},e.prototype.size=function(){return this.tensors.length},e.prototype.read=function(t){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(t<0||t>=this.tensors.length)throw new Error("Tried to read from index "+t+", but array size is: "+this.tensors.length);var n=this.tensors[t];if(n.cleared)throw new Error("TensorArray "+this.name+": Could not read index "+t+" twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(n.cleared=!0),n.read=!0,n.tensor},e.prototype.readMany=function(t){var n=this;return t.map(function(r){return n.read(r)})},e.prototype.write=function(t,n){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error("Tried to write to index "+t+", but array is not resizeable and size is: "+this.maxSize);var r=this.tensors[t]||{};if(n.dtype!==this.dtype)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+`,
          because the value dtype is `+n.dtype+", but TensorArray dtype is "+this.dtype+".");if(this.size()!==0||this.elementShape!=null&&this.elementShape.length!==0||(this.elementShape=n.shape),this.assertShapesMatchAllowUndefinedSize(this.elementShape,n.shape,"TensorArray "+this.name+": Could not write to TensorArray index "+t+"."),r&&r.read)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+", because it has already been read.");if(r&&r.written)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+", because it has already been written.");r.tensor=n,r.written=!0,this.tensors[t]=r},e.prototype.writeMany=function(t,n){var r=this;if(t.length!==n.length)throw new Error("TensorArray "+this.name+": could not write multiple tensors,because the index size: "+t.length+" is not the same as tensors size: "+n.length+".");t.forEach(function(i,a){return r.write(i,n[a])})},e.prototype.gather=function(t,n){if(n&&n!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but gather requested dtype "+n);if(!t){t=[];for(var r=0;r<this.size();r++)t.push(r)}if(t.length===0)return Rr([],[0].concat(this.elementShape));var i=this.readMany(t);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,i[0].shape,"TensorArray shape mismatch: "),as(i,0)},e.prototype.concat=function(t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but concat requested dtype "+t);if(this.size()===0)return Rr([],[0].concat(this.elementShape));for(var n=[],r=0;r<this.size();r++)n.push(r);var i=this.readMany(n);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,i[0].shape,"TensorArray shape mismatch: tensor array shape ("+this.elementShape+") vs first tensor shape ("+i[0].shape+")"),Hi(i,0)},e.prototype.scatter=function(t,n){if(n.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+n.dtype);if(t.length!==n.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: "+t.length+" vs. "+n.shape[0]);var r=Math.max.apply(Math,t);if(!this.dynamicSize&&r>=this.maxSize)throw new Error("Max index must be < array size ("+r+"  vs. "+this.maxSize+")");this.writeMany(t,Nf(n,0))},e.prototype.split=function(t,n){var r=this;if(n.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+n.dtype);var i=0,a=t.map(function(c){return i+=c});if(i!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        `+i+", and tensor's shape is: "+n.shape);if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths ("+this.maxSize+" vs. "+t.length+"), and the TensorArray is not marked as dynamically resizeable");var o=i===0?0:n.size/i,s=[];le(function(){n=n.reshape([1,i,o]);for(var c=0;c<t.length;++c){var f=[0,c===0?0:a[c-1],0],d=[1,t[c],o];s[c]=Ro(n,f,d).reshape(r.elementShape)}return s});for(var u=[],l=0;l<t.length;l++)u[l]=l;this.writeMany(u,s)},e.prototype.assertShapesMatchAllowUndefinedSize=function(t,n,r){r===void 0&&(r=""),pt.assert(this.shapesEqualAllowUndefinedSize(t,n),function(){return r+" Shapes "+t+" and "+n+" must match"})},e.prototype.shapesEqualAllowUndefinedSize=function(t,n){if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r]!==-1&&n[r]!==-1&&t[r]!==n[r])return!1;return!0},e.nextId=0,e}(),B5e=void 0,z5e=function(e,t,n){return ep(B5e,void 0,void 0,function(){var r,i,a,o,s,u,l,c,f,d,h,p,g,m,v,y,b,x,w,S,C,_,E,A,k,T,I,N,O,D,L,W,G,K,ee;return tp(this,function(ce){switch(ce.label){case 0:switch(e.op){case"LoopCond":return[3,1];case"Switch":return[3,2];case"Merge":return[3,4];case"Enter":return[3,5];case"Exit":return[3,6];case"NextIteration":return[3,7];case"TensorArrayV3":return[3,8];case"TensorArrayWriteV3":return[3,9];case"TensorArrayReadV3":return[3,10];case"TensorArrayGatherV3":return[3,11];case"TensorArrayScatterV3":return[3,12];case"TensorArrayConcatV3":return[3,13];case"TensorArraySplitV3":return[3,14];case"TensorArraySizeV3":return[3,15];case"TensorArrayCloseV3":return[3,16]}return[3,17];case 1:return[2,[$("pred",e,t,n).clone()]];case 2:return r=$("pred",e,t,n),i=$("data",e,t,n),[4,r.data()];case 3:return[2,ce.sent()[0]?[void 0,i.clone()]:[i.clone(),void 0]];case 4:return[2,(a=e.inputNames.find(function(he){return Ea(he,t,n)!==void 0}))?[Ea(a,t,n).clone()]:void 0];case 5:return o=$("frameName",e,t,n),s=$("tensor",e,t,n),n.enterFrame(o),[2,[s.clone()]];case 6:return u=$("tensor",e,t,n),n.exitFrame(),[2,[u.clone()]];case 7:return l=$("tensor",e,t,n),n.nextIteration(),[2,[l.clone()]];case 8:return c=$("size",e,t,n),f=$("dtype",e,t,n),d=$("elementShape",e,t,n),h=$("dynamicSize",e,t,n),p=$("clearAfterRead",e,t,n),g=$("identicalElementShapes",e,t,n),m=$("name",e,t,n),v=new L5e(m,f,c,d,g,h,p),n.addTensorArray(v),[2,[Ve(v.id),Ve(1)]];case 9:return y=$("tensorArrayId",e,t,n),b=$("index",e,t,n),x=$("tensor",e,t,n),n.getTensorArray(y).write(b,x),[2,[Ve(1)]];case 10:return w=$("tensorArrayId",e,t,n),S=$("index",e,t,n),[2,[n.getTensorArray(w).read(S)]];case 11:return C=$("tensorArrayId",e,t,n),_=$("indices",e,t,n),E=$("dtype",e,t,n),[2,[n.getTensorArray(C).gather(_,E)]];case 12:return A=$("tensorArrayId",e,t,n),k=$("indices",e,t,n),T=$("tensor",e,t,n),n.getTensorArray(A).scatter(k,T),[2,[Ve(1)]];case 13:return I=$("tensorArrayId",e,t,n),N=n.getTensorArray(I),O=$("dtype",e,t,n),[2,[N.concat(O)]];case 14:return D=$("tensorArrayId",e,t,n),L=$("tensor",e,t,n),W=$("lengths",e,t,n),n.getTensorArray(D).split(W,L),[2,[Ve(1)]];case 15:return G=$("tensorArrayId",e,t,n),K=n.getTensorArray(G),[2,[Ve(K.size(),"int32")]];case 16:return ee=$("tensorArrayId",e,t,n),n.getTensorArray(ee).clearAndClose(),[2,[Ve(0)]];case 17:throw TypeError("Node type "+e.op+" is not implemented")}})})},j5e=function(e,t,n){switch(e.op){case"Conv1D":var r=$("stride",e,t,n),i=$("pad",e,t,n),a=$("dataFormat",e,t,n).toUpperCase(),o=$("dilation",e,t,n);return[sE($("x",e,t,n),$("filter",e,t,n),r,i,a,o)];case"Conv2D":r=$("strides",e,t,n),i=$("pad",e,t,n),a=$("dataFormat",e,t,n).toUpperCase();var s=$("dilations",e,t,n);return[Wh($("x",e,t,n),$("filter",e,t,n),[r[1],r[2]],i,a,[s[1],s[2]])];case"_FusedConv2D":case"FusedDepthwiseConv2dNative":var u=$("fusedOps",e,t,n),l=u[0],c=u[1],f=l==="biasadd",d=c==="prelu",h=l==="fusedbatchnorm",p=$("numArgs",e,t,n);if(f){if(d&&p!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!d&&p!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(h)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported.");r=$("strides",e,t,n),i=$("pad",e,t,n),a=$("dataFormat",e,t,n).toUpperCase(),s=$("dilations",e,t,n);var g=$("args",e,t,n),m=g[0],v=g[1];return[(e.op==="_FusedConv2D"?Bf.conv2d:Bf.depthwiseConv2d)({x:$("x",e,t,n),filter:$("filter",e,t,n),strides:[r[1],r[2]],pad:i,dataFormat:a,dilations:[s[1],s[2]],bias:m,activation:c,preluActivationWeights:v})];case"Conv2DBackpropInput":case"Conv2dTranspose":var y=$("outputShape",e,t,n);return r=$("strides",e,t,n),i=$("pad",e,t,n),[lE($("x",e,t,n),$("filter",e,t,n),y,[r[1],r[2]],i)];case"DepthwiseConv2dNative":case"DepthwiseConv2d":return r=$("strides",e,t,n),i=$("pad",e,t,n),s=$("dilations",e,t,n),a=$("dataFormat",e,t,n).toUpperCase(),[Pm($("input",e,t,n),$("filter",e,t,n),[r[1],r[2]],i,a,[s[1],s[2]])];case"Conv3D":return r=$("strides",e,t,n),i=$("pad",e,t,n),a=$("dataFormat",e,t,n).toUpperCase(),s=$("dilations",e,t,n),[uE($("x",e,t,n),$("filter",e,t,n),[r[1],r[2],r[3]],i,a,[s[1],s[2],s[3]])];case"AvgPool":r=$("strides",e,t,n),i=$("pad",e,t,n);var b=$("kernelSize",e,t,n);return[dE($("x",e,t,n),[b[1],b[2]],[r[1],r[2]],i)];case"MaxPool":return r=$("strides",e,t,n),i=$("pad",e,t,n),b=$("kernelSize",e,t,n),[fE($("x",e,t,n),[b[1],b[2]],[r[1],r[2]],i)];case"MaxPoolWithArgmax":r=$("strides",e,t,n),i=$("pad",e,t,n),b=$("kernelSize",e,t,n);var x=$("includeBatchInIndex",e,t,n),w=_M($("x",e,t,n),[b[1],b[2]],[r[1],r[2]],i,x);return[w.result,w.indexes];case"AvgPool3D":return r=$("strides",e,t,n),i=$("pad",e,t,n),b=$("kernelSize",e,t,n),[pE($("x",e,t,n),[b[1],b[2],b[3]],[r[1],r[2],r[3]],i)];case"MaxPool3D":return r=$("strides",e,t,n),i=$("pad",e,t,n),b=$("kernelSize",e,t,n),[hE($("x",e,t,n),[b[1],b[2],b[3]],[r[1],r[2],r[3]],i)];default:throw TypeError("Node type "+e.op+" is not implemented")}},U5e=function(e,t,n){switch(e.op){case"Fill":var r=$("shape",e,t,n),i=$("dtype",e,t,n),a=$("value",e,t,n);return[Em(r,a,i)];case"LinSpace":var o=$("start",e,t,n),s=$("stop",e,t,n),u=$("num",e,t,n);return[t3(o,s,u)];case"Multinomial":var l=$("logits",e,t,n),c=$("numSamples",e,t,n),f=$("seed",e,t,n);return[cM(l,c,f)];case"OneHot":var d=$("indices",e,t,n),h=$("depth",e,t,n),p=$("onValue",e,t,n),g=$("offValue",e,t,n);return[zh(d,h,p,g)];case"Ones":return[Wu($("shape",e,t,n),$("dtype",e,t,n))];case"OnesLike":return[No($("x",e,t,n))];case"RandomUniform":return[jh($("shape",e,t,n),$("minval",e,t,n),$("maxval",e,t,n),$("dtype",e,t,n))];case"Range":o=$("start",e,t,n);var m=$("stop",e,t,n),v=$("step",e,t,n);return[Cm(o,m,v,$("dtype",e,t,n))];case"TruncatedNormal":r=$("shape",e,t,n);var y=$("mean",e,t,n),b=$("stdDev",e,t,n);return f=$("seed",e,t,n),[yb(r,y,b,$("dtype",e,t,n),f)];case"Zeros":return[Tn($("shape",e,t,n),$("dtype",e,t,n))];case"ZerosLike":return[en($("x",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},W5e=void 0,V5e=function(e,t,n){return ep(W5e,void 0,void 0,function(){var r,i,a,o,s,u,l,c;return tp(this,function(f){switch(f.label){case 0:switch(e.op){case"NonMaxSuppressionV5":case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":return[3,1];case"Where":return[3,5];case"ListDiff":return[3,7]}return[3,8];case 1:return r=$("boxes",e,t,n),i=$("scores",e,t,n),a=$("maxOutputSize",e,t,n),o=$("iouThreshold",e,t,n),s=$("scoreThreshold",e,t,n),e.op!=="NonMaxSuppressionV5"?[3,3]:(u=$("softNmsSigma",e,t,n),[4,Lf.nonMaxSuppressionWithScoreAsync(r,i,a,o,s,u)]);case 2:return[2,[(c=f.sent()).selectedIndices,c.selectedScores]];case 3:return[4,Lf.nonMaxSuppressionAsync(r,i,a,o,s)];case 4:return[2,[f.sent()]];case 5:return l=$("condition",e,t,n).asType("bool"),[4,nE(l)];case 6:return c=[f.sent()],l.dispose(),[2,c];case 7:return[2,s3($("x",e,t,n),$("y",e,t,n))];case 8:throw TypeError("Node type "+e.op+" is not implemented")}})})},q5e=function(e,t,n){switch(e.op){case"TopKV2":var r=$("x",e,t,n),i=$("k",e,t,n),a=$("sorted",e,t,n),o=TM(r,i,a);return[o.values,o.indices];default:throw TypeError("Node type "+e.op+" is not implemented")}},H5e=function(e,t,n){switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":var r=$("default",e,t,n);return[Ea(e.name,t,n)||r];case"Placeholder":return[Ea(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":return[$("x",e,t,n).clone()];case"IdentityN":return $("x",e,t,n).map(function(l){return l.clone()});case"Snapshot":return[$("x",e,t,n).clone()];case"Shape":return[ba($("x",e,t,n).shape,"int32")];case"ShapeN":return $("x",e,t,n).map(function(l){return ba(l.shape)});case"Size":return[Ve($("x",e,t,n).size,"int32")];case"Rank":return[Ve($("x",e,t,n).rank,"int32")];case"NoOp":return[Ve(1)];case"Print":var i=$("x",e,t,n),a=$("data",e,t,n),o=$("message",e,t,n),s=$("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(o);for(var u=0;u<a.length;u++)console.log(Array.prototype.slice.call(a[u].dataSync()).slice(0,s));return[i];default:throw TypeError("Node type "+e.op+" is not implemented")}},G5e=function(e,t,n){switch(e.op){case"ResizeBilinear":var r=$("images",e,t,n),i=$("size",e,t,n),a=$("alignCorners",e,t,n);return[Lf.resizeBilinear(r,[i[0],i[1]],a)];case"ResizeNearestNeighbor":return r=$("images",e,t,n),i=$("size",e,t,n),a=$("alignCorners",e,t,n),[Lf.resizeNearestNeighbor(r,[i[0],i[1]],a)];case"CropAndResize":var o=$("image",e,t,n),s=$("boxes",e,t,n),u=$("boxInd",e,t,n),l=$("cropSize",e,t,n),c=$("method",e,t,n),f=$("extrapolationValue",e,t,n);return[Lf.cropAndResize(o,s,u,l,c,f)];default:throw TypeError("Node type "+e.op+" is not implemented")}},K5e=function(e,t,n){switch(e.op){case"Equal":return[Uh($("a",e,t,n),$("b",e,t,n))];case"NotEqual":return[Fm($("a",e,t,n),$("b",e,t,n))];case"Greater":return[Rm($("a",e,t,n),$("b",e,t,n))];case"GreaterEqual":return[bb($("a",e,t,n),$("b",e,t,n))];case"Less":return[mM($("a",e,t,n),$("b",e,t,n))];case"LessEqual":return[vM($("a",e,t,n),$("b",e,t,n))];case"LogicalAnd":return[Hu($("a",e,t,n),$("b",e,t,n))];case"LogicalNot":return[lM($("a",e,t,n))];case"LogicalOr":return[tE($("a",e,t,n),$("b",e,t,n))];case"Select":case"SelectV2":return[qs($("condition",e,t,n),$("a",e,t,n),$("b",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},X5e=function(e,t,n){switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[cE($("a",e,t,n),$("b",e,t,n),$("transposeA",e,t,n),$("transposeB",e,t,n))];case"Transpose":return[cn($("x",e,t,n),$("perm",e,t,n))];case"_FusedMatMul":var r=$("fusedOps",e,t,n),i=r[0],a=r[1],o=i==="biasadd",s=a==="prelu",u=$("numArgs",e,t,n);if(o){if(s&&u!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!s&&u!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}var l=$("args",e,t,n),c=l[0],f=l[1];return[Bf.matMul({a:$("a",e,t,n),b:$("b",e,t,n),transposeA:$("transposeA",e,t,n),transposeB:$("transposeB",e,t,n),bias:c,activation:a,preluActivationWeights:f})];default:throw TypeError("Node type "+e.op+" is not implemented")}},Y5e=function(e,t,n){switch(e.op){case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[Bh($("x",e,t,n),$("mean",e,t,n),$("variance",e,t,n),$("offset",e,t,n),$("scale",e,t,n),$("epsilon",e,t,n))];case"LRN":return[CM($("x",e,t,n),$("radius",e,t,n),$("bias",e,t,n),$("alpha",e,t,n),$("beta",e,t,n))];case"Softmax":return[Rh($("x",e,t,n))];case"LogSoftmax":return[VS($("x",e,t,n))];case"SparseToDense":return[_E($("sparseIndices",e,t,n),$("outputShape",e,t,n),$("sparseValues",e,t,n),$("defaultValue",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},Z5e=function(e,t,n){switch(e.op){case"Max":var r=$("axis",e,t,n),i=$("keepDims",e,t,n);return[Pf($("x",e,t,n),r,i)];case"Mean":return r=$("axis",e,t,n),i=$("keepDims",e,t,n),[Fr($("x",e,t,n),r,i)];case"Min":return r=$("axis",e,t,n),i=$("keepDims",e,t,n),[vE($("x",e,t,n),r,i)];case"Sum":return r=$("axis",e,t,n),i=$("keepDims",e,t,n),[qr($("x",e,t,n),r,i)];case"All":return r=$("axis",e,t,n),i=$("keepDims",e,t,n),[mE($("x",e,t,n),r,i)];case"Any":return r=$("axis",e,t,n),i=$("keepDims",e,t,n),[_b($("x",e,t,n),r,i)];case"ArgMax":return r=$("axis",e,t,n),[Sb($("x",e,t,n),r)];case"ArgMin":return r=$("axis",e,t,n),[SM($("x",e,t,n),r)];case"Prod":return r=$("axis",e,t,n),i=$("keepDims",e,t,n),[yE($("x",e,t,n),r,i)];default:throw TypeError("Node type "+e.op+" is not implemented")}},J5e=function(e,t,n){switch(e.op){case"ConcatV2":case"Concat":var r=$("n",e,t,n),i=$("axis",e,t,n),a=$("tensors",e,t,n);return a=a.slice(0,r),[Hi(a,i)];case"GatherV2":case"Gather":i=$("axis",e,t,n);var o=$("x",e,t,n),s=$("indices",e,t,n);return[Mm(o,s.asType("int32"),i)];case"ReverseV2":case"Reverse":return i=$("axis",e,t,n),o=$("x",e,t,n),[Ku(o,i)];case"Slice":var u=$("begin",e,t,n),l=$("size",e,t,n);return[Ro($("x",e,t,n),u,l)];case"StridedSlice":u=$("begin",e,t,n);var c=$("end",e,t,n),f=$("strides",e,t,n),d=$("beginMask",e,t,n),h=$("endMask",e,t,n),p=$("ellipsisMask",e,t,n),g=$("newAxisMask",e,t,n),m=$("shrinkAxisMask",e,t,n),v=$("x",e,t,n);if(u.length===1&&v.shape.length>1)for(var y=1;y<v.shape.length;y++)u.push(0),c.push(v.shape[y]),f.push(f[0]);return[kM(v,u,c,f,d,h,p,g,m)];case"Pack":return le(function(){var A=$("axis",e,t,n),k=$("tensors",e,t,n),T=k[0].shape,I=k[0].squeeze().shape,N=k.map(function(O){var D=pt.arraysEqual(O.shape,T);if(!D&&!pt.arraysEqual(O.squeeze().shape,I))throw new Error("the input tensors shape does not match");return D?O:O.reshape(T)});return[as(N,A)]});case"Unpack":return le(function(){var A=$("axis",e,t,n),k=$("tensor",e,t,n);return Nf(k,A)});case"Tile":var b=$("reps",e,t,n);return[sc($("x",e,t,n),b)];case"Split":case"SplitV":i=$("axis",e,t,n);var x=$("numOrSizeSplits",e,t,n);return ic($("x",e,t,n),x,i);case"ScatterNd":s=$("indices",e,t,n);var w=$("values",e,t,n),S=$("shape",e,t,n);return[OM(s,w,S)];case"GatherNd":var C=$("x",e,t,n);return s=$("indices",e,t,n),[IM(C,s)];case"SparseToDense":s=$("sparseIndices",e,t,n),S=$("outputShape",e,t,n);var _=$("sparseValues",e,t,n),E=$("defaultValue",e,t,n);return[_E(s,_,S,_.dtype===E.dtype?E:E.asType(_.dtype))];default:throw TypeError("Node type "+e.op+" is not implemented")}},Q5e=function(e,t,n){switch(e.op){case"FFT":return[Ab($("x",e,t,n))];case"IFFT":return[Bm($("x",e,t,n))];case"RFFT":return[kb($("x",e,t,n))];case"IRFFT":return[wE($("x",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}},e6e=function(e,t,n){switch(e.op){case"Cast":return[IS($("x",e,t,n),$("dtype",e,t,n))];case"ExpandDims":var r=$("axis",e,t,n);return[Do($("x",e,t,n),r)];case"Squeeze":return r=$("axis",e,t,n),[ab($("x",e,t,n),r)];case"Reshape":return[Ws($("x",e,t,n),$("shape",e,t,n))];case"PadV2":case"Pad":return[Gu($("x",e,t,n),XP($("padding",e,t,n),2),$("constantValue",e,t,n))];case"SpaceToBatchND":var i=$("blockShape",e,t,n),a=XP($("paddings",e,t,n),2);return[NS($("x",e,t,n),i,a)];case"BatchToSpaceND":i=$("blockShape",e,t,n);var o=XP($("crops",e,t,n),2);return[OS($("x",e,t,n),i,o)];case"DepthToSpace":var s=$("blockSize",e,t,n),u=$("dataFormat",e,t,n).toUpperCase();return[o3($("x",e,t,n),s,u)];default:throw TypeError("Node type "+e.op+" is not implemented")}};function jee(e,t,n){var r=function(i,a,o){switch(i.category){case"arithmetic":return le(function(){return P5e(i,a,o)});case"basic_math":return le(function(){return $5e(i,a,o)});case"control":return z5e(i,a,o);case"convolution":return le(function(){return j5e(i,a,o)});case"creation":return le(function(){return U5e(i,a,o)});case"dynamic":return V5e(i,a,o);case"evaluation":return le(function(){return q5e(i,a,o)});case"image":return le(function(){return G5e(i,a,o)});case"graph":return le(function(){return H5e(i,a,o)});case"logical":return le(function(){return K5e(i,a,o)});case"matrices":return le(function(){return X5e(i,a,o)});case"normalization":return le(function(){return Y5e(i,a,o)});case"reduction":return le(function(){return Z5e(i,a,o)});case"slice_join":return le(function(){return J5e(i,a,o)});case"spectral":return le(function(){return Q5e(i,a,o)});case"transformation":return le(function(){return e6e(i,a,o)});case"custom":var s=$ee(i.op);if(s&&s.customExecutor)return s.customExecutor(new M5e(i,a,o));throw TypeError("Custom op "+i.op+" is not registered.");default:throw TypeError("Unknown op '"+i.op+"'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}}(e,t,n);return r instanceof Promise?r.then(function(i){return[].concat(i)}):[].concat(r)}var Uee=function(){function e(t,n){this.weightMap=t,this.tensorArrayMap=n,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return e.prototype.newFrame=function(t,n){return{id:t,frameName:n,iterationId:0}},Object.defineProperty(e.prototype,"currentContext",{get:function(){return this.contexts},set:function(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentContextId",{get:function(){return this._currentContextIds[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentContextIds",{get:function(){return this._currentContextIds},enumerable:!0,configurable:!0}),e.prototype.generateCurrentContextIds=function(){for(var t=[],n=0;n<this.contexts.length-1;n++){var r=this.contexts.slice(0,this.contexts.length-n);t.push(this.contextIdforContexts(r))}t.push(""),this._currentContextIds=t},e.prototype.contextIdforContexts=function(t){return t?t.map(function(n){return n.id===0&&n.iterationId===0?"":n.frameName+"-"+n.iterationId}).join("/"):""},e.prototype.enterFrame=function(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))},e.prototype.exitFrame=function(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()},e.prototype.nextIteration=function(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");this.contexts=this.contexts.slice(),this.lastId++;var t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))},e.prototype.getWeight=function(t){return this.weightMap[t]},e.prototype.addTensorArray=function(t){this.tensorArrayMap[t.id]=t},e.prototype.getTensorArray=function(t){return this.tensorArrayMap[t]},e}();function Wee(e,t,n){for(var r=new Set,i=[],a=null,o=null,s=new Set,u=Object.keys(e).map(function(f){return $o(f)[0]}),l=t.slice();l.length>0;){var c=l.pop();(Vee(c)||i6e(c))&&a==null&&(o=(a=c).children.map(function(f){return f.name}).filter(function(f){return r.has(f)})),r.add(c.name),n[c.name]==null&&u.indexOf(c.name)===-1&&(c.inputs.length!==0?c.inputs.forEach(function(f){s.has(f.name)||(s.add(f.name),l.push(f))}):i.push(c.name))}return{inputs:e,outputs:t,usedNodes:r,missingInputs:i,dynamicNode:a,syncInputs:o}}function t6e(e,t,n){var r=n.usedNodes,i=n.inputs,a=[];Object.keys(i).map(function(l){return $o(l)[0]}).map(function(l){return e.nodes[l]}).forEach(function(l){r.has(l.name)&&a.push(l)}),e.weights.forEach(function(l){r.has(l.name)&&a.push(l)});for(var o=new Set,s=[];a.length>0;){var u=a.pop();o.add(u.name),t[u.name]||s.push(u),u.children.forEach(function(l){!o.has(l.name)&&r.has(l.name)&&l.inputs.every(function(c){return o.has(c.name)})&&a.push(l)})}return s}var n6e=["Switch","Merge","Enter","Exit","NextIteration"],r6e=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"];function Vee(e){return n6e.indexOf(e.op)>=0}function i6e(e){return r6e.indexOf(e.op)>=0}var a6e=function(){function e(t){this.graph=t,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._outputs=t.outputs,this._inputs=t.inputs,this._signature=t.signature}return Object.defineProperty(e.prototype,"weightMap",{get:function(){return this._weightMap},set:function(t){var n=Object.keys(t).map(function(r){return t[r].map(function(i){return i.id})});this.weightIds=[].concat.apply([],n),this._weightMap=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputs",{get:function(){return this._inputs.map(function(t){return{name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputs",{get:function(){return this._outputs.map(function(t){return{name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputNodes",{get:function(){return this._inputs.map(function(t){return t.signatureKey||t.name})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputNodes",{get:function(){return this._outputs.map(function(t){return t.signatureKey||t.name})},enumerable:!0,configurable:!0}),e.prototype.getCompilationKey=function(t,n){var r=t.map(function(a){return a.name}).sort(),i=n.map(function(a){return a.name}).sort();return r.join(this.SEPERATOR)+"--"+i.join(this.SEPERATOR)},e.prototype.compile=function(t,n){var r=Wee(t,n,this.weightMap),i=r.missingInputs,a=r.dynamicNode,o=r.syncInputs;if(a!=null)throw new Error("This execution contains the node '"+a.name+"', which has the dynamic op '"+a.op+"'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs ["+o+"]");if(i.length>0){var s=n.map(function(l){return l.name}),u=Object.keys(t);throw new Error("Cannot compute the outputs ["+s+"] from the provided inputs ["+u+"]. Missing the following inputs: ["+i+"]")}return t6e(this.graph,this.weightMap,r)},e.prototype.execute=function(t,n){var r=this;t=this.mapInputs(t);var i=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n);var a=i.map(function(c){return r.graph.nodes[$o(c)[0]]}),o=n.map(function(c){return r.graph.nodes[$o(c)[0]]}),s=this.getCompilationKey(a,o),u=this.compiledMap.get(s);u==null&&(u=this.compile(t,o),this.compiledMap.set(s,u));var l={};return le(function(){var c=new Uee(r._weightMap,l),f=KP({},r.weightMap);Object.keys(t).forEach(function(v){var y=$o(v),b=y[0],x=[];x[y[1]]=t[v],f[b]=x});for(var d=r.getFrozenTensorIds(f),h={},p=0;p<u.length;p++){var g=u[p];if(!f[g.name]){var m=jee(g,f,c);if(m instanceof Promise)throw new Error("The execution of the op '"+g.op+"' returned a promise. Please use model.executeAsync() instead.");f[g.name]=m,r.checkTensorForDisposal(g.name,g,f,c,d,n,h)}}return n.map(function(v){return Ea(v,f,c)})})},e.prototype.getFrozenTensorIds=function(t){var n=[].concat.apply([],Object.keys(t).map(function(r){return t[r]}).map(function(r){return r.map(function(i){return i.id})}));return new Set(n)},e.prototype.checkTensorForDisposal=function(t,n,r,i,a,o,s){n.category!=="control"&&o.indexOf(t)===-1&&(r[t].forEach(function(u){u!=null&&(s[u.id]=(s[u.id]||0)+n.children.length)}),n.inputs.forEach(function(u){if(u.category!=="control"){var l=e5e(u.name,r,i);l!=null&&l.forEach(function(c){if(c&&!a.has(c.id)){var f=s[c.id];f===1?(c.dispose(),delete s[c.id]):f!=null&&s[c.id]--}})}}))},e.prototype.executeAsync=function(t,n){return ep(this,void 0,void 0,function(){var r,i,a,o,s,u,l=this;return tp(this,function(c){switch(c.label){case 0:return t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n),r={},i=new Uee(this._weightMap,r),[4,this.executeWithControlFlow(t,i,n)];case 1:return a=c.sent(),o=n.map(function(f){return Ea(f,a,i)}),s=new Set(o.map(function(f){return f.id})),u=new Set(Object.keys(t).map(function(f){return t[f].id})),Object.keys(a).forEach(function(f){a[f].forEach(function(d){!d||d.isDisposed||s.has(d.id)||u.has(d.id)||l.weightIds.indexOf(d.id)!==-1||d.dispose()})}),[2,o]}})})},e.prototype.executeWithControlFlow=function(t,n,r){return ep(this,void 0,void 0,function(){var i,a,o,s,u,l,c,f,d,h,p,g,m,v,y,b,x=this;return tp(this,function(w){switch(w.label){case 0:i=Object.keys(t),a=i.map(function(S){return x.graph.nodes[$o(S)[0]]}),o=r.map(function(S){return x.graph.nodes[$o(S)[0]]}),s=Wee(t,o,this.weightMap),u=s.usedNodes,l=s.missingInputs,c=s.dynamicNode,f=s.syncInputs,d=a.concat(this.graph.weights).map(function(S){return{node:S,contexts:n.currentContext}}),h=KP({},this.weightMap),Object.keys(t).forEach(function(S){var C=$o(S),_=C[0],E=[];E[C[1]]=t[S],h[_]=E}),p={},g=this.getFrozenTensorIds(h),m={},w.label=1;case 1:return d.length>0?(v=this.processStack(a,d,n,h,m,g,r,p,u),[4,Promise.all(v)]):[3,3];case 2:return w.sent(),[3,1];case 3:if(c==null&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead."),(y=o.filter(function(S){return!Vee(S)&&!Ea(S.name,h,n)}).map(function(S){return S.name})).length>0)throw b="",c!=null&&(b="Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs ["+f+"]"),new Error("Cannot compute the outputs ["+y+"] from the provided inputs ["+i+"]. Consider providing the following inputs: ["+l+"]. "+b);return[2,h]}})})},e.prototype.processStack=function(t,n,r,i,a,o,s,u,l){for(var c=this,f=[],d=function(){var p=n.pop();r.currentContext=p.contexts;var g="";if(p.node.op==="Enter"&&$("isConstant",p.node,i,r)&&(g=tv(p.node.name,r)[0]),t.indexOf(p.node)===-1){var m=jee(p.node,i,r);g||(g=tv(p.node.name,r)[0]);var v=r.currentContext;m instanceof Promise?f.push(m.then(function(y){return i[g]=y,r.currentContext=v,c.checkTensorForDisposal(g,p.node,i,r,o,s,u),c.processChildNodes(p.node,n,r,i,a,l),y})):(i[g]=m,h.checkTensorForDisposal(g,p.node,i,r,o,s,u),h.processChildNodes(p.node,n,r,i,a,l))}else h.processChildNodes(p.node,n,r,i,a,l)},h=this;n.length>0;)d();return f},e.prototype.processChildNodes=function(t,n,r,i,a,o){t.children.forEach(function(s){var u=tv(s.name,r)[0];!a[u]&&o.has(s.name)&&(s.op==="Merge"?s.inputNames.some(function(l){return!!Ea(l,i,r)})&&(a[u]=!0,n.push({contexts:r.currentContext,node:s})):s.inputNames.every(function(l){return!!Ea(l,i,r)})&&(a[u]=!0,n.push({contexts:r.currentContext,node:s})))})},e.prototype.dispose=function(){var t=this;Object.keys(this.weightMap).forEach(function(n){return t.weightMap[n].forEach(function(r){return r.dispose()})})},e.prototype.checkInputShapeAndType=function(t){var n=this;Object.keys(t).forEach(function(r){var i=t[r],a=$o(r)[0],o=n.graph.nodes[a];if(o.attrParams.shape&&o.attrParams.shape.value){var s=o.attrParams.shape.value,u=s.length===i.shape.length&&i.shape.every(function(l,c){return s[c]===-1||s[c]===l});pt.assert(u,function(){return"The shape of dict['"+o.name+"'] provided in model.execute(dict) must be ["+s+"], but was ["+i.shape+"]"})}o.attrParams.dtype&&o.attrParams.dtype.value&&pt.assert(i.dtype===o.attrParams.dtype.value,function(){return"The dtype of dict['"+o.name+"'] provided in model.execute(dict) must be "+o.attrParams.dtype.value+", but was "+i.dtype})})},e.prototype.mapInputs=function(t){var n={};for(var r in t)this._signature!=null&&this._signature.inputs!=null&&this._signature.inputs[r]!=null?n[this._signature.inputs[r].name]=t[r]:n[r]=t[r];return n},e.prototype.checkInputs=function(t){var n=this,r=Object.keys(t).filter(function(i){var a=$o(i)[0];return n.graph.nodes[a]==null});if(r.length>0)throw new Error("The dict provided in model.execute(dict) has keys: ["+r+"] that are not part of graph")},e.prototype.mapOutputs=function(t){var n=this;return t.map(function(r){return n._signature!=null&&n._signature.outputs!=null&&n._signature.outputs[r]!=null?n._signature.outputs[r].name:r},{})},e.prototype.checkOutputs=function(t){var n=this;t.forEach(function(r){var i=$o(r)[0];if(!n.graph.nodes[i])throw new Error("The output '"+r+"' is not found in the graph")})},e}();(function(){function e(t,n){n===void 0&&(n={}),this.modelUrl=t,this.loadOptions=n,this.version="n/a",n==null&&(this.loadOptions={})}return Object.defineProperty(e.prototype,"modelVersion",{get:function(){return this.version},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputNodes",{get:function(){return this.executor.inputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputNodes",{get:function(){return this.executor.outputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputs",{get:function(){return this.executor.inputs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputs",{get:function(){return this.executor.outputs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"weights",{get:function(){return this.executor.weightMap},enumerable:!0,configurable:!0}),e.prototype.findIOHandler=function(){var t=this.modelUrl;if(t.load!=null)this.handler=t;else if(this.loadOptions.requestInit!=null)this.handler=wa.browserHTTPRequest(t,this.loadOptions);else{var n=wa.getLoadHandlers(t,this.loadOptions.onProgress);if(n.length===0)n.push(wa.browserHTTPRequest(t,this.loadOptions));else if(n.length>1)throw new Error("Found more than one ("+n.length+") load handlers for URL '"+[t]+"'");this.handler=n[0]}},e.prototype.load=function(){return ep(this,void 0,void 0,function(){var t,n,r,i;return tp(this,function(a){switch(a.label){case 0:if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return t=this,[4,this.handler.load()];case 1:return t.artifacts=a.sent(),n=this.artifacts.modelTopology,r={},this.artifacts.userDefinedMetadata!=null&&(r=this.artifacts.userDefinedMetadata.signature),this.version=n.versions.producer+"."+n.versions.minConsumer,i=wa.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs),this.executor=new a6e(R5e.Instance.transformGraph(n,r)),this.executor.weightMap=this.convertTensorMapToTensorsMap(i),[2,!0]}})})},e.prototype.save=function(t,n){return ep(this,void 0,void 0,function(){var r;return tp(this,function(i){if(typeof t=="string"){if((r=wa.getSaveHandlers(t)).length===0)throw new Error("Cannot find any save handlers for URL '"+t+"'");if(r.length>1)throw new Error("Found more than one ("+r.length+") save handlers for URL '"+t+"'");t=r[0]}if(t.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return[2,t.save(this.artifacts)]})})},e.prototype.predict=function(t,n){return this.execute(t,this.outputNodes)},e.prototype.normalizeInputs=function(t){if(!(t instanceof Ht||Array.isArray(t)))return t;if((t=Array.isArray(t)?t:[t]).length!==this.inputNodes.length)throw new Error("Input tensor count mismatch,the graph model has "+this.inputNodes.length+" placeholders, while there are "+t.length+" input tensors.");return this.inputNodes.reduce(function(n,r,i){return n[r]=t[i],n},{})},e.prototype.normalizeOutputs=function(t){return t=t||this.outputNodes,Array.isArray(t)?t:[t]},e.prototype.execute=function(t,n){t=this.normalizeInputs(t),n=this.normalizeOutputs(n);var r=this.executor.execute(t,n);return r.length>1?r:r[0]},e.prototype.executeAsync=function(t,n){return ep(this,void 0,void 0,function(){var r;return tp(this,function(i){switch(i.label){case 0:return t=this.normalizeInputs(t),n=this.normalizeOutputs(n),[4,this.executor.executeAsync(t,n)];case 1:return[2,(r=i.sent()).length>1?r:r[0]]}})})},e.prototype.convertTensorMapToTensorsMap=function(t){return Object.keys(t).reduce(function(n,r){return n[r]=[t[r]],n},{})},e.prototype.dispose=function(){this.executor.dispose()},e})();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var qee=function(e,t){return(qee=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])})(e,t)};function On(e,t){function n(){this.constructor=e}qee(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function He(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})}function Ge(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(u){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){o=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(c[0]===6&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(f){c=[6,f],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}function np(e,t){return e(t={exports:{}},t.exports),t.exports}var o6e=np(function(e){(function(t,n,r){function i(o,s){return s.c=o.c,s.s0=o.s0,s.s1=o.s1,s.s2=o.s2,s}function a(o,s){var u=new function(f){var d,h=this,p=(d=4022871197,function(g){g=g.toString();for(var m=0;m<g.length;m++){var v=.02519603282416938*(d+=g.charCodeAt(m));v-=d=v>>>0,d=(v*=d)>>>0,d+=4294967296*(v-=d)}return 23283064365386963e-26*(d>>>0)});h.next=function(){var g=2091639*h.s0+23283064365386963e-26*h.c;return h.s0=h.s1,h.s1=h.s2,h.s2=g-(h.c=0|g)},h.c=1,h.s0=p(" "),h.s1=p(" "),h.s2=p(" "),h.s0-=p(f),h.s0<0&&(h.s0+=1),h.s1-=p(f),h.s1<0&&(h.s1+=1),h.s2-=p(f),h.s2<0&&(h.s2+=1),p=null}(o),l=s&&s.state,c=u.next;return c.int32=function(){return 4294967296*u.next()|0},c.double=function(){return c()+11102230246251565e-32*(2097152*c()|0)},c.quick=c,l&&(typeof l=="object"&&i(l,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.alea=a})(0,e,!1)}),s6e=np(function(e){(function(t,n,r){function i(o,s){return s.x=o.x,s.y=o.y,s.z=o.z,s.w=o.w,s}function a(o,s){var u=new function(f){var d=this,h="";d.x=0,d.y=0,d.z=0,d.w=0,d.next=function(){var g=d.x^d.x<<11;return d.x=d.y,d.y=d.z,d.z=d.w,d.w^=d.w>>>19^g^g>>>8},f===(0|f)?d.x=f:h+=f;for(var p=0;p<h.length+64;p++)d.x^=0|h.charCodeAt(p),d.next()}(o),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/(1<<21);while(f===0);return f},c.int32=u.next,c.quick=c,l&&(typeof l=="object"&&i(l,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xor128=a})(0,e,!1)}),u6e=np(function(e){(function(t,n,r){function i(o,s){return s.x=o.x,s.y=o.y,s.z=o.z,s.w=o.w,s.v=o.v,s.d=o.d,s}function a(o,s){var u=new function(f){var d=this,h="";d.next=function(){var g=d.x^d.x>>>2;return d.x=d.y,d.y=d.z,d.z=d.w,d.w=d.v,(d.d=d.d+362437|0)+(d.v=d.v^d.v<<4^g^g<<1)|0},d.x=0,d.y=0,d.z=0,d.w=0,d.v=0,f===(0|f)?d.x=f:h+=f;for(var p=0;p<h.length+64;p++)d.x^=0|h.charCodeAt(p),p==h.length&&(d.d=d.x<<10^d.x>>>4),d.next()}(o),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/(1<<21);while(f===0);return f},c.int32=u.next,c.quick=c,l&&(typeof l=="object"&&i(l,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xorwow=a})(0,e,!1)}),l6e=np(function(e){(function(t,n,r){function i(o,s){return s.x=o.x.slice(),s.i=o.i,s}function a(o,s){o==null&&(o=+new Date);var u=new function(f){var d=this;d.next=function(){var h,p,g=d.x,m=d.i;return h=g[m],p=(h^=h>>>7)^h<<24,p^=(h=g[m+1&7])^h>>>10,p^=(h=g[m+3&7])^h>>>3,p^=(h=g[m+4&7])^h<<7,h=g[m+7&7],p^=(h^=h<<13)^h<<9,g[m]=p,d.i=m+1&7,p},function(h,p){var g,m=[];if(p===(0|p))m[0]=p;else for(p=""+p,g=0;g<p.length;++g)m[7&g]=m[7&g]<<15^p.charCodeAt(g)+m[g+1&7]<<13;for(;m.length<8;)m.push(0);for(g=0;g<8&&m[g]===0;++g);for(g==8?m[7]=-1:m[g],h.x=m,h.i=0,g=256;g>0;--g)h.next()}(d,f)}(o),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/(1<<21);while(f===0);return f},c.int32=u.next,c.quick=c,l&&(l.x&&i(l,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xorshift7=a})(0,e,!1)}),c6e=np(function(e){(function(t,n,r){function i(o,s){return s.i=o.i,s.w=o.w,s.X=o.X.slice(),s}function a(o,s){o==null&&(o=+new Date);var u=new function(f){var d=this;d.next=function(){var h,p,g=d.w,m=d.X,v=d.i;return d.w=g=g+1640531527|0,p=m[v+34&127],h=m[v=v+1&127],p^=p<<13,h^=h<<17,p^=p>>>15,h^=h>>>12,p=m[v]=p^h,d.i=v,p+(g^g>>>16)|0},function(h,p){var g,m,v,y,b,x=[],w=128;for(p===(0|p)?(m=p,p=null):(p+="\0",m=0,w=Math.max(w,p.length)),v=0,y=-32;y<w;++y)p&&(m^=p.charCodeAt((y+32)%p.length)),y===0&&(b=m),m^=m<<10,m^=m>>>15,m^=m<<4,m^=m>>>13,y>=0&&(b=b+1640531527|0,v=(g=x[127&y]^=m+b)==0?v+1:0);for(v>=128&&(x[127&(p&&p.length||0)]=-1),v=127,y=512;y>0;--y)m=x[v+34&127],g=x[v=v+1&127],m^=m<<13,g^=g<<17,m^=m>>>15,g^=g>>>12,x[v]=m^g;h.w=b,h.X=x,h.i=v}(d,f)}(o),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/(1<<21);while(f===0);return f},c.int32=u.next,c.quick=c,l&&(l.X&&i(l,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.xor4096=a})(0,e,!1)}),f6e=np(function(e){(function(t,n,r){function i(o,s){return s.a=o.a,s.b=o.b,s.c=o.c,s.d=o.d,s}function a(o,s){var u=new function(f){var d=this,h="";d.next=function(){var g=d.b,m=d.c,v=d.d,y=d.a;return g=g<<25^g>>>7^m,m=m-v|0,v=v<<24^v>>>8^y,y=y-g|0,d.b=g=g<<20^g>>>12^m,d.c=m=m-v|0,d.d=v<<16^m>>>16^y,d.a=y-g|0},d.a=0,d.b=0,d.c=-1640531527,d.d=1367130551,f===Math.floor(f)?(d.a=f/4294967296|0,d.b=0|f):h+=f;for(var p=0;p<h.length+20;p++)d.b^=0|h.charCodeAt(p),d.next()}(o),l=s&&s.state,c=function(){return(u.next()>>>0)/4294967296};return c.double=function(){do var f=((u.next()>>>11)+(u.next()>>>0)/4294967296)/(1<<21);while(f===0);return f},c.int32=u.next,c.quick=c,l&&(typeof l=="object"&&i(l,u),c.state=function(){return i(u,{})}),c}n&&n.exports?n.exports=a:r&&r.amd?r(function(){return a}):this.tychei=a})(0,e,!1)}),rp=np(function(e){(function(t,n){var r,i=this,a=256,o=6,s="random",u=n.pow(a,o),l=n.pow(2,52),c=2*l,f=a-1;function d(m,v,y){var b=[],x=p(function C(_,E){var A,k=[],T=typeof _;if(E&&T=="object")for(A in _)try{k.push(C(_[A],E-1))}catch(I){}return k.length?k:T=="string"?_:_+"\0"}((v=v==1?{entropy:!0}:v||{}).entropy?[m,g(t)]:m??function(){try{var C;return r&&(C=r.randomBytes)?C=C(a):(C=new Uint8Array(a),(i.crypto||i.msCrypto).getRandomValues(C)),g(C)}catch(A){var _=i.navigator,E=_&&_.plugins;return[+new Date,i,E,i.screen,g(t)]}}(),3),b),w=new function(C){var _,E=C.length,A=this,k=0,T=A.i=A.j=0,I=A.S=[];for(E||(C=[E++]);k<a;)I[k]=k++;for(k=0;k<a;k++)I[k]=I[T=f&T+C[k%E]+(_=I[k])],I[T]=_;(A.g=function(N){for(var O,D=0,L=A.i,W=A.j,G=A.S;N--;)O=G[L=f&L+1],D=D*a+G[f&(G[L]=G[W=f&W+O])+(G[W]=O)];return A.i=L,A.j=W,D})(a)}(b),S=function(){for(var C=w.g(o),_=u,E=0;C<l;)C=(C+E)*a,_*=a,E=w.g(1);for(;C>=c;)C/=2,_/=2,E>>>=1;return(C+E)/_};return S.int32=function(){return 0|w.g(4)},S.quick=function(){return w.g(4)/4294967296},S.double=S,p(g(w.S),t),(v.pass||y||function(C,_,E,A){return A&&(A.S&&h(A,w),C.state=function(){return h(w,{})}),E?(n[s]=C,_):C})(S,x,"global"in v?v.global:this==n,v.state)}function h(m,v){return v.i=m.i,v.j=m.j,v.S=m.S.slice(),v}function p(m,v){for(var y,b=m+"",x=0;x<b.length;)v[f&x]=f&(y^=19*v[f&x])+b.charCodeAt(x++);return g(v)}function g(m){return String.fromCharCode.apply(0,m)}if(n["seed"+s]=d,p(n.random(),t),e.exports){e.exports=d;try{r=require("crypto")}catch(m){}}})([],Math)});rp.alea=o6e,rp.xor128=s6e,rp.xorwow=u6e,rp.xorshift7=l6e,rp.xor4096=c6e,rp.tychei=f6e;var d6e=rp,Hee=d6e.alea;function h6e(e,t){return JE(e,t)}function JE(e,t,n,r){if(n===void 0&&(n=new Map),r===void 0&&(r=new Set),e==null)return null;if(r.has(e))throw new Error("Circular references are not supported.");if(n.has(e))return n.get(e);var i=t(e);if(i.recurse&&i.value!==null)throw new Error("A deep map function may not return both a value and recurse=true.");if(i.recurse){if(QE(e)){var a=Array.isArray(e)?[]:{};for(var o in r.add(e),e){var s=JE(e[o],t,n,r);a[o]=s}return r.delete(e),a}throw new Error("Can't recurse into non-iterable type: "+e)}return n.set(e,i.value),i.value}function p6e(e,t){return t===void 0&&(t=Kee),Gee(e,t)}function Gee(e,t,n){n===void 0&&(n=new Set);var r=e[0];if(n.has(r))throw new Error("Circular references are not supported.");var i=t(e);if(i.recurse&&i.value!==null)throw new Error("A deep zip function may not return both a value and recurse=true.");if(i.recurse){if(QE(r)){var a=Array.isArray(r)?[]:{};n.add(r);var o=function(u){var l=Gee(e.map(function(c){return c[u]}),t,n);a[u]=l};for(var s in r)o(s);return n.delete(r),a}throw new Error("Can't recurse into non-iterable type: "+r)}return i.value}function Kee(e){return e===null?null:QE(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}function g6e(e,t){return He(this,void 0,void 0,function(){var n,r,i,a,o,s;return Ge(this,function(u){switch(u.label){case 0:n=new Map,JE(e,t,n),r=0,i=Array.from(n.keys()),u.label=1;case 1:return r<i.length?(a=i[r],(o=n.get(a))instanceof Promise?[4,o]:[3,3]):[3,4];case 2:s=u.sent(),n.set(a,s),u.label=3;case 3:return r++,[3,1];case 4:return[2,JE(e,t,n)]}})})}function QE(e){return e!=null&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||typeof e=="object"&&!(e instanceof Ht))}function m6e(e){return e==null||v6e(e)||Array.isArray(e)||typeof e=="object"&&e instanceof Ht||pt.isTypedArray(e)}function v6e(e){return e===null||typeof e!="object"&&typeof e!="function"}function y6e(e){return h6e(e,b6e)}function b6e(e){return e instanceof Ht?{value:e.clone(),recurse:!1}:QE(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}var Xee=function(){function e(t){if(this.capacity=t,this.begin=0,this.end=0,t==null)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}return e.prototype.wrap=function(t){for(;t<0;)t+=this.doubledCapacity;return t%this.doubledCapacity},e.prototype.get=function(t){if(t<0)throw new RangeError("Can't get item at a negative index.");return this.data[t%this.capacity]},e.prototype.set=function(t,n){if(t<0)throw new RangeError("Can't set item at a negative index.");this.data[t%this.capacity]=n},e.prototype.length=function(){var t=this.end-this.begin;return t<0&&(t=this.doubledCapacity+t),t},e.prototype.isFull=function(){return this.length()===this.capacity},e.prototype.isEmpty=function(){return this.length()===0},e.prototype.push=function(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,t),this.end=this.wrap(this.end+1)},e.prototype.pushAll=function(t){for(var n=0,r=t;n<r.length;n++){var i=r[n];this.push(i)}},e.prototype.pop=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);var t=this.get(this.end);return this.set(this.end,void 0),t},e.prototype.unshift=function(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,t)},e.prototype.shift=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var t=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),t},e.prototype.shuffleExcise=function(t){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var n=this.wrap(this.begin+t),r=this.get(n);return this.set(n,this.pop()),r},e}(),x6e=function(e){function t(){return e.call(this,t.INITIAL_CAPACITY)||this}return On(t,e),t.prototype.isFull=function(){return!1},t.prototype.push=function(n){e.prototype.isFull.call(this)&&this.expand(),e.prototype.push.call(this,n)},t.prototype.unshift=function(n){e.prototype.isFull.call(this)&&this.expand(),e.prototype.unshift.call(this,n)},t.prototype.expand=function(){for(var n=2*this.capacity,r=new Array(n),i=this.length(),a=0;a<i;a++)r[a]=this.get(this.wrap(this.begin+a));this.data=r,this.capacity=n,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=i},t.INITIAL_CAPACITY=32,t}(Xee);function w6e(e){return new E6e(e)}function _6e(e){return new C6e(e)}function S6e(e,t){return new Zee(e,t)}var nv,ii=function(){function e(){}return e.prototype.toArray=function(){return He(this,void 0,void 0,function(){var t,n;return Ge(this,function(r){switch(r.label){case 0:return t=[],[4,this.next()];case 1:n=r.sent(),r.label=2;case 2:return n.done?[3,4]:(t.push(n.value),[4,this.next()]);case 3:return n=r.sent(),[3,2];case 4:return[2,t]}})})},e.prototype.toArrayForTest=function(){return He(this,void 0,void 0,function(){var t,n,r;return Ge(this,function(i){switch(i.label){case 0:return t=this.prefetch(100),n=[],[4,t.next()];case 1:r=i.sent(),i.label=2;case 2:return r.done?[3,4]:(n.push(r.value),[4,t.next()]);case 3:return r=i.sent(),[3,2];case 4:return[2,n]}})})},e.prototype.resolveFully=function(){return He(this,void 0,void 0,function(){var t;return Ge(this,function(n){switch(n.label){case 0:return[4,this.next()];case 1:t=n.sent(),n.label=2;case 2:return t.done?[3,4]:[4,this.next()];case 3:return t=n.sent(),[3,2];case 4:return[2]}})})},e.prototype.resolveWhile=function(t){return He(this,void 0,void 0,function(){var n,r;return Ge(this,function(i){switch(i.label){case 0:return[4,this.next()];case 1:n=i.sent(),r=t(n.value),i.label=2;case 2:return n.done||!r?[3,4]:[4,this.next()];case 3:return n=i.sent(),r=t(n.value),[3,2];case 4:return[2]}})})},e.prototype.handleErrors=function(t){return new D6e(this,t)},e.prototype.filter=function(t){return new I6e(this,t)},e.prototype.map=function(t){return new N6e(this,t)},e.prototype.mapAsync=function(t){return new Yee(this,t)},e.prototype.serialMapAsync=function(t){return new Yee(this,t).serial()},e.prototype.flatmap=function(t){return new R6e(this,t)},e.prototype.forEachAsync=function(t){return He(this,void 0,void 0,function(){return Ge(this,function(n){return[2,this.map(t).resolveFully()]})})},e.prototype.serialForEach=function(t){return He(this,void 0,void 0,function(){return Ge(this,function(n){return[2,this.serialMapAsync(t).resolveWhile(function(r){return r===!0})]})})},e.prototype.rowMajorBatch=function(t,n){return n===void 0&&(n=!0),new O6e(this,t,n)},e.prototype.columnMajorBatch=function(t,n,r){return n===void 0&&(n=!0),r===void 0&&(r=Kee),this.rowMajorBatch(t,n).map(function(i){return p6e(i,r)})},e.prototype.concatenate=function(t,n){return new Zee(w6e([this,t]),n)},e.prototype.take=function(t){return t<0||t==null?this:new T6e(this,t)},e.prototype.skip=function(t){return t<0||t==null?this:new k6e(this,t)},e.prototype.prefetch=function(t){return new Jee(this,t)},e.prototype.shuffle=function(t,n){return new F6e(this,t,n)},e.prototype.serial=function(){return new A6e(this)},e}(),E6e=function(e){function t(n){var r=e.call(this)||this;return r.items=n,r.trav=0,r}return On(t,e),t.prototype.summary=function(){return"Array of "+this.items.length+" items"},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n;return Ge(this,function(r){return this.trav>=this.items.length?[2,{value:null,done:!0}]:(n=this.items[this.trav],this.trav++,[2,{value:y6e(n),done:!1}])})})},t}(ii),C6e=function(e){function t(n){var r=e.call(this)||this;return r.nextFn=n,r}return On(t,e),t.prototype.summary=function(){return"Function call"},t.prototype.next=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){try{return[2,this.nextFn()]}catch(r){throw r.message="Error thrown while iterating through a dataset: "+r.message,r}return[2]})})},t}(ii),A6e=function(e){function t(n){var r=e.call(this)||this;return r.upstream=n,r.lastRead=Promise.resolve({value:null,done:!1}),r}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Serial"},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n=this;return Ge(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){return[2,this.upstream.next()]})})},t}(ii),k6e=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.maxCount=r,i.count=0,i.lastRead=Promise.resolve({value:null,done:!1}),i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Skip"},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n=this;return Ge(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return He(this,void 0,void 0,function(){var n;return Ge(this,function(r){switch(r.label){case 0:return this.count++<this.maxCount?[4,this.upstream.next()]:[3,2];case 1:return(n=r.sent()).done?[2,n]:(Ut(n.value),[3,0]);case 2:return[2,this.upstream.next()]}})})},t}(ii),T6e=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.maxCount=r,i.count=0,i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Take"},t.prototype.next=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){return this.count++>=this.maxCount?[2,{value:null,done:!0}]:[2,this.upstream.next()]})})},t}(ii),O6e=function(e){function t(n,r,i){i===void 0&&(i=!0);var a=e.call(this)||this;return a.upstream=n,a.batchSize=r,a.enableSmallLastBatch=i,a.lastRead=Promise.resolve({value:null,done:!1}),a}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> RowMajorBatch"},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n=this;return Ge(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return He(this,void 0,void 0,function(){var n,r;return Ge(this,function(i){switch(i.label){case 0:n=[],i.label=1;case 1:return n.length<this.batchSize?[4,this.upstream.next()]:[3,3];case 2:return(r=i.sent()).done?this.enableSmallLastBatch&&n.length>0?[2,{value:n,done:!1}]:[2,{value:null,done:!0}]:(n.push(r.value),[3,1]);case 3:return[2,{value:n,done:!1}]}})})},t}(ii),I6e=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.predicate=r,i.lastRead=Promise.resolve({value:null,done:!1}),i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Filter"},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n=this;return Ge(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return He(this,void 0,void 0,function(){var n;return Ge(this,function(r){switch(r.label){case 0:return[4,this.upstream.next()];case 1:return(n=r.sent()).done||this.predicate(n.value)?[2,n]:(Ut(n.value),[3,0]);case 2:return[2]}})})},t}(ii),N6e=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.transform=r,i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Map"},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n,r,i,a,o,s,u;return Ge(this,function(l){switch(l.label){case 0:return[4,this.upstream.next()];case 1:if((n=l.sent()).done)return[2,{value:null,done:!0}];for(r=Lu.getTensorsInContainer(n.value),i=this.transform(n.value),a=Lu.getTensorsInContainer(i),o=0,s=r;o<s.length;o++)u=s[o],Lu.isTensorInList(u,a)||u.dispose();return[2,{value:i,done:!1}]}})})},t}(ii),D6e=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.handler=r,i.count=0,i.lastRead=Promise.resolve({value:null,done:!1}),i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> handleErrors"},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n=this;return Ge(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return He(this,void 0,void 0,function(){var n;return Ge(this,function(r){switch(r.label){case 0:r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.upstream.next()];case 2:return[2,r.sent()];case 3:return n=r.sent(),this.handler(n)?[3,4]:[2,{value:null,done:!0}];case 4:return[3,0];case 5:return[2]}})})},t}(ii),Yee=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.transform=r,i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> AsyncMap"},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n,r,i,a,o,s,u;return Ge(this,function(l){switch(l.label){case 0:return[4,this.upstream.next()];case 1:return(n=l.sent()).done?[2,{value:null,done:!0}]:(r=Lu.getTensorsInContainer(n.value),[4,this.transform(n.value)]);case 2:for(i=l.sent(),a=Lu.getTensorsInContainer(i),o=0,s=r;o<s.length;o++)u=s[o],Lu.isTensorInList(u,a)||u.dispose();return[2,{value:i,done:!1}]}})})},t}(ii),o$=function(e){function t(){var n=e.call(this)||this;return n.outputQueue=new x6e,n.lastRead=Promise.resolve({value:null,done:!1}),n}return On(t,e),t.prototype.next=function(){return He(this,void 0,void 0,function(){var n=this;return Ge(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.serialNext=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){switch(n.label){case 0:return this.outputQueue.length()!==0?[3,2]:[4,this.pump()];case 1:return n.sent()?[3,0]:[2,{value:null,done:!0}];case 2:return[2,{value:this.outputQueue.shift(),done:!1}]}})})},t}(ii),R6e=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.transform=r,i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Flatmap"},t.prototype.pump=function(){return He(this,void 0,void 0,function(){var n,r,i,a,o,s,u;return Ge(this,function(l){switch(l.label){case 0:return[4,this.upstream.next()];case 1:if((n=l.sent()).done)return[2,!1];for(r=Lu.getTensorsInContainer(n.value),i=this.transform(n.value),a=Lu.getTensorsInContainer(i),this.outputQueue.pushAll(i),o=0,s=r;o<s.length;o++)u=s[o],Lu.isTensorInList(u,a)||u.dispose();return[2,!0]}})})},t}(o$),Zee=function(e){function t(n,r){var i=e.call(this)||this;return i.baseErrorHandler=r,i.lastRead=null,i.iterator=null,i.moreIterators=n,i}return On(t,e),t.prototype.summary=function(){return"TODO: fill in upstream of chained summaries -> Chained"},t.prototype.next=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){return this.lastRead=this.readFromChain(this.lastRead),[2,this.lastRead]})})},t.prototype.readFromChain=function(n){return He(this,void 0,void 0,function(){var r,i;return Ge(this,function(a){switch(a.label){case 0:return[4,n];case 1:return a.sent(),this.iterator!=null?[3,3]:[4,this.moreIterators.next()];case 2:if((r=a.sent()).done)return[2,{value:null,done:!0}];this.iterator=r.value,this.baseErrorHandler!=null&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler)),a.label=3;case 3:return[4,this.iterator.next()];case 4:return(i=a.sent()).done?(this.iterator=null,[2,this.readFromChain(n)]):[2,i]}})})},t}(ii);(function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"})(nv||(nv={})),function(e){function t(n,r){r===void 0&&(r=nv.FAIL);var i=e.call(this)||this;return i.iterators=n,i.mismatchMode=r,i.count=0,i.currentPromise=null,i}return On(t,e),t.prototype.summary=function(){return"{TODO: fill in upstream of zip summaries} -> Zip"},t.prototype.nextState=function(n){return He(this,void 0,void 0,function(){function r(s){return s instanceof ii?{value:s.next().then(function(u){return i++,u.done&&a++,u.value}),recurse:!1}:{value:null,recurse:!0}}var i,a,o;return Ge(this,function(s){switch(s.label){case 0:return[4,n];case 1:return s.sent(),i=0,a=0,[4,g6e(this.iterators,r)];case 2:if(o=s.sent(),i===a)return[2,{value:null,done:!0}];if(a>0)switch(this.mismatchMode){case nv.FAIL:throw new Error("Zipped streams should have the same length. Mismatched at element "+this.count+".");case nv.SHORTEST:return[2,{value:null,done:!0}];case nv.LONGEST:}return this.count++,[2,{value:o,done:!1}]}})})},t.prototype.next=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){return this.currentPromise=this.nextState(this.currentPromise),[2,this.currentPromise]})})},t}(ii);var Jee=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.bufferSize=r,i.buffer=new Xee(r),i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Prefetch"},t.prototype.refill=function(){for(;!this.buffer.isFull();){var n=this.upstream.next();this.buffer.push(n)}},t.prototype.next=function(){return this.refill(),this.buffer.shift()},t}(ii),F6e=function(e){function t(n,r,i){var a=e.call(this,n,r)||this;return a.upstream=n,a.windowSize=r,a.upstreamExhausted=!1,a.random=Hee(i||pt.now().toString()),a.lastRead=Promise.resolve({value:null,done:!1}),a}return On(t,e),t.prototype.next=function(){return He(this,void 0,void 0,function(){var n=this;return Ge(this,function(r){return this.lastRead=this.lastRead.then(function(){return n.serialNext()}),[2,this.lastRead]})})},t.prototype.randomInt=function(n){return Math.floor(this.random()*n)},t.prototype.chooseIndex=function(){return this.randomInt(this.buffer.length())},t.prototype.serialNext=function(){return He(this,void 0,void 0,function(){var n,r;return Ge(this,function(i){switch(i.label){case 0:this.upstreamExhausted||this.refill(),i.label=1;case 1:return this.buffer.isEmpty()?[3,3]:(n=this.chooseIndex(),[4,this.buffer.shuffleExcise(n)]);case 2:return(r=i.sent()).done?(this.upstreamExhausted=!0,[3,1]):(this.refill(),[2,r]);case 3:return[2,{value:null,done:!0}]}})})},t}(Jee),s$=function(){function e(){this.size=null}return e.prototype.batch=function(t,n){var r=this;n===void 0&&(n=!0);var i=this;return pt.assert(t>0,function(){return`batchSize needs to be positive, but it is
      `+t}),Ju(function(){return He(r,void 0,void 0,function(){return Ge(this,function(a){switch(a.label){case 0:return[4,i.iterator()];case 1:return[2,a.sent().columnMajorBatch(t,n,M6e)]}})})},this.size===1/0||this.size==null?this.size:n?Math.ceil(this.size/t):Math.floor(this.size/t))},e.prototype.concatenate=function(t){var n=this,r=this;return Ju(function(){return He(n,void 0,void 0,function(){var i,a;return Ge(this,function(o){switch(o.label){case 0:return[4,r.iterator()];case 1:return a=(i=o.sent()).concatenate,[4,t.iterator()];case 2:return[2,a.apply(i,[o.sent()])]}})})},this.size===1/0||t.size===1/0?1/0:this.size!=null&&t.size!=null?this.size+t.size:null)},e.prototype.filter=function(t){var n=this,r=this;return Ju(function(){return He(n,void 0,void 0,function(){return Ge(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().filter(function(a){return le(function(){return t(a)})})]}})})},this.size===1/0?1/0:null)},e.prototype.forEachAsync=function(t){return He(this,void 0,void 0,function(){return Ge(this,function(n){switch(n.label){case 0:return[4,this.iterator()];case 1:return[2,n.sent().forEachAsync(t)]}})})},e.prototype.forEach=function(t){return He(this,void 0,void 0,function(){return Ge(this,function(n){return ES("dataset.forEach() is deprecated and will be removed. Please use dataset.forEachAsync() instead"),[2,this.forEachAsync(t)]})})},e.prototype.map=function(t){var n=this,r=this;return Ju(function(){return He(n,void 0,void 0,function(){return Ge(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().map(function(a){return le(function(){return t(a)})})]}})})},this.size)},e.prototype.mapAsync=function(t){var n=this,r=this;return Ju(function(){return He(n,void 0,void 0,function(){return Ge(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().mapAsync(t)]}})})},this.size)},e.prototype.prefetch=function(t){var n=this;if(t==null)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");var r=this;return Ju(function(){return He(n,void 0,void 0,function(){return Ge(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().prefetch(t)]}})})},this.size)},e.prototype.repeat=function(t){var n=this,r=this;return Ju(function(){return He(n,void 0,void 0,function(){var i=this;return Ge(this,function(a){return[2,S6e(_6e(function(){return He(i,void 0,void 0,function(){var o;return Ge(this,function(s){switch(s.label){case 0:return o={},[4,r.iterator()];case 1:return[2,(o.value=s.sent(),o.done=!1,o)]}})})}).take(t))]})})},this.size!=null&&t>0?this.size*t:t===0?0:this.size!=null&&(t===void 0||t<0)?1/0:null)},e.prototype.skip=function(t){var n=this,r=this;return Ju(function(){return He(n,void 0,void 0,function(){return Ge(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().skip(t)]}})})},this.size!=null&&t>=0&&this.size>=t?this.size-t:this.size!=null&&(this.size<t||t===void 0||t<0)?0:null)},e.prototype.shuffle=function(t,n,r){var i=this;if(r===void 0&&(r=!0),t==null||t<0)throw this.size==null?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting bufferSize to the dataset size ("+this.size+" elements)");var a=this,o=Hee(n||pt.now().toString());return Ju(function(){return He(i,void 0,void 0,function(){var s;return Ge(this,function(u){switch(u.label){case 0:return s=o.int32(),r&&(s+=o.int32()),[4,a.iterator()];case 1:return[2,u.sent().shuffle(t,s.toString())]}})})},this.size)},e.prototype.take=function(t){var n=this,r=this;return Ju(function(){return He(n,void 0,void 0,function(){return Ge(this,function(i){switch(i.label){case 0:return[4,r.iterator()];case 1:return[2,i.sent().take(t)]}})})},this.size!=null&&this.size>t?t:this.size!=null&&this.size<=t?this.size:null)},e.prototype.toArray=function(){return He(this,void 0,void 0,function(){return Ge(this,function(t){switch(t.label){case 0:if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,t.sent().toArray()]}})})},e.prototype.toArrayForTest=function(){return He(this,void 0,void 0,function(){return Ge(this,function(t){switch(t.label){case 0:if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,t.sent().toArrayForTest()]}})})},e.MAX_BUFFER_SIZE=1e4,e}();function Ju(e,t){return t===void 0&&(t=null),new(function(n){function r(){var i=n!==null&&n.apply(this,arguments)||this;return i.size=t,i}return On(r,n),r.prototype.iterator=function(){return He(this,void 0,void 0,function(){return Ge(this,function(i){return[2,e()]})})},r}(s$))}function M6e(e){return e===null?null:m6e(e[0])?{value:P6e(e),recurse:!1}:{value:null,recurse:!0}}function P6e(e){if(e.length===0)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof Ht?as(e):Rr(e)}var $6e=function(e){function t(n){var r=e.call(this)||this;return r.input=n,r}return On(t,e),t.prototype.iterator=function(){return He(this,void 0,void 0,function(){var n,r;return Ge(this,function(i){switch(i.label){case 0:return[4,this.input.iterator()];case 1:return n=i.sent(),r=n.decodeUTF8(),[2,r.split(`
`).map(function(a){return a.endsWith("\r")&&(a=a.slice(0,-1)),a})]}})})},t}(s$),eC='"',qb=Symbol("out"),Qee=Symbol("field"),tC=Symbol("quote"),u$=Symbol("quoteafterquote"),ete=Symbol("quoteinquote");(function(e){function t(n,r){var i=e.call(this)||this;return i.input=n,i.hasHeader=!0,i.fullColumnNames=null,i.columnNamesValidated=!1,i.columnConfigs=null,i.configuredColumnsOnly=!1,i.delimiter=",",i.delimWhitespace=!1,i.base=new $6e(n),r||(r={}),i.hasHeader=r.hasHeader!==!1,i.fullColumnNames=r.columnNames,i.columnConfigs=r.columnConfigs,i.configuredColumnsOnly=r.configuredColumnsOnly,r.delimWhitespace?(pt.assert(r.delimiter==null,function(){return"Delimiter should not be provided when delimWhitespace is true."}),i.delimWhitespace=!0,i.delimiter=" "):i.delimiter=r.delimiter?r.delimiter:",",i}return On(t,e),t.prototype.columnNames=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){switch(n.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:n.sent(),n.label=2;case 2:return[2,this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames]}})})},t.prototype.setColumnNames=function(){return He(this,void 0,void 0,function(){var n,r,i,a,o,s,u=this;return Ge(this,function(l){switch(l.label){case 0:return[4,this.maybeReadHeaderLine()];case 1:if(n=l.sent(),!this.fullColumnNames&&!n)throw new Error("Column names must be provided if there is no header line.");if(this.fullColumnNames&&n&&pt.assert(n.length===this.fullColumnNames.length,function(){return"The length of provided columnNames ("+u.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+n.length.toString()+")."}),this.fullColumnNames||(this.fullColumnNames=n),r=this.fullColumnNames.reduce(function(c,f){return c[f]=c[f]+1||1,c},{}),i=Object.keys(r).filter(function(c){return r[c]>1}),pt.assert(i.length===0,function(){return"Duplicate column names found: "+i.toString()}),this.columnConfigs){for(a=0,o=Object.keys(this.columnConfigs);a<o.length;a++)if(s=o[a],this.fullColumnNames.indexOf(s)===-1)throw new Error('The key "'+s+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").")}return this.columnNamesValidated=!0,[2]}})})},t.prototype.maybeReadHeaderLine=function(){return He(this,void 0,void 0,function(){var n,r;return Ge(this,function(i){switch(i.label){case 0:return this.hasHeader?[4,this.base.iterator()]:[3,3];case 1:return[4,i.sent().next()];case 2:if((n=i.sent()).done)throw new Error("No data was found for CSV parsing.");return r=n.value,[2,this.parseRow(r,!1)];case 3:return[2,null]}})})},t.prototype.iterator=function(){return He(this,void 0,void 0,function(){var n,r=this;return Ge(this,function(i){switch(i.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:i.sent(),i.label=2;case 2:return[4,this.base.iterator()];case 3:return n=i.sent(),this.hasHeader&&(n=n.skip(1)),[2,n.map(function(a){return r.makeDataElement(a)})]}})})},t.prototype.makeDataElement=function(n){for(var r=this.parseRow(n),i={},a={},o=0;o<this.fullColumnNames.length;o++){var s=this.fullColumnNames[o],u=this.columnConfigs?this.columnConfigs[s]:null;if(!this.configuredColumnsOnly||u){var l=r[o],c=null;if(l==="")if(u&&u.default!==void 0)c=u.default;else{if(u&&(u.required||u.isLabel))throw new Error("Required column "+s+" is empty in this line: "+n);c=void 0}else{var f=Number(l);if(isNaN(f))c=u&&u.dtype==="bool"?this.getBoolean(l):l;else if(u&&u.dtype)switch(u.dtype){case"float32":c=f;break;case"int32":c=Math.floor(f);break;case"bool":c=this.getBoolean(l);break;default:c=f}else c=f}u&&u.isLabel?a[s]=c:i[s]=c}}return Object.keys(a).length===0?i:{xs:i,ys:a}},t.prototype.getBoolean=function(n){return n==="1"||n.toLowerCase()==="true"?1:0},t.prototype.parseRow=function(n,r){r===void 0&&(r=!0);for(var i=[],a=0,o=n.length,s=qb,u=0;u<o;u++)switch(s){case qb:switch(n.charAt(u)){case eC:a=u+1,s=tC;break;case this.delimiter:if(a=u+1,this.delimiter===" "&&this.delimWhitespace)break;i.push(""),s=qb;break;default:s=Qee,a=u}break;case Qee:switch(n.charAt(u)){case this.delimiter:i.push(n.substring(a,u)),s=qb,a=u+1}break;case tC:switch(n.charAt(u)){case eC:s=u$}break;case u$:switch(n.charAt(u)){case this.delimiter:i.push(n.substring(a,u-1)),s=qb,a=u+1;break;case eC:s=tC;break;default:s=ete}break;case ete:switch(n.charAt(u)){case eC:s=tC}}if(s===u$?i.push(n.substring(a,o-1)):i.push(n.substring(a)),r&&i.length!==this.fullColumnNames.length)throw new Error("Invalid row in csv file. Should have "+this.fullColumnNames.length+" elements in a row, but got "+i);return i},t})(s$),function(e){function t(n){var r=e.call(this)||this;r.microphoneConfig=n,r.isClosed=!1,r.fftSize=n.fftSize||1024;var i=Math.log2(r.fftSize);if(r.fftSize<0||i<4||i>14||!Number.isInteger(i))throw new Error("Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got "+r.fftSize);if(r.numFrames=n.numFramesPerSpectrogram||43,r.sampleRateHz=n.sampleRateHz,r.columnTruncateLength=n.columnTruncateLength||r.fftSize,r.audioTrackConstraints=n.audioTrackConstraints,r.smoothingTimeConstant=n.smoothingTimeConstant||0,r.includeSpectrogram=n.includeSpectrogram!==!1,r.includeWaveform=n.includeWaveform===!0,!r.includeSpectrogram&&!r.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.");return r}return On(t,e),t.prototype.summary=function(){return"microphone"},t.create=function(n){return n===void 0&&(n={}),He(this,void 0,void 0,function(){var r;return Ge(this,function(i){switch(i.label){case 0:if(pe().get("IS_NODE"))throw new Error("microphone API is only supported in browser environment.");return[4,(r=new t(n)).start()];case 1:return i.sent(),[2,r]}})})},t.prototype.start=function(){return He(this,void 0,void 0,function(){var n,r,i,a;return Ge(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),n=this,[4,navigator.mediaDevices.getUserMedia({audio:this.audioTrackConstraints==null||this.audioTrackConstraints,video:!1})];case 1:return n.stream=o.sent(),[3,3];case 2:throw r=o.sent(),new Error("Error thrown while initializing video stream: "+r.message);case 3:if(!this.stream)throw new Error("Could not obtain audio from microphone.");if(i=window.AudioContext||window.webkitAudioContext,this.audioContext=new i,this.sampleRateHz){if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error("Mismatch in sampling rate: Expected: "+this.sampleRateHz+"; Actual: "+this.audioContext.sampleRate)}else this.sampleRateHz=this.audioContext.sampleRate;return a=this.audioContext.createMediaStreamSource(this.stream),this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2*this.fftSize,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,a.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize),[2]}})})},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n,r,i,a,o;return Ge(this,function(s){switch(s.label){case 0:return this.isClosed?[2,{value:null,done:!0}]:[4,this.getAudioData()];case 1:return i=s.sent(),this.includeSpectrogram&&(a=this.flattenQueue(i.freqDataQueue),n=this.getTensorFromAudioDataArray(a,[this.numFrames,this.columnTruncateLength,1])),this.includeWaveform&&(o=this.flattenQueue(i.timeDataQueue),r=this.getTensorFromAudioDataArray(o,[this.numFrames*this.fftSize,1])),[2,{value:{spectrogram:n,waveform:r},done:!1}]}})})},t.prototype.capture=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){switch(n.label){case 0:return[4,this.next()];case 1:return[2,n.sent().value]}})})},t.prototype.getAudioData=function(){return He(this,void 0,void 0,function(){var n,r,i,a=this;return Ge(this,function(o){return n=[],r=[],i=0,[2,new Promise(function(s){var u=setInterval(function(){a.includeSpectrogram&&(a.analyser.getFloatFrequencyData(a.freqData),a.freqData[0]===-1/0&&s({freqDataQueue:n,timeDataQueue:r}),n.push(a.freqData.slice(0,a.columnTruncateLength))),a.includeWaveform&&(a.analyser.getFloatTimeDomainData(a.timeData),r.push(a.timeData.slice())),++i===a.numFrames&&(clearInterval(u),s({freqDataQueue:n,timeDataQueue:r}))},a.fftSize/a.sampleRateHz*1e3)})]})})},t.prototype.stop=function(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),this.stream!=null&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())},t.prototype.toArray=function(){throw new Error("Can not convert infinite audio stream to array.")},t.prototype.getSampleRate=function(){return this.sampleRateHz},t.prototype.flattenQueue=function(n){var r=n[0].length,i=new Float32Array(n.length*r);return n.forEach(function(a,o){return i.set(a,o*r)}),i},t.prototype.getTensorFromAudioDataArray=function(n,r){var i=new Float32Array(pt.sizeFromShape(r));return i.set(n,i.length-n.length),Rr(i,r)},t}(ii),function(e){function t(n,r){var i=e.call(this)||this;if(i.webcamVideoElement=n,i.webcamConfig=r,i.isClosed=!0,i.resize=!1,i.needToResize())if(i.resize=!0,i.cropSize=[i.webcamConfig.resizeHeight,i.webcamConfig.resizeWidth],i.cropBoxInd=ba([0],"int32"),i.webcamConfig.centerCrop){var a=1*i.webcamConfig.resizeWidth/i.webcamVideoElement.width,o=1*i.webcamConfig.resizeHeight/i.webcamVideoElement.height,s=(1-a)/2,u=(1-o)/2,l=s+a,c=o+u;i.cropBox=Uu([u,s,c,l],[1,4])}else i.cropBox=Uu([0,0,1,1],[1,4]);return i}return On(t,e),t.prototype.summary=function(){return"webcam"},t.create=function(n,r){return r===void 0&&(r={}),He(this,void 0,void 0,function(){var i;return Ge(this,function(a){switch(a.label){case 0:if(pe().get("IS_NODE"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!n){if(n=document.createElement("video"),!r.resizeWidth||!r.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");n.width=r.resizeWidth,n.height=r.resizeHeight}return[4,(i=new t(n,r)).start()];case 1:return a.sent(),[2,i]}})})},t.prototype.start=function(){return He(this,void 0,void 0,function(){var n,r,i=this;return Ge(this,function(a){switch(a.label){case 0:this.webcamConfig.facingMode&&pt.assert(this.webcamConfig.facingMode==="user"||this.webcamConfig.facingMode==="environment",function(){return"Invalid webcam facing mode: "+i.webcamConfig.facingMode+". Please provide 'user' or 'environment'"}),a.label=1;case 1:return a.trys.push([1,3,,4]),n=this,[4,navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})];case 2:return n.stream=a.sent(),[3,4];case 3:throw(r=a.sent()).message="Error thrown while initializing video stream: "+r.message,r;case 4:if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(o){console.log(o),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,[2,new Promise(function(o){i.webcamVideoElement.onloadedmetadata=function(){o()}})]}})})},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n;return Ge(this,function(r){if(this.isClosed)return[2,{value:null,done:!0}];try{n=dJ.fromPixels(this.webcamVideoElement)}catch(i){throw new Error("Error thrown converting video to pixels: "+JSON.stringify(i))}if(!this.resize)return[2,{value:n,done:!1}];try{return[2,{value:this.cropAndResizeFrame(n),done:!1}]}catch(i){throw new Error("Error thrown cropping the video: "+i.message)}finally{n.dispose()}return[2]})})},t.prototype.needToResize=function(){return!(!this.webcamConfig.resizeWidth||!this.webcamConfig.resizeHeight||this.webcamVideoElement.width===this.webcamConfig.resizeWidth&&this.webcamVideoElement.height===this.webcamConfig.resizeHeight)},t.prototype.cropAndResizeFrame=function(n){var r=this;return le(function(){var i,a=n.toFloat().expandDims(0),o=(i=Lf.cropAndResize(a,r.cropBox,r.cropBoxInd,r.cropSize,"bilinear")).shape;return i.reshape(o.slice(1))})},t.prototype.capture=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){switch(n.label){case 0:return[4,this.next()];case 1:return[2,n.sent().value]}})})},t.prototype.stop=function(){this.stream.getTracks().forEach(function(n){return n.stop()});try{this.webcamVideoElement.srcObject=null}catch(n){console.log(n),this.webcamVideoElement.src=null}this.isClosed=!0},t.prototype.toArray=function(){throw new Error("Can not convert infinite video stream to array.")},t}(ii);var tte=function(){return function(){}}(),nte=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return On(t,e),t.prototype.split=function(n){return new L6e(this,n)},t}(ii),L6e=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.impl=new B6e(n,r),i}return On(t,e),t.prototype.summary=function(){return this.impl.summary()},t.prototype.next=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){return[2,this.impl.next()]})})},t}(nte),B6e=function(e){function t(n,r){var i=e.call(this)||this;return i.upstream=n,i.separator=r,i.carryover="",i}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Split('"+this.separator+"')"},t.prototype.pump=function(){return He(this,void 0,void 0,function(){var n,r,i,a,o;return Ge(this,function(s){switch(s.label){case 0:return[4,this.upstream.next()];case 1:if((n=s.sent()).done)return this.carryover===""?[2,!1]:(this.outputQueue.push(this.carryover),this.carryover="",[2,!0]);for((r=n.value.split(this.separator))[0]=this.carryover+r[0],i=0,a=r.slice(0,-1);i<a.length;i++)o=a[i],this.outputQueue.push(o);return this.carryover=r[r.length-1],[2,!0]}})})},t}(o$),z6e=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return On(t,e),t.prototype.decodeUTF8=function(){return new j6e(this)},t}(ii),j6e=function(e){function t(n){var r=e.call(this)||this;return r.upstream=n,r.impl=new U6e(n),r}return On(t,e),t.prototype.summary=function(){return this.impl.summary()},t.prototype.next=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){return[2,this.impl.next()]})})},t}(nte),U6e=function(e){function t(n){var r=e.call(this)||this;if(r.upstream=n,pe().get("IS_BROWSER"))r.decoder=new TextDecoder("utf-8");else{var i=require("string_decoder").StringDecoder;r.decoder=new i("utf8")}return r}return On(t,e),t.prototype.summary=function(){return this.upstream.summary()+" -> Utf8"},t.prototype.pump=function(){return He(this,void 0,void 0,function(){var n,r,i;return Ge(this,function(a){switch(a.label){case 0:return[4,this.upstream.next()];case 1:return(n=a.sent()).done?[2,!1]:(r=n.value,i=pe().get("IS_BROWSER")?this.decoder.decode(r,{stream:!0}):this.decoder.write(Buffer.from(r.buffer)),this.outputQueue.push(i),[2,!0])}})})},t}(o$),rte=function(e){function t(n,r){r===void 0&&(r={});var i=e.call(this)||this;return i.file=n,i.options=r,pt.assert(n instanceof Uint8Array||!!pe().get("IS_BROWSER")&&(n instanceof File||n instanceof Blob),function(){return"FileChunkIterator only supports File, Blob and Uint8Array right now."}),i.offset=r.offset||0,i.chunkSize=r.chunkSize||1048576,i}return On(t,e),t.prototype.summary=function(){return"FileChunks "+this.file},t.prototype.next=function(){return He(this,void 0,void 0,function(){var n,r,i=this;return Ge(this,function(a){switch(a.label){case 0:return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?[2,{value:null,done:!0}]:(n=new Promise(function(o,s){var u=i.offset+i.chunkSize;if(i.file instanceof Uint8Array)o(new Uint8Array(i.file.slice(i.offset,u)));else{var l=new FileReader;l.onload=function(f){var d=l.result;if(d instanceof ArrayBuffer&&(d=new Uint8Array(d)),!(d instanceof Uint8Array))return s(new TypeError("FileReader returned unknown type."));o(d)},l.onabort=function(f){return s(new Error("Aborted"))},l.onerror=function(f){return s(new Error(f.type))};var c=i.file.slice(i.offset,u);l.readAsArrayBuffer(c)}i.offset=u}),r={},[4,n]);case 1:return[2,(r.value=a.sent(),r.done=!1,r)]}})})},t}(z6e);function W6e(e,t){return t===void 0&&(t={}),He(this,void 0,void 0,function(){var n,r,i,a,o;return Ge(this,function(s){switch(s.label){case 0:return typeof e=="string"?n=e:(n=e.url,r=V6e(e)),[4,pt.fetch(n,r)];case 1:return(i=s.sent()).ok?(o=Uint8Array.bind,[4,i.arrayBuffer()]):[3,3];case 2:return a=new(o.apply(Uint8Array,[void 0,s.sent()])),[2,new rte(a,t)];case 3:throw new Error(i.statusText)}})})}var V6e=function(e){return{method:e.method,headers:e.headers,body:e.body,mode:e.mode,credentials:e.credentials,cache:e.cache,redirect:e.redirect,referrer:e.referrer,integrity:e.integrity}};function ite(e){return typeof e=="string"&&e.substr(0,7)==="file://"}var q6e=function(e){function t(n,r){r===void 0&&(r={});var i=e.call(this)||this;return i.input=n,i.options=r,i}return On(t,e),t.prototype.iterator=function(){return He(this,void 0,void 0,function(){var n;return Ge(this,function(r){return ite(this.input)&&pe().get("IS_NODE")&&(n=require("fs"),this.input=n.readFileSync(this.input.substr(7))),[2,new rte(this.input,this.options)]})})},t}(tte);(function(e){function t(n,r){r===void 0&&(r={});var i=e.call(this)||this;return i.url=n,i.fileOptions=r,i}return On(t,e),t.prototype.iterator=function(){return He(this,void 0,void 0,function(){return Ge(this,function(n){return ite(this.url)?[2,new q6e(this.url,this.fileOptions).iterator()]:[2,W6e(this.url,this.fileOptions)]})})},t})(tte);function H6e(e){let t;const n=new Set,r=(l,c)=>{const f=typeof l=="function"?l(t):l;if(f!==t){const d=t;t=c?f:Object.assign({},t,f),n.forEach(h=>h(t,d))}},i=()=>t,a=(l,c=i,f=Object.is)=>{let d=c(t);function h(){const p=c(t);if(!f(d,p)){const g=d;l(d=p,g)}}return n.add(h),()=>n.delete(h)},u={setState:r,getState:i,subscribe:(l,c,f)=>c||f?a(l,c,f):(n.add(l),()=>n.delete(l)),destroy:()=>n.clear()};return t=e(r,i,u),u}const G6e=typeof window=="undefined"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),ate=G6e?qt:lf;function K6e(e){const t=typeof e=="function"?H6e(e):e,n=(r=t.getState,i=Object.is)=>{const[,a]=kN(g=>g+1,0),o=t.getState(),s=Jt(o),u=Jt(r),l=Jt(i),c=Jt(!1),f=Jt();f.current===void 0&&(f.current=r(o));let d,h=!1;(s.current!==o||u.current!==r||l.current!==i||c.current)&&(d=r(o),h=!i(f.current,d)),ate(()=>{h&&(f.current=d),s.current=o,u.current=r,l.current=i,c.current=!1});const p=Jt(o);return ate(()=>{const g=()=>{try{const v=t.getState(),y=u.current(v);l.current(f.current,y)||(s.current=v,f.current=y,a())}catch(v){c.current=!0,a()}},m=t.subscribe(g);return t.getState()!==p.current&&g(),m},[]),h?d:f.current};return Object.assign(n,t),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const r=[n,t];return{next(){const i=r.length<=0;return{value:r.shift(),done:i}}}},n}var ote={},ste=mh(r4e),X6e={},Y6e={},nC={},Xr={},rv={};(function(e){/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(e,"__esModule",{value:!0});var t="tfjsflags",n=function(){function u(l){this.global=l,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return u.prototype.setPlatform=function(l,c){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. "+("Overwriting the platform with "+c+".")),this.platformName=l,this.platform=c},u.prototype.registerFlag=function(l,c,f){if(this.flagRegistry[l]={evaluationFn:c,setHook:f},this.urlFlags[l]!=null){var d=this.urlFlags[l];console.warn("Setting feature override from URL "+l+": "+d+"."),this.set(l,d)}},u.prototype.get=function(l){return l in this.flags?this.flags[l]:(this.flags[l]=this.evaluateFlag(l),this.flags[l])},u.prototype.getNumber=function(l){return this.get(l)},u.prototype.getBool=function(l){return this.get(l)},u.prototype.getFlags=function(){return this.flags},Object.defineProperty(u.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),u.prototype.set=function(l,c){if(this.flagRegistry[l]==null)throw new Error("Cannot set flag "+l+" as it has not been registered.");this.flags[l]=c,this.flagRegistry[l].setHook!=null&&this.flagRegistry[l].setHook(c)},u.prototype.evaluateFlag=function(l){if(this.flagRegistry[l]==null)throw new Error("Cannot evaluate flag '"+l+"': no evaluation function found.");return this.flagRegistry[l].evaluationFn()},u.prototype.setFlags=function(l){this.flags=Object.assign({},l)},u.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},u.prototype.populateURLFlags=function(){var l=this;if(!(typeof this.global=="undefined"||typeof this.global.location=="undefined"||typeof this.global.location.search=="undefined")){var c=r(this.global.location.search);if(t in c){var f=c[t].split(",");f.forEach(function(d){var h=d.split(":"),p=h[0],g=h[1];l.urlFlags[p]=a(p,g)})}}},u}();e.Environment=n;function r(u){var l={};return u.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(c){for(var f=[],d=1;d<arguments.length;d++)f[d-1]=arguments[d];return i(l,f[0],f[1]),f.join("=")}),l}e.getQueryParams=r;function i(u,l,c){u[decodeURIComponent(l)]=decodeURIComponent(c||"")}function a(u,l){if(l=l.toLowerCase(),l==="true"||l==="false")return l==="true";if(""+ +l===l)return+l;throw new Error("Could not parse value flag value "+l+" for flag "+u+".")}function o(){return e.ENV}e.env=o,e.ENV=null;function s(u){e.ENV=u}e.setEnvironmentGlobal=s})(rv);var gc={};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(gc,"__esModule",{value:!0});var iv=new Map,Hb=new Map;function Z6e(e,t){var n=l$(e,t);return iv.get(n)}gc.getKernel=Z6e;function J6e(e){return Hb.get(e)}gc.getGradient=J6e;function Q6e(e){for(var t=iv.entries(),n=[];;){var r=t.next(),i=r.done,a=r.value;if(i)break;var o=a[0],s=a[1],u=o.split("_")[0];u===e&&n.push(s)}return n}gc.getKernelsForBackend=Q6e;function eje(e){var t=e.kernelName,n=e.backendName,r=l$(t,n);if(iv.has(r))throw new Error("The kernel '"+t+"' for backend "+("'"+n+"' is already registered"));iv.set(r,e)}gc.registerKernel=eje;function tje(e){var t=e.kernelName;Hb.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),Hb.set(t,e)}gc.registerGradient=tje;function nje(e,t){var n=l$(e,t);if(!iv.has(n))throw new Error("The kernel '"+e+"' for backend "+("'"+t+"' is not registered"));iv.delete(n)}gc.unregisterKernel=nje;function rje(e){if(!Hb.has(e))throw new Error("The gradient '"+e+"' for backend is not registered");Hb.delete(e)}gc.unregisterGradient=rje;function l$(e,t){return t+"_"+e}var Gb={},qe={};/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(qe,"__esModule",{value:!0});var rC=rv;function ute(e){for(var t=e.length,n=0,r=0;t>0;)r=Math.random()*t|0,t--,n=e[t],e[t]=e[r],e[r]=n}qe.shuffle=ute;function ije(e,t,n){return Math.max(e,Math.min(t,n))}qe.clamp=ije;function aje(e){return e%2==0?e:e+1}qe.nearestLargerEven=aje;function oje(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}qe.sum=oje;function sje(e,t){var n=Math.random();return t*n+(1-n)*e}qe.randUniform=sje;function uje(e,t){for(var n=0,r=0;r<e.length;r++){var i=Number(e[r])-Number(t[r]);n+=i*i}return n}qe.distSquared=uje;function av(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}qe.assert=av;function lje(e,t,n){n===void 0&&(n=""),av(lte(e,t),function(){return n+(" Shapes "+e+" and "+t+" must match")})}qe.assertShapesMatch=lje;function cje(e){av(e!=null,function(){return"The input to the tensor constructor must be a non-null value."})}qe.assertNonNull=cje;function c$(e,t,n){if(t===void 0&&(t=[]),n===void 0&&(n=!1),t==null&&(t=[]),Array.isArray(e)||hte(e)&&!n)for(var r=0;r<e.length;++r)c$(e[r],t,n);else t.push(e);return t}qe.flatten=c$;function fje(e){if(e.length===0)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}qe.sizeFromShape=fje;function dje(e){return e.length===0}qe.isScalarShape=dje;function lte(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}qe.arraysEqual=lte;function cte(e){return e%1==0}qe.isInt=cte;function hje(e){if(Math.tanh!=null)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}qe.tanh=hje;function pje(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}qe.sizeToSquarishShape=pje;function gje(e){for(var t=new Uint32Array(e),n=0;n<e;++n)t[n]=n;return ute(t),t}qe.createShuffledIndices=gje;function mje(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}qe.rightPad=mje;function vje(e,t,n){return t===void 0&&(t=function(r){return 0}),new Promise(function(r,i){var a=0,o=function(){if(e()){r();return}a++;var s=t(a);if(n!=null&&a>=n){i();return}setTimeout(o,s)};o()})}qe.repeatedTry=vje;function yje(e,t){for(var n=1,r=-1,i=0;i<e.length;++i)if(e[i]>=0)n*=e[i];else if(e[i]===-1){if(r!==-1)throw Error("Shapes can only have 1 implicit size. "+("Found -1 at dim "+r+" and dim "+i));r=i}else if(e[i]<0)throw Error("Shapes can not be < 0. Found "+e[i]+" at dim "+i);if(r===-1){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(n===0)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. "+("Got "+t+" / "+n));var a=e.slice();return a[r]=t/n,a}qe.inferFromImplicitShape=yje;function fte(e,t){var n=t.length;return e=e==null?t.map(function(r,i){return i}):[].concat(e),av(e.every(function(r){return r>=-n&&r<n}),function(){return"All values in axis param must be in range [-"+n+", "+n+") but "+("got axis "+e)}),av(e.every(function(r){return cte(r)}),function(){return"All values in axis param must be integers but "+("got axis "+e)}),e.map(function(r){return r<0?n+r:r})}qe.parseAxisParam=fte;function bje(e,t){for(var n=[],r=[],i=t!=null&&Array.isArray(t)&&t.length===0,a=t==null||i?null:fte(t,e).sort(),o=0,s=0;s<e.length;++s){if(a!=null){if(a[o]===s&&e[s]!==1)throw new Error("Can't squeeze axis "+s+" since its dim '"+e[s]+"' is not 1");(a[o]==null||a[o]>s)&&e[s]===1&&(n.push(e[s]),r.push(s)),a[o]<=s&&o++}e[s]!==1&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}qe.squeezeShape=bje;function xje(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else throw new Error("Unknown data type "+e);return n}qe.getTypedArrayFromDType=xje;function wje(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else if(e==="string")n=new Array(t);else throw new Error("Unknown data type "+e);return n}qe.getArrayFromDType=wje;function dte(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+t+" being uploaded contains "+r+".")}}qe.checkConversionForErrors=dte;function _je(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}qe.isValidDtype=_je;function Sje(e,t){return!(t==="complex64"||t==="float32"&&e!=="complex64"||t==="int32"&&e!=="float32"&&e!=="complex64"||t==="bool"&&e==="bool")}qe.hasEncodingLoss=Sje;function hte(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}qe.isTypedArray=hte;function Eje(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error("Unknown dtype "+e)}qe.bytesPerElement=Eje;function Cje(e){if(e==null)return 0;var t=0;return e.forEach(function(n){return t+=n.length}),t}qe.bytesFromStringArray=Cje;function pte(e){return typeof e=="string"||e instanceof String}qe.isString=pte;function gte(e){return typeof e=="boolean"}qe.isBoolean=gte;function mte(e){return typeof e=="number"}qe.isNumber=mte;function vte(e){return Array.isArray(e)?vte(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":mte(e)?"float32":pte(e)?"string":gte(e)?"bool":"float32"}qe.inferDtype=vte;function Aje(e){return!!(e&&e.constructor&&e.call&&e.apply)}qe.isFunction=Aje;function kje(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}qe.nearestDivisor=kje;function Tje(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}qe.computeStrides=Tje;function Oje(e,t,n){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=c$(e)),n&&dte(e,t),Nje(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){for(var r=new Uint8Array(e.length),i=0;i<r.length;++i)Math.round(e[i])!==0&&(r[i]=1);return r}else throw new Error("Unknown data type "+t)}qe.toTypedArray=Oje;function yte(e,t,n){var r=new Array;if(t.length===1)for(var i=t[0],a=0;a<i;a++)r[a]=n[e+a];else for(var i=t[0],o=t.slice(1),s=o.reduce(function(l,c){return l*c}),a=0;a<i;a++)r[a]=yte(e+a*s,o,n);return r}function Ije(e,t){if(e.length===0)return t[0];var n=e.reduce(function(r,i){return r*i});if(n===0)return[];if(n!==t.length)throw new Error("["+e+"] does not match the input size.");return yte(0,e,t)}qe.toNestedArray=Ije;function Nje(e,t){return e instanceof Float32Array&&t==="float32"||e instanceof Int32Array&&t==="int32"||e instanceof Uint8Array&&t==="bool"}function Dje(e,t){for(var n=bte(e,t),r=0;r<n.length;r++)n[r]=1;return n}qe.makeOnesTypedArray=Dje;function bte(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error("Unknown data type "+t)}qe.makeZerosTypedArray=bte;function Rje(){return rC.env().platform.now()}qe.now=Rje;function Fje(e){e.forEach(function(t){av(Number.isInteger(t)&&t>=0,function(){return"Tensor must have a shape comprised of positive integers but got "+("shape ["+e+"].")})})}qe.assertNonNegativeIntegerDimensions=Fje;function Mje(e,t){return rC.env().platform.fetch(e,t)}qe.fetch=Mje;function Pje(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",rC.env().platform.encode(e,t)}qe.encodeString=Pje;function $je(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",rC.env().platform.decode(e,t)}qe.decodeString=$je;function Lje(e,t,n){if(t===0)return 0;if(t===1)return e[0];for(var r=e[e.length-1],i=0;i<e.length-1;++i)r+=n[i]*e[i];return r}qe.locToIndex=Lje;function Bje(e,t,n){if(t===0)return[];if(t===1)return[e];for(var r=new Array(t),i=0;i<r.length-1;++i)r[i]=Math.floor(e/n[i]),e-=r[i]*n[i];return r[r.length-1]=e,r}qe.indexToLoc=Bje;/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(Gb,"__esModule",{value:!0});var f$=qe,zje=function(){function e(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new wte)}return e.prototype.profileKernel=function(t,n,r){var i=this,a,o=function(){a=r()},s=this.backendTimer.time(o);return a.forEach(function(u){u.data().then(function(l){xte(l,u.dtype,t),s.then(function(c){var f="";c.getExtraProfileInfo!=null&&(f=c.getExtraProfileInfo()),i.logger.logKernelProfile(t,u,l,c.kernelMs,n,f)})})}),a},e}();Gb.Profiler=zje;function xte(e,t,n){if(t!=="float32")return!1;for(var r=0;r<e.length;r++){var i=e[r];if(isNaN(i)||!isFinite(i))return console.warn("Found "+i+" in the result of '"+n+"'"),!0}return!1}Gb.checkComputationForErrors=xte;var wte=function(){function e(){}return e.prototype.logKernelProfile=function(t,n,r,i,a,o){var s=typeof i=="number"?f$.rightPad(i+"ms",9):i.error,u=f$.rightPad(t,25),l=n.rank,c=n.size,f=f$.rightPad(n.shape.toString(),14),d="";for(var h in a){var p=a[h],g=p.shape||n.shape,m=g.length;d+=h+": "+m+"D "+(m>0?g:"")+" "}console.log("%c"+u+"	%c"+s+"	%c"+l+"D "+f+"	%c"+c+"	%c"+d+"	%c"+o,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},e}();Gb.Logger=wte;var iC={};/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(iC,"__esModule",{value:!0});var jje=qe;function Uje(e,t,n){for(var r={},i={},a=0;a<t.length;a++)r[t[a].id]=!0;for(var a=0;a<e.length;a++){var o=e[a],s=o.inputs;for(var u in s){for(var l=s[u],c=!1,f=0;f<t.length;f++)if(r[l.id]){o.outputs.forEach(function(b){return r[b.id]=!0}),c=!0,i[o.id]=!0;break}if(c)break}}var d={};d[n.id]=!0;for(var h={},a=e.length-1;a>=0;a--)for(var o=e[a],s=o.inputs,f=0;f<o.outputs.length;f++)if(d[o.outputs[f].id]){for(var u in s)d[s[u].id]=!0,h[o.id]=!0;break}for(var p=[],a=0;a<e.length;a++){var o=e[a];if(i[o.id]&&h[o.id]){var g={};for(var u in o.inputs){var m=o.inputs[u];r[m.id]&&(g[u]=m)}var v=Object.assign({},o);v.inputs=g,v.outputs=o.outputs,p.push(v)}}return p}iC.getFilteredNodesXToY=Uje;function Wje(e,t,n){for(var r=function(a){var o=t[a],s=[];if(o.outputs.forEach(function(f){var d=e[f.id];d!=null?s.push(d):s.push(null)}),o.gradient==null)throw new Error("Cannot compute gradient: gradient function not found "+("for "+o.kernelName+"."));var u=o.gradient(s),l=function(f){if(!(f in u))throw new Error("Cannot backprop through input "+f+". "+("Available gradients found: "+Object.keys(u)+"."));var d=n(function(){return u[f]()});if(d.dtype!=="float32")throw new Error("Error in gradient for op "+o.kernelName+". The gradient of input "+(f+" must have 'float32' dtype, but has '"+d.dtype+"'"));var h=o.inputs[f];if(!jje.arraysEqual(d.shape,h.shape))throw new Error("Error in gradient for op "+o.kernelName+". The gradient of input "+("'"+f+"' has shape '"+d.shape+"', which does not match ")+("the shape of the input '"+h.shape+"'"));if(e[h.id]==null)e[h.id]=d;else{var p=e[h.id];e[h.id]=p.add(d),p.dispose()}};for(var c in o.inputs)l(c)},i=t.length-1;i>=0;i--)r(i)}iC.backpropagateGradients=Wje;var kr={},d$={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(d$,"__esModule",{value:!0});var aC=qe,_te=20,Kb=3,h$=7;function Vje(e,t,n,r){var i=aC.computeStrides(t),a=qje(e,t,n,i),o=t.length,s=oC(e,t,n,i,a),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+o),u.push("  shape: ["+t+"]"),u.push("  values:")),u.push(s.map(function(l){return"    "+l}).join(`
`)),u.join(`
`)}d$.tensorToString=Vje;function qje(e,t,n,r){var i=aC.sizeFromShape(t),a=r[r.length-1],o=new Array(a).fill(0),s=t.length,u=n==="complex64"?Yb(e):e;if(s>1)for(var l=0;l<i/a;l++)for(var c=l*a,f=0;f<a;f++)o[f]=Math.max(o[f],Xb(u[c+f],0,n).length);return o}function Xb(e,t,n){var r;return Array.isArray(e)?r=parseFloat(e[0].toFixed(h$))+" + "+(parseFloat(e[1].toFixed(h$))+"j"):aC.isString(e)?r="'"+e+"'":n==="bool"?r=Ste(e):r=parseFloat(e.toFixed(h$)).toString(),aC.rightPad(r,t)}function Ste(e){return e===0?"false":"true"}function oC(e,t,n,r,i,a){a===void 0&&(a=!0);var o=n==="complex64"?2:1,s=t[0],u=t.length;if(u===0){if(n==="complex64"){var l=Yb(e);return[Xb(l[0],0,n)]}return n==="bool"?[Ste(e[0])]:[e[0].toString()]}if(u===1){if(s>_te){var c=Kb*o,f=Array.from(e.slice(0,c)),d=Array.from(e.slice((s-Kb)*o,s*o));return n==="complex64"&&(f=Yb(f),d=Yb(d)),["["+f.map(function(C,_){return Xb(C,i[_],n)}).join(", ")+", ..., "+d.map(function(C,_){return Xb(C,i[s-Kb+_],n)}).join(", ")+"]"]}var h=n==="complex64"?Yb(e):Array.from(e);return["["+h.map(function(C,_){return Xb(C,i[_],n)}).join(", ")+"]"]}var p=t.slice(1),g=r.slice(1),m=r[0]*o,v=[];if(s>_te){for(var y=0;y<Kb;y++){var b=y*m,x=b+m;v.push.apply(v,oC(e.slice(b,x),p,n,g,i,!1))}v.push("...");for(var y=s-Kb;y<s;y++){var b=y*m,x=b+m;v.push.apply(v,oC(e.slice(b,x),p,n,g,i,y===s-1))}}else for(var y=0;y<s;y++){var b=y*m,x=b+m;v.push.apply(v,oC(e.slice(b,x),p,n,g,i,y===s-1))}var w=u===2?",":"";v[0]="["+v[0]+w;for(var y=1;y<v.length-1;y++)v[y]=" "+v[y]+w;for(var S=`,
`,y=2;y<u;y++)S+=`
`;return v[v.length-1]=" "+v[v.length-1]+"]"+(a?"":S),v}function Yb(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Hje=Ye&&Ye.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),sC=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},uC=Ye&&Ye.__generator||function(e,t){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(l){return function(c){return u([l,c])}}function u(l){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,i=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(a=n.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){n.label=l[1];break}if(l[0]===6&&n.label<a[1]){n.label=a[1],a=l;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(l);break}a[2]&&n.ops.pop(),n.trys.pop();continue}l=t.call(e,n)}catch(c){l=[6,c],i=0}finally{r=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(kr,"__esModule",{value:!0});var Gje=d$,mc=qe,lC=qe,Kje=function(){function e(t,n,r){var i=this;if(this.dtype=n,this.shape=t.slice(),this.size=mc.sizeFromShape(t),r!=null){var a=r.length;mc.assert(a===this.size,function(){return"Length of values '"+a+"' does not match the size "+("inferred by the shape '"+i.size+"'.")})}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||mc.getArrayFromDType(n,this.size),this.strides=lC.computeStrides(t)}return e.prototype.set=function(t){for(var n=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];r.length===0&&(r=[0]),mc.assert(r.length===this.rank,function(){return"The number of provided coordinates ("+r.length+") must "+("match the rank ("+n.rank+")")});var a=this.locToIndex(r);this.values[a]=t},e.prototype.get=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.length===0&&(t=[0]);for(var r=0,i=0,a=t;i<a.length;i++){var o=a[i];if(o<0||o>=this.shape[r]){var s="Requested out of range element at "+t+". "+("  Buffer shape="+this.shape);throw new Error(s)}r++}for(var u=t[t.length-1],l=0;l<t.length-1;++l)u+=this.strides[l]*t[l];return this.values[u]},e.prototype.locToIndex=function(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];for(var n=t[t.length-1],r=0;r<t.length-1;++r)n+=this.strides[r]*t[r];return n},e.prototype.indexToLoc=function(t){if(this.rank===0)return[];if(this.rank===1)return[t];for(var n=new Array(this.shape.length),r=0;r<n.length-1;++r)n[r]=Math.floor(t/this.strides[r]),t-=n[r]*this.strides[r];return n[n.length-1]=t,n},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return Qu().makeTensor(this.values,this.shape,this.dtype)},e}();kr.TensorBuffer=Kje;var Qu=null,be=null,Ete=null;function Xje(e){Qu=e}kr.setTensorTracker=Xje;function Yje(e){be=e}kr.setOpHandler=Yje;function Zje(e){Ete=e}kr.setDeprecationWarningFn=Zje;var cC=function(){function e(t,n,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=mc.sizeFromShape(t),this.strides=lC.computeStrides(t),this.dataId=r,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}return e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),mc.assert(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(t,n){return this.throwIfDisposed(),this.reshape([t,n])},e.prototype.as3D=function(t,n,r){return this.throwIfDisposed(),this.reshape([t,n,r])},e.prototype.as4D=function(t,n,r,i){return this.throwIfDisposed(),this.reshape([t,n,r,i])},e.prototype.as5D=function(t,n,r,i,a){return this.throwIfDisposed(),this.reshape([t,n,r,i,a])},e.prototype.asType=function(t){return this.throwIfDisposed(),be.cast(this,t)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.buffer=function(){return sC(this,void 0,void 0,function(){var t;return uC(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,be.buffer(this.shape,this.dtype,t)]}})})},e.prototype.bufferSync=function(){return be.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.array=function(){return sC(this,void 0,void 0,function(){var t;return uC(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,lC.toNestedArray(this.shape,t)]}})})},e.prototype.arraySync=function(){return lC.toNestedArray(this.shape,this.dataSync())},e.prototype.data=function(){return sC(this,void 0,void 0,function(){var t,n;return uC(this,function(r){switch(r.label){case 0:return this.throwIfDisposed(),t=Qu().read(this.dataId),this.dtype!=="string"?[3,2]:[4,t];case 1:n=r.sent();try{return[2,n.map(function(i){return mc.decodeString(i)})]}catch(i){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,t]}})})},e.prototype.dataSync=function(){this.throwIfDisposed();var t=Qu().readSync(this.dataId);if(this.dtype==="string")try{return t.map(function(n){return mc.decodeString(n)})}catch(n){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},e.prototype.bytes=function(){return sC(this,void 0,void 0,function(){var t;return uC(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),[4,Qu().read(this.dataId)];case 1:return t=n.sent(),this.dtype==="string"?[2,t]:[2,new Uint8Array(t.buffer)]}})})},e.prototype.dispose=function(){this.isDisposed||(Qu().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(t){return t===void 0&&(t=!1),be.print(this,t)},e.prototype.reshape=function(t){return this.throwIfDisposed(),be.reshape(this,t)},e.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},e.prototype.expandDims=function(t){return t===void 0&&(t=0),be.expandDims(this,t)},e.prototype.cumsum=function(t,n,r){return t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1),be.cumsum(this,t,n,r)},e.prototype.squeeze=function(t){return this.throwIfDisposed(),be.squeeze(this,t)},e.prototype.clone=function(){return this.throwIfDisposed(),be.clone(this)},e.prototype.toString=function(t){t===void 0&&(t=!1);var n=this.dataSync();return Gje.tensorToString(n,this.shape,this.dtype,t)},e.prototype.gather=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),be.gather(this,t,n)},e.prototype.matMul=function(t,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!1),this.throwIfDisposed(),be.matMul(this,t,n,r)},e.prototype.dot=function(t){return this.throwIfDisposed(),be.dot(this,t)},e.prototype.norm=function(t,n,r){return t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1),this.throwIfDisposed(),be.norm(this,t,n,r)},e.prototype.slice=function(t,n){return this.throwIfDisposed(),be.slice(this,t,n)},e.prototype.reverse=function(t){return this.throwIfDisposed(),be.reverse(this,t)},e.prototype.concat=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),t instanceof e&&(t=[t]),be.concat([this].concat(t),n)},e.prototype.split=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),be.split(this,t,n)},e.prototype.stack=function(t,n){return n===void 0&&(n=0),be.stack([this,t],n)},e.prototype.unstack=function(t){return t===void 0&&(t=0),be.unstack(this,t)},e.prototype.batchNormalization=function(t,n,r,i,a){return r===void 0&&(r=.001),Ete("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,n,a,i,r)},e.prototype.all=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),be.all(this,t,n)},e.prototype.any=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),be.any(this,t,n)},e.prototype.logSumExp=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),be.logSumExp(this,t,n)},e.prototype.sum=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),be.sum(this,t,n)},e.prototype.prod=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),be.prod(this,t,n)},e.prototype.mean=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),be.mean(this,t,n)},e.prototype.min=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),be.min(this,t,n)},e.prototype.max=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),be.max(this,t,n)},e.prototype.argMin=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),be.argMin(this,t)},e.prototype.argMax=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),be.argMax(this,t)},e.prototype.cast=function(t){return this.throwIfDisposed(),be.cast(this,t)},e.prototype.addStrict=function(t){return this.throwIfDisposed(),be.addStrict(this,t)},e.prototype.atan2=function(t){return this.throwIfDisposed(),be.atan2(this,t)},e.prototype.sub=function(t){return this.throwIfDisposed(),be.sub(this,t)},e.prototype.subStrict=function(t){return this.throwIfDisposed(),be.subStrict(this,t)},e.prototype.pow=function(t){return this.throwIfDisposed(),be.pow(this,t)},e.prototype.powStrict=function(t){return this.throwIfDisposed(),be.powStrict(this,t)},e.prototype.mul=function(t){return this.throwIfDisposed(),be.mul(this,t)},e.prototype.mulStrict=function(t){return this.throwIfDisposed(),be.mulStrict(this,t)},e.prototype.floorDiv=function(t){return this.throwIfDisposed(),be.floorDiv(this,t)},e.prototype.divStrict=function(t){return this.throwIfDisposed(),be.divStrict(this,t)},e.prototype.minimum=function(t){return this.throwIfDisposed(),be.minimum(this,t)},e.prototype.minimumStrict=function(t){return this.throwIfDisposed(),be.minimumStrict(this,t)},e.prototype.maximum=function(t){return this.throwIfDisposed(),be.maximum(this,t)},e.prototype.maximumStrict=function(t){return this.throwIfDisposed(),be.maximumStrict(this,t)},e.prototype.mod=function(t){return this.throwIfDisposed(),be.mod(this,t)},e.prototype.modStrict=function(t){return this.throwIfDisposed(),be.modStrict(this,t)},e.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),be.squaredDifferenceStrict(this,t)},e.prototype.notEqual=function(t){return this.throwIfDisposed(),be.notEqual(this,t)},e.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),be.notEqualStrict(this,t)},e.prototype.less=function(t){return this.throwIfDisposed(),be.less(this,t)},e.prototype.lessStrict=function(t){return this.throwIfDisposed(),be.lessStrict(this,t)},e.prototype.equal=function(t){return this.throwIfDisposed(),be.equal(this,t)},e.prototype.equalStrict=function(t){return this.throwIfDisposed(),be.equalStrict(this,t)},e.prototype.lessEqual=function(t){return this.throwIfDisposed(),be.lessEqual(this,t)},e.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),be.lessEqualStrict(this,t)},e.prototype.greater=function(t){return this.throwIfDisposed(),be.greater(this,t)},e.prototype.greaterStrict=function(t){return this.throwIfDisposed(),be.greaterStrict(this,t)},e.prototype.greaterEqual=function(t){return this.throwIfDisposed(),be.greaterEqual(this,t)},e.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),be.greaterEqualStrict(this,t)},e.prototype.logicalAnd=function(t){return this.throwIfDisposed(),be.logicalAnd(this,t)},e.prototype.logicalOr=function(t){return this.throwIfDisposed(),be.logicalOr(this,t)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),be.logicalNot(this)},e.prototype.logicalXor=function(t){return this.throwIfDisposed(),be.logicalXor(this,t)},e.prototype.where=function(t,n){return this.throwIfDisposed(),be.where(t,this,n)},e.prototype.neg=function(){return this.throwIfDisposed(),be.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),be.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),be.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),be.sign(this)},e.prototype.isNaN=function(){return this.throwIfDisposed(),be.isNaN(this)},e.prototype.isInf=function(){return this.throwIfDisposed(),be.isInf(this)},e.prototype.isFinite=function(){return this.throwIfDisposed(),be.isFinite(this)},e.prototype.exp=function(){return this.throwIfDisposed(),be.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),be.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),be.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),be.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),be.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),be.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),be.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),be.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),be.abs(this)},e.prototype.clipByValue=function(t,n){return this.throwIfDisposed(),be.clipByValue(this,t,n)},e.prototype.relu=function(){return this.throwIfDisposed(),be.relu(this)},e.prototype.relu6=function(){return this.throwIfDisposed(),be.relu6(this)},e.prototype.elu=function(){return this.throwIfDisposed(),be.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),be.selu(this)},e.prototype.leakyRelu=function(t){return t===void 0&&(t=.2),this.throwIfDisposed(),be.leakyRelu(this,t)},e.prototype.prelu=function(t){return this.throwIfDisposed(),be.prelu(this,t)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),be.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),be.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),be.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),be.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),be.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),be.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),be.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),be.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),be.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),be.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),be.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),be.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),be.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),be.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),be.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),be.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),be.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),be.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),be.round(this)},e.prototype.step=function(t){return t===void 0&&(t=0),this.throwIfDisposed(),be.step(this,t)},e.prototype.softmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),be.softmax(this,t)},e.prototype.logSoftmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),be.logSoftmax(this,t)},e.prototype.resizeBilinear=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),be.image.resizeBilinear(this,t,n)},e.prototype.resizeNearestNeighbor=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),be.image.resizeNearestNeighbor(this,t,n)},e.prototype.conv1d=function(t,n,r,i,a,o){return i===void 0&&(i="NWC"),a===void 0&&(a=1),this.throwIfDisposed(),be.conv1d(this,t,n,r,i,a,o)},e.prototype.conv2d=function(t,n,r,i,a,o){return i===void 0&&(i="NHWC"),a===void 0&&(a=[1,1]),this.throwIfDisposed(),be.conv2d(this,t,n,r,i,a,o)},e.prototype.conv2dTranspose=function(t,n,r,i,a){return this.throwIfDisposed(),be.conv2dTranspose(this,t,n,r,i,a)},e.prototype.depthwiseConv2D=function(t,n,r,i,a,o){return i===void 0&&(i="NHWC"),a===void 0&&(a=[1,1]),this.throwIfDisposed(),be.depthwiseConv2d(this,t,n,r,i,a,o)},e.prototype.separableConv2d=function(t,n,r,i,a,o){return a===void 0&&(a=[1,1]),o===void 0&&(o="NHWC"),this.throwIfDisposed(),be.separableConv2d(this,t,n,r,i,a,o)},e.prototype.avgPool=function(t,n,r,i){return this.throwIfDisposed(),be.avgPool(this,t,n,r,i)},e.prototype.maxPool=function(t,n,r,i){return this.throwIfDisposed(),be.maxPool(this,t,n,r,i)},e.prototype.localResponseNormalization=function(t,n,r,i){return t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),i===void 0&&(i=.5),be.localResponseNormalization(this,t,n,r,i)},e.prototype.pool=function(t,n,r,i,a){return this.throwIfDisposed(),be.pool(this,t,n,r,i,a)},e.prototype.variable=function(t,n,r){return t===void 0&&(t=!0),this.throwIfDisposed(),Qu().makeVariable(this,t,n,r)},e.prototype.unsortedSegmentSum=function(t,n){return this.throwIfDisposed(),be.unsortedSegmentSum(this,t,n)},e.prototype.batchToSpaceND=function(t,n){return this.throwIfDisposed(),be.batchToSpaceND(this,t,n)},e.prototype.spaceToBatchND=function(t,n){return this.throwIfDisposed(),be.spaceToBatchND(this,t,n)},e.prototype.topk=function(t,n){return t===void 0&&(t=1),n===void 0&&(n=!0),this.throwIfDisposed(),be.topk(this,t,n)},e.prototype.stridedSlice=function(t,n,r,i,a,o,s,u){return i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o=0),s===void 0&&(s=0),u===void 0&&(u=0),this.throwIfDisposed(),be.stridedSlice(this,t,n,r,i,a,o,s,u)},e.prototype.depthToSpace=function(t,n){return this.throwIfDisposed(),be.depthToSpace(this,t,n)},e.prototype.fft=function(){return this.throwIfDisposed(),be.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),be.spectral.ifft(this)},e.prototype.rfft=function(){return this.throwIfDisposed(),be.spectral.rfft(this)},e.prototype.irfft=function(){return this.throwIfDisposed(),be.spectral.irfft(this)},e}();kr.Tensor=cC,Object.defineProperty(cC,Symbol.hasInstance,{value:function(e){return!!e&&e.dataId!=null&&e.shape!=null&&e.dtype!=null}});var Cte=function(e){Hje(t,e);function t(n,r,i,a){var o=e.call(this,n.shape,n.dtype,n.dataId,a)||this;return o.trainable=r,o.name=i,o}return t.prototype.assign=function(n){if(n.dtype!==this.dtype)throw new Error("dtype of the new value ("+n.dtype+") and "+("previous value ("+this.dtype+") must match"));if(!mc.arraysEqual(n.shape,this.shape))throw new Error("shape of the new value ("+n.shape+") and "+("previous value ("+this.shape+") must match"));Qu().disposeTensor(this),this.dataId=n.dataId,Qu().incRef(this,null)},t.prototype.dispose=function(){Qu().disposeVariable(this),this.isDisposedInternal=!0},t}(cC);kr.Variable=Cte,Object.defineProperty(Cte,Symbol.hasInstance,{value:function(e){return e instanceof cC&&e.assign!=null&&e.assign instanceof Function}});var us={},Ate={};(function(e){/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(e,"__esModule",{value:!0}),function(u){u.R0="R0",u.R1="R1",u.R2="R2",u.R3="R3",u.R4="R4",u.R5="R5",u.R6="R6"}(e.Rank||(e.Rank={}));var t;(function(u){u.float32="float32",u.int32="int32",u.bool="int32",u.complex64="complex64"})(t||(t={}));var n;(function(u){u.float32="float32",u.int32="int32",u.bool="bool",u.complex64="complex64"})(n||(n={}));var r;(function(u){u.float32="float32",u.int32="float32",u.bool="float32",u.complex64="complex64"})(r||(r={}));var i;(function(u){u.float32="complex64",u.int32="complex64",u.bool="complex64",u.complex64="complex64"})(i||(i={}));var a={float32:r,int32:t,bool:n,complex64:i};function o(u,l){if(u==="string"||l==="string"){if(u==="string"&&l==="string")return"string";throw new Error("Can not upcast "+u+" with "+l)}return a[u][l]}e.upcastType=o;function s(u){return o(u,"int32")}e.sumOutType=s})(Ate);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(us,"__esModule",{value:!0});var Jje=kr,Qje=Ate,e8e=qe;function t8e(e,t){if(e.dtype===t.dtype)return[e,t];var n=Qje.upcastType(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}us.makeTypesMatch=t8e;function n8e(e,t){e8e.assert(e.dtype===t.dtype,function(){return"The dtypes of the first("+e.dtype+") and"+(" second("+t.dtype+") input must match")})}us.assertTypesMatch=n8e;function r8e(e,t){return t.some(function(n){return n.id===e.id})}us.isTensorInList=r8e;function i8e(e){var t=[],n=new Set;return kte(e,t,n),t}us.getTensorsInContainer=i8e;function kte(e,t,n){if(e!=null){if(e instanceof Jje.Tensor){t.push(e);return}if(!!a8e(e)){var r=e;for(var i in r){var a=r[i];n.has(a)||(n.add(a),kte(a,t,n))}}}}function a8e(e){return Array.isArray(e)||typeof e=="object"}(function(e){/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var t=Ye&&Ye.__awaiter||function(v,y,b,x){return new(b||(b=Promise))(function(w,S){function C(A){try{E(x.next(A))}catch(k){S(k)}}function _(A){try{E(x.throw(A))}catch(k){S(k)}}function E(A){A.done?w(A.value):new b(function(k){k(A.value)}).then(C,_)}E((x=x.apply(v,y||[])).next())})},n=Ye&&Ye.__generator||function(v,y){var b={label:0,sent:function(){if(S[0]&1)throw S[1];return S[1]},trys:[],ops:[]},x,w,S,C;return C={next:_(0),throw:_(1),return:_(2)},typeof Symbol=="function"&&(C[Symbol.iterator]=function(){return this}),C;function _(A){return function(k){return E([A,k])}}function E(A){if(x)throw new TypeError("Generator is already executing.");for(;b;)try{if(x=1,w&&(S=A[0]&2?w.return:A[0]?w.throw||((S=w.return)&&S.call(w),0):w.next)&&!(S=S.call(w,A[1])).done)return S;switch(w=0,S&&(A=[A[0]&2,S.value]),A[0]){case 0:case 1:S=A;break;case 4:return b.label++,{value:A[1],done:!1};case 5:b.label++,w=A[1],A=[0];continue;case 7:A=b.ops.pop(),b.trys.pop();continue;default:if(S=b.trys,!(S=S.length>0&&S[S.length-1])&&(A[0]===6||A[0]===2)){b=0;continue}if(A[0]===3&&(!S||A[1]>S[0]&&A[1]<S[3])){b.label=A[1];break}if(A[0]===6&&b.label<S[1]){b.label=S[1],S=A;break}if(S&&b.label<S[2]){b.label=S[2],b.ops.push(A);break}S[2]&&b.ops.pop(),b.trys.pop();continue}A=y.call(v,b)}catch(k){A=[6,k],w=0}finally{x=S=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var r=rv,i=gc,a=Gb,o=iC,s=kr,u=us,l=qe,c=qe,f=function(){function v(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return v.prototype.dispose=function(){for(var y in this.registeredVariables)this.registeredVariables[y].dispose()},v}(),d=function(){function v(y){this.ENV=y,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new f}return v.prototype.ready=function(){return t(this,void 0,void 0,function(){var y,b,x,w;return n(this,function(S){switch(S.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];y=this.getSortedBackends(),b=0,S.label=1;case 1:return b<y.length?(x=y[b],[4,this.initializeBackend(x).success]):[3,5];case 2:return w=S.sent(),w?[4,this.setBackend(x)]:[3,4];case 3:return S.sent(),[2];case 4:return b++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(v.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var y=this.initializeBackendsAndReturnBest(),b=y.name,x=y.asyncInit;if(x)throw new Error("The highest priority backend '"+b+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(b)}return this.backendInstance},enumerable:!0,configurable:!0}),v.prototype.backendNames=function(){return Object.keys(this.registryFactory)},v.prototype.findBackend=function(y){if(!(y in this.registry))if(y in this.registryFactory){var b=this.initializeBackend(y).asyncInit;if(b)return null}else return null;return this.registry[y]},v.prototype.findBackendFactory=function(y){return y in this.registryFactory?this.registryFactory[y].factory:null},v.prototype.registerBackend=function(y,b,x){return x===void 0&&(x=1),y in this.registryFactory?(console.warn(y+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[y]={factory:b,priority:x},!0)},v.prototype.setBackend=function(y){return t(this,void 0,void 0,function(){var b,x,w,S,C;return n(this,function(_){switch(_.label){case 0:if(this.registryFactory[y]==null)throw new Error("Backend name '"+y+"' not found in registry");return this.backendName=y,this.registry[y]!=null?[3,4]:(this.backendInstance=null,b=this.initializeBackend(y),x=b.success,w=b.asyncInit,w?[4,x]:[3,2]);case 1:return C=_.sent(),[3,3];case 2:C=x,_.label=3;case 3:if(S=C,!S)return[2,!1];_.label=4;case 4:return this.backendInstance=this.registry[y],this.setupRegisteredKernels(),this.profiler=new a.Profiler(this.backendInstance),[2,!0]}})})},v.prototype.setupRegisteredKernels=function(){var y=this,b=i.getKernelsForBackend(this.backendName);b.forEach(function(x){x.setupFunc!=null&&x.setupFunc(y.backendInstance)})},v.prototype.disposeRegisteredKernels=function(y){var b=this,x=i.getKernelsForBackend(y);x.forEach(function(w){w.disposeFunc!=null&&w.disposeFunc(b.registry[y])})},v.prototype.initializeBackend=function(y){var b=this,x=this.registryFactory[y];if(x==null)throw new Error("Cannot initialize backend "+y+", no registration found.");try{var w=x.factory();if(Promise.resolve(w)===w){var S=++this.pendingBackendInitId,C=w.then(function(_){return S<b.pendingBackendInitId?!1:(b.registry[y]=_,b.pendingBackendInit=null,!0)}).catch(function(_){return S<b.pendingBackendInitId||(b.pendingBackendInit=null,console.warn("Initialization of backend "+y+" failed"),console.warn(_.stack||_.message)),!1});return this.pendingBackendInit=C,{success:C,asyncInit:!0}}else return this.registry[y]=w,{success:!0,asyncInit:!1}}catch(_){return console.warn("Initialization of backend "+y+" failed"),console.warn(_.stack||_.message),{success:!1,asyncInit:!1}}},v.prototype.removeBackend=function(y){if(!(y in this.registryFactory))throw new Error(y+" backend not found in registry");this.backendName===y&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,y in this.registry&&(this.disposeRegisteredKernels(y),this.registry[y].dispose(),delete this.registry[y]),delete this.registryFactory[y],this.backendName===y&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},v.prototype.getSortedBackends=function(){var y=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(b,x){return y.registryFactory[x].priority-y.registryFactory[b].priority})},v.prototype.initializeBackendsAndReturnBest=function(){for(var y=this.getSortedBackends(),b=0;b<y.length;b++){var x=y[b],w=this.initializeBackend(x),S=w.success,C=w.asyncInit;if(C||S)return{name:x,asyncInit:C}}throw new Error("Could not initialize any backends, all backend initializations failed.")},v.prototype.moveData=function(y,b){var x=this.state.tensorInfo.get(b),w=x.backend,S=this.readSync(b);w.disposeData(b),x.backend=y,y.move(b,S,x.shape,x.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},v.prototype.tidy=function(y,b){var x=this,w=null;if(b==null){if(typeof y!="function")throw new Error("Please provide a function to tidy()");b=y}else{if(typeof y!="string"&&!(y instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof b!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");w=y}var S;return this.scopedRun(function(){return x.startScope(w)},function(){return x.endScope(S)},function(){return S=b(),S instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),S})},v.prototype.scopedRun=function(y,b,x){y();try{var w=x();return b(),w}catch(S){throw b(),S}},v.prototype.nextTensorId=function(){return v.nextTensorId++},v.prototype.nextVariableId=function(){return v.nextVariableId++},v.prototype.clone=function(y){var b=this.makeTensorFromDataId(y.dataId,y.shape,y.dtype),x={x:y},w=function(C){return{x:function(){return C.toFloat()}}},S=[];return this.addTapeNode(this.state.activeScope.name,x,[b],w,S,{}),b},v.prototype.runKernel=function(y,b,x,w,S){var C=null,_=null;return this.runKernelFunc(C,b,_,y,x,w,S)},v.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},v.prototype.checkKernelForMemLeak=function(y,b,x){var w=this.backend.numDataIds(),S=0;x.forEach(function(E){S+=E.dtype==="complex64"?3:1});var C=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],_=w-b-S-C;if(_>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak "+("("+_+" data ids) after running '"+y+"'"))},v.prototype.runKernelFunc=function(y,b,x,w,S,C,_){var E=this,A,k=[],T=this.isTapeOn();w==null&&(w=this.state.activeScope!=null?this.state.activeScope.name:"");var I=this.state.numBytes,N=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var O,D=i.getKernel(w,this.backendName),L;if(D!=null)O=function(){var G=E.backend.numDataIds();L=D.kernelFunc({inputs:b,attrs:S,backend:E.backend});var K=Array.isArray(L)?L:[L];E.shouldCheckForMemLeaks()&&E.checkKernelForMemLeak(w,G,K);var ee=K.map(function(Oe){var Te=Oe.dataId,De=Oe.shape,me=Oe.dtype;return E.makeTensorFromDataId(Te,De,me)});if(T){var ce=E.getTensorsForGradient(w,b,ee);if(ce==null){_==null&&(_=[]);var he=ee.filter(function(Oe,Te){return _[Te]});ce=(C||[]).slice().concat(he)}k=E.saveTensorsForBackwardMode(ce)}return ee};else{var W=function(G){!T||(k=G.map(function(K){return E.keep(E.clone(K))}))};O=function(){var G=E.backend.numDataIds();L=E.tidy(function(){return y(E.backend,W)});var K=Array.isArray(L)?L:[L];return E.shouldCheckForMemLeaks()&&E.checkKernelForMemLeak(w,G,K),K}}return this.scopedRun(function(){return E.state.kernelDepth++},function(){return E.state.kernelDepth--},function(){E.ENV.getBool("DEBUG")?A=E.profiler.profileKernel(w,b,function(){return O()}):A=O()}),T&&this.addTapeNode(w,b,A,x,k,S),this.state.profiling&&this.state.activeProfile.kernels.push({name:w,bytesAdded:this.state.numBytes-I,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-N,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(b).map(function(G){return b[G].shape}),outputShapes:A.map(function(G){return G.shape})}),Array.isArray(L)?A:A[0]},v.prototype.saveTensorsForBackwardMode=function(y){var b=this,x=y.map(function(w){return b.keep(b.clone(w))});return x},v.prototype.getTensorsForGradient=function(y,b,x){var w=i.getGradient(y);if(w!=null){var S=w.inputsToSave||[],C=w.outputsToSave||[],_=void 0;w.saveAllInputs?(l.assert(Array.isArray(b),function(){return"saveAllInputs is true, expected inputs to be an array."}),_=Object.keys(b).map(function(A){return b[A]})):_=S.map(function(A){return b[A]});var E=x.filter(function(A,k){return C[k]});return _.concat(E)}return null},v.prototype.makeTensor=function(y,b,x,w){if(y==null)throw new Error("Values passed to engine.makeTensor() are null");x=x||"float32",w=w||this.backend;var S=y;x==="string"&&l.isString(y[0])&&(S=y.map(function(k){return l.encodeString(k)}));var C=w.write(S,b,x),_=new s.Tensor(b,x,C,this.nextTensorId());if(this.incRef(_,w),x==="string"){var E=this.state.tensorInfo.get(C),A=c.bytesFromStringArray(S);this.state.numBytes+=A-E.bytes,E.bytes=A}return _},v.prototype.makeTensorFromDataId=function(y,b,x,w){x=x||"float32";var S=new s.Tensor(b,x,y,this.nextTensorId());return this.incRef(S,w),S},v.prototype.makeVariable=function(y,b,x,w){b===void 0&&(b=!0),x=x||this.nextVariableId().toString(),w!=null&&w!==y.dtype&&(y=y.asType(w));var S=new s.Variable(y,b,x,this.nextTensorId());if(this.state.registeredVariables[S.name]!=null)throw new Error("Variable with name "+S.name+" was already registered");return this.state.registeredVariables[S.name]=S,this.incRef(S,this.backend),S},v.prototype.incRef=function(y,b){var x=this.state.tensorInfo.has(y.dataId)?this.state.tensorInfo.get(y.dataId).refCount:0;if(this.state.numTensors++,y.dtype==="string"&&this.state.numStringTensors++,x===0){this.state.numDataBuffers++;var w=0;y.dtype!=="complex64"&&y.dtype!=="string"&&(w=y.size*l.bytesPerElement(y.dtype)),this.state.tensorInfo.set(y.dataId,{backend:b||this.backend,dtype:y.dtype,shape:y.shape,bytes:w,refCount:0}),this.state.numBytes+=w}this.state.tensorInfo.get(y.dataId).refCount++,y instanceof s.Variable||this.track(y)},v.prototype.disposeTensor=function(y){if(!!this.state.tensorInfo.has(y.dataId)){this.state.numTensors--,y.dtype==="string"&&this.state.numStringTensors--;var b=this.state.tensorInfo.get(y.dataId),x=b.refCount;x<=1?(y.dtype!=="complex64"&&(this.state.numBytes-=b.bytes),this.state.numDataBuffers--,b.backend.disposeData(y.dataId),this.state.tensorInfo.delete(y.dataId)):this.state.tensorInfo.get(y.dataId).refCount--}},v.prototype.disposeVariables=function(){for(var y in this.state.registeredVariables){var b=this.state.registeredVariables[y];this.disposeVariable(b)}},v.prototype.disposeVariable=function(y){this.disposeTensor(y),this.state.registeredVariables[y.name]!=null&&delete this.state.registeredVariables[y.name]},v.prototype.memory=function(){var y=this.backend.memory();return y.numTensors=this.state.numTensors,y.numDataBuffers=this.state.numDataBuffers,y.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(y.unreliable=!0,y.reasons==null&&(y.reasons=[]),y.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),y},v.prototype.profile=function(y){return t(this,void 0,void 0,function(){var b,x;return n(this,function(w){return this.state.profiling=!0,b=this.state.numBytes,x=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=y(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(S){return S.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-b,this.state.activeProfile.newTensors=this.state.numTensors-x,[2,this.state.activeProfile]})})},v.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},v.prototype.addTapeNode=function(y,b,x,w,S,C){var _=this,E={id:this.state.nextTapeNodeId++,kernelName:y,inputs:b,outputs:x,saved:S},A=i.getGradient(y);A!=null&&(w=A.gradFunc),w!=null&&(E.gradient=function(k){return k=k.map(function(T,I){if(T==null){var N=x[I],O=l.makeZerosTypedArray(N.size,N.dtype);return _.makeTensor(O,N.shape,N.dtype)}return T}),w(k.length>1?k:k[0],S,C)}),this.state.activeTape.push(E)},v.prototype.keep=function(y){return y.kept=!0,y},v.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},v.prototype.endTape=function(){this.state.gradientDepth--},v.prototype.startScope=function(y){var b={track:[],name:"unnamed scope",id:this.state.nextScopeId++};y&&(b.name=y),this.state.scopeStack.push(b),this.state.activeScope=b},v.prototype.endScope=function(y){for(var b=this,x=u.getTensorsInContainer(y),w=new Set(x.map(function(E){return E.id})),S=0;S<this.state.activeScope.track.length;S++){var C=this.state.activeScope.track[S];!C.kept&&!w.has(C.id)&&C.dispose()}var _=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],x.forEach(function(E){!E.kept&&E.scopeId===_.id&&b.track(E)})},v.prototype.gradients=function(y,b,x,w){var S=this;if(w===void 0&&(w=!1),l.assert(b.length>0,function(){return"gradients() received an empty list of xs."}),x!=null&&x.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+x.dtype+"'");var C=this.scopedRun(function(){return S.startTape()},function(){return S.endTape()},function(){return S.tidy("forward",y)});l.assert(C instanceof s.Tensor,function(){return"The result y returned by f() must be a tensor."});var _=o.getFilteredNodesXToY(this.state.activeTape,b,C);if(!w&&_.length===0&&b.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var E={};E[C.id]=x??h(C.shape),o.backpropagateGradients(E,_,function(k){return S.tidy(k)});var A=b.map(function(k){return E[k.id]});return S.state.gradientDepth===0&&(S.state.activeTape.forEach(function(k){for(var T=0,I=k.saved;T<I.length;T++){var N=I[T];N.dispose()}}),S.state.activeTape=null),{value:C,grads:A}})},v.prototype.customGrad=function(y){var b=this;return l.assert(l.isFunction(y),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var x=[],w=0;w<arguments.length;w++)x[w]=arguments[w];l.assert(x.every(function(_){return _ instanceof s.Tensor}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var S,C={};return x.forEach(function(_,E){C[E]=_}),b.runKernelFunc(function(_,E){return S=y.apply(void 0,x.concat([E])),l.assert(S.value instanceof s.Tensor,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),l.assert(l.isFunction(S.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),S.value},C,function(_,E){var A=S.gradFunc(_,E),k=Array.isArray(A)?A:[A];l.assert(k.length===x.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),l.assert(k.every(function(I){return I instanceof s.Tensor}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var T={};return k.forEach(function(I,N){T[N]=function(){return I}}),T})}},v.prototype.readSync=function(y){var b=this.state.tensorInfo.get(y);return b.backend.readSync(y)},v.prototype.read=function(y){var b=this.state.tensorInfo.get(y);return b.backend.read(y)},v.prototype.time=function(y){return t(this,void 0,void 0,function(){var b,x;return n(this,function(w){switch(w.label){case 0:return b=c.now(),[4,this.backend.time(y)];case 1:return x=w.sent(),x.wallMs=c.now()-b,[2,x]}})})},v.prototype.track=function(y){return this.state.activeScope!=null&&(y.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(y)),y},Object.defineProperty(v.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),v.prototype.reset=function(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new f;for(var y in this.registry)this.disposeRegisteredKernels(y),this.registry[y].dispose(),delete this.registry[y];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},v.nextTensorId=0,v.nextVariableId=0,v}();e.Engine=d;function h(v){var y=c.makeOnesTypedArray(c.sizeFromShape(v),"float32");return e.ENGINE.makeTensor(y,v,"float32")}var p;function g(){if(p==null){var v=void 0;if(typeof window!="undefined")v=window;else if(typeof Ye!="undefined")v=Ye;else if(typeof process!="undefined")v=process;else if(typeof self!="undefined")v=self;else throw new Error("Could not find a global object");p=v}return p}function m(){var v=g();if(v._tfengine==null){var y=new r.Environment(v);v._tfengine=new d(y)}return r.setEnvironmentGlobal(v._tfengine.ENV),s.setTensorTracker(function(){return v._tfengine}),v._tfengine}e.ENGINE=m()})(Xr);var mr={};Object.defineProperty(mr,"__esModule",{value:!0}),mr.Add="Add",mr.AddN="AddN",mr.Div="Div",mr.FusedBatchNorm="FusedBatchNorm",mr.SquaredDifference="SquaredDifference",mr.Square="Square",mr.Transpose="Transpose",mr.NonMaxSuppressionV5="NonMaxSuppressionV5",mr.BroadcastTo="BroadcastTo",mr.OneHot="OneHot",mr.Identity="Identity",mr.Tile="Tile",mr.PadV2="PadV2",mr.FromPixels="FromPixels",mr.MaxPoolWithArgmax="MaxPoolWithArgmax";var Mr={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(Mr,"__esModule",{value:!0});var o8e=Xr,Tte=rv,s8e=kr,Zs=qe;function Ote(e,t){var n=e;if(Zs.isTypedArray(e))return t==="string"?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||Zs.isTypedArray(n)&&t!=="string";)r.push(n.length),n=n[0];return Array.isArray(e)&&Tte.env().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&Ite(e,r,[]),r}Mr.inferShape=Ote;function Ite(e,t,n){if(n=n||[],!Array.isArray(e)&&!Zs.isTypedArray(e)){Zs.assert(t.length===0,function(){return"Element arr["+n.join("][")+"] is a primitive, "+("but should be an array/TypedArray of "+t[0]+" elements")});return}Zs.assert(t.length>0,function(){return"Element arr["+n.join("][")+"] should be a primitive, "+("but is an array of "+e.length+" elements")}),Zs.assert(e.length===t[0],function(){return"Element arr["+n.join("][")+"] should have "+t[0]+" "+("elements, but has "+e.length+" elements")});for(var r=t.slice(1),i=0;i<e.length;++i)Ite(e[i],r,n.concat(i))}function Nte(e,t,n,r){if(e!=null&&(e!=="numeric"&&e!==t||e==="numeric"&&t==="string"))throw new Error("Argument '"+n+"' passed to '"+r+"' must "+("be "+e+" tensor, but got "+t+" tensor"))}function Dte(e,t,n,r){if(r===void 0&&(r="numeric"),e instanceof s8e.Tensor)return Nte(r,e.dtype,t,n),e;var i=Zs.inferDtype(e);if(i!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),Nte(r,i,t,n),e==null||!Zs.isTypedArray(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){var a=e==null?"null":e.constructor.name;throw new Error("Argument '"+t+"' passed to '"+n+"' must be a "+("Tensor or TensorLike, but got '"+a+"'"))}var o=Ote(e,i);!Zs.isTypedArray(e)&&!Array.isArray(e)&&(e=[e]);var s=!0,u=i!=="string"?Zs.toTypedArray(e,i,Tte.env().getBool("DEBUG")):Zs.flatten(e,[],s);return o8e.ENGINE.makeTensor(u,o,i)}Mr.convertToTensor=Dte;function u8e(e,t,n,r){if(r===void 0&&(r="numeric"),!Array.isArray(e))throw new Error("Argument "+t+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");var i=e;return i.map(function(a,o){return Dte(a,t+"["+o+"]",n)},r)}Mr.convertToTensorArray=u8e;var ai={};Object.defineProperty(ai,"__esModule",{value:!0});/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var p$=Xr;function l8e(e){var t=Object.keys(e);if(t.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+(t.length+" keys."));var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var i=function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];p$.ENGINE.startScope(n);try{var s=r.apply(void 0,a);return s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),p$.ENGINE.endScope(s),s}catch(u){throw p$.ENGINE.endScope(null),u}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}ai.op=l8e,Object.defineProperty(nC,"__esModule",{value:!0});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var c8e=Xr,f8e=mr,d8e=us,Rte=Mr,h8e=ai;function p8e(e,t){var n,r=Rte.convertToTensor(e,"a","add"),i=Rte.convertToTensor(t,"b","add");n=d8e.makeTypesMatch(r,i),r=n[0],i=n[1];var a=function(s,u){var l=s.add(r,i);return u([r,i]),l},o={a:r,b:i};return c8e.ENGINE.runKernelFunc(a,o,null,f8e.Add)}nC.add=h8e.op({add_:p8e}),Object.defineProperty(Y6e,"__esModule",{value:!0});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var g8e=nC,m8e=kr;m8e.Tensor.prototype.add=function(e){return g8e.add(this,e)};var v8e={},g$={};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(g$,"__esModule",{value:!0});var y8e=Xr,b8e=mr,x8e=Mr,w8e=ai;function _8e(e,t){var n=x8e.convertToTensor(e,"broadcastTo","x"),r=n.shape;if(t.some(function(p){return!(p>0)||p%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<n.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+n.rank+".");if(t.length>n.rank){for(var i=n.shape.slice();i.length<t.length;)i.unshift(1);n=n.reshape(i)}for(var a=n.shape,o=Array.from(t),s=t.length-1;s>=0;s--)if(a[s]===t[s])o[s]=1;else if(n.shape[s]!==1)throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+t+"].");var u=o.map(function(p,g){return p>1?g:-1}).filter(function(p){return p>=0});if(u.length===0)return n.clone();var l=function(p){return p.tile(n,o)},c=!0,f=function(p){return{x:function(){return p.sum(u,c)}}},d={x:n},h={shape:t,inputShape:a};return y8e.ENGINE.runKernelFunc(l,d,f,b8e.BroadcastTo,h)}g$.broadcastTo=w8e.op({broadcastTo_:_8e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(v8e,"__esModule",{value:!0});var S8e=g$,E8e=kr;E8e.Tensor.prototype.broadcastTo=function(e){return S8e.broadcastTo(this,e)};var C8e={},fC={},oi={},ip={};/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(ip,"__esModule",{value:!0});function A8e(e,t){for(var n=e.length,r=[],i=0;i<n;i++){var a=n-1-i,o=e[a]||1,s=t[t.length-1-i]||1;s>1&&o===1&&r.unshift(a)}return r}ip.getBroadcastDims=A8e;function k8e(e,t){for(var n=[],r=0;r<t.length;r++){var i=e[e.length-r-1],a=t.length-r-1,o=t[a];(i==null||i===1&&o>1)&&n.unshift(a)}return n}ip.getReductionAxes=k8e;function T8e(e,t){for(var n=[],r=Math.max(e.length,t.length),i=0;i<r;i++){var a=e[e.length-i-1];a==null&&(a=1);var o=t[t.length-i-1];if(o==null&&(o=1),a===1)n.unshift(o);else if(o===1)n.unshift(a);else if(a!==o){var s="Operands could not be broadcast together with shapes "+(e+" and "+t+".");throw Error(s)}else n.unshift(a)}return n}ip.assertAndGetBroadcastShape=T8e;var ap={},Zb={};Object.defineProperty(Zb,"__esModule",{value:!0});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var m$=Xr,dC=Mr,O8e=qe,v$=ai;function I8e(e,t){var n=dC.convertToTensor(e,"real","complex"),r=dC.convertToTensor(t,"imag","complex");return O8e.assertShapesMatch(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),m$.ENGINE.runKernelFunc(function(i){return i.complex(n,r)},{$real:n,$imag:r})}function N8e(e){var t=dC.convertToTensor(e,"input","real");return m$.ENGINE.runKernelFunc(function(n){return n.real(t)},{$input:t})}function D8e(e){var t=dC.convertToTensor(e,"input","imag");return m$.ENGINE.runKernelFunc(function(n){return n.imag(t)},{$input:t})}Zb.complex=v$.op({complex_:I8e}),Zb.real=v$.op({real_:N8e}),Zb.imag=v$.op({imag_:D8e}),function(e){/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(e,"__esModule",{value:!0});var t=Xr,n=rv,r=Mr,i=qe,a=Zb,o=ai;function s(_,E,A){var k=r.inferShape(_,A);return u(_,E,k,A)}e.tensor=s;function u(_,E,A,k){if(k==null&&(k=i.inferDtype(_)),k==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!i.isTypedArray(_)&&!Array.isArray(_)&&typeof _!="number"&&typeof _!="boolean"&&typeof _!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(E!=null){i.assertNonNegativeIntegerDimensions(E);var T=i.sizeFromShape(E),I=i.sizeFromShape(A);i.assert(T===I,function(){return"Based on the provided shape, ["+E+"], the tensor should have "+(T+" values but has "+I)});for(var N=0;N<A.length;++N){var O=A[N],D=N===A.length-1?O!==i.sizeFromShape(E.slice(N)):!0;i.assert(A[N]===E[N]||!D,function(){return"Error creating a new Tensor. Inferred shape "+("("+A+") does not match the provided ")+("shape ("+E+"). ")})}}return!i.isTypedArray(_)&&!Array.isArray(_)&&(_=[_]),E=E||A,_=k!=="string"?i.toTypedArray(_,k,n.env().getBool("DEBUG")):i.flatten(_,[],!0),t.ENGINE.makeTensor(_,E,k)}function l(_,E){if((i.isTypedArray(_)&&E!=="string"||Array.isArray(_))&&E!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(E==="string"&&i.isTypedArray(_)&&!(_ instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");var A=[],k=[];return u(_,A,k,E)}e.scalar=l;function c(_,E){i.assertNonNull(_);var A=r.inferShape(_,E);if(A.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");var k=null;return u(_,k,A,E)}e.tensor1d=c;function f(_,E,A){if(i.assertNonNull(_),E!=null&&E.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var k=r.inferShape(_,A);if(k.length!==2&&k.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(k.length===1&&E==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return u(_,E,k,A)}e.tensor2d=f;function d(_,E,A){if(i.assertNonNull(_),E!=null&&E.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var k=r.inferShape(_,A);if(k.length!==3&&k.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(k.length===1&&E==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return u(_,E,k,A)}e.tensor3d=d;function h(_,E,A){if(i.assertNonNull(_),E!=null&&E.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var k=r.inferShape(_,A);if(k.length!==4&&k.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(k.length===1&&E==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return u(_,E,k,A)}e.tensor4d=h;function p(_,E,A){if(i.assertNonNull(_),E!=null&&E.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var k=r.inferShape(_,A);if(k.length!==5&&k.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(k.length===1&&E==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return u(_,E,k,A)}e.tensor5d=p;function g(_,E,A){if(i.assertNonNull(_),E!=null&&E.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var k=r.inferShape(_,A);if(k.length!==6&&k.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(k.length===1&&E==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return E=E||k,u(_,E,k,A)}e.tensor6d=g;function m(_,E,A,k){return E===void 0&&(E=!0),t.ENGINE.makeVariable(_,E,A,k)}e.variable=m;function v(_,E){if(E===void 0&&(E="float32"),E==="complex64"){var A=v(_,"float32"),k=y(_,"float32");return a.complex(A,k)}var T=i.makeOnesTypedArray(i.sizeFromShape(_),E);return t.ENGINE.makeTensor(T,_,E)}e.ones=v;function y(_,E){if(E===void 0&&(E="float32"),E==="complex64"){var A=y(_,"float32"),k=y(_,"float32");return a.complex(A,k)}var T=i.makeZerosTypedArray(i.sizeFromShape(_),E);return t.ENGINE.makeTensor(T,_,E)}e.zeros=y;function b(_,E,A){return t.ENGINE.runKernelFunc(function(k){return k.fill(_,E,A)},{})}e.fill=b;function x(_){var E=r.convertToTensor(_,"x","onesLike");if(E.dtype==="complex64"){var A=e.onesLike(a.real(E)),k=e.zerosLike(a.imag(E));return a.complex(A,k)}var T=function(I,N){return{x:function(){return e.zerosLike(I)}}};return t.ENGINE.runKernelFunc(function(I){return I.onesLike(E)},{x:E},T,"OnesLike")}function w(_){var E=r.convertToTensor(_,"x","zerosLike"),A=function(k,T){return{x:function(){return e.zerosLike(k)}}};return t.ENGINE.runKernelFunc(function(k){return k.zerosLike(E)},{x:E},A,"ZerosLike")}function S(_,E,A){if(A<=0)throw new Error("The number of values should be positive.");return t.ENGINE.runKernelFunc(function(k){return k.linspace(_,E,A)},{})}e.linspace=S;function C(_,E,A,k){if(A===void 0&&(A=1),k===void 0&&(k="float32"),A===0)throw new Error("Cannot have a step of zero");var T=_===E,I=_<E&&A<0,N=E<_&&A>1;if(T||I||N)return y([0],k);var O=Math.abs(Math.ceil((E-_)/A)),D=i.makeZerosTypedArray(O,k);E<_&&A===1&&(A=-1),D[0]=_;for(var L=1;L<D.length;L++)D[L]=D[L-1]+A;return c(D,k)}e.range=C,e.onesLike=o.op({onesLike_:x}),e.zerosLike=o.op({zerosLike_:w})}(ap);var nn={};/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(nn,"__esModule",{value:!0});var on=Xr,fn=Mr,Fte=qe,dn=ai,Ca=ap;function R8e(e){var t=fn.convertToTensor(e,"x","neg"),n=function(a){return{x:function(){return a.neg()}}},r={},i=[t];return on.ENGINE.runKernelFunc(function(a){return a.neg(t)},{x:t},n,"Neg",r,i)}function F8e(e){var t=fn.convertToTensor(e,"x","ceil"),n=function(r){return{$x:function(){return Ca.zerosLike(r)}}};return on.ENGINE.runKernelFunc(function(r){return r.ceil(t)},{$x:t},n)}function M8e(e){var t=fn.convertToTensor(e,"x","floor"),n=function(r){return{$x:function(){return Ca.zerosLike(r)}}};return on.ENGINE.runKernelFunc(function(r){return r.floor(t)},{$x:t},n)}function P8e(e){var t=fn.convertToTensor(e,"x","sign"),n=function(r){return{$x:function(){return Ca.zerosLike(r)}}};return on.ENGINE.runKernelFunc(function(r){return r.sign(t)},{$x:t},n)}function $8e(e){var t=fn.convertToTensor(e,"x","isNaN"),n=function(r){return{$x:function(){return Ca.zerosLike(r)}}};return on.ENGINE.runKernelFunc(function(r){return r.isNaN(t)},{$x:t},n)}function L8e(e){var t=fn.convertToTensor(e,"x","isInf"),n=function(r){return{$x:function(){return Ca.zerosLike(r)}}};return on.ENGINE.runKernelFunc(function(r){return r.isInf(t)},{$x:t},n)}function B8e(e){var t=fn.convertToTensor(e,"x","isFinite"),n=function(r){return{$x:function(){return Ca.zerosLike(r)}}};return on.ENGINE.runKernelFunc(function(r){return r.isFinite(t)},{$x:t},n)}function z8e(e){var t=fn.convertToTensor(e,"x","round"),n=function(r){return{$x:function(){return Ca.zerosLike(r)}}};return on.ENGINE.runKernelFunc(function(r){return r.round(t)},{$x:t},n)}function j8e(e){var t=fn.convertToTensor(e,"x","exp"),n=function(o,s){return{x:function(){return o.mulStrict(s[0])}}},r={},i=[],a=[!0];return on.ENGINE.runKernelFunc(function(o,s){var u=o.exp(t);return s([u]),u},{x:t},n,"Exp",r,i,a)}function U8e(e){var t=fn.convertToTensor(e,"x","expm1"),n=function(r,i){var a=i[0];return{$x:function(){return r.mul(a.exp())}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.expm1(t);return i([t]),a},{$x:t},n)}function W8e(e){var t=fn.convertToTensor(e,"x","log"),n=function(a,o){var s=o[0];return{x:function(){return a.div(s.toFloat())}}},r={},i=[t];return on.ENGINE.runKernelFunc(function(a,o){var s=a.log(t);return o([t]),s},{x:t},n,"Log",r,i)}function V8e(e){var t=fn.convertToTensor(e,"x","log1p"),n=function(r,i){var a=i[0];return{$x:function(){return r.div(a.add(1))}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.log1p(t);return i([t]),a},{$x:t},n)}function q8e(e){var t=fn.convertToTensor(e,"x","sqrt"),n=function(r,i){var a=i[0];return{$x:function(){return r.div(a.toFloat().sqrt().mul(2))}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.sqrt(t);return i([t]),a},{$x:t},n)}function H8e(e){var t=fn.convertToTensor(e,"x","rsqrt"),n=function(i,a){var o=a[0];return{x:function(){return i.div(o.pow(1.5).mul(2)).neg()}}},r=[t];return on.ENGINE.runKernelFunc(function(i,a){var o=i.rsqrt(t);return a([t]),o},{x:t},n,"Rsqrt",{},r)}function G8e(e){var t=fn.convertToTensor(e,"x","reciprocal"),n=function(r,i){var a=i[0];return{$x:function(){return r.div(a.square().neg())}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.reciprocal(t);return i([t]),a},{$x:t},n)}function K8e(e){var t=fn.convertToTensor(e,"x","abs");if(t.dtype==="complex64")return on.ENGINE.runKernelFunc(function(r){return r.complexAbs(t)},{$x:t});var n=function(r,i){var a=i[0];return{x:function(){return r.mul(a.toFloat().step(-1))}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.abs(t);return i([t]),a},{x:t},n,"Abs")}function X8e(e,t,n){var r=fn.convertToTensor(e,"x","clipByValue");Fte.assert(t<=n,function(){return"Error in clip: min ("+t+") must be "+("less than or equal to max ("+n+").")});var i=function(s,u){var l=u[0];return{x:function(){return s.where(l.greaterEqual(t).logicalAnd(l.lessEqual(n)),Ca.zerosLike(s))}}},a=[r],o={min:t,max:n};return on.ENGINE.runKernelFunc(function(s,u){var l=s.clip(r,t,n);return u([r]),l},{x:r},i,"ClipByValue",o,a)}function Y8e(e){var t=fn.convertToTensor(e,"x","sigmoid"),n=function(r,i){var a=i[0];return{x:function(){return r.mul(a.mul(Ca.scalar(1).sub(a)))}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.sigmoid(t);return i([a]),a},{x:t},n,"Sigmoid")}function Z8e(e){var t=fn.convertToTensor(e,"x","logSigmoid"),n=function(r,i){var a=i[0];return{$x:function(){return r.mul(a.neg().sigmoid())}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.softplus(t.neg()).neg();return i([t]),a},{$x:t},n)}function J8e(e){var t=fn.convertToTensor(e,"x","softplus"),n=function(r,i){var a=i[0];return{$x:function(){return r.mul(a.sigmoid())}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.softplus(t);return i([t]),a},{$x:t},n)}function Q8e(e){var t=fn.convertToTensor(e,"x","sin"),n=function(i,a){var o=a[0];return{x:function(){return o.toFloat().cos().mul(i)}}},r=[t];return on.ENGINE.runKernelFunc(function(i,a){var o=i.sin(t);return a([t]),o},{x:t},n,"Sin",{},r)}function e9e(e){var t=fn.convertToTensor(e,"x","cos"),n=function(i,a){var o=a[0];return{x:function(){return o.toFloat().sin().neg().mul(i)}}},r=[t];return on.ENGINE.runKernelFunc(function(i,a){var o=i.cos(t);return a([t]),o},{x:t},n,"Cos",{},r)}function t9e(e){var t=fn.convertToTensor(e,"x","tan"),n=function(r,i){var a=i[0];return{$x:function(){return r.div(a.cos().square())}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.tan(t);return i([t]),a},{$x:t},n)}function n9e(e){var t=fn.convertToTensor(e,"x","asin"),n=function(r,i){var a=i[0];return{$x:function(){return r.divStrict(Ca.scalar(1).sub(a.toFloat().square()).sqrt())}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.asin(t);return i([t]),a},{$x:t},n)}function r9e(e){var t=fn.convertToTensor(e,"x","acos"),n=function(r,i){var a=i[0];return{$x:function(){return r.divStrict(Ca.scalar(1).sub(a.toFloat().square()).sqrt()).neg()}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.acos(t);return i([t]),a},{$x:t},n)}function i9e(e){var t=fn.convertToTensor(e,"x","atan"),n=function(r,i){var a=i[0];return{$x:function(){return r.div(a.toFloat().square().add(1))}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.atan(t);return i([t]),a},{$x:t},n)}function a9e(e){var t=fn.convertToTensor(e,"x","sinh"),n=function(r,i){var a=i[0];return{$x:function(){return a.toFloat().cosh().mulStrict(r)}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.sinh(t);return i([t]),a},{$x:t},n)}function o9e(e){var t=fn.convertToTensor(e,"x","cosh"),n=function(r,i){var a=i[0];return{$x:function(){return a.toFloat().sinh().mulStrict(r)}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.cosh(t);return i([t]),a},{$x:t},n)}function s9e(e){var t=fn.convertToTensor(e,"x","tanh"),n=function(i,a){var o=a[0];return{x:function(){return Ca.scalar(1).sub(o.square()).mulStrict(i)}}},r=[!0];return on.ENGINE.runKernelFunc(function(i,a){var o=i.tanh(t);return a([o]),o},{x:t},n,"Tanh",{},null,r)}function u9e(e){var t=fn.convertToTensor(e,"x","asinh"),n=function(r,i){var a=i[0];return{$x:function(){return r.divStrict(Ca.scalar(1).add(a.toFloat().square()).sqrt())}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.asinh(t);return i([t]),a},{$x:t},n)}function l9e(e){var t=fn.convertToTensor(e,"x","acosh"),n=function(r,i){var a=i[0];return{$x:function(){return r.divStrict(a.toFloat().square().sub(1).sqrt())}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.acosh(t);return i([t]),a},{$x:t},n)}function c9e(e){var t=fn.convertToTensor(e,"x","atanh"),n=function(r,i){var a=i[0];return{$x:function(){return r.div(Ca.scalar(1).sub(a.toFloat().square()))}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.atanh(t);return i([t]),a},{$x:t},n)}function f9e(e){var t=fn.convertToTensor(e,"x","erf");Fte.assert(t.dtype==="int32"||t.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),t.dtype==="int32"&&(t=t.toFloat());var n=function(r,i){var a=i[0];return{$x:function(){return r.mul(a.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}};return on.ENGINE.runKernelFunc(function(r,i){var a=r.erf(t);return i([t]),a},{$x:t},n)}function d9e(e,t){t===void 0&&(t=0);var n=fn.convertToTensor(e,"x","step"),r=function(i){return{$x:function(){return Ca.zerosLike(i)}}};return on.ENGINE.runKernelFunc(function(i){return i.step(n,t)},{$x:n},r)}nn.abs=dn.op({abs_:K8e}),nn.acos=dn.op({acos_:r9e}),nn.acosh=dn.op({acosh_:l9e}),nn.asin=dn.op({asin_:n9e}),nn.asinh=dn.op({asinh_:u9e}),nn.atan=dn.op({atan_:i9e}),nn.atanh=dn.op({atanh_:c9e}),nn.ceil=dn.op({ceil_:F8e}),nn.clipByValue=dn.op({clipByValue_:X8e}),nn.cos=dn.op({cos_:e9e}),nn.cosh=dn.op({cosh_:o9e}),nn.erf=dn.op({erf_:f9e}),nn.exp=dn.op({exp_:j8e}),nn.expm1=dn.op({expm1_:U8e}),nn.floor=dn.op({floor_:M8e}),nn.log=dn.op({log_:W8e}),nn.log1p=dn.op({log1p_:V8e}),nn.logSigmoid=dn.op({logSigmoid_:Z8e}),nn.neg=dn.op({neg_:R8e}),nn.reciprocal=dn.op({reciprocal_:G8e}),nn.round=dn.op({round_:z8e}),nn.rsqrt=dn.op({rsqrt_:H8e}),nn.sigmoid=dn.op({sigmoid_:Y8e}),nn.sign=dn.op({sign_:P8e}),nn.isNaN=dn.op({isNaN_:$8e}),nn.isInf=dn.op({isInf_:L8e}),nn.isFinite=dn.op({isFinite_:B8e}),nn.sin=dn.op({sin_:Q8e}),nn.sinh=dn.op({sinh_:a9e}),nn.softplus=dn.op({softplus_:J8e}),nn.sqrt=dn.op({sqrt_:q8e}),nn.step=dn.op({step_:d9e}),nn.tan=dn.op({tan_:t9e}),nn.tanh=dn.op({tanh_:s9e});/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(oi,"__esModule",{value:!0});var Xf=Xr,Yf=us,xn=Mr,vc=qe,Mte=nC,Yr=ip,Mi=ai,Pte=ap,h9e=nn;function p9e(e,t){var n=xn.convertToTensor(e,"a","addStrict"),r=xn.convertToTensor(t,"b","addStrict");return vc.assertShapesMatch(n.shape,r.shape,"Error in addStrict: "),n.add(r)}function g9e(e,t){var n,r=xn.convertToTensor(e,"a","sub"),i=xn.convertToTensor(t,"b","sub");n=Yf.makeTypesMatch(r,i),r=n[0],i=n[1];var a=Yr.assertAndGetBroadcastShape(r.shape,i.shape),o=function(s){var u=function(){var c=s,f=Yr.getReductionAxes(r.shape,a);return f.length>0&&(c=c.sum(f)),c.reshape(r.shape)},l=function(){var c=s,f=Yr.getReductionAxes(i.shape,a);return f.length>0&&(c=c.sum(f)),c.neg().reshape(i.shape)};return{a:u,b:l}};return Xf.ENGINE.runKernelFunc(function(s){return s.subtract(r,i)},{a:r,b:i},o,"Sub")}function m9e(e,t){var n=xn.convertToTensor(e,"a","subStrict"),r=xn.convertToTensor(t,"b","subStrict");return vc.assertShapesMatch(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}function v9e(e,t){var n,r=xn.convertToTensor(e,"base","pow"),i=xn.convertToTensor(t,"exp","pow");n=Yf.makeTypesMatch(r,i),r=n[0],i=n[1];var a=Yr.assertAndGetBroadcastShape(r.shape,i.shape),o=function(c,f){var d=f[0],h=f[1],p=f[2],g=function(){var v=h.toFloat(),y=c.mul(v.mul(d.pow(v.sub(Pte.scalar(1))))),b=Yr.getReductionAxes(d.shape,a);return b.length>0&&(y=y.sum(b)),y.reshape(d.shape)},m=function(){var v=d.greater(0),y=d.log().where(v,Pte.zerosLike(d)),b=c.mul(p.mul(y)),x=Yr.getReductionAxes(h.shape,a);return x.length>0&&(b=b.sum(x)),b.reshape(h.shape)};return{a:g,b:m}},s={},u=[r,i],l=[!0];return Xf.ENGINE.runKernelFunc(function(c,f){var d=c.pow(r,i);return f([r,i,d]),d},{a:r,b:i},o,"Pow",s,u,l)}function y9e(e,t){return vc.assertShapesMatch(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}function b9e(e,t){var n,r=xn.convertToTensor(e,"a","mul"),i=xn.convertToTensor(t,"b","mul");n=Yf.makeTypesMatch(r,i),r=n[0],i=n[1];var a=Yr.assertAndGetBroadcastShape(r.shape,i.shape),o=function(s,u){var l=u[0],c=u[1],f=function(){var h=s.mul(c.toFloat()),p=Yr.getReductionAxes(l.shape,a);return p.length>0?h.sum(p).reshape(l.shape):h},d=function(){var h=s.mul(l.toFloat()),p=Yr.getReductionAxes(c.shape,a);return p.length>0?h.sum(p).reshape(c.shape):h};return{a:f,b:d}};return Xf.ENGINE.runKernelFunc(function(s,u){var l=s.multiply(r,i);return u([r,i]),l},{a:r,b:i},o,"Mul")}function x9e(e,t){var n=xn.convertToTensor(e,"a","mul"),r=xn.convertToTensor(t,"b","mul");return vc.assertShapesMatch(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}function w9e(e,t){var n,r=xn.convertToTensor(e,"a","floorDiv"),i=xn.convertToTensor(t,"b","floorDiv");n=Yf.makeTypesMatch(r,i),r=n[0],i=n[1];var a=Yr.assertAndGetBroadcastShape(r.shape,i.shape),o=function(s,u){var l=u[0],c=u[1],f=function(){var h=s.div(c.toFloat()),p=Yr.getReductionAxes(l.shape,a);return p.length>0?h.sum(p).reshape(l.shape):h},d=function(){var h=s.mul(l.toFloat()),p=Yr.getReductionAxes(c.shape,a);p.length>0&&(h=h.sum(p).reshape(c.shape));var g=c.square();return h.div(g.toFloat()).neg()};return{a:f,b:d}};return Xf.ENGINE.runKernelFunc(function(s,u){var l=s.floorDiv(r,i);return u([r,i]),l},{a:r,b:i},o,"FloorDiv")}function _9e(e,t){var n=xn.convertToTensor(e,"a","div"),r=xn.convertToTensor(t,"b","div");return vc.assertShapesMatch(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}function S9e(e,t){var n,r=xn.convertToTensor(e,"a","mod"),i=xn.convertToTensor(t,"b","mod");n=Yf.makeTypesMatch(r,i),r=n[0],i=n[1];var a=Yr.assertAndGetBroadcastShape(r.shape,i.shape),o=function(s,u){var l=u[0],c=u[1],f=function(){var h=Yr.getReductionAxes(l.shape,a);return h.length>0?s.sum(h).reshape(l.shape):s},d=function(){var h=s.mul(l.div(c).floor().neg()),p=Yr.getReductionAxes(c.shape,a);return p.length>0?h.sum(p).reshape(c.shape):h};return{$a:f,$b:d}};return Xf.ENGINE.runKernelFunc(function(s,u){var l=s.mod(r,i);return u([r,i]),l},{$a:r,$b:i},o)}function E9e(e,t){var n=xn.convertToTensor(e,"a","modStrict"),r=xn.convertToTensor(t,"b","modStrict");return vc.assertShapesMatch(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}function C9e(e,t){var n,r=xn.convertToTensor(e,"a","minimum"),i=xn.convertToTensor(t,"b","minimum");n=Yf.makeTypesMatch(r,i),r=n[0],i=n[1],r.dtype==="bool"&&(r=r.toInt(),i=i.toInt()),Yr.assertAndGetBroadcastShape(r.shape,i.shape);var a=function(o,s){var u=s[0],l=s[1],c=function(){return o.mul(u.lessEqual(l).toFloat())},f=function(){return o.mul(u.greater(l).toFloat())};return{a:c,b:f}};return Xf.ENGINE.runKernelFunc(function(o,s){var u=o.minimum(r,i);return s([r,i]),u},{a:r,b:i},a,"Minimum")}function A9e(e,t){var n=xn.convertToTensor(e,"a","minimumStrict"),r=xn.convertToTensor(t,"b","minimumStrict");return vc.assertShapesMatch(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}function k9e(e,t){var n,r=xn.convertToTensor(e,"a","maximum"),i=xn.convertToTensor(t,"b","maximum");n=Yf.makeTypesMatch(r,i),r=n[0],i=n[1],r.dtype==="bool"&&(r=r.toInt(),i=i.toInt()),Yr.assertAndGetBroadcastShape(r.shape,i.shape);var a=function(o,s){var u=s[0],l=s[1],c=function(){return o.mul(u.greaterEqual(l).toFloat())},f=function(){return o.mul(u.less(l).toFloat())};return{a:c,b:f}};return Xf.ENGINE.runKernelFunc(function(o,s){var u=o.maximum(r,i);return s([r,i]),u},{a:r,b:i},a,"Maximum")}function T9e(e,t){var n=xn.convertToTensor(e,"a","maximumStrict"),r=xn.convertToTensor(t,"b","maximumStrict");return vc.assertShapesMatch(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}function O9e(e,t){var n=xn.convertToTensor(e,"a","squaredDifferenceStrict"),r=xn.convertToTensor(t,"b","squaredDifferenceStrict");return vc.assertShapesMatch(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}function I9e(e,t){var n,r=xn.convertToTensor(e,"a","atan2"),i=xn.convertToTensor(t,"b","atan2");n=Yf.makeTypesMatch(r,i),r=n[0],i=n[1];var a=Yr.assertAndGetBroadcastShape(r.shape,i.shape),o=function(s,u){var l=u[0],c=u[1],f=function(){var h=Mte.add(l.square(),c.square()),p=s.mul(c.div(h)),g=Yr.getReductionAxes(l.shape,a);return g.length>0&&(p=p.sum(g)),p.reshape(l.shape)},d=function(){var h=Mte.add(l.square(),c.square()),p=h9e.neg(s.mul(l.div(h))),g=Yr.getReductionAxes(c.shape,a);return g.length>0&&(p=p.sum(g)),p.reshape(c.shape)};return{$a:f,$b:d}};return Xf.ENGINE.runKernelFunc(function(s,u){var l=s.atan2(r,i);return u([r,i]),l},{$a:r,$b:i},o)}oi.addStrict=Mi.op({addStrict_:p9e}),oi.atan2=Mi.op({atan2_:I9e}),oi.divStrict=Mi.op({divStrict_:_9e}),oi.floorDiv=Mi.op({floorDiv_:w9e}),oi.maximum=Mi.op({maximum_:k9e}),oi.maximumStrict=Mi.op({maximumStrict_:T9e}),oi.minimum=Mi.op({minimum_:C9e}),oi.minimumStrict=Mi.op({minimumStrict_:A9e}),oi.mod=Mi.op({mod_:S9e}),oi.modStrict=Mi.op({modStrict_:E9e}),oi.mul=Mi.op({mul_:b9e}),oi.mulStrict=Mi.op({mulStrict_:x9e}),oi.pow=Mi.op({pow_:v9e}),oi.powStrict=Mi.op({powStrict_:y9e}),oi.squaredDifferenceStrict=Mi.op({squaredDifferenceStrict_:O9e}),oi.sub=Mi.op({sub_:g9e}),oi.subStrict=Mi.op({subStrict_:m9e});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(fC,"__esModule",{value:!0});var N9e=Xr,D9e=mr,R9e=us,$te=Mr,F9e=oi,M9e=ai;function P9e(e,t){var n,r=$te.convertToTensor(e,"a","div"),i=$te.convertToTensor(t,"b","div");if(n=R9e.makeTypesMatch(r,i),r=n[0],i=n[1],r.dtype==="int32"&&i.dtype==="int32")return F9e.floorDiv(r,i);var a=function(u,l){var c=u.realDivide(r,i);return l([r,i]),c},o={a:r,b:i},s={};return N9e.ENGINE.runKernelFunc(a,o,null,D9e.Div,s)}fC.div=M9e.op({div_:P9e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(C8e,"__esModule",{value:!0});var $9e=fC,L9e=kr;L9e.Tensor.prototype.div=function(e){return $9e.div(this,e)};var B9e={},y$={},Lte={},b$={},Bte={},el={};/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(el,"__esModule",{value:!0});var z9e=qe;function x$(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}el.axesAreInnerMostDims=x$;function zte(e,t,n){for(var r=e.length+t.length,i=[],a=0,o=0,s=0;s<r;s++)n.indexOf(s)===-1?i.push(e[a++]):i.push(t[o++]);return i}el.combineLocations=zte;function j9e(e,t){for(var n=[],r=e.length,i=0;i<r;i++)t.indexOf(i)===-1&&n.push(e[i]);var a=t.map(function(o){return e[o]});return[n,a]}el.computeOutAndReduceShapes=j9e;function U9e(e,t){var n=t.map(function(r){return 1});return zte(e,n,t)}el.expandShapeToKeepDim=U9e;function W9e(e,t,n){z9e.assert(x$(t,n),function(){return e+" supports only inner-most axes for now. "+("Got axes "+t+" and rank-"+n+" input.")})}el.assertAxesAreInnerMostDims=W9e;function V9e(e,t){if(x$(e,t))return null;for(var n=[],r=0;r<t;++r)e.indexOf(r)===-1&&n.push(r);return e.forEach(function(i){return n.push(i)}),n}el.getAxesPermutation=V9e;function q9e(e){return e.map(function(t,n){return[n,t]}).sort(function(t,n){return t[1]-n[1]}).map(function(t){return t[0]})}el.getUndoAxesPermutation=q9e;function H9e(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}el.getInnerMostAxes=H9e;var jte={},hC={};/**
 * @license
 * Copyright 2017 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(hC,"__esModule",{value:!0});var w$=qe;function G9e(e,t){var n=e[0].length;e.forEach(function(i,a){w$.assert(i.length===n,function(){return"Error in concat"+n+"D: rank of tensors["+a+"] must be the same "+("as the rank of the rest ("+n+")")})}),w$.assert(t>=0&&t<n,function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."});var r=e[0];e.forEach(function(i,a){for(var o=0;o<n;o++)w$.assert(o===t||i[o]===r[o],function(){return"Error in concat"+n+"D: Shape of tensors["+a+"] ("+i+") "+("does not match the shape of the rest ("+r+") ")+("along the non-concatenated axis "+a+".")})})}hC.assertParamsConsistent=G9e;function K9e(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}hC.computeOutShape=K9e,function(e){/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(e,"__esModule",{value:!0});var t=Xr,n=Mr,r=qe,i=qe,a=hC,o=ai,s=ap;function u(p){return e.concat(p,0)}function l(p,g){return e.concat(p,g)}function c(p,g){return e.concat(p,g)}function f(p,g){return e.concat(p,g)}function d(p,g){g===void 0&&(g=0),r.assert(p.length>=1,function(){return"Pass at least one tensor to concat"});var m=n.convertToTensorArray(p,"tensors","concat");m[0].dtype==="complex64"&&m.forEach(function(S){if(S.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+S.dtype+". ")}),g=i.parseAxisParam(g,m[0].shape)[0];var v=a.computeOutShape(m.map(function(S){return S.shape}),g);if(r.sizeFromShape(v)===0)return s.tensor([],v);if(m=m.filter(function(S){return S.size>0}),m.length===1)return m[0];var y=m.map(function(S){return S.shape});a.assertParamsConsistent(y,g);var b=function(S){var C=y.map(function(E){return E[g]}),_=e.split(S,C,g);return _.map(function(E){return function(){return E}})},x=m,w={axis:g};return t.ENGINE.runKernelFunc(function(S){return S.concat(m,g)},x,b,"Concat",w)}function h(p,g,m){m===void 0&&(m=0);var v=n.convertToTensor(p,"x","split");m=i.parseAxisParam(m,v.shape)[0];var y;typeof g=="number"?(r.assert(v.shape[m]%g==0,function(){return"Number of splits must evenly divide the axis."}),y=new Array(g).fill(v.shape[m]/g)):(r.assert(v.shape[m]===g.reduce(function(x,w){return x+w}),function(){return"The sum of sizes must match the size of the axis dimension."}),y=g);var b=function(x){return{$x:function(){return e.concat(x,m)}}};return t.ENGINE.runKernelFunc(function(x){return x.split(v,y,m)},{$x:v},b)}e.concat=o.op({concat_:d}),e.concat1d=o.op({concat1d_:u}),e.concat2d=o.op({concat2d_:l}),e.concat3d=o.op({concat3d_:c}),e.concat4d=o.op({concat4d_:f}),e.split=o.op({split_:h})}(jte),function(e){/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var t=Ye&&Ye.__awaiter||function(C,_,E,A){return new(E||(E=Promise))(function(k,T){function I(D){try{O(A.next(D))}catch(L){T(L)}}function N(D){try{O(A.throw(D))}catch(L){T(L)}}function O(D){D.done?k(D.value):new E(function(L){L(D.value)}).then(I,N)}O((A=A.apply(C,_||[])).next())})},n=Ye&&Ye.__generator||function(C,_){var E={label:0,sent:function(){if(T[0]&1)throw T[1];return T[1]},trys:[],ops:[]},A,k,T,I;return I={next:N(0),throw:N(1),return:N(2)},typeof Symbol=="function"&&(I[Symbol.iterator]=function(){return this}),I;function N(D){return function(L){return O([D,L])}}function O(D){if(A)throw new TypeError("Generator is already executing.");for(;E;)try{if(A=1,k&&(T=D[0]&2?k.return:D[0]?k.throw||((T=k.return)&&T.call(k),0):k.next)&&!(T=T.call(k,D[1])).done)return T;switch(k=0,T&&(D=[D[0]&2,T.value]),D[0]){case 0:case 1:T=D;break;case 4:return E.label++,{value:D[1],done:!1};case 5:E.label++,k=D[1],D=[0];continue;case 7:D=E.ops.pop(),E.trys.pop();continue;default:if(T=E.trys,!(T=T.length>0&&T[T.length-1])&&(D[0]===6||D[0]===2)){E=0;continue}if(D[0]===3&&(!T||D[1]>T[0]&&D[1]<T[3])){E.label=D[1];break}if(D[0]===6&&E.label<T[1]){E.label=T[1],T=D;break}if(T&&E.label<T[2]){E.label=T[2],E.ops.push(D);break}T[2]&&E.ops.pop(),E.trys.pop();continue}D=_.call(C,E)}catch(L){D=[6,L],k=0}finally{A=T=0}if(D[0]&5)throw D[1];return{value:D[0]?D[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var r=Xr,i=kr,a=Mr,o=qe,s=el,u=jte,l=ai;function c(C,_){var E=a.convertToTensor(C,"x","reshape",null);_=o.inferFromImplicitShape(_,E.size),o.assert(E.size===o.sizeFromShape(_),function(){return"new shape and old shape must have the same number of elements."});var A=function(T){return{x:function(){return T.reshape(E.shape)}}},k={shape:_};return r.ENGINE.runKernelFunc(function(T){return T.reshape(E,_)},{x:E},A,"Reshape",k)}function f(C,_){var E=a.convertToTensor(C,"x","squeeze");return e.reshape(E,o.squeezeShape(E.shape,_).newShape)}function d(C,_){var E=a.convertToTensor(C,"x","cast");if(!o.isValidDtype(_))throw new Error("Failed to cast to unknown dtype "+_);if(_==="string"&&E.dtype!=="string"||_!=="string"&&E.dtype==="string")throw new Error("Only strings can be casted to strings");var A=function(T){return{x:function(){return T.clone()}}},k={dtype:_};return r.ENGINE.runKernelFunc(function(T){return T.cast(E,_)},{x:E},A,"Cast",k)}function h(C,_){_===void 0&&(_=0);var E=a.convertToTensorArray(C,"tensors","stack");if(o.assert(E.length>=1,function(){return"Pass at least one tensor to tf.stack"}),E.length===1)return E[0].expandDims(_);var A=E[0].rank,k=E[0].shape,T=E[0].dtype;o.assert(_<=A,function(){return"Axis must be <= rank of the tensor"}),E.forEach(function(N){o.assertShapesMatch(k,N.shape,"All tensors passed to stack must have matching shapes")}),E.forEach(function(N){o.assert(T===N.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var I=E.map(function(N){return N.expandDims(_)});return u.concat(I,_)}function p(C,_,E){var A=a.convertToTensor(C,"x","batchToSpaceND"),k=_.reduce(function(I,N){return I*N});o.assert(A.rank>=1+_.length,function(){return"input rank is "+A.rank+" but should be > than blockShape.length "+_.length}),o.assert(E.length===_.length,function(){return"crops.length is "+E.length+" but should be equal to blockShape.length  "+_.length}),o.assert(A.shape[0]%k==0,function(){return"input tensor batch is "+A.shape[0]+" but is not divisible by the product of "+("the elements of blockShape "+_.join(" * ")+" === "+k)});var T=function(I){return{$x:function(){return I.spaceToBatchND(_,E)}}};return r.ENGINE.runKernelFunc(function(I){return I.batchToSpaceND(A,_,E)},{$x:A},T)}function g(C,_,E){var A=a.convertToTensor(C,"x","spaceToBatchND");o.assert(A.rank>=1+_.length,function(){return"input rank "+A.rank+" should be > than [blockShape] "+_.length}),o.assert(E.length===_.length,function(){return"paddings.shape[0] "+E.length+" must be equal to [blockShape] "+_.length}),o.assert(A.shape.reduce(function(T,I,N){return N>0&&N<=_.length?T&&(I+E[N-1][0]+E[N-1][1])%_[N-1]==0:T},!0),function(){return"input spatial dimensions "+A.shape.slice(1)+" with paddings "+E.toString()+" must be divisible by blockShapes "+_.toString()});var k=function(T){return{$x:function(){return T.batchToSpaceND(_,E)}}};return r.ENGINE.runKernelFunc(function(T){return T.spaceToBatchND(A,_,E)},{$x:A},k)}function m(C,_){_===void 0&&(_=0),_=_||0;var E=a.convertToTensor(C,"x","unstack");o.assert(_>=-E.shape.length&&_<E.shape.length,function(){return"Axis = "+_+" is not in [-"+E.shape.length+", "+E.shape.length+")"}),_<0&&(_+=E.shape.length);var A=function(T){return{x:function(){return e.stack(T,_)}}},k={axis:_};return r.ENGINE.runKernelFunc(function(T){return T.unstack(E,_)},{x:E},A,"Unpack",k)}function v(C,_,E,A){_===void 0&&(_=0),E===void 0&&(E=!1),A===void 0&&(A=!1);var k=a.convertToTensor(C,"x","cumsum");_=_|0;var T=s.getAxesPermutation([_],k.rank),I=k;T!=null&&(I=k.transpose(T));var N=s.getInnerMostAxes(1,k.rank)[0],O=function(L){return{permutedX:function(){return L.cumsum(_,E,!A)}}},D=r.ENGINE.runKernelFunc(function(L){return L.cumsum(I,N,E,A)},{permutedX:I},O);return T!=null&&(D=D.transpose(T)),D}function y(C,_){_===void 0&&(_=0);var E=null,A=a.convertToTensor(C,"x","expandDims",E);o.assert(_<=A.rank,function(){return"Axis must be <= rank of the tensor"});var k=A.shape.slice();return _<0&&(o.assert(-(A.rank+1)<=_,function(){return"Axis must be in the interval ["+-(A.rank+1)+", "+A.rank+"]"}),_=A.rank+_+1),k.splice(_,0,1),e.reshape(A,k)}function b(C,_,E){E===void 0&&(E="NHWC");var A=a.convertToTensor(C,"x","depthToSpace"),k=E==="NHWC"?A.shape[1]:A.shape[2],T=E==="NHWC"?A.shape[2]:A.shape[3],I=E==="NHWC"?A.shape[3]:A.shape[1];return o.assert(k*_>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+k+" and "+_+`  for depthToSpace with input shape
      `+A.shape}),o.assert(T*_>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+T+" and "+_+` for depthToSpace with input shape
          `+A.shape}),o.assert(I%(_*_)==0,function(){return"Dimension size must be evenly divisible by "+_*_+" but is "+I+" for depthToSpace with input shape "+A.shape}),r.ENGINE.runKernelFunc(function(N){return N.depthToSpace(A,_,E)},{$x:A})}function x(C,_){return t(this,void 0,void 0,function(){var E,A,k,T,I,N,O,D,L,O,W;return n(this,function(G){switch(G.label){case 0:return E=a.convertToTensor(C,"x","setdiff1d"),A=a.convertToTensor(_,"y","setdiff1d"),o.assert(E.dtype===A.dtype,function(){return"x and y should have the same dtype, but got x ("+E.dtype+") and y ("+A.dtype+")."}),o.assert(E.rank===1,function(){return"x should be 1D tensor, but got x ("+E.shape+")."}),o.assert(A.rank===1,function(){return"y should be 1D tensor, but got y ("+A.shape+")."}),[4,E.data()];case 1:return k=G.sent(),[4,A.data()];case 2:for(T=G.sent(),I=new Set(T),N=0,O=0;O<k.length;O++)I.has(k[O])||N++;for(D=new i.TensorBuffer([N],E.dtype),L=new i.TensorBuffer([N],"int32"),O=0,W=0;O<k.length;O++)I.has(k[O])||(D.values[W]=k[O],L.values[W]=O,W++);return[2,[D.toTensor(),L.toTensor()]]}})})}function w(C,_,E){return _===void 0&&(_="float32"),_=_||"float32",o.assertNonNegativeIntegerDimensions(C),new i.TensorBuffer(C,_,E)}e.buffer=w;function S(C,_){_===void 0&&(_=!1),console.log(C.toString(_))}e.print=S,e.batchToSpaceND=l.op({batchToSpaceND_:p}),e.cast=l.op({cast_:d}),e.cumsum=l.op({cumsum_:v}),e.depthToSpace=l.op({depthToSpace_:b}),e.expandDims=l.op({expandDims_:y}),e.reshape=l.op({reshape_:c}),e.spaceToBatchND=l.op({spaceToBatchND_:g}),e.squeeze=l.op({squeeze_:f}),e.stack=l.op({stack_:h}),e.unstack=l.op({unstack_:m}),e.setdiff1dAsync=x}(Bte);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(b$,"__esModule",{value:!0});var Ute=Bte;function X9e(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);for(var i=Ute.buffer(e,"int32"),a=Ute.buffer([n.length,e.length],"int32"),r=0;r<n.length;r++){var o=i.indexToLoc(n[r]),s=r*e.length;a.values.set(o,s)}return a.toTensor()}b$.whereImpl=X9e,function(e){/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var t=Ye&&Ye.__awaiter||function(m,v,y,b){return new(y||(y=Promise))(function(x,w){function S(E){try{_(b.next(E))}catch(A){w(A)}}function C(E){try{_(b.throw(E))}catch(A){w(A)}}function _(E){E.done?x(E.value):new y(function(A){A(E.value)}).then(S,C)}_((b=b.apply(m,v||[])).next())})},n=Ye&&Ye.__generator||function(m,v){var y={label:0,sent:function(){if(w[0]&1)throw w[1];return w[1]},trys:[],ops:[]},b,x,w,S;return S={next:C(0),throw:C(1),return:C(2)},typeof Symbol=="function"&&(S[Symbol.iterator]=function(){return this}),S;function C(E){return function(A){return _([E,A])}}function _(E){if(b)throw new TypeError("Generator is already executing.");for(;y;)try{if(b=1,x&&(w=E[0]&2?x.return:E[0]?x.throw||((w=x.return)&&w.call(x),0):x.next)&&!(w=w.call(x,E[1])).done)return w;switch(x=0,w&&(E=[E[0]&2,w.value]),E[0]){case 0:case 1:w=E;break;case 4:return y.label++,{value:E[1],done:!1};case 5:y.label++,x=E[1],E=[0];continue;case 7:E=y.ops.pop(),y.trys.pop();continue;default:if(w=y.trys,!(w=w.length>0&&w[w.length-1])&&(E[0]===6||E[0]===2)){y=0;continue}if(E[0]===3&&(!w||E[1]>w[0]&&E[1]<w[3])){y.label=E[1];break}if(E[0]===6&&y.label<w[1]){y.label=w[1],w=E;break}if(w&&y.label<w[2]){y.label=w[2],y.ops.push(E);break}w[2]&&y.ops.pop(),y.trys.pop();continue}E=v.call(m,y)}catch(A){E=[6,A],x=0}finally{b=w=0}if(E[0]&5)throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var r=b$,i=Xr,a=Mr,o=qe,s=ip,u=ai,l=ap;function c(m){var v=a.convertToTensor(m,"x","logicalNot","bool");return i.ENGINE.runKernelFunc(function(y){return y.logicalNot(v)},{$x:v})}function f(m,v){var y=a.convertToTensor(m,"a","logicalAnd","bool"),b=a.convertToTensor(v,"b","logicalAnd","bool");return s.assertAndGetBroadcastShape(y.shape,b.shape),i.ENGINE.runKernelFunc(function(x){return x.logicalAnd(y,b)},{a:y,b},null,"LogicalAnd")}function d(m,v){var y=a.convertToTensor(m,"a","logicalOr","bool"),b=a.convertToTensor(v,"b","logicalOr","bool");return s.assertAndGetBroadcastShape(y.shape,b.shape),i.ENGINE.runKernelFunc(function(x){return x.logicalOr(y,b)},{$a:y,$b:b})}function h(m,v){var y=a.convertToTensor(m,"a","logicalXor","bool"),b=a.convertToTensor(v,"b","logicalXor","bool");return s.assertAndGetBroadcastShape(y.shape,b.shape),e.logicalOr(m,v).logicalAnd(e.logicalAnd(m,v).logicalNot())}function p(m,v,y){var b=a.convertToTensor(v,"a","where"),x=a.convertToTensor(y,"b","where"),w=a.convertToTensor(m,"condition","where","bool");o.assertShapesMatch(b.shape,x.shape,"Error in where: "),w.rank===1?o.assert(w.shape[0]===b.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):o.assertShapesMatch(w.shape,x.shape,"Error in where: ");var S=function(C,_){var E=_[0];return{$condition:function(){return l.zerosLike(E).toFloat()},$a:function(){return C.mul(E.cast(C.dtype))},$b:function(){return C.mul(E.logicalNot().cast(C.dtype))}}};return i.ENGINE.runKernelFunc(function(C,_){var E=C.select(w,b,x);return _([w]),E},{$condition:w,$a:b,$b:x},S)}function g(m){return t(this,void 0,void 0,function(){var v,y,b;return n(this,function(x){switch(x.label){case 0:return v=a.convertToTensor(m,"condition","whereAsync","bool"),[4,v.data()];case 1:return y=x.sent(),b=r.whereImpl(v.shape,y),m!==v&&v.dispose(),[2,b]}})})}e.logicalAnd=u.op({logicalAnd_:f}),e.logicalNot=u.op({logicalNot_:c}),e.logicalOr=u.op({logicalOr_:d}),e.logicalXor=u.op({logicalXor_:h}),e.where=u.op({where_:p}),e.whereAsync=g}(Lte);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(y$,"__esModule",{value:!0});var Y9e=us,Wte=Mr,Z9e=fC,J9e=Lte,Q9e=ai,e7e=ap;function t7e(e,t){var n,r=Wte.convertToTensor(e,"a","div"),i=Wte.convertToTensor(t,"b","div");n=Y9e.makeTypesMatch(r,i),r=n[0],i=n[1];var a=Z9e.div(r,i),o=e7e.zerosLike(a),s=i.equal(o);return J9e.where(s,o,a)}y$.divNoNan=Q9e.op({divNoNan_:t7e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(B9e,"__esModule",{value:!0});var n7e=y$,r7e=kr;r7e.Tensor.prototype.divNoNan=function(e){return n7e.divNoNan(this,e)};var i7e={},_$={};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(_$,"__esModule",{value:!0});var a7e=Xr,o7e=mr,s7e=us,Vte=Mr,u7e=ip,l7e=ai,c7e=ap;function f7e(e,t){var n,r=Vte.convertToTensor(e,"a","squaredDifference"),i=Vte.convertToTensor(t,"b","squaredDifference");n=s7e.makeTypesMatch(r,i),r=n[0],i=n[1],u7e.assertAndGetBroadcastShape(r.shape,i.shape);var a=function(f,d){var h=d[0],p=d[1],g=c7e.scalar(2),m=function(){return f.mul(h.sub(p).mul(g))},v=function(){return f.mul(p.sub(h).mul(g))};return{a:m,b:v}},o=function(f,d){var h=f.squaredDifference(r,i);return d([r,i]),h},s={a:r,b:i},u={},l=[r,i],c=[];return a7e.ENGINE.runKernelFunc(o,s,a,o7e.SquaredDifference,u,l,c)}_$.squaredDifference=l7e.op({squaredDifference_:f7e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(i7e,"__esModule",{value:!0});var d7e=_$,h7e=kr;h7e.Tensor.prototype.squaredDifference=function(e){return d7e.squaredDifference(this,e)};var p7e={},S$={};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(S$,"__esModule",{value:!0});var g7e=Xr,m7e=mr,v7e=Mr,y7e=qe,b7e=ai;function x7e(e,t){var n=null,r=v7e.convertToTensor(e,"x","tile",n);y7e.assert(r.rank===t.length,function(){return"Error in transpose: rank of input "+r.rank+" "+("must match length of reps "+t+".")});var i=function(u,l){var c=u.tile(r,t);return l([r]),c},a=[r],o={x:r},s={reps:t};return g7e.ENGINE.runKernelFunc(i,o,null,m7e.Tile,s,a)}S$.tile=b7e.op({tile_:x7e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(p7e,"__esModule",{value:!0});var w7e=S$,_7e=kr;_7e.Tensor.prototype.tile=function(e){return w7e.tile(this,e)};var S7e={},E$={};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(E$,"__esModule",{value:!0});var E7e=Xr,C7e=mr,A7e=Mr,k7e=ai;function T7e(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var i=A7e.convertToTensor(e,"indices","oneHot","int32"),a=i.shape.concat([t]);i=i.flatten();var o=function(c,f){return f([i]),c.oneHot(i,t,n,r)},s={indices:i},u={depth:t,onValue:n,offValue:r},l=E7e.ENGINE.runKernelFunc(o,s,null,C7e.OneHot,u);return l.reshape(a)}E$.oneHot=k7e.op({oneHot_:T7e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(S7e,"__esModule",{value:!0});var O7e=E$,I7e=kr;I7e.Tensor.prototype.oneHot=function(e,t,n){return t===void 0&&(t=1),n===void 0&&(n=0),O7e.oneHot(this,e,t,n)};var N7e={},C$={};/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(C$,"__esModule",{value:!0});var D7e=Xr,R7e=Mr,qte=qe,F7e=ai;function M7e(e,t){var n=R7e.convertToTensor(e,"x","transpose");if(t==null&&(t=n.shape.map(function(i,a){return a}).reverse()),qte.assert(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" "+("must match length of perm "+t+".")}),t.forEach(function(i){qte.assert(i>=0&&i<n.rank,function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+(" but got "+t)})}),n.rank<=1)return n.clone();var r={perm:t};return D7e.ENGINE.runKernelFunc(function(i){return i.transpose(n,t)},{x:n},null,"Transpose",r)}C$.transpose=F7e.op({transpose_:M7e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(N7e,"__esModule",{value:!0});var P7e=C$,$7e=kr;$7e.Tensor.prototype.transpose=function(e){return P7e.transpose(this,e)};var L7e={},A$={};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(A$,"__esModule",{value:!0});var B7e=Xr,z7e=mr,j7e=Mr,U7e=ai;function W7e(e,t,n){n===void 0&&(n=0);var r=j7e.convertToTensor(e,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var i=function(s,u){return u([r]),s.pad(r,t,n)},a={paddings:t,constantValue:n},o={x:r};return B7e.ENGINE.runKernelFunc(i,o,null,z7e.PadV2,a)}A$.pad=U7e.op({pad_:W7e});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(L7e,"__esModule",{value:!0});var V7e=A$,q7e=kr;q7e.Tensor.prototype.pad=function(e,t){return V7e.pad(this,e,t)};var H7e={},pC={},gC={},vr={};/**
 * @license
 * Copyright 2018 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(vr,"__esModule",{value:!0});var Aa=Xr,Jb=rv,G7e=kr,K7e=us;function X7e(){Jb.env().set("PROD",!0)}vr.enableProdMode=X7e;function Y7e(){Jb.env().set("DEBUG",!0)}vr.enableDebugMode=Y7e;function Z7e(){Jb.env().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}vr.disableDeprecationWarnings=Z7e;function Hte(e){Jb.env().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}vr.deprecationWarn=Hte,G7e.setDeprecationWarningFn(Hte);function J7e(){Aa.ENGINE.disposeVariables()}vr.disposeVariables=J7e;function Q7e(){return Aa.ENGINE}vr.engine=Q7e;function eUe(){return Aa.ENGINE.memory()}vr.memory=eUe;function tUe(e){return Aa.ENGINE.profile(e)}vr.profile=tUe;function nUe(e,t){return Aa.ENGINE.tidy(e,t)}vr.tidy=nUe;function rUe(e){var t=K7e.getTensorsInContainer(e);t.forEach(function(n){return n.dispose()})}vr.dispose=rUe;function iUe(e){return Aa.ENGINE.keep(e)}vr.keep=iUe;function aUe(e){return Aa.ENGINE.time(e)}vr.time=aUe;function oUe(e){return Aa.ENGINE.setBackend(e)}vr.setBackend=oUe;function sUe(){return Aa.ENGINE.ready()}vr.ready=sUe;function uUe(){return Aa.ENGINE.backendName}vr.getBackend=uUe;function lUe(e){Aa.ENGINE.removeBackend(e)}vr.removeBackend=lUe;function cUe(e){return Aa.ENGINE.findBackend(e)}vr.findBackend=cUe;function fUe(e){return Aa.ENGINE.findBackendFactory(e)}vr.findBackendFactory=fUe;function dUe(e,t,n){return n===void 0&&(n=1),Aa.ENGINE.registerBackend(e,t,n)}vr.registerBackend=dUe;function hUe(){return Aa.ENGINE.backend}vr.backend=hUe;function pUe(e,t){Jb.env().setPlatform(e,t)}vr.setPlatform=pUe,Object.defineProperty(gC,"__esModule",{value:!0});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var gUe=vr;function mUe(){gUe.deprecationWarn("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}gC.warnDeprecation=mUe;function vUe(e){var t;return e.rank===0||e.rank===1?t=e.as4D(1,1,1,e.size):e.rank===2?t=e.as4D(1,1,e.shape[0],e.shape[1]):e.rank===3?t=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):t=e,t}gC.xAs4D=vUe;/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(pC,"__esModule",{value:!0});var yUe=Xr,Qb=Mr,k$=qe,Gte=gC,Kte=ai;function bUe(e,t,n,r,i,a){return r===void 0&&(r=.001),Gte.warnDeprecation(),Xte(e,t,n,a,i,r)}function Xte(e,t,n,r,i,a){a==null&&(a=.001);var o=Qb.convertToTensor(e,"x","batchNorm"),s=Qb.convertToTensor(t,"mean","batchNorm"),u=Qb.convertToTensor(n,"variance","batchNorm"),l;i!=null&&(l=Qb.convertToTensor(i,"scale","batchNorm"));var c;r!=null&&(c=Qb.convertToTensor(r,"offset","batchNorm")),k$.assert(s.rank===u.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),k$.assert(c==null||s.rank===c.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),k$.assert(l==null||s.rank===l.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."});var f=function(g,m){var v=Gte.xAs4D(o),y=g.batchNormalization(v,mC(s),mC(u),a,mC(l),mC(c));return m([o,s,u,l]),y},d={x:o,scale:l,offset:c,mean:s,variance:u},h={varianceEpsilon:a},p=yUe.ENGINE.runKernelFunc(f,d,null,"FusedBatchNorm",h);return p.reshape(o.shape)}function mC(e){return e==null?null:e.rank===0?e.as1D():e.rank===1?e:e.rank===2?e.as4D(1,1,e.shape[0],e.shape[1]):e.rank===3?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}pC.batchNormalization=Kte.op({batchNormalization_:bUe}),pC.batchNorm=Kte.op({batchNorm_:Xte}),Object.defineProperty(H7e,"__esModule",{value:!0});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var xUe=pC,wUe=kr;wUe.Tensor.prototype.batchNorm=function(e,t,n,r,i){return xUe.batchNorm(this,e,t,n,r,i)},Object.defineProperty(X6e,"__esModule",{value:!0});var T$={};/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var _Ue=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a])},e(t,n)};return function(t,n){e(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),SUe=Object.prototype.hasOwnProperty;function O$(e,t){return SUe.call(e,t)}function I$(e){if(Array.isArray(e)){for(var n=new Array(e.length),t=0;t<n.length;t++)n[t]=""+t;return n}if(Object.keys)return Object.keys(e);var n=[];for(var r in e)O$(e,r)&&n.push(r);return n}function Lo(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function N$(e){for(var t=0,n=e.length,r;t<n;){if(r=e.charCodeAt(t),r>=48&&r<=57){t++;continue}return!1}return!0}function op(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function Yte(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function D$(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(D$(e[t]))return!0}else if(typeof e=="object"){for(var r=I$(e),i=r.length,t=0;t<i;t++)if(D$(e[r[t]]))return!0}}return!1}function Zte(e,t){var n=[e];for(var r in t){var i=typeof t[r]=="object"?JSON.stringify(t[r],null,2):t[r];typeof i!="undefined"&&n.push(r+": "+i)}return n.join(`
`)}var Jte=function(e){_Ue(t,e);function t(n,r,i,a,o){var s=this.constructor,u=e.call(this,Zte(n,{name:r,index:i,operation:a,tree:o}))||this;return u.name=r,u.index=i,u.operation=a,u.tree=o,Object.setPrototypeOf(u,s.prototype),u.message=Zte(n,{name:r,index:i,operation:a,tree:o}),u}return t}(Error),Pr=Jte,EUe=Lo,ov={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=vC(n,this.path);r&&(r=Lo(r));var i=sp(n,{op:"remove",path:this.from}).removed;return sp(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=vC(n,this.from);return sp(n,{op:"add",path:this.path,value:Lo(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:e1(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},CUe={add:function(e,t,n){return N$(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var r=e.splice(t,1);return{newDocument:n,removed:r[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:ov.move,copy:ov.copy,test:ov.test,_get:ov._get};function vC(e,t){if(t=="")return e;var n={op:"_get",path:t};return sp(e,n),n.value}function sp(e,t,n,r,i,a){if(n===void 0&&(n=!1),r===void 0&&(r=!0),i===void 0&&(i=!0),a===void 0&&(a=0),n&&(typeof n=="function"?n(t,0,e,t.path):bC(t,0)),t.path===""){var o={newDocument:e};if(t.op==="add")return o.newDocument=t.value,o;if(t.op==="replace")return o.newDocument=t.value,o.removed=e,o;if(t.op==="move"||t.op==="copy")return o.newDocument=vC(e,t.from),t.op==="move"&&(o.removed=e),o;if(t.op==="test"){if(o.test=e1(e,t.value),o.test===!1)throw new Pr("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return o.newDocument=e,o}else{if(t.op==="remove")return o.removed=e,o.newDocument=null,o;if(t.op==="_get")return t.value=e,o;if(n)throw new Pr("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",a,t,e);return o}}else{r||(e=Lo(e));var s=t.path||"",u=s.split("/"),l=e,c=1,f=u.length,d=void 0,h=void 0,p=void 0;for(typeof n=="function"?p=n:p=bC;;){if(h=u[c],i&&h=="__proto__")throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&d===void 0&&(l[h]===void 0?d=u.slice(0,c).join("/"):c==f-1&&(d=t.path),d!==void 0&&p(t,0,e,d)),c++,Array.isArray(l)){if(h==="-")h=l.length;else{if(n&&!N$(h))throw new Pr("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a,t,e);N$(h)&&(h=~~h)}if(c>=f){if(n&&t.op==="add"&&h>l.length)throw new Pr("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a,t,e);var o=CUe[t.op].call(t,l,h,e);if(o.test===!1)throw new Pr("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return o}}else if(h&&h.indexOf("~")!=-1&&(h=Yte(h)),c>=f){var o=ov[t.op].call(t,l,h,e);if(o.test===!1)throw new Pr("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return o}l=l[h]}}}function yC(e,t,n,r,i){if(r===void 0&&(r=!0),i===void 0&&(i=!0),n&&!Array.isArray(t))throw new Pr("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=Lo(e));for(var a=new Array(t.length),o=0,s=t.length;o<s;o++)a[o]=sp(e,t[o],n,!0,i,o),e=a[o].newDocument;return a.newDocument=e,a}function AUe(e,t,n){var r=sp(e,t);if(r.test===!1)throw new Pr("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function bC(e,t,n,r){if(typeof e!="object"||e===null||Array.isArray(e))throw new Pr("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(ov[e.op]){if(typeof e.path!="string")throw new Pr("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new Pr('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new Pr("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new Pr("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&D$(e.value))throw new Pr("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var i=e.path.split("/").length,a=r.split("/").length;if(i!==a+1&&i!==a)throw new Pr("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==r)throw new Pr("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var o={op:"_get",path:e.from,value:void 0},s=Qte([o],n);if(s&&s.name==="OPERATION_PATH_UNRESOLVABLE")throw new Pr("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new Pr("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function Qte(e,t,n){try{if(!Array.isArray(e))throw new Pr("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)yC(Lo(t),Lo(e),n||!0);else{n=n||bC;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(i){if(i instanceof Pr)return i;throw i}}function e1(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),r=Array.isArray(t),i,a,o;if(n&&r){if(a=e.length,a!=t.length)return!1;for(i=a;i--!=0;)if(!e1(e[i],t[i]))return!1;return!0}if(n!=r)return!1;var s=Object.keys(e);if(a=s.length,a!==Object.keys(t).length)return!1;for(i=a;i--!=0;)if(!t.hasOwnProperty(s[i]))return!1;for(i=a;i--!=0;)if(o=s[i],!e1(e[o],t[o]))return!1;return!0}return e!==e&&t!==t}var kUe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",JsonPatchError:Pr,deepClone:EUe,getValueByPointer:vC,applyOperation:sp,applyPatch:yC,applyReducer:AUe,validator:bC,validate:Qte,_areEquals:e1});/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var R$=new WeakMap,TUe=function(){function e(t){this.observers=new Map,this.obj=t}return e}(),OUe=function(){function e(t,n){this.callback=t,this.observer=n}return e}();function IUe(e){return R$.get(e)}function NUe(e,t){return e.observers.get(t)}function DUe(e,t){e.observers.delete(t.callback)}function RUe(e,t){t.unobserve()}function FUe(e,t){var n=[],r,i=IUe(e);if(!i)i=new TUe(e),R$.set(e,i);else{var a=NUe(i,t);r=a&&a.observer}if(r)return r;if(r={},i.value=Lo(e),t){r.callback=t,r.next=null;var o=function(){F$(r)},s=function(){clearTimeout(r.next),r.next=setTimeout(o)};typeof window!="undefined"&&(window.addEventListener("mouseup",s),window.addEventListener("keyup",s),window.addEventListener("mousedown",s),window.addEventListener("keydown",s),window.addEventListener("change",s))}return r.patches=n,r.object=e,r.unobserve=function(){F$(r),clearTimeout(r.next),DUe(i,r),typeof window!="undefined"&&(window.removeEventListener("mouseup",s),window.removeEventListener("keyup",s),window.removeEventListener("mousedown",s),window.removeEventListener("keydown",s),window.removeEventListener("change",s))},i.observers.set(t,new OUe(t,r)),r}function F$(e,t){t===void 0&&(t=!1);var n=R$.get(e.object);M$(n.value,e.object,e.patches,"",t),e.patches.length&&yC(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function M$(e,t,n,r,i){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var a=I$(t),o=I$(e),s=!1,u=o.length-1;u>=0;u--){var l=o[u],c=e[l];if(O$(t,l)&&!(t[l]===void 0&&c!==void 0&&Array.isArray(t)===!1)){var f=t[l];typeof c=="object"&&c!=null&&typeof f=="object"&&f!=null?M$(c,f,n,r+"/"+op(l),i):c!==f&&(i&&n.push({op:"test",path:r+"/"+op(l),value:Lo(c)}),n.push({op:"replace",path:r+"/"+op(l),value:Lo(f)}))}else Array.isArray(e)===Array.isArray(t)?(i&&n.push({op:"test",path:r+"/"+op(l),value:Lo(c)}),n.push({op:"remove",path:r+"/"+op(l)}),s=!0):(i&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}))}if(!(!s&&a.length==o.length))for(var u=0;u<a.length;u++){var l=a[u];!O$(e,l)&&t[l]!==void 0&&n.push({op:"add",path:r+"/"+op(l),value:Lo(t[l])})}}}function MUe(e,t,n){n===void 0&&(n=!1);var r=[];return M$(e,t,r,"",n),r}var PUe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",unobserve:RUe,observe:FUe,generate:F$,compare:MUe});Object.assign({},kUe,PUe,{JsonPatchError:Jte,deepClone:Lo,escapePathComponent:op,unescapePathComponent:Yte});var $Ue=/("(?:[^\\"]|\\.)*")|[:,]/g,P$=function(t,n){var r,i,a;return n=n||{},r=JSON.stringify([1],void 0,n.indent===void 0?2:n.indent).slice(2,-3),i=r===""?1/0:n.maxLength===void 0?80:n.maxLength,a=n.replacer,function o(s,u,l){var c,f,d,h,p,g,m,v,y,b,x,w;if(s&&typeof s.toJSON=="function"&&(s=s.toJSON()),x=JSON.stringify(s,a),x===void 0)return x;if(m=i-u.length-l,x.length<=m&&(y=x.replace($Ue,function(S,C){return C||S+" "}),y.length<=m))return y;if(a!=null&&(s=JSON.parse(x),a=void 0),typeof s=="object"&&s!==null){if(v=u+r,d=[],f=0,Array.isArray(s))for(b="[",c="]",m=s.length;f<m;f++)d.push(o(s[f],v,f===m-1?0:1)||"null");else for(b="{",c="}",g=Object.keys(s),m=g.length;f<m;f++)h=g[f],p=JSON.stringify(h)+": ",w=o(s[h],v,p.length+(f===m-1?0:1)),w!==void 0&&d.push(p+w);if(d.length>0)return[b,r+d.join(`,
`+v),c].join(`
`+u)}return x}(t,"",0)},Zf={exports:{}};const LUe="2.0.0",BUe=256,zUe=Number.MAX_SAFE_INTEGER||9007199254740991,jUe=16;var xC={SEMVER_SPEC_VERSION:LUe,MAX_LENGTH:BUe,MAX_SAFE_INTEGER:zUe,MAX_SAFE_COMPONENT_LENGTH:jUe};const UUe=typeof process=="object"&&process.env&&{}.NODE_DEBUG&&/\bsemver\b/i.test({}.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};var wC=UUe;(function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:n}=xC,r=wC;t=e.exports={};const i=t.re=[],a=t.src=[],o=t.t={};let s=0;const u=(l,c,f)=>{const d=s++;r(d,c),o[l]=d,a[d]=c,i[d]=new RegExp(c,f?"g":void 0)};u("NUMERICIDENTIFIER","0|[1-9]\\d*"),u("NUMERICIDENTIFIERLOOSE","[0-9]+"),u("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),u("MAINVERSION",`(${a[o.NUMERICIDENTIFIER]})\\.(${a[o.NUMERICIDENTIFIER]})\\.(${a[o.NUMERICIDENTIFIER]})`),u("MAINVERSIONLOOSE",`(${a[o.NUMERICIDENTIFIERLOOSE]})\\.(${a[o.NUMERICIDENTIFIERLOOSE]})\\.(${a[o.NUMERICIDENTIFIERLOOSE]})`),u("PRERELEASEIDENTIFIER",`(?:${a[o.NUMERICIDENTIFIER]}|${a[o.NONNUMERICIDENTIFIER]})`),u("PRERELEASEIDENTIFIERLOOSE",`(?:${a[o.NUMERICIDENTIFIERLOOSE]}|${a[o.NONNUMERICIDENTIFIER]})`),u("PRERELEASE",`(?:-(${a[o.PRERELEASEIDENTIFIER]}(?:\\.${a[o.PRERELEASEIDENTIFIER]})*))`),u("PRERELEASELOOSE",`(?:-?(${a[o.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${a[o.PRERELEASEIDENTIFIERLOOSE]})*))`),u("BUILDIDENTIFIER","[0-9A-Za-z-]+"),u("BUILD",`(?:\\+(${a[o.BUILDIDENTIFIER]}(?:\\.${a[o.BUILDIDENTIFIER]})*))`),u("FULLPLAIN",`v?${a[o.MAINVERSION]}${a[o.PRERELEASE]}?${a[o.BUILD]}?`),u("FULL",`^${a[o.FULLPLAIN]}$`),u("LOOSEPLAIN",`[v=\\s]*${a[o.MAINVERSIONLOOSE]}${a[o.PRERELEASELOOSE]}?${a[o.BUILD]}?`),u("LOOSE",`^${a[o.LOOSEPLAIN]}$`),u("GTLT","((?:<|>)?=?)"),u("XRANGEIDENTIFIERLOOSE",`${a[o.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),u("XRANGEIDENTIFIER",`${a[o.NUMERICIDENTIFIER]}|x|X|\\*`),u("XRANGEPLAIN",`[v=\\s]*(${a[o.XRANGEIDENTIFIER]})(?:\\.(${a[o.XRANGEIDENTIFIER]})(?:\\.(${a[o.XRANGEIDENTIFIER]})(?:${a[o.PRERELEASE]})?${a[o.BUILD]}?)?)?`),u("XRANGEPLAINLOOSE",`[v=\\s]*(${a[o.XRANGEIDENTIFIERLOOSE]})(?:\\.(${a[o.XRANGEIDENTIFIERLOOSE]})(?:\\.(${a[o.XRANGEIDENTIFIERLOOSE]})(?:${a[o.PRERELEASELOOSE]})?${a[o.BUILD]}?)?)?`),u("XRANGE",`^${a[o.GTLT]}\\s*${a[o.XRANGEPLAIN]}$`),u("XRANGELOOSE",`^${a[o.GTLT]}\\s*${a[o.XRANGEPLAINLOOSE]}$`),u("COERCE",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?(?:$|[^\\d])`),u("COERCERTL",a[o.COERCE],!0),u("LONETILDE","(?:~>?)"),u("TILDETRIM",`(\\s*)${a[o.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",u("TILDE",`^${a[o.LONETILDE]}${a[o.XRANGEPLAIN]}$`),u("TILDELOOSE",`^${a[o.LONETILDE]}${a[o.XRANGEPLAINLOOSE]}$`),u("LONECARET","(?:\\^)"),u("CARETTRIM",`(\\s*)${a[o.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",u("CARET",`^${a[o.LONECARET]}${a[o.XRANGEPLAIN]}$`),u("CARETLOOSE",`^${a[o.LONECARET]}${a[o.XRANGEPLAINLOOSE]}$`),u("COMPARATORLOOSE",`^${a[o.GTLT]}\\s*(${a[o.LOOSEPLAIN]})$|^$`),u("COMPARATOR",`^${a[o.GTLT]}\\s*(${a[o.FULLPLAIN]})$|^$`),u("COMPARATORTRIM",`(\\s*)${a[o.GTLT]}\\s*(${a[o.LOOSEPLAIN]}|${a[o.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",u("HYPHENRANGE",`^\\s*(${a[o.XRANGEPLAIN]})\\s+-\\s+(${a[o.XRANGEPLAIN]})\\s*$`),u("HYPHENRANGELOOSE",`^\\s*(${a[o.XRANGEPLAINLOOSE]})\\s+-\\s+(${a[o.XRANGEPLAINLOOSE]})\\s*$`),u("STAR","(<|>)?=?\\s*\\*"),u("GTE0","^\\s*>=\\s*0.0.0\\s*$"),u("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")})(Zf,Zf.exports);const WUe=["includePrerelease","loose","rtl"],VUe=e=>e?typeof e!="object"?{loose:!0}:WUe.filter(t=>e[t]).reduce((t,n)=>(t[n]=!0,t),{}):{};var _C=VUe;const ene=/^[0-9]+$/,tne=(e,t)=>{const n=ene.test(e),r=ene.test(t);return n&&r&&(e=+e,t=+t),e===t?0:n&&!r?-1:r&&!n?1:e<t?-1:1},qUe=(e,t)=>tne(t,e);var $$={compareIdentifiers:tne,rcompareIdentifiers:qUe};const SC=wC,{MAX_LENGTH:nne,MAX_SAFE_INTEGER:EC}=xC,{re:rne,t:ine}=Zf.exports,HUe=_C,{compareIdentifiers:t1}=$$;class Js{constructor(t,n){if(n=HUe(n),t instanceof Js){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid Version: ${t}`);if(t.length>nne)throw new TypeError(`version is longer than ${nne} characters`);SC("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;const r=t.trim().match(n.loose?rne[ine.LOOSE]:rne[ine.FULL]);if(!r)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>EC||this.major<0)throw new TypeError("Invalid major version");if(this.minor>EC||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>EC||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){const a=+i;if(a>=0&&a<EC)return a}return i}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(SC("SemVer.compare",this.version,this.options,t),!(t instanceof Js)){if(typeof t=="string"&&t===this.version)return 0;t=new Js(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof Js||(t=new Js(t,this.options)),t1(this.major,t.major)||t1(this.minor,t.minor)||t1(this.patch,t.patch)}comparePre(t){if(t instanceof Js||(t=new Js(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let n=0;do{const r=this.prerelease[n],i=t.prerelease[n];if(SC("prerelease compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return t1(r,i)}while(++n)}compareBuild(t){t instanceof Js||(t=new Js(t,this.options));let n=0;do{const r=this.build[n],i=t.build[n];if(SC("prerelease compare",n,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return t1(r,i)}while(++n)}inc(t,n){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n),this.inc("pre",n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",n),this.inc("pre",n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{let r=this.prerelease.length;for(;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);r===-1&&this.prerelease.push(0)}n&&(this.prerelease[0]===n?isNaN(this.prerelease[1])&&(this.prerelease=[n,0]):this.prerelease=[n,0]);break;default:throw new Error(`invalid increment argument: ${t}`)}return this.format(),this.raw=this.version,this}}var ka=Js;const{MAX_LENGTH:GUe}=xC,{re:ane,t:one}=Zf.exports,sne=ka,KUe=_C,XUe=(e,t)=>{if(t=KUe(t),e instanceof sne)return e;if(typeof e!="string"||e.length>GUe||!(t.loose?ane[one.LOOSE]:ane[one.FULL]).test(e))return null;try{return new sne(e,t)}catch(r){return null}};var sv=XUe;const YUe=sv,ZUe=(e,t)=>{const n=YUe(e,t);return n?n.version:null};var JUe=ZUe;const QUe=sv,eWe=(e,t)=>{const n=QUe(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null};var tWe=eWe;const nWe=ka,rWe=(e,t,n,r)=>{typeof n=="string"&&(r=n,n=void 0);try{return new nWe(e,n).inc(t,r).version}catch(i){return null}};var iWe=rWe;const une=ka,aWe=(e,t,n)=>new une(e,n).compare(new une(t,n));var Qs=aWe;const oWe=Qs,sWe=(e,t,n)=>oWe(e,t,n)===0;var L$=sWe;const lne=sv,uWe=L$,lWe=(e,t)=>{if(uWe(e,t))return null;{const n=lne(e),r=lne(t),i=n.prerelease.length||r.prerelease.length,a=i?"pre":"",o=i?"prerelease":"";for(const s in n)if((s==="major"||s==="minor"||s==="patch")&&n[s]!==r[s])return a+s;return o}};var cWe=lWe;const fWe=ka,dWe=(e,t)=>new fWe(e,t).major;var hWe=dWe;const pWe=ka,gWe=(e,t)=>new pWe(e,t).minor;var mWe=gWe;const vWe=ka,yWe=(e,t)=>new vWe(e,t).patch;var bWe=yWe;const xWe=sv,wWe=(e,t)=>{const n=xWe(e,t);return n&&n.prerelease.length?n.prerelease:null};var _We=wWe;const SWe=Qs,EWe=(e,t,n)=>SWe(t,e,n);var CWe=EWe;const AWe=Qs,kWe=(e,t)=>AWe(e,t,!0);var TWe=kWe;const cne=ka,OWe=(e,t,n)=>{const r=new cne(e,n),i=new cne(t,n);return r.compare(i)||r.compareBuild(i)};var B$=OWe;const IWe=B$,NWe=(e,t)=>e.sort((n,r)=>IWe(n,r,t));var DWe=NWe;const RWe=B$,FWe=(e,t)=>e.sort((n,r)=>RWe(r,n,t));var MWe=FWe;const PWe=Qs,$We=(e,t,n)=>PWe(e,t,n)>0;var CC=$We;const LWe=Qs,BWe=(e,t,n)=>LWe(e,t,n)<0;var z$=BWe;const zWe=Qs,jWe=(e,t,n)=>zWe(e,t,n)!==0;var fne=jWe;const UWe=Qs,WWe=(e,t,n)=>UWe(e,t,n)>=0;var j$=WWe;const VWe=Qs,qWe=(e,t,n)=>VWe(e,t,n)<=0;var U$=qWe;const HWe=L$,GWe=fne,KWe=CC,XWe=j$,YWe=z$,ZWe=U$,JWe=(e,t,n,r)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e===n;case"!==":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e!==n;case"":case"=":case"==":return HWe(e,n,r);case"!=":return GWe(e,n,r);case">":return KWe(e,n,r);case">=":return XWe(e,n,r);case"<":return YWe(e,n,r);case"<=":return ZWe(e,n,r);default:throw new TypeError(`Invalid operator: ${t}`)}};var dne=JWe;const QWe=ka,eVe=sv,{re:AC,t:kC}=Zf.exports,tVe=(e,t)=>{if(e instanceof QWe)return e;if(typeof e=="number"&&(e=String(e)),typeof e!="string")return null;t=t||{};let n=null;if(!t.rtl)n=e.match(AC[kC.COERCE]);else{let r;for(;(r=AC[kC.COERCERTL].exec(e))&&(!n||n.index+n[0].length!==e.length);)(!n||r.index+r[0].length!==n.index+n[0].length)&&(n=r),AC[kC.COERCERTL].lastIndex=r.index+r[1].length+r[2].length;AC[kC.COERCERTL].lastIndex=-1}return n===null?null:eVe(`${n[2]}.${n[3]||"0"}.${n[4]||"0"}`,t)};var nVe=tVe,rVe=function(e){e.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}},iVe=wn;wn.Node=up,wn.create=wn;function wn(e){var t=this;if(t instanceof wn||(t=new wn),t.tail=null,t.head=null,t.length=0,e&&typeof e.forEach=="function")e.forEach(function(i){t.push(i)});else if(arguments.length>0)for(var n=0,r=arguments.length;n<r;n++)t.push(arguments[n]);return t}wn.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t},wn.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},wn.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},wn.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)oVe(this,arguments[e]);return this.length},wn.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)sVe(this,arguments[e]);return this.length},wn.prototype.pop=function(){if(!!this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},wn.prototype.shift=function(){if(!!this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},wn.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,r=0;n!==null;r++)e.call(t,n.value,r,this),n=n.next},wn.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,r=this.length-1;n!==null;r--)e.call(t,n.value,r,this),n=n.prev},wn.prototype.get=function(e){for(var t=0,n=this.head;n!==null&&t<e;t++)n=n.next;if(t===e&&n!==null)return n.value},wn.prototype.getReverse=function(e){for(var t=0,n=this.tail;n!==null&&t<e;t++)n=n.prev;if(t===e&&n!==null)return n.value},wn.prototype.map=function(e,t){t=t||this;for(var n=new wn,r=this.head;r!==null;)n.push(e.call(t,r.value,this)),r=r.next;return n},wn.prototype.mapReverse=function(e,t){t=t||this;for(var n=new wn,r=this.tail;r!==null;)n.push(e.call(t,r.value,this)),r=r.prev;return n},wn.prototype.reduce=function(e,t){var n,r=this.head;if(arguments.length>1)n=t;else if(this.head)r=this.head.next,n=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=0;r!==null;i++)n=e(n,r.value,i),r=r.next;return n},wn.prototype.reduceReverse=function(e,t){var n,r=this.tail;if(arguments.length>1)n=t;else if(this.tail)r=this.tail.prev,n=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;r!==null;i--)n=e(n,r.value,i),r=r.prev;return n},wn.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;n!==null;t++)e[t]=n.value,n=n.next;return e},wn.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;n!==null;t++)e[t]=n.value,n=n.prev;return e},wn.prototype.slice=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new wn;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=0,i=this.head;i!==null&&r<e;r++)i=i.next;for(;i!==null&&r<t;r++,i=i.next)n.push(i.value);return n},wn.prototype.sliceReverse=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new wn;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=this.length,i=this.tail;i!==null&&r>t;r--)i=i.prev;for(;i!==null&&r>e;r--,i=i.prev)n.push(i.value);return n},wn.prototype.splice=function(e,t,...n){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var r=0,i=this.head;i!==null&&r<e;r++)i=i.next;for(var a=[],r=0;i&&r<t;r++)a.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var r=0;r<n.length;r++)i=aVe(this,i,n[r]);return a},wn.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;n!==null;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=t,this.tail=e,this};function aVe(e,t,n){var r=t===e.head?new up(n,null,t,e):new up(n,t,t.next,e);return r.next===null&&(e.tail=r),r.prev===null&&(e.head=r),e.length++,r}function oVe(e,t){e.tail=new up(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function sVe(e,t){e.head=new up(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function up(e,t,n,r){if(!(this instanceof up))return new up(e,t,n,r);this.list=r,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}try{rVe(wn)}catch(e){}const uVe=iVe,lp=Symbol("max"),yc=Symbol("length"),uv=Symbol("lengthCalculator"),n1=Symbol("allowStale"),cp=Symbol("maxAge"),bc=Symbol("dispose"),hne=Symbol("noDisposeOnSet"),bi=Symbol("lruList"),eu=Symbol("cache"),pne=Symbol("updateAgeOnGet"),W$=()=>1;class lVe{constructor(t){if(typeof t=="number"&&(t={max:t}),t||(t={}),t.max&&(typeof t.max!="number"||t.max<0))throw new TypeError("max must be a non-negative number");this[lp]=t.max||1/0;const n=t.length||W$;if(this[uv]=typeof n!="function"?W$:n,this[n1]=t.stale||!1,t.maxAge&&typeof t.maxAge!="number")throw new TypeError("maxAge must be a number");this[cp]=t.maxAge||0,this[bc]=t.dispose,this[hne]=t.noDisposeOnSet||!1,this[pne]=t.updateAgeOnGet||!1,this.reset()}set max(t){if(typeof t!="number"||t<0)throw new TypeError("max must be a non-negative number");this[lp]=t||1/0,r1(this)}get max(){return this[lp]}set allowStale(t){this[n1]=!!t}get allowStale(){return this[n1]}set maxAge(t){if(typeof t!="number")throw new TypeError("maxAge must be a non-negative number");this[cp]=t,r1(this)}get maxAge(){return this[cp]}set lengthCalculator(t){typeof t!="function"&&(t=W$),t!==this[uv]&&(this[uv]=t,this[yc]=0,this[bi].forEach(n=>{n.length=this[uv](n.value,n.key),this[yc]+=n.length})),r1(this)}get lengthCalculator(){return this[uv]}get length(){return this[yc]}get itemCount(){return this[bi].length}rforEach(t,n){n=n||this;for(let r=this[bi].tail;r!==null;){const i=r.prev;gne(this,t,r,n),r=i}}forEach(t,n){n=n||this;for(let r=this[bi].head;r!==null;){const i=r.next;gne(this,t,r,n),r=i}}keys(){return this[bi].toArray().map(t=>t.key)}values(){return this[bi].toArray().map(t=>t.value)}reset(){this[bc]&&this[bi]&&this[bi].length&&this[bi].forEach(t=>this[bc](t.key,t.value)),this[eu]=new Map,this[bi]=new uVe,this[yc]=0}dump(){return this[bi].map(t=>TC(this,t)?!1:{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[bi]}set(t,n,r){if(r=r||this[cp],r&&typeof r!="number")throw new TypeError("maxAge must be a number");const i=r?Date.now():0,a=this[uv](n,t);if(this[eu].has(t)){if(a>this[lp])return lv(this,this[eu].get(t)),!1;const u=this[eu].get(t).value;return this[bc]&&(this[hne]||this[bc](t,u.value)),u.now=i,u.maxAge=r,u.value=n,this[yc]+=a-u.length,u.length=a,this.get(t),r1(this),!0}const o=new cVe(t,n,a,i,r);return o.length>this[lp]?(this[bc]&&this[bc](t,n),!1):(this[yc]+=o.length,this[bi].unshift(o),this[eu].set(t,this[bi].head),r1(this),!0)}has(t){if(!this[eu].has(t))return!1;const n=this[eu].get(t).value;return!TC(this,n)}get(t){return V$(this,t,!0)}peek(t){return V$(this,t,!1)}pop(){const t=this[bi].tail;return t?(lv(this,t),t.value):null}del(t){lv(this,this[eu].get(t))}load(t){this.reset();const n=Date.now();for(let r=t.length-1;r>=0;r--){const i=t[r],a=i.e||0;if(a===0)this.set(i.k,i.v);else{const o=a-n;o>0&&this.set(i.k,i.v,o)}}}prune(){this[eu].forEach((t,n)=>V$(this,n,!1))}}const V$=(e,t,n)=>{const r=e[eu].get(t);if(r){const i=r.value;if(TC(e,i)){if(lv(e,r),!e[n1])return}else n&&(e[pne]&&(r.value.now=Date.now()),e[bi].unshiftNode(r));return i.value}},TC=(e,t)=>{if(!t||!t.maxAge&&!e[cp])return!1;const n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[cp]&&n>e[cp]},r1=e=>{if(e[yc]>e[lp])for(let t=e[bi].tail;e[yc]>e[lp]&&t!==null;){const n=t.prev;lv(e,t),t=n}},lv=(e,t)=>{if(t){const n=t.value;e[bc]&&e[bc](n.key,n.value),e[yc]-=n.length,e[eu].delete(n.key),e[bi].removeNode(t)}};class cVe{constructor(t,n,r,i,a){this.key=t,this.value=n,this.length=r,this.now=i,this.maxAge=a||0}}const gne=(e,t,n,r)=>{let i=n.value;TC(e,i)&&(lv(e,n),e[n1]||(i=void 0)),i&&t.call(r,i.value,i.key,e)};var fVe=lVe;class i1{constructor(t,n){if(n=hVe(n),t instanceof i1)return t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease?t:new i1(t.raw,n);if(t instanceof q$)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease,this.raw=t,this.set=t.split(/\s*\|\|\s*/).map(r=>this.parseRange(r.trim())).filter(r=>r.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${t}`);if(this.set.length>1){const r=this.set[0];if(this.set=this.set.filter(i=>!vne(i[0])),this.set.length===0)this.set=[r];else if(this.set.length>1){for(const i of this.set)if(i.length===1&&yVe(i[0])){this.set=[i];break}}}this.format()}format(){return this.range=this.set.map(t=>t.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(t){t=t.trim();const r=`parseRange:${Object.keys(this.options).join(",")}:${t}`,i=mne.get(r);if(i)return i;const a=this.options.loose,o=a?Xi[Pi.HYPHENRANGELOOSE]:Xi[Pi.HYPHENRANGE];t=t.replace(o,TVe(this.options.includePrerelease)),$r("hyphen replace",t),t=t.replace(Xi[Pi.COMPARATORTRIM],gVe),$r("comparator trim",t,Xi[Pi.COMPARATORTRIM]),t=t.replace(Xi[Pi.TILDETRIM],mVe),t=t.replace(Xi[Pi.CARETTRIM],vVe),t=t.split(/\s+/).join(" ");const s=a?Xi[Pi.COMPARATORLOOSE]:Xi[Pi.COMPARATOR],u=t.split(" ").map(f=>bVe(f,this.options)).join(" ").split(/\s+/).map(f=>kVe(f,this.options)).filter(this.options.loose?f=>!!f.match(s):()=>!0).map(f=>new q$(f,this.options));u.length;const l=new Map;for(const f of u){if(vne(f))return[f];l.set(f.value,f)}l.size>1&&l.has("")&&l.delete("");const c=[...l.values()];return mne.set(r,c),c}intersects(t,n){if(!(t instanceof i1))throw new TypeError("a Range is required");return this.set.some(r=>yne(r,n)&&t.set.some(i=>yne(i,n)&&r.every(a=>i.every(o=>a.intersects(o,n)))))}test(t){if(!t)return!1;if(typeof t=="string")try{t=new pVe(t,this.options)}catch(n){return!1}for(let n=0;n<this.set.length;n++)if(OVe(this.set[n],t,this.options))return!0;return!1}}var tu=i1;const dVe=fVe,mne=new dVe({max:1e3}),hVe=_C,q$=IC,$r=wC,pVe=ka,{re:Xi,t:Pi,comparatorTrimReplace:gVe,tildeTrimReplace:mVe,caretTrimReplace:vVe}=Zf.exports,vne=e=>e.value==="<0.0.0-0",yVe=e=>e.value==="",yne=(e,t)=>{let n=!0;const r=e.slice();let i=r.pop();for(;n&&r.length;)n=r.every(a=>i.intersects(a,t)),i=r.pop();return n},bVe=(e,t)=>($r("comp",e,t),e=_Ve(e,t),$r("caret",e),e=xVe(e,t),$r("tildes",e),e=EVe(e,t),$r("xrange",e),e=AVe(e,t),$r("stars",e),e),Ta=e=>!e||e.toLowerCase()==="x"||e==="*",xVe=(e,t)=>e.trim().split(/\s+/).map(n=>wVe(n,t)).join(" "),wVe=(e,t)=>{const n=t.loose?Xi[Pi.TILDELOOSE]:Xi[Pi.TILDE];return e.replace(n,(r,i,a,o,s)=>{$r("tilde",e,r,i,a,o,s);let u;return Ta(i)?u="":Ta(a)?u=`>=${i}.0.0 <${+i+1}.0.0-0`:Ta(o)?u=`>=${i}.${a}.0 <${i}.${+a+1}.0-0`:s?($r("replaceTilde pr",s),u=`>=${i}.${a}.${o}-${s} <${i}.${+a+1}.0-0`):u=`>=${i}.${a}.${o} <${i}.${+a+1}.0-0`,$r("tilde return",u),u})},_Ve=(e,t)=>e.trim().split(/\s+/).map(n=>SVe(n,t)).join(" "),SVe=(e,t)=>{$r("caret",e,t);const n=t.loose?Xi[Pi.CARETLOOSE]:Xi[Pi.CARET],r=t.includePrerelease?"-0":"";return e.replace(n,(i,a,o,s,u)=>{$r("caret",e,i,a,o,s,u);let l;return Ta(a)?l="":Ta(o)?l=`>=${a}.0.0${r} <${+a+1}.0.0-0`:Ta(s)?a==="0"?l=`>=${a}.${o}.0${r} <${a}.${+o+1}.0-0`:l=`>=${a}.${o}.0${r} <${+a+1}.0.0-0`:u?($r("replaceCaret pr",u),a==="0"?o==="0"?l=`>=${a}.${o}.${s}-${u} <${a}.${o}.${+s+1}-0`:l=`>=${a}.${o}.${s}-${u} <${a}.${+o+1}.0-0`:l=`>=${a}.${o}.${s}-${u} <${+a+1}.0.0-0`):($r("no pr"),a==="0"?o==="0"?l=`>=${a}.${o}.${s}${r} <${a}.${o}.${+s+1}-0`:l=`>=${a}.${o}.${s}${r} <${a}.${+o+1}.0-0`:l=`>=${a}.${o}.${s} <${+a+1}.0.0-0`),$r("caret return",l),l})},EVe=(e,t)=>($r("replaceXRanges",e,t),e.split(/\s+/).map(n=>CVe(n,t)).join(" ")),CVe=(e,t)=>{e=e.trim();const n=t.loose?Xi[Pi.XRANGELOOSE]:Xi[Pi.XRANGE];return e.replace(n,(r,i,a,o,s,u)=>{$r("xRange",e,r,i,a,o,s,u);const l=Ta(a),c=l||Ta(o),f=c||Ta(s),d=f;return i==="="&&d&&(i=""),u=t.includePrerelease?"-0":"",l?i===">"||i==="<"?r="<0.0.0-0":r="*":i&&d?(c&&(o=0),s=0,i===">"?(i=">=",c?(a=+a+1,o=0,s=0):(o=+o+1,s=0)):i==="<="&&(i="<",c?a=+a+1:o=+o+1),i==="<"&&(u="-0"),r=`${i+a}.${o}.${s}${u}`):c?r=`>=${a}.0.0${u} <${+a+1}.0.0-0`:f&&(r=`>=${a}.${o}.0${u} <${a}.${+o+1}.0-0`),$r("xRange return",r),r})},AVe=(e,t)=>($r("replaceStars",e,t),e.trim().replace(Xi[Pi.STAR],"")),kVe=(e,t)=>($r("replaceGTE0",e,t),e.trim().replace(Xi[t.includePrerelease?Pi.GTE0PRE:Pi.GTE0],"")),TVe=e=>(t,n,r,i,a,o,s,u,l,c,f,d,h)=>(Ta(r)?n="":Ta(i)?n=`>=${r}.0.0${e?"-0":""}`:Ta(a)?n=`>=${r}.${i}.0${e?"-0":""}`:o?n=`>=${n}`:n=`>=${n}${e?"-0":""}`,Ta(l)?u="":Ta(c)?u=`<${+l+1}.0.0-0`:Ta(f)?u=`<${l}.${+c+1}.0-0`:d?u=`<=${l}.${c}.${f}-${d}`:e?u=`<${l}.${c}.${+f+1}-0`:u=`<=${u}`,`${n} ${u}`.trim()),OVe=(e,t,n)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(let r=0;r<e.length;r++)if($r(e[r].semver),e[r].semver!==q$.ANY&&e[r].semver.prerelease.length>0){const i=e[r].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0},a1=Symbol("SemVer ANY");class OC{static get ANY(){return a1}constructor(t,n){if(n=IVe(n),t instanceof OC){if(t.loose===!!n.loose)return t;t=t.value}G$("comparator",t,n),this.options=n,this.loose=!!n.loose,this.parse(t),this.semver===a1?this.value="":this.value=this.operator+this.semver.version,G$("comp",this)}parse(t){const n=this.options.loose?bne[xne.COMPARATORLOOSE]:bne[xne.COMPARATOR],r=t.match(n);if(!r)throw new TypeError(`Invalid comparator: ${t}`);this.operator=r[1]!==void 0?r[1]:"",this.operator==="="&&(this.operator=""),r[2]?this.semver=new wne(r[2],this.options.loose):this.semver=a1}toString(){return this.value}test(t){if(G$("Comparator.test",t,this.options.loose),this.semver===a1||t===a1)return!0;if(typeof t=="string")try{t=new wne(t,this.options)}catch(n){return!1}return H$(t,this.operator,this.semver,this.options)}intersects(t,n){if(!(t instanceof OC))throw new TypeError("a Comparator is required");if((!n||typeof n!="object")&&(n={loose:!!n,includePrerelease:!1}),this.operator==="")return this.value===""?!0:new _ne(t.value,n).test(this.value);if(t.operator==="")return t.value===""?!0:new _ne(this.value,n).test(t.semver);const r=(this.operator===">="||this.operator===">")&&(t.operator===">="||t.operator===">"),i=(this.operator==="<="||this.operator==="<")&&(t.operator==="<="||t.operator==="<"),a=this.semver.version===t.semver.version,o=(this.operator===">="||this.operator==="<=")&&(t.operator===">="||t.operator==="<="),s=H$(this.semver,"<",t.semver,n)&&(this.operator===">="||this.operator===">")&&(t.operator==="<="||t.operator==="<"),u=H$(this.semver,">",t.semver,n)&&(this.operator==="<="||this.operator==="<")&&(t.operator===">="||t.operator===">");return r||i||a&&o||s||u}}var IC=OC;const IVe=_C,{re:bne,t:xne}=Zf.exports,H$=dne,G$=wC,wne=ka,_ne=tu,NVe=tu,DVe=(e,t,n)=>{try{t=new NVe(t,n)}catch(r){return!1}return t.test(e)};var NC=DVe;const RVe=tu,FVe=(e,t)=>new RVe(e,t).set.map(n=>n.map(r=>r.value).join(" ").trim().split(" "));var MVe=FVe;const PVe=ka,$Ve=tu,LVe=(e,t,n)=>{let r=null,i=null,a=null;try{a=new $Ve(t,n)}catch(o){return null}return e.forEach(o=>{a.test(o)&&(!r||i.compare(o)===-1)&&(r=o,i=new PVe(r,n))}),r};var BVe=LVe;const zVe=ka,jVe=tu,UVe=(e,t,n)=>{let r=null,i=null,a=null;try{a=new jVe(t,n)}catch(o){return null}return e.forEach(o=>{a.test(o)&&(!r||i.compare(o)===1)&&(r=o,i=new zVe(r,n))}),r};var WVe=UVe;const K$=ka,VVe=tu,Sne=CC,qVe=(e,t)=>{e=new VVe(e,t);let n=new K$("0.0.0");if(e.test(n)||(n=new K$("0.0.0-0"),e.test(n)))return n;n=null;for(let r=0;r<e.set.length;++r){const i=e.set[r];let a=null;i.forEach(o=>{const s=new K$(o.semver.version);switch(o.operator){case">":s.prerelease.length===0?s.patch++:s.prerelease.push(0),s.raw=s.format();case"":case">=":(!a||Sne(s,a))&&(a=s);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${o.operator}`)}}),a&&(!n||Sne(n,a))&&(n=a)}return n&&e.test(n)?n:null};var HVe=qVe;const GVe=tu,KVe=(e,t)=>{try{return new GVe(e,t).range||"*"}catch(n){return null}};var XVe=KVe;const YVe=ka,Ene=IC,{ANY:ZVe}=Ene,JVe=tu,QVe=NC,Cne=CC,Ane=z$,eqe=U$,tqe=j$,nqe=(e,t,n,r)=>{e=new YVe(e,r),t=new JVe(t,r);let i,a,o,s,u;switch(n){case">":i=Cne,a=eqe,o=Ane,s=">",u=">=";break;case"<":i=Ane,a=tqe,o=Cne,s="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(QVe(e,t,r))return!1;for(let l=0;l<t.set.length;++l){const c=t.set[l];let f=null,d=null;if(c.forEach(h=>{h.semver===ZVe&&(h=new Ene(">=0.0.0")),f=f||h,d=d||h,i(h.semver,f.semver,r)?f=h:o(h.semver,d.semver,r)&&(d=h)}),f.operator===s||f.operator===u||(!d.operator||d.operator===s)&&a(e,d.semver))return!1;if(d.operator===u&&o(e,d.semver))return!1}return!0};var X$=nqe;const rqe=X$,iqe=(e,t,n)=>rqe(e,t,">",n);var aqe=iqe;const oqe=X$,sqe=(e,t,n)=>oqe(e,t,"<",n);var uqe=sqe;const kne=tu,lqe=(e,t,n)=>(e=new kne(e,n),t=new kne(t,n),e.intersects(t));var cqe=lqe;const fqe=NC,dqe=Qs;var hqe=(e,t,n)=>{const r=[];let i=null,a=null;const o=e.sort((c,f)=>dqe(c,f,n));for(const c of o)fqe(c,t,n)?(a=c,i||(i=c)):(a&&r.push([i,a]),a=null,i=null);i&&r.push([i,null]);const s=[];for(const[c,f]of r)c===f?s.push(c):!f&&c===o[0]?s.push("*"):f?c===o[0]?s.push(`<=${f}`):s.push(`${c} - ${f}`):s.push(`>=${c}`);const u=s.join(" || "),l=typeof t.raw=="string"?t.raw:String(t);return u.length<l.length?u:t};const Tne=tu,DC=IC,{ANY:Y$}=DC,o1=NC,Z$=Qs,pqe=(e,t,n={})=>{if(e===t)return!0;e=new Tne(e,n),t=new Tne(t,n);let r=!1;e:for(const i of e.set){for(const a of t.set){const o=gqe(i,a,n);if(r=r||o!==null,o)continue e}if(r)return!1}return!0},gqe=(e,t,n)=>{if(e===t)return!0;if(e.length===1&&e[0].semver===Y$){if(t.length===1&&t[0].semver===Y$)return!0;n.includePrerelease?e=[new DC(">=0.0.0-0")]:e=[new DC(">=0.0.0")]}if(t.length===1&&t[0].semver===Y$){if(n.includePrerelease)return!0;t=[new DC(">=0.0.0")]}const r=new Set;let i,a;for(const h of e)h.operator===">"||h.operator===">="?i=One(i,h,n):h.operator==="<"||h.operator==="<="?a=Ine(a,h,n):r.add(h.semver);if(r.size>1)return null;let o;if(i&&a){if(o=Z$(i.semver,a.semver,n),o>0)return null;if(o===0&&(i.operator!==">="||a.operator!=="<="))return null}for(const h of r){if(i&&!o1(h,String(i),n)||a&&!o1(h,String(a),n))return null;for(const p of t)if(!o1(h,String(p),n))return!1;return!0}let s,u,l,c,f=a&&!n.includePrerelease&&a.semver.prerelease.length?a.semver:!1,d=i&&!n.includePrerelease&&i.semver.prerelease.length?i.semver:!1;f&&f.prerelease.length===1&&a.operator==="<"&&f.prerelease[0]===0&&(f=!1);for(const h of t){if(c=c||h.operator===">"||h.operator===">=",l=l||h.operator==="<"||h.operator==="<=",i){if(d&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===d.major&&h.semver.minor===d.minor&&h.semver.patch===d.patch&&(d=!1),h.operator===">"||h.operator===">="){if(s=One(i,h,n),s===h&&s!==i)return!1}else if(i.operator===">="&&!o1(i.semver,String(h),n))return!1}if(a){if(f&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===f.major&&h.semver.minor===f.minor&&h.semver.patch===f.patch&&(f=!1),h.operator==="<"||h.operator==="<="){if(u=Ine(a,h,n),u===h&&u!==a)return!1}else if(a.operator==="<="&&!o1(a.semver,String(h),n))return!1}if(!h.operator&&(a||i)&&o!==0)return!1}return!(i&&l&&!a&&o!==0||a&&c&&!i&&o!==0||d||f)},One=(e,t,n)=>{if(!e)return t;const r=Z$(e.semver,t.semver,n);return r>0?e:r<0||t.operator===">"&&e.operator===">="?t:e},Ine=(e,t,n)=>{if(!e)return t;const r=Z$(e.semver,t.semver,n);return r<0?e:r>0||t.operator==="<"&&e.operator==="<="?t:e};var mqe=pqe;const J$=Zf.exports;var Nne={re:J$.re,src:J$.src,tokens:J$.t,SEMVER_SPEC_VERSION:xC.SEMVER_SPEC_VERSION,SemVer:ka,compareIdentifiers:$$.compareIdentifiers,rcompareIdentifiers:$$.rcompareIdentifiers,parse:sv,valid:JUe,clean:tWe,inc:iWe,diff:cWe,major:hWe,minor:mWe,patch:bWe,prerelease:_We,compare:Qs,rcompare:CWe,compareLoose:TWe,compareBuild:B$,sort:DWe,rsort:MWe,gt:CC,lt:z$,eq:L$,neq:fne,gte:j$,lte:U$,cmp:dne,coerce:nVe,Comparator:IC,Range:tu,satisfies:NC,toComparators:MVe,maxSatisfying:BVe,minSatisfying:WVe,minVersion:HVe,validRange:XVe,outside:X$,gtr:aqe,ltr:uqe,intersects:cqe,simplifyRange:hqe,subset:mqe};function ro(e,t,n){return e.fields=t||[],e.fname=n,e}function Tr(e){return e==null?null:e.fname}function Yi(e){return e==null?null:e.fields}function Dne(e){return e.length===1?vqe(e[0]):yqe(e)}const vqe=e=>function(t){return t[e]},yqe=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function Se(e){throw Error(e)}function RC(e){const t=[],n=e.length;let r=null,i=0,a="",o,s,u;e=e+"";function l(){t.push(a+e.substring(o,s)),a="",o=s+1}for(o=s=0;s<n;++s)if(u=e[s],u==="\\")a+=e.substring(o,s),a+=e.substring(++s,++s),o=s;else if(u===r)l(),r=null,i=-1;else{if(r)continue;o===i&&u==='"'||o===i&&u==="'"?(o=s+1,r=u):u==="."&&!i?s>o?l():o=s+1:u==="["?(s>o&&l(),i=o=s+1):u==="]"&&(i||Se("Access path missing open bracket: "+e),i>0&&l(),i=0,o=s+1)}return i&&Se("Access path missing closing bracket: "+e),r&&Se("Access path missing closing quote: "+e),s>o&&(s++,l()),t}function io(e,t,n){const r=RC(e);return e=r.length===1?r[0]:e,ro((n&&n.get||Dne)(r),[e],t||e)}const s1=io("id"),Oa=ro(e=>e,[],"identity"),Jf=ro(()=>0,[],"zero"),cv=ro(()=>1,[],"one"),ls=ro(()=>!0,[],"true"),Qf=ro(()=>!1,[],"false");function FC(e,t,n){const r=[t].concat([].slice.call(n));console[e].apply(console,r)}const Rne=0,Q$=1,Fne=2,Mne=3,Pne=4;function $ne(e,t){let n=e||Rne;return{level(r){return arguments.length?(n=+r,this):n},error(){return n>=Q$&&FC(t||"error","ERROR",arguments),this},warn(){return n>=Fne&&FC(t||"warn","WARN",arguments),this},info(){return n>=Mne&&FC(t||"log","INFO",arguments),this},debug(){return n>=Pne&&FC(t||"log","DEBUG",arguments),this}}}var ut=Array.isArray;function Nt(e){return e===Object(e)}const Lne=e=>e!=="__proto__";function MC(...e){return e.reduce((t,n)=>{for(const r in n)if(r==="signals")t.signals=bqe(t.signals,n.signals);else{const i=r==="legend"?{layout:1}:r==="style"?!0:null;PC(t,r,n[r],i)}return t},{})}function PC(e,t,n,r){if(!Lne(t))return;let i,a;if(Nt(n)&&!ut(n)){a=Nt(e[t])?e[t]:e[t]={};for(i in n)r&&(r===!0||r[i])?PC(a,i,n[i]):Lne(i)&&(a[i]=n[i])}else e[t]=n}function bqe(e,t){if(e==null)return t;const n={},r=[];function i(a){n[a.name]||(n[a.name]=1,r.push(a))}return t.forEach(i),e.forEach(i),r}function sn(e){return e[e.length-1]}function Zi(e){return e==null||e===""?null:+e}const Bne=e=>t=>e*Math.exp(t),zne=e=>t=>Math.log(e*t),jne=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),Une=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,$C=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function LC(e,t,n,r){const i=n(e[0]),a=n(sn(e)),o=(a-i)*t;return[r(i-o),r(a-o)]}function Wne(e,t){return LC(e,t,Zi,Oa)}function Vne(e,t){var n=Math.sign(e[0]);return LC(e,t,zne(n),Bne(n))}function qne(e,t,n){return LC(e,t,$C(n),$C(1/n))}function Hne(e,t,n){return LC(e,t,jne(n),Une(n))}function BC(e,t,n,r,i){const a=r(e[0]),o=r(sn(e)),s=t!=null?r(t):(a+o)/2;return[i(s+(a-s)*n),i(s+(o-s)*n)]}function e4(e,t,n){return BC(e,t,n,Zi,Oa)}function t4(e,t,n){const r=Math.sign(e[0]);return BC(e,t,n,zne(r),Bne(r))}function zC(e,t,n,r){return BC(e,t,n,$C(r),$C(1/r))}function n4(e,t,n,r){return BC(e,t,n,jne(r),Une(r))}function Gne(e){return 1+~~(new Date(e).getMonth()/3)}function Kne(e){return 1+~~(new Date(e).getUTCMonth()/3)}function wt(e){return e!=null?ut(e)?e:[e]:[]}function Xne(e,t,n){let r=e[0],i=e[1],a;return i<r&&(a=i,i=r,r=a),a=i-r,a>=n-t?[t,n]:[r=Math.min(Math.max(r,t),n-a),r+a]}function Lt(e){return typeof e=="function"}const xqe="descending";function r4(e,t,n){n=n||{},t=wt(t)||[];const r=[],i=[],a={},o=n.comparator||wqe;return wt(e).forEach((s,u)=>{s!=null&&(r.push(t[u]===xqe?-1:1),i.push(s=Lt(s)?s:io(s,null,n)),(Yi(s)||[]).forEach(l=>a[l]=1))}),i.length===0?null:ro(o(i,r),Object.keys(a))}const jC=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),wqe=(e,t)=>e.length===1?_qe(e[0],t[0]):Sqe(e,t,e.length),_qe=(e,t)=>function(n,r){return jC(e(n),e(r))*t},Sqe=(e,t,n)=>(t.push(0),function(r,i){let a,o=0,s=-1;for(;o===0&&++s<n;)a=e[s],o=jC(a(r),a(i));return o*t[s]});function Ji(e){return Lt(e)?e:()=>e}function i4(e,t){let n;return r=>{n&&clearTimeout(n),n=setTimeout(()=>(t(r),n=null),e)}}function Rt(e){for(let t,n,r=1,i=arguments.length;r<i;++r){t=arguments[r];for(n in t)e[n]=t[n]}return e}function tl(e,t){let n=0,r,i,a,o;if(e&&(r=e.length))if(t==null){for(i=e[n];n<r&&(i==null||i!==i);i=e[++n]);for(a=o=i;n<r;++n)i=e[n],i!=null&&(i<a&&(a=i),i>o&&(o=i))}else{for(i=t(e[n]);n<r&&(i==null||i!==i);i=t(e[++n]));for(a=o=i;n<r;++n)i=t(e[n]),i!=null&&(i<a&&(a=i),i>o&&(o=i))}return[a,o]}function Yne(e,t){const n=e.length;let r=-1,i,a,o,s,u;if(t==null){for(;++r<n;)if(a=e[r],a!=null&&a>=a){i=o=a;break}if(r===n)return[-1,-1];for(s=u=r;++r<n;)a=e[r],a!=null&&(i>a&&(i=a,s=r),o<a&&(o=a,u=r))}else{for(;++r<n;)if(a=t(e[r],r,e),a!=null&&a>=a){i=o=a;break}if(r===n)return[-1,-1];for(s=u=r;++r<n;)a=t(e[r],r,e),a!=null&&(i>a&&(i=a,s=r),o<a&&(o=a,u=r))}return[s,u]}const Eqe=Object.prototype.hasOwnProperty;function _t(e,t){return Eqe.call(e,t)}const UC={};function fv(e){let t={},n;function r(a){return _t(t,a)&&t[a]!==UC}const i={size:0,empty:0,object:t,has:r,get(a){return r(a)?t[a]:void 0},set(a,o){return r(a)||(++i.size,t[a]===UC&&--i.empty),t[a]=o,this},delete(a){return r(a)&&(--i.size,++i.empty,t[a]=UC),this},clear(){i.size=i.empty=0,i.object=t={}},test(a){return arguments.length?(n=a,i):n},clean(){const a={};let o=0;for(const s in t){const u=t[s];u!==UC&&(!n||!n(u))&&(a[s]=u,++o)}i.size=o,i.empty=0,i.object=t=a}};return e&&Object.keys(e).forEach(a=>{i.set(a,e[a])}),i}function Zne(e,t,n,r,i,a){if(!n&&n!==0)return a;const o=+n;let s=e[0],u=sn(e),l;u<s&&(l=s,s=u,u=l),l=Math.abs(t-s);const c=Math.abs(u-t);return l<c&&l<=o?r:c<=o?i:a}function $e(e,t,n){const r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),Rt(r,n)}function dv(e,t,n,r){let i=t[0],a=t[t.length-1],o;return i>a&&(o=i,i=a,a=o),n=n===void 0||n,r=r===void 0||r,(n?i<=e:i<e)&&(r?e<=a:e<a)}function a4(e){return typeof e=="boolean"}function ed(e){return Object.prototype.toString.call(e)==="[object Date]"}function Jne(e){return e&&Lt(e[Symbol.iterator])}function td(e){return typeof e=="number"}function Qne(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function Bn(e){return typeof e=="string"}function o4(e,t,n){e&&(e=t?wt(e).map(s=>s.replace(/\\(.)/g,"$1")):wt(e));const r=e&&e.length,i=n&&n.get||Dne,a=s=>i(t?[s]:RC(s));let o;if(!r)o=function(){return""};else if(r===1){const s=a(e[0]);o=function(u){return""+s(u)}}else{const s=e.map(a);o=function(u){let l=""+s[0](u),c=0;for(;++c<r;)l+="|"+s[c](u);return l}}return ro(o,e,"key")}function ere(e,t){const n=e[0],r=sn(e),i=+t;return i?i===1?r:n+i*(r-n):n}const Cqe=1e4;function tre(e){e=+e||Cqe;let t,n,r;const i=()=>{t={},n={},r=0},a=(o,s)=>(++r>e&&(n=t,t={},r=1),t[o]=s);return i(),{clear:i,has:o=>_t(t,o)||_t(n,o),get:o=>_t(t,o)?t[o]:_t(n,o)?a(o,n[o]):void 0,set:(o,s)=>_t(t,o)?t[o]=s:a(o,s)}}function nre(e,t,n,r){const i=t.length,a=n.length;if(!a)return t;if(!i)return n;const o=r||new t.constructor(i+a);let s=0,u=0,l=0;for(;s<i&&u<a;++l)o[l]=e(t[s],n[u])>0?n[u++]:t[s++];for(;s<i;++s,++l)o[l]=t[s];for(;u<a;++u,++l)o[l]=n[u];return o}function u1(e,t){let n="";for(;--t>=0;)n+=e;return n}function rre(e,t,n,r){const i=n||" ",a=e+"",o=t-a.length;return o<=0?a:r==="left"?u1(i,o)+a:r==="center"?u1(i,~~(o/2))+a+u1(i,Math.ceil(o/2)):a+u1(i,o)}function l1(e){return e&&sn(e)-e[0]||0}function gt(e){return ut(e)?"["+e.map(gt)+"]":Nt(e)||Bn(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function s4(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const Aqe=e=>td(e)||ed(e)?e:Date.parse(e);function u4(e,t){return t=t||Aqe,e==null||e===""?null:t(e)}function l4(e){return e==null||e===""?null:e+""}function nu(e){const t={},n=e.length;for(let r=0;r<n;++r)t[e[r]]=!0;return t}function ire(e,t,n,r){const i=r??"\u2026",a=e+"",o=a.length,s=Math.max(0,t-i.length);return o<=t?a:n==="left"?i+a.slice(o-s):n==="center"?a.slice(0,Math.ceil(s/2))+i+a.slice(o-~~(s/2)):a.slice(0,s)+i}function nd(e,t,n){if(e)if(t){const r=e.length;for(let i=0;i<r;++i){const a=t(e[i]);a&&n(a,i,e)}}else e.forEach(n)}const kqe=/^([A-Za-z]+:)?\/\//,Tqe=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,Oqe=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,are="file://";function Iqe(e,t){return n=>({options:n||{},sanitize:Dqe,load:Nqe,fileAccess:!!t,file:Rqe(t),http:Mqe(e)})}async function Nqe(e,t){const n=await this.sanitize(e,t),r=n.href;return n.localFile?this.file(r):this.http(r,t)}async function Dqe(e,t){t=Rt({},this.options,t);const n=this.fileAccess,r={href:null};let i,a,o;const s=Tqe.test(e.replace(Oqe,""));(e==null||typeof e!="string"||!s)&&Se("Sanitize failure, invalid URI: "+gt(e));const u=kqe.test(e);return(o=t.baseURL)&&!u&&(!e.startsWith("/")&&o[o.length-1]!=="/"&&(e="/"+e),e=o+e),a=(i=e.startsWith(are))||t.mode==="file"||t.mode!=="http"&&!u&&n,i?e=e.slice(are.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),a=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(r,"localFile",{value:!!a}),r.href=e,t.target&&(r.target=t.target+""),t.rel&&(r.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(r.crossOrigin=t.crossOrigin+""),r}function Rqe(e){return e?t=>new Promise((n,r)=>{e.readFile(t,(i,a)=>{i?r(i):n(a)})}):Fqe}async function Fqe(){Se("No file system access.")}function Mqe(e){return e?async function(t,n){const r=Rt({},this.options.http,n),i=n&&n.response,a=await e(t,r);return a.ok?Lt(a[i])?a[i]():a.text():Se(a.status+""+a.statusText)}:Pqe}async function Pqe(){Se("No HTTP fetch method available.")}const $qe=e=>e!=null&&e===e,Lqe=e=>e==="true"||e==="false"||e===!0||e===!1,Bqe=e=>!Number.isNaN(Date.parse(e)),ore=e=>!Number.isNaN(+e)&&!(e instanceof Date),zqe=e=>ore(e)&&Number.isInteger(+e),c4={boolean:s4,integer:Zi,number:Zi,date:u4,string:l4,unknown:Oa},WC=[Lqe,zqe,ore,Bqe],jqe=["boolean","integer","number","date"];function sre(e,t){if(!e||!e.length)return"unknown";const n=e.length,r=WC.length,i=WC.map((a,o)=>o+1);for(let a=0,o=0,s,u;a<n;++a)for(u=t?e[a][t]:e[a],s=0;s<r;++s)if(i[s]&&$qe(u)&&!WC[s](u)&&(i[s]=0,++o,o===WC.length))return"string";return jqe[i.reduce((a,o)=>a===0?o:a,0)-1]}function ure(e,t){return t.reduce((n,r)=>(n[r]=sre(e,r),n),{})}var lre={},f4={},d4=34,c1=10,h4=13;function cre(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function Uqe(e,t){var n=cre(e);return function(r,i){return t(n(r),i,e)}}function fre(e){var t=Object.create(null),n=[];return e.forEach(function(r){for(var i in r)i in t||n.push(t[i]=i)}),n}function ao(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function Wqe(e){return e<0?"-"+ao(-e,6):e>9999?"+"+ao(e,6):ao(e,4)}function Vqe(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":Wqe(e.getUTCFullYear())+"-"+ao(e.getUTCMonth()+1,2)+"-"+ao(e.getUTCDate(),2)+(i?"T"+ao(t,2)+":"+ao(n,2)+":"+ao(r,2)+"."+ao(i,3)+"Z":r?"T"+ao(t,2)+":"+ao(n,2)+":"+ao(r,2)+"Z":n||t?"T"+ao(t,2)+":"+ao(n,2)+"Z":"")}function qqe(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function r(f,d){var h,p,g=i(f,function(m,v){if(h)return h(m,v-1);p=m,h=d?Uqe(m,d):cre(m)});return g.columns=p||[],g}function i(f,d){var h=[],p=f.length,g=0,m=0,v,y=p<=0,b=!1;f.charCodeAt(p-1)===c1&&--p,f.charCodeAt(p-1)===h4&&--p;function x(){if(y)return f4;if(b)return b=!1,lre;var S,C=g,_;if(f.charCodeAt(C)===d4){for(;g++<p&&f.charCodeAt(g)!==d4||f.charCodeAt(++g)===d4;);return(S=g)>=p?y=!0:(_=f.charCodeAt(g++))===c1?b=!0:_===h4&&(b=!0,f.charCodeAt(g)===c1&&++g),f.slice(C+1,S-1).replace(/""/g,'"')}for(;g<p;){if((_=f.charCodeAt(S=g++))===c1)b=!0;else if(_===h4)b=!0,f.charCodeAt(g)===c1&&++g;else if(_!==n)continue;return f.slice(C,S)}return y=!0,f.slice(C,p)}for(;(v=x())!==f4;){for(var w=[];v!==lre&&v!==f4;)w.push(v),v=x();d&&(w=d(w,m++))==null||h.push(w)}return h}function a(f,d){return f.map(function(h){return d.map(function(p){return c(h[p])}).join(e)})}function o(f,d){return d==null&&(d=fre(f)),[d.map(c).join(e)].concat(a(f,d)).join(`
`)}function s(f,d){return d==null&&(d=fre(f)),a(f,d).join(`
`)}function u(f){return f.map(l).join(`
`)}function l(f){return f.map(c).join(e)}function c(f){return f==null?"":f instanceof Date?Vqe(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:r,parseRows:i,format:o,formatBody:s,formatRows:u,formatRow:l,formatValue:c}}function dre(e){const t=function(n,r){const i={delimiter:e};return p4(n,r?Rt(r,i):i)};return t.responseType="text",t}function p4(e,t){return t.header&&(e=t.header.map(gt).join(t.delimiter)+`
`+e),qqe(t.delimiter).parse(e+"")}p4.responseType="text";function Hqe(e){return typeof Buffer=="function"&&Lt(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function g4(e,t){const n=t&&t.property?io(t.property):Oa;return Nt(e)&&!Hqe(e)?Gqe(n(e),t):n(JSON.parse(e))}g4.responseType="json";function Gqe(e,t){return!ut(e)&&Jne(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}function Kqe(e){return e}function Xqe(e){if(e==null)return Kqe;var t,n,r=e.scale[0],i=e.scale[1],a=e.translate[0],o=e.translate[1];return function(s,u){u||(t=n=0);var l=2,c=s.length,f=new Array(c);for(f[0]=(t+=s[0])*r+a,f[1]=(n+=s[1])*i+o;l<c;)f[l]=s[l],++l;return f}}function Yqe(e,t){for(var n,r=e.length,i=r-t;i<--r;)n=e[i],e[i++]=e[r],e[r]=n}function Zqe(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return hre(e,n)})}:hre(e,t)}function hre(e,t){var n=t.id,r=t.bbox,i=t.properties==null?{}:t.properties,a=pre(e,t);return n==null&&r==null?{type:"Feature",properties:i,geometry:a}:r==null?{type:"Feature",id:n,properties:i,geometry:a}:{type:"Feature",id:n,bbox:r,properties:i,geometry:a}}function pre(e,t){var n=Xqe(e.transform),r=e.arcs;function i(c,f){f.length&&f.pop();for(var d=r[c<0?~c:c],h=0,p=d.length;h<p;++h)f.push(n(d[h],h));c<0&&Yqe(f,p)}function a(c){return n(c)}function o(c){for(var f=[],d=0,h=c.length;d<h;++d)i(c[d],f);return f.length<2&&f.push(f[0]),f}function s(c){for(var f=o(c);f.length<4;)f.push(f[0]);return f}function u(c){return c.map(s)}function l(c){var f=c.type,d;switch(f){case"GeometryCollection":return{type:f,geometries:c.geometries.map(l)};case"Point":d=a(c.coordinates);break;case"MultiPoint":d=c.coordinates.map(a);break;case"LineString":d=o(c.arcs);break;case"MultiLineString":d=c.arcs.map(o);break;case"Polygon":d=u(c.arcs);break;case"MultiPolygon":d=c.arcs.map(u);break;default:return null}return{type:f,coordinates:d}}return l(t)}function Jqe(e,t){var n={},r={},i={},a=[],o=-1;t.forEach(function(l,c){var f=e.arcs[l<0?~l:l],d;f.length<3&&!f[1][0]&&!f[1][1]&&(d=t[++o],t[o]=l,t[c]=d)}),t.forEach(function(l){var c=s(l),f=c[0],d=c[1],h,p;if(h=i[f])if(delete i[h.end],h.push(l),h.end=d,p=r[d]){delete r[p.start];var g=p===h?h:h.concat(p);r[g.start=h.start]=i[g.end=p.end]=g}else r[h.start]=i[h.end]=h;else if(h=r[d])if(delete r[h.start],h.unshift(l),h.start=f,p=i[f]){delete i[p.end];var m=p===h?h:p.concat(h);r[m.start=p.start]=i[m.end=h.end]=m}else r[h.start]=i[h.end]=h;else h=[l],r[h.start=f]=i[h.end=d]=h});function s(l){var c=e.arcs[l<0?~l:l],f=c[0],d;return e.transform?(d=[0,0],c.forEach(function(h){d[0]+=h[0],d[1]+=h[1]})):d=c[c.length-1],l<0?[d,f]:[f,d]}function u(l,c){for(var f in l){var d=l[f];delete c[d.start],delete d.start,delete d.end,d.forEach(function(h){n[h<0?~h:h]=1}),a.push(d)}}return u(i,r),u(r,i),t.forEach(function(l){n[l<0?~l:l]||a.push([l])}),a}function Qqe(e){return pre(e,eHe.apply(this,arguments))}function eHe(e,t,n){var r,i,a;if(arguments.length>1)r=tHe(e,t,n);else for(i=0,r=new Array(a=e.arcs.length);i<a;++i)r[i]=i;return{type:"MultiLineString",arcs:Jqe(e,r)}}function tHe(e,t,n){var r=[],i=[],a;function o(f){var d=f<0?~f:f;(i[d]||(i[d]=[])).push({i:f,g:a})}function s(f){f.forEach(o)}function u(f){f.forEach(s)}function l(f){f.forEach(u)}function c(f){switch(a=f,f.type){case"GeometryCollection":f.geometries.forEach(c);break;case"LineString":s(f.arcs);break;case"MultiLineString":case"Polygon":u(f.arcs);break;case"MultiPolygon":l(f.arcs);break}}return c(t),i.forEach(n==null?function(f){r.push(f[0].i)}:function(f){n(f[0].g,f[f.length-1].g)&&r.push(f[0].i)}),r}const nHe={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function gre(e,t){let n,r,i,a;return e=g4(e,t),t&&t.feature?(n=Zqe,i=t.feature):t&&t.mesh?(n=Qqe,i=t.mesh,a=nHe[t.filter]):Se("Missing TopoJSON feature or mesh parameter."),r=(r=e.objects[i])?n(e,r,a):Se("Invalid TopoJSON object: "+i),r&&r.features||[r]}gre.responseType="json";const VC={dsv:p4,csv:dre(","),tsv:dre("	"),json:g4,topojson:gre};function m4(e,t){return arguments.length>1?(VC[e]=t,this):_t(VC,e)?VC[e]:null}function mre(e){const t=m4(e);return t&&t.responseType||"text"}function hv(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function f1(e){let t=e,n=e;e.length===1&&(t=(o,s)=>e(o)-s,n=rHe(e));function r(o,s,u,l){for(u==null&&(u=0),l==null&&(l=o.length);u<l;){const c=u+l>>>1;n(o[c],s)<0?u=c+1:l=c}return u}function i(o,s,u,l){for(u==null&&(u=0),l==null&&(l=o.length);u<l;){const c=u+l>>>1;n(o[c],s)>0?l=c:u=c+1}return u}function a(o,s,u,l){u==null&&(u=0),l==null&&(l=o.length);const c=r(o,s,u,l-1);return c>u&&t(o[c-1],s)>-t(o[c],s)?c-1:c}return{left:r,center:a,right:i}}function rHe(e){return(t,n)=>hv(e(t),n)}function vre(e){return e===null?NaN:+e}function*iHe(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(r=+r)>=r&&(yield r)}}const yre=f1(hv),rd=yre.right,aHe=yre.left;f1(vre).center;function oHe(e,t){let n=0,r,i=0,a=0;if(t===void 0)for(let o of e)o!=null&&(o=+o)>=o&&(r=o-i,i+=r/++n,a+=r*(o-i));else{let o=-1;for(let s of e)(s=t(s,++o,e))!=null&&(s=+s)>=s&&(r=s-i,i+=r/++n,a+=r*(s-i))}if(n>1)return a/(n-1)}function sHe(e,t){const n=oHe(e,t);return n&&Math.sqrt(n)}class Ia{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const a=n[i],o=t+a,s=Math.abs(t)<Math.abs(a)?t-(o-a):a-(o-t);s&&(n[r++]=s),t=o}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,a,o=0;if(n>0){for(o=t[--n];n>0&&(r=o,i=t[--n],o=r+i,a=i-(o-r),!a););n>0&&(a<0&&t[n-1]<0||a>0&&t[n-1]>0)&&(i=a*2,r=o+i,i==r-o&&(o=r))}return o}}function uHe(e,t){return Array.from(t,n=>e[n])}var v4=Math.sqrt(50),y4=Math.sqrt(10),b4=Math.sqrt(2);function x4(e,t,n){var r,i=-1,a,o,s;if(t=+t,e=+e,n=+n,e===t&&n>0)return[e];if((r=t<e)&&(a=e,e=t,t=a),(s=bre(e,t,n))===0||!isFinite(s))return[];if(s>0){let u=Math.round(e/s),l=Math.round(t/s);for(u*s<e&&++u,l*s>t&&--l,o=new Array(a=l-u+1);++i<a;)o[i]=(u+i)*s}else{s=-s;let u=Math.round(e*s),l=Math.round(t*s);for(u/s<e&&++u,l/s>t&&--l,o=new Array(a=l-u+1);++i<a;)o[i]=(u+i)/s}return r&&o.reverse(),o}function bre(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=v4?10:a>=y4?5:a>=b4?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=v4?10:a>=y4?5:a>=b4?2:1)}function id(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=v4?i*=10:a>=y4?i*=5:a>=b4&&(i*=2),t<e?-i:i}function fp(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function w4(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function xre(e,t,n=0,r=e.length-1,i=hv){for(;r>n;){if(r-n>600){const u=r-n+1,l=t-n+1,c=Math.log(u),f=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*f*(u-f)/u)*(l-u/2<0?-1:1),h=Math.max(n,Math.floor(t-l*f/u+d)),p=Math.min(r,Math.floor(t+(u-l)*f/u+d));xre(e,t,h,p,i)}const a=e[t];let o=n,s=r;for(d1(e,n,t),i(e[r],a)>0&&d1(e,n,r);o<s;){for(d1(e,o,s),++o,--s;i(e[o],a)<0;)++o;for(;i(e[s],a)>0;)--s}i(e[n],a)===0?d1(e,n,s):(++s,d1(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}return e}function d1(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function _4(e,t,n){if(e=Float64Array.from(iHe(e,n)),!!(r=e.length)){if((t=+t)<=0||r<2)return w4(e);if(t>=1)return fp(e);var r,i=(r-1)*t,a=Math.floor(i),o=fp(xre(e,a).subarray(0,a+1)),s=w4(e.subarray(a+1));return o+(s-o)*(i-a)}}function wre(e,t,n=vre){if(!!(r=e.length)){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,a=Math.floor(i),o=+n(e[a],a,e),s=+n(e[a+1],a+1,e);return o+(s-o)*(i-a)}}function lHe(e,t){let n=0,r=0;if(t===void 0)for(let i of e)i!=null&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let a of e)(a=t(a,++i,e))!=null&&(a=+a)>=a&&(++n,r+=a)}if(n)return r/n}function _re(e,t){return _4(e,.5,t)}function*cHe(e){for(const t of e)yield*t}function Sre(e){return Array.from(cHe(e))}function Bo(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,a=new Array(i);++r<i;)a[r]=e+r*n;return a}function Ere(e,t){let n=0;if(t===void 0)for(let r of e)(r=+r)&&(n+=r);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&(n+=i)}return n}function fHe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function qC(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function pv(e){return e=qC(Math.abs(e)),e?e[1]:NaN}function dHe(e,t){return function(n,r){for(var i=n.length,a=[],o=0,s=e[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),a.push(n.substring(i-=s,i+s)),!((u+=s+1)>r));)s=e[o=(o+1)%e.length];return a.reverse().join(t)}}function hHe(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var pHe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function h1(e){if(!(t=pHe.exec(e)))throw new Error("invalid format: "+e);var t;return new S4({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}h1.prototype=S4.prototype;function S4(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}S4.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function gHe(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var Cre;function mHe(e,t){var n=qC(e,t);if(!n)return e+"";var r=n[0],i=n[1],a=i-(Cre=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+qC(e,Math.max(0,t+a-1))[0]}function Are(e,t){var n=qC(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var kre={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:fHe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Are(e*100,t),r:Are,s:mHe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Tre(e){return e}var Ore=Array.prototype.map,Ire=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function Nre(e){var t=e.grouping===void 0||e.thousands===void 0?Tre:dHe(Ore.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?Tre:hHe(Ore.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"\u2212":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function l(f){f=h1(f);var d=f.fill,h=f.align,p=f.sign,g=f.symbol,m=f.zero,v=f.width,y=f.comma,b=f.precision,x=f.trim,w=f.type;w==="n"?(y=!0,w="g"):kre[w]||(b===void 0&&(b=12),x=!0,w="g"),(m||d==="0"&&h==="=")&&(m=!0,d="0",h="=");var S=g==="$"?n:g==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",C=g==="$"?r:/[%p]/.test(w)?o:"",_=kre[w],E=/[defgprs%]/.test(w);b=b===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function A(k){var T=S,I=C,N,O,D;if(w==="c")I=_(k)+I,k="";else{k=+k;var L=k<0||1/k<0;if(k=isNaN(k)?u:_(Math.abs(k),b),x&&(k=gHe(k)),L&&+k==0&&p!=="+"&&(L=!1),T=(L?p==="("?p:s:p==="-"||p==="("?"":p)+T,I=(w==="s"?Ire[8+Cre/3]:"")+I+(L&&p==="("?")":""),E){for(N=-1,O=k.length;++N<O;)if(D=k.charCodeAt(N),48>D||D>57){I=(D===46?i+k.slice(N+1):k.slice(N))+I,k=k.slice(0,N);break}}}y&&!m&&(k=t(k,1/0));var W=T.length+k.length+I.length,G=W<v?new Array(v-W+1).join(d):"";switch(y&&m&&(k=t(G+k,G.length?v-I.length:1/0),G=""),h){case"<":k=T+k+I+G;break;case"=":k=T+G+k+I;break;case"^":k=G.slice(0,W=G.length>>1)+T+k+I+G.slice(W);break;default:k=G+T+k+I;break}return a(k)}return A.toString=function(){return f+""},A}function c(f,d){var h=l((f=h1(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(pv(d)/3)))*3,g=Math.pow(10,-p),m=Ire[8+p/3];return function(v){return h(g*v)+m}}return{format:l,formatPrefix:c}}var HC,Dre,Rre;vHe({thousands:",",grouping:[3],currency:["$",""]});function vHe(e){return HC=Nre(e),Dre=HC.format,Rre=HC.formatPrefix,HC}function yHe(e){return Math.max(0,-pv(Math.abs(e)))}function bHe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(pv(t)/3)))*3-pv(Math.abs(e)))}function xHe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,pv(t)-pv(e))+1}var E4=new Date,C4=new Date;function xi(e,t,n,r){function i(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=function(a){return e(a=new Date(+a)),a},i.ceil=function(a){return e(a=new Date(a-1)),t(a,1),e(a),a},i.round=function(a){var o=i(a),s=i.ceil(a);return a-o<s-a?o:s},i.offset=function(a,o){return t(a=new Date(+a),o==null?1:Math.floor(o)),a},i.range=function(a,o,s){var u=[],l;if(a=i.ceil(a),s=s==null?1:Math.floor(s),!(a<o)||!(s>0))return u;do u.push(l=new Date(+a)),t(a,s),e(a);while(l<a&&a<o);return u},i.filter=function(a){return xi(function(o){if(o>=o)for(;e(o),!a(o);)o.setTime(o-1)},function(o,s){if(o>=o)if(s<0)for(;++s<=0;)for(;t(o,-1),!a(o););else for(;--s>=0;)for(;t(o,1),!a(o););})},n&&(i.count=function(a,o){return E4.setTime(+a),C4.setTime(+o),e(E4),e(C4),Math.floor(n(E4,C4))},i.every=function(a){return a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(r?function(o){return r(o)%a==0}:function(o){return i.count(0,o)%a==0}):i}),i}var p1=xi(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});p1.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?xi(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):p1};const xc=1e3,cs=xc*60,wc=cs*60,dp=wc*24,A4=dp*7,Fre=dp*30,k4=dp*365;var ad=xi(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*xc)},function(e,t){return(t-e)/xc},function(e){return e.getUTCSeconds()}),T4=xi(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*xc)},function(e,t){e.setTime(+e+t*cs)},function(e,t){return(t-e)/cs},function(e){return e.getMinutes()}),O4=xi(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*xc-e.getMinutes()*cs)},function(e,t){e.setTime(+e+t*wc)},function(e,t){return(t-e)/wc},function(e){return e.getHours()}),od=xi(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*cs)/dp,e=>e.getDate()-1);function hp(e){return xi(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+n*7)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*cs)/A4})}var g1=hp(0),I4=hp(1);hp(2),hp(3);var m1=hp(4);hp(5),hp(6);var GC=xi(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()}),_c=xi(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});_c.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:xi(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)})};var N4=xi(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*cs)},function(e,t){return(t-e)/cs},function(e){return e.getUTCMinutes()}),D4=xi(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*wc)},function(e,t){return(t-e)/wc},function(e){return e.getUTCHours()}),sd=xi(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/dp},function(e){return e.getUTCDate()-1});function pp(e){return xi(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n*7)},function(t,n){return(n-t)/A4})}var v1=pp(0),R4=pp(1);pp(2),pp(3);var y1=pp(4);pp(5),pp(6);var KC=xi(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12},function(e){return e.getUTCMonth()}),Sc=xi(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});Sc.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:xi(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})};function Mre(e,t,n,r,i,a){const o=[[ad,1,xc],[ad,5,5*xc],[ad,15,15*xc],[ad,30,30*xc],[a,1,cs],[a,5,5*cs],[a,15,15*cs],[a,30,30*cs],[i,1,wc],[i,3,3*wc],[i,6,6*wc],[i,12,12*wc],[r,1,dp],[r,2,2*dp],[n,1,A4],[t,1,Fre],[t,3,3*Fre],[e,1,k4]];function s(l,c,f){const d=c<l;d&&([l,c]=[c,l]);const h=f&&typeof f.range=="function"?f:u(l,c,f),p=h?h.range(l,+c+1):[];return d?p.reverse():p}function u(l,c,f){const d=Math.abs(c-l)/f,h=f1(([,,m])=>m).right(o,d);if(h===o.length)return e.every(id(l/k4,c/k4,f));if(h===0)return p1.every(Math.max(id(l,c,f),1));const[p,g]=o[d/o[h-1][2]<o[h][2]/d?h-1:h];return p.every(g)}return[s,u]}const[wHe,_He]=Mre(Sc,KC,v1,sd,D4,N4),[SHe,EHe]=Mre(_c,GC,g1,od,O4,T4),$i="year",oo="quarter",Qi="month",si="week",so="date",ea="day",nl="dayofyear",zo="hours",jo="minutes",fs="seconds",ru="milliseconds",F4=[$i,oo,Qi,si,so,ea,nl,zo,jo,fs,ru],M4=F4.reduce((e,t,n)=>(e[t]=1+n,e),{});function P4(e){const t=wt(e).slice(),n={};return t.length||Se("Missing time unit."),t.forEach(i=>{_t(M4,i)?n[i]=1:Se("Invalid time unit: ".concat(i,"."))}),(n[si]||n[ea]?1:0)+(n[oo]||n[Qi]||n[so]?1:0)+(n[nl]?1:0)>1&&Se("Incompatible time units: ".concat(e)),t.sort((i,a)=>M4[i]-M4[a]),t}const CHe={[$i]:"%Y ",[oo]:"Q%q ",[Qi]:"%b ",[so]:"%d ",[si]:"W%U ",[ea]:"%a ",[nl]:"%j ",[zo]:"%H:00",[jo]:"00:%M",[fs]:":%S",[ru]:".%L",["".concat($i,"-").concat(Qi)]:"%Y-%m ",["".concat($i,"-").concat(Qi,"-").concat(so)]:"%Y-%m-%d ",["".concat(zo,"-").concat(jo)]:"%H:%M"};function Pre(e,t){const n=Rt({},CHe,t),r=P4(e),i=r.length;let a="",o=0,s,u;for(o=0;o<i;)for(s=r.length;s>o;--s)if(u=r.slice(o,s).join("-"),n[u]!=null){a+=n[u],o=s;break}return a.trim()}const gp=new Date;function $4(e){return gp.setFullYear(e),gp.setMonth(0),gp.setDate(1),gp.setHours(0,0,0,0),gp}function $re(e){return Bre(new Date(e))}function Lre(e){return L4(new Date(e))}function Bre(e){return od.count($4(e.getFullYear())-1,e)}function L4(e){return g1.count($4(e.getFullYear())-1,e)}function B4(e){return $4(e).getDay()}function AHe(e,t,n,r,i,a,o){if(0<=e&&e<100){const s=new Date(-1,t,n,r,i,a,o);return s.setFullYear(e),s}return new Date(e,t,n,r,i,a,o)}function zre(e){return Ure(new Date(e))}function jre(e){return z4(new Date(e))}function Ure(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return sd.count(t-1,e)}function z4(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return v1.count(t-1,e)}function j4(e){return gp.setTime(Date.UTC(e,0,1)),gp.getUTCDay()}function kHe(e,t,n,r,i,a,o){if(0<=e&&e<100){const s=new Date(Date.UTC(-1,t,n,r,i,a,o));return s.setUTCFullYear(n.y),s}return new Date(Date.UTC(e,t,n,r,i,a,o))}function Wre(e,t,n,r,i){const a=t||1,o=sn(e),s=(v,y,b)=>(b=b||v,THe(n[b],r[b],v===o&&a,y)),u=new Date,l=nu(e),c=l[$i]?s($i):Ji(2012),f=l[Qi]?s(Qi):l[oo]?s(oo):Jf,d=l[si]&&l[ea]?s(ea,1,si+ea):l[si]?s(si,1):l[ea]?s(ea,1):l[so]?s(so,1):l[nl]?s(nl,1):cv,h=l[zo]?s(zo):Jf,p=l[jo]?s(jo):Jf,g=l[fs]?s(fs):Jf,m=l[ru]?s(ru):Jf;return function(v){u.setTime(+v);const y=c(u);return i(y,f(u),d(u,y),h(u),p(u),g(u),m(u))}}function THe(e,t,n,r){const i=n<=1?e:r?(a,o)=>r+n*Math.floor((e(a,o)-r)/n):(a,o)=>n*Math.floor(e(a,o)/n);return t?(a,o)=>t(i(a,o),o):i}function gv(e,t,n){return t+e*7-(n+6)%7}const OHe={[$i]:e=>e.getFullYear(),[oo]:e=>Math.floor(e.getMonth()/3),[Qi]:e=>e.getMonth(),[so]:e=>e.getDate(),[zo]:e=>e.getHours(),[jo]:e=>e.getMinutes(),[fs]:e=>e.getSeconds(),[ru]:e=>e.getMilliseconds(),[nl]:e=>Bre(e),[si]:e=>L4(e),[si+ea]:(e,t)=>gv(L4(e),e.getDay(),B4(t)),[ea]:(e,t)=>gv(1,e.getDay(),B4(t))},IHe={[oo]:e=>3*e,[si]:(e,t)=>gv(e,0,B4(t))};function Vre(e,t){return Wre(e,t||1,OHe,IHe,AHe)}const NHe={[$i]:e=>e.getUTCFullYear(),[oo]:e=>Math.floor(e.getUTCMonth()/3),[Qi]:e=>e.getUTCMonth(),[so]:e=>e.getUTCDate(),[zo]:e=>e.getUTCHours(),[jo]:e=>e.getUTCMinutes(),[fs]:e=>e.getUTCSeconds(),[ru]:e=>e.getUTCMilliseconds(),[nl]:e=>Ure(e),[si]:e=>z4(e),[ea]:(e,t)=>gv(1,e.getUTCDay(),j4(t)),[si+ea]:(e,t)=>gv(z4(e),e.getUTCDay(),j4(t))},DHe={[oo]:e=>3*e,[si]:(e,t)=>gv(e,0,j4(t))};function qre(e,t){return Wre(e,t||1,NHe,DHe,kHe)}const RHe={[$i]:_c,[oo]:GC.every(3),[Qi]:GC,[si]:g1,[so]:od,[ea]:od,[nl]:od,[zo]:O4,[jo]:T4,[fs]:ad,[ru]:p1},FHe={[$i]:Sc,[oo]:KC.every(3),[Qi]:KC,[si]:v1,[so]:sd,[ea]:sd,[nl]:sd,[zo]:D4,[jo]:N4,[fs]:ad,[ru]:p1};function mv(e){return RHe[e]}function vv(e){return FHe[e]}function Hre(e,t,n){return e?e.offset(t,n):void 0}function Gre(e,t,n){return Hre(mv(e),t,n)}function Kre(e,t,n){return Hre(vv(e),t,n)}function Xre(e,t,n,r){return e?e.range(t,n,r):void 0}function Yre(e,t,n,r){return Xre(mv(e),t,n,r)}function Zre(e,t,n,r){return Xre(vv(e),t,n,r)}const b1=1e3,x1=b1*60,w1=x1*60,XC=w1*24,MHe=XC*7,Jre=XC*30,U4=XC*365,Qre=[$i,Qi,so,zo,jo,fs,ru],_1=Qre.slice(0,-1),S1=_1.slice(0,-1),E1=S1.slice(0,-1),PHe=E1.slice(0,-1),$He=[$i,si],eie=[$i,Qi],tie=[$i],C1=[[_1,1,b1],[_1,5,5*b1],[_1,15,15*b1],[_1,30,30*b1],[S1,1,x1],[S1,5,5*x1],[S1,15,15*x1],[S1,30,30*x1],[E1,1,w1],[E1,3,3*w1],[E1,6,6*w1],[E1,12,12*w1],[PHe,1,XC],[$He,1,MHe],[eie,1,Jre],[eie,3,3*Jre],[tie,1,U4]];function nie(e){const t=e.extent,n=e.maxbins||40,r=Math.abs(l1(t))/n;let i=f1(s=>s[2]).right(C1,r),a,o;return i===C1.length?(a=tie,o=id(t[0]/U4,t[1]/U4,n)):i?(i=C1[r/C1[i-1][2]<C1[i][2]/r?i-1:i],a=i[0],o=i[1]):(a=Qre,o=Math.max(id(t[0],t[1],n),1)),{units:a,step:o}}function W4(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function V4(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function A1(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function rie(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,a=e.days,o=e.shortDays,s=e.months,u=e.shortMonths,l=k1(i),c=T1(i),f=k1(a),d=T1(a),h=k1(o),p=T1(o),g=k1(s),m=T1(s),v=k1(u),y=T1(u),b={a:L,A:W,b:G,B:K,c:null,d:lie,e:lie,f:oGe,g:mGe,G:yGe,H:rGe,I:iGe,j:aGe,L:cie,m:sGe,M:uGe,p:ee,q:ce,Q:mie,s:vie,S:lGe,u:cGe,U:fGe,V:dGe,w:hGe,W:pGe,x:null,X:null,y:gGe,Y:vGe,Z:bGe,"%":gie},x={a:he,A:Oe,b:Te,B:De,c:null,d:die,e:die,f:SGe,g:RGe,G:MGe,H:xGe,I:wGe,j:_Ge,L:hie,m:EGe,M:CGe,p:me,q:P,Q:mie,s:vie,S:AGe,u:kGe,U:TGe,V:OGe,w:IGe,W:NGe,x:null,X:null,y:DGe,Y:FGe,Z:PGe,"%":gie},w={a:A,A:k,b:T,B:I,c:N,d:sie,e:sie,f:QHe,g:oie,G:aie,H:uie,I:uie,j:XHe,L:JHe,m:KHe,M:YHe,p:E,q:GHe,Q:tGe,s:nGe,S:ZHe,u:UHe,U:WHe,V:VHe,w:jHe,W:qHe,x:O,X:D,y:oie,Y:aie,Z:HHe,"%":eGe};b.x=S(n,b),b.X=S(r,b),b.c=S(t,b),x.x=S(n,x),x.X=S(r,x),x.c=S(t,x);function S(F,V){return function(ae){var Y=[],M=-1,B=0,R=F.length,X,ge,xe;for(ae instanceof Date||(ae=new Date(+ae));++M<R;)F.charCodeAt(M)===37&&(Y.push(F.slice(B,M)),(ge=iie[X=F.charAt(++M)])!=null?X=F.charAt(++M):ge=X==="e"?" ":"0",(xe=V[X])&&(X=xe(ae,ge)),Y.push(X),B=M+1);return Y.push(F.slice(B,M)),Y.join("")}}function C(F,V){return function(ae){var Y=A1(1900,void 0,1),M=_(Y,F,ae+="",0),B,R;if(M!=ae.length)return null;if("Q"in Y)return new Date(Y.Q);if("s"in Y)return new Date(Y.s*1e3+("L"in Y?Y.L:0));if(V&&!("Z"in Y)&&(Y.Z=0),"p"in Y&&(Y.H=Y.H%12+Y.p*12),Y.m===void 0&&(Y.m="q"in Y?Y.q:0),"V"in Y){if(Y.V<1||Y.V>53)return null;"w"in Y||(Y.w=1),"Z"in Y?(B=V4(A1(Y.y,0,1)),R=B.getUTCDay(),B=R>4||R===0?R4.ceil(B):R4(B),B=sd.offset(B,(Y.V-1)*7),Y.y=B.getUTCFullYear(),Y.m=B.getUTCMonth(),Y.d=B.getUTCDate()+(Y.w+6)%7):(B=W4(A1(Y.y,0,1)),R=B.getDay(),B=R>4||R===0?I4.ceil(B):I4(B),B=od.offset(B,(Y.V-1)*7),Y.y=B.getFullYear(),Y.m=B.getMonth(),Y.d=B.getDate()+(Y.w+6)%7)}else("W"in Y||"U"in Y)&&("w"in Y||(Y.w="u"in Y?Y.u%7:"W"in Y?1:0),R="Z"in Y?V4(A1(Y.y,0,1)).getUTCDay():W4(A1(Y.y,0,1)).getDay(),Y.m=0,Y.d="W"in Y?(Y.w+6)%7+Y.W*7-(R+5)%7:Y.w+Y.U*7-(R+6)%7);return"Z"in Y?(Y.H+=Y.Z/100|0,Y.M+=Y.Z%100,V4(Y)):W4(Y)}}function _(F,V,ae,Y){for(var M=0,B=V.length,R=ae.length,X,ge;M<B;){if(Y>=R)return-1;if(X=V.charCodeAt(M++),X===37){if(X=V.charAt(M++),ge=w[X in iie?V.charAt(M++):X],!ge||(Y=ge(F,ae,Y))<0)return-1}else if(X!=ae.charCodeAt(Y++))return-1}return Y}function E(F,V,ae){var Y=l.exec(V.slice(ae));return Y?(F.p=c.get(Y[0].toLowerCase()),ae+Y[0].length):-1}function A(F,V,ae){var Y=h.exec(V.slice(ae));return Y?(F.w=p.get(Y[0].toLowerCase()),ae+Y[0].length):-1}function k(F,V,ae){var Y=f.exec(V.slice(ae));return Y?(F.w=d.get(Y[0].toLowerCase()),ae+Y[0].length):-1}function T(F,V,ae){var Y=v.exec(V.slice(ae));return Y?(F.m=y.get(Y[0].toLowerCase()),ae+Y[0].length):-1}function I(F,V,ae){var Y=g.exec(V.slice(ae));return Y?(F.m=m.get(Y[0].toLowerCase()),ae+Y[0].length):-1}function N(F,V,ae){return _(F,t,V,ae)}function O(F,V,ae){return _(F,n,V,ae)}function D(F,V,ae){return _(F,r,V,ae)}function L(F){return o[F.getDay()]}function W(F){return a[F.getDay()]}function G(F){return u[F.getMonth()]}function K(F){return s[F.getMonth()]}function ee(F){return i[+(F.getHours()>=12)]}function ce(F){return 1+~~(F.getMonth()/3)}function he(F){return o[F.getUTCDay()]}function Oe(F){return a[F.getUTCDay()]}function Te(F){return u[F.getUTCMonth()]}function De(F){return s[F.getUTCMonth()]}function me(F){return i[+(F.getUTCHours()>=12)]}function P(F){return 1+~~(F.getUTCMonth()/3)}return{format:function(F){var V=S(F+="",b);return V.toString=function(){return F},V},parse:function(F){var V=C(F+="",!1);return V.toString=function(){return F},V},utcFormat:function(F){var V=S(F+="",x);return V.toString=function(){return F},V},utcParse:function(F){var V=C(F+="",!0);return V.toString=function(){return F},V}}}var iie={"-":"",_:" ","0":"0"},wi=/^\s*\d+/,LHe=/^%/,BHe=/[\\^$*+?|[\]().{}]/g;function _n(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(t)+i:i)}function zHe(e){return e.replace(BHe,"\\$&")}function k1(e){return new RegExp("^(?:"+e.map(zHe).join("|")+")","i")}function T1(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function jHe(e,t,n){var r=wi.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function UHe(e,t,n){var r=wi.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function WHe(e,t,n){var r=wi.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function VHe(e,t,n){var r=wi.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function qHe(e,t,n){var r=wi.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function aie(e,t,n){var r=wi.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function oie(e,t,n){var r=wi.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function HHe(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function GHe(e,t,n){var r=wi.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function KHe(e,t,n){var r=wi.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function sie(e,t,n){var r=wi.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function XHe(e,t,n){var r=wi.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function uie(e,t,n){var r=wi.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function YHe(e,t,n){var r=wi.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function ZHe(e,t,n){var r=wi.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function JHe(e,t,n){var r=wi.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function QHe(e,t,n){var r=wi.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function eGe(e,t,n){var r=LHe.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function tGe(e,t,n){var r=wi.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function nGe(e,t,n){var r=wi.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function lie(e,t){return _n(e.getDate(),t,2)}function rGe(e,t){return _n(e.getHours(),t,2)}function iGe(e,t){return _n(e.getHours()%12||12,t,2)}function aGe(e,t){return _n(1+od.count(_c(e),e),t,3)}function cie(e,t){return _n(e.getMilliseconds(),t,3)}function oGe(e,t){return cie(e,t)+"000"}function sGe(e,t){return _n(e.getMonth()+1,t,2)}function uGe(e,t){return _n(e.getMinutes(),t,2)}function lGe(e,t){return _n(e.getSeconds(),t,2)}function cGe(e){var t=e.getDay();return t===0?7:t}function fGe(e,t){return _n(g1.count(_c(e)-1,e),t,2)}function fie(e){var t=e.getDay();return t>=4||t===0?m1(e):m1.ceil(e)}function dGe(e,t){return e=fie(e),_n(m1.count(_c(e),e)+(_c(e).getDay()===4),t,2)}function hGe(e){return e.getDay()}function pGe(e,t){return _n(I4.count(_c(e)-1,e),t,2)}function gGe(e,t){return _n(e.getFullYear()%100,t,2)}function mGe(e,t){return e=fie(e),_n(e.getFullYear()%100,t,2)}function vGe(e,t){return _n(e.getFullYear()%1e4,t,4)}function yGe(e,t){var n=e.getDay();return e=n>=4||n===0?m1(e):m1.ceil(e),_n(e.getFullYear()%1e4,t,4)}function bGe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+_n(t/60|0,"0",2)+_n(t%60,"0",2)}function die(e,t){return _n(e.getUTCDate(),t,2)}function xGe(e,t){return _n(e.getUTCHours(),t,2)}function wGe(e,t){return _n(e.getUTCHours()%12||12,t,2)}function _Ge(e,t){return _n(1+sd.count(Sc(e),e),t,3)}function hie(e,t){return _n(e.getUTCMilliseconds(),t,3)}function SGe(e,t){return hie(e,t)+"000"}function EGe(e,t){return _n(e.getUTCMonth()+1,t,2)}function CGe(e,t){return _n(e.getUTCMinutes(),t,2)}function AGe(e,t){return _n(e.getUTCSeconds(),t,2)}function kGe(e){var t=e.getUTCDay();return t===0?7:t}function TGe(e,t){return _n(v1.count(Sc(e)-1,e),t,2)}function pie(e){var t=e.getUTCDay();return t>=4||t===0?y1(e):y1.ceil(e)}function OGe(e,t){return e=pie(e),_n(y1.count(Sc(e),e)+(Sc(e).getUTCDay()===4),t,2)}function IGe(e){return e.getUTCDay()}function NGe(e,t){return _n(R4.count(Sc(e)-1,e),t,2)}function DGe(e,t){return _n(e.getUTCFullYear()%100,t,2)}function RGe(e,t){return e=pie(e),_n(e.getUTCFullYear()%100,t,2)}function FGe(e,t){return _n(e.getUTCFullYear()%1e4,t,4)}function MGe(e,t){var n=e.getUTCDay();return e=n>=4||n===0?y1(e):y1.ceil(e),_n(e.getUTCFullYear()%1e4,t,4)}function PGe(){return"+0000"}function gie(){return"%"}function mie(e){return+e}function vie(e){return Math.floor(+e/1e3)}var yv,q4,yie,H4,bie;$Ge({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function $Ge(e){return yv=rie(e),q4=yv.format,yie=yv.parse,H4=yv.utcFormat,bie=yv.utcParse,yv}function O1(e){const t={};return n=>t[n]||(t[n]=e(n))}function LGe(e,t){return n=>{const r=e(n),i=r.indexOf(t);if(i<0)return r;let a=BGe(r,i);const o=a<r.length?r.slice(a):"";for(;--a>i;)if(r[a]!=="0"){++a;break}return r.slice(0,a)+o}}function BGe(e,t){let n=e.lastIndexOf("e"),r;if(n>0)return n;for(n=e.length;--n>t;)if(r=e.charCodeAt(n),r>=48&&r<=57)return n+1}function xie(e){const t=O1(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(r){const i=h1(r||",");if(i.precision==null){switch(i.precision=12,i.type){case"%":i.precision-=2;break;case"e":i.precision-=1;break}return LGe(t(i),t(".1f")(1)[1])}else return t(i)},formatSpan(r,i,a,o){o=h1(o??",f");const s=id(r,i,a),u=Math.max(Math.abs(r),Math.abs(i));let l;if(o.precision==null)switch(o.type){case"s":return isNaN(l=bHe(s,u))||(o.precision=l),n(o,u);case"":case"e":case"g":case"p":case"r":{isNaN(l=xHe(s,u))||(o.precision=l-(o.type==="e"));break}case"f":case"%":{isNaN(l=yHe(s))||(o.precision=l-(o.type==="%")*2);break}}return t(o)}}}let G4;wie();function wie(){return G4=xie({format:Dre,formatPrefix:Rre})}function _ie(e){return xie(Nre(e))}function YC(e){return arguments.length?G4=_ie(e):G4}function Sie(e,t,n){n=n||{},Nt(n)||Se("Invalid time multi-format specifier: ".concat(n));const r=t(fs),i=t(jo),a=t(zo),o=t(so),s=t(si),u=t(Qi),l=t(oo),c=t($i),f=e(n[ru]||".%L"),d=e(n[fs]||":%S"),h=e(n[jo]||"%I:%M"),p=e(n[zo]||"%I %p"),g=e(n[so]||n[ea]||"%a %d"),m=e(n[si]||"%b %d"),v=e(n[Qi]||"%B"),y=e(n[oo]||"%B"),b=e(n[$i]||"%Y");return x=>(r(x)<x?f:i(x)<x?d:a(x)<x?h:o(x)<x?p:u(x)<x?s(x)<x?g:m:c(x)<x?l(x)<x?v:y:b)(x)}function Eie(e){const t=O1(e.format),n=O1(e.utcFormat);return{timeFormat:r=>Bn(r)?t(r):Sie(t,mv,r),utcFormat:r=>Bn(r)?n(r):Sie(n,vv,r),timeParse:O1(e.parse),utcParse:O1(e.utcParse)}}let K4;Cie();function Cie(){return K4=Eie({format:q4,parse:yie,utcFormat:H4,utcParse:bie})}function Aie(e){return Eie(rie(e))}function I1(e){return arguments.length?K4=Aie(e):K4}const X4=(e,t)=>Rt({},e,t);function kie(e,t){const n=e?_ie(e):YC(),r=t?Aie(t):I1();return X4(n,r)}function Y4(e,t){const n=arguments.length;return n&&n!==2&&Se("defaultLocale expects either zero or two arguments."),n?X4(YC(e),I1(t)):X4(YC(),I1())}function zGe(){return wie(),Cie(),Y4()}function Tie(e,t,n,r){t=t||{};const i=m4(t.type||"json");return i||Se("Unknown data format type: "+t.type),e=i(e,t),t.parse&&jGe(e,t.parse,n,r),_t(e,"columns")&&delete e.columns,e}function jGe(e,t,n,r){if(!e.length)return;const i=I1();n=n||i.timeParse,r=r||i.utcParse;let a=e.columns||Object.keys(e[0]),o,s,u,l,c,f;t==="auto"&&(t=ure(e,a)),a=Object.keys(t);const d=a.map(h=>{const p=t[h];let g,m;if(p&&(p.startsWith("date:")||p.startsWith("utc:")))return g=p.split(/:(.+)?/,2),m=g[1],(m[0]==="'"&&m[m.length-1]==="'"||m[0]==='"'&&m[m.length-1]==='"')&&(m=m.slice(1,-1)),(g[0]==="utc"?r:n)(m);if(!c4[p])throw Error("Illegal format pattern: "+h+":"+p);return c4[p]});for(u=0,c=e.length,f=a.length;u<c;++u)for(o=e[u],l=0;l<f;++l)s=a[l],o[s]=d[l](o[s])}const ZC=Iqe(typeof fetch!="undefined"&&fetch,null);function JC(e){const t=e||Oa,n=[],r={};return n.add=i=>{const a=t(i);return r[a]||(r[a]=1,n.push(i)),n},n.remove=i=>{const a=t(i);if(r[a]){r[a]=0;const o=n.indexOf(i);o>=0&&n.splice(o,1)}return n},n}async function QC(e,t){try{await t(e)}catch(n){e.error(n)}}const Oie=Symbol("vega_id");let UGe=1;function eA(e){return!!(e&&lt(e))}function lt(e){return e[Oie]}function Iie(e,t){return e[Oie]=t,e}function In(e){const t=e===Object(e)?e:{data:e};return lt(t)?t:Iie(t,UGe++)}function Z4(e){return tA(e,In({}))}function tA(e,t){for(const n in e)t[n]=e[n];return t}function Nie(e,t){return Iie(t,lt(e))}function mp(e,t){return e?t?(n,r)=>e(n,r)||lt(t(n))-lt(t(r)):(n,r)=>e(n,r)||lt(n)-lt(r):null}function Die(e){return e&&e.constructor===vp}function vp(){const e=[],t=[],n=[],r=[],i=[];let a=null,o=!1;return{constructor:vp,insert(s){const u=wt(s),l=u.length;for(let c=0;c<l;++c)e.push(u[c]);return this},remove(s){const u=Lt(s)?r:t,l=wt(s),c=l.length;for(let f=0;f<c;++f)u.push(l[f]);return this},modify(s,u,l){const c={field:u,value:Ji(l)};return Lt(s)?(c.filter=s,i.push(c)):(c.tuple=s,n.push(c)),this},encode(s,u){return Lt(s)?i.push({filter:s,field:u}):n.push({tuple:s,field:u}),this},clean(s){return a=s,this},reflow(){return o=!0,this},pulse(s,u){const l={},c={};let f,d,h,p,g,m;for(f=0,d=u.length;f<d;++f)l[lt(u[f])]=1;for(f=0,d=t.length;f<d;++f)g=t[f],l[lt(g)]=-1;for(f=0,d=r.length;f<d;++f)p=r[f],u.forEach(y=>{p(y)&&(l[lt(y)]=-1)});for(f=0,d=e.length;f<d;++f)g=e[f],m=lt(g),l[m]?l[m]=1:s.add.push(In(e[f]));for(f=0,d=u.length;f<d;++f)g=u[f],l[lt(g)]<0&&s.rem.push(g);function v(y,b,x){x?y[b]=x(y):s.encode=b,o||(c[lt(y)]=y)}for(f=0,d=n.length;f<d;++f)h=n[f],g=h.tuple,p=h.field,m=l[lt(g)],m>0&&(v(g,p,h.value),s.modifies(p));for(f=0,d=i.length;f<d;++f)h=i[f],p=h.filter,u.forEach(y=>{p(y)&&l[lt(y)]>0&&v(y,h.field,h.value)}),s.modifies(h.field);if(o)s.mod=t.length||r.length?u.filter(y=>l[lt(y)]>0):u.slice();else for(m in c)s.mod.push(c[m]);return(a||a==null&&(t.length||r.length))&&s.clean(!0),s}}}const nA="_:mod:_";function rA(){Object.defineProperty(this,nA,{writable:!0,value:{}})}rA.prototype={set(e,t,n,r){const i=this,a=i[e],o=i[nA];return t!=null&&t>=0?(a[t]!==n||r)&&(a[t]=n,o[t+":"+e]=-1,o[e]=-1):(a!==n||r)&&(i[e]=n,o[e]=ut(n)?1+n.length:-1),i},modified(e,t){const n=this[nA];if(arguments.length){if(ut(e)){for(let r=0;r<e.length;++r)if(n[e[r]])return!0;return!1}}else{for(const r in n)if(n[r])return!0;return!1}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[nA]={},this}};let WGe=0;const VGe="pulse",qGe=new rA,HGe=1,GGe=2;function Xn(e,t,n,r){this.id=++WGe,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,r)}function Rie(e){return function(t){const n=this.flags;return arguments.length===0?!!(n&e):(this.flags=t?n|e:n&~e,this)}}Xn.prototype={targets(){return this._targets||(this._targets=JC(s1))},set(e){return this.value!==e?(this.value=e,1):0},skip:Rie(HGe),modified:Rie(GGe),parameters(e,t,n){t=t!==!1;const r=this._argval=this._argval||new rA,i=this._argops=this._argops||[],a=[];let o,s,u,l;const c=(f,d,h)=>{h instanceof Xn?(h!==this&&(t&&h.targets().add(this),a.push(h)),i.push({op:h,name:f,index:d})):r.set(f,d,h)};for(o in e)if(s=e[o],o===VGe)wt(s).forEach(f=>{f instanceof Xn?f!==this&&(f.targets().add(this),a.push(f)):Se("Pulse parameters must be operator instances.")}),this.source=s;else if(ut(s))for(r.set(o,-1,Array(u=s.length)),l=0;l<u;++l)c(o,l,s[l]);else c(o,-1,s);return this.marshall().clear(),n&&(i.initonly=!0),a},marshall(e){const t=this._argval||qGe,n=this._argops;let r,i,a,o;if(n){const s=n.length;for(i=0;i<s;++i)r=n[i],a=r.op,o=a.modified()&&a.stamp===e,t.set(r.name,r.index,a.value,o);if(n.initonly){for(i=0;i<s;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,r,i;if(e)for(t=0,n=e.length;t<n;++t)r=e[t],i=r.op,i._targets&&i._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),r=t.call(this,n,e);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};function KGe(e,t,n,r){let i=1,a;return e instanceof Xn?a=e:e&&e.prototype instanceof Xn?a=new e:Lt(e)?a=new Xn(null,e):(i=0,a=new Xn(e,t)),this.rank(a),i&&(r=n,n=t),n&&this.connect(a,a.parameters(n,r)),this.touch(a),a}function XGe(e,t){const n=e.rank,r=t.length;for(let i=0;i<r;++i)if(n<t[i].rank){this.rerank(e);return}}let YGe=0;function iA(e,t,n){this.id=++YGe,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function ud(e,t,n){return new iA(e,t,n)}iA.prototype={_filter:ls,_apply:Oa,targets(){return this._targets||(this._targets=JC(s1))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,r=n?n.length:0;for(let i=0;i<r;++i)n[i].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=ud(e);return this.targets().add(t),t},apply(e){const t=ud(null,e);return this.targets().add(t),t},merge(){const e=ud();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{const n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){const t=ud();return this.targets().add(ud(null,null,i4(e,n=>{const r=n.dataflow;t.receive(n),r&&r.run&&r.run()}))),t},between(e,t){let n=!1;return e.targets().add(ud(null,null,()=>n=!0)),t.targets().add(ud(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=ls,this._targets=null}};function ZGe(e,t,n,r){const i=this,a=ud(n,r),o=function(l){l.dataflow=i;try{a.receive(l)}catch(c){i.error(c)}finally{i.run()}};let s;typeof e=="string"&&typeof document!="undefined"?s=document.querySelectorAll(e):s=wt(e);const u=s.length;for(let l=0;l<u;++l)s[l].addEventListener(t,o);return a}function JGe(e,t){const n=this.locale();return Tie(e,t,n.timeParse,n.utcParse)}function QGe(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))}async function eKe(e,t){const n=this;let r=0,i;try{i=await n.loader().load(e,{context:"dataflow",response:mre(t&&t.type)});try{i=n.parse(i,t)}catch(a){r=-2,n.warn("Data ingestion failed",e,a)}}catch(a){r=-1,n.warn("Loading failed",e,a)}return{data:i,status:r}}async function tKe(e,t,n){const r=this,i=r._pending||nKe(r);i.requests+=1;const a=await r.request(t,n);return r.pulse(e,r.changeset().remove(ls).insert(a.data||[])),i.done(),a}function nKe(e){let t;const n=new Promise(r=>t=r);return n.requests=0,n.done=()=>{--n.requests==0&&(e._pending=null,t(e))},e._pending=n}const rKe={skip:!0};function iKe(e,t,n,r,i){return(e instanceof Xn?oKe:aKe)(this,e,t,n,r,i),this}function aKe(e,t,n,r,i,a){const o=Rt({},a,rKe);let s,u;Lt(n)||(n=Ji(n)),r===void 0?s=l=>e.touch(n(l)):Lt(r)?(u=new Xn(null,r,i,!1),s=l=>{u.evaluate(l);const c=n(l),f=u.value;Die(f)?e.pulse(c,f,a):e.update(c,f,o)}):s=l=>e.update(n(l),r,o),t.apply(s)}function oKe(e,t,n,r,i,a){if(r===void 0)t.targets().add(n);else{const o=a||{},s=new Xn(null,sKe(n,r),i,!1);s.modified(o.force),s.rank=t.rank,t.targets().add(s),n&&(s.skip(!0),s.value=n.value,s.targets().add(n),e.connect(n,[s]))}}function sKe(e,t){return t=Lt(t)?t:Ji(t),e?function(n,r){const i=t(n,r);return e.skip()||(e.skip(i!==this.value).value=i),i}:t}function uKe(e){e.rank=++this._rank}function lKe(e){const t=[e];let n,r,i;for(;t.length;)if(this.rank(n=t.pop()),r=n._targets)for(i=r.length;--i>=0;)t.push(n=r[i]),n===e&&Se("Cycle detected in dataflow graph.")}const aA={},rl=1<<0,ld=1<<1,Ec=1<<2,cKe=rl|ld,Fie=rl|Ec,bv=rl|ld|Ec,Mie=1<<3,N1=1<<4,Pie=1<<5,$ie=1<<6;function cd(e,t,n){this.dataflow=e,this.stamp=t??-1,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function J4(e,t){const n=[];return nd(e,t,r=>n.push(r)),n}function Lie(e,t){const n={};return e.visit(t,r=>{n[lt(r)]=1}),r=>n[lt(r)]?null:r}function oA(e,t){return e?(n,r)=>e(n,r)&&t(n,r):t}cd.prototype={StopPropagation:aA,ADD:rl,REM:ld,MOD:Ec,ADD_REM:cKe,ADD_MOD:Fie,ALL:bv,REFLOW:Mie,SOURCE:N1,NO_SOURCE:Pie,NO_FIELDS:$ie,fork(e){return new cd(this.dataflow).init(this,e)},clone(){const e=this.fork(bv);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(bv|N1)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new cd(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(t&$ie)&&(n.fields=e.fields),t&rl?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),t&ld?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),t&Ec?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),t&Pie?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||bv;return t&rl&&this.add.length||t&ld&&this.rem.length||t&Ec&&this.mod.length},reflow(e){if(e)return this.fork(bv).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(Ec,Lie(this,rl))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return ut(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return(t||this.mod.length)&&n?arguments.length?ut(e)?e.some(r=>n[r]):n[e]:!!n:!1},filter(e,t){const n=this;return e&rl&&(n.addF=oA(n.addF,t)),e&ld&&(n.remF=oA(n.remF,t)),e&Ec&&(n.modF=oA(n.modF,t)),e&N1&&(n.srcF=oA(n.srcF,t)),n},materialize(e){e=e||bv;const t=this;return e&rl&&t.addF&&(t.add=J4(t.add,t.addF),t.addF=null),e&ld&&t.remF&&(t.rem=J4(t.rem,t.remF),t.remF=null),e&Ec&&t.modF&&(t.mod=J4(t.mod,t.modF),t.modF=null),e&N1&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,r=t;if(e&N1)return nd(n.source,n.srcF,r),n;e&rl&&nd(n.add,n.addF,r),e&ld&&nd(n.rem,n.remF,r),e&Ec&&nd(n.mod,n.modF,r);const i=n.source;if(e&Mie&&i){const a=n.add.length+n.mod.length;a===i.length||(a?nd(i,Lie(n,Fie),r):nd(i,n.srcF,r))}return n}};function Q4(e,t,n,r){const i=this,a=n.length;let o=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=r||null,this.pulses=n;for(let s=0;s<a;++s){const u=n[s];if(u.stamp===t){if(u.fields){const l=i.fields||(i.fields={});for(const c in u.fields)l[c]=1}u.changed(i.ADD)&&(o|=i.ADD),u.changed(i.REM)&&(o|=i.REM),u.changed(i.MOD)&&(o|=i.MOD)}}this.changes=o}$e(Q4,cd,{fork(e){const t=new cd(this.dataflow).init(this,e&this.NO_FIELDS);return e!==void 0&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?ut(e)?e.some(r=>n[r]):n[e]:0},filter(){Se("MultiPulse does not support filtering.")},materialize(){Se("MultiPulse does not support materialization.")},visit(e,t){const n=this,r=n.pulses,i=r.length;let a=0;if(e&n.SOURCE)for(;a<i;++a)r[a].visit(e,t);else for(;a<i;++a)r[a].stamp===n.stamp&&r[a].visit(e,t);return n}});async function fKe(e,t,n){const r=this,i=[];if(r._pulse)return Bie(r);if(r._pending&&await r._pending,t&&await QC(r,t),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;const a=++r._clock;r._pulse=new cd(r,a,e),r._touched.forEach(c=>r._enqueue(c,!0)),r._touched=JC(s1);let o=0,s,u,l;try{for(;r._heap.size()>0;){if(s=r._heap.pop(),s.rank!==s.qrank){r._enqueue(s,!0);continue}u=s.run(r._getPulse(s,e)),u.then?u=await u:u.async&&(i.push(u.async),u=aA),u!==aA&&s._targets&&s._targets.forEach(c=>r._enqueue(c)),++o}}catch(c){r._heap.clear(),l=c}if(r._input={},r._pulse=null,r.debug(`Pulse ${a}: ${o} operators`),l&&(r._postrun=[],r.error(l)),r._postrun.length){const c=r._postrun.sort((f,d)=>d.priority-f.priority);r._postrun=[];for(let f=0;f<c.length;++f)await QC(r,c[f].callback)}return n&&await QC(r,n),i.length&&Promise.all(i).then(c=>r.runAsync(null,()=>{c.forEach(f=>{try{f(r)}catch(d){r.error(d)}})})),r}async function dKe(e,t,n){for(;this._running;)await this._running;const r=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(r,r),this._running}function hKe(e,t,n){return this._pulse?Bie(this):(this.evaluate(e,t,n),this)}function pKe(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(r){this.error(r)}}function Bie(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}function gKe(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))}function mKe(e,t){const n=e.source,r=this._clock;return n&&ut(n)?new Q4(this,r,n.map(i=>i.pulse),t):this._input[e.id]||vKe(this._pulse,n&&n.pulse)}function vKe(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==aA&&(e.source=t.source),e)}const eL={skip:!1,force:!1};function yKe(e,t){const n=t||eL;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this}function bKe(e,t,n){const r=n||eL;return(e.set(t)||r.force)&&this.touch(e,r),this}function xKe(e,t,n){this.touch(e,n||eL);const r=new cd(this,this._clock+(this._pulse?0:1)),i=e.pulse&&e.pulse.source||[];return r.target=e,this._input[e.id]=t.pulse(r,i),this}function wKe(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),zie(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let r;return t.length?(r=t[0],t[0]=n,_Ke(t,0,e)):r=n,r}}}function zie(e,t,n,r){let i,a;const o=e[n];for(;n>t;){if(a=n-1>>1,i=e[a],r(o,i)<0){e[n]=i,n=a;continue}break}return e[n]=o}function _Ke(e,t,n){const r=t,i=e.length,a=e[t];let o=(t<<1)+1,s;for(;o<i;)s=o+1,s<i&&n(e[o],e[s])>=0&&(o=s),e[t]=e[o],t=o,o=(t<<1)+1;return e[t]=a,zie(e,r,t,n)}function xv(){this.logger($ne()),this.logLevel(Q$),this._clock=0,this._rank=0,this._locale=Y4();try{this._loader=ZC()}catch(e){}this._touched=JC(s1),this._input={},this._pulse=null,this._heap=wKe((e,t)=>e.qrank-t.qrank),this._postrun=[]}function D1(e){return function(){return this._log[e].apply(this,arguments)}}xv.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:D1("error"),warn:D1("warn"),info:D1("info"),debug:D1("debug"),logLevel:D1("level"),cleanThreshold:1e4,add:KGe,connect:XGe,rank:uKe,rerank:lKe,pulse:xKe,touch:yKe,update:bKe,changeset:vp,ingest:QGe,parse:JGe,preload:tKe,request:eKe,events:ZGe,on:iKe,evaluate:fKe,run:hKe,runAsync:dKe,runAfter:pKe,_enqueue:gKe,_getPulse:mKe};function ve(e,t){Xn.call(this,e,null,t)}$e(ve,Xn,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const wv={};function jie(e){const t=Uie(e);return t&&t.Definition||null}function Uie(e){return e=e&&e.toLowerCase(),_t(wv,e)?wv[e]:null}function*Wie(e,t){if(t==null)for(let n of e)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)r=t(r,++n,e),r!=null&&r!==""&&(r=+r)>=r&&(yield r)}}function tL(e,t,n){const r=Float64Array.from(Wie(e,n));return r.sort(hv),t.map(i=>wre(r,i))}function nL(e,t){return tL(e,[.25,.5,.75],t)}function rL(e,t){const n=e.length,r=sHe(e,t),i=nL(e,t),a=(i[2]-i[0])/1.34,o=Math.min(r,a)||r||Math.abs(i[0])||1;return 1.06*o*Math.pow(n,-.2)}function Vie(e){const t=e.maxbins||20,n=e.base||10,r=Math.log(n),i=e.divide||[5,2];let a=e.extent[0],o=e.extent[1],s,u,l,c,f,d;const h=e.span||o-a||Math.abs(a)||1;if(e.step)s=e.step;else if(e.steps){for(c=h/t,f=0,d=e.steps.length;f<d&&e.steps[f]<c;++f);s=e.steps[Math.max(0,f-1)]}else{for(u=Math.ceil(Math.log(t)/r),l=e.minstep||0,s=Math.max(l,Math.pow(n,Math.round(Math.log(h)/r)-u));Math.ceil(h/s)>t;)s*=n;for(f=0,d=i.length;f<d;++f)c=s/i[f],c>=l&&h/c<=t&&(s=c)}c=Math.log(s);const p=c>=0?0:~~(-c/r)+1,g=Math.pow(n,-p-1);return(e.nice||e.nice===void 0)&&(c=Math.floor(a/s+g)*s,a=a<c?c-s:c,o=Math.ceil(o/s)*s),{start:a,stop:o===a?a+s:o,step:s}}var ds=Math.random;function SKe(e){ds=e}function qie(e,t,n,r){if(!e.length)return[void 0,void 0];const i=Float64Array.from(Wie(e,r)),a=i.length,o=t;let s,u,l,c;for(l=0,c=Array(o);l<o;++l){for(s=0,u=0;u<a;++u)s+=i[~~(ds()*a)];c[l]=s/a}return c.sort(hv),[_4(c,n/2),_4(c,1-n/2)]}function Hie(e,t,n,r){r=r||(d=>d);const i=e.length,a=new Float64Array(i);let o=0,s=1,u=r(e[0]),l=u,c=u+t,f;for(;s<i;++s){if(f=r(e[s]),f>=c){for(l=(u+l)/2;o<s;++o)a[o]=l;c=f+t,u=f}l=f}for(l=(u+l)/2;o<s;++o)a[o]=l;return n?EKe(a,t+t/4):a}function EKe(e,t){const n=e.length;let r=0,i=1,a,o;for(;e[r]===e[i];)++i;for(;i<n;){for(a=i+1;e[i]===e[a];)++a;if(e[i]-e[i-1]<t){for(o=i+(r+a-i-i>>1);o<i;)e[o++]=e[i];for(;o>i;)e[o--]=e[r]}r=i,i=a}return e}function CKe(e){return function(){return e=(1103515245*e+12345)%2147483647,e/2147483647}}function AKe(e,t){t==null&&(t=e,e=0);let n,r,i;const a={min(o){return arguments.length?(n=o||0,i=r-n,a):n},max(o){return arguments.length?(r=o||0,i=r-n,a):r},sample(){return n+Math.floor(i*ds())},pdf(o){return o===Math.floor(o)&&o>=n&&o<r?1/i:0},cdf(o){const s=Math.floor(o);return s<n?0:s>=r?1:(s-n+1)/i},icdf(o){return o>=0&&o<=1?n-1+Math.floor(o*i):NaN}};return a.min(e).max(t)}const Gie=Math.sqrt(2*Math.PI),kKe=Math.SQRT2;let R1=NaN;function sA(e,t){e=e||0,t=t??1;let n=0,r=0,i,a;if(R1===R1)n=R1,R1=NaN;else{do n=ds()*2-1,r=ds()*2-1,i=n*n+r*r;while(i===0||i>1);a=Math.sqrt(-2*Math.log(i)/i),n*=a,R1=r*a}return e+n*t}function iL(e,t,n){n=n??1;const r=(e-(t||0))/n;return Math.exp(-.5*r*r)/(n*Gie)}function uA(e,t,n){t=t||0,n=n??1;const r=(e-t)/n,i=Math.abs(r);let a;if(i>37)a=0;else{const o=Math.exp(-i*i/2);let s;i<7.07106781186547?(s=.0352624965998911*i+.700383064443688,s=s*i+6.37396220353165,s=s*i+33.912866078383,s=s*i+112.079291497871,s=s*i+221.213596169931,s=s*i+220.206867912376,a=o*s,s=.0883883476483184*i+1.75566716318264,s=s*i+16.064177579207,s=s*i+86.7807322029461,s=s*i+296.564248779674,s=s*i+637.333633378831,s=s*i+793.826512519948,s=s*i+440.413735824752,a=a/s):(s=i+.65,s=i+4/s,s=i+3/s,s=i+2/s,s=i+1/s,a=o/s/2.506628274631)}return r>0?1-a:a}function lA(e,t,n){return e<0||e>1?NaN:(t||0)+(n??1)*kKe*TKe(2*e-1)}function TKe(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function aL(e,t){let n,r;const i={mean(a){return arguments.length?(n=a||0,i):n},stdev(a){return arguments.length?(r=a??1,i):r},sample:()=>sA(n,r),pdf:a=>iL(a,n,r),cdf:a=>uA(a,n,r),icdf:a=>lA(a,n,r)};return i.mean(e).stdev(t)}function oL(e,t){const n=aL();let r=0;const i={data(a){return arguments.length?(e=a,r=a?a.length:0,i.bandwidth(t)):e},bandwidth(a){return arguments.length?(t=a,!t&&e&&(t=rL(e)),i):t},sample(){return e[~~(ds()*r)]+t*n.sample()},pdf(a){let o=0,s=0;for(;s<r;++s)o+=n.pdf((a-e[s])/t);return o/t/r},cdf(a){let o=0,s=0;for(;s<r;++s)o+=n.cdf((a-e[s])/t);return o/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(e)}function sL(e,t){return e=e||0,t=t??1,Math.exp(e+sA()*t)}function uL(e,t,n){if(e<=0)return 0;t=t||0,n=n??1;const r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*Gie*e)}function lL(e,t,n){return uA(Math.log(e),t,n)}function cL(e,t,n){return Math.exp(lA(e,t,n))}function Kie(e,t){let n,r;const i={mean(a){return arguments.length?(n=a||0,i):n},stdev(a){return arguments.length?(r=a??1,i):r},sample:()=>sL(n,r),pdf:a=>uL(a,n,r),cdf:a=>lL(a,n,r),icdf:a=>cL(a,n,r)};return i.mean(e).stdev(t)}function Xie(e,t){let n=0,r;function i(o){const s=[];let u=0,l;for(l=0;l<n;++l)u+=s[l]=o[l]==null?1:+o[l];for(l=0;l<n;++l)s[l]/=u;return s}const a={weights(o){return arguments.length?(r=i(t=o||[]),a):t},distributions(o){return arguments.length?(o?(n=o.length,e=o):(n=0,e=[]),a.weights(t)):e},sample(){const o=ds();let s=e[n-1],u=r[0],l=0;for(;l<n-1;u+=r[++l])if(o<u){s=e[l];break}return s.sample()},pdf(o){let s=0,u=0;for(;u<n;++u)s+=r[u]*e[u].pdf(o);return s},cdf(o){let s=0,u=0;for(;u<n;++u)s+=r[u]*e[u].cdf(o);return s},icdf(){throw Error("Mixture icdf not supported.")}};return a.distributions(e).weights(t)}function fL(e,t){return t==null&&(t=e??1,e=0),e+(t-e)*ds()}function dL(e,t,n){return n==null&&(n=t??1,t=0),e>=t&&e<=n?1/(n-t):0}function hL(e,t,n){return n==null&&(n=t??1,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function pL(e,t,n){return n==null&&(n=t??1,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function Yie(e,t){let n,r;const i={min(a){return arguments.length?(n=a||0,i):n},max(a){return arguments.length?(r=a??1,i):r},sample:()=>fL(n,r),pdf:a=>dL(a,n,r),cdf:a=>hL(a,n,r),icdf:a=>pL(a,n,r)};return t==null&&(t=e??1,e=0),i.min(e).max(t)}function F1(e,t,n,r){const i=r-e*e,a=Math.abs(i)<1e-24?0:(n-e*t)/i;return[t-a*e,a]}function cA(e,t,n,r){e=e.filter(h=>{let p=t(h),g=n(h);return p!=null&&(p=+p)>=p&&g!=null&&(g=+g)>=g}),r&&e.sort((h,p)=>t(h)-t(p));const i=e.length,a=new Float64Array(i),o=new Float64Array(i);let s=0,u=0,l=0,c,f,d;for(d of e)a[s]=c=+t(d),o[s]=f=+n(d),++s,u+=(c-u)/s,l+=(f-l)/s;for(s=0;s<i;++s)a[s]-=u,o[s]-=l;return[a,o,u,l]}function M1(e,t,n,r){let i=-1,a,o;for(const s of e)a=t(s),o=n(s),a!=null&&(a=+a)>=a&&o!=null&&(o=+o)>=o&&r(a,o,++i)}function _v(e,t,n,r,i){let a=0,o=0;return M1(e,t,n,(s,u)=>{const l=u-i(s),c=u-r;a+=l*l,o+=c*c}),1-a/o}function gL(e,t,n){let r=0,i=0,a=0,o=0,s=0;M1(e,t,n,(c,f)=>{++s,r+=(c-r)/s,i+=(f-i)/s,a+=(c*f-a)/s,o+=(c*c-o)/s});const u=F1(r,i,a,o),l=c=>u[0]+u[1]*c;return{coef:u,predict:l,rSquared:_v(e,t,n,i,l)}}function Zie(e,t,n){let r=0,i=0,a=0,o=0,s=0;M1(e,t,n,(c,f)=>{++s,c=Math.log(c),r+=(c-r)/s,i+=(f-i)/s,a+=(c*f-a)/s,o+=(c*c-o)/s});const u=F1(r,i,a,o),l=c=>u[0]+u[1]*Math.log(c);return{coef:u,predict:l,rSquared:_v(e,t,n,i,l)}}function Jie(e,t,n){const[r,i,a,o]=cA(e,t,n);let s=0,u=0,l=0,c=0,f=0,d,h,p;M1(e,t,n,(y,b)=>{d=r[f++],h=Math.log(b),p=d*b,s+=(b*h-s)/f,u+=(p-u)/f,l+=(p*h-l)/f,c+=(d*p-c)/f});const[g,m]=F1(u/o,s/o,l/o,c/o),v=y=>Math.exp(g+m*(y-a));return{coef:[Math.exp(g-m*a),m],predict:v,rSquared:_v(e,t,n,o,v)}}function Qie(e,t,n){let r=0,i=0,a=0,o=0,s=0,u=0;M1(e,t,n,(f,d)=>{const h=Math.log(f),p=Math.log(d);++u,r+=(h-r)/u,i+=(p-i)/u,a+=(h*p-a)/u,o+=(h*h-o)/u,s+=(d-s)/u});const l=F1(r,i,a,o),c=f=>l[0]*Math.pow(f,l[1]);return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:_v(e,t,n,s,c)}}function mL(e,t,n){const[r,i,a,o]=cA(e,t,n),s=r.length;let u=0,l=0,c=0,f=0,d=0,h,p,g,m;for(h=0;h<s;)p=r[h],g=i[h++],m=p*p,u+=(m-u)/h,l+=(m*p-l)/h,c+=(m*m-c)/h,f+=(p*g-f)/h,d+=(m*g-d)/h;const v=c-u*u,y=u*v-l*l,b=(d*u-f*l)/y,x=(f*v-d*l)/y,w=-b*u,S=C=>(C=C-a,b*C*C+x*C+w+o);return{coef:[w-x*a+b*a*a+o,x-2*b*a,b],predict:S,rSquared:_v(e,t,n,o,S)}}function eae(e,t,n,r){if(r===1)return gL(e,t,n);if(r===2)return mL(e,t,n);const[i,a,o,s]=cA(e,t,n),u=i.length,l=[],c=[],f=r+1;let d,h,p,g,m;for(d=0;d<f;++d){for(p=0,g=0;p<u;++p)g+=Math.pow(i[p],d)*a[p];for(l.push(g),m=new Float64Array(f),h=0;h<f;++h){for(p=0,g=0;p<u;++p)g+=Math.pow(i[p],d+h);m[h]=g}c.push(m)}c.push(l);const v=IKe(c),y=b=>{b-=o;let x=s+v[0]+v[1]*b+v[2]*b*b;for(d=3;d<f;++d)x+=v[d]*Math.pow(b,d);return x};return{coef:OKe(f,v,-o,s),predict:y,rSquared:_v(e,t,n,s,y)}}function OKe(e,t,n,r){const i=Array(e);let a,o,s,u;for(a=0;a<e;++a)i[a]=0;for(a=e-1;a>=0;--a)for(s=t[a],u=1,i[a]+=s,o=1;o<=a;++o)u*=(a+1-o)/o,i[a-o]+=s*Math.pow(n,o)*u;return i[0]+=r,i}function IKe(e){const t=e.length-1,n=[];let r,i,a,o,s;for(r=0;r<t;++r){for(o=r,i=r+1;i<t;++i)Math.abs(e[r][i])>Math.abs(e[r][o])&&(o=i);for(a=r;a<t+1;++a)s=e[a][r],e[a][r]=e[a][o],e[a][o]=s;for(i=r+1;i<t;++i)for(a=t;a>=r;a--)e[a][i]-=e[a][r]*e[r][i]/e[r][r]}for(i=t-1;i>=0;--i){for(s=0,a=i+1;a<t;++a)s+=e[a][i]*n[a];n[i]=(e[t][i]-s)/e[i][i]}return n}const tae=2,nae=1e-12;function rae(e,t,n,r){const[i,a,o,s]=cA(e,t,n,!0),u=i.length,l=Math.max(2,~~(r*u)),c=new Float64Array(u),f=new Float64Array(u),d=new Float64Array(u).fill(1);for(let h=-1;++h<=tae;){const p=[0,l-1];for(let m=0;m<u;++m){const v=i[m],y=p[0],b=p[1],x=v-i[y]>i[b]-v?y:b;let w=0,S=0,C=0,_=0,E=0;const A=1/Math.abs(i[x]-v||1);for(let I=y;I<=b;++I){const N=i[I],O=a[I],D=NKe(Math.abs(v-N)*A)*d[I],L=N*D;w+=D,S+=L,C+=O*D,_+=O*L,E+=N*L}const[k,T]=F1(S/w,C/w,_/w,E/w);c[m]=k+T*v,f[m]=Math.abs(a[m]-c[m]),DKe(i,m+1,p)}if(h===tae)break;const g=_re(f);if(Math.abs(g)<nae)break;for(let m=0,v,y;m<u;++m)v=f[m]/(6*g),d[m]=v>=1?nae:(y=1-v*v)*y}return RKe(i,c,o,s)}function NKe(e){return(e=1-e*e*e)*e*e}function DKe(e,t,n){const r=e[t];let i=n[0],a=n[1]+1;if(!(a>=e.length))for(;t>i&&e[a]-r<=r-e[i];)n[0]=++i,n[1]=a,++a}function RKe(e,t,n,r){const i=e.length,a=[];let o=0,s=0,u=[],l;for(;o<i;++o)l=e[o]+n,u[0]===l?u[1]+=(t[o]-u[1])/++s:(s=0,u[1]+=r,u=[l,t[o]],a.push(u));return u[1]+=r,a}const FKe=.1*Math.PI/180;function fA(e,t,n,r){n=n||25,r=Math.max(n,r||200);const i=h=>[h,e(h)],a=t[0],o=t[1],s=o-a,u=s/r,l=[i(a)],c=[];if(n===r){for(let h=1;h<r;++h)l.push(i(a+h/n*s));return l.push(i(o)),l}else{c.push(i(o));for(let h=n;--h>0;)c.push(i(a+h/n*s))}let f=l[0],d=c[c.length-1];for(;d;){const h=i((f[0]+d[0])/2);h[0]-f[0]>=u&&MKe(f,h,d)>FKe?c.push(h):(f=d,l.push(d),c.pop()),d=c[c.length-1]}return l}function MKe(e,t,n){const r=Math.atan2(n[1]-e[1],n[0]-e[0]),i=Math.atan2(t[1]-e[1],t[0]-e[0]);return Math.abs(r-i)}function PKe(e){return t=>{const n=e.length;let r=1,i=String(e[0](t));for(;r<n;++r)i+="|"+e[r](t);return i}}function vL(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:PKe(e)}function iae(e,t,n){return n||e+(t?"_"+t:"")}const yL=()=>{},$Ke={init:yL,add:yL,rem:yL,idx:0},P1={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.sum,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||e.min===void 0)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||e.max===void 0)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},$1=Object.keys(P1);function LKe(e,t){return n=>Rt({name:e,out:n||e},$Ke,t)}$1.forEach(e=>{P1[e]=LKe(e,P1[e])});function aae(e,t){return P1[e](t)}function oae(e,t){return e.idx-t.idx}function BKe(e){const t={};e.forEach(r=>t[r.name]=r);const n=r=>{!r.req||r.req.forEach(i=>{t[i]||n(t[i]=P1[i]())})};return e.forEach(n),Object.values(t).sort(oae)}function zKe(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.init(this))}function jKe(e,t){if(e==null||e===""){++this.missing;return}e===e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t)))}function UKe(e,t){if(e==null||e===""){--this.missing;return}e===e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t)))}function WKe(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function sae(e,t){const n=t||Oa,r=BKe(e),i=e.slice().sort(oae);function a(o){this._ops=r,this._out=i,this.cell=o,this.init()}return a.prototype.init=zKe,a.prototype.add=jKe,a.prototype.rem=UKe,a.prototype.set=WKe,a.prototype.get=n,a.fields=e.map(o=>o.out),a}function bL(e){this._key=e?io(e):lt,this.reset()}const Li=bL.prototype;Li.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},Li.add=function(e){this._add.push(e)},Li.rem=function(e){this._rem.push(e)},Li.values=function(){if(this._get=null,this._rem.length===0)return this._add;const e=this._add,t=this._rem,n=this._key,r=e.length,i=t.length,a=Array(r-i),o={};let s,u,l;for(s=0;s<i;++s)o[n(t[s])]=1;for(s=0,u=0;s<r;++s)o[n(l=e[s])]?o[n(l)]=0:a[u++]=l;return this._rem=[],this._add=a},Li.distinct=function(e){const t=this.values(),n={};let r=t.length,i=0,a;for(;--r>=0;)a=e(t[r])+"",_t(n,a)||(n[a]=1,++i);return i},Li.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=Yne(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext},Li.argmin=function(e){return this.extent(e)[0]||{}},Li.argmax=function(e){return this.extent(e)[1]||{}},Li.min=function(e){const t=this.extent(e)[0];return t!=null?e(t):void 0},Li.max=function(e){const t=this.extent(e)[1];return t!=null?e(t):void 0},Li.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=nL(this.values(),e),this._get=e),this._q},Li.q1=function(e){return this.quartile(e)[0]},Li.q2=function(e){return this.quartile(e)[1]},Li.q3=function(e){return this.quartile(e)[2]},Li.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=qie(this.values(),1e3,.05,e),this._get=e),this._ci},Li.ci0=function(e){return this.ci(e)[0]},Li.ci1=function(e){return this.ci(e)[1]};function fd(e){ve.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}fd.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:$1},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]},$e(fd,ve,{transform(e,t){const n=this,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.modified();return n.stamp=r.stamp,n.value&&(i||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(e):{},t.visit(t.SOURCE,a=>n.add(a))):(n.value=n.value||n.init(e),t.visit(t.REM,a=>n.rem(a)),t.visit(t.ADD,a=>n.add(a))),r.modifies(n._outputs),n._drop=e.drop!==!1,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&r.clean(!0).runAfter(()=>this.clean()),n.changes(r)},cross(){const e=this,t=e.value,n=e._dnames,r=n.map(()=>({})),i=n.length;function a(s){let u,l,c,f;for(u in s)for(c=s[u].tuple,l=0;l<i;++l)r[l][f=c[n[l]]]=f}a(e._prev),a(t);function o(s,u,l){const c=n[l],f=r[l++];for(const d in f){const h=s?s+"|"+d:d;u[c]=f[d],l<i?o(h,u,l):t[h]||e.cell(h,u)}}o("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],r={};function i(m){const v=wt(Yi(m)),y=v.length;let b=0,x;for(;b<y;++b)r[x=v[b]]||(r[x]=1,t.push(x))}this._dims=wt(e.groupby),this._dnames=this._dims.map(m=>{const v=Tr(m);return i(m),n.push(v),v}),this.cellkey=e.key?e.key:vL(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const a=e.fields||[null],o=e.ops||["count"],s=e.as||[],u=a.length,l={};let c,f,d,h,p,g;for(u!==o.length&&Se("Unmatched number of fields and aggregate ops."),g=0;g<u;++g){if(c=a[g],f=o[g],c==null&&f!=="count"&&Se("Null aggregate field specified."),h=Tr(c),p=iae(f,h,s[g]),n.push(p),f==="count"){this._counts.push(p);continue}d=l[h],d||(i(c),d=l[h]=[],d.field=c,this._measures.push(d)),f!=="count"&&(this._countOnly=!1),d.push(aae(f,p))}return this._measures=this._measures.map(m=>sae(m,m.field)),{}},cellkey:vL(),cell(e,t){let n=this.value[e];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const r=this._measures,i=r.length;n.agg=Array(i);for(let a=0;a<i;++a)n.agg[a]=new r[a](n)}return n.store&&(n.data=new bL),n},newtuple(e,t){const n=this._dnames,r=this._dims,i=r.length,a={};for(let o=0;o<i;++o)a[n[o]]=r[o](e);return t?Nie(t.tuple,a):In(a)},clean(){const e=this.value;for(const t in e)e[t].num===0&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const r=n.agg;for(let i=0,a=r.length;i<a;++i)r[i].add(r[i].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const r=n.agg;for(let i=0,a=r.length;i<a;++i)r[i].rem(r[i].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let r=0,i=n.length;r<i;++r)t[n[r]]=e.num;if(!this._countOnly){const r=e.agg;for(let i=0,a=r.length;i<a;++i)r[i].set(t)}return t},changes(e){const t=this._adds,n=this._mods,r=this._prev,i=this._drop,a=e.add,o=e.rem,s=e.mod;let u,l,c,f;if(r)for(l in r)u=r[l],(!i||u.num)&&o.push(u.tuple);for(c=0,f=this._alen;c<f;++c)a.push(this.celltuple(t[c])),t[c]=null;for(c=0,f=this._mlen;c<f;++c)u=n[c],(u.num===0&&i?o:s).push(this.celltuple(u)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}});const VKe=1e-14;function xL(e){ve.call(this,null,e)}xL.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]},$e(xL,ve,{transform(e,t){const n=e.interval!==!1,r=this._bins(e),i=r.start,a=r.step,o=e.as||["bin0","bin1"],s=o[0],u=o[1];let l;return e.modified()?(t=t.reflow(!0),l=t.SOURCE):l=t.modified(Yi(e.field))?t.ADD_MOD:t.ADD,t.visit(l,n?c=>{const f=r(c);c[s]=f,c[u]=f==null?null:i+a*(1+(f-i)/a)}:c=>c[s]=r(c)),t.modifies(n?o:s)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=Vie(e),r=n.step;let i=n.start,a=i+Math.ceil((n.stop-i)/r)*r,o,s;(o=e.anchor)!=null&&(s=o-(i+r*Math.floor((o-i)/r)),i+=s,a+=s);const u=function(l){let c=Zi(t(l));return c==null?null:c<i?-1/0:c>a?1/0:(c=Math.max(i,Math.min(c,a-r)),i+r*Math.floor(VKe+(c-i)/r))};return u.start=i,u.stop=n.stop,u.step=r,this.value=ro(u,Yi(t),e.name||"bin_"+Tr(t))}});function uae(e,t,n){const r=e;let i=t||[],a=n||[],o={},s=0;return{add:u=>a.push(u),remove:u=>o[r(u)]=++s,size:()=>i.length,data:(u,l)=>(s&&(i=i.filter(c=>!o[r(c)]),o={},s=0),l&&u&&i.sort(u),a.length&&(i=u?nre(u,i,a.sort(u)):i.concat(a),a=[]),i)}}function wL(e){ve.call(this,[],e)}wL.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},$e(wL,ve,{transform(e,t){const n=t.fork(t.ALL),r=uae(lt,this.value,n.materialize(n.ADD).add),i=e.sort,a=t.changed()||i&&(e.modified("sort")||t.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(a),this.value=n.source=r.data(mp(i),a),t.source&&t.source.root&&(this.value.root=t.source.root),n}});function lae(e){Xn.call(this,null,qKe,e)}$e(lae,Xn);function qKe(e){return this.value&&!e.modified()?this.value:r4(e.fields,e.orders)}function _L(e){ve.call(this,null,e)}_L.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function HKe(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}$e(_L,ve,{transform(e,t){const n=f=>d=>{for(var h=HKe(s(d),e.case,a)||[],p,g=0,m=h.length;g<m;++g)o.test(p=h[g])||f(p)},r=this._parameterCheck(e,t),i=this._counts,a=this._match,o=this._stop,s=e.field,u=e.as||["text","count"],l=n(f=>i[f]=1+(i[f]||0)),c=n(f=>i[f]-=1);return r?t.visit(t.SOURCE,l):(t.visit(t.ADD,l),t.visit(t.REM,c)),this._finish(t,u)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,r=this._tuples||(this._tuples={}),i=t[0],a=t[1],o=e.fork(e.NO_SOURCE|e.NO_FIELDS);let s,u,l;for(s in n)u=r[s],l=n[s]||0,!u&&l?(r[s]=u=In({}),u[i]=s,u[a]=l,o.add.push(u)):l===0?(u&&o.rem.push(u),n[s]=null,r[s]=null):u[a]!==l&&(u[a]=l,o.mod.push(u));return o.modifies(t)}});function SL(e){ve.call(this,null,e)}SL.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},$e(SL,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.as||["a","b"],i=r[0],a=r[1],o=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let s=this.value;return o?(s&&(n.rem=s),s=t.materialize(t.SOURCE).source,n.add=this.value=GKe(s,i,a,e.filter||ls)):n.mod=s,n.source=this.value,n.modifies(r)}});function GKe(e,t,n,r){for(var i=[],a={},o=e.length,s=0,u,l;s<o;++s)for(a[t]=l=e[s],u=0;u<o;++u)a[n]=e[u],r(a)&&(i.push(In(a)),a={},a[t]=l);return i}const cae={kde:oL,mixture:Xie,normal:aL,lognormal:Kie,uniform:Yie},KKe="distributions",fae="function",XKe="field";function dae(e,t){const n=e[fae];_t(cae,n)||Se("Unknown distribution function: "+n);const r=cae[n]();for(const i in e)i===XKe?r.data((e.from||t()).map(e[i])):i===KKe?r[i](e[i].map(a=>dae(a,t))):typeof r[i]===fae&&r[i](e[i]);return r}function EL(e){ve.call(this,null,e)}const hae=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],YKe={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:hae},{name:"weights",type:"number",array:!0}]};EL.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:hae.concat(YKe)},{name:"as",type:"string",array:!0,default:["value","density"]}]},$e(EL,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=dae(e.distribution,ZKe(t)),i=e.steps||e.minsteps||25,a=e.steps||e.maxsteps||200;let o=e.method||"pdf";o!=="pdf"&&o!=="cdf"&&Se("Invalid density method: "+o),!e.extent&&!r.data&&Se("Missing density extent parameter."),o=r[o];const s=e.as||["value","density"],u=e.extent||tl(r.data()),l=fA(o,u,i,a).map(c=>{const f={};return f[s[0]]=c[0],f[s[1]]=c[1],In(f)});this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function ZKe(e){return()=>e.materialize(e.SOURCE).source}function pae(e,t){return e?e.map((n,r)=>t[r]||Tr(n)):null}function CL(e,t,n){const r=[],i=f=>f(u);let a,o,s,u,l,c;if(t==null)r.push(e.map(n));else for(a={},o=0,s=e.length;o<s;++o)u=e[o],l=t.map(i),c=a[l],c||(a[l]=c=[],c.dims=l,r.push(c)),c.push(n(u));return r}const gae="bin";function AL(e){ve.call(this,null,e)}AL.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:gae}]};const JKe=(e,t)=>l1(tl(e,t))/30;$e(AL,ve,{transform(e,t){if(this.value&&!(e.modified()||t.changed()))return t;const n=t.materialize(t.SOURCE).source,r=CL(t.source,e.groupby,Oa),i=e.smooth||!1,a=e.field,o=e.step||JKe(n,a),s=mp((p,g)=>a(p)-a(g)),u=e.as||gae,l=r.length;let c=1/0,f=-1/0,d=0,h;for(;d<l;++d){const p=r[d].sort(s);h=-1;for(const g of Hie(p,o,i,a))g<c&&(c=g),g>f&&(f=g),p[++h][u]=g}return this.value={start:c,stop:f,step:o},t.reflow(!0).modifies(u)}});function mae(e){Xn.call(this,null,QKe,e),this.modified(!0)}$e(mae,Xn);function QKe(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:ro(n=>t(n,e),Yi(t),Tr(t))}function kL(e){ve.call(this,[void 0,void 0],e)}kL.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},$e(kL,ve,{transform(e,t){const n=this.value,r=e.field,i=t.changed()||t.modified(r.fields)||e.modified("field");let a=n[0],o=n[1];if((i||a==null)&&(a=1/0,o=-1/0),t.visit(i?t.SOURCE:t.ADD,s=>{const u=Zi(r(s));u!=null&&(u<a&&(a=u),u>o&&(o=u))}),!Number.isFinite(a)||!Number.isFinite(o)){let s=Tr(r);s&&(s=` for field "${s}"`),t.dataflow.warn(`Infinite extent${s}: [${a}, ${o}]`),a=o=void 0}this.value=[a,o]}});function TL(e,t){Xn.call(this,e),this.parent=t,this.count=0}$e(TL,Xn,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}});function dA(e){ve.call(this,{},e),this._keys=fv();const t=this._targets=[];t.active=0,t.forEach=n=>{for(let r=0,i=t.active;r<i;++r)n(t[r],r,t)}}$e(dA,ve,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,r){const i=this.value;let a=_t(i,e)&&i[e],o,s;return a?a.value.stamp<n.stamp&&(a.init(n),this.activate(a)):(s=r||(s=this._group[e])&&s.tuple,o=n.dataflow,a=new TL(n.fork(n.NO_SOURCE),this),o.add(a).connect(t(o,e,s)),i[e]=a,this.activate(a)),a},clean(){const e=this.value;let t=0;for(const n in e)if(e[n].count===0){const r=e[n].detachSubflow;r&&r(),delete e[n],++t}if(t){const n=this._targets.filter(r=>r&&r.count>0);this.initTargets(n)}},initTargets(e){const t=this._targets,n=t.length,r=e?e.length:0;let i=0;for(;i<r;++i)t[i]=e[i];for(;i<n&&t[i]!=null;++i)t[i]=null;t.active=r},transform(e,t){const n=t.dataflow,r=e.key,i=e.subflow,a=this._keys,o=e.modified("key"),s=u=>this.subflow(u,i,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,u=>{const l=lt(u),c=a.get(l);c!==void 0&&(a.delete(l),s(c).rem(u))}),t.visit(t.ADD,u=>{const l=r(u);a.set(lt(u),l),s(l).add(u)}),o||t.modified(r.fields)?t.visit(t.MOD,u=>{const l=lt(u),c=a.get(l),f=r(u);c===f?s(f).mod(u):(a.set(l,f),s(c).rem(u),s(f).add(u))}):t.changed(t.MOD)&&t.visit(t.MOD,u=>{s(a.get(lt(u))).mod(u)}),o&&t.visit(t.REFLOW,u=>{const l=lt(u),c=a.get(l),f=r(u);c!==f&&(a.set(l,f),s(c).rem(u),s(f).add(u))}),t.clean()?n.runAfter(()=>{this.clean(),a.clean()}):a.empty>n.cleanThreshold&&n.runAfter(a.clean),t}});function vae(e){Xn.call(this,null,eXe,e)}$e(vae,Xn);function eXe(e){return this.value&&!e.modified()?this.value:ut(e.name)?wt(e.name).map(t=>io(t)):io(e.name,e.as)}function OL(e){ve.call(this,fv(),e)}OL.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},$e(OL,ve,{transform(e,t){const n=t.dataflow,r=this.value,i=t.fork(),a=i.add,o=i.rem,s=i.mod,u=e.expr;let l=!0;t.visit(t.REM,f=>{const d=lt(f);r.has(d)?r.delete(d):o.push(f)}),t.visit(t.ADD,f=>{u(f,e)?a.push(f):r.set(lt(f),1)});function c(f){const d=lt(f),h=u(f,e),p=r.get(d);h&&p?(r.delete(d),a.push(f)):!h&&!p?(r.set(d,1),o.push(f)):l&&h&&!p&&s.push(f)}return t.visit(t.MOD,c),e.modified()&&(l=!1,t.visit(t.REFLOW,c)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}});function IL(e){ve.call(this,[],e)}IL.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},$e(IL,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=pae(r,e.as||[]),a=e.index||null,o=i.length;return n.rem=this.value,t.visit(t.SOURCE,s=>{const u=r.map(p=>p(s)),l=u.reduce((p,g)=>Math.max(p,g.length),0);let c=0,f,d,h;for(;c<l;++c){for(d=Z4(s),f=0;f<o;++f)d[i[f]]=(h=u[f][c])==null?null:h;a&&(d[a]=c),n.add.push(d)}}),this.value=n.source=n.add,a&&n.modifies(a),n.modifies(i)}});function NL(e){ve.call(this,[],e)}NL.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},$e(NL,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=r.map(Tr),a=e.as||["key","value"],o=a[0],s=a[1],u=r.length;return n.rem=this.value,t.visit(t.SOURCE,l=>{for(let c=0,f;c<u;++c)f=Z4(l),f[o]=i[c],f[s]=r[c](l),n.add.push(f)}),this.value=n.source=n.add,n.modifies(a)}});function DL(e){ve.call(this,null,e)}DL.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},$e(DL,ve,{transform(e,t){const n=e.expr,r=e.as,i=e.modified(),a=e.initonly?t.ADD:i?t.SOURCE:t.modified(n.fields)||t.modified(r)?t.ADD_MOD:t.ADD;return i&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(r),t.visit(a,o=>o[r]=n(o,e))}});function yae(e){ve.call(this,[],e)}$e(yae,ve,{transform(e,t){const n=t.fork(t.ALL),r=e.generator;let i=this.value,a=e.size-i.length,o,s,u;if(a>0){for(o=[];--a>=0;)o.push(u=In(r(e))),i.push(u);n.add=n.add.length?n.materialize(n.ADD).add.concat(o):o}else s=i.slice(0,-a),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(s):s,i=i.slice(-a);return n.source=this.value=i,n}});const hA={value:"value",median:_re,mean:lHe,min:w4,max:fp},tXe=[];function RL(e){ve.call(this,[],e)}RL.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function nXe(e){var t=e.method||hA.value,n;if(hA[t]==null)Se("Unrecognized imputation method: "+t);else return t===hA.value?(n=e.value!==void 0?e.value:0,()=>n):hA[t]}function rXe(e){const t=e.field;return n=>n?t(n):NaN}$e(RL,ve,{transform(e,t){var n=t.fork(t.ALL),r=nXe(e),i=rXe(e),a=Tr(e.field),o=Tr(e.key),s=(e.groupby||[]).map(Tr),u=iXe(t.source,e.groupby,e.key,e.keyvals),l=[],c=this.value,f=u.domain.length,d,h,p,g,m,v,y,b,x,w;for(m=0,b=u.length;m<b;++m)for(d=u[m],p=d.values,h=NaN,y=0;y<f;++y)if(d[y]==null){for(g=u.domain[y],w={_impute:!0},v=0,x=p.length;v<x;++v)w[s[v]]=p[v];w[o]=g,w[a]=Number.isNaN(h)?h=r(d,i):h,l.push(In(w))}return l.length&&(n.add=n.materialize(n.ADD).add.concat(l)),c.length&&(n.rem=n.materialize(n.REM).rem.concat(c)),this.value=l,n}});function iXe(e,t,n,r){var i=v=>v(m),a=[],o=r?r.slice():[],s={},u={},l,c,f,d,h,p,g,m;for(o.forEach((v,y)=>s[v]=y+1),d=0,g=e.length;d<g;++d)m=e[d],p=n(m),h=s[p]||(s[p]=o.push(p)),c=(l=t?t.map(i):tXe)+"",(f=u[c])||(f=u[c]=[],a.push(f),f.values=l),f[h-1]=m;return a.domain=o,a}function FL(e){fd.call(this,e)}FL.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:$1},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]},$e(FL,fd,{transform(e,t){const n=this,r=e.modified();let i;return n.value&&(r||t.modified(n._inputs,!0))?(i=n.value=r?n.init(e):{},t.visit(t.SOURCE,a=>n.add(a))):(i=n.value=n.value||this.init(e),t.visit(t.REM,a=>n.rem(a)),t.visit(t.ADD,a=>n.add(a))),n.changes(),t.visit(t.SOURCE,a=>{Rt(a,i[n.cellkey(a)].tuple)}),t.reflow(r).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(e[n]),e[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}});function ML(e){ve.call(this,null,e)}ML.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},$e(ML,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=CL(r,e.groupby,e.field),a=(e.groupby||[]).map(Tr),o=e.bandwidth,s=e.cumulative?"cdf":"pdf",u=e.as||["value","density"],l=[];let c=e.extent,f=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;s!=="pdf"&&s!=="cdf"&&Se("Invalid density method: "+s),e.resolve==="shared"&&(c||(c=tl(r,e.field)),f=d=e.steps||d),i.forEach(h=>{const p=oL(h,o)[s],g=e.counts?h.length:1,m=c||tl(h);fA(p,m,f,d).forEach(v=>{const y={};for(let b=0;b<a.length;++b)y[a[b]]=h.dims[b];y[u[0]]=v[0],y[u[1]]=v[1]*g,l.push(In(y))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function bae(e){Xn.call(this,null,aXe,e)}$e(bae,Xn);function aXe(e){return this.value&&!e.modified()?this.value:o4(e.fields,e.flat)}function xae(e){ve.call(this,[],e),this._pending=null}$e(xae,ve,{transform(e,t){const n=t.dataflow;return this._pending?PL(this,t,this._pending):oXe(e)?t.StopPropagation:e.values?PL(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(i=>(this._pending=wt(i.data),a=>a.touch(this)))}:n.request(e.url,e.format).then(r=>PL(this,t,wt(r.data)))}});function oXe(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function PL(e,t,n){n.forEach(In);const r=t.fork(t.NO_FIELDS&t.NO_SOURCE);return r.rem=e.value,e.value=r.source=r.add=n,e._pending=null,r.rem.length&&r.clean(!0),r}function $L(e){ve.call(this,{},e)}$L.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},$e($L,ve,{transform(e,t){const n=e.fields,r=e.index,i=e.values,a=e.default==null?null:e.default,o=e.modified(),s=n.length;let u=o?t.SOURCE:t.ADD,l=t,c=e.as,f,d,h;return i?(d=i.length,s>1&&!c&&Se('Multi-field lookup requires explicit "as" parameter.'),c&&c.length!==s*d&&Se('The "as" parameter has too few output field names.'),c=c||i.map(Tr),f=function(p){for(var g=0,m=0,v,y;g<s;++g)if(y=r.get(n[g](p)),y==null)for(v=0;v<d;++v,++m)p[c[m]]=a;else for(v=0;v<d;++v,++m)p[c[m]]=i[v](y)}):(c||Se("Missing output field names."),f=function(p){for(var g=0,m;g<s;++g)m=r.get(n[g](p)),p[c[g]]=m??a}),o?l=t.reflow(!0):(h=n.some(p=>t.modified(p.fields)),u|=h?t.MOD:0),t.visit(u,f),l.modifies(c)}});function wae(e){Xn.call(this,null,sXe,e)}$e(wae,Xn);function sXe(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let r=1/0,i=-1/0,a,o;for(a=0;a<n;++a)o=t[a],o[0]<r&&(r=o[0]),o[1]>i&&(i=o[1]);return[r,i]}function _ae(e){Xn.call(this,null,uXe,e)}$e(_ae,Xn);function uXe(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function Sae(e){ve.call(this,null,e)}$e(Sae,ve,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function LL(e){fd.call(this,e)}LL.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:$1,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]},$e(LL,fd,{_transform:fd.prototype.transform,transform(e,t){return this._transform(lXe(e,t),t)}});function lXe(e,t){const n=e.field,r=e.value,i=(e.op==="count"?"__count__":e.op)||"sum",a=Yi(n).concat(Yi(r)),o=fXe(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:o.map(()=>i),fields:o.map(s=>cXe(s,n,r,a)),as:o.map(s=>s+""),modified:e.modified.bind(e)}}function cXe(e,t,n,r){return ro(i=>t(i)===e?n(i):NaN,r,e+"")}function fXe(e,t,n){const r={},i=[];return n.visit(n.SOURCE,a=>{const o=e(a);r[o]||(r[o]=1,i.push(o))}),i.sort(jC),t?i.slice(0,t):i}function Eae(e){dA.call(this,e)}$e(Eae,dA,{transform(e,t){const n=e.subflow,r=e.field,i=a=>this.subflow(lt(a),n,t,a);return(e.modified("field")||r&&t.modified(Yi(r)))&&Se("PreFacet does not support field modification."),this.initTargets(),r?(t.visit(t.MOD,a=>{const o=i(a);r(a).forEach(s=>o.mod(s))}),t.visit(t.ADD,a=>{const o=i(a);r(a).forEach(s=>o.add(In(s)))}),t.visit(t.REM,a=>{const o=i(a);r(a).forEach(s=>o.rem(s))})):(t.visit(t.MOD,a=>i(a).mod(a)),t.visit(t.ADD,a=>i(a).add(a)),t.visit(t.REM,a=>i(a).rem(a))),t.clean()&&t.runAfter(()=>this.clean()),t}});function BL(e){ve.call(this,null,e)}BL.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},$e(BL,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.fields,i=pae(e.fields,e.as||[]),a=r?(s,u)=>dXe(s,u,r,i):tA;let o;return this.value?o=this.value:(t=t.addAll(),o=this.value={}),t.visit(t.REM,s=>{const u=lt(s);n.rem.push(o[u]),o[u]=null}),t.visit(t.ADD,s=>{const u=a(s,In({}));o[lt(s)]=u,n.add.push(u)}),t.visit(t.MOD,s=>{n.mod.push(a(s,o[lt(s)]))}),n}});function dXe(e,t,n,r){for(let i=0,a=n.length;i<a;++i)t[r[i]]=n[i](e);return t}function Cae(e){ve.call(this,null,e)}$e(Cae,ve,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function zL(e){ve.call(this,null,e)}zL.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};const hXe=1e-14;$e(zL,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const i=t.materialize(t.SOURCE).source,a=CL(i,e.groupby,e.field),o=(e.groupby||[]).map(Tr),s=[],u=e.step||.01,l=e.probs||Bo(u/2,1-hXe,u),c=l.length;return a.forEach(f=>{const d=tL(f,l);for(let h=0;h<c;++h){const p={};for(let g=0;g<o.length;++g)p[o[g]]=f.dims[g];p[r[0]]=l[h],p[r[1]]=d[h],s.push(In(p))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=s,n}});function Aae(e){ve.call(this,null,e)}$e(Aae,ve,{transform(e,t){let n,r;return this.value?r=this.value:(n=t=t.addAll(),r=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,i=>{const a=lt(i);n.rem.push(r[a]),r[a]=null}),t.visit(t.ADD,i=>{const a=Z4(i);r[lt(i)]=a,n.add.push(a)}),t.visit(t.MOD,i=>{const a=r[lt(i)];for(const o in i)a[o]=i[o],n.modifies(o);n.mod.push(a)})),n}});function jL(e){ve.call(this,[],e),this.count=0}jL.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},$e(jL,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE),r=e.modified("size"),i=e.size,a=this.value.reduce((c,f)=>(c[lt(f)]=1,c),{});let o=this.value,s=this.count,u=0;function l(c){let f,d;o.length<i?o.push(c):(d=~~((s+1)*ds()),d<o.length&&d>=u&&(f=o[d],a[lt(f)]&&n.rem.push(f),o[d]=c)),++s}if(t.rem.length&&(t.visit(t.REM,c=>{const f=lt(c);a[f]&&(a[f]=-1,n.rem.push(c)),--s}),o=o.filter(c=>a[lt(c)]!==-1)),(t.rem.length||r)&&o.length<i&&t.source&&(u=s=o.length,t.visit(t.SOURCE,c=>{a[lt(c)]||l(c)}),u=-1),r&&o.length>i){const c=o.length-i;for(let f=0;f<c;++f)a[lt(o[f])]=-1,n.rem.push(o[f]);o=o.slice(c)}return t.mod.length&&t.visit(t.MOD,c=>{a[lt(c)]&&n.mod.push(c)}),t.add.length&&t.visit(t.ADD,l),(t.add.length||u<0)&&(n.add=o.filter(c=>!a[lt(c)])),this.count=s,this.value=n.source=o,n}});function UL(e){ve.call(this,null,e)}UL.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},$e(UL,ve,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),r=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=Bo(e.start,e.stop,e.step||1).map(i=>{const a={};return a[r]=i,In(a)}),n.add=t.add.concat(this.value),n}});function kae(e){ve.call(this,null,e),this.modified(!0)}$e(kae,ve,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function WL(e){ve.call(this,null,e)}const Tae=["unit0","unit1"];WL.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:F4,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:Tae}]},$e(WL,ve,{transform(e,t){const n=e.field,r=e.interval!==!1,i=e.timezone==="utc",a=this._floor(e,t),o=(i?vv:mv)(a.unit).offset,s=e.as||Tae,u=s[0],l=s[1],c=a.step;let f=a.start||1/0,d=a.stop||-1/0,h=t.ADD;return(e.modified()||t.modified(Yi(n)))&&(t=t.reflow(!0),h=t.SOURCE,f=1/0,d=-1/0),t.visit(h,p=>{const g=n(p);let m,v;g==null?(p[u]=null,r&&(p[l]=null)):(p[u]=m=v=a(g),r&&(p[l]=v=o(m,c)),m<f&&(f=m),v>d&&(d=v))}),a.start=f,a.stop=d,t.modifies(r?s:u)},_floor(e,t){const n=e.timezone==="utc",{units:r,step:i}=e.units?{units:e.units,step:e.step||1}:nie({extent:e.extent||tl(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),a=P4(r),o=this.value||{},s=(n?qre:Vre)(a,i);return s.unit=sn(a),s.units=a,s.step=i,s.start=o.start,s.stop=o.stop,this.value=s}});function Oae(e){ve.call(this,fv(),e)}$e(Oae,ve,{transform(e,t){const n=t.dataflow,r=e.field,i=this.value,a=s=>i.set(r(s),s);let o=!0;return e.modified("field")||t.modified(r.fields)?(i.clear(),t.visit(t.SOURCE,a)):t.changed()?(t.visit(t.REM,s=>i.delete(r(s))),t.visit(t.ADD,a)):o=!1,this.modified(o),i.empty>n.cleanThreshold&&n.runAfter(i.clean),t.fork()}});function Iae(e){ve.call(this,null,e)}$e(Iae,ve,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(mp(e.sort)):t.source).map(e.field))}});function pXe(e,t,n,r){const i=L1[e](t,n);return{init:i.init||Jf,update:function(a,o){o[r]=i.next(a)}}}const L1={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?++e:e}}},percent_rank:function(){const e=L1.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,r=t.compare;let i=t.index;if(e<i){for(;i+1<n.length&&!r(n[i],n[i+1]);)++i;e=i}return(1+e)/n.length}}},ntile:function(e,t){t=+t,t>0||Se("ntile num must be greater than zero.");const n=L1.cume_dist(),r=n.next;return{init:n.init,next:i=>Math.ceil(t*r(i))}},lag:function(e,t){return t=+t||1,{next:n=>{const r=n.index-t;return r>=0?e(n.data[r]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const r=n.index+t,i=n.data;return r<i.length?e(i[r]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return t=+t,t>0||Se("nth_value nth must be greater than zero."),{next:n=>{const r=n.i0+(t-1);return r<n.i1?e(n.data[r]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const r=e(n.data[n.index]);return r!=null?t=r:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:r=>{const i=r.data;return r.index<=n?t:(n=gXe(e,i,r.index))<0?(n=i.length,t=null):t=e(i[n])}}}};function gXe(e,t,n){for(let r=t.length;n<r;++n)if(e(t[n])!=null)return n;return-1}const mXe=Object.keys(L1);function Nae(e){const t=wt(e.ops),n=wt(e.fields),r=wt(e.params),i=wt(e.as),a=this.outputs=[],o=this.windows=[],s={},u={},l=[],c=[];let f=!0;function d(h){wt(Yi(h)).forEach(p=>s[p]=1)}d(e.sort),t.forEach((h,p)=>{const g=n[p],m=Tr(g),v=iae(h,m,i[p]);if(d(g),a.push(v),_t(L1,h))o.push(pXe(h,n[p],r[p],v));else{if(g==null&&h!=="count"&&Se("Null aggregate field specified."),h==="count"){l.push(v);return}f=!1;let y=u[m];y||(y=u[m]=[],y.field=g,c.push(y)),y.push(aae(h,v))}}),(l.length||c.length)&&(this.cell=vXe(c,l,f)),this.inputs=Object.keys(s)}const Dae=Nae.prototype;Dae.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()},Dae.update=function(e,t){const n=this.cell,r=this.windows,i=e.data,a=r&&r.length;let o;if(n){for(o=e.p0;o<e.i0;++o)n.rem(i[o]);for(o=e.p1;o<e.i1;++o)n.add(i[o]);n.set(t)}for(o=0;o<a;++o)r[o].update(e,t)};function vXe(e,t,n){e=e.map(u=>sae(u,u.field));const r={num:0,agg:null,store:!1,count:t};if(!n)for(var i=e.length,a=r.agg=Array(i),o=0;o<i;++o)a[o]=new e[o](r);if(r.store)var s=r.data=new bL;return r.add=function(u){if(r.num+=1,!n){s&&s.add(u);for(let l=0;l<i;++l)a[l].add(a[l].get(u),u)}},r.rem=function(u){if(r.num-=1,!n){s&&s.rem(u);for(let l=0;l<i;++l)a[l].rem(a[l].get(u),u)}},r.set=function(u){let l,c;for(s&&s.values(),l=0,c=t.length;l<c;++l)u[t[l]]=r.num;if(!n)for(l=0,c=a.length;l<c;++l)a[l].set(u)},r.init=function(){r.num=0,s&&s.reset();for(let u=0;u<i;++u)a[u].init()},r}function VL(e){ve.call(this,{},e),this._mlen=0,this._mods=[]}VL.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:mXe.concat($1)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]},$e(VL,ve,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),r=mp(e.sort),i=vL(e.groupby),a=s=>this.group(i(s));let o=this.state;(!o||n)&&(o=this.state=new Nae(e)),n||t.modified(o.inputs)?(this.value={},t.visit(t.SOURCE,s=>a(s).add(s))):(t.visit(t.REM,s=>a(s).remove(s)),t.visit(t.ADD,s=>a(s).add(s)));for(let s=0,u=this._mlen;s<u;++s)yXe(this._mods[s],o,r,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(o.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=uae(lt),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});function yXe(e,t,n,r){const i=r.sort,a=i&&!r.ignorePeers,o=r.frame||[null,0],s=e.data(n),u=s.length,l=a?f1(i):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:s,compare:i||Ji(-1)};t.init();for(let f=0;f<u;++f)bXe(c,o,f,u),a&&xXe(c,l),t.update(c,s[f])}function bXe(e,t,n,r){e.p0=e.i0,e.p1=e.i1,e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0])),e.i1=t[1]==null?r:Math.min(r,n+Math.abs(t[1])+1),e.index=n}function xXe(e,t){const n=e.i0,r=e.i1-1,i=e.compare,a=e.data,o=a.length-1;n>0&&!i(a[n],a[n-1])&&(e.i0=t.left(a,a[n])),r<o&&!i(a[r],a[r+1])&&(e.i1=t.right(a,a[r]))}var wXe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",aggregate:fd,bin:xL,collect:wL,compare:lae,countpattern:_L,cross:SL,density:EL,dotbin:AL,expression:mae,extent:kL,facet:dA,field:vae,filter:OL,flatten:IL,fold:NL,formula:DL,generate:yae,impute:RL,joinaggregate:FL,kde:ML,key:bae,load:xae,lookup:$L,multiextent:wae,multivalues:_ae,params:Sae,pivot:LL,prefacet:Eae,project:BL,proxy:Cae,quantile:zL,relay:Aae,sample:jL,sequence:UL,sieve:kae,subflow:TL,timeunit:WL,tupleindex:Oae,values:Iae,window:VL});const qL=Math.PI,HL=2*qL,yp=1e-6,_Xe=HL-yp;function GL(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function bp(){return new GL}GL.prototype=bp.prototype={constructor:GL,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,i,a){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function(e,t,n,r,i){e=+e,t=+t,n=+n,r=+r,i=+i;var a=this._x1,o=this._y1,s=n-e,u=r-t,l=a-e,c=o-t,f=l*l+c*c;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>yp)if(!(Math.abs(c*s-u*l)>yp)||!i)this._+="L"+(this._x1=e)+","+(this._y1=t);else{var d=n-a,h=r-o,p=s*s+u*u,g=d*d+h*h,m=Math.sqrt(p),v=Math.sqrt(f),y=i*Math.tan((qL-Math.acos((p+f-g)/(2*m*v)))/2),b=y/v,x=y/m;Math.abs(b-1)>yp&&(this._+="L"+(e+b*l)+","+(t+b*c)),this._+="A"+i+","+i+",0,0,"+ +(c*d>l*h)+","+(this._x1=e+x*s)+","+(this._y1=t+x*u)}},arc:function(e,t,n,r,i,a){e=+e,t=+t,n=+n,a=!!a;var o=n*Math.cos(r),s=n*Math.sin(r),u=e+o,l=t+s,c=1^a,f=a?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+u+","+l:(Math.abs(this._x1-u)>yp||Math.abs(this._y1-l)>yp)&&(this._+="L"+u+","+l),!!n&&(f<0&&(f=f%HL+HL),f>_Xe?this._+="A"+n+","+n+",0,1,"+c+","+(e-o)+","+(t-s)+"A"+n+","+n+",0,1,"+c+","+(this._x1=u)+","+(this._y1=l):f>yp&&(this._+="A"+n+","+n+",0,"+ +(f>=qL)+","+c+","+(this._x1=e+n*Math.cos(i))+","+(this._y1=t+n*Math.sin(i))))},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};function Rn(e){return function(){return e}}var Rae=Math.abs,ta=Math.atan2,xp=Math.cos,SXe=Math.max,KL=Math.min,il=Math.sin,Sv=Math.sqrt,na=1e-12,Ev=Math.PI,pA=Ev/2,Fae=2*Ev;function EXe(e){return e>1?0:e<-1?Ev:Math.acos(e)}function Mae(e){return e>=1?pA:e<=-1?-pA:Math.asin(e)}function CXe(e){return e.innerRadius}function AXe(e){return e.outerRadius}function kXe(e){return e.startAngle}function TXe(e){return e.endAngle}function OXe(e){return e&&e.padAngle}function IXe(e,t,n,r,i,a,o,s){var u=n-e,l=r-t,c=o-i,f=s-a,d=f*u-c*l;if(!(d*d<na))return d=(c*(t-a)-f*(e-i))/d,[e+d*u,t+d*l]}function gA(e,t,n,r,i,a,o){var s=e-n,u=t-r,l=(o?a:-a)/Sv(s*s+u*u),c=l*u,f=-l*s,d=e+c,h=t+f,p=n+c,g=r+f,m=(d+p)/2,v=(h+g)/2,y=p-d,b=g-h,x=y*y+b*b,w=i-a,S=d*g-p*h,C=(b<0?-1:1)*Sv(SXe(0,w*w*x-S*S)),_=(S*b-y*C)/x,E=(-S*y-b*C)/x,A=(S*b+y*C)/x,k=(-S*y+b*C)/x,T=_-m,I=E-v,N=A-m,O=k-v;return T*T+I*I>N*N+O*O&&(_=A,E=k),{cx:_,cy:E,x01:-c,y01:-f,x11:_*(i/w-1),y11:E*(i/w-1)}}function NXe(){var e=CXe,t=AXe,n=Rn(0),r=null,i=kXe,a=TXe,o=OXe,s=null;function u(){var l,c,f=+e.apply(this,arguments),d=+t.apply(this,arguments),h=i.apply(this,arguments)-pA,p=a.apply(this,arguments)-pA,g=Rae(p-h),m=p>h;if(s||(s=l=bp()),d<f&&(c=d,d=f,f=c),!(d>na))s.moveTo(0,0);else if(g>Fae-na)s.moveTo(d*xp(h),d*il(h)),s.arc(0,0,d,h,p,!m),f>na&&(s.moveTo(f*xp(p),f*il(p)),s.arc(0,0,f,p,h,m));else{var v=h,y=p,b=h,x=p,w=g,S=g,C=o.apply(this,arguments)/2,_=C>na&&(r?+r.apply(this,arguments):Sv(f*f+d*d)),E=KL(Rae(d-f)/2,+n.apply(this,arguments)),A=E,k=E,T,I;if(_>na){var N=Mae(_/f*il(C)),O=Mae(_/d*il(C));(w-=N*2)>na?(N*=m?1:-1,b+=N,x-=N):(w=0,b=x=(h+p)/2),(S-=O*2)>na?(O*=m?1:-1,v+=O,y-=O):(S=0,v=y=(h+p)/2)}var D=d*xp(v),L=d*il(v),W=f*xp(x),G=f*il(x);if(E>na){var K=d*xp(y),ee=d*il(y),ce=f*xp(b),he=f*il(b),Oe;if(g<Ev&&(Oe=IXe(D,L,ce,he,K,ee,W,G))){var Te=D-Oe[0],De=L-Oe[1],me=K-Oe[0],P=ee-Oe[1],F=1/il(EXe((Te*me+De*P)/(Sv(Te*Te+De*De)*Sv(me*me+P*P)))/2),V=Sv(Oe[0]*Oe[0]+Oe[1]*Oe[1]);A=KL(E,(f-V)/(F-1)),k=KL(E,(d-V)/(F+1))}}S>na?k>na?(T=gA(ce,he,D,L,d,k,m),I=gA(K,ee,W,G,d,k,m),s.moveTo(T.cx+T.x01,T.cy+T.y01),k<E?s.arc(T.cx,T.cy,k,ta(T.y01,T.x01),ta(I.y01,I.x01),!m):(s.arc(T.cx,T.cy,k,ta(T.y01,T.x01),ta(T.y11,T.x11),!m),s.arc(0,0,d,ta(T.cy+T.y11,T.cx+T.x11),ta(I.cy+I.y11,I.cx+I.x11),!m),s.arc(I.cx,I.cy,k,ta(I.y11,I.x11),ta(I.y01,I.x01),!m))):(s.moveTo(D,L),s.arc(0,0,d,v,y,!m)):s.moveTo(D,L),!(f>na)||!(w>na)?s.lineTo(W,G):A>na?(T=gA(W,G,K,ee,f,-A,m),I=gA(D,L,ce,he,f,-A,m),s.lineTo(T.cx+T.x01,T.cy+T.y01),A<E?s.arc(T.cx,T.cy,A,ta(T.y01,T.x01),ta(I.y01,I.x01),!m):(s.arc(T.cx,T.cy,A,ta(T.y01,T.x01),ta(T.y11,T.x11),!m),s.arc(0,0,f,ta(T.cy+T.y11,T.cx+T.x11),ta(I.cy+I.y11,I.cx+I.x11),m),s.arc(I.cx,I.cy,A,ta(I.y11,I.x11),ta(I.y01,I.x01),!m))):s.arc(0,0,f,x,b,m)}if(s.closePath(),l)return s=null,l+""||null}return u.centroid=function(){var l=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,c=(+i.apply(this,arguments)+ +a.apply(this,arguments))/2-Ev/2;return[xp(c)*l,il(c)*l]},u.innerRadius=function(l){return arguments.length?(e=typeof l=="function"?l:Rn(+l),u):e},u.outerRadius=function(l){return arguments.length?(t=typeof l=="function"?l:Rn(+l),u):t},u.cornerRadius=function(l){return arguments.length?(n=typeof l=="function"?l:Rn(+l),u):n},u.padRadius=function(l){return arguments.length?(r=l==null?null:typeof l=="function"?l:Rn(+l),u):r},u.startAngle=function(l){return arguments.length?(i=typeof l=="function"?l:Rn(+l),u):i},u.endAngle=function(l){return arguments.length?(a=typeof l=="function"?l:Rn(+l),u):a},u.padAngle=function(l){return arguments.length?(o=typeof l=="function"?l:Rn(+l),u):o},u.context=function(l){return arguments.length?(s=l??null,u):s},u}function Pae(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function $ae(e){this._context=e}$ae.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function XL(e){return new $ae(e)}function Lae(e){return e[0]}function Bae(e){return e[1]}function zae(e,t){var n=Rn(!0),r=null,i=XL,a=null;e=typeof e=="function"?e:e===void 0?Lae:Rn(e),t=typeof t=="function"?t:t===void 0?Bae:Rn(t);function o(s){var u,l=(s=Pae(s)).length,c,f=!1,d;for(r==null&&(a=i(d=bp())),u=0;u<=l;++u)!(u<l&&n(c=s[u],u,s))===f&&((f=!f)?a.lineStart():a.lineEnd()),f&&a.point(+e(c,u,s),+t(c,u,s));if(d)return a=null,d+""||null}return o.x=function(s){return arguments.length?(e=typeof s=="function"?s:Rn(+s),o):e},o.y=function(s){return arguments.length?(t=typeof s=="function"?s:Rn(+s),o):t},o.defined=function(s){return arguments.length?(n=typeof s=="function"?s:Rn(!!s),o):n},o.curve=function(s){return arguments.length?(i=s,r!=null&&(a=i(r)),o):i},o.context=function(s){return arguments.length?(s==null?r=a=null:a=i(r=s),o):r},o}function jae(e,t,n){var r=null,i=Rn(!0),a=null,o=XL,s=null;e=typeof e=="function"?e:e===void 0?Lae:Rn(+e),t=typeof t=="function"?t:Rn(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?Bae:Rn(+n);function u(c){var f,d,h,p=(c=Pae(c)).length,g,m=!1,v,y=new Array(p),b=new Array(p);for(a==null&&(s=o(v=bp())),f=0;f<=p;++f){if(!(f<p&&i(g=c[f],f,c))===m)if(m=!m)d=f,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),h=f-1;h>=d;--h)s.point(y[h],b[h]);s.lineEnd(),s.areaEnd()}m&&(y[f]=+e(g,f,c),b[f]=+t(g,f,c),s.point(r?+r(g,f,c):y[f],n?+n(g,f,c):b[f]))}if(v)return s=null,v+""||null}function l(){return zae().defined(i).curve(o).context(a)}return u.x=function(c){return arguments.length?(e=typeof c=="function"?c:Rn(+c),r=null,u):e},u.x0=function(c){return arguments.length?(e=typeof c=="function"?c:Rn(+c),u):e},u.x1=function(c){return arguments.length?(r=c==null?null:typeof c=="function"?c:Rn(+c),u):r},u.y=function(c){return arguments.length?(t=typeof c=="function"?c:Rn(+c),n=null,u):t},u.y0=function(c){return arguments.length?(t=typeof c=="function"?c:Rn(+c),u):t},u.y1=function(c){return arguments.length?(n=c==null?null:typeof c=="function"?c:Rn(+c),u):n},u.lineX0=u.lineY0=function(){return l().x(e).y(t)},u.lineY1=function(){return l().x(e).y(n)},u.lineX1=function(){return l().x(r).y(t)},u.defined=function(c){return arguments.length?(i=typeof c=="function"?c:Rn(!!c),u):i},u.curve=function(c){return arguments.length?(o=c,a!=null&&(s=o(a)),u):o},u.context=function(c){return arguments.length?(c==null?a=s=null:s=o(a=c),u):a},u}var DXe={draw:function(e,t){var n=Math.sqrt(t/Ev);e.moveTo(n,0),e.arc(0,0,n,0,Fae)}};function RXe(e,t){var n=null;e=typeof e=="function"?e:Rn(e||DXe),t=typeof t=="function"?t:Rn(t===void 0?64:+t);function r(){var i;if(n||(n=i=bp()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),i)return n=null,i+""||null}return r.type=function(i){return arguments.length?(e=typeof i=="function"?i:Rn(i),r):e},r.size=function(i){return arguments.length?(t=typeof i=="function"?i:Rn(+i),r):t},r.context=function(i){return arguments.length?(n=i??null,r):n},r}function dd(){}function mA(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function vA(e){this._context=e}vA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:mA(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:mA(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function FXe(e){return new vA(e)}function Uae(e){this._context=e}Uae.prototype={areaStart:dd,areaEnd:dd,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:mA(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function MXe(e){return new Uae(e)}function Wae(e){this._context=e}Wae.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:mA(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function PXe(e){return new Wae(e)}function Vae(e,t){this._basis=new vA(e),this._beta=t}Vae.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],i=t[0],a=e[n]-r,o=t[n]-i,s=-1,u;++s<=n;)u=s/n,this._basis.point(this._beta*e[s]+(1-this._beta)*(r+u*a),this._beta*t[s]+(1-this._beta)*(i+u*o));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var $Xe=function e(t){function n(r){return t===1?new vA(r):new Vae(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function yA(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function YL(e,t){this._context=e,this._k=(1-t)/6}YL.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:yA(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:yA(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var LXe=function e(t){function n(r){return new YL(r,t)}return n.tension=function(r){return e(+r)},n}(0);function ZL(e,t){this._context=e,this._k=(1-t)/6}ZL.prototype={areaStart:dd,areaEnd:dd,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:yA(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var BXe=function e(t){function n(r){return new ZL(r,t)}return n.tension=function(r){return e(+r)},n}(0);function JL(e,t){this._context=e,this._k=(1-t)/6}JL.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:yA(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var zXe=function e(t){function n(r){return new JL(r,t)}return n.tension=function(r){return e(+r)},n}(0);function QL(e,t,n){var r=e._x1,i=e._y1,a=e._x2,o=e._y2;if(e._l01_a>na){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,u=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/u,i=(i*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/u}if(e._l23_a>na){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);a=(a*l+e._x1*e._l23_2a-t*e._l12_2a)/c,o=(o*l+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(r,i,a,o,e._x2,e._y2)}function qae(e,t){this._context=e,this._alpha=t}qae.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:QL(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var jXe=function e(t){function n(r){return t?new qae(r,t):new YL(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Hae(e,t){this._context=e,this._alpha=t}Hae.prototype={areaStart:dd,areaEnd:dd,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:QL(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var UXe=function e(t){function n(r){return t?new Hae(r,t):new ZL(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Gae(e,t){this._context=e,this._alpha=t}Gae.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:QL(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var WXe=function e(t){function n(r){return t?new Gae(r,t):new JL(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Kae(e){this._context=e}Kae.prototype={areaStart:dd,areaEnd:dd,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function VXe(e){return new Kae(e)}function Xae(e){return e<0?-1:1}function Yae(e,t,n){var r=e._x1-e._x0,i=t-e._x1,a=(e._y1-e._y0)/(r||i<0&&-0),o=(n-e._y1)/(i||r<0&&-0),s=(a*i+o*r)/(r+i);return(Xae(a)+Xae(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function Zae(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function eB(e,t,n){var r=e._x0,i=e._y0,a=e._x1,o=e._y1,s=(a-r)/3;e._context.bezierCurveTo(r+s,i+s*t,a-s,o-s*n,a,o)}function bA(e){this._context=e}bA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:eB(this,this._t0,Zae(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,eB(this,Zae(this,n=Yae(this,e,t)),n);break;default:eB(this,this._t0,n=Yae(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function Jae(e){this._context=new Qae(e)}(Jae.prototype=Object.create(bA.prototype)).point=function(e,t){bA.prototype.point.call(this,t,e)};function Qae(e){this._context=e}Qae.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,a){this._context.bezierCurveTo(t,e,r,n,a,i)}};function qXe(e){return new bA(e)}function HXe(e){return new Jae(e)}function eoe(e){this._context=e}eoe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=toe(e),i=toe(t),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],e[o],t[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function toe(e){var t,n=e.length-1,r,i=new Array(n),a=new Array(n),o=new Array(n);for(i[0]=0,a[0]=2,o[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,a[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,a[n-1]=7,o[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/a[t-1],a[t]-=r,o[t]-=r*o[t-1];for(i[n-1]=o[n-1]/a[n-1],t=n-2;t>=0;--t)i[t]=(o[t]-i[t+1])/a[t];for(a[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)a[t]=2*e[t+1]-i[t+1];return[i,a]}function GXe(e){return new eoe(e)}function xA(e,t){this._context=e,this._t=t}xA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function KXe(e){return new xA(e,.5)}function XXe(e){return new xA(e,0)}function YXe(e){return new xA(e,1)}function Cv(e,t){if(typeof document!="undefined"&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}const ZXe=()=>typeof Image!="undefined"?Image:null;function al(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function hd(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const tB=Symbol("implicit");function nB(){var e=new Map,t=[],n=[],r=tB;function i(a){var o=a+"",s=e.get(o);if(!s){if(r!==tB)return r;e.set(o,s=t.push(a))}return n[(s-1)%n.length]}return i.domain=function(a){if(!arguments.length)return t.slice();t=[],e=new Map;for(const o of a){const s=o+"";e.has(s)||e.set(s,t.push(o))}return i},i.range=function(a){return arguments.length?(n=Array.from(a),i):n.slice()},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return nB(t,n).unknown(r)},al.apply(i,arguments),i}function Av(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function B1(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function pd(){}var wp=.7,kv=1/wp,Tv="\\s*([+-]?\\d+)\\s*",z1="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",ol="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",JXe=/^#([0-9a-f]{3,8})$/,QXe=new RegExp("^rgb\\("+[Tv,Tv,Tv]+"\\)$"),eYe=new RegExp("^rgb\\("+[ol,ol,ol]+"\\)$"),tYe=new RegExp("^rgba\\("+[Tv,Tv,Tv,z1]+"\\)$"),nYe=new RegExp("^rgba\\("+[ol,ol,ol,z1]+"\\)$"),rYe=new RegExp("^hsl\\("+[z1,ol,ol]+"\\)$"),iYe=new RegExp("^hsla\\("+[z1,ol,ol,z1]+"\\)$"),noe={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Av(pd,j1,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:roe,formatHex:roe,formatHsl:aYe,formatRgb:ioe,toString:ioe});function roe(){return this.rgb().formatHex()}function aYe(){return loe(this).formatHsl()}function ioe(){return this.rgb().formatRgb()}function j1(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=JXe.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?aoe(t):n===3?new Bi(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?wA(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?wA(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=QXe.exec(e))?new Bi(t[1],t[2],t[3],1):(t=eYe.exec(e))?new Bi(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=tYe.exec(e))?wA(t[1],t[2],t[3],t[4]):(t=nYe.exec(e))?wA(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=rYe.exec(e))?uoe(t[1],t[2]/100,t[3]/100,1):(t=iYe.exec(e))?uoe(t[1],t[2]/100,t[3]/100,t[4]):noe.hasOwnProperty(e)?aoe(noe[e]):e==="transparent"?new Bi(NaN,NaN,NaN,0):null}function aoe(e){return new Bi(e>>16&255,e>>8&255,e&255,1)}function wA(e,t,n,r){return r<=0&&(e=t=n=NaN),new Bi(e,t,n,r)}function rB(e){return e instanceof pd||(e=j1(e)),e?(e=e.rgb(),new Bi(e.r,e.g,e.b,e.opacity)):new Bi}function gd(e,t,n,r){return arguments.length===1?rB(e):new Bi(e,t,n,r??1)}function Bi(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Av(Bi,gd,B1(pd,{brighter:function(e){return e=e==null?kv:Math.pow(kv,e),new Bi(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?wp:Math.pow(wp,e),new Bi(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ooe,formatHex:ooe,formatRgb:soe,toString:soe}));function ooe(){return"#"+iB(this.r)+iB(this.g)+iB(this.b)}function soe(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function iB(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function uoe(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new sl(e,t,n,r)}function loe(e){if(e instanceof sl)return new sl(e.h,e.s,e.l,e.opacity);if(e instanceof pd||(e=j1(e)),!e)return new sl;if(e instanceof sl)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,s=a-i,u=(a+i)/2;return s?(t===a?o=(n-r)/s+(n<r)*6:n===a?o=(r-t)/s+2:o=(t-n)/s+4,s/=u<.5?a+i:2-a-i,o*=60):s=u>0&&u<1?0:o,new sl(o,s,u,e.opacity)}function _A(e,t,n,r){return arguments.length===1?loe(e):new sl(e,t,n,r??1)}function sl(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Av(sl,_A,B1(pd,{brighter:function(e){return e=e==null?kv:Math.pow(kv,e),new sl(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?wp:Math.pow(wp,e),new sl(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Bi(aB(e>=240?e-240:e+120,i,r),aB(e,i,r),aB(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function aB(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const coe=Math.PI/180,foe=180/Math.PI,SA=18,doe=.96422,hoe=1,poe=.82521,goe=4/29,Ov=6/29,moe=3*Ov*Ov,oYe=Ov*Ov*Ov;function voe(e){if(e instanceof ul)return new ul(e.l,e.a,e.b,e.opacity);if(e instanceof Cc)return yoe(e);e instanceof Bi||(e=rB(e));var t=lB(e.r),n=lB(e.g),r=lB(e.b),i=oB((.2225045*t+.7168786*n+.0606169*r)/hoe),a,o;return t===n&&n===r?a=o=i:(a=oB((.4360747*t+.3850649*n+.1430804*r)/doe),o=oB((.0139322*t+.0971045*n+.7141733*r)/poe)),new ul(116*i-16,500*(a-i),200*(i-o),e.opacity)}function EA(e,t,n,r){return arguments.length===1?voe(e):new ul(e,t,n,r??1)}function ul(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}Av(ul,EA,B1(pd,{brighter:function(e){return new ul(this.l+SA*(e??1),this.a,this.b,this.opacity)},darker:function(e){return new ul(this.l-SA*(e??1),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=doe*sB(t),e=hoe*sB(e),n=poe*sB(n),new Bi(uB(3.1338561*t-1.6168667*e-.4906146*n),uB(-.9787684*t+1.9161415*e+.033454*n),uB(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function oB(e){return e>oYe?Math.pow(e,1/3):e/moe+goe}function sB(e){return e>Ov?e*e*e:moe*(e-goe)}function uB(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function lB(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function sYe(e){if(e instanceof Cc)return new Cc(e.h,e.c,e.l,e.opacity);if(e instanceof ul||(e=voe(e)),e.a===0&&e.b===0)return new Cc(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*foe;return new Cc(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function CA(e,t,n,r){return arguments.length===1?sYe(e):new Cc(e,t,n,r??1)}function Cc(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function yoe(e){if(isNaN(e.h))return new ul(e.l,0,0,e.opacity);var t=e.h*coe;return new ul(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}Av(Cc,CA,B1(pd,{brighter:function(e){return new Cc(this.h,this.c,this.l+SA*(e??1),this.opacity)},darker:function(e){return new Cc(this.h,this.c,this.l-SA*(e??1),this.opacity)},rgb:function(){return yoe(this).rgb()}}));var boe=-.14861,cB=1.78277,fB=-.29227,AA=-.90649,U1=1.97294,xoe=U1*AA,woe=U1*cB,_oe=cB*fB-AA*boe;function uYe(e){if(e instanceof _p)return new _p(e.h,e.s,e.l,e.opacity);e instanceof Bi||(e=rB(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(_oe*r+xoe*t-woe*n)/(_oe+xoe-woe),a=r-i,o=(U1*(n-i)-fB*a)/AA,s=Math.sqrt(o*o+a*a)/(U1*i*(1-i)),u=s?Math.atan2(o,a)*foe-120:NaN;return new _p(u<0?u+360:u,s,i,e.opacity)}function dB(e,t,n,r){return arguments.length===1?uYe(e):new _p(e,t,n,r??1)}function _p(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Av(_p,dB,B1(pd,{brighter:function(e){return e=e==null?kv:Math.pow(kv,e),new _p(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?wp:Math.pow(wp,e),new _p(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*coe,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new Bi(255*(t+n*(boe*r+cB*i)),255*(t+n*(fB*r+AA*i)),255*(t+n*(U1*r)),this.opacity)}}));function Soe(e,t,n,r,i){var a=e*e,o=a*e;return((1-3*e+3*a-o)*t+(4-6*a+3*o)*n+(1+3*e+3*a-3*o)*r+o*i)/6}function Eoe(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],a=e[r+1],o=r>0?e[r-1]:2*i-a,s=r<t-1?e[r+2]:2*a-i;return Soe((n-r/t)*t,o,i,a,s)}}function Coe(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],a=e[r%t],o=e[(r+1)%t],s=e[(r+2)%t];return Soe((n-r/t)*t,i,a,o,s)}}var kA=e=>()=>e;function Aoe(e,t){return function(n){return e+n*t}}function lYe(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function TA(e,t){var n=t-e;return n?Aoe(e,n>180||n<-180?n-360*Math.round(n/360):n):kA(isNaN(e)?t:e)}function cYe(e){return(e=+e)==1?_i:function(t,n){return n-t?lYe(t,n,e):kA(isNaN(t)?n:t)}}function _i(e,t){var n=t-e;return n?Aoe(e,n):kA(isNaN(e)?t:e)}var hB=function e(t){var n=cYe(t);function r(i,a){var o=n((i=gd(i)).r,(a=gd(a)).r),s=n(i.g,a.g),u=n(i.b,a.b),l=_i(i.opacity,a.opacity);return function(c){return i.r=o(c),i.g=s(c),i.b=u(c),i.opacity=l(c),i+""}}return r.gamma=e,r}(1);function koe(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),a=new Array(n),o,s;for(o=0;o<n;++o)s=gd(t[o]),r[o]=s.r||0,i[o]=s.g||0,a[o]=s.b||0;return r=e(r),i=e(i),a=e(a),s.opacity=1,function(u){return s.r=r(u),s.g=i(u),s.b=a(u),s+""}}}var fYe=koe(Eoe),dYe=koe(Coe);function pB(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(a){for(i=0;i<n;++i)r[i]=e[i]*(1-a)+t[i]*a;return r}}function Toe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function hYe(e,t){return(Toe(t)?pB:Ooe)(e,t)}function Ooe(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),a=new Array(n),o;for(o=0;o<r;++o)i[o]=md(e[o],t[o]);for(;o<n;++o)a[o]=t[o];return function(s){for(o=0;o<r;++o)a[o]=i[o](s);return a}}function Ioe(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function iu(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Noe(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=md(e[i],t[i]):r[i]=t[i];return function(a){for(i in n)r[i]=n[i](a);return r}}var gB=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,mB=new RegExp(gB.source,"g");function pYe(e){return function(){return e}}function gYe(e){return function(t){return e(t)+""}}function Doe(e,t){var n=gB.lastIndex=mB.lastIndex=0,r,i,a,o=-1,s=[],u=[];for(e=e+"",t=t+"";(r=gB.exec(e))&&(i=mB.exec(t));)(a=i.index)>n&&(a=t.slice(n,a),s[o]?s[o]+=a:s[++o]=a),(r=r[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,u.push({i:o,x:iu(r,i)})),n=mB.lastIndex;return n<t.length&&(a=t.slice(n),s[o]?s[o]+=a:s[++o]=a),s.length<2?u[0]?gYe(u[0].x):pYe(t):(t=u.length,function(l){for(var c=0,f;c<t;++c)s[(f=u[c]).i]=f.x(l);return s.join("")})}function md(e,t){var n=typeof t,r;return t==null||n==="boolean"?kA(t):(n==="number"?iu:n==="string"?(r=j1(t))?(t=r,hB):Doe:t instanceof j1?hB:t instanceof Date?Ioe:Toe(t)?pB:Array.isArray(t)?Ooe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Noe:iu)(e,t)}function mYe(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function vYe(e,t){var n=TA(+e,+t);return function(r){var i=n(r);return i-360*Math.floor(i/360)}}function W1(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var Roe=180/Math.PI,vB={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Foe(e,t,n,r,i,a){var o,s,u;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),e*r<t*n&&(e=-e,t=-t,u=-u,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(t,e)*Roe,skewX:Math.atan(u)*Roe,scaleX:o,scaleY:s}}var OA;function yYe(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?vB:Foe(t.a,t.b,t.c,t.d,t.e,t.f)}function bYe(e){return e==null||(OA||(OA=document.createElementNS("http://www.w3.org/2000/svg","g")),OA.setAttribute("transform",e),!(e=OA.transform.baseVal.consolidate()))?vB:(e=e.matrix,Foe(e.a,e.b,e.c,e.d,e.e,e.f))}function Moe(e,t,n,r){function i(l){return l.length?l.pop()+" ":""}function a(l,c,f,d,h,p){if(l!==f||c!==d){var g=h.push("translate(",null,t,null,n);p.push({i:g-4,x:iu(l,f)},{i:g-2,x:iu(c,d)})}else(f||d)&&h.push("translate("+f+t+d+n)}function o(l,c,f,d){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),d.push({i:f.push(i(f)+"rotate(",null,r)-2,x:iu(l,c)})):c&&f.push(i(f)+"rotate("+c+r)}function s(l,c,f,d){l!==c?d.push({i:f.push(i(f)+"skewX(",null,r)-2,x:iu(l,c)}):c&&f.push(i(f)+"skewX("+c+r)}function u(l,c,f,d,h,p){if(l!==f||c!==d){var g=h.push(i(h)+"scale(",null,",",null,")");p.push({i:g-4,x:iu(l,f)},{i:g-2,x:iu(c,d)})}else(f!==1||d!==1)&&h.push(i(h)+"scale("+f+","+d+")")}return function(l,c){var f=[],d=[];return l=e(l),c=e(c),a(l.translateX,l.translateY,c.translateX,c.translateY,f,d),o(l.rotate,c.rotate,f,d),s(l.skewX,c.skewX,f,d),u(l.scaleX,l.scaleY,c.scaleX,c.scaleY,f,d),l=c=null,function(h){for(var p=-1,g=d.length,m;++p<g;)f[(m=d[p]).i]=m.x(h);return f.join("")}}}var xYe=Moe(yYe,"px, ","px)","deg)"),wYe=Moe(bYe,", ",")",")"),_Ye=1e-12;function Poe(e){return((e=Math.exp(e))+1/e)/2}function SYe(e){return((e=Math.exp(e))-1/e)/2}function EYe(e){return((e=Math.exp(2*e))-1)/(e+1)}var CYe=function e(t,n,r){function i(a,o){var s=a[0],u=a[1],l=a[2],c=o[0],f=o[1],d=o[2],h=c-s,p=f-u,g=h*h+p*p,m,v;if(g<_Ye)v=Math.log(d/l)/t,m=function(C){return[s+C*h,u+C*p,l*Math.exp(t*C*v)]};else{var y=Math.sqrt(g),b=(d*d-l*l+r*g)/(2*l*n*y),x=(d*d-l*l-r*g)/(2*d*n*y),w=Math.log(Math.sqrt(b*b+1)-b),S=Math.log(Math.sqrt(x*x+1)-x);v=(S-w)/t,m=function(C){var _=C*v,E=Poe(w),A=l/(n*y)*(E*EYe(t*_+w)-SYe(w));return[s+A*h,u+A*p,l*E/Poe(t*_+w)]}}return m.duration=v*1e3*t/Math.SQRT2,m}return i.rho=function(a){var o=Math.max(.001,+a),s=o*o,u=s*s;return e(o,s,u)},i}(Math.SQRT2,2,4);function $oe(e){return function(t,n){var r=e((t=_A(t)).h,(n=_A(n)).h),i=_i(t.s,n.s),a=_i(t.l,n.l),o=_i(t.opacity,n.opacity);return function(s){return t.h=r(s),t.s=i(s),t.l=a(s),t.opacity=o(s),t+""}}}var AYe=$oe(TA),kYe=$oe(_i);function TYe(e,t){var n=_i((e=EA(e)).l,(t=EA(t)).l),r=_i(e.a,t.a),i=_i(e.b,t.b),a=_i(e.opacity,t.opacity);return function(o){return e.l=n(o),e.a=r(o),e.b=i(o),e.opacity=a(o),e+""}}function Loe(e){return function(t,n){var r=e((t=CA(t)).h,(n=CA(n)).h),i=_i(t.c,n.c),a=_i(t.l,n.l),o=_i(t.opacity,n.opacity);return function(s){return t.h=r(s),t.c=i(s),t.l=a(s),t.opacity=o(s),t+""}}}var OYe=Loe(TA),IYe=Loe(_i);function Boe(e){return function t(n){n=+n;function r(i,a){var o=e((i=dB(i)).h,(a=dB(a)).h),s=_i(i.s,a.s),u=_i(i.l,a.l),l=_i(i.opacity,a.opacity);return function(c){return i.h=o(c),i.s=s(c),i.l=u(Math.pow(c,n)),i.opacity=l(c),i+""}}return r.gamma=t,r}(1)}var NYe=Boe(TA),DYe=Boe(_i);function yB(e,t){t===void 0&&(t=e,e=md);for(var n=0,r=t.length-1,i=t[0],a=new Array(r<0?0:r);n<r;)a[n]=e(i,i=t[++n]);return function(o){var s=Math.max(0,Math.min(r-1,Math.floor(o*=r)));return a[s](o-s)}}function RYe(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}var FYe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",interpolate:md,interpolateArray:hYe,interpolateBasis:Eoe,interpolateBasisClosed:Coe,interpolateDate:Ioe,interpolateDiscrete:mYe,interpolateHue:vYe,interpolateNumber:iu,interpolateNumberArray:pB,interpolateObject:Noe,interpolateRound:W1,interpolateString:Doe,interpolateTransformCss:xYe,interpolateTransformSvg:wYe,interpolateZoom:CYe,interpolateRgb:hB,interpolateRgbBasis:fYe,interpolateRgbBasisClosed:dYe,interpolateHsl:AYe,interpolateHslLong:kYe,interpolateLab:TYe,interpolateHcl:OYe,interpolateHclLong:IYe,interpolateCubehelix:NYe,interpolateCubehelixLong:DYe,piecewise:yB,quantize:RYe});function MYe(e){return function(){return e}}function bB(e){return+e}var zoe=[0,1];function uo(e){return e}function xB(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:MYe(isNaN(t)?NaN:.5)}function PYe(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function $Ye(e,t,n){var r=e[0],i=e[1],a=t[0],o=t[1];return i<r?(r=xB(i,r),a=n(o,a)):(r=xB(r,i),a=n(a,o)),function(s){return a(r(s))}}function LYe(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),a=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)i[o]=xB(e[o],e[o+1]),a[o]=n(t[o],t[o+1]);return function(s){var u=rd(e,s,1,r)-1;return a[u](i[u](s))}}function V1(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function IA(){var e=zoe,t=zoe,n=md,r,i,a,o=uo,s,u,l;function c(){var d=Math.min(e.length,t.length);return o!==uo&&(o=PYe(e[0],e[d-1])),s=d>2?LYe:$Ye,u=l=null,f}function f(d){return d==null||isNaN(d=+d)?a:(u||(u=s(e.map(r),t,n)))(r(o(d)))}return f.invert=function(d){return o(i((l||(l=s(t,e.map(r),iu)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,bB),c()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),c()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),n=W1,c()},f.clamp=function(d){return arguments.length?(o=d?!0:uo,c()):o!==uo},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(a=d,f):a},function(d,h){return r=d,i=h,c()}}function joe(){return IA()(uo,uo)}function NA(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Iv(e){return e=NA(Math.abs(e)),e?e[1]:NaN}function BYe(e,t){return function(n,r){for(var i=n.length,a=[],o=0,s=e[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),a.push(n.substring(i-=s,i+s)),!((u+=s+1)>r));)s=e[o=(o+1)%e.length];return a.reverse().join(t)}}function zYe(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var jYe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function q1(e){return new wB(e)}q1.prototype=wB.prototype;function wB(e){if(!(t=jYe.exec(e)))throw new Error("invalid format: "+e);var t;this.fill=t[1]||" ",this.align=t[2]||">",this.sign=t[3]||"-",this.symbol=t[4]||"",this.zero=!!t[5],this.width=t[6]&&+t[6],this.comma=!!t[7],this.precision=t[8]&&+t[8].slice(1),this.trim=!!t[9],this.type=t[10]||""}wB.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width==null?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision==null?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function UYe(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(r>0){if(!+e[n])break e;r=0}break}return r>0?e.slice(0,r)+e.slice(i+1):e}var Uoe;function WYe(e,t){var n=NA(e,t);if(!n)return e+"";var r=n[0],i=n[1],a=i-(Uoe=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+NA(e,Math.max(0,t+a-1))[0]}function Woe(e,t){var n=NA(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var Voe={"%":function(e,t){return(e*100).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return Woe(e*100,t)},r:Woe,s:WYe,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function qoe(e){return e}var Hoe=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function Goe(e){var t=e.grouping&&e.thousands?BYe(e.grouping,e.thousands):qoe,n=e.currency,r=e.decimal,i=e.numerals?zYe(e.numerals):qoe,a=e.percent||"%";function o(u){u=q1(u);var l=u.fill,c=u.align,f=u.sign,d=u.symbol,h=u.zero,p=u.width,g=u.comma,m=u.precision,v=u.trim,y=u.type;y==="n"?(g=!0,y="g"):Voe[y]||(m==null&&(m=12),v=!0,y="g"),(h||l==="0"&&c==="=")&&(h=!0,l="0",c="=");var b=d==="$"?n[0]:d==="#"&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",x=d==="$"?n[1]:/[%p]/.test(y)?a:"",w=Voe[y],S=/[defgprs%]/.test(y);m=m==null?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m));function C(_){var E=b,A=x,k,T,I;if(y==="c")A=w(_)+A,_="";else{_=+_;var N=_<0;if(_=w(Math.abs(_),m),v&&(_=UYe(_)),N&&+_==0&&(N=!1),E=(N?f==="("?f:"-":f==="-"||f==="("?"":f)+E,A=(y==="s"?Hoe[8+Uoe/3]:"")+A+(N&&f==="("?")":""),S){for(k=-1,T=_.length;++k<T;)if(I=_.charCodeAt(k),48>I||I>57){A=(I===46?r+_.slice(k+1):_.slice(k))+A,_=_.slice(0,k);break}}}g&&!h&&(_=t(_,1/0));var O=E.length+_.length+A.length,D=O<p?new Array(p-O+1).join(l):"";switch(g&&h&&(_=t(D+_,D.length?p-A.length:1/0),D=""),c){case"<":_=E+_+A+D;break;case"=":_=E+D+_+A;break;case"^":_=D.slice(0,O=D.length>>1)+E+_+A+D.slice(O);break;default:_=D+E+_+A;break}return i(_)}return C.toString=function(){return u+""},C}function s(u,l){var c=o((u=q1(u),u.type="f",u)),f=Math.max(-8,Math.min(8,Math.floor(Iv(l)/3)))*3,d=Math.pow(10,-f),h=Hoe[8+f/3];return function(p){return c(d*p)+h}}return{format:o,formatPrefix:s}}var DA,RA,_B;Koe({decimal:".",thousands:",",grouping:[3],currency:["$",""]});function Koe(e){return DA=Goe(e),RA=DA.format,_B=DA.formatPrefix,DA}function Xoe(e){return Math.max(0,-Iv(Math.abs(e)))}function Yoe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Iv(t)/3)))*3-Iv(Math.abs(e)))}function Zoe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Iv(t)-Iv(e))+1}var VYe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",formatDefaultLocale:Koe,get format(){return RA},get formatPrefix(){return _B},formatLocale:Goe,formatSpecifier:q1,precisionFixed:Xoe,precisionPrefix:Yoe,precisionRound:Zoe});function Joe(e,t,n,r){var i=id(e,t,n),a;switch(r=q1(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(a=Yoe(i,o))&&(r.precision=a),_B(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(a=Zoe(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=a-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(a=Xoe(i))&&(r.precision=a-(r.type==="%")*2);break}}return RA(r)}function Sp(e){var t=e.domain;return e.ticks=function(n){var r=t();return x4(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var i=t();return Joe(i[0],i[i.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,a=r.length-1,o=r[i],s=r[a],u,l,c=10;for(s<o&&(l=o,o=s,s=l,l=i,i=a,a=l);c-- >0;){if(l=bre(o,s,n),l===u)return r[i]=o,r[a]=s,t(r);if(l>0)o=Math.floor(o/l)*l,s=Math.ceil(s/l)*l;else if(l<0)o=Math.ceil(o*l)/l,s=Math.floor(s*l)/l;else break;u=l}return e},e}function Qoe(){var e=joe();return e.copy=function(){return V1(e,Qoe())},al.apply(e,arguments),Sp(e)}function ese(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,bB),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return ese(e).unknown(t)},e=arguments.length?Array.from(e,bB):[0,1],Sp(n)}function tse(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],a=e[r],o;return a<i&&(o=n,n=r,r=o,o=i,i=a,a=o),e[n]=t.floor(i),e[r]=t.ceil(a),e}function nse(e){return Math.log(e)}function rse(e){return Math.exp(e)}function qYe(e){return-Math.log(-e)}function HYe(e){return-Math.exp(-e)}function GYe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function KYe(e){return e===10?GYe:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function XYe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function ise(e){return function(t){return-e(-t)}}function SB(e){var t=e(nse,rse),n=t.domain,r=10,i,a;function o(){return i=XYe(r),a=KYe(r),n()[0]<0?(i=ise(i),a=ise(a),e(qYe,HYe)):e(nse,rse),t}return t.base=function(s){return arguments.length?(r=+s,o()):r},t.domain=function(s){return arguments.length?(n(s),o()):n()},t.ticks=function(s){var u=n(),l=u[0],c=u[u.length-1],f;(f=c<l)&&(d=l,l=c,c=d);var d=i(l),h=i(c),p,g,m,v=s==null?10:+s,y=[];if(!(r%1)&&h-d<v){if(d=Math.floor(d),h=Math.ceil(h),l>0){for(;d<=h;++d)for(g=1,p=a(d);g<r;++g)if(m=p*g,!(m<l)){if(m>c)break;y.push(m)}}else for(;d<=h;++d)for(g=r-1,p=a(d);g>=1;--g)if(m=p*g,!(m<l)){if(m>c)break;y.push(m)}y.length*2<v&&(y=x4(l,c,v))}else y=x4(d,h,Math.min(h-d,v)).map(a);return f?y.reverse():y},t.tickFormat=function(s,u){if(u==null&&(u=r===10?".0e":","),typeof u!="function"&&(u=RA(u)),s===1/0)return u;s==null&&(s=10);var l=Math.max(1,r*s/t.ticks().length);return function(c){var f=c/a(Math.round(i(c)));return f*r<r-.5&&(f*=r),f<=l?u(c):""}},t.nice=function(){return n(tse(n(),{floor:function(s){return a(Math.floor(i(s)))},ceil:function(s){return a(Math.ceil(i(s)))}}))},t}function ase(){var e=SB(IA()).domain([1,10]);return e.copy=function(){return V1(e,ase()).base(e.base())},al.apply(e,arguments),e}function ose(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function sse(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function EB(e){var t=1,n=e(ose(t),sse(t));return n.constant=function(r){return arguments.length?e(ose(t=+r),sse(t)):t},Sp(n)}function use(){var e=EB(IA());return e.copy=function(){return V1(e,use()).constant(e.constant())},al.apply(e,arguments)}function lse(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function YYe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function ZYe(e){return e<0?-e*e:e*e}function CB(e){var t=e(uo,uo),n=1;function r(){return n===1?e(uo,uo):n===.5?e(YYe,ZYe):e(lse(n),lse(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},Sp(t)}function AB(){var e=CB(IA());return e.copy=function(){return V1(e,AB()).exponent(e.exponent())},al.apply(e,arguments),e}function JYe(){return AB.apply(null,arguments).exponent(.5)}function cse(){var e=[],t=[],n=[],r;function i(){var o=0,s=Math.max(1,t.length);for(n=new Array(s-1);++o<s;)n[o-1]=wre(e,o/s);return a}function a(o){return o==null||isNaN(o=+o)?r:t[rd(n,o)]}return a.invertExtent=function(o){var s=t.indexOf(o);return s<0?[NaN,NaN]:[s>0?n[s-1]:e[0],s<n.length?n[s]:e[e.length-1]]},a.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let s of o)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(hv),i()},a.range=function(o){return arguments.length?(t=Array.from(o),i()):t.slice()},a.unknown=function(o){return arguments.length?(r=o,a):r},a.quantiles=function(){return n.slice()},a.copy=function(){return cse().domain(e).range(t).unknown(r)},al.apply(a,arguments)}function fse(){var e=0,t=1,n=1,r=[.5],i=[0,1],a;function o(u){return u!=null&&u<=u?i[rd(r,u,0,n)]:a}function s(){var u=-1;for(r=new Array(n);++u<n;)r[u]=((u+1)*t-(u-n)*e)/(n+1);return o}return o.domain=function(u){return arguments.length?([e,t]=u,e=+e,t=+t,s()):[e,t]},o.range=function(u){return arguments.length?(n=(i=Array.from(u)).length-1,s()):i.slice()},o.invertExtent=function(u){var l=i.indexOf(u);return l<0?[NaN,NaN]:l<1?[e,r[0]]:l>=n?[r[n-1],t]:[r[l-1],r[l]]},o.unknown=function(u){return arguments.length&&(a=u),o},o.thresholds=function(){return r.slice()},o.copy=function(){return fse().domain([e,t]).range(i).unknown(a)},al.apply(Sp(o),arguments)}function dse(){var e=[.5],t=[0,1],n,r=1;function i(a){return a!=null&&a<=a?t[rd(e,a,0,r)]:n}return i.domain=function(a){return arguments.length?(e=Array.from(a),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(a){return arguments.length?(t=Array.from(a),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(a){var o=t.indexOf(a);return[e[o-1],e[o]]},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return dse().domain(e).range(t).unknown(n)},al.apply(i,arguments)}function QYe(e){return new Date(e)}function eZe(e){return e instanceof Date?+e:+new Date(+e)}function kB(e,t,n,r,i,a,o,s,u,l){var c=joe(),f=c.invert,d=c.domain,h=l(".%L"),p=l(":%S"),g=l("%I:%M"),m=l("%I %p"),v=l("%a %d"),y=l("%b %d"),b=l("%B"),x=l("%Y");function w(S){return(u(S)<S?h:s(S)<S?p:o(S)<S?g:a(S)<S?m:r(S)<S?i(S)<S?v:y:n(S)<S?b:x)(S)}return c.invert=function(S){return new Date(f(S))},c.domain=function(S){return arguments.length?d(Array.from(S,eZe)):d().map(QYe)},c.ticks=function(S){var C=d();return e(C[0],C[C.length-1],S??10)},c.tickFormat=function(S,C){return C==null?w:l(C)},c.nice=function(S){var C=d();return(!S||typeof S.range!="function")&&(S=t(C[0],C[C.length-1],S??10)),S?d(tse(C,S)):c},c.copy=function(){return V1(c,kB(e,t,n,r,i,a,o,s,u,l))},c}function tZe(){return al.apply(kB(SHe,EHe,_c,GC,g1,od,O4,T4,ad,q4).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function nZe(){return al.apply(kB(wHe,_He,Sc,KC,v1,sd,D4,N4,ad,H4).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function FA(){var e=0,t=1,n,r,i,a,o=uo,s=!1,u;function l(f){return f==null||isNaN(f=+f)?u:o(i===0?.5:(f=(a(f)-n)*i,s?Math.max(0,Math.min(1,f)):f))}l.domain=function(f){return arguments.length?([e,t]=f,n=a(e=+e),r=a(t=+t),i=n===r?0:1/(r-n),l):[e,t]},l.clamp=function(f){return arguments.length?(s=!!f,l):s},l.interpolator=function(f){return arguments.length?(o=f,l):o};function c(f){return function(d){var h,p;return arguments.length?([h,p]=d,o=f(h,p),l):[o(0),o(1)]}}return l.range=c(md),l.rangeRound=c(W1),l.unknown=function(f){return arguments.length?(u=f,l):u},function(f){return a=f,n=f(e),r=f(t),i=n===r?0:1/(r-n),l}}function vd(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function TB(){var e=Sp(FA()(uo));return e.copy=function(){return vd(e,TB())},hd.apply(e,arguments)}function hse(){var e=SB(FA()).domain([1,10]);return e.copy=function(){return vd(e,hse()).base(e.base())},hd.apply(e,arguments)}function pse(){var e=EB(FA());return e.copy=function(){return vd(e,pse()).constant(e.constant())},hd.apply(e,arguments)}function OB(){var e=CB(FA());return e.copy=function(){return vd(e,OB()).exponent(e.exponent())},hd.apply(e,arguments)}function rZe(){return OB.apply(null,arguments).exponent(.5)}function MA(){var e=0,t=.5,n=1,r=1,i,a,o,s,u,l=uo,c,f=!1,d;function h(g){return isNaN(g=+g)?d:(g=.5+((g=+c(g))-a)*(r*g<r*a?s:u),l(f?Math.max(0,Math.min(1,g)):g))}h.domain=function(g){return arguments.length?([e,t,n]=g,i=c(e=+e),a=c(t=+t),o=c(n=+n),s=i===a?0:.5/(a-i),u=a===o?0:.5/(o-a),r=a<i?-1:1,h):[e,t,n]},h.clamp=function(g){return arguments.length?(f=!!g,h):f},h.interpolator=function(g){return arguments.length?(l=g,h):l};function p(g){return function(m){var v,y,b;return arguments.length?([v,y,b]=m,l=yB(g,[v,y,b]),h):[l(0),l(.5),l(1)]}}return h.range=p(md),h.rangeRound=p(W1),h.unknown=function(g){return arguments.length?(d=g,h):d},function(g){return c=g,i=g(e),a=g(t),o=g(n),s=i===a?0:.5/(a-i),u=a===o?0:.5/(o-a),r=a<i?-1:1,h}}function gse(){var e=Sp(MA()(uo));return e.copy=function(){return vd(e,gse())},hd.apply(e,arguments)}function mse(){var e=SB(MA()).domain([.1,1,10]);return e.copy=function(){return vd(e,mse()).base(e.base())},hd.apply(e,arguments)}function vse(){var e=EB(MA());return e.copy=function(){return vd(e,vse()).constant(e.constant())},hd.apply(e,arguments)}function IB(){var e=CB(MA());return e.copy=function(){return vd(e,IB()).exponent(e.exponent())},hd.apply(e,arguments)}function iZe(){return IB.apply(null,arguments).exponent(.5)}function NB(e,t,n){const r=e-t+n*2;return e?r>0?r:1:0}const aZe="identity",Nv="linear",Ac="log",H1="pow",G1="sqrt",PA="symlog",Ep="time",Cp="utc",ll="sequential",Dv="diverging",Rv="quantile",$A="quantize",LA="threshold",DB="ordinal",RB="point",yse="band",FB="bin-ordinal",ui="continuous",K1="discrete",X1="discretizing",hs="interpolating",MB="temporal";function oZe(e){return function(t){let n=t[0],r=t[1],i;return r<n&&(i=n,n=r,r=i),[e.invert(n),e.invert(r)]}}function sZe(e){return function(t){const n=e.range();let r=t[0],i=t[1],a=-1,o,s,u,l;for(i<r&&(s=r,r=i,i=s),u=0,l=n.length;u<l;++u)n[u]>=r&&n[u]<=i&&(a<0&&(a=u),o=u);if(!(a<0))return r=e.invertExtent(n[a]),i=e.invertExtent(n[o]),[r[0]===void 0?r[1]:r[0],i[1]===void 0?i[0]:i[1]]}}function PB(){const e=nB().unknown(void 0),t=e.domain,n=e.range;let r=[0,1],i,a,o=!1,s=0,u=0,l=.5;delete e.unknown;function c(){const f=t().length,d=r[1]<r[0],h=r[1-d],p=NB(f,s,u);let g=r[d-0];i=(h-g)/(p||1),o&&(i=Math.floor(i)),g+=(h-g-i*(f-s))*l,a=i*(1-s),o&&(g=Math.round(g),a=Math.round(a));const m=Bo(f).map(v=>g+i*v);return n(d?m.reverse():m)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(r=[+f[0],+f[1]],c()):r.slice()},e.rangeRound=function(f){return r=[+f[0],+f[1]],o=!0,c()},e.bandwidth=function(){return a},e.step=function(){return i},e.round=function(f){return arguments.length?(o=!!f,c()):o},e.padding=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),s=u,c()):s},e.paddingInner=function(f){return arguments.length?(s=Math.max(0,Math.min(1,f)),c()):s},e.paddingOuter=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.align=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;const d=r[1]<r[0],h=d?n().reverse():n(),p=h.length-1;let g=+f[0],m=+f[1],v,y,b;if(!(g!==g||m!==m)&&(m<g&&(b=g,g=m,m=b),!(m<h[0]||g>r[1-d])))return v=Math.max(0,rd(h,g)-1),y=g===m?v:rd(h,m)-1,g-h[v]>a+1e-10&&++v,d&&(b=v,v=p-y,y=p-b),v>y?void 0:t().slice(v,y+1)},e.invert=function(f){const d=e.invertRange([f,f]);return d&&d[0]},e.copy=function(){return PB().domain(t()).range(r).round(o).paddingInner(s).paddingOuter(u).align(l)},c()}function bse(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return bse(t())},e}function uZe(){return bse(PB().paddingInner(1))}var lZe=Array.prototype.map;function cZe(e){return lZe.call(e,Zi)}const fZe=Array.prototype.slice;function xse(){let e=[],t=[];function n(r){return r==null||r!==r?void 0:t[(rd(e,r)-1)%t.length]}return n.domain=function(r){return arguments.length?(e=cZe(r),n):e.slice()},n.range=function(r){return arguments.length?(t=fZe.call(r),n):t.slice()},n.tickFormat=function(r,i){return Joe(e[0],sn(e),r??10,i)},n.copy=function(){return xse().domain(n.domain()).range(n.range())},n}const BA={};function dZe(e,t,n){const r=function(){const a=t();return a.invertRange||(a.invertRange=a.invert?oZe(a):a.invertExtent?sZe(a):void 0),a.type=e,a};return r.metadata=nu(wt(n)),r}function Sn(e,t,n){return arguments.length>1?(BA[e]=dZe(e,t,n),this):wse(e)?BA[e]:void 0}Sn(aZe,ese),Sn(Nv,Qoe,ui),Sn(Ac,ase,[ui,Ac]),Sn(H1,AB,ui),Sn(G1,JYe,ui),Sn(PA,use,ui),Sn(Ep,tZe,[ui,MB]),Sn(Cp,nZe,[ui,MB]),Sn(ll,TB,[ui,hs]),Sn("".concat(ll,"-").concat(Nv),TB,[ui,hs]),Sn("".concat(ll,"-").concat(Ac),hse,[ui,hs,Ac]),Sn("".concat(ll,"-").concat(H1),OB,[ui,hs]),Sn("".concat(ll,"-").concat(G1),rZe,[ui,hs]),Sn("".concat(ll,"-").concat(PA),pse,[ui,hs]),Sn("".concat(Dv,"-").concat(Nv),gse,[ui,hs]),Sn("".concat(Dv,"-").concat(Ac),mse,[ui,hs,Ac]),Sn("".concat(Dv,"-").concat(H1),IB,[ui,hs]),Sn("".concat(Dv,"-").concat(G1),iZe,[ui,hs]),Sn("".concat(Dv,"-").concat(PA),vse,[ui,hs]),Sn(Rv,cse,[X1,Rv]),Sn($A,fse,X1),Sn(LA,dse,X1),Sn(FB,xse,[K1,X1]),Sn(DB,nB,K1),Sn(yse,PB,K1),Sn(RB,uZe,K1);function wse(e){return _t(BA,e)}function Ap(e,t){const n=BA[e];return n&&n.metadata[t]}function $B(e){return Ap(e,ui)}function Fv(e){return Ap(e,K1)}function LB(e){return Ap(e,X1)}function _se(e){return Ap(e,Ac)}function hZe(e){return Ap(e,MB)}function Sse(e){return Ap(e,hs)}function Ese(e){return Ap(e,Rv)}const pZe=["clamp","base","constant","exponent"];function Cse(e,t){const n=t[0],r=sn(t)-n;return function(i){return e(n+i*r)}}function zA(e,t,n){return yB(BB(t||"rgb",n),e)}function Ase(e,t){const n=new Array(t),r=t+1;for(let i=0;i<t;)n[i]=e(++i/r);return n}function kse(e,t,n){const r=n-t;let i,a,o;return!r||!Number.isFinite(r)?Ji(.5):(i=(a=e.type).indexOf("-"),a=i<0?a:a.slice(i+1),o=Sn(a)().domain([t,n]).range([0,1]),pZe.forEach(s=>e[s]?o[s](e[s]()):0),o)}function BB(e,t){const n=FYe[gZe(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function gZe(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const mZe={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},vZe={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function Tse(e){const t=e.length/6|0,n=new Array(t);for(let r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}function Ose(e,t){for(const n in e)zB(n,t(e[n]))}const Ise={};Ose(vZe,Tse),Ose(mZe,e=>zA(Tse(e)));function zB(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(Ise[e]=t,this):Ise[e]}const jA="symbol",yZe="discrete",bZe="gradient",xZe=e=>ut(e)?e.map(t=>String(t)):String(e),wZe=(e,t)=>e[1]-t[1],_Ze=(e,t)=>t[1]-e[1];function jB(e,t,n){let r;return td(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),n!=null&&(t=Math.min(t,Math.floor(l1(e.domain())/n||1)))),Nt(t)&&(r=t.step,t=t.interval),Bn(t)&&(t=e.type===Ep?mv(t):e.type==Cp?vv(t):Se("Only time and utc scales accept interval strings."),r&&(t=t.every(r))),t}function Nse(e,t,n){let r=e.range(),i=r[0],a=sn(r),o=wZe;if(i>a&&(r=a,a=i,i=r,o=_Ze),i=Math.floor(i),a=Math.ceil(a),t=t.map(s=>[s,e(s)]).filter(s=>i<=s[1]&&s[1]<=a).sort(o).map(s=>s[0]),n>0&&t.length>1){const s=[t[0],sn(t)];for(;t.length>n&&t.length>=3;)t=t.filter((u,l)=>!(l%2));t.length<3&&(t=s)}return t}function UB(e,t){return e.bins?Nse(e,e.bins):e.ticks?e.ticks(t):e.domain()}function Dse(e,t,n,r,i,a){const o=t.type;let s=xZe;if(o===Ep||i===Ep)s=e.timeFormat(r);else if(o===Cp||i===Cp)s=e.utcFormat(r);else if(_se(o)){const u=e.formatFloat(r);if(a||t.bins)s=u;else{const l=Rse(t,n,!1);s=c=>l(c)?u(c):""}}else if(t.tickFormat){const u=t.domain();s=e.formatSpan(u[0],u[u.length-1],n,r)}else r&&(s=e.format(r));return s}function Rse(e,t,n){const r=UB(e,t),i=e.base(),a=Math.log(i),o=Math.max(1,i*t/r.length),s=u=>{let l=u/Math.pow(i,Math.round(Math.log(u)/a));return l*i<i-.5&&(l*=i),l<=o};return n?r.filter(s):s}const WB={[Rv]:"quantiles",[$A]:"thresholds",[LA]:"domain"},Fse={[Rv]:"quantiles",[$A]:"domain"};function Mse(e,t){return e.bins?CZe(e.bins):e.type===Ac?Rse(e,t,!0):WB[e.type]?EZe(e[WB[e.type]]()):UB(e,t)}function SZe(e,t,n){const r=t[Fse[t.type]](),i=r.length;let a=i>1?r[1]-r[0]:r[0],o;for(o=1;o<i;++o)a=Math.min(a,r[o]-r[o-1]);return e.formatSpan(0,a,3*10,n)}function EZe(e){const t=[-1/0].concat(e);return t.max=1/0,t}function CZe(e){const t=e.slice(0,-1);return t.max=sn(e),t}const AZe=e=>WB[e.type]||e.bins;function Pse(e,t,n,r,i,a,o){const s=Fse[t.type]&&a!==Ep&&a!==Cp?SZe(e,t,i):Dse(e,t,n,i,a,o);return r===jA&&AZe(t)?kZe(s):r===yZe?TZe(s):OZe(s)}const kZe=e=>(t,n,r)=>{const i=$se(r[n+1],$se(r.max,1/0)),a=Lse(t,e),o=Lse(i,e);return a&&o?a+" \u2013 "+o:o?"< "+o:"\u2265 "+a},$se=(e,t)=>e??t,TZe=e=>(t,n)=>n?e(t):null,OZe=e=>t=>e(t),Lse=(e,t)=>Number.isFinite(e)?t(e):null;function IZe(e){const t=e.domain(),n=t.length-1;let r=+t[0],i=+sn(t),a=i-r;if(e.type===LA){const o=n?a/n:.1;r-=o,i+=o,a=i-r}return o=>(o-r)/a}function NZe(e,t,n,r){const i=r||t.type;return Bn(n)&&hZe(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&i===Ep?e.timeFormat("%A, %d %B %Y, %X"):!n&&i===Cp?e.utcFormat("%A, %d %B %Y, %X UTC"):Pse(e,t,5,null,n,r,!0)}function Bse(e,t,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=NZe(e,t,n.format,n.formatType);if(LB(t.type)){const a=Mse(t).slice(1).map(i),o=a.length;return"".concat(o," boundar").concat(o===1?"y":"ies",": ").concat(a.join(", "))}else if(Fv(t.type)){const a=t.domain(),o=a.length,s=o>r?a.slice(0,r-2).map(i).join(", ")+", ending with "+a.slice(-1).map(i):a.map(i).join(", ");return"".concat(o," value").concat(o===1?"":"s",": ").concat(s)}else{const a=t.domain();return"values from ".concat(i(a[0])," to ").concat(i(sn(a)))}}let zse=0;function DZe(){zse=0}const UA="p_";function VB(e){return e&&e.gradient}function jse(e,t,n){const r=e.gradient;let i=e.id,a=r==="radial"?UA:"";return i||(i=e.id="gradient_"+zse++,r==="radial"?(e.x1=cl(e.x1,.5),e.y1=cl(e.y1,.5),e.r1=cl(e.r1,0),e.x2=cl(e.x2,.5),e.y2=cl(e.y2,.5),e.r2=cl(e.r2,.5),a=UA):(e.x1=cl(e.x1,0),e.y1=cl(e.y1,0),e.x2=cl(e.x2,1),e.y2=cl(e.y2,0))),t[i]=e,"url("+(n||"")+"#"+a+i+")"}function cl(e,t){return e??t}function Use(e,t){var n=[],r;return r={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(i,a){return n.push({offset:i,color:a}),r}}}const Wse={basis:{curve:FXe},"basis-closed":{curve:MXe},"basis-open":{curve:PXe},bundle:{curve:$Xe,tension:"beta",value:.85},cardinal:{curve:LXe,tension:"tension",value:0},"cardinal-open":{curve:zXe,tension:"tension",value:0},"cardinal-closed":{curve:BXe,tension:"tension",value:0},"catmull-rom":{curve:jXe,tension:"alpha",value:.5},"catmull-rom-closed":{curve:UXe,tension:"alpha",value:.5},"catmull-rom-open":{curve:WXe,tension:"alpha",value:.5},linear:{curve:XL},"linear-closed":{curve:VXe},monotone:{horizontal:HXe,vertical:qXe},natural:{curve:GXe},step:{curve:KXe},"step-after":{curve:YXe},"step-before":{curve:XXe}};function qB(e,t,n){var r=_t(Wse,e)&&Wse[e],i=null;return r&&(i=r.curve||r[t||"vertical"],r.tension&&n!=null&&(i=i[r.tension](n))),i}const RZe={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},Y1=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];function Mv(e){const t=[];let n,r,i,a,o,s,u,l,c,f;const d=e.slice().replace(Y1[0],"###$1").split(Y1[1]).slice(1);for(u=0,c=d.length;u<c;++u){for(n=d[u],r=n.slice(1).trim().replace(Y1[2],"$1###$2").replace(Y1[3],"$1###$2").split(Y1[4]),o=n.charAt(0),i=[o],l=0,f=r.length;l<f;++l)(a=+r[l])===a&&i.push(a);if(s=RZe[o.toLowerCase()],i.length-1>s){const h=i.length;for(l=1,t.push([o].concat(i.slice(l,l+=s))),o=o==="M"?"L":o==="m"?"l":o;l<h;l+=s)t.push([o].concat(i.slice(l,l+s)))}else t.push(i)}return t}const yd=Math.PI/180,FZe=1e-14,kp=Math.PI/2,fl=Math.PI*2,Pv=Math.sqrt(3)/2;var HB={},GB={},Vse=[].join;function MZe(e,t,n,r,i,a,o,s,u){const l=Vse.call(arguments);if(HB[l])return HB[l];const c=o*yd,f=Math.sin(c),d=Math.cos(c);n=Math.abs(n),r=Math.abs(r);const h=d*(s-e)*.5+f*(u-t)*.5,p=d*(u-t)*.5-f*(s-e)*.5;let g=h*h/(n*n)+p*p/(r*r);g>1&&(g=Math.sqrt(g),n*=g,r*=g);const m=d/n,v=f/n,y=-f/r,b=d/r,x=m*s+v*u,w=y*s+b*u,S=m*e+v*t,C=y*e+b*t,_=(S-x)*(S-x)+(C-w)*(C-w);let E=1/_-.25;E<0&&(E=0);let A=Math.sqrt(E);a==i&&(A=-A);const k=.5*(x+S)-A*(C-w),T=.5*(w+C)+A*(S-x),I=Math.atan2(w-T,x-k);let O=Math.atan2(C-T,S-k)-I;O<0&&a===1?O+=fl:O>0&&a===0&&(O-=fl);const D=Math.ceil(Math.abs(O/(kp+.001))),L=[];for(let W=0;W<D;++W){const G=I+W*O/D,K=I+(W+1)*O/D;L[W]=[k,T,G,K,n,r,f,d]}return HB[l]=L}function PZe(e){const t=Vse.call(e);if(GB[t])return GB[t];var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],l=e[7];const c=l*o,f=-u*s,d=u*o,h=l*s,p=Math.cos(i),g=Math.sin(i),m=Math.cos(a),v=Math.sin(a),y=.5*(a-i),b=Math.sin(y*.5),x=8/3*b*b/Math.sin(y),w=n+p-x*g,S=r+g+x*p,C=n+m,_=r+v,E=C+x*v,A=_-x*m;return GB[t]=[c*w+f*S,d*w+h*S,c*E+f*A,d*E+h*A,c*C+f*_,d*C+h*_]}const ps=["l",0,0,0,0,0,0,0];function $Ze(e,t,n){const r=ps[0]=e[0];if(r==="a"||r==="A")ps[1]=t*e[1],ps[2]=n*e[2],ps[3]=e[3],ps[4]=e[4],ps[5]=e[5],ps[6]=t*e[6],ps[7]=n*e[7];else if(r==="h"||r==="H")ps[1]=t*e[1];else if(r==="v"||r==="V")ps[1]=n*e[1];else for(var i=1,a=e.length;i<a;++i)ps[i]=(i%2==1?t:n)*e[i];return ps}function Z1(e,t,n,r,i,a){var o,s=null,u=0,l=0,c=0,f=0,d,h,p,g;n==null&&(n=0),r==null&&(r=0),i==null&&(i=1),a==null&&(a=i),e.beginPath&&e.beginPath();for(var m=0,v=t.length;m<v;++m){switch(o=t[m],(i!==1||a!==1)&&(o=$Ze(o,i,a)),o[0]){case"l":u+=o[1],l+=o[2],e.lineTo(u+n,l+r);break;case"L":u=o[1],l=o[2],e.lineTo(u+n,l+r);break;case"h":u+=o[1],e.lineTo(u+n,l+r);break;case"H":u=o[1],e.lineTo(u+n,l+r);break;case"v":l+=o[1],e.lineTo(u+n,l+r);break;case"V":l=o[1],e.lineTo(u+n,l+r);break;case"m":u+=o[1],l+=o[2],e.moveTo(u+n,l+r);break;case"M":u=o[1],l=o[2],e.moveTo(u+n,l+r);break;case"c":d=u+o[5],h=l+o[6],c=u+o[3],f=l+o[4],e.bezierCurveTo(u+o[1]+n,l+o[2]+r,c+n,f+r,d+n,h+r),u=d,l=h;break;case"C":u=o[5],l=o[6],c=o[3],f=o[4],e.bezierCurveTo(o[1]+n,o[2]+r,c+n,f+r,u+n,l+r);break;case"s":d=u+o[3],h=l+o[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+r,u+o[1]+n,l+o[2]+r,d+n,h+r),c=u+o[1],f=l+o[2],u=d,l=h;break;case"S":d=o[3],h=o[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+r,o[1]+n,o[2]+r,d+n,h+r),u=d,l=h,c=o[1],f=o[2];break;case"q":d=u+o[3],h=l+o[4],c=u+o[1],f=l+o[2],e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h;break;case"Q":d=o[3],h=o[4],e.quadraticCurveTo(o[1]+n,o[2]+r,d+n,h+r),u=d,l=h,c=o[1],f=o[2];break;case"t":d=u+o[1],h=l+o[2],s[0].match(/[QqTt]/)===null?(c=u,f=l):s[0]==="t"?(c=2*u-p,f=2*l-g):s[0]==="q"&&(c=2*u-c,f=2*l-f),p=c,g=f,e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h,c=u+o[1],f=l+o[2];break;case"T":d=o[1],h=o[2],c=2*u-c,f=2*l-f,e.quadraticCurveTo(c+n,f+r,d+n,h+r),u=d,l=h;break;case"a":qse(e,u+n,l+r,[o[1],o[2],o[3],o[4],o[5],o[6]+u+n,o[7]+l+r]),u+=o[6],l+=o[7];break;case"A":qse(e,u+n,l+r,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+r]),u=o[6],l=o[7];break;case"z":case"Z":e.closePath();break}s=o}}function qse(e,t,n,r){const i=MZe(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n);for(let a=0;a<i.length;++a){const o=PZe(i[a]);e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}const Hse=.5773502691896257,Gse={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,fl)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,a=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-a),e.lineTo(i,-a),e.lineTo(0,-n),e.lineTo(-i,-a),e.lineTo(-r,-a),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=Pv*n,i=r-n*Hse,a=n/4;e.moveTo(0,-r-i),e.lineTo(-a,r-i),e.lineTo(a,r-i),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=Pv*n,i=r-n*Hse;e.moveTo(0,-r-i),e.lineTo(-n,r-i),e.lineTo(n,r-i),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Pv*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Pv*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Pv*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=Pv*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function Kse(e){return _t(Gse,e)?Gse[e]:LZe(e)}var KB={};function LZe(e){if(!_t(KB,e)){const t=Mv(e);KB[e]={draw:function(n,r){Z1(n,t,0,0,Math.sqrt(r)/2)}}}return KB[e]}const bd=.448084975506;function BZe(e){return e.x}function zZe(e){return e.y}function jZe(e){return e.width}function UZe(e){return e.height}function kc(e){return typeof e=="function"?e:()=>+e}function WA(e,t,n){return Math.max(t,Math.min(e,n))}function Xse(){var e=BZe,t=zZe,n=jZe,r=UZe,i=kc(0),a=i,o=i,s=i,u=null;function l(c,f,d){var h,p=f??+e.call(this,c),g=d??+t.call(this,c),m=+n.call(this,c),v=+r.call(this,c),y=Math.min(m,v)/2,b=WA(+i.call(this,c),0,y),x=WA(+a.call(this,c),0,y),w=WA(+o.call(this,c),0,y),S=WA(+s.call(this,c),0,y);if(u||(u=h=bp()),b<=0&&x<=0&&w<=0&&S<=0)u.rect(p,g,m,v);else{var C=p+m,_=g+v;u.moveTo(p+b,g),u.lineTo(C-x,g),u.bezierCurveTo(C-bd*x,g,C,g+bd*x,C,g+x),u.lineTo(C,_-S),u.bezierCurveTo(C,_-bd*S,C-bd*S,_,C-S,_),u.lineTo(p+w,_),u.bezierCurveTo(p+bd*w,_,p,_-bd*w,p,_-w),u.lineTo(p,g+b),u.bezierCurveTo(p,g+bd*b,p+bd*b,g,p+b,g),u.closePath()}if(h)return u=null,h+""||null}return l.x=function(c){return arguments.length?(e=kc(c),l):e},l.y=function(c){return arguments.length?(t=kc(c),l):t},l.width=function(c){return arguments.length?(n=kc(c),l):n},l.height=function(c){return arguments.length?(r=kc(c),l):r},l.cornerRadius=function(c,f,d,h){return arguments.length?(i=kc(c),a=f!=null?kc(f):i,s=d!=null?kc(d):i,o=h!=null?kc(h):a,l):i},l.context=function(c){return arguments.length?(u=c??null,l):u},l}function Yse(){var e,t,n,r,i=null,a,o,s,u;function l(f,d,h){const p=h/2;if(a){var g=s-d,m=f-o;if(g||m){var v=Math.sqrt(g*g+m*m),y=(g/=v)*u,b=(m/=v)*u,x=Math.atan2(m,g);i.moveTo(o-y,s-b),i.lineTo(f-g*p,d-m*p),i.arc(f,d,p,x-Math.PI,x),i.lineTo(o+y,s+b),i.arc(o,s,u,x,x+Math.PI)}else i.arc(f,d,p,0,fl);i.closePath()}else a=1;o=f,s=d,u=p}function c(f){var d,h=f.length,p,g=!1,m;for(i==null&&(i=m=bp()),d=0;d<=h;++d)!(d<h&&r(p=f[d],d,f))===g&&(g=!g)&&(a=0),g&&l(+e(p,d,f),+t(p,d,f),+n(p,d,f));if(m)return i=null,m+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(r=f,c):r},c.context=function(f){return arguments.length?(f==null?i=null:i=f,c):i},c}function J1(e,t){return e??t}const Q1=e=>e.x||0,ex=e=>e.y||0,WZe=e=>e.width||0,VZe=e=>e.height||0,qZe=e=>(e.x||0)+(e.width||0),HZe=e=>(e.y||0)+(e.height||0),GZe=e=>e.startAngle||0,KZe=e=>e.endAngle||0,XZe=e=>e.padAngle||0,YZe=e=>e.innerRadius||0,ZZe=e=>e.outerRadius||0,JZe=e=>e.cornerRadius||0,QZe=e=>J1(e.cornerRadiusTopLeft,e.cornerRadius)||0,eJe=e=>J1(e.cornerRadiusTopRight,e.cornerRadius)||0,tJe=e=>J1(e.cornerRadiusBottomRight,e.cornerRadius)||0,nJe=e=>J1(e.cornerRadiusBottomLeft,e.cornerRadius)||0,rJe=e=>J1(e.size,64),iJe=e=>e.size||1,VA=e=>e.defined!==!1,aJe=e=>Kse(e.shape||"circle"),oJe=NXe().startAngle(GZe).endAngle(KZe).padAngle(XZe).innerRadius(YZe).outerRadius(ZZe).cornerRadius(JZe),sJe=jae().x(Q1).y1(ex).y0(HZe).defined(VA),uJe=jae().y(ex).x1(Q1).x0(qZe).defined(VA),lJe=zae().x(Q1).y(ex).defined(VA),cJe=Xse().x(Q1).y(ex).width(WZe).height(VZe).cornerRadius(QZe,eJe,tJe,nJe),fJe=RXe().type(aJe).size(rJe),dJe=Yse().x(Q1).y(ex).defined(VA).size(iJe);function XB(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function hJe(e,t){return oJe.context(e)(t)}function pJe(e,t){const n=t[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?uJe:sJe).curve(qB(r,n.orient,n.tension)).context(e)(t)}function gJe(e,t){const n=t[0],r=n.interpolate||"linear";return lJe.curve(qB(r,n.orient,n.tension)).context(e)(t)}function $v(e,t,n,r){return cJe.context(e)(t,n,r)}function mJe(e,t){return(t.mark.shape||t.shape).context(e)(t)}function vJe(e,t){return fJe.context(e)(t)}function yJe(e,t){return dJe.context(e)(t)}var Zse=1;function Jse(){Zse=1}function YB(e,t,n){var r=t.clip,i=e._defs,a=t.clip_id||(t.clip_id="clip"+Zse++),o=i.clipping[a]||(i.clipping[a]={id:a});return Lt(r)?o.path=r(null):XB(n)?o.path=$v(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+a+")"}function li(e){this.clear(),e&&this.union(e)}li.prototype={clone(){return new li(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(e,t,n){var{x1:r,y1:i,x2:a,y2:o}=this,s=Math.cos(e),u=Math.sin(e),l=t-t*s+n*u,c=n-t*u-n*s;return[s*r-u*i+l,u*r+s*i+c,s*r-u*o+l,u*r+s*o+c,s*a-u*i+l,u*a+s*i+c,s*a-u*o+l,u*a+s*o+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function qA(e){this.mark=e,this.bounds=this.bounds||new li}function HA(e){qA.call(this,e),this.items=this.items||[]}$e(HA,qA);function ZB(e){this._pending=0,this._loader=e||ZC()}function Qse(e){e._pending+=1}function tx(e){e._pending-=1}ZB.prototype={pending(){return this._pending},sanitizeURL(e){const t=this;return Qse(t),t._loader.sanitize(e,{context:"href"}).then(n=>(tx(t),n)).catch(()=>(tx(t),null))},loadImage(e){const t=this,n=ZXe();return Qse(t),t._loader.sanitize(e,{context:"image"}).then(r=>{const i=r.href;if(!i||!n)throw{url:i};const a=new n,o=_t(r,"crossOrigin")?r.crossOrigin:"anonymous";return o!=null&&(a.crossOrigin=o),a.onload=()=>tx(t),a.onerror=()=>tx(t),a.src=i,a}).catch(r=>(tx(t),{complete:!1,width:0,height:0,src:r&&r.url||""}))},ready(){const e=this;return new Promise(t=>{function n(r){e.pending()?setTimeout(()=>{n(!0)},10):t(r)}n(!1)})}};function Tc(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){const r=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(r+(n?bJe(t,r):0))}return e}function bJe(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}const xJe=fl-1e-8;let GA,KA,XA,Tp,JB,YA,QB,ez;const xd=(e,t)=>GA.add(e,t),ZA=(e,t)=>xd(KA=e,XA=t),eue=e=>xd(e,GA.y1),tue=e=>xd(GA.x1,e),Op=(e,t)=>JB*e+QB*t,Ip=(e,t)=>YA*e+ez*t,tz=(e,t)=>xd(Op(e,t),Ip(e,t)),nz=(e,t)=>ZA(Op(e,t),Ip(e,t));function nx(e,t){return GA=e,t?(Tp=t*yd,JB=ez=Math.cos(Tp),YA=Math.sin(Tp),QB=-YA):(JB=ez=1,Tp=YA=QB=0),wJe}const wJe={beginPath(){},closePath(){},moveTo:nz,lineTo:nz,rect(e,t,n,r){Tp?(tz(e+n,t),tz(e+n,t+r),tz(e,t+r),nz(e,t)):(xd(e+n,t+r),ZA(e,t))},quadraticCurveTo(e,t,n,r){const i=Op(e,t),a=Ip(e,t),o=Op(n,r),s=Ip(n,r);nue(KA,i,o,eue),nue(XA,a,s,tue),ZA(o,s)},bezierCurveTo(e,t,n,r,i,a){const o=Op(e,t),s=Ip(e,t),u=Op(n,r),l=Ip(n,r),c=Op(i,a),f=Ip(i,a);rue(KA,o,u,c,eue),rue(XA,s,l,f,tue),ZA(c,f)},arc(e,t,n,r,i,a){if(r+=Tp,i+=Tp,KA=n*Math.cos(i)+e,XA=n*Math.sin(i)+t,Math.abs(i-r)>xJe)xd(e-n,t-n),xd(e+n,t+n);else{const o=l=>xd(n*Math.cos(l)+e,n*Math.sin(l)+t);let s,u;if(o(r),o(i),i!==r)if(r=r%fl,r<0&&(r+=fl),i=i%fl,i<0&&(i+=fl),i<r&&(a=!a,s=r,r=i,i=s),a)for(i-=fl,s=r-r%kp,u=0;u<4&&s>i;++u,s-=kp)o(s);else for(s=r-r%kp+kp,u=0;u<4&&s<i;++u,s=s+kp)o(s)}}};function nue(e,t,n,r){const i=(e-t)/(e+n-2*t);0<i&&i<1&&r(e+(t-e)*i)}function rue(e,t,n,r,i){const a=r-e+3*t-3*n,o=e+n-2*t,s=e-t;let u=0,l=0,c;Math.abs(a)>FZe?(c=o*o+s*a,c>=0&&(c=Math.sqrt(c),u=(-o+c)/a,l=(-o-c)/a)):u=.5*s/o,0<u&&u<1&&i(iue(u,e,t,n,r)),0<l&&l<1&&i(iue(l,e,t,n,r))}function iue(e,t,n,r,i){const a=1-e,o=a*a,s=e*e;return o*a*t+3*o*e*n+3*a*s*r+s*e*i}var wd=(wd=Cv(1,1))?wd.getContext("2d"):null;const rz=new li;function iz(e){return function(t,n){if(!wd)return!0;e(wd,t),rz.clear().union(t.bounds).intersect(n).round();const{x1:r,y1:i,x2:a,y2:o}=rz;for(let s=i;s<=o;++s)for(let u=r;u<=a;++u)if(wd.isPointInPath(u,s))return!0;return!1}}function az(e,t){return t.contains(e.x||0,e.y||0)}function aue(e,t){const n=e.x||0,r=e.y||0,i=e.width||0,a=e.height||0;return t.intersects(rz.set(n,r,n+i,r+a))}function oue(e,t){const n=e.x||0,r=e.y||0,i=e.x2!=null?e.x2:n,a=e.y2!=null?e.y2:r;return Lv(t,n,r,i,a)}function Lv(e,t,n,r,i){const{x1:a,y1:o,x2:s,y2:u}=e,l=r-t,c=i-n;let f=0,d=1,h,p,g,m;for(m=0;m<4;++m){if(m===0&&(h=-l,p=-(a-t)),m===1&&(h=l,p=s-t),m===2&&(h=-c,p=-(o-n)),m===3&&(h=c,p=u-n),Math.abs(h)<1e-10&&p<0)return!1;if(g=p/h,h<0){if(g>d)return!1;g>f&&(f=g)}else if(h>0){if(g<f)return!1;g<d&&(d=g)}}return!0}function Bv(e,t){e.globalCompositeOperation=t.blend||"source-over"}function au(e,t){return e??t}function sue(e,t){const n=t.length;for(let r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function _Je(e,t,n){const r=n.width(),i=n.height();let a;if(t.gradient==="radial")a=e.createRadialGradient(n.x1+au(t.x1,.5)*r,n.y1+au(t.y1,.5)*i,Math.max(r,i)*au(t.r1,0),n.x1+au(t.x2,.5)*r,n.y1+au(t.y2,.5)*i,Math.max(r,i)*au(t.r2,.5));else{const o=au(t.x1,0),s=au(t.y1,0),u=au(t.x2,1),l=au(t.y2,0);if(o===u||s===l||r===i)a=e.createLinearGradient(n.x1+o*r,n.y1+s*i,n.x1+u*r,n.y1+l*i);else{const c=Cv(Math.ceil(r),Math.ceil(i)),f=c.getContext("2d");return f.scale(r,i),f.fillStyle=sue(f.createLinearGradient(o,s,u,l),t.stops),f.fillRect(0,0,r,i),e.createPattern(c,"no-repeat")}}return sue(a,t.stops)}function uue(e,t,n){return VB(n)?_Je(e,n,t.bounds):n}function JA(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=uue(e,t,t.fill),!0):!1}var SJe=[];function zv(e,t,n){var r=(r=t.strokeWidth)!=null?r:1;return r<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=uue(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||SJe),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function EJe(e,t){return e.zindex-t.zindex||e.index-t.index}function oz(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],r,i,a;for(i=0,a=t.length;i<a;++i)r=t[i],r.index=i,r.zindex&&n.push(r);return e.zdirty=!1,e.zitems=n.sort(EJe)}function ou(e,t){var n=e.items,r,i;if(!n||!n.length)return;const a=oz(e);if(a&&a.length){for(r=0,i=n.length;r<i;++r)n[r].zindex||t(n[r]);n=a}for(r=0,i=n.length;r<i;++r)t(n[r])}function QA(e,t){var n=e.items,r,i;if(!n||!n.length)return null;const a=oz(e);for(a&&a.length&&(n=a),i=n.length;--i>=0;)if(r=t(n[i]))return r;if(n===a){for(n=e.items,i=n.length;--i>=0;)if(!n[i].zindex&&(r=t(n[i])))return r}return null}function sz(e){return function(t,n,r){ou(n,i=>{(!r||r.intersects(i.bounds))&&lue(e,t,i,i)})}}function CJe(e){return function(t,n,r){n.items.length&&(!r||r.intersects(n.bounds))&&lue(e,t,n.items[0],n.items)}}function lue(e,t,n,r){var i=n.opacity==null?1:n.opacity;i!==0&&(e(t,r)||(Bv(t,n),n.fill&&JA(t,n,i)&&t.fill(),n.stroke&&zv(t,n,i)&&t.stroke()))}function ek(e){return e=e||ls,function(t,n,r,i,a,o){return r*=t.pixelRatio,i*=t.pixelRatio,QA(n,s=>{const u=s.bounds;if(!(u&&!u.contains(a,o)||!u)&&e(t,s,r,i,a,o))return s})}}function rx(e,t){return function(n,r,i,a){var o=Array.isArray(r)?r[0]:r,s=t??o.fill,u=o.stroke&&n.isPointInStroke,l,c;return u&&(l=o.strokeWidth,c=o.strokeCap,n.lineWidth=l??1,n.lineCap=c??"butt"),e(n,r)?!1:s&&n.isPointInPath(i,a)||u&&n.isPointInStroke(i,a)}}function uz(e){return ek(rx(e))}function Np(e,t){return"translate("+e+","+t+")"}function lz(e){return"rotate("+e+")"}function AJe(e,t){return"scale("+e+","+t+")"}function cue(e){return Np(e.x||0,e.y||0)}function kJe(e){return Np(e.x||0,e.y||0)+(e.angle?" "+lz(e.angle):"")}function TJe(e){return Np(e.x||0,e.y||0)+(e.angle?" "+lz(e.angle):"")+(e.scaleX||e.scaleY?" "+AJe(e.scaleX||1,e.scaleY||1):"")}function cz(e,t,n){function r(o,s){o("transform",kJe(s)),o("d",t(null,s))}function i(o,s){return t(nx(o,s.angle),s),Tc(o,s).translate(s.x||0,s.y||0)}function a(o,s){var u=s.x||0,l=s.y||0,c=s.angle||0;o.translate(u,l),c&&o.rotate(c*=yd),o.beginPath(),t(o,s),c&&o.rotate(-c),o.translate(-u,-l)}return{type:e,tag:"path",nested:!1,attr:r,bound:i,draw:sz(a),pick:uz(a),isect:n||iz(a)}}var OJe=cz("arc",hJe);function IJe(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],r=e[0].orient==="horizontal"?"y":"x",i=e.length,a=1/0,o,s;--i>=0;)e[i].defined!==!1&&(s=Math.abs(e[i][r]-n),s<a&&(a=s,o=e[i]));return o}function NJe(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),r=e.length,i,a,o;--r>=0;)if(e[r].defined!==!1&&(i=e[r].x-t[0],a=e[r].y-t[1],o=i*i+a*a,o<n))return e[r];return null}function DJe(e,t){for(var n=e.length,r,i,a;--n>=0;)if(e[n].defined!==!1&&(r=e[n].x-t[0],i=e[n].y-t[1],a=r*r+i*i,r=e[n].size||1,a<r*r))return e[n];return null}function fz(e,t,n){function r(u,l){var c=l.mark.items;c.length&&u("d",t(null,c))}function i(u,l){var c=l.items;return c.length===0?u:(t(nx(u),c),Tc(u,c[0]))}function a(u,l){u.beginPath(),t(u,l)}const o=rx(a);function s(u,l,c,f,d,h){var p=l.items,g=l.bounds;return!p||!p.length||g&&!g.contains(d,h)?null:(c*=u.pixelRatio,f*=u.pixelRatio,o(u,p,c,f)?p[0]:null)}return{type:e,tag:"path",nested:!0,attr:r,bound:i,draw:CJe(a),pick:s,isect:az,tip:n}}var RJe=fz("area",pJe,IJe);function FJe(e,t){var n=t.clip;e.save(),Lt(n)?(e.beginPath(),n(e),e.clip()):fue(e,t.group)}function fue(e,t){e.beginPath(),XB(t)?$v(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function due(e){const t=au(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function MJe(e,t){e("transform",cue(t))}function hue(e,t){const n=due(t);e("d",$v(null,t,n,n))}function PJe(e,t){e("class","background"),e("aria-hidden",!0),hue(e,t)}function $Je(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?hue(e,t):e("d","")}function LJe(e,t,n){const r=t.clip?YB(n,t,t):null;e("clip-path",r)}function BJe(e,t){if(!t.clip&&t.items){const n=t.items,r=n.length;for(let i=0;i<r;++i)e.union(n[i].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),Tc(e,t),e.translate(t.x||0,t.y||0)}function ix(e,t,n,r){const i=due(t);e.beginPath(),$v(e,t,(n||0)+i,(r||0)+i)}const zJe=rx(ix),jJe=rx(ix,!1),UJe=rx(ix,!0);function WJe(e,t,n){ou(t,r=>{const i=r.x||0,a=r.y||0,o=r.strokeForeground,s=r.opacity==null?1:r.opacity;(r.stroke||r.fill)&&s&&(ix(e,r,i,a),Bv(e,r),r.fill&&JA(e,r,s)&&e.fill(),r.stroke&&!o&&zv(e,r,s)&&e.stroke()),e.save(),e.translate(i,a),r.clip&&fue(e,r),n&&n.translate(-i,-a),ou(r,u=>{this.draw(e,u,n)}),n&&n.translate(i,a),e.restore(),o&&r.stroke&&s&&(ix(e,r,i,a),Bv(e,r),zv(e,r,s)&&e.stroke())})}function VJe(e,t,n,r,i,a){if(t.bounds&&!t.bounds.contains(i,a)||!t.items)return null;const o=n*e.pixelRatio,s=r*e.pixelRatio;return QA(t,u=>{let l,c,f;const d=u.bounds;if(d&&!d.contains(i,a))return;c=u.x||0,f=u.y||0;const h=c+(u.width||0),p=f+(u.height||0),g=u.clip;if(g&&(i<c||i>h||a<f||a>p))return;if(e.save(),e.translate(c,f),c=i-c,f=a-f,g&&XB(u)&&!UJe(e,u,o,s))return e.restore(),null;const m=u.strokeForeground,v=t.interactive!==!1;return v&&m&&u.stroke&&jJe(e,u,o,s)?(e.restore(),u):(l=QA(u,y=>qJe(y,c,f)?this.pick(y,n,r,c,f):null),!l&&v&&(u.fill||!m&&u.stroke)&&zJe(e,u,o,s)&&(l=u),e.restore(),l||null)})}function qJe(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var HJe={type:"group",tag:"g",nested:!1,attr:MJe,bound:BJe,draw:WJe,pick:VJe,isect:aue,content:LJe,background:PJe,foreground:$Je},ax={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function dz(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(r=>{e.image=r,e.image.url=e.url})),n}function hz(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function pz(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function tk(e,t){return e==="center"?t/2:e==="right"?t:0}function nk(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function GJe(e,t,n){const r=dz(t,n),i=hz(t,r),a=pz(t,r),o=(t.x||0)-tk(t.align,i),s=(t.y||0)-nk(t.baseline,a),u=!r.src&&r.toDataURL?r.toDataURL():r.src||"";e("href",u,ax["xmlns:xlink"],"xlink:href"),e("transform",Np(o,s)),e("width",i),e("height",a),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function KJe(e,t){const n=t.image,r=hz(t,n),i=pz(t,n),a=(t.x||0)-tk(t.align,r),o=(t.y||0)-nk(t.baseline,i);return e.set(a,o,a+r,o+i)}function XJe(e,t,n){ou(t,r=>{if(n&&!n.intersects(r.bounds))return;const i=dz(r,this);let a=hz(r,i),o=pz(r,i);if(a===0||o===0)return;let s=(r.x||0)-tk(r.align,a),u=(r.y||0)-nk(r.baseline,o),l,c,f,d;r.aspect!==!1&&(c=i.width/i.height,f=r.width/r.height,c===c&&f===f&&c!==f&&(f<c?(d=a/c,u+=(o-d)/2,o=d):(d=o*c,s+=(a-d)/2,a=d))),(i.complete||i.toDataURL)&&(Bv(e,r),e.globalAlpha=(l=r.opacity)!=null?l:1,e.imageSmoothingEnabled=r.smooth!==!1,e.drawImage(i,s,u,a,o))})}var YJe={type:"image",tag:"image",nested:!1,attr:GJe,bound:KJe,draw:XJe,pick:ek(),isect:ls,get:dz,xOffset:tk,yOffset:nk},ZJe=fz("line",gJe,NJe);function JJe(e,t){var n=t.scaleX||1,r=t.scaleY||1;(n!==1||r!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",TJe(t)),e("d",t.path)}function rk(e,t){var n=t.path;if(n==null)return!0;var r=t.x||0,i=t.y||0,a=t.scaleX||1,o=t.scaleY||1,s=(t.angle||0)*yd,u=t.pathCache;(!u||u.path!==n)&&((t.pathCache=u=Mv(n)).path=n),s&&e.rotate&&e.translate?(e.translate(r,i),e.rotate(s),Z1(e,u,0,0,a,o),e.rotate(-s),e.translate(-r,-i)):Z1(e,u,r,i,a,o)}function QJe(e,t){return rk(nx(e,t.angle),t)?e.set(0,0,0,0):Tc(e,t,!0)}var eQe={type:"path",tag:"path",nested:!1,attr:JJe,bound:QJe,draw:sz(rk),pick:uz(rk),isect:iz(rk)};function tQe(e,t){e("d",$v(null,t))}function nQe(e,t){var n,r;return Tc(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)}function pue(e,t){e.beginPath(),$v(e,t)}var rQe={type:"rect",tag:"path",nested:!1,attr:tQe,bound:nQe,draw:sz(pue),pick:uz(pue),isect:aue};function iQe(e,t){e("transform",cue(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function aQe(e,t){var n,r;return Tc(e.set(n=t.x||0,r=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:r),t)}function gue(e,t,n){var r,i,a,o;return t.stroke&&zv(e,t,n)?(r=t.x||0,i=t.y||0,a=t.x2!=null?t.x2:r,o=t.y2!=null?t.y2:i,e.beginPath(),e.moveTo(r,i),e.lineTo(a,o),!0):!1}function oQe(e,t,n){ou(t,r=>{if(!(n&&!n.intersects(r.bounds))){var i=r.opacity==null?1:r.opacity;i&&gue(e,r,i)&&(Bv(e,r),e.stroke())}})}function sQe(e,t,n,r){return e.isPointInStroke?gue(e,t,1)&&e.isPointInStroke(n,r):!1}var uQe={type:"rule",tag:"line",nested:!1,attr:iQe,bound:aQe,draw:oQe,pick:ek(sQe),isect:oue},lQe=cz("shape",mJe),cQe=cz("symbol",vJe,az);const mue=tre();var dl={height:hl,measureWidth:mz,estimateWidth:gz,width:gz,canvas:vue};vue(!0);function vue(e){dl.width=e&&wd?mz:gz}function gz(e,t){return yue(Sd(e,t),hl(e))}function yue(e,t){return~~(.8*e.length*t)}function mz(e,t){return hl(e)<=0||!(t=Sd(e,t))?0:bue(t,ik(e))}function bue(e,t){const n=`(${t}) ${e}`;let r=mue.get(n);return r===void 0&&(wd.font=t,r=wd.measureText(e).width,mue.set(n,r)),r}function hl(e){return e.fontSize!=null?+e.fontSize||0:11}function _d(e){return e.lineHeight!=null?e.lineHeight:hl(e)+2}function fQe(e){return ut(e)?e.length>1?e:e[0]:e}function ox(e){return fQe(e.lineBreak&&e.text&&!ut(e.text)?e.text.split(e.lineBreak):e.text)}function vz(e){const t=ox(e);return(ut(t)?t.length-1:0)*_d(e)}function Sd(e,t){const n=t==null?"":(t+"").trim();return e.limit>0&&n.length?hQe(e,n):n}function dQe(e){if(dl.width===mz){const t=ik(e);return n=>bue(n,t)}else{const t=hl(e);return n=>yue(n,t)}}function hQe(e,t){var n=+e.limit,r=dQe(e);if(r(t)<n)return t;var i=e.ellipsis||"\u2026",a=e.dir==="rtl",o=0,s=t.length,u;if(n-=r(i),a){for(;o<s;)u=o+s>>>1,r(t.slice(u))>n?o=u+1:s=u;return i+t.slice(o)}else{for(;o<s;)u=1+(o+s>>>1),r(t.slice(0,u))<n?o=u:s=u-1;return t.slice(0,o)+i}}function sx(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function ik(e,t){return""+(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+hl(e)+"px "+sx(e,t)}function yz(e){var t=e.baseline,n=hl(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*_d(e):t==="line-bottom"?.29*n-.5*_d(e):0)}const pQe={left:"start",center:"middle",right:"end"},ux=new li;function ak(e){var t=e.x||0,n=e.y||0,r=e.radius||0,i;return r&&(i=(e.theta||0)-kp,t+=r*Math.cos(i),n+=r*Math.sin(i)),ux.x1=t,ux.y1=n,ux}function gQe(e,t){var n=t.dx||0,r=(t.dy||0)+yz(t),i=ak(t),a=i.x1,o=i.y1,s=t.angle||0,u;e("text-anchor",pQe[t.align]||"start"),s?(u=Np(a,o)+" "+lz(s),(n||r)&&(u+=" "+Np(n,r))):u=Np(a+n,o+r),e("transform",u)}function bz(e,t,n){var r=dl.height(t),i=t.align,a=ak(t),o=a.x1,s=a.y1,u=t.dx||0,l=(t.dy||0)+yz(t)-Math.round(.8*r),c=ox(t),f;if(ut(c)?(r+=_d(t)*(c.length-1),f=c.reduce((d,h)=>Math.max(d,dl.width(t,h)),0)):f=dl.width(t,c),i==="center"?u-=f/2:i==="right"&&(u-=f),e.set(u+=o,l+=s,u+f,l+r),t.angle&&!n)e.rotate(t.angle*yd,o,s);else if(n===2)return e.rotatedPoints(t.angle*yd,o,s);return e}function mQe(e,t,n){ou(t,r=>{var i=r.opacity==null?1:r.opacity,a,o,s,u,l,c,f;if(!(n&&!n.intersects(r.bounds)||i===0||r.fontSize<=0||r.text==null||r.text.length===0)){if(e.font=ik(r),e.textAlign=r.align||"left",a=ak(r),o=a.x1,s=a.y1,r.angle&&(e.save(),e.translate(o,s),e.rotate(r.angle*yd),o=s=0),o+=r.dx||0,s+=(r.dy||0)+yz(r),c=ox(r),Bv(e,r),ut(c))for(l=_d(r),u=0;u<c.length;++u)f=Sd(r,c[u]),r.fill&&JA(e,r,i)&&e.fillText(f,o,s),r.stroke&&zv(e,r,i)&&e.strokeText(f,o,s),s+=l;else f=Sd(r,c),r.fill&&JA(e,r,i)&&e.fillText(f,o,s),r.stroke&&zv(e,r,i)&&e.strokeText(f,o,s);r.angle&&e.restore()}})}function vQe(e,t,n,r,i,a){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var o=ak(t),s=o.x1,u=o.y1,l=bz(ux,t,1),c=-t.angle*yd,f=Math.cos(c),d=Math.sin(c),h=f*i-d*a+(s-f*s+d*u),p=d*i+f*a+(u-d*s-f*u);return l.contains(h,p)}function yQe(e,t){const n=bz(ux,e,2);return Lv(t,n[0],n[1],n[2],n[3])||Lv(t,n[0],n[1],n[4],n[5])||Lv(t,n[4],n[5],n[6],n[7])||Lv(t,n[2],n[3],n[6],n[7])}var bQe={type:"text",tag:"text",nested:!1,attr:gQe,bound:bz,draw:mQe,pick:ek(vQe),isect:yQe},xQe=fz("trail",yJe,DJe),Uo={arc:OJe,area:RJe,group:HJe,image:YJe,line:ZJe,path:eQe,rect:rQe,rule:uQe,shape:lQe,symbol:cQe,text:bQe,trail:xQe};function xz(e,t,n){var r=Uo[e.mark.marktype],i=t||r.bound;return r.nested&&(e=e.mark),i(e.bounds||(e.bounds=new li),e,n)}var xue={mark:null};function wue(e,t,n){var r=Uo[e.marktype],i=r.bound,a=e.items,o=a&&a.length,s,u,l,c;if(r.nested)return o?l=a[0]:(xue.mark=e,l=xue),c=xz(l,i,n),t=t&&t.union(c)||c,t;if(t=t||e.bounds&&e.bounds.clear()||new li,o)for(s=0,u=a.length;s<u;++s)t.union(xz(a[s],i,n));return e.bounds=t}const wQe=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function _ue(e,t){return JSON.stringify(e,wQe,t)}function Sue(e){const t=typeof e=="string"?JSON.parse(e):e;return Eue(t)}function Eue(e){var t=e.marktype,n=e.items,r,i,a;if(n)for(i=0,a=n.length;i<a;++i)r=t?"mark":"group",n[i][r]=e,n[i].zindex&&(n[i][r].zdirty=!0),(t||r)==="group"&&Eue(n[i]);return t&&wue(e),e}function wz(e){arguments.length?this.root=Sue(e):(this.root=Cue({marktype:"group",name:"root",role:"frame"}),this.root.items=[new HA(this.root)])}wz.prototype={toJSON(e){return _ue(this.root,e||0)},mark(e,t,n){t=t||this.root.items[0];const r=Cue(e,t);return t.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}};function Cue(e,t){const n={bounds:new li,clip:!!e.clip,group:t,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return e.aria!=null&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function Ed(e,t,n){return!e&&typeof document!="undefined"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function _z(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function lo(e,t,n,r){var i=e.childNodes[t],a;return(!i||i.tagName.toLowerCase()!==n.toLowerCase())&&(a=i||null,i=Ed(e.ownerDocument,n,r),e.insertBefore(i,a)),i}function su(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function Aue(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function ok(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function _Qe(e,t,n,r){var i=e&&e.mark,a,o;if(i&&(a=Uo[i.marktype]).tip){for(o=ok(t,n),o[0]-=r[0],o[1]-=r[1];e=e.mark.group;)o[0]-=e.x||0,o[1]-=e.y||0;e=a.tip(i.items,o)}return e}function Cd(e,t){this._active=null,this._handlers={},this._loader=e||ZC(),this._tooltip=t||SQe}function SQe(e,t,n,r){e.element().setAttribute("title",r||"")}Cd.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let r=e?e.length:0;--r>=0;)if(e[r].type===t&&(!n||e[r].handler===n))return r;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const r in t)n.push(...t[r]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then(r=>{const i=new MouseEvent(e.type,e),a=Ed(null,"a");for(const o in r)a.setAttribute(o,r[o]);a.dispatchEvent(i)}).catch(()=>{})},handleTooltip(e,t,n){if(t&&t.tooltip!=null){t=_Qe(t,e,this.canvas(),this._origin);const r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),r=this._origin,i=e.bounds,a=i.width(),o=i.height();let s=i.x1+r[0]+n.left,u=i.y1+r[1]+n.top;for(;e.mark&&(e=e.mark.group);)s+=e.x||0,u+=e.y||0;return{x:s,y:u,width:a,height:o,left:s,top:u,right:s+a,bottom:u+o}}};function pl(e){this._el=null,this._bgcolor=null,this._loader=new ZB(e)}pl.prototype={initialize(e,t,n,r,i){return this._el=e,this.resize(t,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return arguments.length===0?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,r){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(e){const t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){const t=this.render(e);return this._ready?this._ready.then(()=>t):Promise.resolve(t)},_load(e,t){var n=this,r=n._loader[e](t);if(!n._ready){const i=n._call;n._ready=n._loader.ready().then(a=>{a&&i(),n._ready=null})}return r},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const EQe="keydown",CQe="keypress",AQe="keyup",kue="dragenter",sk="dragleave",Tue="dragover",Sz="mousedown",kQe="mouseup",uk="mousemove",lx="mouseout",Oue="mouseover",lk="click",TQe="dblclick",OQe="wheel",Iue="mousewheel",ck="touchstart",fk="touchmove",dk="touchend",IQe=[EQe,CQe,AQe,kue,sk,Tue,Sz,kQe,uk,lx,Oue,lk,TQe,OQe,Iue,ck,fk,dk],Ez=uk,cx=lx,Cz=lk;function fx(e,t){Cd.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}const NQe=e=>e===ck||e===fk||e===dk?[ck,fk,dk]:[e];function Nue(e,t){NQe(t).forEach(n=>DQe(e,n))}function DQe(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?r=>e[t](r):r=>e.fire(t,r)))}function Due(e,t,n){return function(r){const i=this._active,a=this.pickEvent(r);a===i?this.fire(e,r):((!i||!i.exit)&&this.fire(n,r),this._active=a,this.fire(t,r),this.fire(e,r))}}function Rue(e){return function(t){this.fire(e,t),this._active=null}}$e(fx,Cd,{initialize(e,t,n){return this._canvas=e&&_z(e,"canvas"),[lk,Sz,uk,lx,sk].forEach(r=>Nue(this,r)),Cd.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:IQe,DOMMouseScroll(e){this.fire(Iue,e)},mousemove:Due(uk,Oue,lx),dragover:Due(Tue,kue,sk),mouseout:Rue(lx),dragleave:Rue(sk),mousedown(e){this._down=this._active,this.fire(Sz,e)},click(e){this._down===this._active&&(this.fire(lk,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(ck,e,!0)},touchmove(e){this.fire(fk,e,!0)},touchend(e){this.fire(dk,e,!0),this._touch=null},fire(e,t,n){const r=n?this._touch:this._active,i=this._handlers[e];if(t.vegaType=e,e===Cz&&r&&r.href?this.handleHref(t,r,r.href):(e===Ez||e===cx)&&this.handleTooltip(t,r,e!==cx),i)for(let a=0,o=i.length;a<o;++a)i[a].handler.call(this._obj,t,r)},on(e,t){const n=this.eventName(e),r=this._handlers;return this._handlerIndex(r[n],e,t)<0&&(Nue(this,e),(r[n]||(r[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&r.splice(i,1),this},pickEvent(e){const t=ok(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,r,i){const a=this.context();return Uo[e.marktype].pick.call(this,a,e,t,n,r,i)}});function RQe(){return typeof window!="undefined"&&window.devicePixelRatio||1}var FQe=RQe();function MQe(e,t,n,r,i,a){const o=typeof HTMLElement!="undefined"&&e instanceof HTMLElement&&e.parentNode!=null,s=e.getContext("2d"),u=o?FQe:i;e.width=t*u,e.height=n*u;for(const l in a)s[l]=a[l];return o&&u!==1&&(e.style.width=t+"px",e.style.height=n+"px"),s.pixelRatio=u,s.setTransform(u,0,0,u,u*r[0],u*r[1]),e}function hk(e){pl.call(this,e),this._options={},this._redraw=!1,this._dirty=new li,this._tempb=new li}const Fue=pl.prototype,PQe=(e,t,n)=>new li().set(0,0,t,n).translate(-e[0],-e[1]);function $Qe(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}$e(hk,pl,{initialize(e,t,n,r,i,a){return this._options=a||{},this._canvas=this._options.externalContext?null:Cv(1,1,this._options.type),e&&this._canvas&&(su(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),Fue.initialize.call(this,e,t,n,r,i)},resize(e,t,n,r){if(Fue.resize.call(this,e,t,n,r),this._canvas)MQe(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const i=this._options.externalContext;i||Se("CanvasRenderer is missing a valid canvas or context"),i.scale(this._scale,this._scale),i.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){const t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){const t=this.context(),n=this._origin,r=this._width,i=this._height,a=this._dirty,o=PQe(n,r,i);t.save();const s=this._redraw||a.empty()?(this._redraw=!1,o.expand(1)):$Qe(t,o.intersect(a),n);return this.clear(-n[0],-n[1],r,i),this.draw(t,e,s),t.restore(),a.clear(),this},draw(e,t,n){const r=Uo[t.marktype];t.clip&&FJe(e,t),r.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,r){const i=this._options,a=this.context();i.type!=="pdf"&&!i.externalContext&&a.clearRect(e,t,n,r),this._bgcolor!=null&&(a.fillStyle=this._bgcolor,a.fillRect(e,t,n,r))}});function Az(e,t){Cd.call(this,e,t);const n=this;n._hrefHandler=kz(n,(r,i)=>{i&&i.href&&n.handleHref(r,i,i.href)}),n._tooltipHandler=kz(n,(r,i)=>{n.handleTooltip(r,i,r.type!==cx)})}const kz=(e,t)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)};$e(Az,Cd,{initialize(e,t,n){let r=this._svg;return r&&(r.removeEventListener(Cz,this._hrefHandler),r.removeEventListener(Ez,this._tooltipHandler),r.removeEventListener(cx,this._tooltipHandler)),this._svg=r=e&&_z(e,"svg"),r&&(r.addEventListener(Cz,this._hrefHandler),r.addEventListener(Ez,this._tooltipHandler),r.addEventListener(cx,this._tooltipHandler)),Cd.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),r=this._handlers;if(this._handlerIndex(r[n],e,t)<0){const a={type:e,handler:t,listener:kz(this,t)};(r[n]||(r[n]=[])).push(a),this._svg&&this._svg.addEventListener(n,a.listener)}return this},off(e,t){const n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const Mue="aria-hidden",Tz="aria-label",Oz="role",Iz="aria-roledescription",Pue="graphics-object",Nz="graphics-symbol",$ue=(e,t,n)=>({[Oz]:e,[Iz]:t,[Tz]:n||void 0}),LQe=nu(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),Lue={axis:{desc:"axis",caption:jQe},legend:{desc:"legend",caption:UQe},"title-text":{desc:"title",caption:e=>`Title text '${Uue(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${Uue(e)}'`}},Bue={ariaRole:Oz,ariaRoleDescription:Iz,description:Tz};function zue(e,t){const n=t.aria===!1;if(e(Mue,n||void 0),n||t.description==null)for(const r in Bue)e(Bue[r],void 0);else{const r=t.mark.marktype;e(Tz,t.description),e(Oz,t.ariaRole||(r==="group"?Pue:Nz)),e(Iz,t.ariaRoleDescription||`${r} mark`)}}function jue(e){return e.aria===!1?{[Mue]:!0}:LQe[e.role]?null:Lue[e.role]?zQe(e,Lue[e.role]):BQe(e)}function BQe(e){const t=e.marktype,n=t==="group"||t==="text"||e.items.some(r=>r.description!=null&&r.aria!==!1);return $ue(n?Pue:Nz,`${t} mark container`,e.description)}function zQe(e,t){try{const n=e.items[0],r=t.caption||(()=>"");return $ue(t.role||Nz,t.desc,n.description||r(n))}catch(n){return null}}function Uue(e){return wt(e.text).join(" ")}function jQe(e){const t=e.datum,n=e.orient,r=t.title?Wue(e):null,i=e.context,a=i.scales[t.scale].value,o=i.dataflow.locale(),s=a.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(r?` titled '${r}'`:"")+` for a ${Fv(s)?"discrete":s} scale with ${Bse(o,a,e)}`}function UQe(e){const t=e.datum,n=t.title?Wue(e):null,r=`${t.type||""} legend`.trim(),i=t.scales,a=Object.keys(i),o=e.context,s=o.scales[i[a[0]]].value,u=o.dataflow.locale();return VQe(r)+(n?` titled '${n}'`:"")+` for ${WQe(a)} with ${Bse(u,s,e)}`}function Wue(e){try{return wt(sn(e.items).items[0].text).join(" ")}catch(t){return null}}function WQe(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+sn(e)}function VQe(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const Vue=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),qQe=e=>Vue(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function Dz(){let e="",t="",n="";const r=[],i=()=>t=n="",a=u=>{t&&(e+=`${t}>${n}`,i()),r.push(u)},o=(u,l)=>(l!=null&&(t+=` ${u}="${qQe(l)}"`),s),s={open(u,...l){a(u),t="<"+u;for(const c of l)for(const f in c)o(f,c[f]);return s},close(){const u=r.pop();return t?e+=t+(n?`>${n}</${u}>`:"/>"):e+=`</${u}>`,i(),s},attr:o,text:u=>(n+=Vue(u),s),toString:()=>e};return s}const que=e=>Hue(Dz(),e)+"";function Hue(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,r=n.length;for(let i=0;i<r;++i)e.attr(n[i].name,n[i].value)}if(t.hasChildNodes()){const n=t.childNodes,r=n.length;for(let i=0;i<r;i++){const a=n[i];a.nodeType===3?e.text(a.nodeValue):Hue(e,a)}}return e.close()}const pk={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},Gue={fill:"none","stroke-miterlimit":10},dx=0,Kue="http://www.w3.org/2000/xmlns/",ci=ax.xmlns;function Rz(e){pl.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const Fz=pl.prototype;$e(Rz,pl,{initialize(e,t,n,r,i){return this._defs={},this._clearDefs(),e&&(this._svg=lo(e,0,"svg",ci),this._svg.setAttributeNS(Kue,"xmlns",ci),this._svg.setAttributeNS(Kue,"xmlns:xlink",ax["xmlns:xlink"]),this._svg.setAttribute("version",ax.version),this._svg.setAttribute("class","marks"),su(e,1),this._root=lo(this._svg,dx,"g",ci),Ad(this._root,Gue),su(this._svg,dx+1)),this.background(this._bgcolor),Fz.initialize.call(this,e,t,n,r,i)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),Fz.background.apply(this,arguments)},resize(e,t,n,r){return Fz.resize.call(this,e,t,n,r),this._svg&&(Ad(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=lo(e,dx,"rect",ci),Ad(n,{width:this._width,height:this._height,fill:t}));const r=que(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),r},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),su(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,r,i,a,o,s,u;for(o=0,s=e.length;o<s;++o)if(n=e[o],r=n.mark,r.marktype!==i&&(i=r.marktype,a=Uo[i]),r.zdirty&&r.dirty!==t&&(this._dirtyAll=!1,Xue(n,t),r.items.forEach(l=>{l.dirty=t})),!r.zdirty){if(n.exit){a.nested&&r.items.length?(u=r.items[0],u._svg&&this._update(a,u._svg,u)):n._svg&&(u=n._svg.parentNode,u&&u.removeChild(n._svg)),n._svg=null;continue}n=a.nested?r.items[0]:n,n._update!==t&&(!n._svg||!n._svg.ownerSVGElement?(this._dirtyAll=!1,Xue(n,t)):this._update(a,n._svg,n),n._update=t)}return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;const r=this._svg,i=Uo[t.marktype],a=t.interactive===!1?"none":null,o=i.tag==="g";let s=null,u=0;const l=Yue(t,e,n,"g",r);l.setAttribute("class",Aue(t));const c=jue(t);for(const d in c)Na(l,d,c[d]);o||Na(l,"pointer-events",a),Na(l,"clip-path",t.clip?YB(this,t,t.group):null);const f=d=>{const h=this.isDirty(d),p=Yue(d,l,s,i.tag,r);h&&(this._update(i,p,d),o&&KQe(this,p,d)),s=p,++u};return i.nested?t.items.length&&f(t.items[0]):ou(t,f),su(l,u),l},_update(e,t,n){Oc=t,ra=t.__values__,zue(hx,n),e.attr(hx,n,this);const r=YQe[e.type];r&&r.call(this,e,t,n),Oc&&this.style(Oc,n)},style(e,t){if(t!=null)for(const n in pk){let r=n==="font"?sx(t):t[n];if(r===ra[n])continue;const i=pk[n];r==null?e.removeAttribute(i):(VB(r)&&(r=jse(r,this._defs.gradient,Zue())),e.setAttribute(i,r+"")),ra[n]=r}},defs(){const e=this._svg,t=this._defs;let n=t.el,r=0;for(const i in t.gradient)n||(t.el=n=lo(e,dx+1,"defs",ci)),r=HQe(n,t.gradient[i],r);for(const i in t.clipping)n||(t.el=n=lo(e,dx+1,"defs",ci)),r=GQe(n,t.clipping[i],r);n&&(r===0?(e.removeChild(n),t.el=null):su(n,r))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});function Xue(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function HQe(e,t,n){let r,i,a;if(t.gradient==="radial"){let o=lo(e,n++,"pattern",ci);Ad(o,{id:UA+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),o=lo(o,0,"rect",ci),Ad(o,{width:1,height:1,fill:`url(${Zue()}#${t.id})`}),e=lo(e,n++,"radialGradient",ci),Ad(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=lo(e,n++,"linearGradient",ci),Ad(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,i=t.stops.length;r<i;++r)a=lo(e,r,"stop",ci),a.setAttribute("offset",t.stops[r].offset),a.setAttribute("stop-color",t.stops[r].color);return su(e,r),n}function GQe(e,t,n){let r;return e=lo(e,n,"clipPath",ci),e.setAttribute("id",t.id),t.path?(r=lo(e,0,"path",ci),r.setAttribute("d",t.path)):(r=lo(e,0,"rect",ci),Ad(r,{x:0,y:0,width:t.width,height:t.height})),su(e,1),n+1}function KQe(e,t,n){t=t.lastChild.previousSibling;let r,i=0;ou(n,a=>{r=e.mark(t,a,r),++i}),su(t,1+i)}function Yue(e,t,n,r,i){let a=e._svg,o;if(!a&&(o=t.ownerDocument,a=Ed(o,r,ci),e._svg=a,e.mark&&(a.__data__=e,a.__values__={fill:"default"},r==="g"))){const s=Ed(o,"path",ci);a.appendChild(s),s.__data__=e;const u=Ed(o,"g",ci);a.appendChild(u),u.__data__=e;const l=Ed(o,"path",ci);a.appendChild(l),l.__data__=e,l.__values__={fill:"default"}}return(a.ownerSVGElement!==i||XQe(a,n))&&t.insertBefore(a,n?n.nextSibling:t.firstChild),a}function XQe(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}let Oc=null,ra=null;const YQe={group(e,t,n){const r=Oc=t.childNodes[2];ra=r.__values__,e.foreground(hx,n,this),ra=t.__values__,Oc=t.childNodes[1],e.content(hx,n,this);const i=Oc=t.childNodes[0];e.background(hx,n,this);const a=n.mark.interactive===!1?"none":null;if(a!==ra.events&&(Na(r,"pointer-events",a),Na(i,"pointer-events",a),ra.events=a),n.strokeForeground&&n.stroke){const o=n.fill;Na(r,"display",null),this.style(i,n),Na(i,"stroke",null),o&&(n.fill=null),ra=r.__values__,this.style(r,n),o&&(n.fill=o),Oc=null}else Na(r,"display","none")},image(e,t,n){n.smooth===!1?(Mz(t,"image-rendering","optimizeSpeed"),Mz(t,"image-rendering","pixelated")):Mz(t,"image-rendering",null)},text(e,t,n){const r=ox(n);let i,a,o,s;ut(r)?(a=r.map(u=>Sd(n,u)),i=a.join(`
`),i!==ra.text&&(su(t,0),o=t.ownerDocument,s=_d(n),a.forEach((u,l)=>{const c=Ed(o,"tspan",ci);c.__data__=n,c.textContent=u,l&&(c.setAttribute("x",0),c.setAttribute("dy",s)),t.appendChild(c)}),ra.text=i)):(a=Sd(n,r),a!==ra.text&&(t.textContent=a,ra.text=a)),Na(t,"font-family",sx(n)),Na(t,"font-size",hl(n)+"px"),Na(t,"font-style",n.fontStyle),Na(t,"font-variant",n.fontVariant),Na(t,"font-weight",n.fontWeight)}};function hx(e,t,n){t!==ra[e]&&(n?ZQe(Oc,e,t,n):Na(Oc,e,t),ra[e]=t)}function Mz(e,t,n){n!==ra[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),ra[t]=n)}function Ad(e,t){for(const n in t)Na(e,n,t[n])}function Na(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function ZQe(e,t,n,r){n!=null?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}function Zue(){let e;return typeof window=="undefined"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function Pz(e){pl.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}$e(Pz,pl,{svg(){return this._text},_render(e){const t=Dz();t.open("svg",Rt({},ax,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&n!=="transparent"&&n!=="none"&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",Gue,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=Uo[t.marktype],r=n.tag,i=[zue,n.attr];e.open("g",{class:Aue(t),"clip-path":t.clip?YB(this,t,t.group):null},jue(t),{"pointer-events":r!=="g"&&t.interactive===!1?"none":null});const a=o=>{const s=this.href(o);if(s&&e.open("a",s),e.open(r,this.attr(t,o,i,r!=="g"?r:null)),r==="text"){const u=ox(o);if(ut(u)){const l={x:0,dy:_d(o)};for(let c=0;c<u.length;++c)e.open("tspan",c?l:null).text(Sd(o,u[c])).close()}else e.text(Sd(o,u))}else if(r==="g"){const u=o.strokeForeground,l=o.fill,c=o.stroke;u&&c&&(o.stroke=null),e.open("path",this.attr(t,o,n.background,"bgrect")).close(),e.open("g",this.attr(t,o,n.content)),ou(o,f=>this.mark(e,f)),e.close(),u&&c?(l&&(o.fill=null),o.stroke=c,e.open("path",this.attr(t,o,n.foreground,"bgrect")).close(),l&&(o.fill=l)):e.open("path",this.attr(t,o,n.foreground,"bgfore")).close()}e.close(),s&&e.close()};return n.nested?t.items&&t.items.length&&a(t.items[0]):ou(t,a),e.close()},href(e){const t=e.href;let n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then(r=>{r["xlink:href"]=r.href,r.href=null,(this._hrefs||(this._hrefs={}))[t]=r})}return null},attr(e,t,n,r){const i={},a=(o,s,u,l)=>{i[l||o]=s};return Array.isArray(n)?n.forEach(o=>o(a,t,this)):n(a,t,this),r&&JQe(i,t,e,r,this._defs),i},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(Object.keys(t).length+Object.keys(n).length!==0){e.open("defs");for(const i in t){const a=t[i],o=a.stops;a.gradient==="radial"?(e.open("pattern",{id:UA+i,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+i+")"}).close(),e.close(),e.open("radialGradient",{id:i,fx:a.x1,fy:a.y1,fr:a.r1,cx:a.x2,cy:a.y2,r:a.r2})):e.open("linearGradient",{id:i,x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2});for(let s=0;s<o.length;++s)e.open("stop",{offset:o[s].offset,"stop-color":o[s].color}).close();e.close()}for(const i in n){const a=n[i];e.open("clipPath",{id:i}),a.path?e.open("path",{d:a.path}).close():e.open("rect",{x:0,y:0,width:a.width,height:a.height}).close(),e.close()}e.close()}}});function JQe(e,t,n,r,i){if(t==null||(r==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),r==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;r==="image"&&t.smooth===!1&&(e.style="image-rendering: optimizeSpeed; image-rendering: pixelated;"),r==="text"&&(e["font-family"]=sx(t),e["font-size"]=hl(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const a in pk){let o=t[a];const s=pk[a];o==="transparent"&&(s==="fill"||s==="stroke")||o!=null&&(VB(o)&&(o=jse(o,i.gradient,"")),e[s]=o)}return e}const Jue="canvas",Que="png",ele="svg",tle="none",kd={Canvas:Jue,PNG:Que,SVG:ele,None:tle},jv={};jv[Jue]=jv[Que]={renderer:hk,headless:hk,handler:fx},jv[ele]={renderer:Rz,headless:Pz,handler:Az},jv[tle]={};function gk(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(jv[e]=t,this):jv[e]}function nle(e,t,n){const r=[],i=new li().union(t),a=e.marktype;return a?rle(e,i,n,r):a==="group"?ile(e,i,n,r):Se("Intersect scene must be mark node or group item.")}function rle(e,t,n,r){if(QQe(e,t,n)){const i=e.items,a=e.marktype,o=i.length;let s=0;if(a==="group")for(;s<o;++s)ile(i[s],t,n,r);else for(const u=Uo[a].isect;s<o;++s){const l=i[s];ale(l,t,u)&&r.push(l)}}return r}function QQe(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function ile(e,t,n,r){n&&n(e.mark)&&ale(e,t,Uo.group.isect)&&r.push(e);const i=e.items,a=i&&i.length;if(a){const o=e.x||0,s=e.y||0;t.translate(-o,-s);for(let u=0;u<a;++u)rle(i[u],t,n,r);t.translate(o,s)}return r}function ale(e,t,n){const r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}const $z=new li;function ole(e){const t=e.clip;if(Lt(t))t(nx($z.clear()));else if(t)$z.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect($z)}const eet=1e-9;function Lz(e,t,n){return e===t?!0:n==="path"?sle(e,t):e instanceof Date&&t instanceof Date?+e==+t:td(e)&&td(t)?Math.abs(e-t)<=eet:!e||!t||!Nt(e)&&!Nt(t)?e==t:tet(e,t)}function sle(e,t){return Lz(Mv(e),Mv(t))}function tet(e,t){var n=Object.keys(e),r=Object.keys(t),i,a;if(n.length!==r.length)return!1;for(n.sort(),r.sort(),a=n.length-1;a>=0;a--)if(n[a]!=r[a])return!1;for(a=n.length-1;a>=0;a--)if(i=n[a],!Lz(e[i],t[i],i))return!1;return typeof e==typeof t}function net(){Jse(),DZe()}const Uv="top",uu="left",lu="right",Td="bottom",ret="top-left",iet="top-right",aet="bottom-left",oet="bottom-right",Bz="start",zz="middle",Da="end",set="x",uet="y",mk="group",jz="axis",Uz="title",cet="frame",fet="scope",Wz="legend",ule="row-header",lle="row-footer",cle="row-title",fle="column-header",dle="column-footer",hle="column-title",det="padding",het="symbol",ple="fit",pet="fit-x",get="fit-y",met="pad",Vz="none",vk="all",qz="each",Hz="flush",Od="column",Id="row";function gle(e){ve.call(this,null,e)}$e(gle,ve,{transform(e,t){const n=t.dataflow,r=e.mark,i=r.marktype,a=Uo[i],o=a.bound;let s=r.bounds,u;if(a.nested)r.items.length&&n.dirty(r.items[0]),s=yk(r,o),r.items.forEach(l=>{l.bounds.clear().union(s)});else if(i===mk||e.modified())switch(t.visit(t.MOD,l=>n.dirty(l)),s.clear(),r.items.forEach(l=>s.union(yk(l,o))),r.role){case jz:case Wz:case Uz:t.reflow()}else u=t.changed(t.REM),t.visit(t.ADD,l=>{s.union(yk(l,o))}),t.visit(t.MOD,l=>{u=u||s.alignsWith(l.bounds),n.dirty(l),s.union(yk(l,o))}),u&&(s.clear(),r.items.forEach(l=>s.union(l.bounds)));return ole(r),t.modifies("bounds")}});function yk(e,t,n){return t(e.bounds.clear(),e,n)}const mle=":vega_identifier:";function Gz(e){ve.call(this,0,e)}Gz.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},$e(Gz,ve,{transform(e,t){const n=vet(t.dataflow),r=e.as;let i=n.value;return t.visit(t.ADD,a=>a[r]=a[r]||++i),n.set(this.value=i),t}});function vet(e){return e._signals[mle]||(e._signals[mle]=e.add(0))}function vle(e){ve.call(this,null,e)}$e(vle,ve,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,yet(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const r=n.marktype===mk?HA:qA;return t.visit(t.ADD,i=>r.call(i,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});function yet(e){const t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function yle(e){ve.call(this,null,e)}const ble={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((r,i)=>!i||!xle(n.bounds,r.bounds,t)?(n=r,1):r.opacity=0)}},xle=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),wle=(e,t)=>{for(var n=1,r=e.length,i=e[0].bounds,a;n<r;i=a,++n)if(xle(i,a=e[n].bounds,t))return!0},bet=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},xet=(e,t,n)=>{var r=e.range(),i=new li;return t===Uv||t===Td?i.set(r[0],-1/0,r[1],1/0):i.set(-1/0,r[0],1/0,r[1]),i.expand(n||1),a=>i.encloses(a.bounds)},_le=e=>(e.forEach(t=>t.opacity=1),e),Sle=(e,t)=>e.reflow(t.modified()).modifies("opacity");$e(yle,ve,{transform(e,t){const n=ble[e.method]||ble.parity,r=e.separation||0;let i=t.materialize(t.SOURCE).source,a,o;if(!i||!i.length)return;if(!e.method)return e.modified("method")&&(_le(i),t=Sle(t,e)),t;if(i=i.filter(bet),!i.length)return;if(e.sort&&(i=i.slice().sort(e.sort)),a=_le(i),t=Sle(t,e),a.length>=3&&wle(a,r)){do a=n(a,r);while(a.length>=3&&wle(a,r));a.length<3&&!sn(i).opacity&&(a.length>1&&(sn(a).opacity=0),sn(i).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(o=xet(e.boundScale,e.boundOrient,+e.boundTolerance),i.forEach(u=>{o(u)||(u.opacity=0)}));const s=a[0].mark.bounds.clear();return i.forEach(u=>{u.opacity&&s.union(u.bounds)}),t}});function Ele(e){ve.call(this,null,e)}$e(Ele,ve,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,r=>n.dirty(r)),t.fields&&t.fields.zindex){const r=t.source&&t.source[0];r&&(r.mark.zdirty=!0)}}});const ia=new li;function Wv(e,t,n){return e[t]===n?0:(e[t]=n,1)}function wet(e){var t=e.items[0].orient;return t===uu||t===lu}function _et(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function Eet(e,t,n,r){var i=t.items[0],a=i.datum,o=i.translate!=null?i.translate:.5,s=i.orient,u=_et(a),l=i.range,c=i.offset,f=i.position,d=i.minExtent,h=i.maxExtent,p=a.title&&i.items[u[2]].items[0],g=i.titlePadding,m=i.bounds,v=p&&vz(p),y=0,b=0,x,w;switch(ia.clear().union(m),m.clear(),(x=u[0])>-1&&m.union(i.items[x].bounds),(x=u[1])>-1&&m.union(i.items[x].bounds),s){case Uv:y=f||0,b=-c,w=Math.max(d,Math.min(h,-m.y1)),m.add(0,-w).add(l,0),p&&bk(e,p,w,g,v,0,-1,m);break;case uu:y=-c,b=f||0,w=Math.max(d,Math.min(h,-m.x1)),m.add(-w,0).add(0,l),p&&bk(e,p,w,g,v,1,-1,m);break;case lu:y=n+c,b=f||0,w=Math.max(d,Math.min(h,m.x2)),m.add(0,0).add(w,l),p&&bk(e,p,w,g,v,1,1,m);break;case Td:y=f||0,b=r+c,w=Math.max(d,Math.min(h,m.y2)),m.add(0,0).add(l,w),p&&bk(e,p,w,g,0,0,1,m);break;default:y=i.x,b=i.y}return Tc(m.translate(y,b),i),Wv(i,"x",y+o)|Wv(i,"y",b+o)&&(i.bounds=ia,e.dirty(i),i.bounds=m,e.dirty(i)),i.mark.bounds.clear().union(m)}function bk(e,t,n,r,i,a,o,s){const u=t.bounds;if(t.auto){const l=o*(n+i+r);let c=0,f=0;e.dirty(t),a?c=(t.x||0)-(t.x=l):f=(t.y||0)-(t.y=l),t.mark.bounds.clear().union(u.translate(-c,-f)),e.dirty(t)}s.union(u)}const Cle=(e,t)=>Math.floor(Math.min(e,t)),Ale=(e,t)=>Math.ceil(Math.max(e,t));function Cet(e){var t=e.items,n=t.length,r=0,i,a;const o={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;r<n;++r)if(i=t[r],a=i.items,i.marktype===mk)switch(i.role){case jz:case Wz:case Uz:break;case ule:o.rowheaders.push(...a);break;case lle:o.rowfooters.push(...a);break;case fle:o.colheaders.push(...a);break;case dle:o.colfooters.push(...a);break;case cle:o.rowtitle=a[0];break;case hle:o.coltitle=a[0];break;default:o.marks.push(...a)}return o}function Aet(e){return new li().set(0,0,e.width||0,e.height||0)}function ket(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function lr(e,t,n){const r=Nt(e)?e[t]:e;return r??(n!==void 0?n:0)}function kle(e){return e<0?Math.ceil(-e):0}function Tle(e,t,n){var r=!n.nodirty,i=n.bounds===Hz?Aet:ket,a=ia.set(0,0,0,0),o=lr(n.align,Od),s=lr(n.align,Id),u=lr(n.padding,Od),l=lr(n.padding,Id),c=n.columns||t.length,f=c<=0?1:Math.ceil(t.length/c),d=t.length,h=Array(d),p=Array(c),g=0,m=Array(d),v=Array(f),y=0,b=Array(d),x=Array(d),w=Array(d),S,C,_,E,A,k,T,I,N,O,D;for(C=0;C<c;++C)p[C]=0;for(C=0;C<f;++C)v[C]=0;for(C=0;C<d;++C)k=t[C],A=w[C]=i(k),k.x=k.x||0,b[C]=0,k.y=k.y||0,x[C]=0,_=C%c,E=~~(C/c),g=Math.max(g,T=Math.ceil(A.x2)),y=Math.max(y,I=Math.ceil(A.y2)),p[_]=Math.max(p[_],T),v[E]=Math.max(v[E],I),h[C]=u+kle(A.x1),m[C]=l+kle(A.y1),r&&e.dirty(t[C]);for(C=0;C<d;++C)C%c==0&&(h[C]=0),C<c&&(m[C]=0);if(o===qz)for(_=1;_<c;++_){for(D=0,C=_;C<d;C+=c)D<h[C]&&(D=h[C]);for(C=_;C<d;C+=c)h[C]=D+p[_-1]}else if(o===vk){for(D=0,C=0;C<d;++C)C%c&&D<h[C]&&(D=h[C]);for(C=0;C<d;++C)C%c&&(h[C]=D+g)}else for(o=!1,_=1;_<c;++_)for(C=_;C<d;C+=c)h[C]+=p[_-1];if(s===qz)for(E=1;E<f;++E){for(D=0,C=E*c,S=C+c;C<S;++C)D<m[C]&&(D=m[C]);for(C=E*c;C<S;++C)m[C]=D+v[E-1]}else if(s===vk){for(D=0,C=c;C<d;++C)D<m[C]&&(D=m[C]);for(C=c;C<d;++C)m[C]=D+y}else for(s=!1,E=1;E<f;++E)for(C=E*c,S=C+c;C<S;++C)m[C]+=v[E-1];for(N=0,C=0;C<d;++C)N=h[C]+(C%c?N:0),b[C]+=N-t[C].x;for(_=0;_<c;++_)for(O=0,C=_;C<d;C+=c)O+=m[C],x[C]+=O-t[C].y;if(o&&lr(n.center,Od)&&f>1)for(C=0;C<d;++C)A=o===vk?g:p[C%c],N=A-w[C].x2-t[C].x-b[C],N>0&&(b[C]+=N/2);if(s&&lr(n.center,Id)&&c!==1)for(C=0;C<d;++C)A=s===vk?y:v[~~(C/c)],O=A-w[C].y2-t[C].y-x[C],O>0&&(x[C]+=O/2);for(C=0;C<d;++C)a.union(w[C].translate(b[C],x[C]));switch(N=lr(n.anchor,set),O=lr(n.anchor,uet),lr(n.anchor,Od)){case Da:N-=a.width();break;case zz:N-=a.width()/2}switch(lr(n.anchor,Id)){case Da:O-=a.height();break;case zz:O-=a.height()/2}for(N=Math.round(N),O=Math.round(O),a.clear(),C=0;C<d;++C)t[C].mark.bounds.clear();for(C=0;C<d;++C)k=t[C],k.x+=b[C]+=N,k.y+=x[C]+=O,a.union(k.mark.bounds.union(k.bounds.translate(b[C],x[C]))),r&&e.dirty(k);return a}function Tet(e,t,n){var r=Cet(t),i=r.marks,a=n.bounds===Hz?Oet:Iet,o=n.offset,s=n.columns||i.length,u=s<=0?1:Math.ceil(i.length/s),l=u*s,c,f,d,h,p,g,m;const v=Tle(e,i,n);v.empty()&&v.set(0,0,0,0),r.rowheaders&&(g=lr(n.headerBand,Id,null),c=xk(e,r.rowheaders,i,s,u,-lr(o,"rowHeader"),Cle,0,a,"x1",0,s,1,g)),r.colheaders&&(g=lr(n.headerBand,Od,null),f=xk(e,r.colheaders,i,s,s,-lr(o,"columnHeader"),Cle,1,a,"y1",0,1,s,g)),r.rowfooters&&(g=lr(n.footerBand,Id,null),d=xk(e,r.rowfooters,i,s,u,lr(o,"rowFooter"),Ale,0,a,"x2",s-1,s,1,g)),r.colfooters&&(g=lr(n.footerBand,Od,null),h=xk(e,r.colfooters,i,s,s,lr(o,"columnFooter"),Ale,1,a,"y2",l-s,1,s,g)),r.rowtitle&&(p=lr(n.titleAnchor,Id),m=lr(o,"rowTitle"),m=p===Da?d+m:c-m,g=lr(n.titleBand,Id,.5),Ole(e,r.rowtitle,m,0,v,g)),r.coltitle&&(p=lr(n.titleAnchor,Od),m=lr(o,"columnTitle"),m=p===Da?h+m:f-m,g=lr(n.titleBand,Od,.5),Ole(e,r.coltitle,m,1,v,g))}function Oet(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):void 0}function Iet(e,t){return e.bounds[t]}function xk(e,t,n,r,i,a,o,s,u,l,c,f,d,h){var p=n.length,g=0,m=0,v,y,b,x,w,S,C,_,E;if(!p)return g;for(v=c;v<p;v+=f)n[v]&&(g=o(g,u(n[v],l)));if(!t.length)return g;for(t.length>i&&(e.warn("Grid headers exceed limit: "+i),t=t.slice(0,i)),g+=a,y=0,x=t.length;y<x;++y)e.dirty(t[y]),t[y].mark.bounds.clear();for(v=c,y=0,x=t.length;y<x;++y,v+=f){for(S=t[y],w=S.mark.bounds,b=v;b>=0&&(C=n[b])==null;b-=d);s?(_=h==null?C.x:Math.round(C.bounds.x1+h*C.bounds.width()),E=g):(_=g,E=h==null?C.y:Math.round(C.bounds.y1+h*C.bounds.height())),w.union(S.bounds.translate(_-(S.x||0),E-(S.y||0))),S.x=_,S.y=E,e.dirty(S),m=o(m,w[l])}return m}function Ole(e,t,n,r,i,a){if(!!t){e.dirty(t);var o=n,s=n;r?o=Math.round(i.x1+a*i.width()):s=Math.round(i.y1+a*i.height()),t.bounds.translate(o-(t.x||0),s-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=o,t.y=s,e.dirty(t)}}function Net(e,t){const n=e[t]||{};return(r,i)=>n[r]!=null?n[r]:e[r]!=null?e[r]:i}function Det(e,t){let n=-1/0;return e.forEach(r=>{r.offset!=null&&(n=Math.max(n,r.offset))}),n>-1/0?n:t}function Ret(e,t,n,r,i,a,o){const s=Net(n,t),u=Det(e,s("offset",0)),l=s("anchor",Bz),c=l===Da?1:l===zz?.5:0,f={align:qz,bounds:s("bounds",Hz),columns:s("direction")==="vertical"?1:e.length,padding:s("margin",8),center:s("center"),nodirty:!0};switch(t){case uu:f.anchor={x:Math.floor(r.x1)-u,column:Da,y:c*(o||r.height()+2*r.y1),row:l};break;case lu:f.anchor={x:Math.ceil(r.x2)+u,y:c*(o||r.height()+2*r.y1),row:l};break;case Uv:f.anchor={y:Math.floor(i.y1)-u,row:Da,x:c*(a||i.width()+2*i.x1),column:l};break;case Td:f.anchor={y:Math.ceil(i.y2)+u,x:c*(a||i.width()+2*i.x1),column:l};break;case ret:f.anchor={x:u,y:u};break;case iet:f.anchor={x:a-u,y:u,column:Da};break;case aet:f.anchor={x:u,y:o-u,row:Da};break;case oet:f.anchor={x:a-u,y:o-u,column:Da,row:Da};break}return f}function Fet(e,t){var n=t.items[0],r=n.datum,i=n.orient,a=n.bounds,o=n.x,s=n.y,u,l;return n._bounds?n._bounds.clear().union(a):n._bounds=a.clone(),a.clear(),Pet(e,n,n.items[0].items[0]),a=Met(n,a),u=2*n.padding,l=2*n.padding,a.empty()||(u=Math.ceil(a.width()+u),l=Math.ceil(a.height()+l)),r.type===het&&$et(n.items[0].items[0].items[0].items),i!==Vz&&(n.x=o=0,n.y=s=0),n.width=u,n.height=l,Tc(a.set(o,s,o+u,s+l),n),n.mark.bounds.clear().union(a),n}function Met(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}function Pet(e,t,n){var r=t.padding,i=r-n.x,a=r-n.y;if(!t.datum.title)(i||a)&&px(e,n,i,a);else{var o=t.items[1].items[0],s=o.anchor,u=t.titlePadding||0,l=r-o.x,c=r-o.y;switch(o.orient){case uu:i+=Math.ceil(o.bounds.width())+u;break;case lu:case Td:break;default:a+=o.bounds.height()+u}switch((i||a)&&px(e,n,i,a),o.orient){case uu:c+=Vv(t,n,o,s,1,1);break;case lu:l+=Vv(t,n,o,Da,0,0)+u,c+=Vv(t,n,o,s,1,1);break;case Td:l+=Vv(t,n,o,s,0,0),c+=Vv(t,n,o,Da,-1,0,1)+u;break;default:l+=Vv(t,n,o,s,0,0)}(l||c)&&px(e,o,l,c),(l=Math.round(o.bounds.x1-r))<0&&(px(e,n,-l,0),px(e,o,-l,0))}}function Vv(e,t,n,r,i,a,o){const s=e.datum.type!=="symbol",u=n.datum.vgrad,l=s&&(a||!u)&&!o?t.items[0]:t,c=l.bounds[i?"y2":"x2"]-e.padding,f=u&&a?c:0,d=u&&a?0:c,h=i<=0?0:vz(n);return Math.round(r===Bz?f:r===Da?d-h:.5*(c-h))}function px(e,t,n,r){t.x+=n,t.y+=r,t.bounds.translate(n,r),t.mark.bounds.translate(n,r),e.dirty(t)}function $et(e){const t=e.reduce((n,r)=>(n[r.column]=Math.max(r.bounds.x2-r.x,n[r.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}function Let(e,t,n,r,i){var a=t.items[0],o=a.frame,s=a.orient,u=a.anchor,l=a.offset,c=a.padding,f=a.items[0].items[0],d=a.items[1]&&a.items[1].items[0],h=s===uu||s===lu?r:n,p=0,g=0,m=0,v=0,y=0,b;if(o!==mk?s===uu?(p=i.y2,h=i.y1):s===lu?(p=i.y1,h=i.y2):(p=i.x1,h=i.x2):s===uu&&(p=r,h=0),b=u===Bz?p:u===Da?h:(p+h)/2,d&&d.text){switch(s){case Uv:case Td:y=f.bounds.height()+c;break;case uu:v=f.bounds.width()+c;break;case lu:v=-f.bounds.width()-c;break}ia.clear().union(d.bounds),ia.translate(v-(d.x||0),y-(d.y||0)),Wv(d,"x",v)|Wv(d,"y",y)&&(e.dirty(d),d.bounds.clear().union(ia),d.mark.bounds.clear().union(ia),e.dirty(d)),ia.clear().union(d.bounds)}else ia.clear();switch(ia.union(f.bounds),s){case Uv:g=b,m=i.y1-ia.height()-l;break;case uu:g=i.x1-ia.width()-l,m=b;break;case lu:g=i.x2+ia.width()+l,m=b;break;case Td:g=b,m=i.y2+l;break;default:g=a.x,m=a.y}return Wv(a,"x",g)|Wv(a,"y",m)&&(ia.translate(g,m),e.dirty(a),a.bounds.clear().union(ia),t.bounds.clear().union(ia),e.dirty(a)),a.bounds}function Ile(e){ve.call(this,null,e)}$e(Ile,ve,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach(r=>{e.layout&&Tet(n,r,e.layout),zet(n,r,e)}),Bet(e.mark.group)?t.reflow():t}});function Bet(e){return e&&e.mark.role!=="legend-entry"}function zet(e,t,n){var r=t.items,i=Math.max(0,t.width||0),a=Math.max(0,t.height||0),o=new li().set(0,0,i,a),s=o.clone(),u=o.clone(),l=[],c,f,d,h,p,g;for(p=0,g=r.length;p<g;++p)switch(f=r[p],f.role){case jz:h=wet(f)?s:u,h.union(Eet(e,f,i,a));break;case Uz:c=f;break;case Wz:l.push(Fet(e,f));break;case cet:case fet:case ule:case lle:case cle:case fle:case dle:case hle:s.union(f.bounds),u.union(f.bounds);break;default:o.union(f.bounds)}if(l.length){const m={};l.forEach(v=>{d=v.orient||lu,d!==Vz&&(m[d]||(m[d]=[])).push(v)});for(const v in m){const y=m[v];Tle(e,y,Ret(y,v,n.legends,s,u,i,a))}l.forEach(v=>{const y=v.bounds;if(y.equals(v._bounds)||(v.bounds=v._bounds,e.dirty(v),v.bounds=y,e.dirty(v)),n.autosize&&n.autosize.type===ple)switch(v.orient){case uu:case lu:o.add(y.x1,0).add(y.x2,0);break;case Uv:case Td:o.add(0,y.y1).add(0,y.y2)}else o.union(y)})}o.union(s).union(u),c&&o.union(Let(e,c,i,a,o)),t.clip&&o.set(0,0,t.width||0,t.height||0),jet(e,t,o,n)}function jet(e,t,n,r){const i=r.autosize||{},a=i.type;if(e._autosize<1||!a)return;let o=e._width,s=e._height,u=Math.max(0,t.width||0),l=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1));const d=Math.max(0,Math.ceil(n.x2-u)),h=Math.max(0,Math.ceil(n.y2-c));if(i.contains===det){const p=e.padding();o-=p.left+p.right,s-=p.top+p.bottom}a===Vz?(l=0,f=0,u=o,c=s):a===ple?(u=Math.max(0,o-l-d),c=Math.max(0,s-f-h)):a===pet?(u=Math.max(0,o-l-d),s=c+f+h):a===get?(o=u+l+d,c=Math.max(0,s-f-h)):a===met&&(o=u+l+d,s=c+f+h),e._resizeView(o,s,u,c,[l,f],i.resize)}var Uet=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",bound:gle,identifier:Gz,mark:vle,overlap:yle,render:Ele,viewlayout:Ile});function Nle(e){ve.call(this,null,e)}$e(Nle,ve,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,a=e.scale,o=e.count==null?e.values?e.values.length:10:e.count,s=jB(a,o,e.minstep),u=e.format||Dse(n,a,s,e.formatSpecifier,e.formatType,!!e.values),l=e.values?Nse(a,e.values,s):UB(a,s);return i&&(r.rem=i),i=l.map((c,f)=>In({index:f/(l.length-1||1),value:c,label:u(c)})),e.extra&&i.length&&i.push(In({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}});function Dle(e){ve.call(this,null,e)}function Wet(){return In({})}function Vet(e){const t=fv().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}$e(Dle,ve,{transform(e,t){var n=t.dataflow,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.item||Wet,a=e.key||lt,o=this.value;return ut(r.encode)&&(r.encode=null),o&&(e.modified("key")||t.modified(a))&&Se("DataJoin does not support modified key function or fields."),o||(t=t.addAll(),this.value=o=Vet(a)),t.visit(t.ADD,s=>{const u=a(s);let l=o.get(u);l?l.exit?(o.empty--,r.add.push(l)):r.mod.push(l):(l=i(s),o.set(u,l),r.add.push(l)),l.datum=s,l.exit=!1}),t.visit(t.MOD,s=>{const u=a(s),l=o.get(u);l&&(l.datum=s,r.mod.push(l))}),t.visit(t.REM,s=>{const u=a(s),l=o.get(u);s===l.datum&&!l.exit&&(r.rem.push(l),l.exit=!0,++o.empty)}),t.changed(t.ADD_MOD)&&r.modifies("datum"),(t.clean()||e.clean&&o.empty>n.cleanThreshold)&&n.runAfter(o.clean),r}});function Rle(e){ve.call(this,null,e)}$e(Rle,ve,{transform(e,t){var n=t.fork(t.ADD_REM),r=e.mod||!1,i=e.encoders,a=t.encode;if(ut(a))if(n.changed()||a.every(f=>i[f]))a=a[0],n.encode=null;else return t.StopPropagation;var o=a==="enter",s=i.update||Qf,u=i.enter||Qf,l=i.exit||Qf,c=(a&&!o?i[a]:s)||Qf;if(t.changed(t.ADD)&&(t.visit(t.ADD,f=>{u(f,e),s(f,e)}),n.modifies(u.output),n.modifies(s.output),c!==Qf&&c!==s&&(t.visit(t.ADD,f=>{c(f,e)}),n.modifies(c.output))),t.changed(t.REM)&&l!==Qf&&(t.visit(t.REM,f=>{l(f,e)}),n.modifies(l.output)),o||c!==Qf){const f=t.MOD|(e.modified()?t.REFLOW:0);o?(t.visit(f,d=>{const h=u(d,e)||r;(c(d,e)||h)&&n.mod.push(d)}),n.mod.length&&n.modifies(u.output)):t.visit(f,d=>{(c(d,e)||r)&&n.mod.push(d)}),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}});function Fle(e){ve.call(this,[],e)}$e(Fle,ve,{transform(e,t){if(this.value!=null&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=this.value,a=e.type||jA,o=e.scale,s=+e.limit,u=jB(o,e.count==null?5:e.count,e.minstep),l=!!e.values||a===jA,c=e.format||Pse(n,o,u,a,e.formatSpecifier,e.formatType,l),f=e.values||Mse(o,u),d,h,p,g,m;return i&&(r.rem=i),a===jA?(s&&f.length>s?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),i=f.slice(0,s-1),m=!0):i=f,Lt(p=e.size)?(!e.values&&o(i[0])===0&&(i=i.slice(1)),g=i.reduce((v,y)=>Math.max(v,p(y,e)),0)):p=Ji(g=p||8),i=i.map((v,y)=>In({index:y,label:c(v,y,i),value:v,offset:g,size:p(v,e)})),m&&(m=f[i.length],i.push(In({index:i.length,label:"\u2026".concat(f.length-i.length," entries"),value:m,offset:g,size:p(m,e)})))):a===bZe?(d=o.domain(),h=kse(o,d[0],sn(d)),f.length<3&&!e.values&&d[0]!==sn(d)&&(f=[d[0],sn(d)]),i=f.map((v,y)=>In({index:y,label:c(v,y,f),value:v,perc:h(v)}))):(p=f.length-1,h=IZe(o),i=f.map((v,y)=>In({index:y,label:c(v,y,f),value:v,perc:y?h(v):0,perc2:y===p?1:h(f[y+1])}))),r.source=i,r.add=i,this.value=i,r}});const qet=e=>e.source.x,Het=e=>e.source.y,Get=e=>e.target.x,Ket=e=>e.target.y;function Kz(e){ve.call(this,{},e)}Kz.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},$e(Kz,ve,{transform(e,t){var n=e.sourceX||qet,r=e.sourceY||Het,i=e.targetX||Get,a=e.targetY||Ket,o=e.as||"path",s=e.orient||"vertical",u=e.shape||"line",l=Lle.get(u+"-"+s)||Lle.get(u);return l||Se("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,c=>{c[o]=l(n(c),r(c),i(c),a(c))}),t.reflow(e.modified()).modifies(o)}});const Mle=(e,t,n,r)=>"M"+e+","+t+"L"+n+","+r,Xet=(e,t,n,r)=>Mle(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),Ple=(e,t,n,r)=>{var i=n-e,a=r-t,o=Math.sqrt(i*i+a*a)/2,s=180*Math.atan2(a,i)/Math.PI;return"M"+e+","+t+"A"+o+","+o+" "+s+" 0 1 "+n+","+r},Yet=(e,t,n,r)=>Ple(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),$le=(e,t,n,r)=>{const i=n-e,a=r-t,o=.2*(i+a),s=.2*(a-i);return"M"+e+","+t+"C"+(e+o)+","+(t+s)+" "+(n+s)+","+(r-o)+" "+n+","+r},Zet=(e,t,n,r)=>$le(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n)),Jet=(e,t,n,r)=>"M"+e+","+t+"V"+r+"H"+n,Qet=(e,t,n,r)=>"M"+e+","+t+"H"+n+"V"+r,ett=(e,t,n,r)=>{const i=Math.cos(e),a=Math.sin(e),o=Math.cos(n),s=Math.sin(n),u=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*i+","+t*a+"A"+t+","+t+" 0 0,"+(u?1:0)+" "+t*o+","+t*s+"L"+r*o+","+r*s},ttt=(e,t,n,r)=>{const i=(e+n)/2;return"M"+e+","+t+"C"+i+","+t+" "+i+","+r+" "+n+","+r},ntt=(e,t,n,r)=>{const i=(t+r)/2;return"M"+e+","+t+"C"+e+","+i+" "+n+","+i+" "+n+","+r},rtt=(e,t,n,r)=>{const i=Math.cos(e),a=Math.sin(e),o=Math.cos(n),s=Math.sin(n),u=(t+r)/2;return"M"+t*i+","+t*a+"C"+u*i+","+u*a+" "+u*o+","+u*s+" "+r*o+","+r*s},Lle=fv({line:Mle,"line-radial":Xet,arc:Ple,"arc-radial":Yet,curve:$le,"curve-radial":Zet,"orthogonal-horizontal":Jet,"orthogonal-vertical":Qet,"orthogonal-radial":ett,"diagonal-horizontal":ttt,"diagonal-vertical":ntt,"diagonal-radial":rtt});function Xz(e){ve.call(this,null,e)}Xz.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},$e(Xz,ve,{transform(e,t){var n=e.as||["startAngle","endAngle"],r=n[0],i=n[1],a=e.field||cv,o=e.startAngle||0,s=e.endAngle!=null?e.endAngle:2*Math.PI,u=t.source,l=u.map(a),c=l.length,f=o,d=(s-o)/Ere(l),h=Bo(c),p,g,m;for(e.sort&&h.sort((v,y)=>l[v]-l[y]),p=0;p<c;++p)m=l[h[p]],g=u[h[p]],g[r]=f,g[i]=f+=m*d;return this.value=l,t.reflow(e.modified()).modifies(n)}});const itt=5;function att(e){const t=e.type;return!e.bins&&(t===Nv||t===H1||t===G1)}function Ble(e){return $B(e)&&e!==ll}const ott=nu(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function zle(e){ve.call(this,null,e),this.modified(!0)}$e(zle,ve,{transform(e,t){var n=t.dataflow,r=this.value,i=stt(e);(!r||i!==r.type)&&(this.value=r=Sn(i)());for(i in e)if(!ott[i]){if(i==="padding"&&Ble(r.type))continue;Lt(r[i])?r[i](e[i]):n.warn("Unsupported scale property: "+i)}return htt(r,e,dtt(r,e,ltt(r,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function stt(e){var t=e.type,n="",r;return t===ll?ll+"-"+Nv:(utt(e)&&(r=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0,n=r===2?ll+"-":r===3?Dv+"-":""),(n+t||Nv).toLowerCase())}function utt(e){const t=e.type;return $B(t)&&t!==Ep&&t!==Cp&&(e.scheme||e.range&&e.range.length&&e.range.every(Bn))}function ltt(e,t,n){const r=ctt(e,t.domainRaw,n);if(r>-1)return r;var i=t.domain,a=e.type,o=t.zero||t.zero===void 0&&att(e),s,u;if(!i)return 0;if(Ble(a)&&t.padding&&i[0]!==sn(i)&&(i=ftt(a,i,t.range,t.padding,t.exponent,t.constant)),(o||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null)&&(s=(i=i.slice()).length-1||1,o&&(i[0]>0&&(i[0]=0),i[s]<0&&(i[s]=0)),t.domainMin!=null&&(i[0]=t.domainMin),t.domainMax!=null&&(i[s]=t.domainMax),t.domainMid!=null)){u=t.domainMid;const l=u>i[s]?s+1:u<i[0]?0:s;l!==s&&n.warn("Scale domainMid exceeds domain min or max.",u),i.splice(l,0,u)}return e.domain(jle(a,i,n)),a===DB&&e.unknown(t.domainImplicit?tB:void 0),t.nice&&e.nice&&e.nice(t.nice!==!0&&jB(e,t.nice)||null),i.length}function ctt(e,t,n){return t?(e.domain(jle(e.type,t,n)),t.length):-1}function ftt(e,t,n,r,i,a){var o=Math.abs(sn(n)-n[0]),s=o/(o-2*r),u=e===Ac?t4(t,null,s):e===G1?zC(t,null,s,.5):e===H1?zC(t,null,s,i||1):e===PA?n4(t,null,s,a||1):e4(t,null,s);return t=t.slice(),t[0]=u[0],t[t.length-1]=u[1],t}function jle(e,t,n){if(_se(e)){var r=Math.abs(t.reduce((i,a)=>i+(a<0?-1:a>0?1:0),0));r!==t.length&&n.warn("Log scale domain includes zero: "+gt(t))}return t}function dtt(e,t,n){let r=t.bins;if(r&&!ut(r)){const i=e.domain(),a=i[0],o=sn(i),s=r.step;let u=r.start==null?a:r.start,l=r.stop==null?o:r.stop;s||Se("Scale bins parameter missing step property."),u<a&&(u=s*Math.ceil(a/s)),l>o&&(l=s*Math.floor(o/s)),r=Bo(u,l+s/2,s)}return r?e.bins=r:e.bins&&delete e.bins,e.type===FB&&(r?!t.domain&&!t.domainRaw&&(e.domain(r),n=r.length):e.bins=e.domain()),n}function htt(e,t,n){var r=e.type,i=t.round||!1,a=t.range;if(t.rangeStep!=null)a=ptt(r,t,n);else if(t.scheme&&(a=gtt(r,t,n),Lt(a))){if(e.interpolator)return e.interpolator(a);Se("Scale type ".concat(r," does not support interpolating color schemes."))}if(a&&Sse(r))return e.interpolator(zA(Yz(a,t.reverse),t.interpolate,t.interpolateGamma));a&&t.interpolate&&e.interpolate?e.interpolate(BB(t.interpolate,t.interpolateGamma)):Lt(e.round)?e.round(i):Lt(e.rangeRound)&&e.interpolate(i?W1:md),a&&e.range(Yz(a,t.reverse))}function ptt(e,t,n){e!==yse&&e!==RB&&Se("Only band and point scales support rangeStep.");var r=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,i=e===RB?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*NB(n,i,r)]}function gtt(e,t,n){var r=t.schemeExtent,i,a;return ut(t.scheme)?a=zA(t.scheme,t.interpolate,t.interpolateGamma):(i=t.scheme.toLowerCase(),a=zB(i),a||Se("Unrecognized scheme name: ".concat(t.scheme))),n=e===LA?n+1:e===FB?n-1:e===Rv||e===$A?+t.schemeCount||itt:n,Sse(e)?Ule(a,r,t.reverse):Lt(a)?Ase(Ule(a,r),n):e===DB?a:a.slice(0,n)}function Ule(e,t,n){return Lt(e)&&(t||n)?Cse(e,Yz(t||[0,1],n)):e}function Yz(e,t){return t?e.slice().reverse():e}function Wle(e){ve.call(this,null,e)}$e(Wle,ve,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(mp(e.sort)),this.modified(n),t}});const Vle="zero",qle="center",Hle="normalize",Gle=["y0","y1"];function Zz(e){ve.call(this,null,e)}Zz.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:Vle,values:[Vle,qle,Hle]},{name:"as",type:"string",array:!0,length:2,default:Gle}]},$e(Zz,ve,{transform(e,t){var n=e.as||Gle,r=n[0],i=n[1],a=mp(e.sort),o=e.field||cv,s=e.offset===qle?mtt:e.offset===Hle?vtt:ytt,u,l,c,f;for(u=btt(t.source,e.groupby,a,o),l=0,c=u.length,f=u.max;l<c;++l)s(u[l],f,o,r,i);return t.reflow(e.modified()).modifies(n)}});function mtt(e,t,n,r,i){for(var a=(t-e.sum)/2,o=e.length,s=0,u;s<o;++s)u=e[s],u[r]=a,u[i]=a+=Math.abs(n(u))}function vtt(e,t,n,r,i){for(var a=1/e.sum,o=0,s=e.length,u=0,l=0,c;u<s;++u)c=e[u],c[r]=o,c[i]=o=a*(l+=Math.abs(n(c)))}function ytt(e,t,n,r,i){for(var a=0,o=0,s=e.length,u=0,l,c;u<s;++u)c=e[u],l=+n(c),l<0?(c[r]=o,c[i]=o+=l):(c[r]=a,c[i]=a+=l)}function btt(e,t,n,r){var i=[],a=g=>g(c),o,s,u,l,c,f,d,h,p;if(t==null)i.push(e.slice());else for(o={},s=0,u=e.length;s<u;++s)c=e[s],f=t.map(a),d=o[f],d||(o[f]=d=[],i.push(d)),d.push(c);for(f=0,p=0,l=i.length;f<l;++f){for(d=i[f],s=0,h=0,u=d.length;s<u;++s)h+=Math.abs(r(d[s]));d.sum=h,h>p&&(p=h),n&&d.sort(n)}return i.max=p,i}var xtt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",axisticks:Nle,datajoin:Dle,encode:Rle,legendentries:Fle,linkpath:Kz,pie:Xz,scale:zle,sortitems:Wle,stack:Zz}),mt=1e-6,wk=1e-12,Gt=Math.PI,Or=Gt/2,_k=Gt/4,Ra=Gt*2,Lr=180/Gt,Kt=Gt/180,hn=Math.abs,qv=Math.atan,gs=Math.atan2,yt=Math.cos,Sk=Math.ceil,Kle=Math.exp,Jz=Math.hypot,Ek=Math.log,Qz=Math.pow,ct=Math.sin,ms=Math.sign||function(e){return e>0?1:e<0?-1:0},Fa=Math.sqrt,e5=Math.tan;function Xle(e){return e>1?0:e<-1?Gt:Math.acos(e)}function co(e){return e>1?Or:e<-1?-Or:Math.asin(e)}function zi(){}function Ck(e,t){e&&Zle.hasOwnProperty(e.type)&&Zle[e.type](e,t)}var Yle={Feature:function(e,t){Ck(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)Ck(n[r].geometry,t)}},Zle={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){t5(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)t5(n[r],t,0)},Polygon:function(e,t){Jle(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)Jle(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)Ck(n[r],t)}};function t5(e,t,n){var r=-1,i=e.length-n,a;for(t.lineStart();++r<i;)a=e[r],t.point(a[0],a[1],a[2]);t.lineEnd()}function Jle(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)t5(e[n],t,1);t.polygonEnd()}function Ic(e,t){e&&Yle.hasOwnProperty(e.type)?Yle[e.type](e,t):Ck(e,t)}var Ak=new Ia,kk=new Ia,Qle,ece,n5,r5,i5,gl={point:zi,lineStart:zi,lineEnd:zi,polygonStart:function(){Ak=new Ia,gl.lineStart=wtt,gl.lineEnd=_tt},polygonEnd:function(){var e=+Ak;kk.add(e<0?Ra+e:e),this.lineStart=this.lineEnd=this.point=zi},sphere:function(){kk.add(Ra)}};function wtt(){gl.point=Stt}function _tt(){tce(Qle,ece)}function Stt(e,t){gl.point=tce,Qle=e,ece=t,e*=Kt,t*=Kt,n5=e,r5=yt(t=t/2+_k),i5=ct(t)}function tce(e,t){e*=Kt,t*=Kt,t=t/2+_k;var n=e-n5,r=n>=0?1:-1,i=r*n,a=yt(t),o=ct(t),s=i5*o,u=r5*a+s*yt(i),l=s*r*ct(i);Ak.add(gs(l,u)),n5=e,r5=a,i5=o}function Ett(e){return kk=new Ia,Ic(e,gl),kk*2}function Tk(e){return[gs(e[1],e[0]),co(e[2])]}function Dp(e){var t=e[0],n=e[1],r=yt(n);return[r*yt(t),r*ct(t),ct(n)]}function Ok(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Hv(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function a5(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Ik(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Nk(e){var t=Fa(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var yr,fo,Ir,Wo,Rp,nce,rce,Gv,gx,Nd,Nc,Dc={point:o5,lineStart:ace,lineEnd:oce,polygonStart:function(){Dc.point=sce,Dc.lineStart=Ctt,Dc.lineEnd=Att,gx=new Ia,gl.polygonStart()},polygonEnd:function(){gl.polygonEnd(),Dc.point=o5,Dc.lineStart=ace,Dc.lineEnd=oce,Ak<0?(yr=-(Ir=180),fo=-(Wo=90)):gx>mt?Wo=90:gx<-mt&&(fo=-90),Nc[0]=yr,Nc[1]=Ir},sphere:function(){yr=-(Ir=180),fo=-(Wo=90)}};function o5(e,t){Nd.push(Nc=[yr=e,Ir=e]),t<fo&&(fo=t),t>Wo&&(Wo=t)}function ice(e,t){var n=Dp([e*Kt,t*Kt]);if(Gv){var r=Hv(Gv,n),i=[r[1],-r[0],0],a=Hv(i,r);Nk(a),a=Tk(a);var o=e-Rp,s=o>0?1:-1,u=a[0]*Lr*s,l,c=hn(o)>180;c^(s*Rp<u&&u<s*e)?(l=a[1]*Lr,l>Wo&&(Wo=l)):(u=(u+360)%360-180,c^(s*Rp<u&&u<s*e)?(l=-a[1]*Lr,l<fo&&(fo=l)):(t<fo&&(fo=t),t>Wo&&(Wo=t))),c?e<Rp?Vo(yr,e)>Vo(yr,Ir)&&(Ir=e):Vo(e,Ir)>Vo(yr,Ir)&&(yr=e):Ir>=yr?(e<yr&&(yr=e),e>Ir&&(Ir=e)):e>Rp?Vo(yr,e)>Vo(yr,Ir)&&(Ir=e):Vo(e,Ir)>Vo(yr,Ir)&&(yr=e)}else Nd.push(Nc=[yr=e,Ir=e]);t<fo&&(fo=t),t>Wo&&(Wo=t),Gv=n,Rp=e}function ace(){Dc.point=ice}function oce(){Nc[0]=yr,Nc[1]=Ir,Dc.point=o5,Gv=null}function sce(e,t){if(Gv){var n=e-Rp;gx.add(hn(n)>180?n+(n>0?360:-360):n)}else nce=e,rce=t;gl.point(e,t),ice(e,t)}function Ctt(){gl.lineStart()}function Att(){sce(nce,rce),gl.lineEnd(),hn(gx)>mt&&(yr=-(Ir=180)),Nc[0]=yr,Nc[1]=Ir,Gv=null}function Vo(e,t){return(t-=e)<0?t+360:t}function ktt(e,t){return e[0]-t[0]}function uce(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function Ttt(e){var t,n,r,i,a,o,s;if(Wo=Ir=-(yr=fo=1/0),Nd=[],Ic(e,Dc),n=Nd.length){for(Nd.sort(ktt),t=1,r=Nd[0],a=[r];t<n;++t)i=Nd[t],uce(r,i[0])||uce(r,i[1])?(Vo(r[0],i[1])>Vo(r[0],r[1])&&(r[1]=i[1]),Vo(i[0],r[1])>Vo(r[0],r[1])&&(r[0]=i[0])):a.push(r=i);for(o=-1/0,n=a.length-1,t=0,r=a[n];t<=n;r=i,++t)i=a[t],(s=Vo(r[1],i[0]))>o&&(o=s,yr=i[0],Ir=r[1])}return Nd=Nc=null,yr===1/0||fo===1/0?[[NaN,NaN],[NaN,NaN]]:[[yr,fo],[Ir,Wo]]}var mx,Dk,Rk,Fk,Mk,Pk,$k,Lk,s5,u5,l5,lce,cce,Ma,Pa,$a,cu={sphere:zi,point:c5,lineStart:fce,lineEnd:dce,polygonStart:function(){cu.lineStart=Ntt,cu.lineEnd=Dtt},polygonEnd:function(){cu.lineStart=fce,cu.lineEnd=dce}};function c5(e,t){e*=Kt,t*=Kt;var n=yt(t);vx(n*yt(e),n*ct(e),ct(t))}function vx(e,t,n){++mx,Rk+=(e-Rk)/mx,Fk+=(t-Fk)/mx,Mk+=(n-Mk)/mx}function fce(){cu.point=Ott}function Ott(e,t){e*=Kt,t*=Kt;var n=yt(t);Ma=n*yt(e),Pa=n*ct(e),$a=ct(t),cu.point=Itt,vx(Ma,Pa,$a)}function Itt(e,t){e*=Kt,t*=Kt;var n=yt(t),r=n*yt(e),i=n*ct(e),a=ct(t),o=gs(Fa((o=Pa*a-$a*i)*o+(o=$a*r-Ma*a)*o+(o=Ma*i-Pa*r)*o),Ma*r+Pa*i+$a*a);Dk+=o,Pk+=o*(Ma+(Ma=r)),$k+=o*(Pa+(Pa=i)),Lk+=o*($a+($a=a)),vx(Ma,Pa,$a)}function dce(){cu.point=c5}function Ntt(){cu.point=Rtt}function Dtt(){hce(lce,cce),cu.point=c5}function Rtt(e,t){lce=e,cce=t,e*=Kt,t*=Kt,cu.point=hce;var n=yt(t);Ma=n*yt(e),Pa=n*ct(e),$a=ct(t),vx(Ma,Pa,$a)}function hce(e,t){e*=Kt,t*=Kt;var n=yt(t),r=n*yt(e),i=n*ct(e),a=ct(t),o=Pa*a-$a*i,s=$a*r-Ma*a,u=Ma*i-Pa*r,l=Jz(o,s,u),c=co(l),f=l&&-c/l;s5.add(f*o),u5.add(f*s),l5.add(f*u),Dk+=c,Pk+=c*(Ma+(Ma=r)),$k+=c*(Pa+(Pa=i)),Lk+=c*($a+($a=a)),vx(Ma,Pa,$a)}function Ftt(e){mx=Dk=Rk=Fk=Mk=Pk=$k=Lk=0,s5=new Ia,u5=new Ia,l5=new Ia,Ic(e,cu);var t=+s5,n=+u5,r=+l5,i=Jz(t,n,r);return i<wk&&(t=Pk,n=$k,r=Lk,Dk<mt&&(t=Rk,n=Fk,r=Mk),i=Jz(t,n,r),i<wk)?[NaN,NaN]:[gs(n,t)*Lr,co(r/i)*Lr]}function f5(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function d5(e,t){return[hn(e)>Gt?e+Math.round(-e/Ra)*Ra:e,t]}d5.invert=d5;function pce(e,t,n){return(e%=Ra)?t||n?f5(mce(e),vce(t,n)):mce(e):t||n?vce(t,n):d5}function gce(e){return function(t,n){return t+=e,[t>Gt?t-Ra:t<-Gt?t+Ra:t,n]}}function mce(e){var t=gce(e);return t.invert=gce(-e),t}function vce(e,t){var n=yt(e),r=ct(e),i=yt(t),a=ct(t);function o(s,u){var l=yt(u),c=yt(s)*l,f=ct(s)*l,d=ct(u),h=d*n+c*r;return[gs(f*i-h*a,c*n-d*r),co(h*i+f*a)]}return o.invert=function(s,u){var l=yt(u),c=yt(s)*l,f=ct(s)*l,d=ct(u),h=d*i-f*a;return[gs(f*i+d*a,c*n+h*r),co(h*n-c*r)]},o}function Mtt(e){e=pce(e[0]*Kt,e[1]*Kt,e.length>2?e[2]*Kt:0);function t(n){return n=e(n[0]*Kt,n[1]*Kt),n[0]*=Lr,n[1]*=Lr,n}return t.invert=function(n){return n=e.invert(n[0]*Kt,n[1]*Kt),n[0]*=Lr,n[1]*=Lr,n},t}function Ptt(e,t,n,r,i,a){if(!!n){var o=yt(t),s=ct(t),u=r*n;i==null?(i=t+r*Ra,a=t-u/2):(i=yce(o,i),a=yce(o,a),(r>0?i<a:i>a)&&(i+=r*Ra));for(var l,c=i;r>0?c>a:c<a;c-=u)l=Tk([o,-s*yt(c),-s*ct(c)]),e.point(l[0],l[1])}}function yce(e,t){t=Dp(t),t[0]-=e,Nk(t);var n=Xle(-t[1]);return((-t[2]<0?-n:n)+Ra-mt)%Ra}function bce(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:zi,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function Bk(e,t){return hn(e[0]-t[0])<mt&&hn(e[1]-t[1])<mt}function zk(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function xce(e,t,n,r,i){var a=[],o=[],s,u;if(e.forEach(function(p){if(!((g=p.length-1)<=0)){var g,m=p[0],v=p[g],y;if(Bk(m,v)){if(!m[2]&&!v[2]){for(i.lineStart(),s=0;s<g;++s)i.point((m=p[s])[0],m[1]);i.lineEnd();return}v[0]+=2*mt}a.push(y=new zk(m,p,null,!0)),o.push(y.o=new zk(m,null,y,!1)),a.push(y=new zk(v,p,null,!1)),o.push(y.o=new zk(v,null,y,!0))}}),!!a.length){for(o.sort(t),wce(a),wce(o),s=0,u=o.length;s<u;++s)o[s].e=n=!n;for(var l=a[0],c,f;;){for(var d=l,h=!0;d.v;)if((d=d.n)===l)return;c=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(s=0,u=c.length;s<u;++s)i.point((f=c[s])[0],f[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(h)for(c=d.p.z,s=c.length-1;s>=0;--s)i.point((f=c[s])[0],f[1]);else r(d.x,d.p.x,-1,i);d=d.p}d=d.o,c=d.z,h=!h}while(!d.v);i.lineEnd()}}}function wce(e){if(!!(t=e.length)){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function h5(e){return hn(e[0])<=Gt?e[0]:ms(e[0])*((hn(e[0])+Gt)%Ra-Gt)}function $tt(e,t){var n=h5(t),r=t[1],i=ct(r),a=[ct(n),-yt(n),0],o=0,s=0,u=new Ia;i===1?r=Or+mt:i===-1&&(r=-Or-mt);for(var l=0,c=e.length;l<c;++l)if(!!(d=(f=e[l]).length))for(var f,d,h=f[d-1],p=h5(h),g=h[1]/2+_k,m=ct(g),v=yt(g),y=0;y<d;++y,p=x,m=S,v=C,h=b){var b=f[y],x=h5(b),w=b[1]/2+_k,S=ct(w),C=yt(w),_=x-p,E=_>=0?1:-1,A=E*_,k=A>Gt,T=m*S;if(u.add(gs(T*E*ct(A),v*C+T*yt(A))),o+=k?_+E*Ra:_,k^p>=n^x>=n){var I=Hv(Dp(h),Dp(b));Nk(I);var N=Hv(a,I);Nk(N);var O=(k^_>=0?-1:1)*co(N[2]);(r>O||r===O&&(I[0]||I[1]))&&(s+=k^_>=0?1:-1)}}return(o<-mt||o<mt&&u<-wk)^s&1}function _ce(e,t,n,r){return function(i){var a=t(i),o=bce(),s=t(o),u=!1,l,c,f,d={point:h,lineStart:g,lineEnd:m,polygonStart:function(){d.point=v,d.lineStart=y,d.lineEnd=b,c=[],l=[]},polygonEnd:function(){d.point=h,d.lineStart=g,d.lineEnd=m,c=Sre(c);var x=$tt(l,r);c.length?(u||(i.polygonStart(),u=!0),xce(c,Btt,x,n,i)):x&&(u||(i.polygonStart(),u=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),u&&(i.polygonEnd(),u=!1),c=l=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(x,w){e(x,w)&&i.point(x,w)}function p(x,w){a.point(x,w)}function g(){d.point=p,a.lineStart()}function m(){d.point=h,a.lineEnd()}function v(x,w){f.push([x,w]),s.point(x,w)}function y(){s.lineStart(),f=[]}function b(){v(f[0][0],f[0][1]),s.lineEnd();var x=s.clean(),w=o.result(),S,C=w.length,_,E,A;if(f.pop(),l.push(f),f=null,!!C){if(x&1){if(E=w[0],(_=E.length-1)>0){for(u||(i.polygonStart(),u=!0),i.lineStart(),S=0;S<_;++S)i.point((A=E[S])[0],A[1]);i.lineEnd()}return}C>1&&x&2&&w.push(w.pop().concat(w.shift())),c.push(w.filter(Ltt))}}return d}}function Ltt(e){return e.length>1}function Btt(e,t){return((e=e.x)[0]<0?e[1]-Or-mt:Or-e[1])-((t=t.x)[0]<0?t[1]-Or-mt:Or-t[1])}var Sce=_ce(function(){return!0},ztt,Utt,[-Gt,-Or]);function ztt(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(a,o){var s=a>0?Gt:-Gt,u=hn(a-t);hn(u-Gt)<mt?(e.point(t,n=(n+o)/2>0?Or:-Or),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(s,n),e.point(a,n),i=0):r!==s&&u>=Gt&&(hn(t-r)<mt&&(t-=r*mt),hn(a-s)<mt&&(a-=s*mt),n=jtt(t,n,a,o),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(s,n),i=0),e.point(t=a,n=o),r=s},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function jtt(e,t,n,r){var i,a,o=ct(e-n);return hn(o)>mt?qv((ct(t)*(a=yt(r))*ct(n)-ct(r)*(i=yt(t))*ct(e))/(i*a*o)):(t+r)/2}function Utt(e,t,n,r){var i;if(e==null)i=n*Or,r.point(-Gt,i),r.point(0,i),r.point(Gt,i),r.point(Gt,0),r.point(Gt,-i),r.point(0,-i),r.point(-Gt,-i),r.point(-Gt,0),r.point(-Gt,i);else if(hn(e[0]-t[0])>mt){var a=e[0]<t[0]?Gt:-Gt;i=n*a/2,r.point(-a,i),r.point(0,i),r.point(a,i)}else r.point(t[0],t[1])}function Wtt(e){var t=yt(e),n=6*Kt,r=t>0,i=hn(t)>mt;function a(c,f,d,h){Ptt(h,e,n,d,c,f)}function o(c,f){return yt(c)*yt(f)>t}function s(c){var f,d,h,p,g;return{lineStart:function(){p=h=!1,g=1},point:function(m,v){var y=[m,v],b,x=o(m,v),w=r?x?0:l(m,v):x?l(m+(m<0?Gt:-Gt),v):0;if(!f&&(p=h=x)&&c.lineStart(),x!==h&&(b=u(f,y),(!b||Bk(f,b)||Bk(y,b))&&(y[2]=1)),x!==h)g=0,x?(c.lineStart(),b=u(y,f),c.point(b[0],b[1])):(b=u(f,y),c.point(b[0],b[1],2),c.lineEnd()),f=b;else if(i&&f&&r^x){var S;!(w&d)&&(S=u(y,f,!0))&&(g=0,r?(c.lineStart(),c.point(S[0][0],S[0][1]),c.point(S[1][0],S[1][1]),c.lineEnd()):(c.point(S[1][0],S[1][1]),c.lineEnd(),c.lineStart(),c.point(S[0][0],S[0][1],3)))}x&&(!f||!Bk(f,y))&&c.point(y[0],y[1]),f=y,h=x,d=w},lineEnd:function(){h&&c.lineEnd(),f=null},clean:function(){return g|(p&&h)<<1}}}function u(c,f,d){var h=Dp(c),p=Dp(f),g=[1,0,0],m=Hv(h,p),v=Ok(m,m),y=m[0],b=v-y*y;if(!b)return!d&&c;var x=t*v/b,w=-t*y/b,S=Hv(g,m),C=Ik(g,x),_=Ik(m,w);a5(C,_);var E=S,A=Ok(C,E),k=Ok(E,E),T=A*A-k*(Ok(C,C)-1);if(!(T<0)){var I=Fa(T),N=Ik(E,(-A-I)/k);if(a5(N,C),N=Tk(N),!d)return N;var O=c[0],D=f[0],L=c[1],W=f[1],G;D<O&&(G=O,O=D,D=G);var K=D-O,ee=hn(K-Gt)<mt,ce=ee||K<mt;if(!ee&&W<L&&(G=L,L=W,W=G),ce?ee?L+W>0^N[1]<(hn(N[0]-O)<mt?L:W):L<=N[1]&&N[1]<=W:K>Gt^(O<=N[0]&&N[0]<=D)){var he=Ik(E,(-A+I)/k);return a5(he,C),[N,Tk(he)]}}}function l(c,f){var d=r?e:Gt-e,h=0;return c<-d?h|=1:c>d&&(h|=2),f<-d?h|=4:f>d&&(h|=8),h}return _ce(o,s,a,r?[0,-e]:[-Gt,e-Gt])}function Vtt(e,t,n,r,i,a){var o=e[0],s=e[1],u=t[0],l=t[1],c=0,f=1,d=u-o,h=l-s,p;if(p=n-o,!(!d&&p>0)){if(p/=d,d<0){if(p<c)return;p<f&&(f=p)}else if(d>0){if(p>f)return;p>c&&(c=p)}if(p=i-o,!(!d&&p<0)){if(p/=d,d<0){if(p>f)return;p>c&&(c=p)}else if(d>0){if(p<c)return;p<f&&(f=p)}if(p=r-s,!(!h&&p>0)){if(p/=h,h<0){if(p<c)return;p<f&&(f=p)}else if(h>0){if(p>f)return;p>c&&(c=p)}if(p=a-s,!(!h&&p<0)){if(p/=h,h<0){if(p>f)return;p>c&&(c=p)}else if(h>0){if(p<c)return;p<f&&(f=p)}return c>0&&(e[0]=o+c*d,e[1]=s+c*h),f<1&&(t[0]=o+f*d,t[1]=s+f*h),!0}}}}}var yx=1e9,jk=-yx;function Ece(e,t,n,r){function i(l,c){return e<=l&&l<=n&&t<=c&&c<=r}function a(l,c,f,d){var h=0,p=0;if(l==null||(h=o(l,f))!==(p=o(c,f))||u(l,c)<0^f>0)do d.point(h===0||h===3?e:n,h>1?r:t);while((h=(h+f+4)%4)!==p);else d.point(c[0],c[1])}function o(l,c){return hn(l[0]-e)<mt?c>0?0:3:hn(l[0]-n)<mt?c>0?2:1:hn(l[1]-t)<mt?c>0?1:0:c>0?3:2}function s(l,c){return u(l.x,c.x)}function u(l,c){var f=o(l,1),d=o(c,1);return f!==d?f-d:f===0?c[1]-l[1]:f===1?l[0]-c[0]:f===2?l[1]-c[1]:c[0]-l[0]}return function(l){var c=l,f=bce(),d,h,p,g,m,v,y,b,x,w,S,C={point:_,lineStart:T,lineEnd:I,polygonStart:A,polygonEnd:k};function _(O,D){i(O,D)&&c.point(O,D)}function E(){for(var O=0,D=0,L=h.length;D<L;++D)for(var W=h[D],G=1,K=W.length,ee=W[0],ce,he,Oe=ee[0],Te=ee[1];G<K;++G)ce=Oe,he=Te,ee=W[G],Oe=ee[0],Te=ee[1],he<=r?Te>r&&(Oe-ce)*(r-he)>(Te-he)*(e-ce)&&++O:Te<=r&&(Oe-ce)*(r-he)<(Te-he)*(e-ce)&&--O;return O}function A(){c=f,d=[],h=[],S=!0}function k(){var O=E(),D=S&&O,L=(d=Sre(d)).length;(D||L)&&(l.polygonStart(),D&&(l.lineStart(),a(null,null,1,l),l.lineEnd()),L&&xce(d,s,O,a,l),l.polygonEnd()),c=l,d=h=p=null}function T(){C.point=N,h&&h.push(p=[]),w=!0,x=!1,y=b=NaN}function I(){d&&(N(g,m),v&&x&&f.rejoin(),d.push(f.result())),C.point=_,x&&c.lineEnd()}function N(O,D){var L=i(O,D);if(h&&p.push([O,D]),w)g=O,m=D,v=L,w=!1,L&&(c.lineStart(),c.point(O,D));else if(L&&x)c.point(O,D);else{var W=[y=Math.max(jk,Math.min(yx,y)),b=Math.max(jk,Math.min(yx,b))],G=[O=Math.max(jk,Math.min(yx,O)),D=Math.max(jk,Math.min(yx,D))];Vtt(W,G,e,t,n,r)?(x||(c.lineStart(),c.point(W[0],W[1])),c.point(G[0],G[1]),L||c.lineEnd(),S=!1):L&&(c.lineStart(),c.point(O,D),S=!1)}y=O,b=D,x=L}return C}}function Cce(e,t,n){var r=Bo(e,t-mt,n).concat(t);return function(i){return r.map(function(a){return[i,a]})}}function Ace(e,t,n){var r=Bo(e,t-mt,n).concat(t);return function(i){return r.map(function(a){return[a,i]})}}function qtt(){var e,t,n,r,i,a,o,s,u=10,l=u,c=90,f=360,d,h,p,g,m=2.5;function v(){return{type:"MultiLineString",coordinates:y()}}function y(){return Bo(Sk(r/c)*c,n,c).map(p).concat(Bo(Sk(s/f)*f,o,f).map(g)).concat(Bo(Sk(t/u)*u,e,u).filter(function(b){return hn(b%c)>mt}).map(d)).concat(Bo(Sk(a/l)*l,i,l).filter(function(b){return hn(b%f)>mt}).map(h))}return v.lines=function(){return y().map(function(b){return{type:"LineString",coordinates:b}})},v.outline=function(){return{type:"Polygon",coordinates:[p(r).concat(g(o).slice(1),p(n).reverse().slice(1),g(s).reverse().slice(1))]}},v.extent=function(b){return arguments.length?v.extentMajor(b).extentMinor(b):v.extentMinor()},v.extentMajor=function(b){return arguments.length?(r=+b[0][0],n=+b[1][0],s=+b[0][1],o=+b[1][1],r>n&&(b=r,r=n,n=b),s>o&&(b=s,s=o,o=b),v.precision(m)):[[r,s],[n,o]]},v.extentMinor=function(b){return arguments.length?(t=+b[0][0],e=+b[1][0],a=+b[0][1],i=+b[1][1],t>e&&(b=t,t=e,e=b),a>i&&(b=a,a=i,i=b),v.precision(m)):[[t,a],[e,i]]},v.step=function(b){return arguments.length?v.stepMajor(b).stepMinor(b):v.stepMinor()},v.stepMajor=function(b){return arguments.length?(c=+b[0],f=+b[1],v):[c,f]},v.stepMinor=function(b){return arguments.length?(u=+b[0],l=+b[1],v):[u,l]},v.precision=function(b){return arguments.length?(m=+b,d=Cce(a,i,90),h=Ace(t,e,m),p=Cce(s,o,90),g=Ace(r,n,m),v):m},v.extentMajor([[-180,-90+mt],[180,90-mt]]).extentMinor([[-180,-80-mt],[180,80+mt]])}var bx=e=>e,p5=new Ia,g5=new Ia,kce,Tce,m5,v5,Rc={point:zi,lineStart:zi,lineEnd:zi,polygonStart:function(){Rc.lineStart=Htt,Rc.lineEnd=Ktt},polygonEnd:function(){Rc.lineStart=Rc.lineEnd=Rc.point=zi,p5.add(hn(g5)),g5=new Ia},result:function(){var e=p5/2;return p5=new Ia,e}};function Htt(){Rc.point=Gtt}function Gtt(e,t){Rc.point=Oce,kce=m5=e,Tce=v5=t}function Oce(e,t){g5.add(v5*e-m5*t),m5=e,v5=t}function Ktt(){Oce(kce,Tce)}var Kv=1/0,Uk=Kv,xx=-Kv,Wk=xx,Vk={point:Xtt,lineStart:zi,lineEnd:zi,polygonStart:zi,polygonEnd:zi,result:function(){var e=[[Kv,Uk],[xx,Wk]];return xx=Wk=-(Uk=Kv=1/0),e}};function Xtt(e,t){e<Kv&&(Kv=e),e>xx&&(xx=e),t<Uk&&(Uk=t),t>Wk&&(Wk=t)}var y5=0,b5=0,wx=0,qk=0,Hk=0,Xv=0,x5=0,w5=0,_x=0,Ice,Nce,ml,vl,vs={point:Fp,lineStart:Dce,lineEnd:Rce,polygonStart:function(){vs.lineStart=Jtt,vs.lineEnd=Qtt},polygonEnd:function(){vs.point=Fp,vs.lineStart=Dce,vs.lineEnd=Rce},result:function(){var e=_x?[x5/_x,w5/_x]:Xv?[qk/Xv,Hk/Xv]:wx?[y5/wx,b5/wx]:[NaN,NaN];return y5=b5=wx=qk=Hk=Xv=x5=w5=_x=0,e}};function Fp(e,t){y5+=e,b5+=t,++wx}function Dce(){vs.point=Ytt}function Ytt(e,t){vs.point=Ztt,Fp(ml=e,vl=t)}function Ztt(e,t){var n=e-ml,r=t-vl,i=Fa(n*n+r*r);qk+=i*(ml+e)/2,Hk+=i*(vl+t)/2,Xv+=i,Fp(ml=e,vl=t)}function Rce(){vs.point=Fp}function Jtt(){vs.point=ent}function Qtt(){Fce(Ice,Nce)}function ent(e,t){vs.point=Fce,Fp(Ice=ml=e,Nce=vl=t)}function Fce(e,t){var n=e-ml,r=t-vl,i=Fa(n*n+r*r);qk+=i*(ml+e)/2,Hk+=i*(vl+t)/2,Xv+=i,i=vl*e-ml*t,x5+=i*(ml+e),w5+=i*(vl+t),_x+=i*3,Fp(ml=e,vl=t)}function Mce(e){this._context=e}Mce.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,Ra);break}}},result:zi};var _5=new Ia,S5,Pce,$ce,Sx,Ex,Cx={point:zi,lineStart:function(){Cx.point=tnt},lineEnd:function(){S5&&Lce(Pce,$ce),Cx.point=zi},polygonStart:function(){S5=!0},polygonEnd:function(){S5=null},result:function(){var e=+_5;return _5=new Ia,e}};function tnt(e,t){Cx.point=Lce,Pce=Sx=e,$ce=Ex=t}function Lce(e,t){Sx-=e,Ex-=t,_5.add(Fa(Sx*Sx+Ex*Ex)),Sx=e,Ex=t}function Bce(){this._string=[]}Bce.prototype={_radius:4.5,_circle:zce(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._string.push("M",e,",",t),this._point=1;break}case 1:{this._string.push("L",e,",",t);break}default:{this._circle==null&&(this._circle=zce(this._radius)),this._string.push("M",e,",",t,this._circle);break}}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}else return null}};function zce(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function jce(e,t){var n=4.5,r,i;function a(o){return o&&(typeof n=="function"&&i.pointRadius(+n.apply(this,arguments)),Ic(o,r(i))),i.result()}return a.area=function(o){return Ic(o,r(Rc)),Rc.result()},a.measure=function(o){return Ic(o,r(Cx)),Cx.result()},a.bounds=function(o){return Ic(o,r(Vk)),Vk.result()},a.centroid=function(o){return Ic(o,r(vs)),vs.result()},a.projection=function(o){return arguments.length?(r=o==null?(e=null,bx):(e=o).stream,a):e},a.context=function(o){return arguments.length?(i=o==null?(t=null,new Bce):new Mce(t=o),typeof n!="function"&&i.pointRadius(n),a):t},a.pointRadius=function(o){return arguments.length?(n=typeof o=="function"?o:(i.pointRadius(+o),+o),a):n},a.projection(e).context(t)}function Gk(e){return function(t){var n=new E5;for(var r in e)n[r]=e[r];return n.stream=t,n}}function E5(){}E5.prototype={constructor:E5,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function C5(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),Ic(n,e.stream(Vk)),t(Vk.result()),r!=null&&e.clipExtent(r),e}function Kk(e,t,n){return C5(e,function(r){var i=t[1][0]-t[0][0],a=t[1][1]-t[0][1],o=Math.min(i/(r[1][0]-r[0][0]),a/(r[1][1]-r[0][1])),s=+t[0][0]+(i-o*(r[1][0]+r[0][0]))/2,u=+t[0][1]+(a-o*(r[1][1]+r[0][1]))/2;e.scale(150*o).translate([s,u])},n)}function A5(e,t,n){return Kk(e,[[0,0],t],n)}function k5(e,t,n){return C5(e,function(r){var i=+t,a=i/(r[1][0]-r[0][0]),o=(i-a*(r[1][0]+r[0][0]))/2,s=-a*r[0][1];e.scale(150*a).translate([o,s])},n)}function T5(e,t,n){return C5(e,function(r){var i=+t,a=i/(r[1][1]-r[0][1]),o=-a*r[0][0],s=(i-a*(r[1][1]+r[0][1]))/2;e.scale(150*a).translate([o,s])},n)}var Uce=16,nnt=yt(30*Kt);function Wce(e,t){return+t?int(e,t):rnt(e)}function rnt(e){return Gk({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function int(e,t){function n(r,i,a,o,s,u,l,c,f,d,h,p,g,m){var v=l-r,y=c-i,b=v*v+y*y;if(b>4*t&&g--){var x=o+d,w=s+h,S=u+p,C=Fa(x*x+w*w+S*S),_=co(S/=C),E=hn(hn(S)-1)<mt||hn(a-f)<mt?(a+f)/2:gs(w,x),A=e(E,_),k=A[0],T=A[1],I=k-r,N=T-i,O=y*I-v*N;(O*O/b>t||hn((v*I+y*N)/b-.5)>.3||o*d+s*h+u*p<nnt)&&(n(r,i,a,o,s,u,k,T,E,x/=C,w/=C,S,g,m),m.point(k,T),n(k,T,E,x,w,S,l,c,f,d,h,p,g,m))}}return function(r){var i,a,o,s,u,l,c,f,d,h,p,g,m={point:v,lineStart:y,lineEnd:x,polygonStart:function(){r.polygonStart(),m.lineStart=w},polygonEnd:function(){r.polygonEnd(),m.lineStart=y}};function v(_,E){_=e(_,E),r.point(_[0],_[1])}function y(){f=NaN,m.point=b,r.lineStart()}function b(_,E){var A=Dp([_,E]),k=e(_,E);n(f,d,c,h,p,g,f=k[0],d=k[1],c=_,h=A[0],p=A[1],g=A[2],Uce,r),r.point(f,d)}function x(){m.point=v,r.lineEnd()}function w(){y(),m.point=S,m.lineEnd=C}function S(_,E){b(i=_,E),a=f,o=d,s=h,u=p,l=g,m.point=b}function C(){n(f,d,c,h,p,g,a,o,i,s,u,l,Uce,r),m.lineEnd=x,x()}return m}}var ant=Gk({point:function(e,t){this.stream.point(e*Kt,t*Kt)}});function ont(e){return Gk({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function snt(e,t,n,r,i){function a(o,s){return o*=r,s*=i,[t+e*o,n-e*s]}return a.invert=function(o,s){return[(o-t)/e*r,(n-s)/e*i]},a}function Vce(e,t,n,r,i,a){if(!a)return snt(e,t,n,r,i);var o=yt(a),s=ct(a),u=o*e,l=s*e,c=o/e,f=s/e,d=(s*n-o*t)/e,h=(s*t+o*n)/e;function p(g,m){return g*=r,m*=i,[u*g-l*m+t,n-l*g-u*m]}return p.invert=function(g,m){return[r*(c*g-f*m+d),i*(h-f*g-c*m)]},p}function yl(e){return qce(function(){return e})()}function qce(e){var t,n=150,r=480,i=250,a=0,o=0,s=0,u=0,l=0,c,f=0,d=1,h=1,p=null,g=Sce,m=null,v,y,b,x=bx,w=.5,S,C,_,E,A;function k(O){return _(O[0]*Kt,O[1]*Kt)}function T(O){return O=_.invert(O[0],O[1]),O&&[O[0]*Lr,O[1]*Lr]}k.stream=function(O){return E&&A===O?E:E=ant(ont(c)(g(S(x(A=O)))))},k.preclip=function(O){return arguments.length?(g=O,p=void 0,N()):g},k.postclip=function(O){return arguments.length?(x=O,m=v=y=b=null,N()):x},k.clipAngle=function(O){return arguments.length?(g=+O?Wtt(p=O*Kt):(p=null,Sce),N()):p*Lr},k.clipExtent=function(O){return arguments.length?(x=O==null?(m=v=y=b=null,bx):Ece(m=+O[0][0],v=+O[0][1],y=+O[1][0],b=+O[1][1]),N()):m==null?null:[[m,v],[y,b]]},k.scale=function(O){return arguments.length?(n=+O,I()):n},k.translate=function(O){return arguments.length?(r=+O[0],i=+O[1],I()):[r,i]},k.center=function(O){return arguments.length?(a=O[0]%360*Kt,o=O[1]%360*Kt,I()):[a*Lr,o*Lr]},k.rotate=function(O){return arguments.length?(s=O[0]%360*Kt,u=O[1]%360*Kt,l=O.length>2?O[2]%360*Kt:0,I()):[s*Lr,u*Lr,l*Lr]},k.angle=function(O){return arguments.length?(f=O%360*Kt,I()):f*Lr},k.reflectX=function(O){return arguments.length?(d=O?-1:1,I()):d<0},k.reflectY=function(O){return arguments.length?(h=O?-1:1,I()):h<0},k.precision=function(O){return arguments.length?(S=Wce(C,w=O*O),N()):Fa(w)},k.fitExtent=function(O,D){return Kk(k,O,D)},k.fitSize=function(O,D){return A5(k,O,D)},k.fitWidth=function(O,D){return k5(k,O,D)},k.fitHeight=function(O,D){return T5(k,O,D)};function I(){var O=Vce(n,0,0,d,h,f).apply(null,t(a,o)),D=Vce(n,r-O[0],i-O[1],d,h,f);return c=pce(s,u,l),C=f5(t,D),_=f5(c,C),S=Wce(C,w),N()}function N(){return E=A=null,k}return function(){return t=e.apply(this,arguments),k.invert=t.invert&&T,I()}}function O5(e){var t=0,n=Gt/3,r=qce(e),i=r(t,n);return i.parallels=function(a){return arguments.length?r(t=a[0]*Kt,n=a[1]*Kt):[t*Lr,n*Lr]},i}function unt(e){var t=yt(e);function n(r,i){return[r*t,ct(i)/t]}return n.invert=function(r,i){return[r/t,co(i*t)]},n}function lnt(e,t){var n=ct(e),r=(n+ct(t))/2;if(hn(r)<mt)return unt(e);var i=1+n*(2*r-n),a=Fa(i)/r;function o(s,u){var l=Fa(i-2*r*ct(u))/r;return[l*ct(s*=r),a-l*yt(s)]}return o.invert=function(s,u){var l=a-u,c=gs(s,hn(l))*ms(l);return l*r<0&&(c-=Gt*ms(s)*ms(l)),[c/r,co((i-(s*s+l*l)*r*r)/(2*r))]},o}function Xk(){return O5(lnt).scale(155.424).center([0,33.6442])}function Hce(){return Xk().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function cnt(e){var t=e.length;return{point:function(n,r){for(var i=-1;++i<t;)e[i].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function fnt(){var e,t,n=Hce(),r,i=Xk().rotate([154,0]).center([-2,58.5]).parallels([55,65]),a,o=Xk().rotate([157,0]).center([-3,19.9]).parallels([8,18]),s,u,l={point:function(d,h){u=[d,h]}};function c(d){var h=d[0],p=d[1];return u=null,r.point(h,p),u||(a.point(h,p),u)||(s.point(h,p),u)}c.invert=function(d){var h=n.scale(),p=n.translate(),g=(d[0]-p[0])/h,m=(d[1]-p[1])/h;return(m>=.12&&m<.234&&g>=-.425&&g<-.214?i:m>=.166&&m<.234&&g>=-.214&&g<-.115?o:n).invert(d)},c.stream=function(d){return e&&t===d?e:e=cnt([n.stream(t=d),i.stream(d),o.stream(d)])},c.precision=function(d){return arguments.length?(n.precision(d),i.precision(d),o.precision(d),f()):n.precision()},c.scale=function(d){return arguments.length?(n.scale(d),i.scale(d*.35),o.scale(d),c.translate(n.translate())):n.scale()},c.translate=function(d){if(!arguments.length)return n.translate();var h=n.scale(),p=+d[0],g=+d[1];return r=n.translate(d).clipExtent([[p-.455*h,g-.238*h],[p+.455*h,g+.238*h]]).stream(l),a=i.translate([p-.307*h,g+.201*h]).clipExtent([[p-.425*h+mt,g+.12*h+mt],[p-.214*h-mt,g+.234*h-mt]]).stream(l),s=o.translate([p-.205*h,g+.212*h]).clipExtent([[p-.214*h+mt,g+.166*h+mt],[p-.115*h-mt,g+.234*h-mt]]).stream(l),f()},c.fitExtent=function(d,h){return Kk(c,d,h)},c.fitSize=function(d,h){return A5(c,d,h)},c.fitWidth=function(d,h){return k5(c,d,h)},c.fitHeight=function(d,h){return T5(c,d,h)};function f(){return e=t=null,c}return c.scale(1070)}function Gce(e){return function(t,n){var r=yt(t),i=yt(n),a=e(r*i);return a===1/0?[2,0]:[a*i*ct(t),a*ct(n)]}}function Ax(e){return function(t,n){var r=Fa(t*t+n*n),i=e(r),a=ct(i),o=yt(i);return[gs(t*a,r*o),co(r&&n*a/r)]}}var Kce=Gce(function(e){return Fa(2/(1+e))});Kce.invert=Ax(function(e){return 2*co(e/2)});function dnt(){return yl(Kce).scale(124.75).clipAngle(180-.001)}var Xce=Gce(function(e){return(e=Xle(e))&&e/ct(e)});Xce.invert=Ax(function(e){return e});function hnt(){return yl(Xce).scale(79.4188).clipAngle(180-.001)}function Yk(e,t){return[e,Ek(e5((Or+t)/2))]}Yk.invert=function(e,t){return[e,2*qv(Kle(t))-Or]};function pnt(){return Yce(Yk).scale(961/Ra)}function Yce(e){var t=yl(e),n=t.center,r=t.scale,i=t.translate,a=t.clipExtent,o=null,s,u,l;t.scale=function(f){return arguments.length?(r(f),c()):r()},t.translate=function(f){return arguments.length?(i(f),c()):i()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(f==null?o=s=u=l=null:(o=+f[0][0],s=+f[0][1],u=+f[1][0],l=+f[1][1]),c()):o==null?null:[[o,s],[u,l]]};function c(){var f=Gt*r(),d=t(Mtt(t.rotate()).invert([0,0]));return a(o==null?[[d[0]-f,d[1]-f],[d[0]+f,d[1]+f]]:e===Yk?[[Math.max(d[0]-f,o),s],[Math.min(d[0]+f,u),l]]:[[o,Math.max(d[1]-f,s)],[u,Math.min(d[1]+f,l)]])}return c()}function Zk(e){return e5((Or+e)/2)}function gnt(e,t){var n=yt(e),r=e===t?ct(e):Ek(n/yt(t))/Ek(Zk(t)/Zk(e)),i=n*Qz(Zk(e),r)/r;if(!r)return Yk;function a(o,s){i>0?s<-Or+mt&&(s=-Or+mt):s>Or-mt&&(s=Or-mt);var u=i/Qz(Zk(s),r);return[u*ct(r*o),i-u*yt(r*o)]}return a.invert=function(o,s){var u=i-s,l=ms(r)*Fa(o*o+u*u),c=gs(o,hn(u))*ms(u);return u*r<0&&(c-=Gt*ms(o)*ms(u)),[c/r,2*qv(Qz(i/l,1/r))-Or]},a}function mnt(){return O5(gnt).scale(109.5).parallels([30,30])}function Jk(e,t){return[e,t]}Jk.invert=Jk;function vnt(){return yl(Jk).scale(152.63)}function ynt(e,t){var n=yt(e),r=e===t?ct(e):(n-yt(t))/(t-e),i=n/r+e;if(hn(r)<mt)return Jk;function a(o,s){var u=i-s,l=r*o;return[u*ct(l),i-u*yt(l)]}return a.invert=function(o,s){var u=i-s,l=gs(o,hn(u))*ms(u);return u*r<0&&(l-=Gt*ms(o)*ms(u)),[l/r,i-ms(r)*Fa(o*o+u*u)]},a}function bnt(){return O5(ynt).scale(131.154).center([0,13.9389])}var kx=1.340264,Tx=-.081106,Ox=893e-6,Ix=.003796,Qk=Fa(3)/2,xnt=12;function Zce(e,t){var n=co(Qk*ct(t)),r=n*n,i=r*r*r;return[e*yt(n)/(Qk*(kx+3*Tx*r+i*(7*Ox+9*Ix*r))),n*(kx+Tx*r+i*(Ox+Ix*r))]}Zce.invert=function(e,t){for(var n=t,r=n*n,i=r*r*r,a=0,o,s,u;a<xnt&&(s=n*(kx+Tx*r+i*(Ox+Ix*r))-t,u=kx+3*Tx*r+i*(7*Ox+9*Ix*r),n-=o=s/u,r=n*n,i=r*r*r,!(hn(o)<wk));++a);return[Qk*e*(kx+3*Tx*r+i*(7*Ox+9*Ix*r))/yt(n),co(ct(n)/Qk)]};function wnt(){return yl(Zce).scale(177.158)}function Jce(e,t){var n=yt(t),r=yt(e)*n;return[n*ct(e)/r,ct(t)/r]}Jce.invert=Ax(qv);function _nt(){return yl(Jce).scale(144.049).clipAngle(60)}function Snt(){var e=1,t=0,n=0,r=1,i=1,a=0,o,s,u=null,l,c,f,d=1,h=1,p=Gk({point:function(x,w){var S=b([x,w]);this.stream.point(S[0],S[1])}}),g=bx,m,v;function y(){return d=e*r,h=e*i,m=v=null,b}function b(x){var w=x[0]*d,S=x[1]*h;if(a){var C=S*o-w*s;w=w*o+S*s,S=C}return[w+t,S+n]}return b.invert=function(x){var w=x[0]-t,S=x[1]-n;if(a){var C=S*o+w*s;w=w*o-S*s,S=C}return[w/d,S/h]},b.stream=function(x){return m&&v===x?m:m=p(g(v=x))},b.postclip=function(x){return arguments.length?(g=x,u=l=c=f=null,y()):g},b.clipExtent=function(x){return arguments.length?(g=x==null?(u=l=c=f=null,bx):Ece(u=+x[0][0],l=+x[0][1],c=+x[1][0],f=+x[1][1]),y()):u==null?null:[[u,l],[c,f]]},b.scale=function(x){return arguments.length?(e=+x,y()):e},b.translate=function(x){return arguments.length?(t=+x[0],n=+x[1],y()):[t,n]},b.angle=function(x){return arguments.length?(a=x%360*Kt,s=ct(a),o=yt(a),y()):a*Lr},b.reflectX=function(x){return arguments.length?(r=x?-1:1,y()):r<0},b.reflectY=function(x){return arguments.length?(i=x?-1:1,y()):i<0},b.fitExtent=function(x,w){return Kk(b,x,w)},b.fitSize=function(x,w){return A5(b,x,w)},b.fitWidth=function(x,w){return k5(b,x,w)},b.fitHeight=function(x,w){return T5(b,x,w)},b}function Qce(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}Qce.invert=function(e,t){var n=t,r=25,i;do{var a=n*n,o=a*a;n-=i=(n*(1.007226+a*(.015085+o*(-.044475+.028874*a-.005916*o)))-t)/(1.007226+a*(.015085*3+o*(-.044475*7+.028874*9*a-.005916*11*o)))}while(hn(i)>mt&&--r>0);return[e/(.8707+(a=n*n)*(-.131979+a*(-.013791+a*a*a*(.003971-.001529*a)))),n]};function Ent(){return yl(Qce).scale(175.295)}function efe(e,t){return[yt(t)*ct(e),ct(t)]}efe.invert=Ax(co);function Cnt(){return yl(efe).scale(249.5).clipAngle(90+mt)}function tfe(e,t){var n=yt(t),r=1+yt(e)*n;return[n*ct(e)/r,ct(t)/r]}tfe.invert=Ax(function(e){return 2*qv(e)});function Ant(){return yl(tfe).scale(250).clipAngle(142)}function nfe(e,t){return[Ek(e5((Or+t)/2)),-e]}nfe.invert=function(e,t){return[-t,2*qv(Kle(e))-Or]};function knt(){var e=Yce(nfe),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}var Tnt=Math.abs,I5=Math.cos,eT=Math.sin,Ont=1e-6,rfe=Math.PI,N5=rfe/2,ife=Int(2);function afe(e){return e>1?N5:e<-1?-N5:Math.asin(e)}function Int(e){return e>0?Math.sqrt(e):0}function Nnt(e,t){var n=e*eT(t),r=30,i;do t-=i=(t+eT(t)-n)/(1+I5(t));while(Tnt(i)>Ont&&--r>0);return t/2}function Dnt(e,t,n){function r(i,a){return[e*i*I5(a=Nnt(n,a)),t*eT(a)]}return r.invert=function(i,a){return a=afe(a/t),[i/(e*I5(a)),afe((2*a+eT(2*a))/n)]},r}var Rnt=Dnt(ife/N5,ife,rfe);function Fnt(){return yl(Rnt).scale(169.529)}const Mnt=jce(),D5=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function Pnt(e,t){return function n(){const r=t();return r.type=e,r.path=jce().projection(r),r.copy=r.copy||function(){const i=n();return D5.forEach(a=>{r[a]&&i[a](r[a]())}),i.path.pointRadius(r.path.pointRadius()),i},r}}function R5(e,t){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(tT[e]=Pnt(e,t),this):tT[e]||null}function ofe(e){return e&&e.path||Mnt}const tT={albers:Hce,albersusa:fnt,azimuthalequalarea:dnt,azimuthalequidistant:hnt,conicconformal:mnt,conicequalarea:Xk,conicequidistant:bnt,equalEarth:wnt,equirectangular:vnt,gnomonic:_nt,identity:Snt,mercator:pnt,mollweide:Fnt,naturalEarth1:Ent,orthographic:Cnt,stereographic:Ant,transversemercator:knt};for(const e in tT)R5(e,tT[e]);function $nt(){}const Fc=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function sfe(){var e=1,t=1,n=s;function r(u,l){return l.map(c=>i(u,c))}function i(u,l){var c=[],f=[];return a(u,l,d=>{n(d,u,l),Lnt(d)>0?c.push([d]):f.push(d)}),f.forEach(d=>{for(var h=0,p=c.length,g;h<p;++h)if(Bnt((g=c[h])[0],d)!==-1){g.push(d);return}}),{type:"MultiPolygon",value:l,coordinates:c}}function a(u,l,c){var f=new Array,d=new Array,h,p,g,m,v,y;for(h=p=-1,m=u[0]>=l,Fc[m<<1].forEach(b);++h<e-1;)g=m,m=u[h+1]>=l,Fc[g|m<<1].forEach(b);for(Fc[m<<0].forEach(b);++p<t-1;){for(h=-1,m=u[p*e+e]>=l,v=u[p*e]>=l,Fc[m<<1|v<<2].forEach(b);++h<e-1;)g=m,m=u[p*e+e+h+1]>=l,y=v,v=u[p*e+h+1]>=l,Fc[g|m<<1|v<<2|y<<3].forEach(b);Fc[m|v<<3].forEach(b)}for(h=-1,v=u[p*e]>=l,Fc[v<<2].forEach(b);++h<e-1;)y=v,v=u[p*e+h+1]>=l,Fc[v<<2|y<<3].forEach(b);Fc[v<<3].forEach(b);function b(x){var w=[x[0][0]+h,x[0][1]+p],S=[x[1][0]+h,x[1][1]+p],C=o(w),_=o(S),E,A;(E=d[C])?(A=f[_])?(delete d[E.end],delete f[A.start],E===A?(E.ring.push(S),c(E.ring)):f[E.start]=d[A.end]={start:E.start,end:A.end,ring:E.ring.concat(A.ring)}):(delete d[E.end],E.ring.push(S),d[E.end=_]=E):(E=f[_])?(A=d[C])?(delete f[E.start],delete d[A.end],E===A?(E.ring.push(S),c(E.ring)):f[A.start]=d[E.end]={start:A.start,end:E.end,ring:A.ring.concat(E.ring)}):(delete f[E.start],E.ring.unshift(w),f[E.start=C]=E):f[C]=d[_]={start:C,end:_,ring:[w,S]}}}function o(u){return u[0]*2+u[1]*(e+1)*4}function s(u,l,c){u.forEach(f=>{var d=f[0],h=f[1],p=d|0,g=h|0,m,v=l[g*e+p];d>0&&d<e&&p===d&&(m=l[g*e+p-1],f[0]=d+(c-m)/(v-m)-.5),h>0&&h<t&&g===h&&(m=l[(g-1)*e+p],f[1]=h+(c-m)/(v-m)-.5)})}return r.contour=i,r.size=function(u){if(!arguments.length)return[e,t];var l=Math.floor(u[0]),c=Math.floor(u[1]);return l>=0&&c>=0||Se("invalid size"),e=l,t=c,r},r.smooth=function(u){return arguments.length?(n=u?s:$nt,r):n===s},r}function Lnt(e){for(var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}function Bnt(e,t){for(var n=-1,r=t.length,i;++n<r;)if(i=znt(e,t[n]))return i;return 0}function znt(e,t){for(var n=t[0],r=t[1],i=-1,a=0,o=e.length,s=o-1;a<o;s=a++){var u=e[a],l=u[0],c=u[1],f=e[s],d=f[0],h=f[1];if(jnt(u,f,t))return 0;c>r!=h>r&&n<(d-l)*(r-c)/(h-c)+l&&(i=-i)}return i}function jnt(e,t,n){var r;return Unt(e,t,n)&&Wnt(e[r=+(e[0]===t[0])],n[r],t[r])}function Unt(e,t,n){return(t[0]-e[0])*(n[1]-e[1])==(n[0]-e[0])*(t[1]-e[1])}function Wnt(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function ufe(e,t,n){return function(r){var i=tl(r),a=n?Math.min(i[0],0):i[0],o=i[1],s=o-a,u=t?id(a,o,e):s/(e+1);return Bo(a+u,o,u)}}function F5(e){ve.call(this,null,e)}F5.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},$e(F5,ve,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=e.field||Oa,a=sfe().smooth(e.smooth!==!1),o=e.thresholds||Vnt(r,i,e),s=e.as===null?null:e.as||"contour",u=[];return r.forEach(l=>{const c=i(l),f=a.size([c.width,c.height])(c.values,ut(o)?o:o(c.values));qnt(f,c,l,e),f.forEach(d=>{u.push(tA(l,In(s!=null?{[s]:d}:d)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function Vnt(e,t,n){const r=ufe(n.levels||10,n.nice,n.zero!==!1);return n.resolve!=="shared"?r:r(e.map(i=>fp(t(i).values)))}function qnt(e,t,n,r){let i=r.scale||t.scale,a=r.translate||t.translate;if(Lt(i)&&(i=i(n,r)),Lt(a)&&(a=a(n,r)),(i===1||i==null)&&!a)return;const o=(td(i)?i:i[0])||1,s=(td(i)?i:i[1])||1,u=a&&a[0]||0,l=a&&a[1]||0;e.forEach(lfe(t,o,s,u,l))}function lfe(e,t,n,r,i){const a=e.x1||0,o=e.y1||0,s=t*n<0;function u(f){f.forEach(l)}function l(f){s&&f.reverse(),f.forEach(c)}function c(f){f[0]=(f[0]-a)*t+r,f[1]=(f[1]-o)*n+i}return function(f){return f.coordinates.forEach(u),f}}function cfe(e,t,n){const r=e>=0?e:rL(t,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function M5(e){return Lt(e)?e:Ji(+e)}function ffe(){var e=u=>u[0],t=u=>u[1],n=cv,r=[-1,-1],i=960,a=500,o=2;function s(u,l){const c=cfe(r[0],u,e)>>o,f=cfe(r[1],u,t)>>o,d=c?c+2:0,h=f?f+2:0,p=2*d+(i>>o),g=2*h+(a>>o),m=new Float32Array(p*g),v=new Float32Array(p*g);let y=m;u.forEach(x=>{const w=d+(+e(x)>>o),S=h+(+t(x)>>o);w>=0&&w<p&&S>=0&&S<g&&(m[w+S*p]+=+n(x))}),c>0&&f>0?(Yv(p,g,m,v,c),Zv(p,g,v,m,f),Yv(p,g,m,v,c),Zv(p,g,v,m,f),Yv(p,g,m,v,c),Zv(p,g,v,m,f)):c>0?(Yv(p,g,m,v,c),Yv(p,g,v,m,c),Yv(p,g,m,v,c),y=v):f>0&&(Zv(p,g,m,v,f),Zv(p,g,v,m,f),Zv(p,g,m,v,f),y=v);const b=l?Math.pow(2,-2*o):1/Ere(y);for(let x=0,w=p*g;x<w;++x)y[x]*=b;return{values:y,scale:1<<o,width:p,height:g,x1:d,y1:h,x2:d+(i>>o),y2:h+(a>>o)}}return s.x=function(u){return arguments.length?(e=M5(u),s):e},s.y=function(u){return arguments.length?(t=M5(u),s):t},s.weight=function(u){return arguments.length?(n=M5(u),s):n},s.size=function(u){if(!arguments.length)return[i,a];var l=+u[0],c=+u[1];return l>=0&&c>=0||Se("invalid size"),i=l,a=c,s},s.cellSize=function(u){return arguments.length?((u=+u)>=1||Se("invalid cell size"),o=Math.floor(Math.log(u)/Math.LN2),s):1<<o},s.bandwidth=function(u){return arguments.length?(u=wt(u),u.length===1&&(u=[+u[0],+u[0]]),u.length!==2&&Se("invalid bandwidth"),r=u,s):r},s}function Yv(e,t,n,r,i){const a=(i<<1)+1;for(let o=0;o<t;++o)for(let s=0,u=0;s<e+i;++s)s<e&&(u+=n[s+o*e]),s>=i&&(s>=a&&(u-=n[s-a+o*e]),r[s-i+o*e]=u/Math.min(s+1,e-1+a-s,a))}function Zv(e,t,n,r,i){const a=(i<<1)+1;for(let o=0;o<e;++o)for(let s=0,u=0;s<t+i;++s)s<t&&(u+=n[o+s*e]),s>=i&&(s>=a&&(u-=n[o+(s-a)*e]),r[o+(s-i)*e]=u/Math.min(s+1,t-1+a-s,a))}function P5(e){ve.call(this,null,e)}P5.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const Hnt=["x","y","weight","size","cellSize","bandwidth"];function dfe(e,t){return Hnt.forEach(n=>t[n]!=null?e[n](t[n]):0),e}$e(P5,ve,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,i=Gnt(r,e.groupby),a=(e.groupby||[]).map(Tr),o=dfe(ffe(),e),s=e.as||"grid",u=[];function l(c,f){for(let d=0;d<a.length;++d)c[a[d]]=f[d];return c}return u=i.map(c=>In(l({[s]:o(c,e.counts)},c.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function Gnt(e,t){var n=[],r=c=>c(s),i,a,o,s,u,l;if(t==null)n.push(e);else for(i={},a=0,o=e.length;a<o;++a)s=e[a],u=t.map(r),l=i[u],l||(i[u]=l=[],l.dims=u,n.push(l)),l.push(s);return n}function $5(e){ve.call(this,null,e)}$5.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},$e($5,ve,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=sfe().smooth(e.smooth!==!1),i=e.values,a=e.thresholds||ufe(e.count||10,e.nice,!!i),o=e.size,s,u;return i||(i=t.materialize(t.SOURCE).source,s=dfe(ffe(),e)(i,!0),u=lfe(s,s.scale||1,s.scale||1,0,0),o=[s.width,s.height],i=s.values),a=ut(a)?a:a(i),i=r.size(o)(i,a),u&&i.forEach(u),this.value&&(n.rem=this.value),this.value=n.source=n.add=(i||[]).map(In),n}});const L5="Feature",B5="FeatureCollection",Knt="MultiPoint";function z5(e){ve.call(this,null,e)}z5.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},$e(z5,ve,{transform(e,t){var n=this._features,r=this._points,i=e.fields,a=i&&i[0],o=i&&i[1],s=e.geojson||!i&&Oa,u=t.ADD,l;l=e.modified()||t.changed(t.REM)||t.modified(Yi(s))||a&&t.modified(Yi(a))||o&&t.modified(Yi(o)),(!this.value||l)&&(u=t.SOURCE,this._features=n=[],this._points=r=[]),s&&t.visit(u,c=>n.push(s(c))),a&&o&&(t.visit(u,c=>{var f=a(c),d=o(c);f!=null&&d!=null&&(f=+f)===f&&(d=+d)===d&&r.push([f,d])}),n=n.concat({type:L5,geometry:{type:Knt,coordinates:r}})),this.value={type:B5,features:n}}});function j5(e){ve.call(this,null,e)}j5.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},$e(j5,ve,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.field||Oa,a=e.as||"path",o=n.SOURCE;!r||e.modified()?(this.value=r=ofe(e.projection),n.materialize().reflow()):o=i===Oa||t.modified(i.fields)?n.ADD_MOD:n.ADD;const s=Xnt(r,e.pointRadius);return n.visit(o,u=>u[a]=r(i(u))),r.pointRadius(s),n.modifies(a)}});function Xnt(e,t){const n=e.pointRadius();return e.context(null),t!=null&&e.pointRadius(t),n}function U5(e){ve.call(this,null,e)}U5.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},$e(U5,ve,{transform(e,t){var n=e.projection,r=e.fields[0],i=e.fields[1],a=e.as||["x","y"],o=a[0],s=a[1],u;function l(c){const f=n([r(c),i(c)]);f?(c[o]=f[0],c[s]=f[1]):(c[o]=void 0,c[s]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,l):(u=t.modified(r.fields)||t.modified(i.fields),t.visit(u?t.ADD_MOD:t.ADD,l)),t.modifies(a)}});function W5(e){ve.call(this,null,e)}W5.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},$e(W5,ve,{transform(e,t){var n=t.fork(t.ALL),r=this.value,i=e.as||"shape",a=n.ADD;return(!r||e.modified())&&(this.value=r=Ynt(ofe(e.projection),e.field||io("datum"),e.pointRadius),n.materialize().reflow(),a=n.SOURCE),n.visit(a,o=>o[i]=r),n.modifies(i)}});function Ynt(e,t,n){const r=n==null?i=>e(t(i)):i=>{var a=e.pointRadius(),o=e.pointRadius(n)(t(i));return e.pointRadius(a),o};return r.context=i=>(e.context(i),r),r}function V5(e){ve.call(this,[],e),this.generator=qtt()}V5.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},$e(V5,ve,{transform(e,t){var n=this.value,r=this.generator,i;if(!n.length||e.modified())for(const a in e)Lt(r[a])&&r[a](e[a]);return i=r(),n.length?t.mod.push(Nie(n[0],i)):t.add.push(In(i)),n[0]=i,t}});function q5(e){ve.call(this,null,e)}q5.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},$e(q5,ve,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,r=e.resolve==="shared",i=e.field||Oa,a=Jnt(e.opacity,e),o=Znt(e.color,e),s=e.as||"image",u={$x:0,$y:0,$value:0,$max:r?fp(n.map(l=>fp(i(l).values))):0};return n.forEach(l=>{const c=i(l),f=Rt({},l,u);r||(f.$max=fp(c.values||[])),l[s]=Qnt(c,f,o.dep?o:Ji(o(f)),a.dep?a:Ji(a(f)))}),t.reflow(!0).modifies(s)}});function Znt(e,t){let n;return Lt(e)?(n=r=>gd(e(r,t)),n.dep=hfe(e)):n=Ji(gd(e||"#888")),n}function Jnt(e,t){let n;return Lt(e)?(n=r=>e(r,t),n.dep=hfe(e)):e?n=Ji(e):(n=r=>r.$value/r.$max||0,n.dep=!0),n}function hfe(e){if(!Lt(e))return!1;const t=nu(Yi(e));return t.$x||t.$y||t.$value||t.$max}function Qnt(e,t,n,r){const i=e.width,a=e.height,o=e.x1||0,s=e.y1||0,u=e.x2||i,l=e.y2||a,c=e.values,f=c?m=>c[m]:Jf,d=Cv(u-o,l-s),h=d.getContext("2d"),p=h.getImageData(0,0,u-o,l-s),g=p.data;for(let m=s,v=0;m<l;++m){t.$y=m-s;for(let y=o,b=m*i;y<u;++y,v+=4){t.$x=y-o,t.$value=f(y+b);const x=n(t);g[v+0]=x.r,g[v+1]=x.g,g[v+2]=x.b,g[v+3]=~~(255*r(t))}}return h.putImageData(p,0,0),d}function pfe(e){ve.call(this,null,e),this.modified(!0)}$e(pfe,ve,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=trt(e.type),D5.forEach(r=>{e[r]!=null&&gfe(n,r,e[r])})):D5.forEach(r=>{e.modified(r)&&gfe(n,r,e[r])}),e.pointRadius!=null&&n.path.pointRadius(e.pointRadius),e.fit&&ert(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function ert(e,t){const n=nrt(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}function trt(e){const t=R5((e||"mercator").toLowerCase());return t||Se("Unrecognized projection type: "+e),t()}function gfe(e,t,n){Lt(e[t])&&e[t](n)}function nrt(e){return e=wt(e),e.length===1?e[0]:{type:B5,features:e.reduce((t,n)=>t.concat(rrt(n)),[])}}function rrt(e){return e.type===B5?e.features:wt(e).filter(t=>t!=null).map(t=>t.type===L5?t:{type:L5,geometry:t})}var irt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",contour:$5,geojson:z5,geopath:j5,geopoint:U5,geoshape:W5,graticule:V5,heatmap:q5,isocontour:F5,kde2d:P5,projection:pfe});function art(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function i(){var a,o=n.length,s,u=0,l=0;for(a=0;a<o;++a)s=n[a],u+=s.x,l+=s.y;for(u=(u/o-e)*r,l=(l/o-t)*r,a=0;a<o;++a)s=n[a],s.x-=u,s.y-=l}return i.initialize=function(a){n=a},i.x=function(a){return arguments.length?(e=+a,i):e},i.y=function(a){return arguments.length?(t=+a,i):t},i.strength=function(a){return arguments.length?(r=+a,i):r},i}function ort(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return mfe(this.cover(t,n),t,n,e)}function mfe(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,a=e._root,o={data:r},s=e._x0,u=e._y0,l=e._x1,c=e._y1,f,d,h,p,g,m,v,y;if(!a)return e._root=o,e;for(;a.length;)if((g=t>=(f=(s+l)/2))?s=f:l=f,(m=n>=(d=(u+c)/2))?u=d:c=d,i=a,!(a=a[v=m<<1|g]))return i[v]=o,e;if(h=+e._x.call(null,a.data),p=+e._y.call(null,a.data),t===h&&n===p)return o.next=a,i?i[v]=o:e._root=o,e;do i=i?i[v]=new Array(4):e._root=new Array(4),(g=t>=(f=(s+l)/2))?s=f:l=f,(m=n>=(d=(u+c)/2))?u=d:c=d;while((v=m<<1|g)==(y=(p>=d)<<1|h>=f));return i[y]=a,i[v]=o,e}function srt(e){var t,n,r=e.length,i,a,o=new Array(r),s=new Array(r),u=1/0,l=1/0,c=-1/0,f=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(a=+this._y.call(null,t))||(o[n]=i,s[n]=a,i<u&&(u=i),i>c&&(c=i),a<l&&(l=a),a>f&&(f=a));if(u>c||l>f)return this;for(this.cover(u,l).cover(c,f),n=0;n<r;++n)mfe(this,o[n],s[n],e[n]);return this}function urt(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,a=(r=Math.floor(t))+1;else{for(var o=i-n||1,s=this._root,u,l;n>e||e>=i||r>t||t>=a;)switch(l=(t<r)<<1|e<n,u=new Array(4),u[l]=s,s=u,o*=2,l){case 0:i=n+o,a=r+o;break;case 1:n=i-o,a=r+o;break;case 2:i=n+o,r=a-o;break;case 3:n=i-o,r=a-o;break}this._root&&this._root.length&&(this._root=s)}return this._x0=n,this._y0=r,this._x1=i,this._y1=a,this}function lrt(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function crt(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function La(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function frt(e,t,n){var r,i=this._x0,a=this._y0,o,s,u,l,c=this._x1,f=this._y1,d=[],h=this._root,p,g;for(h&&d.push(new La(h,i,a,c,f)),n==null?n=1/0:(i=e-n,a=t-n,c=e+n,f=t+n,n*=n);p=d.pop();)if(!(!(h=p.node)||(o=p.x0)>c||(s=p.y0)>f||(u=p.x1)<i||(l=p.y1)<a))if(h.length){var m=(o+u)/2,v=(s+l)/2;d.push(new La(h[3],m,v,u,l),new La(h[2],o,v,m,l),new La(h[1],m,s,u,v),new La(h[0],o,s,m,v)),(g=(t>=v)<<1|e>=m)&&(p=d[d.length-1],d[d.length-1]=d[d.length-1-g],d[d.length-1-g]=p)}else{var y=e-+this._x.call(null,h.data),b=t-+this._y.call(null,h.data),x=y*y+b*b;if(x<n){var w=Math.sqrt(n=x);i=e-w,a=t-w,c=e+w,f=t+w,r=h.data}}return r}function drt(e){if(isNaN(c=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,n=this._root,r,i,a,o=this._x0,s=this._y0,u=this._x1,l=this._y1,c,f,d,h,p,g,m,v;if(!n)return this;if(n.length)for(;;){if((p=c>=(d=(o+u)/2))?o=d:u=d,(g=f>=(h=(s+l)/2))?s=h:l=h,t=n,!(n=n[m=g<<1|p]))return this;if(!n.length)break;(t[m+1&3]||t[m+2&3]||t[m+3&3])&&(r=t,v=m)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(a=n.next)&&delete n.next,i?(a?i.next=a:delete i.next,this):t?(a?t[m]=a:delete t[m],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[v]=n:this._root=n),this):(this._root=a,this)}function hrt(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function prt(){return this._root}function grt(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function mrt(e){var t=[],n,r=this._root,i,a,o,s,u;for(r&&t.push(new La(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,a=n.x0,o=n.y0,s=n.x1,u=n.y1)&&r.length){var l=(a+s)/2,c=(o+u)/2;(i=r[3])&&t.push(new La(i,l,c,s,u)),(i=r[2])&&t.push(new La(i,a,c,l,u)),(i=r[1])&&t.push(new La(i,l,o,s,c)),(i=r[0])&&t.push(new La(i,a,o,l,c))}return this}function vrt(e){var t=[],n=[],r;for(this._root&&t.push(new La(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var a,o=r.x0,s=r.y0,u=r.x1,l=r.y1,c=(o+u)/2,f=(s+l)/2;(a=i[0])&&t.push(new La(a,o,s,c,f)),(a=i[1])&&t.push(new La(a,c,s,u,f)),(a=i[2])&&t.push(new La(a,o,f,c,l)),(a=i[3])&&t.push(new La(a,c,f,u,l))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function yrt(e){return e[0]}function brt(e){return arguments.length?(this._x=e,this):this._x}function xrt(e){return e[1]}function wrt(e){return arguments.length?(this._y=e,this):this._y}function H5(e,t,n){var r=new G5(t??yrt,n??xrt,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function G5(e,t,n,r,i,a){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function vfe(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var Ba=H5.prototype=G5.prototype;Ba.copy=function(){var e=new G5(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=vfe(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=new Array(4)}):t.target[i]=vfe(r));return e},Ba.add=ort,Ba.addAll=srt,Ba.cover=urt,Ba.data=lrt,Ba.extent=crt,Ba.find=frt,Ba.remove=drt,Ba.removeAll=hrt,Ba.root=prt,Ba.size=grt,Ba.visit=mrt,Ba.visitAfter=vrt,Ba.x=brt,Ba.y=wrt;function za(e){return function(){return e}}function Dd(e){return(e()-.5)*1e-6}function _rt(e){return e.x+e.vx}function Srt(e){return e.y+e.vy}function Ert(e){var t,n,r,i=1,a=1;typeof e!="function"&&(e=za(e==null?1:+e));function o(){for(var l,c=t.length,f,d,h,p,g,m,v=0;v<a;++v)for(f=H5(t,_rt,Srt).visitAfter(s),l=0;l<c;++l)d=t[l],g=n[d.index],m=g*g,h=d.x+d.vx,p=d.y+d.vy,f.visit(y);function y(b,x,w,S,C){var _=b.data,E=b.r,A=g+E;if(_){if(_.index>d.index){var k=h-_.x-_.vx,T=p-_.y-_.vy,I=k*k+T*T;I<A*A&&(k===0&&(k=Dd(r),I+=k*k),T===0&&(T=Dd(r),I+=T*T),I=(A-(I=Math.sqrt(I)))/I*i,d.vx+=(k*=I)*(A=(E*=E)/(m+E)),d.vy+=(T*=I)*A,_.vx-=k*(A=1-A),_.vy-=T*A)}return}return x>h+A||S<h-A||w>p+A||C<p-A}}function s(l){if(l.data)return l.r=n[l.data.index];for(var c=l.r=0;c<4;++c)l[c]&&l[c].r>l.r&&(l.r=l[c].r)}function u(){if(!!t){var l,c=t.length,f;for(n=new Array(c),l=0;l<c;++l)f=t[l],n[f.index]=+e(f,l,t)}}return o.initialize=function(l,c){t=l,r=c,u()},o.iterations=function(l){return arguments.length?(a=+l,o):a},o.strength=function(l){return arguments.length?(i=+l,o):i},o.radius=function(l){return arguments.length?(e=typeof l=="function"?l:za(+l),u(),o):e},o}function Crt(e){return e.index}function yfe(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function Art(e){var t=Crt,n=f,r,i=za(30),a,o,s,u,l,c=1;e==null&&(e=[]);function f(m){return 1/Math.min(s[m.source.index],s[m.target.index])}function d(m){for(var v=0,y=e.length;v<c;++v)for(var b=0,x,w,S,C,_,E,A;b<y;++b)x=e[b],w=x.source,S=x.target,C=S.x+S.vx-w.x-w.vx||Dd(l),_=S.y+S.vy-w.y-w.vy||Dd(l),E=Math.sqrt(C*C+_*_),E=(E-a[b])/E*m*r[b],C*=E,_*=E,S.vx-=C*(A=u[b]),S.vy-=_*A,w.vx+=C*(A=1-A),w.vy+=_*A}function h(){if(!!o){var m,v=o.length,y=e.length,b=new Map(o.map((w,S)=>[t(w,S,o),w])),x;for(m=0,s=new Array(v);m<y;++m)x=e[m],x.index=m,typeof x.source!="object"&&(x.source=yfe(b,x.source)),typeof x.target!="object"&&(x.target=yfe(b,x.target)),s[x.source.index]=(s[x.source.index]||0)+1,s[x.target.index]=(s[x.target.index]||0)+1;for(m=0,u=new Array(y);m<y;++m)x=e[m],u[m]=s[x.source.index]/(s[x.source.index]+s[x.target.index]);r=new Array(y),p(),a=new Array(y),g()}}function p(){if(!!o)for(var m=0,v=e.length;m<v;++m)r[m]=+n(e[m],m,e)}function g(){if(!!o)for(var m=0,v=e.length;m<v;++m)a[m]=+i(e[m],m,e)}return d.initialize=function(m,v){o=m,l=v,h()},d.links=function(m){return arguments.length?(e=m,h(),d):e},d.id=function(m){return arguments.length?(t=m,d):t},d.iterations=function(m){return arguments.length?(c=+m,d):c},d.strength=function(m){return arguments.length?(n=typeof m=="function"?m:za(+m),p(),d):n},d.distance=function(m){return arguments.length?(i=typeof m=="function"?m:za(+m),g(),d):i},d}var krt={value:()=>{}};function bfe(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new nT(n)}function nT(e){this._=e}function Trt(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}nT.prototype=bfe.prototype={constructor:nT,on:function(e,t){var n=this._,r=Trt(e+"",n),i,a=-1,o=r.length;if(arguments.length<2){for(;++a<o;)if((i=(e=r[a]).type)&&(i=Ort(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++a<o;)if(i=(e=r[a]).type)n[i]=xfe(n[i],e.name,t);else if(t==null)for(i in n)n[i]=xfe(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new nT(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,a;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=this._[e],r=0,i=a.length;r<i;++r)a[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,a=r.length;i<a;++i)r[i].value.apply(t,n)}};function Ort(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function xfe(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=krt,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Jv=0,Nx=0,Dx=0,wfe=1e3,rT,Rx,iT=0,Mp=0,aT=0,Fx=typeof performance=="object"&&performance.now?performance:Date,_fe=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function K5(){return Mp||(_fe(Irt),Mp=Fx.now()+aT)}function Irt(){Mp=0}function oT(){this._call=this._time=this._next=null}oT.prototype=Sfe.prototype={constructor:oT,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?K5():+n)+(t==null?0:+t),!this._next&&Rx!==this&&(Rx?Rx._next=this:rT=this,Rx=this),this._call=e,this._time=n,X5()},stop:function(){this._call&&(this._call=null,this._time=1/0,X5())}};function Sfe(e,t,n){var r=new oT;return r.restart(e,t,n),r}function Nrt(){K5(),++Jv;for(var e=rT,t;e;)(t=Mp-e._time)>=0&&e._call.call(null,t),e=e._next;--Jv}function Efe(){Mp=(iT=Fx.now())+aT,Jv=Nx=0;try{Nrt()}finally{Jv=0,Rrt(),Mp=0}}function Drt(){var e=Fx.now(),t=e-iT;t>wfe&&(aT-=t,iT=e)}function Rrt(){for(var e,t=rT,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:rT=n);Rx=e,X5(r)}function X5(e){if(!Jv){Nx&&(Nx=clearTimeout(Nx));var t=e-Mp;t>24?(e<1/0&&(Nx=setTimeout(Efe,e-Fx.now()-aT)),Dx&&(Dx=clearInterval(Dx))):(Dx||(iT=Fx.now(),Dx=setInterval(Drt,wfe)),Jv=1,_fe(Efe))}}function Frt(e,t,n){var r=new oT,i=t;return t==null?(r.restart(e,t,n),r):(r._restart=r.restart,r.restart=function(a,o,s){o=+o,s=s==null?K5():+s,r._restart(function u(l){l+=i,r._restart(u,i+=o,s),a(l)},o,s)},r.restart(e,t,n),r)}const Mrt=1664525,Prt=1013904223,Cfe=4294967296;function $rt(){let e=1;return()=>(e=(Mrt*e+Prt)%Cfe)/Cfe}function Lrt(e){return e.x}function Brt(e){return e.y}var zrt=10,jrt=Math.PI*(3-Math.sqrt(5));function Urt(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),a=0,o=.6,s=new Map,u=Sfe(f),l=bfe("tick","end"),c=$rt();e==null&&(e=[]);function f(){d(),l.call("tick",t),n<r&&(u.stop(),l.call("end",t))}function d(g){var m,v=e.length,y;g===void 0&&(g=1);for(var b=0;b<g;++b)for(n+=(a-n)*i,s.forEach(function(x){x(n)}),m=0;m<v;++m)y=e[m],y.fx==null?y.x+=y.vx*=o:(y.x=y.fx,y.vx=0),y.fy==null?y.y+=y.vy*=o:(y.y=y.fy,y.vy=0);return t}function h(){for(var g=0,m=e.length,v;g<m;++g){if(v=e[g],v.index=g,v.fx!=null&&(v.x=v.fx),v.fy!=null&&(v.y=v.fy),isNaN(v.x)||isNaN(v.y)){var y=zrt*Math.sqrt(.5+g),b=g*jrt;v.x=y*Math.cos(b),v.y=y*Math.sin(b)}(isNaN(v.vx)||isNaN(v.vy))&&(v.vx=v.vy=0)}}function p(g){return g.initialize&&g.initialize(e,c),g}return h(),t={tick:d,restart:function(){return u.restart(f),t},stop:function(){return u.stop(),t},nodes:function(g){return arguments.length?(e=g,h(),s.forEach(p),t):e},alpha:function(g){return arguments.length?(n=+g,t):n},alphaMin:function(g){return arguments.length?(r=+g,t):r},alphaDecay:function(g){return arguments.length?(i=+g,t):+i},alphaTarget:function(g){return arguments.length?(a=+g,t):a},velocityDecay:function(g){return arguments.length?(o=1-g,t):1-o},randomSource:function(g){return arguments.length?(c=g,s.forEach(p),t):c},force:function(g,m){return arguments.length>1?(m==null?s.delete(g):s.set(g,p(m)),t):s.get(g)},find:function(g,m,v){var y=0,b=e.length,x,w,S,C,_;for(v==null?v=1/0:v*=v,y=0;y<b;++y)C=e[y],x=g-C.x,w=m-C.y,S=x*x+w*w,S<v&&(_=C,v=S);return _},on:function(g,m){return arguments.length>1?(l.on(g,m),t):l.on(g)}}}function Wrt(){var e,t,n,r,i=za(-30),a,o=1,s=1/0,u=.81;function l(h){var p,g=e.length,m=H5(e,Lrt,Brt).visitAfter(f);for(r=h,p=0;p<g;++p)t=e[p],m.visit(d)}function c(){if(!!e){var h,p=e.length,g;for(a=new Array(p),h=0;h<p;++h)g=e[h],a[g.index]=+i(g,h,e)}}function f(h){var p=0,g,m,v=0,y,b,x;if(h.length){for(y=b=x=0;x<4;++x)(g=h[x])&&(m=Math.abs(g.value))&&(p+=g.value,v+=m,y+=m*g.x,b+=m*g.y);h.x=y/v,h.y=b/v}else{g=h,g.x=g.data.x,g.y=g.data.y;do p+=a[g.data.index];while(g=g.next)}h.value=p}function d(h,p,g,m){if(!h.value)return!0;var v=h.x-t.x,y=h.y-t.y,b=m-p,x=v*v+y*y;if(b*b/u<x)return x<s&&(v===0&&(v=Dd(n),x+=v*v),y===0&&(y=Dd(n),x+=y*y),x<o&&(x=Math.sqrt(o*x)),t.vx+=v*h.value*r/x,t.vy+=y*h.value*r/x),!0;if(h.length||x>=s)return;(h.data!==t||h.next)&&(v===0&&(v=Dd(n),x+=v*v),y===0&&(y=Dd(n),x+=y*y),x<o&&(x=Math.sqrt(o*x)));do h.data!==t&&(b=a[h.data.index]*r/x,t.vx+=v*b,t.vy+=y*b);while(h=h.next)}return l.initialize=function(h,p){e=h,n=p,c()},l.strength=function(h){return arguments.length?(i=typeof h=="function"?h:za(+h),c(),l):i},l.distanceMin=function(h){return arguments.length?(o=h*h,l):Math.sqrt(o)},l.distanceMax=function(h){return arguments.length?(s=h*h,l):Math.sqrt(s)},l.theta=function(h){return arguments.length?(u=h*h,l):Math.sqrt(u)},l}function Vrt(e){var t=za(.1),n,r,i;typeof e!="function"&&(e=za(e==null?0:+e));function a(s){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vx+=(i[u]-c.x)*r[u]*s}function o(){if(!!n){var s,u=n.length;for(r=new Array(u),i=new Array(u),s=0;s<u;++s)r[s]=isNaN(i[s]=+e(n[s],s,n))?0:+t(n[s],s,n)}}return a.initialize=function(s){n=s,o()},a.strength=function(s){return arguments.length?(t=typeof s=="function"?s:za(+s),o(),a):t},a.x=function(s){return arguments.length?(e=typeof s=="function"?s:za(+s),o(),a):e},a}function qrt(e){var t=za(.1),n,r,i;typeof e!="function"&&(e=za(e==null?0:+e));function a(s){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vy+=(i[u]-c.y)*r[u]*s}function o(){if(!!n){var s,u=n.length;for(r=new Array(u),i=new Array(u),s=0;s<u;++s)r[s]=isNaN(i[s]=+e(n[s],s,n))?0:+t(n[s],s,n)}}return a.initialize=function(s){n=s,o()},a.strength=function(s){return arguments.length?(t=typeof s=="function"?s:za(+s),o(),a):t},a.y=function(s){return arguments.length?(e=typeof s=="function"?s:za(+s),o(),a):e},a}const Afe={center:art,collide:Ert,nbody:Wrt,link:Art,x:Vrt,y:qrt},Mx="forces",Y5=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],Hrt=["static","iterations"],kfe=["x","y","vx","vy"];function Z5(e){ve.call(this,null,e)}Z5.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:kfe}]},$e(Z5,ve,{transform(e,t){var n=this.value,r=t.changed(t.ADD_REM),i=e.modified(Y5),a=e.iterations||300;if(n?(r&&(t.modifies("index"),n.nodes(t.source)),(i||t.changed(t.MOD))&&Tfe(n,e,0,t)):(this.value=n=Krt(t.source,e),n.on("tick",Grt(t.dataflow,this)),e.static||(r=!0,n.tick()),t.modifies("index")),i||r||e.modified(Hrt)||t.changed()&&e.restart){if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/a)),e.static)for(n.stop();--a>=0;)n.tick();else if(n.stopped()&&n.restart(),!r)return t.StopPropagation}return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let s=this._argops,u=0,l=s.length,c;u<l;++u)if(c=s[u],!(c.name!==Mx||c.op._argval.force!=="link")){for(var r=c.op._argops,i=0,a=r.length,o;i<a;++i)if(r[i].name==="links"&&(o=r[i].op.source)){n.pulse(o,n.changeset().reflow());break}}return t.reflow(e.modified()).modifies(kfe)}});function Grt(e,t){return()=>e.touch(t).run()}function Krt(e,t){const n=Urt(e),r=n.stop,i=n.restart;let a=!1;return n.stopped=()=>a,n.restart=()=>(a=!1,i()),n.stop=()=>(a=!0,r()),Tfe(n,t,!0).on("end",()=>a=!0)}function Tfe(e,t,n,r){var i=wt(t.forces),a,o,s,u;for(a=0,o=Y5.length;a<o;++a)s=Y5[a],s!==Mx&&t.modified(s)&&e[s](t[s]);for(a=0,o=i.length;a<o;++a)u=Mx+a,s=n||t.modified(Mx,a)?Yrt(i[a]):r&&Xrt(i[a],r)?e.force(u):null,s&&e.force(u,s);for(o=e.numForces||0;a<o;++a)e.force(Mx+a,null);return e.numForces=i.length,e}function Xrt(e,t){var n,r;for(n in e)if(Lt(r=e[n])&&t.modified(Yi(r)))return 1;return 0}function Yrt(e){var t,n;_t(Afe,e.force)||Se("Unrecognized force: "+e.force),t=Afe[e.force]();for(n in e)Lt(t[n])&&Zrt(t[n],e[n],e);return t}function Zrt(e,t,n){e(Lt(t)?r=>t(r,n):t)}var Jrt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",force:Z5});function Qrt(e,t){return e.parent===t.parent?1:2}function eit(e){return e.reduce(tit,0)/e.length}function tit(e,t){return e+t.x}function nit(e){return 1+e.reduce(rit,0)}function rit(e,t){return Math.max(e,t.y)}function iit(e){for(var t;t=e.children;)e=t[0];return e}function ait(e){for(var t;t=e.children;)e=t[t.length-1];return e}function oit(){var e=Qrt,t=1,n=1,r=!1;function i(a){var o,s=0;a.eachAfter(function(d){var h=d.children;h?(d.x=eit(h),d.y=nit(h)):(d.x=o?s+=e(d,o):0,d.y=0,o=d)});var u=iit(a),l=ait(a),c=u.x-e(u,l)/2,f=l.x+e(l,u)/2;return a.eachAfter(r?function(d){d.x=(d.x-a.x)*t,d.y=(a.y-d.y)*n}:function(d){d.x=(d.x-c)/(f-c)*t,d.y=(1-(a.y?d.y/a.y:1))*n})}return i.separation=function(a){return arguments.length?(e=a,i):e},i.size=function(a){return arguments.length?(r=!1,t=+a[0],n=+a[1],i):r?null:[t,n]},i.nodeSize=function(a){return arguments.length?(r=!0,t=+a[0],n=+a[1],i):r?[t,n]:null},i}function sit(e){var t=0,n=e.children,r=n&&n.length;if(!r)t=1;else for(;--r>=0;)t+=n[r].value;e.value=t}function uit(){return this.eachAfter(sit)}function lit(e,t){let n=-1;for(const r of this)e.call(t,r,++n,this);return this}function cit(e,t){for(var n=this,r=[n],i,a,o=-1;n=r.pop();)if(e.call(t,n,++o,this),i=n.children)for(a=i.length-1;a>=0;--a)r.push(i[a]);return this}function fit(e,t){for(var n=this,r=[n],i=[],a,o,s,u=-1;n=r.pop();)if(i.push(n),a=n.children)for(o=0,s=a.length;o<s;++o)r.push(a[o]);for(;n=i.pop();)e.call(t,n,++u,this);return this}function dit(e,t){let n=-1;for(const r of this)if(e.call(t,r,++n,this))return r}function hit(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n})}function pit(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function git(e){for(var t=this,n=mit(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r}function mit(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;for(e=n.pop(),t=r.pop();e===t;)i=e,e=n.pop(),t=r.pop();return i}function vit(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function yit(){return Array.from(this)}function bit(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function xit(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*wit(){var e=this,t,n=[e],r,i,a;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,r=e.children)for(i=0,a=r.length;i<a;++i)n.push(r[i]);while(n.length)}function J5(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=Eit)):t===void 0&&(t=Sit);for(var n=new Qv(e),r,i=[n],a,o,s,u;r=i.pop();)if((o=t(r.data))&&(u=(o=Array.from(o)).length))for(r.children=o,s=u-1;s>=0;--s)i.push(a=o[s]=new Qv(o[s])),a.parent=r,a.depth=r.depth+1;return n.eachBefore(Ofe)}function _it(){return J5(this).eachBefore(Cit)}function Sit(e){return e.children}function Eit(e){return Array.isArray(e)?e[1]:null}function Cit(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function Ofe(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function Qv(e){this.data=e,this.depth=this.height=0,this.parent=null}Qv.prototype=J5.prototype={constructor:Qv,count:uit,each:lit,eachAfter:fit,eachBefore:cit,find:dit,sum:hit,sort:pit,path:git,ancestors:vit,descendants:yit,leaves:bit,links:xit,copy:_it,[Symbol.iterator]:wit};function Ait(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function kit(e){for(var t=e.length,n,r;t;)r=Math.random()*t--|0,n=e[t],e[t]=e[r],e[r]=n;return e}function Tit(e){for(var t=0,n=(e=kit(Array.from(e))).length,r=[],i,a;t<n;)i=e[t],a&&Ife(a,i)?++t:(a=Iit(r=Oit(r,i)),t=0);return a}function Oit(e,t){var n,r;if(Q5(t,e))return[t];for(n=0;n<e.length;++n)if(sT(t,e[n])&&Q5(Px(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(sT(Px(e[n],e[r]),t)&&sT(Px(e[n],t),e[r])&&sT(Px(e[r],t),e[n])&&Q5(Nfe(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function sT(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function Ife(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function Q5(e,t){for(var n=0;n<t.length;++n)if(!Ife(e,t[n]))return!1;return!0}function Iit(e){switch(e.length){case 1:return Nit(e[0]);case 2:return Px(e[0],e[1]);case 3:return Nfe(e[0],e[1],e[2])}}function Nit(e){return{x:e.x,y:e.y,r:e.r}}function Px(e,t){var n=e.x,r=e.y,i=e.r,a=t.x,o=t.y,s=t.r,u=a-n,l=o-r,c=s-i,f=Math.sqrt(u*u+l*l);return{x:(n+a+u/f*c)/2,y:(r+o+l/f*c)/2,r:(f+i+s)/2}}function Nfe(e,t,n){var r=e.x,i=e.y,a=e.r,o=t.x,s=t.y,u=t.r,l=n.x,c=n.y,f=n.r,d=r-o,h=r-l,p=i-s,g=i-c,m=u-a,v=f-a,y=r*r+i*i-a*a,b=y-o*o-s*s+u*u,x=y-l*l-c*c+f*f,w=h*p-d*g,S=(p*x-g*b)/(w*2)-r,C=(g*m-p*v)/w,_=(h*b-d*x)/(w*2)-i,E=(d*v-h*m)/w,A=C*C+E*E-1,k=2*(a+S*C+_*E),T=S*S+_*_-a*a,I=-(A?(k+Math.sqrt(k*k-4*A*T))/(2*A):T/k);return{x:r+S+C*I,y:i+_+E*I,r:I}}function Dfe(e,t,n){var r=e.x-t.x,i,a,o=e.y-t.y,s,u,l=r*r+o*o;l?(a=t.r+n.r,a*=a,u=e.r+n.r,u*=u,a>u?(i=(l+u-a)/(2*l),s=Math.sqrt(Math.max(0,u/l-i*i)),n.x=e.x-i*r-s*o,n.y=e.y-i*o+s*r):(i=(l+a-u)/(2*l),s=Math.sqrt(Math.max(0,a/l-i*i)),n.x=t.x+i*r-s*o,n.y=t.y+i*o+s*r)):(n.x=t.x+n.r,n.y=t.y)}function Rfe(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function Ffe(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,a=(t.y*n.r+n.y*t.r)/r;return i*i+a*a}function uT(e){this._=e,this.next=null,this.previous=null}function Dit(e){if(!(i=(e=Ait(e)).length))return 0;var t,n,r,i,a,o,s,u,l,c,f;if(t=e[0],t.x=0,t.y=0,!(i>1))return t.r;if(n=e[1],t.x=-n.r,n.x=t.r,n.y=0,!(i>2))return t.r+n.r;Dfe(n,t,r=e[2]),t=new uT(t),n=new uT(n),r=new uT(r),t.next=r.previous=n,n.next=t.previous=r,r.next=n.previous=t;e:for(s=3;s<i;++s){Dfe(t._,n._,r=e[s]),r=new uT(r),u=n.next,l=t.previous,c=n._.r,f=t._.r;do if(c<=f){if(Rfe(u._,r._)){n=u,t.next=n,n.previous=t,--s;continue e}c+=u._.r,u=u.next}else{if(Rfe(l._,r._)){t=l,t.next=n,n.previous=t,--s;continue e}f+=l._.r,l=l.previous}while(u!==l.next);for(r.previous=t,r.next=n,t.next=n.previous=n=r,a=Ffe(t);(r=r.next)!==n;)(o=Ffe(r))<a&&(t=r,a=o);n=t.next}for(t=[n._],r=n;(r=r.next)!==n;)t.push(r._);for(r=Tit(t),s=0;s<i;++s)t=e[s],t.x-=r.x,t.y-=r.y;return r.r}function Rit(e){return e==null?null:lT(e)}function lT(e){if(typeof e!="function")throw new Error;return e}function Pp(){return 0}function e0(e){return function(){return e}}function Fit(e){return Math.sqrt(e.value)}function Mit(){var e=null,t=1,n=1,r=Pp;function i(a){return a.x=t/2,a.y=n/2,e?a.eachBefore(Mfe(e)).eachAfter(e6(r,.5)).eachBefore(Pfe(1)):a.eachBefore(Mfe(Fit)).eachAfter(e6(Pp,1)).eachAfter(e6(r,a.r/Math.min(t,n))).eachBefore(Pfe(Math.min(t,n)/(2*a.r))),a}return i.radius=function(a){return arguments.length?(e=Rit(a),i):e},i.size=function(a){return arguments.length?(t=+a[0],n=+a[1],i):[t,n]},i.padding=function(a){return arguments.length?(r=typeof a=="function"?a:e0(+a),i):r},i}function Mfe(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function e6(e,t){return function(n){if(r=n.children){var r,i,a=r.length,o=e(n)*t||0,s;if(o)for(i=0;i<a;++i)r[i].r+=o;if(s=Dit(r),o)for(i=0;i<a;++i)r[i].r-=o;n.r=s+o}}}function Pfe(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function $fe(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function $x(e,t,n,r,i){for(var a=e.children,o,s=-1,u=a.length,l=e.value&&(r-t)/e.value;++s<u;)o=a[s],o.y0=n,o.y1=i,o.x0=t,o.x1=t+=o.value*l}function Pit(){var e=1,t=1,n=0,r=!1;function i(o){var s=o.height+1;return o.x0=o.y0=n,o.x1=e,o.y1=t/s,o.eachBefore(a(t,s)),r&&o.eachBefore($fe),o}function a(o,s){return function(u){u.children&&$x(u,u.x0,o*(u.depth+1)/s,u.x1,o*(u.depth+2)/s);var l=u.x0,c=u.y0,f=u.x1-n,d=u.y1-n;f<l&&(l=f=(l+f)/2),d<c&&(c=d=(c+d)/2),u.x0=l,u.y0=c,u.x1=f,u.y1=d}}return i.round=function(o){return arguments.length?(r=!!o,i):r},i.size=function(o){return arguments.length?(e=+o[0],t=+o[1],i):[e,t]},i.padding=function(o){return arguments.length?(n=+o,i):n},i}var $it={depth:-1},Lfe={};function Lit(e){return e.id}function Bit(e){return e.parentId}function Bfe(){var e=Lit,t=Bit;function n(r){var i=Array.from(r),a=i.length,o,s,u,l,c,f,d,h=new Map;for(s=0;s<a;++s)o=i[s],c=i[s]=new Qv(o),(f=e(o,s,r))!=null&&(f+="")&&(d=c.id=f,h.set(d,h.has(d)?Lfe:c)),(f=t(o,s,r))!=null&&(f+="")&&(c.parent=f);for(s=0;s<a;++s)if(c=i[s],f=c.parent){if(l=h.get(f),!l)throw new Error("missing: "+f);if(l===Lfe)throw new Error("ambiguous: "+f);l.children?l.children.push(c):l.children=[c],c.parent=l}else{if(u)throw new Error("multiple roots");u=c}if(!u)throw new Error("no root");if(u.parent=$it,u.eachBefore(function(p){p.depth=p.parent.depth+1,--a}).eachBefore(Ofe),u.parent=null,a>0)throw new Error("cycle");return u}return n.id=function(r){return arguments.length?(e=lT(r),n):e},n.parentId=function(r){return arguments.length?(t=lT(r),n):t},n}function zit(e,t){return e.parent===t.parent?1:2}function t6(e){var t=e.children;return t?t[0]:e.t}function n6(e){var t=e.children;return t?t[t.length-1]:e.t}function jit(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function Uit(e){for(var t=0,n=0,r=e.children,i=r.length,a;--i>=0;)a=r[i],a.z+=t,a.m+=t,t+=a.s+(n+=a.c)}function Wit(e,t,n){return e.a.parent===t.parent?e.a:n}function cT(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}cT.prototype=Object.create(Qv.prototype);function Vit(e){for(var t=new cT(e,0),n,r=[t],i,a,o,s;n=r.pop();)if(a=n._.children)for(n.children=new Array(s=a.length),o=s-1;o>=0;--o)r.push(i=n.children[o]=new cT(a[o],o)),i.parent=n;return(t.parent=new cT(null,0)).children=[t],t}function qit(){var e=zit,t=1,n=1,r=null;function i(l){var c=Vit(l);if(c.eachAfter(a),c.parent.m=-c.z,c.eachBefore(o),r)l.eachBefore(u);else{var f=l,d=l,h=l;l.eachBefore(function(y){y.x<f.x&&(f=y),y.x>d.x&&(d=y),y.depth>h.depth&&(h=y)});var p=f===d?1:e(f,d)/2,g=p-f.x,m=t/(d.x+p+g),v=n/(h.depth||1);l.eachBefore(function(y){y.x=(y.x+g)*m,y.y=y.depth*v})}return l}function a(l){var c=l.children,f=l.parent.children,d=l.i?f[l.i-1]:null;if(c){Uit(l);var h=(c[0].z+c[c.length-1].z)/2;d?(l.z=d.z+e(l._,d._),l.m=l.z-h):l.z=h}else d&&(l.z=d.z+e(l._,d._));l.parent.A=s(l,d,l.parent.A||f[0])}function o(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function s(l,c,f){if(c){for(var d=l,h=l,p=c,g=d.parent.children[0],m=d.m,v=h.m,y=p.m,b=g.m,x;p=n6(p),d=t6(d),p&&d;)g=t6(g),h=n6(h),h.a=l,x=p.z+y-d.z-m+e(p._,d._),x>0&&(jit(Wit(p,l,f),l,x),m+=x,v+=x),y+=p.m,m+=d.m,b+=g.m,v+=h.m;p&&!n6(h)&&(h.t=p,h.m+=y-v),d&&!t6(g)&&(g.t=d,g.m+=m-b,f=l)}return f}function u(l){l.x*=t,l.y=l.depth*n}return i.separation=function(l){return arguments.length?(e=l,i):e},i.size=function(l){return arguments.length?(r=!1,t=+l[0],n=+l[1],i):r?null:[t,n]},i.nodeSize=function(l){return arguments.length?(r=!0,t=+l[0],n=+l[1],i):r?[t,n]:null},i}function fT(e,t,n,r,i){for(var a=e.children,o,s=-1,u=a.length,l=e.value&&(i-n)/e.value;++s<u;)o=a[s],o.x0=t,o.x1=r,o.y0=n,o.y1=n+=o.value*l}var zfe=(1+Math.sqrt(5))/2;function jfe(e,t,n,r,i,a){for(var o=[],s=t.children,u,l,c=0,f=0,d=s.length,h,p,g=t.value,m,v,y,b,x,w,S;c<d;){h=i-n,p=a-r;do m=s[f++].value;while(!m&&f<d);for(v=y=m,w=Math.max(p/h,h/p)/(g*e),S=m*m*w,x=Math.max(y/S,S/v);f<d;++f){if(m+=l=s[f].value,l<v&&(v=l),l>y&&(y=l),S=m*m*w,b=Math.max(y/S,S/v),b>x){m-=l;break}x=b}o.push(u={value:m,dice:h<p,children:s.slice(c,f)}),u.dice?$x(u,n,r,i,g?r+=p*m/g:a):fT(u,n,r,g?n+=h*m/g:i,a),g-=m,c=f}return o}var Ufe=function e(t){function n(r,i,a,o,s){jfe(t,r,i,a,o,s)}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(zfe);function Hit(){var e=Ufe,t=!1,n=1,r=1,i=[0],a=Pp,o=Pp,s=Pp,u=Pp,l=Pp;function c(d){return d.x0=d.y0=0,d.x1=n,d.y1=r,d.eachBefore(f),i=[0],t&&d.eachBefore($fe),d}function f(d){var h=i[d.depth],p=d.x0+h,g=d.y0+h,m=d.x1-h,v=d.y1-h;m<p&&(p=m=(p+m)/2),v<g&&(g=v=(g+v)/2),d.x0=p,d.y0=g,d.x1=m,d.y1=v,d.children&&(h=i[d.depth+1]=a(d)/2,p+=l(d)-h,g+=o(d)-h,m-=s(d)-h,v-=u(d)-h,m<p&&(p=m=(p+m)/2),v<g&&(g=v=(g+v)/2),e(d,p,g,m,v))}return c.round=function(d){return arguments.length?(t=!!d,c):t},c.size=function(d){return arguments.length?(n=+d[0],r=+d[1],c):[n,r]},c.tile=function(d){return arguments.length?(e=lT(d),c):e},c.padding=function(d){return arguments.length?c.paddingInner(d).paddingOuter(d):c.paddingInner()},c.paddingInner=function(d){return arguments.length?(a=typeof d=="function"?d:e0(+d),c):a},c.paddingOuter=function(d){return arguments.length?c.paddingTop(d).paddingRight(d).paddingBottom(d).paddingLeft(d):c.paddingTop()},c.paddingTop=function(d){return arguments.length?(o=typeof d=="function"?d:e0(+d),c):o},c.paddingRight=function(d){return arguments.length?(s=typeof d=="function"?d:e0(+d),c):s},c.paddingBottom=function(d){return arguments.length?(u=typeof d=="function"?d:e0(+d),c):u},c.paddingLeft=function(d){return arguments.length?(l=typeof d=="function"?d:e0(+d),c):l},c}function Git(e,t,n,r,i){var a=e.children,o,s=a.length,u,l=new Array(s+1);for(l[0]=u=o=0;o<s;++o)l[o+1]=u+=a[o].value;c(0,s,e.value,t,n,r,i);function c(f,d,h,p,g,m,v){if(f>=d-1){var y=a[f];y.x0=p,y.y0=g,y.x1=m,y.y1=v;return}for(var b=l[f],x=h/2+b,w=f+1,S=d-1;w<S;){var C=w+S>>>1;l[C]<x?w=C+1:S=C}x-l[w-1]<l[w]-x&&f+1<w&&--w;var _=l[w]-b,E=h-_;if(m-p>v-g){var A=h?(p*E+m*_)/h:m;c(f,w,_,p,g,A,v),c(w,d,E,A,g,m,v)}else{var k=h?(g*E+v*_)/h:v;c(f,w,_,p,g,m,k),c(w,d,E,p,k,m,v)}}}function Kit(e,t,n,r,i){(e.depth&1?fT:$x)(e,t,n,r,i)}var Xit=function e(t){function n(r,i,a,o,s){if((u=r._squarify)&&u.ratio===t)for(var u,l,c,f,d=-1,h,p=u.length,g=r.value;++d<p;){for(l=u[d],c=l.children,f=l.value=0,h=c.length;f<h;++f)l.value+=c[f].value;l.dice?$x(l,i,a,o,g?a+=(s-a)*l.value/g:s):fT(l,i,a,g?i+=(o-i)*l.value/g:o,s),g-=l.value}else r._squarify=u=jfe(t,r,i,a,o,s),u.ratio=t}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(zfe);function r6(e,t,n){const r={};return e.each(i=>{const a=i.data;n(a)&&(r[t(a)]=i)}),e.lookup=r,e}function i6(e){ve.call(this,null,e)}i6.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const Yit=e=>e.values;$e(i6,ve,{transform(e,t){t.source||Se("Nest transform requires an upstream data source.");var n=e.generate,r=e.modified(),i=t.clone(),a=this.value;return(!a||r||t.changed())&&(a&&a.each(o=>{o.children&&eA(o.data)&&i.rem.push(o.data)}),this.value=a=J5({values:wt(e.keys).reduce((o,s)=>(o.key(s),o),Zit()).entries(i.source)},Yit),n&&a.each(o=>{o.children&&(o=In(o.data),i.add.push(o),i.source.push(o))}),r6(a,lt,lt)),i.source.root=a,i}});function Zit(){const e=[],t={entries:i=>r(n(i,0),0),key:i=>(e.push(i),t)};function n(i,a){if(a>=e.length)return i;const o=i.length,s=e[a++],u={},l={};let c=-1,f,d,h;for(;++c<o;)f=s(d=i[c])+"",(h=u[f])?h.push(d):u[f]=[d];for(f in u)l[f]=n(u[f],a);return l}function r(i,a){if(++a>e.length)return i;const o=[];for(const s in i)o.push({key:s,values:r(i[s],a)});return o}return t}function Mc(e){ve.call(this,null,e)}const Jit=(e,t)=>e.parent===t.parent?1:2;$e(Mc,ve,{transform(e,t){(!t.source||!t.source.root)&&Se(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),r=this.fields,i=t.source.root,a=e.as||r;e.field?i.sum(e.field):i.count(),e.sort&&i.sort(mp(e.sort,o=>o.data)),Qit(n,this.params,e),n.separation&&n.separation(e.separation!==!1?Jit:cv);try{this.value=n(i)}catch(o){Se(o)}return i.each(o=>eat(o,r,a)),t.reflow(e.modified()).modifies(a).modifies("leaf")}});function Qit(e,t,n){for(let r,i=0,a=t.length;i<a;++i)r=t[i],r in n&&e[r](n[r])}function eat(e,t,n){const r=e.data,i=t.length-1;for(let a=0;a<i;++a)r[n[a]]=e[t[a]];r[n[i]]=e.children?e.children.length:0}const a6=["x","y","r","depth","children"];function o6(e){Mc.call(this,e)}o6.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:a6.length,default:a6}]},$e(o6,Mc,{layout:Mit,params:["radius","size","padding"],fields:a6});const s6=["x0","y0","x1","y1","depth","children"];function u6(e){Mc.call(this,e)}u6.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:s6.length,default:s6}]},$e(u6,Mc,{layout:Pit,params:["size","round","padding"],fields:s6});function l6(e){ve.call(this,null,e)}l6.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},$e(l6,ve,{transform(e,t){t.source||Se("Stratify transform requires an upstream data source.");let n=this.value;const r=e.modified(),i=t.fork(t.ALL).materialize(t.SOURCE),a=!n||r||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return i.source=i.source.slice(),a&&(n=i.source.length?r6(Bfe().id(e.key).parentId(e.parentKey)(i.source),e.key,ls):r6(Bfe()([{}]),e.key,e.key)),i.source.root=this.value=n,i}});const Wfe={tidy:qit,cluster:oit},c6=["x","y","depth","children"];function f6(e){Mc.call(this,e)}f6.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:c6.length,default:c6}]},$e(f6,Mc,{layout(e){const t=e||"tidy";if(_t(Wfe,t))return Wfe[t]();Se("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:c6});function d6(e){ve.call(this,[],e)}d6.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},$e(d6,ve,{transform(e,t){const n=this.value,r=t.source&&t.source.root,i=t.fork(t.NO_SOURCE),a={};return r||Se("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(i.rem=n,t.visit(t.SOURCE,o=>a[lt(o)]=1),r.each(o=>{const s=o.data,u=o.parent&&o.parent.data;u&&a[lt(s)]&&a[lt(u)]&&i.add.push(In({source:u,target:s}))}),this.value=i.add):t.changed(t.MOD)&&(t.visit(t.MOD,o=>a[lt(o)]=1),n.forEach(o=>{(a[lt(o.source)]||a[lt(o.target)])&&i.mod.push(o)})),i}});const Vfe={binary:Git,dice:$x,slice:fT,slicedice:Kit,squarify:Ufe,resquarify:Xit},h6=["x0","y0","x1","y1","depth","children"];function p6(e){Mc.call(this,e)}p6.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:h6.length,default:h6}]},$e(p6,Mc,{layout(){const e=Hit();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{_t(Vfe,t)?e.tile(Vfe[t]):Se("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:h6});var tat=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",nest:i6,pack:o6,partition:u6,stratify:l6,tree:f6,treelinks:d6,treemap:p6});const nat=4278190080,rat=268435456,iat=.0625;function aat(e,t){const n=e.bitmap();return(t||[]).forEach(r=>n.set(e(r.boundary[0]),e(r.boundary[3]))),[n,void 0]}function oat(e,t,n,r){const i=e.width,a=e.height,o=n||r,s=Cv(i,a).getContext("2d");t.forEach(m=>qfe(s,m,o));const u=new Uint32Array(s.getImageData(0,0,i,a).data.buffer),l=e.bitmap(),c=o&&e.bitmap();let f,d,h,p,g;for(d=0;d<a;++d)for(f=0;f<i;++f)g=u[d*i+f]&nat,g&&(h=e(f),p=e(d),r||l.set(h,p),o&&g^rat&&c.set(h,p));return[l,c]}function qfe(e,t,n){if(!t.length)return;const r=t[0].mark.marktype;r==="group"?t.forEach(i=>{i.items.forEach(a=>qfe(e,a.items,n))}):Uo[r].draw(e,{items:n?t.map(sat):t})}function sat(e){const t=tA(e,{});return t.stroke&&(t.strokeOpacity=1),t.fill&&(t.fillOpacity=iat,t.stroke="#000",t.strokeOpacity=1,t.strokeWidth=2),t}const Pc=5,ja=31,Lx=32,Rd=new Uint32Array(Lx+1),fu=new Uint32Array(Lx+1);fu[0]=0,Rd[0]=~fu[0];for(let e=1;e<=Lx;++e)fu[e]=fu[e-1]<<1|1,Rd[e]=~fu[e];function uat(e,t){const n=new Uint32Array(~~((e*t+Lx)/Lx));function r(a,o){n[a]|=o}function i(a,o){n[a]&=o}return{array:n,get:(a,o)=>{const s=o*e+a;return n[s>>>Pc]&1<<(s&ja)},set:(a,o)=>{const s=o*e+a;r(s>>>Pc,1<<(s&ja))},clear:(a,o)=>{const s=o*e+a;i(s>>>Pc,~(1<<(s&ja)))},getRange:(a,o,s,u)=>{let l=u,c,f,d,h;for(;l>=o;--l)if(c=l*e+a,f=l*e+s,d=c>>>Pc,h=f>>>Pc,d===h){if(n[d]&Rd[c&ja]&fu[(f&ja)+1])return!0}else{if(n[d]&Rd[c&ja]||n[h]&fu[(f&ja)+1])return!0;for(let p=d+1;p<h;++p)if(n[p])return!0}return!1},setRange:(a,o,s,u)=>{let l,c,f,d,h;for(;o<=u;++o)if(l=o*e+a,c=o*e+s,f=l>>>Pc,d=c>>>Pc,f===d)r(f,Rd[l&ja]&fu[(c&ja)+1]);else for(r(f,Rd[l&ja]),r(d,fu[(c&ja)+1]),h=f+1;h<d;++h)r(h,4294967295)},clearRange:(a,o,s,u)=>{let l,c,f,d,h;for(;o<=u;++o)if(l=o*e+a,c=o*e+s,f=l>>>Pc,d=c>>>Pc,f===d)i(f,fu[l&ja]|Rd[(c&ja)+1]);else for(i(f,fu[l&ja]),i(d,Rd[(c&ja)+1]),h=f+1;h<d;++h)i(h,0)},outOfBounds:(a,o,s,u)=>a<0||o<0||u>=t||s>=e}}function lat(e,t,n){const r=Math.max(1,Math.sqrt(e*t/1e6)),i=~~((e+2*n+r)/r),a=~~((t+2*n+r)/r),o=s=>~~((s+n)/r);return o.invert=s=>s*r-n,o.bitmap=()=>uat(i,a),o.ratio=r,o.padding=n,o.width=e,o.height=t,o}function cat(e,t,n,r){const i=e.width,a=e.height;return function(o){const s=o.datum.datum.items[r].items,u=s.length,l=o.datum.fontSize,c=dl.width(o.datum,o.datum.text);let f=0,d,h,p,g,m,v,y;for(let b=0;b<u;++b)d=s[b].x,p=s[b].y,h=s[b].x2===void 0?d:s[b].x2,g=s[b].y2===void 0?p:s[b].y2,m=(d+h)/2,v=(p+g)/2,y=Math.abs(h-d+g-p),y>=f&&(f=y,o.x=m,o.y=v);return m=c/2,v=l/2,d=o.x-m,h=o.x+m,p=o.y-v,g=o.y+v,o.align="center",d<0&&h<=i?o.align="left":0<=d&&i<h&&(o.align="right"),o.baseline="middle",p<0&&g<=a?o.baseline="top":0<=p&&a<g&&(o.baseline="bottom"),!0}}function dT(e,t,n,r,i,a){let o=n/2;return e-o<0||e+o>i||t-(o=r/2)<0||t+o>a}function Fd(e,t,n,r,i,a,o,s){const u=i*a/(r*2),l=e(t-u),c=e(t+u),f=e(n-(a=a/2)),d=e(n+a);return o.outOfBounds(l,f,c,d)||o.getRange(l,f,c,d)||s&&s.getRange(l,f,c,d)}function fat(e,t,n,r){const i=e.width,a=e.height,o=t[0],s=t[1];function u(l,c,f,d,h){const p=e.invert(l),g=e.invert(c);let m=f,v=a,y;if(!dT(p,g,d,h,i,a)&&!Fd(e,p,g,h,d,m,o,s)&&!Fd(e,p,g,h,d,h,o,null)){for(;v-m>=1;)y=(m+v)/2,Fd(e,p,g,h,d,y,o,s)?v=y:m=y;if(m>f)return[p,g,m,!0]}}return function(l){const c=l.datum.datum.items[r].items,f=c.length,d=l.datum.fontSize,h=dl.width(l.datum,l.datum.text);let p=n?d:0,g=!1,m=!1,v=0,y,b,x,w,S,C,_,E,A,k,T,I,N,O,D,L,W;for(let G=0;G<f;++G){for(y=c[G].x,x=c[G].y,b=c[G].x2===void 0?y:c[G].x2,w=c[G].y2===void 0?x:c[G].y2,y>b&&(W=y,y=b,b=W),x>w&&(W=x,x=w,w=W),A=e(y),T=e(b),k=~~((A+T)/2),I=e(x),O=e(w),N=~~((I+O)/2),_=k;_>=A;--_)for(E=N;E>=I;--E)L=u(_,E,p,h,d),L&&([l.x,l.y,p,g]=L);for(_=k;_<=T;++_)for(E=N;E<=O;++E)L=u(_,E,p,h,d),L&&([l.x,l.y,p,g]=L);!g&&!n&&(D=Math.abs(b-y+w-x),S=(y+b)/2,C=(x+w)/2,D>=v&&!dT(S,C,h,d,i,a)&&!Fd(e,S,C,d,h,d,o,null)&&(v=D,l.x=S,l.y=C,m=!0))}return g||m?(S=h/2,C=d/2,o.setRange(e(l.x-S),e(l.y-C),e(l.x+S),e(l.y+C)),l.align="center",l.baseline="middle",!0):!1}}const dat=[-1,-1,1,1],hat=[-1,1,-1,1];function pat(e,t,n,r){const i=e.width,a=e.height,o=t[0],s=t[1],u=e.bitmap();return function(l){const c=l.datum.datum.items[r].items,f=c.length,d=l.datum.fontSize,h=dl.width(l.datum,l.datum.text),p=[];let g=n?d:0,m=!1,v=!1,y=0,b,x,w,S,C,_,E,A,k,T,I,N;for(let O=0;O<f;++O){for(b=c[O].x,w=c[O].y,x=c[O].x2===void 0?b:c[O].x2,S=c[O].y2===void 0?w:c[O].y2,p.push([e((b+x)/2),e((w+S)/2)]);p.length;)if([E,A]=p.pop(),!(o.get(E,A)||s.get(E,A)||u.get(E,A))){u.set(E,A);for(let D=0;D<4;++D)C=E+dat[D],_=A+hat[D],u.outOfBounds(C,_,C,_)||p.push([C,_]);if(C=e.invert(E),_=e.invert(A),k=g,T=a,!dT(C,_,h,d,i,a)&&!Fd(e,C,_,d,h,k,o,s)&&!Fd(e,C,_,d,h,d,o,null)){for(;T-k>=1;)I=(k+T)/2,Fd(e,C,_,d,h,I,o,s)?T=I:k=I;k>g&&(l.x=C,l.y=_,g=k,m=!0)}}!m&&!n&&(N=Math.abs(x-b+S-w),C=(b+x)/2,_=(w+S)/2,N>=y&&!dT(C,_,h,d,i,a)&&!Fd(e,C,_,d,h,d,o,null)&&(y=N,l.x=C,l.y=_,v=!0))}return m||v?(C=h/2,_=d/2,o.setRange(e(l.x-C),e(l.y-_),e(l.x+C),e(l.y+_)),l.align="center",l.baseline="middle",!0):!1}}const gat=["right","center","left"],mat=["bottom","middle","top"];function vat(e,t,n,r){const i=e.width,a=e.height,o=t[0],s=t[1],u=r.length;return function(l){const c=l.boundary,f=l.datum.fontSize;if(c[2]<0||c[5]<0||c[0]>i||c[3]>a)return!1;let d=0,h,p,g,m,v,y,b,x,w,S,C,_,E,A,k;for(let T=0;T<u;++T){if(h=(n[T]&3)-1,p=(n[T]>>>2&3)-1,g=h===0&&p===0||r[T]<0,m=h&&p?Math.SQRT1_2:1,v=r[T]<0?-1:1,y=c[1+h]+r[T]*h*m,C=c[4+p]+v*f*p/2+r[T]*p*m,x=C-f/2,w=C+f/2,_=e(y),A=e(x),k=e(w),!d)if(Hfe(_,_,A,k,o,s,y,y,x,w,c,g))d=dl.width(l.datum,l.datum.text);else continue;if(S=y+v*d*h/2,y=S-d/2,b=S+d/2,_=e(y),E=e(b),Hfe(_,E,A,k,o,s,y,b,x,w,c,g))return l.x=h?h*v<0?b:y:S,l.y=p?p*v<0?w:x:C,l.align=gat[h*v+1],l.baseline=mat[p*v+1],o.setRange(_,A,E,k),!0}return!1}}function Hfe(e,t,n,r,i,a,o,s,u,l,c,f){return!(i.outOfBounds(e,n,t,r)||(f&&a?a.getRange(e,n,t,r)||!yat(o,u,s,l,c):i.getRange(e,n,t,r)))}function yat(e,t,n,r,i){return i[0]<=e&&n<=i[2]&&i[3]<=t&&r<=i[5]}const g6=0,m6=4,v6=8,y6=0,b6=1,x6=2,bat={"top-left":g6+y6,top:g6+b6,"top-right":g6+x6,left:m6+y6,middle:m6+b6,right:m6+x6,"bottom-left":v6+y6,bottom:v6+b6,"bottom-right":v6+x6},xat={naive:cat,"reduced-search":fat,floodfill:pat};function wat(e,t,n,r,i,a,o,s,u,l,c){if(!e.length)return e;const f=Math.max(r.length,i.length),d=_at(r,f),h=Sat(i,f),p=Eat(e[0].datum),g=p==="group"&&e[0].datum.items[u].marktype,m=g==="area",v=Cat(p,g,s,u),y=lat(t[0],t[1],l),b=m&&c==="naive",x=e.map(C=>({datum:C,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:v(C)}));let w;if(!b){n&&x.sort((_,E)=>n(_.datum,E.datum));let C=!1;for(let _=0;_<h.length&&!C;++_)C=h[_]===5||d[_]<0;p&&(o||m)&&(a=[e.map(_=>_.datum)].concat(a)),w=a.length?oat(y,a,C,m):aat(y,o&&x)}const S=m?xat[c](y,w,o,u):vat(y,w,h,d);return x.forEach(C=>C.opacity=+S(C)),x}function _at(e,t){const n=new Float64Array(t),r=e.length;for(let i=0;i<r;++i)n[i]=e[i]||0;for(let i=r;i<t;++i)n[i]=n[r-1];return n}function Sat(e,t){const n=new Int8Array(t),r=e.length;for(let i=0;i<r;++i)n[i]|=bat[e[i]];for(let i=r;i<t;++i)n[i]=n[r-1];return n}function Eat(e){return e&&e.mark&&e.mark.marktype}function Cat(e,t,n,r){const i=a=>[a.x,a.x,a.x,a.y,a.y,a.y];return e?e==="line"||e==="area"?a=>i(a.datum):t==="line"?a=>{const o=a.datum.items[r].items;return i(o.length?o[n==="start"?0:o.length-1]:{x:NaN,y:NaN})}:a=>{const o=a.datum.bounds;return[o.x1,(o.x1+o.x2)/2,o.x2,o.y1,(o.y1+o.y2)/2,o.y2]}:i}const w6=["x","y","opacity","align","baseline"],Gfe=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function _6(e){ve.call(this,null,e)}_6.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:Gfe},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:w6.length,default:w6}]},$e(_6,ve,{transform(e,t){function n(a){const o=e[a];return Lt(o)&&t.modified(o.fields)}const r=e.modified();if(!(r||t.changed(t.ADD_REM)||n("sort")))return;(!e.size||e.size.length!==2)&&Se("Size parameter should be specified as a [width, height] array.");const i=e.as||w6;return wat(t.materialize(t.SOURCE).source,e.size,e.sort,wt(e.offset||1),wt(e.anchor||Gfe),e.avoidMarks||[],e.avoidBaseMark!==!1,e.lineAnchor||"end",e.markIndex||0,e.padding||0,e.method||"naive").forEach(a=>{const o=a.datum;o[i[0]]=a.x,o[i[1]]=a.y,o[i[2]]=a.opacity,o[i[3]]=a.align,o[i[4]]=a.baseline}),t.reflow(r).modifies(i)}});var Aat=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",label:_6});function Kfe(e,t){var n=[],r=function(c){return c(s)},i,a,o,s,u,l;if(t==null)n.push(e);else for(i={},a=0,o=e.length;a<o;++a)s=e[a],u=t.map(r),l=i[u],l||(i[u]=l=[],l.dims=u,n.push(l)),l.push(s);return n}function S6(e){ve.call(this,null,e)}S6.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},$e(S6,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=Kfe(r,e.groupby),a=(e.groupby||[]).map(Tr),o=a.length,s=e.as||[Tr(e.x),Tr(e.y)],u=[];i.forEach(l=>{rae(l,e.x,e.y,e.bandwidth||.3).forEach(c=>{const f={};for(let d=0;d<o;++d)f[a[d]]=l.dims[d];f[s[0]]=c[0],f[s[1]]=c[1],u.push(In(f))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});const E6={linear:gL,log:Zie,exp:Jie,pow:Qie,quad:mL,poly:eae},kat=(e,t)=>e==="poly"?t:e==="quad"?2:1;function C6(e){ve.call(this,null,e)}C6.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(E6)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},$e(C6,ve,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const r=t.materialize(t.SOURCE).source,i=Kfe(r,e.groupby),a=(e.groupby||[]).map(Tr),o=e.method||"linear",s=e.order||3,u=kat(o,s),l=e.as||[Tr(e.x),Tr(e.y)],c=E6[o],f=[];let d=e.extent;_t(E6,o)||Se("Invalid regression method: "+o),d!=null&&o==="log"&&d[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),d=null),i.forEach(h=>{if(h.length<=u){t.dataflow.warn("Skipping regression with more parameters than data points.");return}const g=c(h,e.x,e.y,s);if(e.params){f.push(In({keys:h.dims,coef:g.coef,rSquared:g.rSquared}));return}const m=d||tl(h,e.x),v=y=>{const b={};for(let x=0;x<a.length;++x)b[a[x]]=h.dims[x];b[l[0]]=y[0],b[l[1]]=y[1],f.push(In(b))};o==="linear"?m.forEach(y=>v([y,g.predict(y)])):fA(g.predict,m,25,200).forEach(v)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=f}return n}});var Tat=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",loess:S6,regression:C6});const Xfe=Math.pow(2,-52),hT=new Uint32Array(512);class pT{static from(t,n=Rat,r=Fat){const i=t.length,a=new Float64Array(i*2);for(let o=0;o<i;o++){const s=t[o];a[2*o]=n(s),a[2*o+1]=r(s)}return new pT(a)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const r=Math.max(2*n-5,0);this._triangles=new Uint32Array(r*3),this._halfedges=new Int32Array(r*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:r,_hullTri:i,_hullHash:a}=this,o=t.length>>1;let s=1/0,u=1/0,l=-1/0,c=-1/0;for(let A=0;A<o;A++){const k=t[2*A],T=t[2*A+1];k<s&&(s=k),T<u&&(u=T),k>l&&(l=k),T>c&&(c=T),this._ids[A]=A}const f=(s+l)/2,d=(u+c)/2;let h=1/0,p,g,m;for(let A=0;A<o;A++){const k=A6(f,d,t[2*A],t[2*A+1]);k<h&&(p=A,h=k)}const v=t[2*p],y=t[2*p+1];h=1/0;for(let A=0;A<o;A++){if(A===p)continue;const k=A6(v,y,t[2*A],t[2*A+1]);k<h&&k>0&&(g=A,h=k)}let b=t[2*g],x=t[2*g+1],w=1/0;for(let A=0;A<o;A++){if(A===p||A===g)continue;const k=Nat(v,y,b,x,t[2*A],t[2*A+1]);k<w&&(m=A,w=k)}let S=t[2*m],C=t[2*m+1];if(w===1/0){for(let T=0;T<o;T++)this._dists[T]=t[2*T]-t[0]||t[2*T+1]-t[1];t0(this._ids,this._dists,0,o-1);const A=new Uint32Array(o);let k=0;for(let T=0,I=-1/0;T<o;T++){const N=this._ids[T];this._dists[N]>I&&(A[k++]=N,I=this._dists[N])}this.hull=A.subarray(0,k),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(gT(v,y,b,x,S,C)){const A=g,k=b,T=x;g=m,b=S,x=C,m=A,S=k,C=T}const _=Dat(v,y,b,x,S,C);this._cx=_.x,this._cy=_.y;for(let A=0;A<o;A++)this._dists[A]=A6(t[2*A],t[2*A+1],_.x,_.y);t0(this._ids,this._dists,0,o-1),this._hullStart=p;let E=3;r[p]=n[m]=g,r[g]=n[p]=m,r[m]=n[g]=p,i[p]=0,i[g]=1,i[m]=2,a.fill(-1),a[this._hashKey(v,y)]=p,a[this._hashKey(b,x)]=g,a[this._hashKey(S,C)]=m,this.trianglesLen=0,this._addTriangle(p,g,m,-1,-1,-1);for(let A=0,k,T;A<this._ids.length;A++){const I=this._ids[A],N=t[2*I],O=t[2*I+1];if(A>0&&Math.abs(N-k)<=Xfe&&Math.abs(O-T)<=Xfe||(k=N,T=O,I===p||I===g||I===m))continue;let D=0;for(let ee=0,ce=this._hashKey(N,O);ee<this._hashSize&&(D=a[(ce+ee)%this._hashSize],!(D!==-1&&D!==r[D]));ee++);D=n[D];let L=D,W;for(;W=r[L],!gT(N,O,t[2*L],t[2*L+1],t[2*W],t[2*W+1]);)if(L=W,L===D){L=-1;break}if(L===-1)continue;let G=this._addTriangle(L,I,r[L],-1,-1,i[L]);i[I]=this._legalize(G+2),i[L]=G,E++;let K=r[L];for(;W=r[K],gT(N,O,t[2*K],t[2*K+1],t[2*W],t[2*W+1]);)G=this._addTriangle(K,I,W,i[I],-1,i[K]),i[I]=this._legalize(G+2),r[K]=K,E--,K=W;if(L===D)for(;W=n[L],gT(N,O,t[2*W],t[2*W+1],t[2*L],t[2*L+1]);)G=this._addTriangle(W,I,L,-1,i[L],i[W]),this._legalize(G+2),i[W]=G,r[L]=L,E--,L=W;this._hullStart=n[I]=L,r[L]=n[K]=I,r[I]=K,a[this._hashKey(N,O)]=I,a[this._hashKey(t[2*L],t[2*L+1])]=L}this.hull=new Uint32Array(E);for(let A=0,k=this._hullStart;A<E;A++)this.hull[A]=k,k=r[k];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(Oat(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:r,coords:i}=this;let a=0,o=0;for(;;){const s=r[t],u=t-t%3;if(o=u+(t+2)%3,s===-1){if(a===0)break;t=hT[--a];continue}const l=s-s%3,c=u+(t+1)%3,f=l+(s+2)%3,d=n[o],h=n[t],p=n[c],g=n[f];if(Iat(i[2*d],i[2*d+1],i[2*h],i[2*h+1],i[2*p],i[2*p+1],i[2*g],i[2*g+1])){n[t]=g,n[s]=d;const v=r[f];if(v===-1){let b=this._hullStart;do{if(this._hullTri[b]===f){this._hullTri[b]=t;break}b=this._hullPrev[b]}while(b!==this._hullStart)}this._link(t,v),this._link(s,r[o]),this._link(o,f);const y=l+(s+1)%3;a<hT.length&&(hT[a++]=y)}else{if(a===0)break;t=hT[--a]}}return o}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,r,i,a,o){const s=this.trianglesLen;return this._triangles[s]=t,this._triangles[s+1]=n,this._triangles[s+2]=r,this._link(s,i),this._link(s+1,a),this._link(s+2,o),this.trianglesLen+=3,s}}function Oat(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function A6(e,t,n,r){const i=e-n,a=t-r;return i*i+a*a}function k6(e,t,n,r,i,a){const o=(r-t)*(i-e),s=(n-e)*(a-t);return Math.abs(o-s)>=33306690738754716e-32*Math.abs(o+s)?o-s:0}function gT(e,t,n,r,i,a){return(k6(i,a,e,t,n,r)||k6(e,t,n,r,i,a)||k6(n,r,i,a,e,t))<0}function Iat(e,t,n,r,i,a,o,s){const u=e-o,l=t-s,c=n-o,f=r-s,d=i-o,h=a-s,p=u*u+l*l,g=c*c+f*f,m=d*d+h*h;return u*(f*m-g*h)-l*(c*m-g*d)+p*(c*h-f*d)<0}function Nat(e,t,n,r,i,a){const o=n-e,s=r-t,u=i-e,l=a-t,c=o*o+s*s,f=u*u+l*l,d=.5/(o*l-s*u),h=(l*c-s*f)*d,p=(o*f-u*c)*d;return h*h+p*p}function Dat(e,t,n,r,i,a){const o=n-e,s=r-t,u=i-e,l=a-t,c=o*o+s*s,f=u*u+l*l,d=.5/(o*l-s*u),h=e+(l*c-s*f)*d,p=t+(o*f-u*c)*d;return{x:h,y:p}}function t0(e,t,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const a=e[i],o=t[a];let s=i-1;for(;s>=n&&t[e[s]]>o;)e[s+1]=e[s--];e[s+1]=a}else{const i=n+r>>1;let a=n+1,o=r;Bx(e,i,a),t[e[n]]>t[e[r]]&&Bx(e,n,r),t[e[a]]>t[e[r]]&&Bx(e,a,r),t[e[n]]>t[e[a]]&&Bx(e,n,a);const s=e[a],u=t[s];for(;;){do a++;while(t[e[a]]<u);do o--;while(t[e[o]]>u);if(o<a)break;Bx(e,a,o)}e[n+1]=e[o],e[o]=s,r-a+1>=o-n?(t0(e,t,a,r),t0(e,t,n,o-1)):(t0(e,t,n,o-1),t0(e,t,a,r))}}function Bx(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function Rat(e){return e[0]}function Fat(e){return e[1]}const Yfe=1e-6;class $p{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,r){t=+t,n=+n,r=+r;const i=t+r,a=n;if(r<0)throw new Error("negative radius");this._x1===null?this._+=`M${i},${a}`:(Math.abs(this._x1-i)>Yfe||Math.abs(this._y1-a)>Yfe)&&(this._+="L"+i+","+a),!!r&&(this._+=`A${r},${r},0,1,1,${t-r},${n}A${r},${r},0,1,1,${this._x1=i},${this._y1=a}`)}rect(t,n,r,i){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+r}v${+i}h${-r}Z`}value(){return this._||null}}class T6{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}class Mat{constructor(t,[n,r,i,a]=[0,0,960,500]){if(!((i=+i)>=(n=+n))||!((a=+a)>=(r=+r)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=i,this.xmin=n,this.ymax=a,this.ymin=r,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:r},vectors:i}=this,a=this.circumcenters=this._circumcenters.subarray(0,r.length/3*2);for(let h=0,p=0,g=r.length,m,v;h<g;h+=3,p+=2){const y=r[h]*2,b=r[h+1]*2,x=r[h+2]*2,w=t[y],S=t[y+1],C=t[b],_=t[b+1],E=t[x],A=t[x+1],k=C-w,T=_-S,I=E-w,N=A-S,O=k*k+T*T,D=I*I+N*N,L=(k*N-T*I)*2;if(!L)m=(w+E)/2-1e8*N,v=(S+A)/2+1e8*I;else if(Math.abs(L)<1e-8)m=(w+E)/2,v=(S+A)/2;else{const W=1/L;m=w+(N*O-T*D)*W,v=S+(k*D-I*O)*W}a[p]=m,a[p+1]=v}let o=n[n.length-1],s,u=o*4,l,c=t[2*o],f,d=t[2*o+1];i.fill(0);for(let h=0;h<n.length;++h)o=n[h],s=u,l=c,f=d,u=o*4,c=t[2*o],d=t[2*o+1],i[s+2]=i[u]=f-d,i[s+3]=i[u+1]=c-l}render(t){const n=t==null?t=new $p:void 0,{delaunay:{halfedges:r,inedges:i,hull:a},circumcenters:o,vectors:s}=this;if(a.length<=1)return null;for(let c=0,f=r.length;c<f;++c){const d=r[c];if(d<c)continue;const h=Math.floor(c/3)*2,p=Math.floor(d/3)*2,g=o[h],m=o[h+1],v=o[p],y=o[p+1];this._renderSegment(g,m,v,y,t)}let u,l=a[a.length-1];for(let c=0;c<a.length;++c){u=l,l=a[c];const f=Math.floor(i[l]/3)*2,d=o[f],h=o[f+1],p=u*4,g=this._project(d,h,s[p+2],s[p+3]);g&&this._renderSegment(d,h,g[0],g[1],t)}return n&&n.value()}renderBounds(t){const n=t==null?t=new $p:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const r=n==null?n=new $p:void 0,i=this._clip(t);if(i===null||!i.length)return;n.moveTo(i[0],i[1]);let a=i.length;for(;i[0]===i[a-2]&&i[1]===i[a-1]&&a>1;)a-=2;for(let o=2;o<a;o+=2)(i[o]!==i[o-2]||i[o+1]!==i[o-1])&&n.lineTo(i[o],i[o+1]);return n.closePath(),r&&r.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,r=t.length/2;n<r;++n){const i=this.cellPolygon(n);i&&(i.index=n,yield i)}}cellPolygon(t){const n=new T6;return this.renderCell(t,n),n.value()}_renderSegment(t,n,r,i,a){let o;const s=this._regioncode(t,n),u=this._regioncode(r,i);s===0&&u===0?(a.moveTo(t,n),a.lineTo(r,i)):(o=this._clipSegment(t,n,r,i,s,u))&&(a.moveTo(o[0],o[1]),a.lineTo(o[2],o[3]))}contains(t,n,r){return n=+n,n!==n||(r=+r,r!==r)?!1:this.delaunay._step(t,n,r)===t}*neighbors(t){const n=this._clip(t);if(n)for(const r of this.delaunay.neighbors(t)){const i=this._clip(r);if(i)e:for(let a=0,o=n.length;a<o;a+=2)for(let s=0,u=i.length;s<u;s+=2)if(n[a]==i[s]&&n[a+1]==i[s+1]&&n[(a+2)%o]==i[(s+u-2)%u]&&n[(a+3)%o]==i[(s+u-1)%u]){yield r;break e}}}_cell(t){const{circumcenters:n,delaunay:{inedges:r,halfedges:i,triangles:a}}=this,o=r[t];if(o===-1)return null;const s=[];let u=o;do{const l=Math.floor(u/3);if(s.push(n[l*2],n[l*2+1]),u=u%3==2?u-2:u+1,a[u]!==t)break;u=i[u]}while(u!==o&&u!==-1);return s}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(n===null)return null;const{vectors:r}=this,i=t*4;return r[i]||r[i+1]?this._clipInfinite(t,n,r[i],r[i+1],r[i+2],r[i+3]):this._clipFinite(t,n)}_clipFinite(t,n){const r=n.length;let i=null,a,o,s=n[r-2],u=n[r-1],l,c=this._regioncode(s,u),f,d;for(let h=0;h<r;h+=2)if(a=s,o=u,s=n[h],u=n[h+1],l=c,c=this._regioncode(s,u),l===0&&c===0)f=d,d=0,i?i.push(s,u):i=[s,u];else{let p,g,m,v,y;if(l===0){if((p=this._clipSegment(a,o,s,u,l,c))===null)continue;[g,m,v,y]=p}else{if((p=this._clipSegment(s,u,a,o,c,l))===null)continue;[v,y,g,m]=p,f=d,d=this._edgecode(g,m),f&&d&&this._edge(t,f,d,i,i.length),i?i.push(g,m):i=[g,m]}f=d,d=this._edgecode(v,y),f&&d&&this._edge(t,f,d,i,i.length),i?i.push(v,y):i=[v,y]}if(i)f=d,d=this._edgecode(i[0],i[1]),f&&d&&this._edge(t,f,d,i,i.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return i}_clipSegment(t,n,r,i,a,o){for(;;){if(a===0&&o===0)return[t,n,r,i];if(a&o)return null;let s,u,l=a||o;l&8?(s=t+(r-t)*(this.ymax-n)/(i-n),u=this.ymax):l&4?(s=t+(r-t)*(this.ymin-n)/(i-n),u=this.ymin):l&2?(u=n+(i-n)*(this.xmax-t)/(r-t),s=this.xmax):(u=n+(i-n)*(this.xmin-t)/(r-t),s=this.xmin),a?(t=s,n=u,a=this._regioncode(t,n)):(r=s,i=u,o=this._regioncode(r,i))}}_clipInfinite(t,n,r,i,a,o){let s=Array.from(n),u;if((u=this._project(s[0],s[1],r,i))&&s.unshift(u[0],u[1]),(u=this._project(s[s.length-2],s[s.length-1],a,o))&&s.push(u[0],u[1]),s=this._clipFinite(t,s))for(let l=0,c=s.length,f,d=this._edgecode(s[c-2],s[c-1]);l<c;l+=2)f=d,d=this._edgecode(s[l],s[l+1]),f&&d&&(l=this._edge(t,f,d,s,l),c=s.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(s=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return s}_edge(t,n,r,i,a){for(;n!==r;){let o,s;switch(n){case 5:n=4;continue;case 4:n=6,o=this.xmax,s=this.ymin;break;case 6:n=2;continue;case 2:n=10,o=this.xmax,s=this.ymax;break;case 10:n=8;continue;case 8:n=9,o=this.xmin,s=this.ymax;break;case 9:n=1;continue;case 1:n=5,o=this.xmin,s=this.ymin;break}(i[a]!==o||i[a+1]!==s)&&this.contains(t,o,s)&&(i.splice(a,0,o,s),a+=2)}if(i.length>4)for(let o=0;o<i.length;o+=2){const s=(o+2)%i.length,u=(o+4)%i.length;(i[o]===i[s]&&i[s]===i[u]||i[o+1]===i[s+1]&&i[s+1]===i[u+1])&&(i.splice(s,2),o-=2)}return a}_project(t,n,r,i){let a=1/0,o,s,u;if(i<0){if(n<=this.ymin)return null;(o=(this.ymin-n)/i)<a&&(u=this.ymin,s=t+(a=o)*r)}else if(i>0){if(n>=this.ymax)return null;(o=(this.ymax-n)/i)<a&&(u=this.ymax,s=t+(a=o)*r)}if(r>0){if(t>=this.xmax)return null;(o=(this.xmax-t)/r)<a&&(s=this.xmax,u=n+(a=o)*i)}else if(r<0){if(t<=this.xmin)return null;(o=(this.xmin-t)/r)<a&&(s=this.xmin,u=n+(a=o)*i)}return[s,u]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}}const Pat=2*Math.PI,n0=Math.pow;function $at(e){return e[0]}function Lat(e){return e[1]}function Bat(e){const{triangles:t,coords:n}=e;for(let r=0;r<t.length;r+=3){const i=2*t[r],a=2*t[r+1],o=2*t[r+2];if((n[o]-n[i])*(n[a+1]-n[i+1])-(n[a]-n[i])*(n[o+1]-n[i+1])>1e-10)return!1}return!0}function zat(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class O6{static from(t,n=$at,r=Lat,i){return new O6("length"in t?jat(t,n,r,i):Float64Array.from(Uat(t,n,r,i)))}constructor(t){this._delaunator=new pT(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&Bat(t)){this.collinear=Int32Array.from({length:n.length/2},(d,h)=>h).sort((d,h)=>n[2*d]-n[2*h]||n[2*d+1]-n[2*h+1]);const u=this.collinear[0],l=this.collinear[this.collinear.length-1],c=[n[2*u],n[2*u+1],n[2*l],n[2*l+1]],f=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let d=0,h=n.length/2;d<h;++d){const p=zat(n[2*d],n[2*d+1],f);n[2*d]=p[0],n[2*d+1]=p[1]}this._delaunator=new pT(n)}else delete this.collinear;const r=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,a=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),s=this._hullIndex.fill(-1);for(let u=0,l=r.length;u<l;++u){const c=a[u%3==2?u-2:u+1];(r[u]===-1||o[c]===-1)&&(o[c]=u)}for(let u=0,l=i.length;u<l;++u)s[i[u]]=u;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],this.triangles[1]=i[1],this.triangles[2]=i[1],o[i[0]]=1,i.length===2&&(o[i[1]]=0))}voronoi(t){return new Mat(this,t)}*neighbors(t){const{inedges:n,hull:r,_hullIndex:i,halfedges:a,triangles:o,collinear:s}=this;if(s){const f=s.indexOf(t);f>0&&(yield s[f-1]),f<s.length-1&&(yield s[f+1]);return}const u=n[t];if(u===-1)return;let l=u,c=-1;do{if(yield c=o[l],l=l%3==2?l-2:l+1,o[l]!==t)return;if(l=a[l],l===-1){const f=r[(i[t]+1)%r.length];f!==c&&(yield f);return}}while(l!==u)}find(t,n,r=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;const i=r;let a;for(;(a=this._step(r,t,n))>=0&&a!==r&&a!==i;)r=a;return a}_step(t,n,r){const{inedges:i,hull:a,_hullIndex:o,halfedges:s,triangles:u,points:l}=this;if(i[t]===-1||!l.length)return(t+1)%(l.length>>1);let c=t,f=n0(n-l[t*2],2)+n0(r-l[t*2+1],2);const d=i[t];let h=d;do{let p=u[h];const g=n0(n-l[p*2],2)+n0(r-l[p*2+1],2);if(g<f&&(f=g,c=p),h=h%3==2?h-2:h+1,u[h]!==t)break;if(h=s[h],h===-1){if(h=a[(o[t]+1)%a.length],h!==p&&n0(n-l[h*2],2)+n0(r-l[h*2+1],2)<f)return h;break}}while(h!==d);return c}render(t){const n=t==null?t=new $p:void 0,{points:r,halfedges:i,triangles:a}=this;for(let o=0,s=i.length;o<s;++o){const u=i[o];if(u<o)continue;const l=a[o]*2,c=a[u]*2;t.moveTo(r[l],r[l+1]),t.lineTo(r[c],r[c+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n=2){const r=t==null?t=new $p:void 0,{points:i}=this;for(let a=0,o=i.length;a<o;a+=2){const s=i[a],u=i[a+1];t.moveTo(s+n,u),t.arc(s,u,n,0,Pat)}return r&&r.value()}renderHull(t){const n=t==null?t=new $p:void 0,{hull:r,points:i}=this,a=r[0]*2,o=r.length;t.moveTo(i[a],i[a+1]);for(let s=1;s<o;++s){const u=2*r[s];t.lineTo(i[u],i[u+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new T6;return this.renderHull(t),t.value()}renderTriangle(t,n){const r=n==null?n=new $p:void 0,{points:i,triangles:a}=this,o=a[t*=3]*2,s=a[t+1]*2,u=a[t+2]*2;return n.moveTo(i[o],i[o+1]),n.lineTo(i[s],i[s+1]),n.lineTo(i[u],i[u+1]),n.closePath(),r&&r.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,r=t.length/3;n<r;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new T6;return this.renderTriangle(t,n),n.value()}}function jat(e,t,n,r){const i=e.length,a=new Float64Array(i*2);for(let o=0;o<i;++o){const s=e[o];a[o*2]=t.call(r,s,o,e),a[o*2+1]=n.call(r,s,o,e)}return a}function*Uat(e,t,n,r){let i=0;for(const a of e)yield t.call(r,a,i,e),yield n.call(r,a,i,e),++i}function I6(e){ve.call(this,null,e)}I6.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const Wat=[-1e5,-1e5,1e5,1e5];$e(I6,ve,{transform(e,t){const n=e.as||"path",r=t.source;if(!r||!r.length)return t;let i=e.size;i=i?[0,0,i[0],i[1]]:(i=e.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:Wat;const a=this.value=O6.from(r,e.x,e.y).voronoi(i);for(let o=0,s=r.length;o<s;++o){const u=a.cellPolygon(o);r[o][n]=u?Vat(u):null}return t.reflow(e.modified()).modifies(n)}});function Vat(e){const t=e[0][0],n=e[0][1];let r=e.length-1;for(;e[r][0]===t&&e[r][1]===n;--r);return"M"+e.slice(0,r+1).join("L")+"Z"}var qat=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",voronoi:I6}),N6=Math.PI/180,zx=1<<11>>5,mT=1<<11;function Hat(){var e=[256,256],t,n,r,i,a,o,s,u=Zfe,l=[],c=Math.random,f={};f.layout=function(){for(var p=d(Cv()),g=Jat((e[0]>>5)*e[1]),m=null,v=l.length,y=-1,b=[],x=l.map(S=>({text:t(S),font:n(S),style:i(S),weight:a(S),rotate:o(S),size:~~(r(S)+1e-14),padding:s(S),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:S})).sort((S,C)=>C.size-S.size);++y<v;){var w=x[y];w.x=e[0]*(c()+.5)>>1,w.y=e[1]*(c()+.5)>>1,Gat(p,w,x,y),w.hasText&&h(g,w,m)&&(b.push(w),m?Xat(m,w):m=[{x:w.x+w.x0,y:w.y+w.y0},{x:w.x+w.x1,y:w.y+w.y1}],w.x-=e[0]>>1,w.y-=e[1]>>1)}return b};function d(p){p.width=p.height=1;var g=Math.sqrt(p.getContext("2d").getImageData(0,0,1,1).data.length>>2);p.width=(zx<<5)/g,p.height=mT/g;var m=p.getContext("2d");return m.fillStyle=m.strokeStyle="red",m.textAlign="center",{context:m,ratio:g}}function h(p,g,m){for(var v=g.x,y=g.y,b=Math.sqrt(e[0]*e[0]+e[1]*e[1]),x=u(e),w=c()<.5?1:-1,S=-w,C,_,E;(C=x(S+=w))&&(_=~~C[0],E=~~C[1],!(Math.min(Math.abs(_),Math.abs(E))>=b));)if(g.x=v+_,g.y=y+E,!(g.x+g.x0<0||g.y+g.y0<0||g.x+g.x1>e[0]||g.y+g.y1>e[1])&&(!m||!Kat(g,p,e[0]))&&(!m||Yat(g,m))){for(var A=g.sprite,k=g.width>>5,T=e[0]>>5,I=g.x-(k<<4),N=I&127,O=32-N,D=g.y1-g.y0,L=(g.y+g.y0)*T+(I>>5),W,G=0;G<D;G++){W=0;for(var K=0;K<=k;K++)p[L+K]|=W<<O|(K<k?(W=A[G*k+K])>>>N:0);L+=T}return g.sprite=null,!0}return!1}return f.words=function(p){return arguments.length?(l=p,f):l},f.size=function(p){return arguments.length?(e=[+p[0],+p[1]],f):e},f.font=function(p){return arguments.length?(n=Lp(p),f):n},f.fontStyle=function(p){return arguments.length?(i=Lp(p),f):i},f.fontWeight=function(p){return arguments.length?(a=Lp(p),f):a},f.rotate=function(p){return arguments.length?(o=Lp(p),f):o},f.text=function(p){return arguments.length?(t=Lp(p),f):t},f.spiral=function(p){return arguments.length?(u=Qat[p]||p,f):u},f.fontSize=function(p){return arguments.length?(r=Lp(p),f):r},f.padding=function(p){return arguments.length?(s=Lp(p),f):s},f.random=function(p){return arguments.length?(c=p,f):c},f}function Gat(e,t,n,r){if(!t.sprite){var i=e.context,a=e.ratio;i.clearRect(0,0,(zx<<5)/a,mT/a);var o=0,s=0,u=0,l=n.length,c,f,d,h,p;for(--r;++r<l;){if(t=n[r],i.save(),i.font=t.style+" "+t.weight+" "+~~((t.size+1)/a)+"px "+t.font,c=i.measureText(t.text+"m").width*a,d=t.size<<1,t.rotate){var g=Math.sin(t.rotate*N6),m=Math.cos(t.rotate*N6),v=c*m,y=c*g,b=d*m,x=d*g;c=Math.max(Math.abs(v+x),Math.abs(v-x))+31>>5<<5,d=~~Math.max(Math.abs(y+b),Math.abs(y-b))}else c=c+31>>5<<5;if(d>u&&(u=d),o+c>=zx<<5&&(o=0,s+=u,u=0),s+d>=mT)break;i.translate((o+(c>>1))/a,(s+(d>>1))/a),t.rotate&&i.rotate(t.rotate*N6),i.fillText(t.text,0,0),t.padding&&(i.lineWidth=2*t.padding,i.strokeText(t.text,0,0)),i.restore(),t.width=c,t.height=d,t.xoff=o,t.yoff=s,t.x1=c>>1,t.y1=d>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,o+=c}for(var w=i.getImageData(0,0,(zx<<5)/a,mT/a).data,S=[];--r>=0;)if(t=n[r],!!t.hasText){for(c=t.width,f=c>>5,d=t.y1-t.y0,h=0;h<d*f;h++)S[h]=0;if(o=t.xoff,o==null)return;s=t.yoff;var C=0,_=-1;for(p=0;p<d;p++){for(h=0;h<c;h++){var E=f*p+(h>>5),A=w[(s+p)*(zx<<5)+(o+h)<<2]?1<<31-h%32:0;S[E]|=A,C|=A}C?_=p:(t.y0++,d--,p--,s++)}t.y1=t.y0+_,t.sprite=S.slice(0,(t.y1-t.y0)*f)}}}function Kat(e,t,n){n>>=5;for(var r=e.sprite,i=e.width>>5,a=e.x-(i<<4),o=a&127,s=32-o,u=e.y1-e.y0,l=(e.y+e.y0)*n+(a>>5),c,f=0;f<u;f++){c=0;for(var d=0;d<=i;d++)if((c<<s|(d<i?(c=r[f*i+d])>>>o:0))&t[l+d])return!0;l+=n}return!1}function Xat(e,t){var n=e[0],r=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>r.x&&(r.x=t.x+t.x1),t.y+t.y1>r.y&&(r.y=t.y+t.y1)}function Yat(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function Zfe(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function Zat(e){var t=4,n=t*e[0]/e[1],r=0,i=0;return function(a){var o=a<0?-1:1;switch(Math.sqrt(1+4*o*a)-o&3){case 0:r+=n;break;case 1:i+=t;break;case 2:r-=n;break;default:i-=t;break}return[r,i]}}function Jat(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function Lp(e){return typeof e=="function"?e:function(){return e}}var Qat={archimedean:Zfe,rectangular:Zat};const Jfe=["x","y","font","fontSize","fontStyle","fontWeight","angle"],eot=["text","font","rotate","fontSize","fontStyle","fontWeight"];function D6(e){ve.call(this,Hat(),e)}D6.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:Jfe}]},$e(D6,ve,{transform(e,t){e.size&&!(e.size[0]&&e.size[1])&&Se("Wordcloud size dimensions must be non-zero.");function n(p){const g=e[p];return Lt(g)&&t.modified(g.fields)}const r=e.modified();if(!(r||t.changed(t.ADD_REM)||eot.some(n)))return;const i=t.materialize(t.SOURCE).source,a=this.value,o=e.as||Jfe;let s=e.fontSize||14,u;if(Lt(s)?u=e.fontSizeRange:s=Ji(s),u){const p=s,g=Sn("sqrt")().domain(tl(i,p)).range(u);s=m=>g(p(m))}i.forEach(p=>{p[o[0]]=NaN,p[o[1]]=NaN,p[o[3]]=0});const l=a.words(i).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(s).random(ds).layout(),c=a.size(),f=c[0]>>1,d=c[1]>>1,h=l.length;for(let p=0,g,m;p<h;++p)g=l[p],m=g.datum,m[o[0]]=g.x+f,m[o[1]]=g.y+d,m[o[2]]=g.font,m[o[3]]=g.size,m[o[4]]=g.style,m[o[5]]=g.weight,m[o[6]]=g.rotate;return t.reflow(r).modifies(o)}});var tot=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",wordcloud:D6});const not=e=>new Uint8Array(e),rot=e=>new Uint16Array(e),jx=e=>new Uint32Array(e);function iot(){let e=8,t=[],n=jx(0),r=vT(0,e),i=vT(0,e);return{data:()=>t,seen:()=>n=aot(n,t.length),add(a){for(let o=0,s=t.length,u=a.length,l;o<u;++o)l=a[o],l._index=s++,t.push(l)},remove(a,o){const s=t.length,u=Array(s-a),l=t;let c,f,d;for(f=0;!o[f]&&f<s;++f)u[f]=t[f],l[f]=f;for(d=f;f<s;++f)c=t[f],o[f]?l[f]=-1:(l[f]=d,r[d]=r[f],i[d]=i[f],u[d]=c,c._index=d++),r[f]=0;return t=u,l},size:()=>t.length,curr:()=>r,prev:()=>i,reset:a=>i[a]=r[a],all:()=>e<257?255:e<65537?65535:4294967295,set(a,o){r[a]|=o},clear(a,o){r[a]&=~o},resize(a,o){const s=r.length;(a>s||o>e)&&(e=Math.max(o,e),r=vT(a,e,r),i=vT(a,e))}}}function aot(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function vT(e,t,n){const r=(t<257?not:t<65537?rot:jx)(e);return n&&r.set(n),r}function Qfe(e,t,n){const r=1<<t;return{one:r,zero:~r,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(i,a){const o=this,s=o.bisect(o.range,i.value),u=i.index,l=s[0],c=s[1],f=u.length;let d;for(d=0;d<l;++d)a[u[d]]|=r;for(d=c;d<f;++d)a[u[d]]|=r;return o}}}function ede(){let e=jx(0),t=[],n=0;function r(s,u,l){if(!u.length)return[];const c=n,f=u.length,d=jx(f);let h=Array(f),p,g,m;for(m=0;m<f;++m)h[m]=s(u[m]),d[m]=m;if(h=oot(h,d),c)p=t,g=e,t=Array(c+f),e=jx(c+f),sot(l,p,g,c,h,d,f,t,e);else{if(l>0)for(m=0;m<f;++m)d[m]+=l;t=h,e=d}return n=c+f,{index:d,value:h}}function i(s,u){const l=n;let c,f,d;for(f=0;!u[e[f]]&&f<l;++f);for(d=f;f<l;++f)u[c=e[f]]||(e[d]=c,t[d]=t[f],++d);n=l-s}function a(s){for(let u=0,l=n;u<l;++u)e[u]=s[e[u]]}function o(s,u){let l;return u?l=u.length:(u=t,l=n),[aHe(u,s[0],0,l),rd(u,s[1],0,l)]}return{insert:r,remove:i,bisect:o,reindex:a,index:()=>e,size:()=>n}}function oot(e,t){return e.sort.call(t,(n,r)=>{const i=e[n],a=e[r];return i<a?-1:i>a?1:0}),uHe(e,t)}function sot(e,t,n,r,i,a,o,s,u){let l=0,c=0,f;for(f=0;l<r&&c<o;++f)t[l]<i[c]?(s[f]=t[l],u[f]=n[l++]):(s[f]=i[c],u[f]=a[c++]+e);for(;l<r;++l,++f)s[f]=t[l],u[f]=n[l];for(;c<o;++c,++f)s[f]=i[c],u[f]=a[c]+e}function R6(e){ve.call(this,iot(),e),this._indices=null,this._dims=null}R6.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]},$e(R6,ve,{transform(e,t){if(this._dims){var n=e.modified("fields")||e.fields.some(r=>t.modified(r.fields));return n?this.reinit(e,t):this.eval(e,t)}else return this.init(e,t)},init(e,t){const n=e.fields,r=e.query,i=this._indices={},a=this._dims=[],o=r.length;let s=0,u,l;for(;s<o;++s)u=n[s].fname,l=i[u]||(i[u]=ede()),a.push(Qfe(l,s,r[s]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),r=e.fields,i=e.query,a=this._indices,o=this._dims,s=this.value,u=s.curr(),l=s.prev(),c=s.all(),f=n.rem=n.add,d=n.mod,h=i.length,p={};let g,m,v,y,b,x,w,S,C;if(l.set(u),t.rem.length&&(b=this.remove(e,t,n)),t.add.length&&s.add(t.add),t.mod.length)for(x={},y=t.mod,w=0,S=y.length;w<S;++w)x[y[w]._index]=1;for(w=0;w<h;++w)C=r[w],(!o[w]||e.modified("fields",w)||t.modified(C.fields))&&(v=C.fname,(g=p[v])||(a[v]=m=ede(),p[v]=g=m.insert(C,t.source,0)),o[w]=Qfe(m,w,i[w]).onAdd(g,u));for(w=0,S=s.data().length;w<S;++w)b[w]||(l[w]!==u[w]?f.push(w):x[w]&&u[w]!==c&&d.push(w));return s.mask=(1<<h)-1,n},eval(e,t){const n=t.materialize().fork(),r=this._dims.length;let i=0;return t.rem.length&&(this.remove(e,t,n),i|=(1<<r)-1),e.modified("query")&&!e.modified("fields")&&(i|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),i|=(1<<r)-1),t.mod.length&&(this.modify(t,n),i|=(1<<r)-1),this.value.mask=i,n},insert(e,t,n){const r=t.add,i=this.value,a=this._dims,o=this._indices,s=e.fields,u={},l=n.add,c=i.size()+r.length,f=a.length;let d=i.size(),h,p,g;i.resize(c,f),i.add(r);const m=i.curr(),v=i.prev(),y=i.all();for(h=0;h<f;++h)p=s[h].fname,g=u[p]||(u[p]=o[p].insert(s[h],r,d)),a[h].onAdd(g,m);for(;d<c;++d)v[d]=y,m[d]!==y&&l.push(d)},modify(e,t){const n=t.mod,r=this.value,i=r.curr(),a=r.all(),o=e.mod;let s,u,l;for(s=0,u=o.length;s<u;++s)l=o[s]._index,i[l]!==a&&n.push(l)},remove(e,t,n){const r=this._indices,i=this.value,a=i.curr(),o=i.prev(),s=i.all(),u={},l=n.rem,c=t.rem;let f,d,h,p;for(f=0,d=c.length;f<d;++f)h=c[f]._index,u[h]=1,o[h]=p=a[h],a[h]=s,p!==s&&l.push(h);for(h in r)r[h].remove(d,u);return this.reindex(t,d,u),u},reindex(e,t,n){const r=this._indices,i=this.value;e.runAfter(()=>{const a=i.remove(t,n);for(const o in r)r[o].reindex(a)})},update(e,t,n){const r=this._dims,i=e.query,a=t.stamp,o=r.length;let s=0,u,l;for(n.filters=0,l=0;l<o;++l)e.modified("query",l)&&(u=l,++s);if(s===1)s=r[u].one,this.incrementOne(r[u],i[u],n.add,n.rem);else for(l=0,s=0;l<o;++l)!e.modified("query",l)||(s|=r[l].one,this.incrementAll(r[l],i[l],a,n.add),n.rem=n.add);return s},incrementAll(e,t,n,r){const i=this.value,a=i.seen(),o=i.curr(),s=i.prev(),u=e.index(),l=e.bisect(e.range),c=e.bisect(t),f=c[0],d=c[1],h=l[0],p=l[1],g=e.one;let m,v,y;if(f<h)for(m=f,v=Math.min(h,d);m<v;++m)y=u[m],a[y]!==n&&(s[y]=o[y],a[y]=n,r.push(y)),o[y]^=g;else if(f>h)for(m=h,v=Math.min(f,p);m<v;++m)y=u[m],a[y]!==n&&(s[y]=o[y],a[y]=n,r.push(y)),o[y]^=g;if(d>p)for(m=Math.max(f,p),v=d;m<v;++m)y=u[m],a[y]!==n&&(s[y]=o[y],a[y]=n,r.push(y)),o[y]^=g;else if(d<p)for(m=Math.max(h,d),v=p;m<v;++m)y=u[m],a[y]!==n&&(s[y]=o[y],a[y]=n,r.push(y)),o[y]^=g;e.range=t.slice()},incrementOne(e,t,n,r){const i=this.value,a=i.curr(),o=e.index(),s=e.bisect(e.range),u=e.bisect(t),l=u[0],c=u[1],f=s[0],d=s[1],h=e.one;let p,g,m;if(l<f)for(p=l,g=Math.min(f,c);p<g;++p)m=o[p],a[m]^=h,n.push(m);else if(l>f)for(p=f,g=Math.min(l,d);p<g;++p)m=o[p],a[m]^=h,r.push(m);if(c>d)for(p=Math.max(l,d),g=c;p<g;++p)m=o[p],a[m]^=h,n.push(m);else if(c<d)for(p=Math.max(f,c),g=d;p<g;++p)m=o[p],a[m]^=h,r.push(m);e.range=t.slice()}});function F6(e){ve.call(this,null,e)}F6.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},$e(F6,ve,{transform(e,t){const n=~(e.ignore||0),r=e.filter,i=r.mask;if((i&n)==0)return t.StopPropagation;const a=t.fork(t.ALL),o=r.data(),s=r.curr(),u=r.prev(),l=c=>s[c]&n?null:o[c];return a.filter(a.MOD,l),i&i-1?(a.filter(a.ADD,c=>{const f=s[c]&n;return!f&&f^u[c]&n?o[c]:null}),a.filter(a.REM,c=>{const f=s[c]&n;return f&&!(f^(f^u[c]&n))?o[c]:null})):(a.filter(a.ADD,l),a.filter(a.REM,c=>(s[c]&n)===i?o[c]:null)),a.filter(a.SOURCE,c=>l(c._index))}});var uot=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",crossfilter:R6,resolvefilter:F6});const lot="RawCode",Bp="Literal",cot="Property",fot="Identifier",dot="ArrayExpression",hot="BinaryExpression",tde="CallExpression",pot="ConditionalExpression",got="LogicalExpression",mot="MemberExpression",vot="ObjectExpression",yot="UnaryExpression";function du(e){this.type=e}du.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=bot(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};function bot(e){switch(e.type){case dot:return e.elements;case hot:case got:return[e.left,e.right];case tde:return[e.callee].concat(e.arguments);case pot:return[e.test,e.consequent,e.alternate];case mot:return[e.object,e.property];case vot:return e.properties;case cot:return[e.key,e.value];case yot:return[e.argument];case fot:case Bp:case lot:default:return[]}}var bl,at,we,aa,zn,yT=1,Ux=2,zp=3,Md=4,bT=5,jp=6,ho=7,Wx=8,xot=9;bl={},bl[yT]="Boolean",bl[Ux]="<end>",bl[zp]="Identifier",bl[Md]="Keyword",bl[bT]="Null",bl[jp]="Numeric",bl[ho]="Punctuator",bl[Wx]="String",bl[xot]="RegularExpression";var wot="ArrayExpression",_ot="BinaryExpression",Sot="CallExpression",Eot="ConditionalExpression",nde="Identifier",Cot="Literal",Aot="LogicalExpression",kot="MemberExpression",Tot="ObjectExpression",Oot="Property",Iot="UnaryExpression",Si="Unexpected token %0",Not="Unexpected number",Dot="Unexpected string",Rot="Unexpected identifier",Fot="Unexpected reserved word",Mot="Unexpected end of input",M6="Invalid regular expression",P6="Invalid regular expression: missing /",rde="Octal literals are not allowed in strict mode.",Pot="Duplicate data property in object literal not allowed in strict mode",ji="ILLEGAL",Vx="Disabled.",$ot=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),Lot=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function xT(e,t){if(!e)throw new Error("ASSERT: "+t)}function $c(e){return e>=48&&e<=57}function $6(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function qx(e){return"01234567".indexOf(e)>=0}function Bot(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function Hx(e){return e===10||e===13||e===8232||e===8233}function Gx(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&$ot.test(String.fromCharCode(e))}function wT(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&Lot.test(String.fromCharCode(e))}const zot={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function ide(){for(;we<aa;){const e=at.charCodeAt(we);if(Bot(e)||Hx(e))++we;else break}}function L6(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)we<aa&&$6(at[we])?(r=at[we++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):En({},Si,ji);return String.fromCharCode(i)}function jot(){var e,t,n,r;for(e=at[we],t=0,e==="}"&&En({},Si,ji);we<aa&&(e=at[we++],!!$6(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&En({},Si,ji),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function ade(){var e,t;for(e=at.charCodeAt(we++),t=String.fromCharCode(e),e===92&&(at.charCodeAt(we)!==117&&En({},Si,ji),++we,e=L6("u"),(!e||e==="\\"||!Gx(e.charCodeAt(0)))&&En({},Si,ji),t=e);we<aa&&(e=at.charCodeAt(we),!!wT(e));)++we,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),at.charCodeAt(we)!==117&&En({},Si,ji),++we,e=L6("u"),(!e||e==="\\"||!wT(e.charCodeAt(0)))&&En({},Si,ji),t+=e);return t}function Uot(){var e,t;for(e=we++;we<aa;){if(t=at.charCodeAt(we),t===92)return we=e,ade();if(wT(t))++we;else break}return at.slice(e,we)}function Wot(){var e,t,n;return e=we,t=at.charCodeAt(we)===92?ade():Uot(),t.length===1?n=zp:zot.hasOwnProperty(t)?n=Md:t==="null"?n=bT:t==="true"||t==="false"?n=yT:n=zp,{type:n,value:t,start:e,end:we}}function B6(){var e=we,t=at.charCodeAt(we),n,r=at[we],i,a,o;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++we,{type:ho,value:String.fromCharCode(t),start:e,end:we};default:if(n=at.charCodeAt(we+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return we+=2,{type:ho,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:we};case 33:case 61:return we+=2,at.charCodeAt(we)===61&&++we,{type:ho,value:at.slice(e,we),start:e,end:we}}}if(o=at.substr(we,4),o===">>>=")return we+=4,{type:ho,value:o,start:e,end:we};if(a=o.substr(0,3),a===">>>"||a==="<<="||a===">>=")return we+=3,{type:ho,value:a,start:e,end:we};if(i=a.substr(0,2),r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>")return we+=2,{type:ho,value:i,start:e,end:we};if(i==="//"&&En({},Si,ji),"<>=!+-*%&|^/".indexOf(r)>=0)return++we,{type:ho,value:r,start:e,end:we};En({},Si,ji)}function Vot(e){let t="";for(;we<aa&&$6(at[we]);)t+=at[we++];return t.length===0&&En({},Si,ji),Gx(at.charCodeAt(we))&&En({},Si,ji),{type:jp,value:parseInt("0x"+t,16),start:e,end:we}}function qot(e){let t="0"+at[we++];for(;we<aa&&qx(at[we]);)t+=at[we++];return(Gx(at.charCodeAt(we))||$c(at.charCodeAt(we)))&&En({},Si,ji),{type:jp,value:parseInt(t,8),octal:!0,start:e,end:we}}function ode(){var e,t,n;if(n=at[we],xT($c(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=we,e="",n!=="."){if(e=at[we++],n=at[we],e==="0"){if(n==="x"||n==="X")return++we,Vot(t);if(qx(n))return qot(t);n&&$c(n.charCodeAt(0))&&En({},Si,ji)}for(;$c(at.charCodeAt(we));)e+=at[we++];n=at[we]}if(n==="."){for(e+=at[we++];$c(at.charCodeAt(we));)e+=at[we++];n=at[we]}if(n==="e"||n==="E")if(e+=at[we++],n=at[we],(n==="+"||n==="-")&&(e+=at[we++]),$c(at.charCodeAt(we)))for(;$c(at.charCodeAt(we));)e+=at[we++];else En({},Si,ji);return Gx(at.charCodeAt(we))&&En({},Si,ji),{type:jp,value:parseFloat(e),start:t,end:we}}function Hot(){var e="",t,n,r,i,a=!1;for(t=at[we],xT(t==="'"||t==='"',"String literal must starts with a quote"),n=we,++we;we<aa;)if(r=at[we++],r===t){t="";break}else if(r==="\\")if(r=at[we++],!r||!Hx(r.charCodeAt(0)))switch(r){case"u":case"x":at[we]==="{"?(++we,e+=jot()):e+=L6(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:qx(r)?(i="01234567".indexOf(r),i!==0&&(a=!0),we<aa&&qx(at[we])&&(a=!0,i=i*8+"01234567".indexOf(at[we++]),"0123".indexOf(r)>=0&&we<aa&&qx(at[we])&&(i=i*8+"01234567".indexOf(at[we++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&at[we]===`
`&&++we;else{if(Hx(r.charCodeAt(0)))break;e+=r}return t!==""&&En({},Si,ji),{type:Wx,value:e,octal:a,start:n,end:we}}function Got(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(r,i)=>{if(parseInt(i,16)<=1114111)return"x";En({},M6)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){En({},M6)}try{return new RegExp(e,t)}catch(r){return null}}function Kot(){var e,t,n,r,i;for(e=at[we],xT(e==="/","Regular expression literal must start with a slash"),t=at[we++],n=!1,r=!1;we<aa;)if(e=at[we++],t+=e,e==="\\")e=at[we++],Hx(e.charCodeAt(0))&&En({},P6),t+=e;else if(Hx(e.charCodeAt(0)))En({},P6);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||En({},P6),i=t.substr(1,t.length-2),{value:i,literal:t}}function Xot(){var e,t,n;for(t="",n="";we<aa&&(e=at[we],!!wT(e.charCodeAt(0)));)++we,e==="\\"&&we<aa?En({},Si,ji):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&En({},M6,n),{value:n,literal:t}}function Yot(){var e,t,n,r;return zn=null,ide(),e=we,t=Kot(),n=Xot(),r=Got(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:we}}function Zot(e){return e.type===zp||e.type===Md||e.type===yT||e.type===bT}function sde(){if(ide(),we>=aa)return{type:Ux,start:we,end:we};const e=at.charCodeAt(we);return Gx(e)?Wot():e===40||e===41||e===59?B6():e===39||e===34?Hot():e===46?$c(at.charCodeAt(we+1))?ode():B6():$c(e)?ode():B6()}function po(){const e=zn;return we=e.end,zn=sde(),we=e.end,e}function ude(){const e=we;zn=sde(),we=e}function Jot(e){const t=new du(wot);return t.elements=e,t}function lde(e,t,n){const r=new du(e==="||"||e==="&&"?Aot:_ot);return r.operator=e,r.left=t,r.right=n,r}function Qot(e,t){const n=new du(Sot);return n.callee=e,n.arguments=t,n}function est(e,t,n){const r=new du(Eot);return r.test=e,r.consequent=t,r.alternate=n,r}function z6(e){const t=new du(nde);return t.name=e,t}function Kx(e){const t=new du(Cot);return t.value=e.value,t.raw=at.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function cde(e,t,n){const r=new du(kot);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function tst(e){const t=new du(Tot);return t.properties=e,t}function fde(e,t,n){const r=new du(Oot);return r.key=t,r.value=n,r.kind=e,r}function nst(e,t){const n=new du(Iot);return n.operator=e,n.argument=t,n.prefix=!0,n}function En(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,(a,o)=>(xT(o<r.length,"Message reference must be in range"),r[o]));throw n=new Error(i),n.index=we,n.description=i,n}function _T(e){e.type===Ux&&En(e,Mot),e.type===jp&&En(e,Not),e.type===Wx&&En(e,Dot),e.type===zp&&En(e,Rot),e.type===Md&&En(e,Fot),En(e,Si,e.value)}function oa(e){const t=po();(t.type!==ho||t.value!==e)&&_T(t)}function ir(e){return zn.type===ho&&zn.value===e}function j6(e){return zn.type===Md&&zn.value===e}function rst(){const e=[];for(we=zn.start,oa("[");!ir("]");)ir(",")?(po(),e.push(null)):(e.push(Up()),ir("]")||oa(","));return po(),Jot(e)}function dde(){we=zn.start;const e=po();return e.type===Wx||e.type===jp?(e.octal&&En(e,rde),Kx(e)):z6(e.value)}function ist(){var e,t,n,r;if(we=zn.start,e=zn,e.type===zp)return n=dde(),oa(":"),r=Up(),fde("init",n,r);if(e.type===Ux||e.type===ho)_T(e);else return t=dde(),oa(":"),r=Up(),fde("init",t,r)}function ast(){var e=[],t,n,r,i={},a=String;for(we=zn.start,oa("{");!ir("}");)t=ist(),t.key.type===nde?n=t.key.name:n=a(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?En({},Pot):i[r]=!0,e.push(t),ir("}")||oa(",");return oa("}"),tst(e)}function ost(){oa("(");const e=U6();return oa(")"),e}const sst={if:1};function ust(){var e,t,n;if(ir("("))return ost();if(ir("["))return rst();if(ir("{"))return ast();if(e=zn.type,we=zn.start,e===zp||sst[zn.value])n=z6(po().value);else if(e===Wx||e===jp)zn.octal&&En(zn,rde),n=Kx(po());else{if(e===Md)throw new Error(Vx);e===yT?(t=po(),t.value=t.value==="true",n=Kx(t)):e===bT?(t=po(),t.value=null,n=Kx(t)):ir("/")||ir("/=")?(n=Kx(Yot()),ude()):_T(po())}return n}function lst(){const e=[];if(oa("("),!ir(")"))for(;we<aa&&(e.push(Up()),!ir(")"));)oa(",");return oa(")"),e}function cst(){we=zn.start;const e=po();return Zot(e)||_T(e),z6(e.value)}function fst(){return oa("."),cst()}function dst(){oa("[");const e=U6();return oa("]"),e}function hst(){var e,t,n;for(e=ust();;)if(ir("."))n=fst(),e=cde(".",e,n);else if(ir("("))t=lst(),e=Qot(e,t);else if(ir("["))n=dst(),e=cde("[",e,n);else break;return e}function hde(){const e=hst();if(zn.type===ho&&(ir("++")||ir("--")))throw new Error(Vx);return e}function ST(){var e,t;if(zn.type!==ho&&zn.type!==Md)t=hde();else{if(ir("++")||ir("--"))throw new Error(Vx);if(ir("+")||ir("-")||ir("~")||ir("!"))e=po(),t=ST(),t=nst(e.value,t);else{if(j6("delete")||j6("void")||j6("typeof"))throw new Error(Vx);t=hde()}}return t}function pde(e){let t=0;if(e.type!==ho&&e.type!==Md)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function pst(){var e,t,n,r,i,a,o,s,u,l;if(e=zn,u=ST(),r=zn,i=pde(r),i===0)return u;for(r.prec=i,po(),t=[e,zn],o=ST(),a=[u,r,o];(i=pde(zn))>0;){for(;a.length>2&&i<=a[a.length-2].prec;)o=a.pop(),s=a.pop().value,u=a.pop(),t.pop(),n=lde(s,u,o),a.push(n);r=po(),r.prec=i,a.push(r),t.push(zn),n=ST(),a.push(n)}for(l=a.length-1,n=a[l],t.pop();l>1;)t.pop(),n=lde(a[l-1].value,a[l-2],n),l-=2;return n}function Up(){var e,t,n;return e=pst(),ir("?")&&(po(),t=Up(),oa(":"),n=Up(),e=est(e,t,n)),e}function U6(){const e=Up();if(ir(","))throw new Error(Vx);return e}function gde(e){at=e,we=0,aa=at.length,zn=null,ude();const t=U6();if(zn.type!==Ux)throw new Error("Unexpect token after expression.");return t}var mde={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function vde(e){function t(o,s,u,l){let c=e(s[0]);return u&&(c=u+"("+c+")",u.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+o+(l<0?"":l===0?"()":"("+s.slice(1).map(e).join(",")+")")}function n(o,s,u){return l=>t(o,l,s,u)}const r="new Date",i="String",a="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(o){o.length<3&&Se("Missing arguments to clamp function."),o.length>3&&Se("Too many arguments to clamp function.");const s=o.map(e);return"Math.max("+s[1]+", Math.min("+s[2]+","+s[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),trim:n("trim",i,0),regexp:a,test:n("test",a),if:function(o){o.length<3&&Se("Missing arguments to if function."),o.length>3&&Se("Too many arguments to if function.");const s=o.map(e);return"("+s[0]+"?"+s[1]+":"+s[2]+")"}}}function gst(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function yde(e){e=e||{};const t=e.allowed?nu(e.allowed):{},n=e.forbidden?nu(e.forbidden):{},r=e.constants||mde,i=(e.functions||vde)(f),a=e.globalvar,o=e.fieldvar,s=Lt(a)?a:p=>"".concat(a,'["').concat(p,'"]');let u={},l={},c=0;function f(p){if(Bn(p))return p;const g=d[p.type];return g==null&&Se("Unsupported type: "+p.type),g(p)}const d={Literal:p=>p.raw,Identifier:p=>{const g=p.name;return c>0?g:_t(n,g)?Se("Illegal identifier: "+g):_t(r,g)?r[g]:_t(t,g)?g:(u[g]=1,s(g))},MemberExpression:p=>{const g=!p.computed,m=f(p.object);g&&(c+=1);const v=f(p.property);return m===o&&(l[gst(v)]=1),g&&(c-=1),m+(g?"."+v:"["+v+"]")},CallExpression:p=>{p.callee.type!=="Identifier"&&Se("Illegal callee type: "+p.callee.type);const g=p.callee.name,m=p.arguments,v=_t(i,g)&&i[g];return v||Se("Unrecognized function: "+g),Lt(v)?v(m):v+"("+m.map(f).join(",")+")"},ArrayExpression:p=>"["+p.elements.map(f).join(",")+"]",BinaryExpression:p=>"("+f(p.left)+" "+p.operator+" "+f(p.right)+")",UnaryExpression:p=>"("+p.operator+f(p.argument)+")",ConditionalExpression:p=>"("+f(p.test)+"?"+f(p.consequent)+":"+f(p.alternate)+")",LogicalExpression:p=>"("+f(p.left)+p.operator+f(p.right)+")",ObjectExpression:p=>"{"+p.properties.map(f).join(",")+"}",Property:p=>{c+=1;const g=f(p.key);return c-=1,g+":"+f(p.value)}};function h(p){const g={code:f(p),globals:Object.keys(u),fields:Object.keys(l)};return u={},l={},g}return h.functions=i,h.constants=r,h}function mst(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function vst(e){let t=e,n=e;e.length===1&&(t=(o,s)=>e(o)-s,n=yst(e));function r(o,s,u,l){for(u==null&&(u=0),l==null&&(l=o.length);u<l;){const c=u+l>>>1;n(o[c],s)<0?u=c+1:l=c}return u}function i(o,s,u,l){for(u==null&&(u=0),l==null&&(l=o.length);u<l;){const c=u+l>>>1;n(o[c],s)>0?l=c:u=c+1}return u}function a(o,s,u,l){u==null&&(u=0),l==null&&(l=o.length);const c=r(o,s,u,l-1);return c>u&&t(o[c-1],s)>-t(o[c],s)?c-1:c}return{left:r,center:a,right:i}}function yst(e){return(t,n)=>mst(e(t),n)}const W6="intersect",bde="union",bst="vlMulti",xst="vlPoint",xde="or",wst="and",_st="_vgsid_",Sst="E",Est="R",Cst="R-E",Ast="R-LE",kst="R-RE",ET="index:unit";function wde(e,t){for(var n=t.fields,r=t.values,i=n.length,a=0,o,s;a<i;++a)if(s=n[a],s.getter=io.getter||io(s.field),o=s.getter(e),ed(o)&&(o=Zi(o)),ed(r[a])&&(r[a]=Zi(r[a])),ed(r[a][0])&&(r[a]=r[a].map(Zi)),s.type===Sst){if(ut(r[a])?r[a].indexOf(o)<0:o!==r[a])return!1}else if(s.type===Est){if(!dv(o,r[a]))return!1}else if(s.type===kst){if(!dv(o,r[a],!0,!1))return!1}else if(s.type===Cst){if(!dv(o,r[a],!1,!1))return!1}else if(s.type===Ast&&!dv(o,r[a],!1,!0))return!1;return!0}function Tst(e,t,n){for(var r=this.context.data[e],i=r?r.values.value:[],a=r?r[ET]&&r[ET].value:void 0,o=n===W6,s=i.length,u=0,l,c,f,d,h;u<s;++u)if(l=i[u],a&&o){if(c=c||{},f=c[d=l.unit]||0,f===-1)continue;if(h=wde(t,l),c[d]=h?-1:++f,h&&a.size===1)return!0;if(!h&&f===a.get(d).count)return!1}else if(h=wde(t,l),o^h)return h;return s&&o}const V6=io(_st),_de=vst(V6),Ost=_de.left,Ist=_de.right;function Nst(e,t,n){const r=this.context.data[e],i=r?r.values.value:[],a=r?r[ET]&&r[ET].value:void 0,o=n===W6,s=V6(t),u=Ost(i,s);if(u===i.length||V6(i[u])!==s)return!1;if(a&&o){if(a.size===1)return!0;if(Ist(i,s)-u<a.size)return!1}return!0}function Dst(e,t){return e.map(n=>Rt({values:t.fields.map(r=>(r.getter||(r.getter=io(r.field)))(n.datum))},t))}function Rst(e,t,n,r){for(var i=this.context.data[e],a=i?i.values.value:[],o={},s={},u={},l,c,f,d,h,p,g,m,v,y=a.length,b=0,x,w;b<y;++b){for(l=a[b],d=l.unit,c=l.fields,f=l.values,x=0,w=c.length;x<w;++x)h=c[x],p=o[h.field]||(o[h.field]={}),g=p[d]||(p[d]=[]),u[h.field]=m=h.type.charAt(0),v=Sde[m+"_union"],p[d]=v(g,wt(f[x]));n&&(g=s[d]||(s[d]=[]),g.push(wt(f).reduce((S,C,_)=>(S[c[_].field]=C,S),{})))}if(t=t||bde,Object.keys(o).forEach(S=>{o[S]=Object.keys(o[S]).map(C=>o[S][C]).reduce((C,_)=>C===void 0?_:Sde[u[S]+"_"+t](C,_))}),a=Object.keys(s),n&&a.length){const S=r?xst:bst;o[S]=t===bde?{[xde]:a.reduce((C,_)=>(C.push(...s[_]),C),[])}:{[wst]:a.map(C=>({[xde]:s[C]}))}}return o}var Sde={E_union:function(e,t){if(!e.length)return t;for(var n=0,r=t.length;n<r;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.indexOf(n)>=0):t},R_union:function(e,t){var n=Zi(t[0]),r=Zi(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<r&&(e[1]=r),e):[n,r]},R_intersect:function(e,t){var n=Zi(t[0]),r=Zi(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?r<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>r&&(e[1]=r),e):[n,r]}};const Fst=":",Mst="@";function q6(e,t,n,r){t[0].type!==Bp&&Se("First argument to selection functions must be a string literal.");const i=t[0].value,a=t.length>=2&&sn(t).value,o="unit",s=Mst+o,u=Fst+i;a===W6&&!_t(r,s)&&(r[s]=n.getData(i).indataRef(n,o)),_t(r,u)||(r[u]=n.getData(i).tuplesRef())}function Ede(e){const t=this.context.data[e];return t?t.values.value:[]}function Pst(e,t,n){const r=this.context.data[e]["index:"+t],i=r?r.value.get(n):void 0;return i&&i.count}function $st(e,t){const n=this.context.dataflow,r=this.context.data[e],i=r.input;return n.pulse(i,n.changeset().remove(ls).insert(t)),1}function Lst(e,t,n){if(e){const r=this.context.dataflow,i=e.mark.source;r.pulse(i,r.changeset().encode(e,t))}return n!==void 0?n:e}const Xx=e=>function(t,n){return this.context.dataflow.locale()[e](n)(t)},Bst=Xx("format"),Cde=Xx("timeFormat"),zst=Xx("utcFormat"),jst=Xx("timeParse"),Ust=Xx("utcParse"),CT=new Date(2e3,0,1);function AT(e,t,n){return!Number.isInteger(e)||!Number.isInteger(t)?"":(CT.setYear(2e3),CT.setMonth(e),CT.setDate(t),Cde.call(this,CT,n))}function Wst(e){return AT.call(this,e,1,"%B")}function Vst(e){return AT.call(this,e,1,"%b")}function qst(e){return AT.call(this,0,2+e,"%A")}function Hst(e){return AT.call(this,0,2+e,"%a")}const Gst=":",Kst="@",H6="%",Ade="$";function G6(e,t,n,r){t[0].type!==Bp&&Se("First argument to data functions must be a string literal.");const i=t[0].value,a=Gst+i;if(!_t(a,r))try{r[a]=n.getData(i).tuplesRef()}catch(o){}}function Xst(e,t,n,r){t[0].type!==Bp&&Se("First argument to indata must be a string literal."),t[1].type!==Bp&&Se("Second argument to indata must be a string literal.");const i=t[0].value,a=t[1].value,o=Kst+a;_t(o,r)||(r[o]=n.getData(i).indataRef(n,a))}function go(e,t,n,r){if(t[0].type===Bp)kde(n,r,t[0].value);else for(e in n.scales)kde(n,r,e)}function kde(e,t,n){const r=H6+n;if(!_t(t,r))try{t[r]=e.scaleRef(n)}catch(i){}}function Lc(e,t){let n;return Lt(e)?e:Bn(e)?(n=t.scales[e])&&n.value:void 0}function Yst(e,t,n){t.__bandwidth=i=>i&&i.bandwidth?i.bandwidth():0,n._bandwidth=go,n._range=go,n._scale=go;const r=i=>"_["+(i.type===Bp?gt(H6+i.value):gt(H6)+"+"+e(i))+"]";return{_bandwidth:i=>"this.__bandwidth(".concat(r(i[0]),")"),_range:i=>"".concat(r(i[0]),".range()"),_scale:i=>"".concat(r(i[0]),"(").concat(e(i[1]),")")}}function K6(e,t){return function(n,r,i){if(n){const a=Lc(n,(i||this).context);return a&&a.path[e](r)}else return t(r)}}const Zst=K6("area",Ett),Jst=K6("bounds",Ttt),Qst=K6("centroid",Ftt);function eut(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function X6(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(r){e.warn(r)}return n[n.length-1]}function tut(){return X6(this.context.dataflow,"warn",arguments)}function nut(){return X6(this.context.dataflow,"info",arguments)}function rut(){return X6(this.context.dataflow,"debug",arguments)}function Y6(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Z6(e){const t=gd(e),n=Y6(t.r),r=Y6(t.g),i=Y6(t.b);return .2126*n+.7152*r+.0722*i}function iut(e,t){const n=Z6(e),r=Z6(t),i=Math.max(n,r),a=Math.min(n,r);return(i+.05)/(a+.05)}function aut(){const e=[].slice.call(arguments);return e.unshift({}),Rt(...e)}function Tde(e,t){return e===t||e!==e&&t!==t?!0:ut(e)?ut(t)&&e.length===t.length?out(e,t):!1:Nt(e)&&Nt(t)?Ode(e,t):!1}function out(e,t){for(let n=0,r=e.length;n<r;++n)if(!Tde(e[n],t[n]))return!1;return!0}function Ode(e,t){for(const n in e)if(!Tde(e[n],t[n]))return!1;return!0}function Ide(e){return t=>Ode(e,t)}function sut(e,t,n,r,i,a){const o=this.context.dataflow,s=this.context.data[e],u=s.input,l=o.stamp();let c=s.changes,f,d;if(o._trigger===!1||!(u.value.length||t||r))return 0;if((!c||c.stamp<l)&&(s.changes=c=o.changeset(),c.stamp=l,o.runAfter(()=>{s.modified=!0,o.pulse(u,c).run()},!0,1)),n&&(f=n===!0?ls:ut(n)||eA(n)?n:Ide(n),c.remove(f)),t&&c.insert(t),r&&(f=Ide(r),u.value.some(f)?c.remove(f):c.insert(r)),i)for(d in a)c.modify(i,d,a[d]);return 1}function uut(e){const t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+r*r)}function lut(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}const Nde={};function cut(e,t){const n=Nde[t]||(Nde[t]=io(t));return ut(e)?e.map(n):n(e)}function J6(e){return ut(e)||ArrayBuffer.isView(e)?e:null}function Q6(e){return J6(e)||(Bn(e)?e:null)}function fut(e,...t){return J6(e).join(...t)}function dut(e,...t){return Q6(e).indexOf(...t)}function hut(e,...t){return Q6(e).lastIndexOf(...t)}function put(e,...t){return Q6(e).slice(...t)}function gut(e,t,n){return Lt(n)&&Se("Function argument passed to replace."),String(e).replace(t,n)}function mut(e){return J6(e).slice().reverse()}function vut(e,t,n){return NB(e||0,t||0,n||0)}function yut(e,t){const n=Lc(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function but(e,t){const n=Lc(e,(t||this).context);return n?n.copy():void 0}function xut(e,t){const n=Lc(e,(t||this).context);return n?n.domain():[]}function wut(e,t,n){const r=Lc(e,(n||this).context);return r?ut(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t):void 0}function _ut(e,t){const n=Lc(e,(t||this).context);return n&&n.range?n.range():[]}function Sut(e,t,n){const r=Lc(e,(n||this).context);return r?r(t):void 0}function Eut(e,t,n,r,i){e=Lc(e,(i||this).context);const a=Use(t,n);let o=e.domain(),s=o[0],u=sn(o),l=Oa;return u-s?l=kse(e,s,u):e=(e.interpolator?Sn("sequential")().interpolator(e.interpolator()):Sn("linear")().interpolate(e.interpolate()).range(e.range())).domain([s=0,u=1]),e.ticks&&(o=e.ticks(+r||15),s!==o[0]&&o.unshift(s),u!==sn(o)&&o.push(u)),o.forEach(c=>a.stop(l(c),e(c))),a}function Cut(e,t,n){const r=Lc(e,(n||this).context);return function(i){return r?r.path.context(i)(t):""}}function Aut(e){let t=null;return function(n){return n?Z1(n,t=t||Mv(e)):e}}const Dde=e=>e.data;function Rde(e,t){const n=Ede.call(t,e);return n.root&&n.root.lookup||{}}function kut(e,t,n){const r=Rde(e,this),i=r[t],a=r[n];return i&&a?i.path(a).map(Dde):void 0}function Tut(e,t){const n=Rde(e,this)[t];return n?n.ancestors().map(Dde):void 0}const Fde=()=>typeof window!="undefined"&&window||null;function Out(){const e=Fde();return e?e.screen:{}}function Iut(){const e=Fde();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function Nut(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}function Dut(e,t,n){if(!e)return[];const[r,i]=e,a=new li().set(r[0],r[1],i[0],i[1]),o=n||this.context.dataflow.scenegraph().root;return nle(o,a,Rut(t))}function Rut(e){let t=null;if(e){const n=wt(e.marktype),r=wt(e.markname);t=i=>(!n.length||n.some(a=>i.marktype===a))&&(!r.length||r.some(a=>i.name===a))}return t}const Yx={random(){return ds()},cumulativeNormal:uA,cumulativeLogNormal:lL,cumulativeUniform:hL,densityNormal:iL,densityLogNormal:uL,densityUniform:dL,quantileNormal:lA,quantileLogNormal:cL,quantileUniform:pL,sampleNormal:sA,sampleLogNormal:sL,sampleUniform:fL,isArray:ut,isBoolean:a4,isDate:ed,isDefined(e){return e!==void 0},isNumber:td,isObject:Nt,isRegExp:Qne,isString:Bn,isTuple:eA,isValid(e){return e!=null&&e===e},toBoolean:s4,toDate:u4,toNumber:Zi,toString:l4,indexof:dut,join:fut,lastindexof:hut,replace:gut,reverse:mut,slice:put,flush:Zne,lerp:ere,merge:aut,pad:rre,peek:sn,pluck:cut,span:l1,inrange:dv,truncate:ire,rgb:gd,lab:EA,hcl:CA,hsl:_A,luminance:Z6,contrast:iut,sequence:Bo,format:Bst,utcFormat:zst,utcParse:Ust,utcOffset:Kre,utcSequence:Zre,timeFormat:Cde,timeParse:jst,timeOffset:Gre,timeSequence:Yre,timeUnitSpecifier:Pre,monthFormat:Wst,monthAbbrevFormat:Vst,dayFormat:qst,dayAbbrevFormat:Hst,quarter:Gne,utcquarter:Kne,week:Lre,utcweek:jre,dayofyear:$re,utcdayofyear:zre,warn:tut,info:nut,debug:rut,extent:tl,inScope:eut,intersect:Dut,clampRange:Xne,pinchDistance:uut,pinchAngle:lut,screen:Out,containerSize:Nut,windowSize:Iut,bandspace:vut,setdata:$st,pathShape:Aut,panLinear:Wne,panLog:Vne,panPow:qne,panSymlog:Hne,zoomLinear:e4,zoomLog:t4,zoomPow:zC,zoomSymlog:n4,encode:Lst,modify:sut},Fut=["view","item","group","xy","x","y"],Mut="event.vega.",Mde="this.",ej={},Pde={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>"_[".concat(gt(Ade+e),"]"),functions:Put,constants:mde,visitors:ej},tj=yde(Pde);function Put(e){const t=vde(e);Fut.forEach(n=>t[n]=Mut+n);for(const n in Yx)t[n]=Mde+n;return Rt(t,Yst(e,Yx,ej)),t}function Zr(e,t,n){return arguments.length===1?Yx[e]:(Yx[e]=t,n&&(ej[e]=n),tj&&(tj.functions[e]=Mde+e),this)}Zr("bandwidth",yut,go),Zr("copy",but,go),Zr("domain",xut,go),Zr("range",_ut,go),Zr("invert",wut,go),Zr("scale",Sut,go),Zr("gradient",Eut,go),Zr("geoArea",Zst,go),Zr("geoBounds",Jst,go),Zr("geoCentroid",Qst,go),Zr("geoShape",Cut,go),Zr("indata",Pst,Xst),Zr("data",Ede,G6),Zr("treePath",kut,G6),Zr("treeAncestors",Tut,G6),Zr("vlSelectionTest",Tst,q6),Zr("vlSelectionIdTest",Nst,q6),Zr("vlSelectionResolve",Rst,q6),Zr("vlSelectionTuples",Dst);function xl(e,t){const n={};let r;try{e=Bn(e)?e:gt(e)+"",r=gde(e)}catch(a){Se("Expression parse error: "+e)}r.visit(a=>{if(a.type!==tde)return;const o=a.callee.name,s=Pde.visitors[o];s&&s(o,a.arguments,t,n)});const i=tj(r);return i.globals.forEach(a=>{const o=Ade+a;!_t(n,o)&&t.getSignal(a)&&(n[o]=t.signalRef(a))}),{$expr:Rt({code:i.code},t.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}function $ut(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(r=>t.parseOperator(r)),n.forEach(r=>t.parseOperatorParameters(r)),(e.streams||[]).forEach(r=>t.parseStream(r)),(e.updates||[]).forEach(r=>t.parseUpdate(r)),t.resolve()}const Lut=nu(["rule"]),$de=nu(["group","image","rect"]);function But(e,t){let n="";return Lut[t]||(e.x2&&(e.x?($de[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?($de[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function nj(e){return(e+"").toLowerCase()}function zut(e){return nj(e)==="operator"}function jut(e){return nj(e)==="collect"}function Zx(e,t,n){n[n.length-1]!==";"&&(n="return("+n+");");const r=Function(...t.concat(n));return e&&e.functions?r.bind(e.functions):r}function Uut(e,t,n,r){return"((u = ".concat(e,") < (v = ").concat(t,") || u == null) && v != null ? ").concat(n,`
  : (u > v || v == null) && u != null ? `).concat(r,`
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? `).concat(n,`
  : v !== v && u === u ? `).concat(r," : ")}var Wut={operator:(e,t)=>Zx(e,["_"],t.code),parameter:(e,t)=>Zx(e,["datum","_"],t.code),event:(e,t)=>Zx(e,["event"],t.code),handler:(e,t)=>{const n="var datum=event.item&&event.item.datum;return ".concat(t.code,";");return Zx(e,["_","event"],n)},encode:(e,t)=>{const{marktype:n,channels:r}=t;let i="var o=item,datum=o.datum,m=0,$;";for(const a in r){const o="o["+gt(a)+"]";i+="$=".concat(r[a].code,";if(").concat(o,"!==$)").concat(o,"=$,m=1;")}return i+=But(r,n),i+="return m;",Zx(e,["item","_"],i)},codegen:{get(e){const t="[".concat(e.map(gt).join("]["),"]"),n=Function("_","return _".concat(t,";"));return n.path=t,n},comparator(e,t){let n;const r=(a,o)=>{const s=t[o];let u,l;return a.path?(u="a".concat(a.path),l="b".concat(a.path)):((n=n||{})["f"+o]=a,u="this.f".concat(o,"(a)"),l="this.f".concat(o,"(b)")),Uut(u,l,-s,s)},i=Function("a","b","var u, v; return "+e.map(r).join("")+"0;");return n?i.bind(n):i}}};function Vut(e){const t=this;zut(e.type)||!e.type?t.operator(e,e.update?t.operatorExpression(e.update):null):t.transform(e,e.type)}function qut(e){const t=this;if(e.params){const n=t.get(e.id);n||Se("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}}function Hut(e,t){t=t||{};const n=this;for(const r in e){const i=e[r];t[r]=ut(i)?i.map(a=>Lde(a,n,t)):Lde(i,n,t)}return t}function Lde(e,t,n){if(!e||!Nt(e))return e;for(let r=0,i=Bde.length,a;r<i;++r)if(a=Bde[r],_t(e,a.key))return a.parse(e,t,n);return e}var Bde=[{key:"$ref",parse:Gut},{key:"$key",parse:Xut},{key:"$expr",parse:Kut},{key:"$field",parse:Yut},{key:"$encode",parse:Jut},{key:"$compare",parse:Zut},{key:"$context",parse:Qut},{key:"$subflow",parse:elt},{key:"$tupleid",parse:tlt}];function Gut(e,t){return t.get(e.$ref)||Se("Operator not defined: "+e.$ref)}function Kut(e,t,n){e.$params&&t.parseParameters(e.$params,n);const r="e:"+e.$expr.code+"_"+e.$name;return t.fn[r]||(t.fn[r]=ro(t.parameterExpression(e.$expr),e.$fields,e.$name))}function Xut(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=o4(e.$key,e.$flat,t.expr.codegen))}function Yut(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=io(e.$field,e.$name,t.expr.codegen))}function Zut(e,t){const n="c:"+e.$compare+"_"+e.$order,r=wt(e.$compare).map(i=>i&&i.$tupleid?lt:i);return t.fn[n]||(t.fn[n]=r4(r,e.$order,t.expr.codegen))}function Jut(e,t){const n=e.$encode,r={};for(const i in n){const a=n[i];r[i]=ro(t.encodeExpression(a.$expr),a.$fields),r[i].output=a.$output}return r}function Qut(e,t){return t}function elt(e,t){const n=e.$subflow;return function(r,i,a){const o=t.fork().parse(n),s=o.get(n.operators[0].id),u=o.signals.parent;return u&&u.set(a),s.detachSubflow=()=>t.detach(o),s}}function tlt(){return lt}function nlt(e){var t=this,n=e.filter!=null?t.eventExpression(e.filter):void 0,r=e.stream!=null?t.get(e.stream):void 0,i;e.source?r=t.events(e.source,e.type,n):e.merge&&(i=e.merge.map(a=>t.get(a)),r=i[0].merge.apply(i[0],i.slice(1))),e.between&&(i=e.between.map(a=>t.get(a)),r=r.between(i[0],i[1])),e.filter&&(r=r.filter(n)),e.throttle!=null&&(r=r.throttle(+e.throttle)),e.debounce!=null&&(r=r.debounce(+e.debounce)),r==null&&Se("Invalid stream definition: "+JSON.stringify(e)),e.consume&&r.consume(!0),t.stream(e,r)}function rlt(e){var t=this,n=Nt(n=e.source)?n.$ref:n,r=t.get(n),i=null,a=e.update,o=void 0;r||Se("Source not defined: "+e.source),i=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),a&&a.$expr&&(a.$params&&(o=t.parseParameters(a.$params)),a=t.handlerExpression(a.$expr)),t.update(e,r,i,a,o)}const ilt={skip:!0};function alt(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach(a=>{const o=t.signals[a];e.signals(a,o)&&(r[a]=o.value)})}if(e.data){var i=n.data={};Object.keys(t.data).forEach(a=>{const o=t.data[a];e.data(a,o)&&(i[a]=o.input.value)})}return t.subcontext&&e.recurse!==!1&&(n.subcontext=t.subcontext.map(a=>a.getState(e))),n}function olt(e){var t=this,n=t.dataflow,r=e.data,i=e.signals;Object.keys(i||{}).forEach(a=>{n.update(t.signals[a],i[a],ilt)}),Object.keys(r||{}).forEach(a=>{n.pulse(t.data[a].input,n.changeset().remove(ls).insert(r[a]))}),(e.subcontext||[]).forEach((a,o)=>{const s=t.subcontext[o];s&&s.setState(a)})}function zde(e,t,n,r){return new jde(e,t,n,r)}function jde(e,t,n,r){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=r||Wut,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function Ude(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}jde.prototype=Ude.prototype={fork(){const e=new Ude(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,r=n.dataflow,i=e.value;if(n.set(e.id,t),jut(e.type)&&i&&(i.$ingest?r.ingest(t,i.$ingest,i.$format):i.$request?r.preload(t,i.$request,i.$format):r.pulse(t,r.changeset().insert(i))),e.root&&(n.root=t),e.parent){let a=n.get(e.parent.$ref);a?(r.connect(a,[t]),t.targets().add(a)):(n.unresolved=n.unresolved||[]).push(()=>{a=n.get(e.parent.$ref),r.connect(a,[t]),t.targets().add(a)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const a in e.data){const o=n.data[a]||(n.data[a]={});e.data[a].forEach(s=>o[s]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[nj(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,r,i){this.dataflow.on(t,n,r,i,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:$ut,parseOperator:Vut,parseOperatorParameters:qut,parseParameters:Hut,parseStream:nlt,parseUpdate:rlt,getState:alt,setState:olt};function slt(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),Wde(t,e.description()))}function Wde(e,t){e&&(t==null?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}function ult(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}const rj="default";function llt(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:rj,item:null}));e.on(e.events("view","mousemove"),t,(n,r)=>{const i=t.value,a=i?Bn(i)?i:i.user:rj,o=r.item&&r.item.cursor||null;return i&&a===i.user&&o==i.item?i:{user:a,item:o}}),e.add(null,function(n){let r=n.cursor,i=this.value;return Bn(r)||(i=r.item,r=r.user),ij(e,r&&r!==rj?r:i||r),i},{cursor:t})}function ij(e,t){const n=e.globalCursor()?typeof document!="undefined"&&document.body:e.container();if(n)return t==null?n.style.removeProperty("cursor"):n.style.cursor=t}function kT(e,t){var n=e._runtime.data;return _t(n,t)||Se("Unrecognized data set: "+t),n[t]}function clt(e,t){return arguments.length<2?kT(this,e).values.value:TT.call(this,e,vp().remove(ls).insert(t))}function TT(e,t){Die(t)||Se("Second argument to changes must be a changeset.");const n=kT(this,e);return n.modified=!0,this.pulse(n.input,t)}function flt(e,t){return TT.call(this,e,vp().insert(t))}function dlt(e,t){return TT.call(this,e,vp().remove(t))}function Vde(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function qde(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function OT(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function hlt(e){var t=OT(e),n=Vde(e),r=qde(e);e._renderer.background(e.background()),e._renderer.resize(n,r,t),e._handler.origin(t),e._resizeListeners.forEach(i=>{try{i(n,r)}catch(a){e.error(a)}})}function plt(e,t,n){var r=e._renderer,i=r&&r.canvas(),a,o,s;return i&&(s=OT(e),o=t.changedTouches?t.changedTouches[0]:t,a=ok(o,i),a[0]-=s[0],a[1]-=s[1]),t.dataflow=e,t.item=n,t.vega=glt(e,n,a),t}function glt(e,t,n){const r=t?t.mark.marktype==="group"?t:t.mark.group:null;function i(o){var s=r,u;if(o){for(u=t;u;u=u.mark.group)if(u.mark.name===o){s=u;break}}return s&&s.mark&&s.mark.interactive?s:{}}function a(o){if(!o)return n;Bn(o)&&(o=i(o));const s=n.slice();for(;o;)s[0]-=o.x||0,s[1]-=o.y||0,o=o.mark&&o.mark.group;return s}return{view:Ji(e),item:Ji(t||{}),group:i,xy:a,x:o=>a(o)[0],y:o=>a(o)[1]}}const Hde="view",mlt="timer",vlt="window",ylt={trap:!1};function blt(e){const t=Rt({defaults:{}},e),n=(r,i)=>{i.forEach(a=>{ut(r[a])&&(r[a]=nu(r[a]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}function Gde(e,t,n,r){e._eventListeners.push({type:n,sources:wt(t),handler:r})}function xlt(e,t){var n=e._eventConfig.defaults,r=n.prevent,i=n.allow;return r===!1||i===!0?!1:r===!0||i===!1?!0:r?r[t]:i?!i[t]:e.preventDefault()}function IT(e,t,n){const r=e._eventConfig&&e._eventConfig[t];return r===!1||Nt(r)&&!r[n]?(e.warn(`Blocked ${t} ${n} event listener.`),!1):!0}function wlt(e,t,n){var r=this,i=new iA(n),a=function(l,c){r.runAsync(null,()=>{e===Hde&&xlt(r,t)&&l.preventDefault(),i.receive(plt(r,l,c))})},o;if(e===mlt)IT(r,"timer",t)&&r.timer(a,t);else if(e===Hde)IT(r,"view",t)&&r.addEventListener(t,a,ylt);else if(e===vlt?IT(r,"window",t)&&typeof window!="undefined"&&(o=[window]):typeof document!="undefined"&&IT(r,"selector",t)&&(o=document.querySelectorAll(e)),!o)r.warn("Can not resolve event source: "+e);else{for(var s=0,u=o.length;s<u;++s)o[s].addEventListener(t,a);Gde(r,o,t,a)}return i}function Kde(e){return e.item}function Xde(e){return e.item.mark.source}function Yde(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function _lt(e,t){return e=[e||"hover"],t=[t||"update",e[0]],this.on(this.events("view","mouseover",Kde),Xde,Yde(e)),this.on(this.events("view","mouseout",Kde),Xde,Yde(t)),this}function Slt(){var e=this._tooltip,t=this._timers,n=this._eventListeners,r,i,a;for(r=t.length;--r>=0;)t[r].stop();for(r=n.length;--r>=0;)for(a=n[r],i=a.sources.length;--i>=0;)a.sources[i].removeEventListener(a.type,a.handler);return e&&e.call(this,this._handler,null,null,null),this}function qo(e,t,n){const r=document.createElement(e);for(const i in t)r.setAttribute(i,t[i]);return n!=null&&(r.textContent=n),r}const Elt="vega-bind",Clt="vega-bind-name",Alt="vega-bind-radio";function klt(e,t,n){if(!t)return;const r=n.param;let i=n.state;return i||(i=n.state={elements:null,active:!1,set:null,update:o=>{o!=e.signal(r.signal)&&e.runAsync(null,()=>{i.source=!0,e.signal(r.signal,o)})}},r.debounce&&(i.update=i4(r.debounce,i.update))),(r.input==null&&r.element?Tlt:Ilt)(i,t,r,e),i.active||(e.on(e._signals[r.signal],null,()=>{i.source?i.source=!1:i.set(e.signal(r.signal))}),i.active=!0),i}function Tlt(e,t,n,r){const i=n.event||"input",a=()=>e.update(t.value);r.signal(n.signal,t.value),t.addEventListener(i,a),Gde(r,t,i,a),e.set=o=>{t.value=o,t.dispatchEvent(Olt(i))}}function Olt(e){return typeof Event!="undefined"?new Event(e):{type:e}}function Ilt(e,t,n,r){const i=r.signal(n.signal),a=qo("div",{class:Elt}),o=n.input==="radio"?a:a.appendChild(qo("label"));o.appendChild(qo("span",{class:Clt},n.name||n.signal)),t.appendChild(a);let s=Nlt;switch(n.input){case"checkbox":s=Dlt;break;case"select":s=Rlt;break;case"radio":s=Flt;break;case"range":s=Mlt;break}s(e,o,n,i)}function Nlt(e,t,n,r){const i=qo("input");for(const a in n)a!=="signal"&&a!=="element"&&i.setAttribute(a==="input"?"type":a,n[a]);i.setAttribute("name",n.signal),i.value=r,t.appendChild(i),i.addEventListener("input",()=>e.update(i.value)),e.elements=[i],e.set=a=>i.value=a}function Dlt(e,t,n,r){const i={type:"checkbox",name:n.signal};r&&(i.checked=!0);const a=qo("input",i);t.appendChild(a),a.addEventListener("change",()=>e.update(a.checked)),e.elements=[a],e.set=o=>a.checked=!!o||null}function Rlt(e,t,n,r){const i=qo("select",{name:n.signal}),a=n.labels||[];n.options.forEach((o,s)=>{const u={value:o};NT(o,r)&&(u.selected=!0),i.appendChild(qo("option",u,(a[s]||o)+""))}),t.appendChild(i),i.addEventListener("change",()=>{e.update(n.options[i.selectedIndex])}),e.elements=[i],e.set=o=>{for(let s=0,u=n.options.length;s<u;++s)if(NT(n.options[s],o)){i.selectedIndex=s;return}}}function Flt(e,t,n,r){const i=qo("span",{class:Alt}),a=n.labels||[];t.appendChild(i),e.elements=n.options.map((o,s)=>{const u={type:"radio",name:n.signal,value:o};NT(o,r)&&(u.checked=!0);const l=qo("input",u);l.addEventListener("change",()=>e.update(o));const c=qo("label",{},(a[s]||o)+"");return c.prepend(l),i.appendChild(c),l}),e.set=o=>{const s=e.elements,u=s.length;for(let l=0;l<u;++l)NT(s[l].value,o)&&(s[l].checked=!0)}}function Mlt(e,t,n,r){r=r!==void 0?r:(+n.max+ +n.min)/2;const i=n.max!=null?n.max:Math.max(100,+r)||100,a=n.min||Math.min(0,i,+r)||0,o=n.step||id(a,i,100),s=qo("input",{type:"range",name:n.signal,min:a,max:i,step:o});s.value=r;const u=qo("span",{},+r);t.appendChild(s),t.appendChild(u);const l=()=>{u.textContent=s.value,e.update(+s.value)};s.addEventListener("input",l),s.addEventListener("change",l),e.elements=[s],e.set=c=>{s.value=c,u.textContent=c}}function NT(e,t){return e===t||e+""==t+""}function Zde(e,t,n,r,i,a){return t=t||new r(e.loader()),t.initialize(n,Vde(e),qde(e),OT(e),i,a).background(e.background())}function aj(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function Plt(e,t,n,r){const i=new r(e.loader(),aj(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,OT(e),e);return t&&t.handlers().forEach(a=>{i.on(a.type,a.handler)}),i}function $lt(e,t){const n=this,r=n._renderType,i=n._eventConfig.bind,a=gk(r);e=n._el=e?oj(n,e,!0):null,slt(n),a||n.error("Unrecognized renderer type: "+r);const o=a.handler||fx,s=e?a.renderer:a.headless;return n._renderer=s?Zde(n,n._renderer,e,s):null,n._handler=Plt(n,n._handler,e,o),n._redraw=!0,e&&i!=="none"&&(t=t?n._elBind=oj(n,t,!0):e.appendChild(qo("form",{class:"vega-bindings"})),n._bind.forEach(u=>{u.param.element&&i!=="container"&&(u.element=oj(n,u.param.element,!!u.param.input))}),n._bind.forEach(u=>{klt(n,u.element||t,u)})),n}function oj(e,t,n){if(typeof t=="string")if(typeof document!="undefined"){if(t=document.querySelector(t),!t)return e.error("Signal bind element not found: "+t),null}else return e.error("DOM document instance not found."),null;if(t&&n)try{t.innerHTML=""}catch(r){t=null,e.error(r)}return t}const Jx=e=>+e||0,Llt=e=>({top:e,bottom:e,left:e,right:e});function Jde(e){return Nt(e)?{top:Jx(e.top),bottom:Jx(e.bottom),left:Jx(e.left),right:Jx(e.right)}:Llt(Jx(e))}async function sj(e,t,n,r){const i=gk(t),a=i&&i.headless;return a||Se("Unrecognized renderer type: "+t),await e.runAsync(),Zde(e,null,null,a,n,r).renderAsync(e._scenegraph.root)}async function Blt(e,t){e!==kd.Canvas&&e!==kd.SVG&&e!==kd.PNG&&Se("Unrecognized image type: "+e);const n=await sj(this,e,t);return e===kd.SVG?zlt(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function zlt(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}async function jlt(e,t){return(await sj(this,kd.Canvas,e,t)).canvas()}async function Ult(e){return(await sj(this,kd.SVG,e)).svg()}function Wlt(e,t,n){return zde(e,wv,Yx,n).parse(t)}function Vlt(e){var t=this._runtime.scales;return _t(t,e)||Se("Unrecognized scale or projection: "+e),t[e].value}var Qde="width",ehe="height",uj="padding",the={skip:!0};function nhe(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===uj?r.left+r.right:0)}function rhe(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===uj?r.top+r.bottom:0)}function qlt(e){var t=e._signals,n=t[Qde],r=t[ehe],i=t[uj];function a(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,s=>{e._width=s.size,e._viewWidth=nhe(e,s.size),a()},{size:n}),e._resizeHeight=e.add(null,s=>{e._height=s.size,e._viewHeight=rhe(e,s.size),a()},{size:r});const o=e.add(null,a,{pad:i});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=r.rank+1,o.rank=i.rank+1}function Hlt(e,t,n,r,i,a){this.runAfter(o=>{let s=0;o._autosize=0,o.width()!==n&&(s=1,o.signal(Qde,n,the),o._resizeWidth.skip(!0)),o.height()!==r&&(s=1,o.signal(ehe,r,the),o._resizeHeight.skip(!0)),o._viewWidth!==e&&(o._resize=1,o._viewWidth=e),o._viewHeight!==t&&(o._resize=1,o._viewHeight=t),(o._origin[0]!==i[0]||o._origin[1]!==i[1])&&(o._resize=1,o._origin=i),s&&o.run("enter"),a&&o.runAfter(u=>u.resize())},!1,1)}function Glt(e){return this._runtime.getState(e||{data:Klt,signals:Xlt,recurse:!0})}function Klt(e,t){return t.modified&&ut(t.input.value)&&e.indexOf("_:vega:_")}function Xlt(e,t){return!(e==="parent"||t instanceof wv.proxy)}function Ylt(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}function Zlt(e,t){function n(r){e({timestamp:Date.now(),elapsed:r})}this._timers.push(Frt(n,t))}function Jlt(e,t,n,r){const i=e.element();i&&i.setAttribute("title",Qlt(r))}function Qlt(e){return e==null?"":ut(e)?ihe(e):Nt(e)&&!ed(e)?ect(e):e+""}function ect(e){return Object.keys(e).map(t=>{const n=e[t];return t+": "+(ut(n)?ihe(n):ahe(n))}).join(`
`)}function ihe(e){return"["+e.map(ahe).join(", ")+"]"}function ahe(e){return ut(e)?"[\u2026]":Nt(e)&&!ed(e)?"{\u2026}":e}function ohe(e,t){const n=this;if(t=t||{},xv.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),t.logLevel!=null&&n.logLevel(t.logLevel),t.locale||e.locale){const a=Rt({},e.locale,t.locale);n.locale(kie(a.number,a.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||kd.Canvas,n._scenegraph=new wz;const r=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||Jlt,n._redraw=!0,n._handler=new fx().scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=blt(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const i=Wlt(n,e,t.expr);n._runtime=i,n._signals=i.signals,n._bind=(e.bindings||[]).map(a=>({state:null,param:Rt({},a)})),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=nhe(n,n._width),n._viewHeight=rhe(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,qlt(n),ult(n),llt(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}function DT(e,t){return _t(e._signals,t)?e._signals[t]:Se("Unrecognized signal name: "+gt(t))}function she(e,t){const n=(e._targets||[]).filter(r=>r._update&&r._update.handler===t);return n.length?n[0]:null}function uhe(e,t,n,r){let i=she(n,r);return i||(i=aj(e,()=>r(t,n.value)),i.handler=r,e.on(n,null,i)),e}function lhe(e,t,n){const r=she(t,n);return r&&t._targets.remove(r),e}$e(ohe,xv,{async evaluate(e,t,n){if(await xv.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,hlt(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(r){this.error(r)}return n&&QC(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=e!=null?e+"":null;return t!==this._desc&&Wde(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const r=DT(this,e);return arguments.length===1?r.value:this.update(r,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",Jde(e)):Jde(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(gk(e)||Se("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(xv.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(DT(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:Hlt,addEventListener(e,t,n){let r=t;return n&&n.trap===!1||(r=aj(this,t),r.raw=t),this._handler.on(e,r),this},removeEventListener(e,t){for(var n=this._handler.handlers(e),r=n.length,i,a;--r>=0;)if(a=n[r].type,i=n[r].handler,e===a&&(t===i||t===i.raw)){this._handler.off(a,i);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return uhe(this,e,DT(this,e),t)},removeSignalListener(e,t){return lhe(this,DT(this,e),t)},addDataListener(e,t){return uhe(this,e,kT(this,e).values,t)},removeDataListener(e,t){return lhe(this,kT(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=ij(this,null);this._globalCursor=!!e,t&&ij(this,t)}return this}else return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:Zlt,events:wlt,finalize:Slt,hover:_lt,data:clt,change:TT,insert:flt,remove:dlt,scale:Vlt,initialize:$lt,toImageURL:Blt,toCanvas:jlt,toSVG:Ult,getState:Glt,setState:Ylt});const tct="view",RT="[",FT="]",che="{",fhe="}",nct=":",dhe=",",rct="@",ict=">",act=/[[\]{}]/,oct={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let hhe,phe;function Pd(e,t,n){return hhe=t||tct,phe=n||oct,ghe(e.trim()).map(lj)}function sct(e){return phe[e]}function Qx(e,t,n,r,i){const a=e.length;let o=0,s;for(;t<a;++t){if(s=e[t],!o&&s===n)return t;i&&i.indexOf(s)>=0?--o:r&&r.indexOf(s)>=0&&++o}return t}function ghe(e){const t=[],n=e.length;let r=0,i=0;for(;i<n;)i=Qx(e,i,dhe,RT+che,FT+fhe),t.push(e.substring(r,i).trim()),r=++i;if(t.length===0)throw"Empty event selector: "+e;return t}function lj(e){return e[0]==="["?uct(e):lct(e)}function uct(e){const t=e.length;let n=1,r;if(n=Qx(e,n,FT,RT,FT),n===t)throw"Empty between selector: "+e;if(r=ghe(e.substring(1,n)),r.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==ict)throw"Expected '>' after between selector: "+e;r=r.map(lj);const i=lj(e.slice(1).trim());return i.between?{between:r,stream:i}:(i.between=r,i)}function lct(e){const t={source:hhe},n=[];let r=[0,0],i=0,a=0,o=e.length,s=0,u,l;if(e[o-1]===fhe){if(s=e.lastIndexOf(che),s>=0){try{r=cct(e.substring(s+1,o-1))}catch(c){throw"Invalid throttle specification: "+e}e=e.slice(0,s).trim(),o=e.length}else throw"Unmatched right brace: "+e;s=0}if(!o)throw e;if(e[0]===rct&&(i=++s),u=Qx(e,s,nct),u<o&&(n.push(e.substring(a,u).trim()),a=s=++u),s=Qx(e,s,RT),s===o)n.push(e.substring(a,o).trim());else if(n.push(e.substring(a,s).trim()),l=[],a=++s,a===o)throw"Unmatched left bracket: "+e;for(;s<o;){if(s=Qx(e,s,FT),s===o)throw"Unmatched left bracket: "+e;if(l.push(e.substring(a,s).trim()),s<o-1&&e[++s]!==RT)throw"Expected left bracket: "+e;a=++s}if(!(o=n.length)||act.test(n[o-1]))throw"Invalid event selector: "+e;return o>1?(t.type=n[1],i?t.markname=n[0].slice(1):sct(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),l!=null&&(t.filter=l),r[0]&&(t.throttle=r[0]),r[1]&&(t.debounce=r[1]),t}function cct(e){const t=e.split(dhe);if(!e.length||t.length>2)throw e;return t.map(n=>{const r=+n;if(r!==r)throw e;return r})}function fct(e){return Nt(e)?e:{type:e||"pad"}}const ew=e=>+e||0,dct=e=>({top:e,bottom:e,left:e,right:e});function hct(e){return Nt(e)?e.signal?e:{top:ew(e.top),bottom:ew(e.bottom),left:ew(e.left),right:ew(e.right)}:dct(ew(e))}const Ei=e=>Nt(e)&&!ut(e)?Rt({},e):{value:e};function mhe(e,t,n,r){return n!=null?(Nt(n)&&!ut(n)||ut(n)&&n.length&&Nt(n[0])?e.update[t]=n:e[r||"enter"][t]={value:n},1):0}function Ui(e,t,n){for(const r in t)mhe(e,r,t[r]);for(const r in n)mhe(e,r,n[r],"update")}function r0(e,t,n){for(const r in t)n&&_t(n,r)||(e[r]=Rt(e[r]||{},t[r]));return e}function i0(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const cj="mark",fj="frame",dj="scope",pct="axis",gct="axis-domain",mct="axis-grid",vct="axis-label",yct="axis-tick",bct="axis-title",xct="legend",wct="legend-band",_ct="legend-entry",Sct="legend-gradient",vhe="legend-label",Ect="legend-symbol",Cct="legend-title",Act="title",kct="title-text",Tct="title-subtitle";function Oct(e,t,n,r,i){const a={},o={};let s,u,l,c;u="lineBreak",t==="text"&&i[u]!=null&&!i0(u,e)&&hj(a,u,i[u]),(n=="legend"||String(n).startsWith("axis"))&&(n=null),c=n===fj?i.group:n===cj?Rt({},i.mark,i[t]):null;for(u in c)l=i0(u,e)||(u==="fill"||u==="stroke")&&(i0("fill",e)||i0("stroke",e)),l||hj(a,u,c[u]);wt(r).forEach(f=>{const d=i.style&&i.style[f];for(const h in d)i0(h,e)||hj(a,h,d[h])}),e=Rt({},e);for(u in a)c=a[u],c.signal?(s=s||{})[u]=c:o[u]=c;return e.enter=Rt(o,e.enter),s&&(e.update=Rt(s,e.update)),e}function hj(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const yhe=e=>Bn(e)?gt(e):e.signal?"(".concat(e.signal,")"):bhe(e);function MT(e){if(e.gradient!=null)return Nct(e);let t=e.signal?"(".concat(e.signal,")"):e.color?Ict(e.color):e.field!=null?bhe(e.field):e.value!==void 0?gt(e.value):void 0;return e.scale!=null&&(t=Dct(e,t)),t===void 0&&(t=null),e.exponent!=null&&(t="pow(".concat(t,",").concat($T(e.exponent),")")),e.mult!=null&&(t+="*".concat($T(e.mult))),e.offset!=null&&(t+="+".concat($T(e.offset))),e.round&&(t="round(".concat(t,")")),t}const PT=(e,t,n,r)=>"(".concat(e,"(").concat([t,n,r].map(MT).join(","),")+'')");function Ict(e){return e.c?PT("hcl",e.h,e.c,e.l):e.h||e.s?PT("hsl",e.h,e.s,e.l):e.l||e.a?PT("lab",e.l,e.a,e.b):e.r||e.g||e.b?PT("rgb",e.r,e.g,e.b):null}function Nct(e){const t=[e.start,e.stop,e.count].map(n=>n==null?null:gt(n));for(;t.length&&sn(t)==null;)t.pop();return t.unshift(yhe(e.gradient)),"gradient(".concat(t.join(","),")")}function $T(e){return Nt(e)?"("+MT(e)+")":e}function bhe(e){return xhe(Nt(e)?e:{datum:e})}function xhe(e){let t,n,r;if(e.signal)t="datum",r=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(r=e.parent,t+=".datum"):r=e.group}else e.datum?(t="datum",r=e.datum):Se("Invalid field reference: "+gt(e));return e.signal||(r=Bn(r)?RC(r).map(gt).join("]["):xhe(r)),t+"["+r+"]"}function Dct(e,t){const n=yhe(e.scale);return e.range!=null?t="lerp(_range(".concat(n,"), ").concat(+e.range,")"):(t!==void 0&&(t="_scale(".concat(n,", ").concat(t,")")),e.band&&(t=(t?t+"+":"")+"_bandwidth(".concat(n,")")+(+e.band==1?"":"*"+$T(e.band)),e.extra&&(t="(datum.extra ? _scale(".concat(n,", datum.extra.value) : ").concat(t,")"))),t==null&&(t="0")),t}function Rct(e){let t="";return e.forEach(n=>{const r=MT(n);t+=n.test?"(".concat(n.test,")?").concat(r,":"):r}),sn(t)===":"&&(t+="null"),t}function whe(e,t,n,r,i,a){const o={};a=a||{},a.encoders={$encode:o},e=Oct(e,t,n,r,i.config);for(const s in e)o[s]=Fct(e[s],t,a,i);return a}function Fct(e,t,n,r){const i={},a={};for(const o in e)e[o]!=null&&(i[o]=Pct(Mct(e[o]),r,n,a));return{$expr:{marktype:t,channels:i},$fields:Object.keys(a),$output:Object.keys(e)}}function Mct(e){return ut(e)?Rct(e):MT(e)}function Pct(e,t,n,r){const i=xl(e,t);return i.$fields.forEach(a=>r[a]=1),Rt(n,i.$params),i.$expr}const $ct="outer",Lct=["value","update","init","react","bind"];function _he(e,t){Se(e+' for "outer" push: '+gt(t))}function She(e,t){const n=e.name;if(e.push===$ct)t.signals[n]||_he("No prior signal definition",n),Lct.forEach(r=>{e[r]!==void 0&&_he("Invalid property ",r)});else{const r=t.addSignal(n,e.value);e.react===!1&&(r.react=!1),e.bind&&t.addBinding(n,e.bind)}}function pj(e,t,n,r){this.id=-1,this.type=e,this.value=t,this.params=n,r&&(this.parent=r)}function LT(e,t,n,r){return new pj(e,t,n,r)}function BT(e,t){return LT("operator",e,t)}function ft(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function tw(e,t){return t?{$field:e,$name:t}:{$field:e}}const gj=tw("key");function Ehe(e,t){return{$compare:e,$order:t}}function Bct(e,t){const n={$key:e};return t&&(n.$flat=!0),n}const zct="ascending",jct="descending";function Uct(e){return Nt(e)?(e.order===jct?"-":"+")+zT(e.op,e.field):""}function zT(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const mj="scope",vj="view";function fi(e){return e&&e.signal}function Wct(e){return e&&e.expr}function jT(e){if(fi(e))return!0;if(Nt(e)){for(const t in e)if(jT(e[t]))return!0}return!1}function hu(e,t){return e??t}function Wp(e){return e&&e.signal||e}const Che="timer";function nw(e,t){return(e.merge?qct:e.stream?Hct:e.type?Gct:Se("Invalid stream specification: "+gt(e)))(e,t)}function Vct(e){return e===mj?vj:e||vj}function qct(e,t){const n=e.merge.map(i=>nw(i,t)),r=yj({merge:n},e,t);return t.addStream(r).id}function Hct(e,t){const n=nw(e.stream,t),r=yj({stream:n},e,t);return t.addStream(r).id}function Gct(e,t){let n;e.type===Che?(n=t.event(Che,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(Vct(e.source),e.type);const r=yj({stream:n},e,t);return Object.keys(r).length===1?n:t.addStream(r).id}function yj(e,t,n){let r=t.between;return r&&(r.length!==2&&Se('Stream "between" parameter must have 2 entries: '+gt(t)),e.between=[nw(r[0],n),nw(r[1],n)]),r=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&r.push(Kct(t.marktype,t.markname,t.markrole)),t.source===mj&&r.push("inScope(event.item)"),r.length&&(e.filter=xl("("+r.join(")&&(")+")",n).$expr),(r=t.throttle)!=null&&(e.throttle=+r),(r=t.debounce)!=null&&(e.debounce=+r),t.consume&&(e.consume=!0),e}function Kct(e,t,n){const r="event.item";return r+(e&&e!=="*"?"&&"+r+".mark.marktype==='"+e+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(t?"&&"+r+".mark.name==='"+t+"'":"")}const Xct={code:"_.$value",ast:{type:"Identifier",value:"value"}};function Yct(e,t,n){const r=e.encode,i={target:n};let a=e.events,o=e.update,s=[];a||Se("Signal update missing events specification."),Bn(a)&&(a=Pd(a,t.isSubscope()?mj:vj)),a=wt(a).filter(u=>u.signal||u.scale?(s.push(u),0):1),s.length>1&&(s=[Jct(s)]),a.length&&s.push(a.length>1?{merge:a}:a[0]),r!=null&&(o&&Se("Signal encode and update are mutually exclusive."),o="encode(item(),"+gt(r)+")"),i.update=Bn(o)?xl(o,t):o.expr!=null?xl(o.expr,t):o.value!=null?o.value:o.signal!=null?{$expr:Xct,$params:{$value:t.signalRef(o.signal)}}:Se("Invalid signal update specification."),e.force&&(i.options={force:!0}),s.forEach(u=>t.addUpdate(Rt(Zct(u,t),i)))}function Zct(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):nw(e,t)}}function Jct(e){return{signal:"["+e.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}function Qct(e,t){const n=t.getSignal(e.name);let r=e.update;e.init&&(r?Se("Signals can not include both init and update expressions."):(r=e.init,n.initonly=!0)),r&&(r=xl(r,t),n.update=r.$expr,n.params=r.$params),e.on&&e.on.forEach(i=>Yct(i,t,n.id))}const Vn=e=>(t,n,r)=>LT(e,n,t||void 0,r),Ahe=Vn("aggregate"),eft=Vn("axisticks"),khe=Vn("bound"),pu=Vn("collect"),The=Vn("compare"),tft=Vn("datajoin"),Ohe=Vn("encode"),nft=Vn("expression"),rft=Vn("facet"),ift=Vn("field"),aft=Vn("key"),oft=Vn("legendentries"),sft=Vn("load"),uft=Vn("mark"),lft=Vn("multiextent"),cft=Vn("multivalues"),fft=Vn("overlap"),dft=Vn("params"),Ihe=Vn("prefacet"),hft=Vn("projection"),pft=Vn("proxy"),gft=Vn("relay"),Nhe=Vn("render"),mft=Vn("scale"),Vp=Vn("sieve"),vft=Vn("sortitems"),Dhe=Vn("viewlayout"),yft=Vn("values");let bft=0;const Rhe={min:"min",max:"max",count:"sum"};function xft(e,t){const n=e.type||"linear";wse(n)||Se("Unrecognized scale type: "+gt(n)),t.addScale(e.name,{type:n,domain:void 0})}function wft(e,t){const n=t.getScale(e.name).params;let r;n.domain=Fhe(e.domain,e,t),e.range!=null&&(n.range=Phe(e,t,n)),e.interpolate!=null&&Nft(e.interpolate,n),e.nice!=null&&(n.nice=Ift(e.nice)),e.bins!=null&&(n.bins=Oft(e.bins,t));for(r in e)_t(n,r)||r==="name"||(n[r]=ys(e[r],t))}function ys(e,t){return Nt(e)?e.signal?t.signalRef(e.signal):Se("Unsupported object: "+gt(e)):e}function UT(e,t){return e.signal?t.signalRef(e.signal):e.map(n=>ys(n,t))}function WT(e){Se("Can not find data set: "+gt(e))}function Fhe(e,t,n){if(!e){(t.domainMin!=null||t.domainMax!=null)&&Se("No scale domain defined for domainMin/domainMax to override.");return}return e.signal?n.signalRef(e.signal):(ut(e)?_ft:e.fields?Eft:Sft)(e,t,n)}function _ft(e,t,n){return e.map(r=>ys(r,n))}function Sft(e,t,n){const r=n.getData(e.data);return r||WT(e.data),Fv(t.type)?r.valuesRef(n,e.field,Mhe(e.sort,!1)):Ese(t.type)?r.domainRef(n,e.field):r.extentRef(n,e.field)}function Eft(e,t,n){const r=e.data,i=e.fields.reduce((a,o)=>(o=Bn(o)?{data:r,field:o}:ut(o)||o.signal?Cft(o,n):o,a.push(o),a),[]);return(Fv(t.type)?Aft:Ese(t.type)?kft:Tft)(e,n,i)}function Cft(e,t){const n="_:vega:_"+bft++,r=pu({});if(ut(e))r.value={$ingest:e};else if(e.signal){const i="setdata("+gt(n)+","+e.signal+")";r.params.input=t.signalRef(i)}return t.addDataPipeline(n,[r,Vp({})]),{data:n,field:"data"}}function Aft(e,t,n){const r=Mhe(e.sort,!0);let i,a;const o=n.map(l=>{const c=t.getData(l.data);return c||WT(l.data),c.countsRef(t,l.field,r)}),s={groupby:gj,pulse:o};r&&(i=r.op||"count",a=r.field?zT(i,r.field):"count",s.ops=[Rhe[i]],s.fields=[t.fieldRef(a)],s.as=[a]),i=t.add(Ahe(s));const u=t.add(pu({pulse:ft(i)}));return a=t.add(yft({field:gj,sort:t.sortRef(r),pulse:ft(u)})),ft(a)}function Mhe(e,t){return e&&(!e.field&&!e.op?Nt(e)?e.field="key":e={field:"key"}:!e.field&&e.op!=="count"?Se("No field provided for sort aggregate op: "+e.op):t&&e.field&&e.op&&!Rhe[e.op]&&Se("Multiple domain scales can not be sorted using "+e.op)),e}function kft(e,t,n){const r=n.map(i=>{const a=t.getData(i.data);return a||WT(i.data),a.domainRef(t,i.field)});return ft(t.add(cft({values:r})))}function Tft(e,t,n){const r=n.map(i=>{const a=t.getData(i.data);return a||WT(i.data),a.extentRef(t,i.field)});return ft(t.add(lft({extents:r})))}function Oft(e,t){return e.signal||ut(e)?UT(e,t):t.objectProperty(e)}function Ift(e){return Nt(e)?{interval:ys(e.interval),step:ys(e.step)}:ys(e)}function Nft(e,t){t.interpolate=ys(e.type||e),e.gamma!=null&&(t.interpolateGamma=ys(e.gamma))}function Phe(e,t,n){const r=t.config.range;let i=e.range;if(i.signal)return t.signalRef(i.signal);if(Bn(i)){if(r&&_t(r,i))return e=Rt({},e,{range:r[i]}),Phe(e,t,n);i==="width"?i=[0,{signal:"width"}]:i==="height"?i=Fv(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:Se("Unrecognized scale range value: "+gt(i))}else if(i.scheme){n.scheme=ut(i.scheme)?UT(i.scheme,t):ys(i.scheme,t),i.extent&&(n.schemeExtent=UT(i.extent,t)),i.count&&(n.schemeCount=ys(i.count,t));return}else if(i.step){n.rangeStep=ys(i.step,t);return}else{if(Fv(e.type)&&!ut(i))return Fhe(i,e,t);ut(i)||Se("Unsupported range type: "+gt(i))}return i.map(a=>(ut(a)?UT:ys)(a,t))}function Dft(e,t){const n=t.config.projection||{},r={};for(const i in e)i!=="name"&&(r[i]=bj(e[i],i,t));for(const i in n)r[i]==null&&(r[i]=bj(n[i],i,t));t.addProjection(e.name,r)}function bj(e,t,n){return ut(e)?e.map(r=>bj(r,t,n)):Nt(e)?e.signal?n.signalRef(e.signal):t==="fit"?e:Se("Unsupported parameter object: "+gt(e)):e}const gu="top",a0="left",o0="right",$d="bottom",$he="center",Rft="vertical",Fft="start",Mft="middle",Pft="end",xj="index",wj="label",$ft="offset",s0="perc",Lft="perc2",bs="value",rw="guide-label",_j="guide-title",Bft="group-title",zft="group-subtitle",Lhe="symbol",VT="gradient",Sj="discrete",Ej="size",jft="shape",Uft="fill",Wft="stroke",Vft="strokeWidth",qft="strokeDash",Hft="opacity",Cj=[Ej,jft,Uft,Wft,Vft,qft,Hft],iw={name:1,style:1,interactive:1},pn={value:0},xs={value:1},qT="group",Bhe="rect",Aj="rule",Gft="symbol",qp="text";function aw(e){return e.type=qT,e.interactive=e.interactive||!1,e}function mo(e,t){const n=(r,i)=>hu(e[r],hu(t[r],i));return n.isVertical=r=>Rft===hu(e.direction,t.direction||(r?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>hu(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>hu(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>hu(e.columns,hu(t.columns,+n.isVertical(!0))),n}function zhe(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function Kft(e,t,n){const r=t.config.style[n];return r&&r[e]}function HT(e,t,n){return"item.anchor === '".concat(Fft,"' ? ").concat(e," : item.anchor === '").concat(Pft,"' ? ").concat(t," : ").concat(n)}const kj=HT(gt(a0),gt(o0),gt($he));function Xft(e){const t=e("tickBand");let n=e("tickOffset"),r,i;return t?t.signal?(r={signal:"(".concat(t.signal,") === 'extent' ? 1 : 0.5")},i={signal:"(".concat(t.signal,") === 'extent'")},Nt(n)||(n={signal:"(".concat(t.signal,") === 'extent' ? 0 : ").concat(n)})):t==="extent"?(r=1,i=!0,n=0):(r=.5,i=!1):(r=e("bandPosition"),i=e("tickExtra")),{extra:i,band:r,offset:n}}function jhe(e,t){return t?e?Nt(e)?Object.assign({},e,{offset:jhe(e.offset,t)}):{value:e,offset:t}:t:e}function Ho(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=r0(e.encode,t,iw)):e.interactive=!1,e}function Yft(e,t,n,r){const i=mo(e,n),a=i.isVertical(),o=i.gradientThickness(),s=i.gradientLength();let u,l,c,f,d;a?(l=[0,1],c=[0,0],f=o,d=s):(l=[0,0],c=[1,0],f=s,d=o);const h={enter:u={opacity:pn,x:pn,y:pn,width:Ei(f),height:Ei(d)},update:Rt({},u,{opacity:xs,fill:{gradient:t,start:l,stop:c}}),exit:{opacity:pn}};return Ui(h,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")}),Ho({type:Bhe,role:Sct,encode:h},r)}function Zft(e,t,n,r,i){const a=mo(e,n),o=a.isVertical(),s=a.gradientThickness(),u=a.gradientLength();let l,c,f,d,h="";o?(l="y",f="y2",c="x",d="width",h="1-"):(l="x",f="x2",c="y",d="height");const p={opacity:pn,fill:{scale:t,field:bs}};p[l]={signal:h+"datum."+s0,mult:u},p[c]=pn,p[f]={signal:h+"datum."+Lft,mult:u},p[d]=Ei(s);const g={enter:p,update:Rt({},p,{opacity:xs}),exit:{opacity:pn}};return Ui(g,{stroke:a("gradientStrokeColor"),strokeWidth:a("gradientStrokeWidth")},{opacity:a("gradientOpacity")}),Ho({type:Bhe,role:wct,key:bs,from:i,encode:g},r)}const Jft="datum.".concat(s0,'<=0?"').concat(a0,'":datum.').concat(s0,'>=1?"').concat(o0,'":"').concat($he,'"'),Qft="datum.".concat(s0,'<=0?"').concat($d,'":datum.').concat(s0,'>=1?"').concat(gu,'":"').concat(Mft,'"');function Uhe(e,t,n,r){const i=mo(e,t),a=i.isVertical(),o=Ei(i.gradientThickness()),s=i.gradientLength();let u=i("labelOverlap"),l,c,f,d,h="";const p={enter:l={opacity:pn},update:c={opacity:xs,text:{field:wj}},exit:{opacity:pn}};return Ui(p,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:hu(e.labelLimit,t.gradientLabelLimit)}),a?(l.align={value:"left"},l.baseline=c.baseline={signal:Qft},f="y",d="x",h="1-"):(l.align=c.align={signal:Jft},l.baseline={value:"top"},f="x",d="y"),l[f]=c[f]={signal:h+"datum."+s0,mult:s},l[d]=c[d]=o,o.offset=hu(e.labelOffset,t.gradientLabelOffset)||0,u=u?{separation:i("labelSeparation"),method:u,order:"datum."+xj}:void 0,Ho({type:qp,role:vhe,style:rw,key:bs,from:r,encode:p,overlap:u},n)}function edt(e,t,n,r,i){const a=mo(e,t),o=n.entries,s=!!(o&&o.interactive),u=o?o.name:void 0,l=a("clipHeight"),c=a("symbolOffset"),f={data:"value"},d="(".concat(i,") ? datum.").concat($ft," : datum.").concat(Ej),h=l?Ei(l):{field:Ej},p="datum.".concat(xj),g="max(1, ".concat(i,")");let m,v,y,b,x;h.mult=.5,m={enter:v={opacity:pn,x:{signal:d,mult:.5,offset:c},y:h},update:y={opacity:xs,x:v.x,y:v.y},exit:{opacity:pn}};let w=null,S=null;e.fill||(w=t.symbolBaseFillColor,S=t.symbolBaseStrokeColor),Ui(m,{fill:a("symbolFillColor",w),shape:a("symbolType"),size:a("symbolSize"),stroke:a("symbolStrokeColor",S),strokeDash:a("symbolDash"),strokeDashOffset:a("symbolDashOffset"),strokeWidth:a("symbolStrokeWidth")},{opacity:a("symbolOpacity")}),Cj.forEach(A=>{e[A]&&(y[A]=v[A]={scale:e[A],field:bs})});const C=Ho({type:Gft,role:Ect,key:bs,from:f,clip:l?!0:void 0,encode:m},n.symbols),_=Ei(c);_.offset=a("labelOffset"),m={enter:v={opacity:pn,x:{signal:d,offset:_},y:h},update:y={opacity:xs,text:{field:wj},x:v.x,y:v.y},exit:{opacity:pn}},Ui(m,{align:a("labelAlign"),baseline:a("labelBaseline"),fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontStyle:a("labelFontStyle"),fontWeight:a("labelFontWeight"),limit:a("labelLimit")});const E=Ho({type:qp,role:vhe,style:rw,key:bs,from:f,encode:m},n.labels);return m={enter:{noBound:{value:!l},width:pn,height:l?Ei(l):pn,opacity:pn},exit:{opacity:pn},update:y={opacity:xs,row:{signal:null},column:{signal:null}}},a.isVertical(!0)?(b="ceil(item.mark.items.length / ".concat(g,")"),y.row.signal="".concat(p,"%").concat(b),y.column.signal="floor(".concat(p," / ").concat(b,")"),x={field:["row",p]}):(y.row.signal="floor(".concat(p," / ").concat(g,")"),y.column.signal="".concat(p," % ").concat(g),x={field:p}),y.column.signal="(".concat(i,")?").concat(y.column.signal,":").concat(p),r={facet:{data:r,name:"value",groupby:xj}},aw({role:dj,from:r,encode:r0(m,o,iw),marks:[C,E],name:u,interactive:s,sort:x})}function tdt(e,t){const n=mo(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}const Tj='item.orient === "left"',Oj='item.orient === "right"',GT="(".concat(Tj," || ").concat(Oj,")"),ndt="datum.vgrad && ".concat(GT),rdt=HT('"top"','"bottom"','"middle"'),idt=HT('"right"','"left"','"center"'),adt="datum.vgrad && ".concat(Oj," ? (").concat(idt,") : (").concat(GT," && !(datum.vgrad && ").concat(Tj,')) ? "left" : ').concat(kj),odt="item._anchor || (".concat(GT,' ? "middle" : "start")'),sdt="".concat(ndt," ? (").concat(Tj," ? -90 : 90) : 0"),udt="".concat(GT," ? (datum.vgrad ? (").concat(Oj,' ? "bottom" : "top") : ').concat(rdt,') : "top"');function ldt(e,t,n,r){const i=mo(e,t),a={enter:{opacity:pn},update:{opacity:xs,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:pn}};return Ui(a,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:odt},angle:{signal:sdt},align:{signal:adt},baseline:{signal:udt},text:e.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")}),Ho({type:qp,role:Cct,style:_j,from:r,encode:a},n)}function cdt(e,t){let n;return Nt(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+Whe(e.path)+")":e.sphere&&(n="geoShape("+Whe(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function Whe(e){return Nt(e)&&e.signal?e.signal:gt(e)}function Vhe(e){const t=e.role||"";return!t.indexOf("axis")||!t.indexOf("legend")||!t.indexOf("title")?t:e.type===qT?dj:t||cj}function fdt(e){return{marktype:e.type,name:e.name||void 0,role:e.role||Vhe(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function ddt(e,t){return e&&e.signal?t.signalRef(e.signal):e!==!1}function Ij(e,t){const n=jie(e.type);n||Se("Unrecognized transform type: "+gt(e.type));const r=LT(n.type.toLowerCase(),null,qhe(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(r)),r.metadata=n.metadata||{},r}function qhe(e,t,n){const r={},i=e.params.length;for(let a=0;a<i;++a){const o=e.params[a];r[o.name]=hdt(o,t,n)}return r}function hdt(e,t,n){const r=e.type,i=t[e.name];if(r==="index")return pdt(e,t,n);if(i===void 0){e.required&&Se("Missing required "+gt(t.type)+" parameter: "+gt(e.name));return}else{if(r==="param")return gdt(e,t,n);if(r==="projection")return n.projectionRef(t[e.name])}return e.array&&!fi(i)?i.map(a=>Hhe(e,a,n)):Hhe(e,i,n)}function Hhe(e,t,n){const r=e.type;if(fi(t))return Khe(r)?Se("Expression references can not be signals."):Nj(r)?n.fieldRef(t):Xhe(r)?n.compareRef(t):n.signalRef(t.signal);{const i=e.expr||Nj(r);return i&&mdt(t)?n.exprRef(t.expr,t.as):i&&vdt(t)?tw(t.field,t.as):Khe(r)?xl(t,n):ydt(r)?ft(n.getData(t).values):Nj(r)?tw(t):Xhe(r)?n.compareRef(t):t}}function pdt(e,t,n){return Bn(t.from)||Se('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}function gdt(e,t,n){const r=t[e.name];return e.array?(ut(r)||Se("Expected an array of sub-parameters. Instead: "+gt(r)),r.map(i=>Ghe(e,i,n))):Ghe(e,r,n)}function Ghe(e,t,n){const r=e.params.length;let i;for(let o=0;o<r;++o){i=e.params[o];for(const s in i.key)if(i.key[s]!==t[s]){i=null;break}if(i)break}i||Se("Unsupported parameter: "+gt(t));const a=Rt(qhe(i,t,n),i.key);return ft(n.add(dft(a)))}const mdt=e=>e&&e.expr,vdt=e=>e&&e.field,ydt=e=>e==="data",Khe=e=>e==="expr",Nj=e=>e==="field",Xhe=e=>e==="compare";function bdt(e,t,n){let r,i,a,o,s;return e?(r=e.facet)&&(t||Se("Only group marks can be faceted."),r.field!=null?o=s=KT(r,n):(e.data?s=ft(n.getData(e.data).aggregate):(a=Ij(Rt({type:"aggregate",groupby:wt(r.groupby)},r.aggregate),n),a.params.key=n.keyRef(r.groupby),a.params.pulse=KT(r,n),o=s=ft(n.add(a))),i=n.keyRef(r.groupby,!0))):o=ft(n.add(pu(null,[{}]))),o||(o=KT(e,n)),{key:i,pulse:o,parent:s}}function KT(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:ft(t.getData(e.data).output)}function Hp(e,t,n,r,i){this.scope=e,this.input=t,this.output=n,this.values=r,this.aggregate=i,this.index={}}Hp.fromEntries=function(e,t){const n=t.length,r=t[n-1],i=t[n-2];let a=t[0],o=null,s=1;for(a&&a.type==="load"&&(a=t[1]),e.add(t[0]);s<n;++s)t[s].params.pulse=ft(t[s-1]),e.add(t[s]),t[s].type==="aggregate"&&(o=t[s]);return new Hp(e,a,i,r,o)};function Yhe(e){return Bn(e)?e:null}function Zhe(e,t,n){const r=zT(n.op,n.field);let i;if(t.ops){for(let a=0,o=t.as.length;a<o;++a)if(t.as[a]===r)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((i=n.op.signal)?e.signalRef(i):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(r))}function ow(e,t,n,r,i,a,o){const s=t[n]||(t[n]={}),u=Uct(a);let l=Yhe(i),c,f;if(l!=null&&(e=t.scope,l=l+(u?"|"+u:""),c=s[l]),!c){const d=a?{field:gj,pulse:t.countsRef(e,i,a)}:{field:e.fieldRef(i),pulse:ft(t.output)};u&&(d.sort=e.sortRef(a)),f=e.add(LT(r,void 0,d)),o&&(t.index[i]=f),c=ft(f),l!=null&&(s[l]=c)}return c}Hp.prototype={countsRef(e,t,n){const r=this,i=r.counts||(r.counts={}),a=Yhe(t);let o,s,u;return a!=null&&(e=r.scope,o=i[a]),o?n&&n.field&&Zhe(e,o.agg.params,n):(u={groupby:e.fieldRef(t,"key"),pulse:ft(r.output)},n&&n.field&&Zhe(e,u,n),s=e.add(Ahe(u)),o=e.add(pu({pulse:ft(s)})),o={agg:s,ref:ft(o)},a!=null&&(i[a]=o)),o.ref},tuplesRef(){return ft(this.values)},extentRef(e,t){return ow(e,this,"extent","extent",t,!1)},domainRef(e,t){return ow(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return ow(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return ow(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return ow(e,this,"indata","tupleindex",t,!0,!0)}};function xdt(e,t,n){const r=e.from.facet,i=r.name,a=KT(r,t);let o;r.name||Se("Facet must have a name: "+gt(r)),r.data||Se("Facet must reference a data set: "+gt(r)),r.field?o=t.add(Ihe({field:t.fieldRef(r.field),pulse:a})):r.groupby?o=t.add(rft({key:t.keyRef(r.groupby),group:ft(t.proxy(n.parent)),pulse:a})):Se("Facet must specify groupby or field: "+gt(r));const s=t.fork(),u=s.add(pu()),l=s.add(Vp({pulse:ft(u)}));s.addData(i,new Hp(s,u,u,l)),s.addSignal("parent",null),o.params.subflow={$subflow:s.parse(e).toRuntime()}}function wdt(e,t,n){const r=t.add(Ihe({pulse:n.pulse})),i=t.fork();i.add(Vp()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(e).toRuntime()}}function Jhe(e,t,n){const r=e.remove,i=e.insert,a=e.toggle,o=e.modify,s=e.values,u=t.add(BT()),l="if("+e.trigger+',modify("'+n+'",'+[i,r,a,o,s].map(f=>f??"null").join(",")+"),0)",c=xl(l,t);u.update=c.$expr,u.params=c.$params}function XT(e,t){const n=Vhe(e),r=e.type===qT,i=e.from&&e.from.facet,a=e.overlap;let o=e.layout||n===dj||n===fj,s,u,l,c,f,d,h;const p=n===cj||o||i,g=bdt(e.from,r,t);u=t.add(tft({key:g.key||(e.key?tw(e.key):void 0),pulse:g.pulse,clean:!r}));const m=ft(u);u=l=t.add(pu({pulse:m})),u=t.add(uft({markdef:fdt(e),interactive:ddt(e.interactive,t),clip:cdt(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:ft(u)}));const v=ft(u);u=c=t.add(Ohe(whe(e.encode,e.type,n,e.style,t,{mod:!1,pulse:v}))),u.params.parent=t.encode(),e.transform&&e.transform.forEach(S=>{const C=Ij(S,t),_=C.metadata;(_.generates||_.changes)&&Se("Mark transforms should not generate new data."),_.nomod||(c.params.mod=!0),C.params.pulse=ft(u),t.add(u=C)}),e.sort&&(u=t.add(vft({sort:t.compareRef(e.sort),pulse:ft(u)})));const y=ft(u);(i||o)&&(o=t.add(Dhe({layout:t.objectProperty(e.layout),legends:t.legends,mark:v,pulse:y})),d=ft(o));const b=t.add(khe({mark:v,pulse:d||y}));h=ft(b),r&&(p&&(s=t.operators,s.pop(),o&&s.pop()),t.pushState(y,d||h,m),i?xdt(e,t,g):p?wdt(e,t,g):t.parse(e),t.popState(),p&&(o&&s.push(o),s.push(b))),a&&(h=_dt(a,h,t));const x=t.add(Nhe({pulse:h})),w=t.add(Vp({pulse:ft(x)},void 0,t.parent()));e.name!=null&&(f=e.name,t.addData(f,new Hp(t,l,x,w)),e.on&&e.on.forEach(S=>{(S.insert||S.remove||S.toggle)&&Se("Marks only support modify triggers."),Jhe(S,t,f)}))}function _dt(e,t,n){const r=e.method,i=e.bound,a=e.separation,o={separation:fi(a)?n.signalRef(a.signal):a,method:fi(r)?n.signalRef(r.signal):r,pulse:t};if(e.order&&(o.sort=n.compareRef({field:e.order})),i){const s=i.tolerance;o.boundTolerance=fi(s)?n.signalRef(s.signal):+s,o.boundScale=n.scaleRef(i.scale),o.boundOrient=i.orient}return ft(n.add(fft(o)))}function Sdt(e,t){const n=t.config.legend,r=e.encode||{},i=mo(e,n),a=r.legend||{},o=a.name||void 0,s=a.interactive,u=a.style,l={};let c=0,f,d,h;Cj.forEach(b=>e[b]?(l[b]=e[b],c=c||e[b]):0),c||Se("Missing valid scale for legend.");const p=Edt(e,t.scaleType(c)),g={title:e.title!=null,scales:l,type:p,vgrad:p!=="symbol"&&i.isVertical()},m=ft(t.add(pu(null,[g]))),v={enter:{x:{value:0},y:{value:0}}},y=ft(t.add(oft(d={type:p,scale:t.scaleRef(c),count:t.objectProperty(i("tickCount")),limit:t.property(i("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return p===VT?(h=[Yft(e,c,n,r.gradient),Uhe(e,n,r.labels,y)],d.count=d.count||t.signalRef("max(2,2*floor((".concat(Wp(i.gradientLength()),")/100))"))):p===Sj?h=[Zft(e,c,n,r.gradient,y),Uhe(e,n,r.labels,y)]:(f=tdt(e,n),h=[edt(e,n,r,y,Wp(f.columns))],d.size=kdt(e,t,h[0].marks)),h=[aw({role:_ct,from:m,encode:v,marks:h,layout:f,interactive:s})],g.title&&h.push(ldt(e,n,r.title,m)),XT(aw({role:xct,from:m,encode:r0(Adt(i,e,n),a,iw),marks:h,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:o,interactive:s,style:u}),t)}function Edt(e,t){let n=e.type||Lhe;return!e.type&&Cdt(e)===1&&(e.fill||e.stroke)&&(n=$B(t)?VT:LB(t)?Sj:Lhe),n!==VT?n:LB(t)?Sj:VT}function Cdt(e){return Cj.reduce((t,n)=>t+(e[n]?1:0),0)}function Adt(e,t,n){const r={enter:{},update:{}};return Ui(r,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),r}function kdt(e,t,n){const r=Wp(Qhe("size",e,n)),i=Wp(Qhe("strokeWidth",e,n)),a=Wp(Tdt(n[1].encode,t,rw));return xl("max(ceil(sqrt(".concat(r,")+").concat(i,"),").concat(a,")"),t)}function Qhe(e,t,n){return t[e]?'scale("'.concat(t[e],'",datum)'):zhe(e,n[0].encode)}function Tdt(e,t,n){return zhe("fontSize",e)||Kft("fontSize",t,n)}const Odt='item.orient==="'.concat(a0,'"?-90:item.orient==="').concat(o0,'"?90:0');function Idt(e,t){e=Bn(e)?{text:e}:e;const n=mo(e,t.config.title),r=e.encode||{},i=r.group||{},a=i.name||void 0,o=i.interactive,s=i.style,u=[],l={},c=ft(t.add(pu(null,[l])));return u.push(Rdt(e,n,Ndt(e),c)),e.subtitle&&u.push(Fdt(e,n,r.subtitle,c)),XT(aw({role:Act,from:c,encode:Ddt(n,i),marks:u,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:a,interactive:o,style:s}),t)}function Ndt(e){const t=e.encode;return t&&t.title||Rt({name:e.name,interactive:e.interactive,style:e.style},t)}function Ddt(e,t){const n={enter:{},update:{}};return Ui(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:kj},angle:{signal:Odt},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),r0(n,t,iw)}function Rdt(e,t,n,r){const i={value:0},a=e.text,o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return Ui(o,{text:a,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Ho({type:qp,role:kct,style:Bft,from:r,encode:o},n)}function Fdt(e,t,n,r){const i={value:0},a=e.subtitle,o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return Ui(o,{text:a,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Ho({type:qp,role:Tct,style:zft,from:r,encode:o},n)}function Mdt(e,t){const n=[];e.transform&&e.transform.forEach(r=>{n.push(Ij(r,t))}),e.on&&e.on.forEach(r=>{Jhe(r,t,e.name)}),t.addDataPipeline(e.name,Pdt(e,t,n))}function Pdt(e,t,n){const r=[];let i=null,a=!1,o=!1,s,u,l,c,f;for(e.values?fi(e.values)||jT(e.format)?(r.push(epe(t,e)),r.push(i=Gp())):r.push(i=Gp({$ingest:e.values,$format:e.format})):e.url?jT(e.url)||jT(e.format)?(r.push(epe(t,e)),r.push(i=Gp())):r.push(i=Gp({$request:e.url,$format:e.format})):e.source&&(i=s=wt(e.source).map(d=>ft(t.getData(d).output)),r.push(null)),u=0,l=n.length;u<l;++u)c=n[u],f=c.metadata,!i&&!f.source&&r.push(i=Gp()),r.push(c),f.generates&&(o=!0),f.modifies&&!o&&(a=!0),f.source?i=c:f.changes&&(i=null);return s&&(l=s.length-1,r[0]=gft({derive:a,pulse:l?s:s[0]}),(a||l)&&r.splice(1,0,Gp())),i||r.push(Gp()),r.push(Vp({})),r}function Gp(e){const t=pu({},e);return t.metadata={source:!0},t}function epe(e,t){return sft({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const tpe=e=>e===$d||e===gu,YT=(e,t,n)=>fi(e)?zdt(e.signal,t,n):e===a0||e===gu?t:n,Ci=(e,t,n)=>fi(e)?Ldt(e.signal,t,n):tpe(e)?t:n,mu=(e,t,n)=>fi(e)?Bdt(e.signal,t,n):tpe(e)?n:t,npe=(e,t,n)=>fi(e)?jdt(e.signal,t,n):e===gu?{value:t}:{value:n},$dt=(e,t,n)=>fi(e)?Udt(e.signal,t,n):e===o0?{value:t}:{value:n},Ldt=(e,t,n)=>rpe("".concat(e," === '").concat(gu,"' || ").concat(e," === '").concat($d,"'"),t,n),Bdt=(e,t,n)=>rpe("".concat(e," !== '").concat(gu,"' && ").concat(e," !== '").concat($d,"'"),t,n),zdt=(e,t,n)=>Dj("".concat(e," === '").concat(a0,"' || ").concat(e," === '").concat(gu,"'"),t,n),jdt=(e,t,n)=>Dj("".concat(e," === '").concat(gu,"'"),t,n),Udt=(e,t,n)=>Dj("".concat(e," === '").concat(o0,"'"),t,n),rpe=(e,t,n)=>(t=t!=null?Ei(t):t,n=n!=null?Ei(n):n,ipe(t)&&ipe(n)?(t=t?t.signal||gt(t.value):null,n=n?n.signal||gt(n.value):null,{signal:"".concat(e," ? (").concat(t,") : (").concat(n,")")}):[Rt({test:e},t)].concat(n||[])),ipe=e=>e==null||Object.keys(e).length===1,Dj=(e,t,n)=>({signal:"".concat(e," ? (").concat(u0(t),") : (").concat(u0(n),")")}),Wdt=(e,t,n,r,i)=>({signal:(r!=null?"".concat(e," === '").concat(a0,"' ? (").concat(u0(r),") : "):"")+(n!=null?"".concat(e," === '").concat($d,"' ? (").concat(u0(n),") : "):"")+(i!=null?"".concat(e," === '").concat(o0,"' ? (").concat(u0(i),") : "):"")+(t!=null?"".concat(e," === '").concat(gu,"' ? (").concat(u0(t),") : "):"")+"(null)"}),u0=e=>fi(e)?e.signal:e==null?null:gt(e),Vdt=(e,t)=>t===0?0:fi(e)?{signal:"(".concat(e.signal,") * ").concat(t)}:{value:e*t},l0=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function c0(e,t,n,r){let i;if(t&&_t(t,e))return t[e];if(_t(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=e[5].toLowerCase()+e.slice(6)}return r[_j][i]}else if(e.startsWith("label")){switch(e){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=e[5].toLowerCase()+e.slice(6)}return r[rw][i]}return null}function ape(e){const t={};for(const n of e)if(!!n)for(const r in n)t[r]=1;return Object.keys(t)}function qdt(e,t){var n=t.config,r=n.style,i=n.axis,a=t.scaleType(e.scale)==="band"&&n.axisBand,o=e.orient,s,u,l;if(fi(o)){const f=ape([n.axisX,n.axisY]),d=ape([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);s={};for(l of f)s[l]=Ci(o,c0(l,n.axisX,i,r),c0(l,n.axisY,i,r));u={};for(l of d)u[l]=Wdt(o.signal,c0(l,n.axisTop,i,r),c0(l,n.axisBottom,i,r),c0(l,n.axisLeft,i,r),c0(l,n.axisRight,i,r))}else s=o===gu||o===$d?n.axisX:n.axisY,u=n["axis"+o[0].toUpperCase()+o.slice(1)];return s||u||a?Rt({},i,s,u,a):i}function Hdt(e,t,n,r){const i=mo(e,t),a=e.orient;let o,s;const u={enter:o={opacity:pn},update:s={opacity:xs},exit:{opacity:pn}};Ui(u,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});const l=ope(e,0),c=ope(e,1);return o.x=s.x=Ci(a,l,pn),o.x2=s.x2=Ci(a,c),o.y=s.y=mu(a,l,pn),o.y2=s.y2=mu(a,c),Ho({type:Aj,role:gct,from:r,encode:u},n)}function ope(e,t){return{scale:e.scale,range:t}}function Gdt(e,t,n,r,i){const a=mo(e,t),o=e.orient,s=e.gridScale,u=YT(o,1,-1),l=Kdt(e.offset,u);let c,f,d;const h={enter:c={opacity:pn},update:d={opacity:xs},exit:f={opacity:pn}};Ui(h,{stroke:a("gridColor"),strokeCap:a("gridCap"),strokeDash:a("gridDash"),strokeDashOffset:a("gridDashOffset"),strokeOpacity:a("gridOpacity"),strokeWidth:a("gridWidth")});const p={scale:e.scale,field:bs,band:i.band,extra:i.extra,offset:i.offset,round:a("tickRound")},g=Ci(o,{signal:"height"},{signal:"width"}),m=s?{scale:s,range:0,mult:u,offset:l}:{value:0,offset:l},v=s?{scale:s,range:1,mult:u,offset:l}:Rt(g,{mult:u,offset:l});return c.x=d.x=Ci(o,p,m),c.y=d.y=mu(o,p,m),c.x2=d.x2=mu(o,v),c.y2=d.y2=Ci(o,v),f.x=Ci(o,p),f.y=mu(o,p),Ho({type:Aj,role:mct,key:bs,from:r,encode:h},n)}function Kdt(e,t){if(t!==1)if(!Nt(e))e=fi(t)?{signal:"(".concat(t.signal,") * (").concat(e||0,")")}:t*(e||0);else{let n=e=Rt({},e);for(;n.mult!=null;)if(Nt(n.mult))n=n.mult=Rt({},n.mult);else return n.mult=fi(t)?{signal:"(".concat(n.mult,") * (").concat(t.signal,")")}:n.mult*t,e;n.mult=t}return e}function Xdt(e,t,n,r,i,a){const o=mo(e,t),s=e.orient,u=YT(s,-1,1);let l,c,f;const d={enter:l={opacity:pn},update:f={opacity:xs},exit:c={opacity:pn}};Ui(d,{stroke:o("tickColor"),strokeCap:o("tickCap"),strokeDash:o("tickDash"),strokeDashOffset:o("tickDashOffset"),strokeOpacity:o("tickOpacity"),strokeWidth:o("tickWidth")});const h=Ei(i);h.mult=u;const p={scale:e.scale,field:bs,band:a.band,extra:a.extra,offset:a.offset,round:o("tickRound")};return f.y=l.y=Ci(s,pn,p),f.y2=l.y2=Ci(s,h),c.x=Ci(s,p),f.x=l.x=mu(s,pn,p),f.x2=l.x2=mu(s,h),c.y=mu(s,p),Ho({type:Aj,role:yct,key:bs,from:r,encode:d},n)}function Rj(e,t,n,r,i){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+r+","+i+")"}}function Ydt(e,t,n,r,i,a){const o=mo(e,t),s=e.orient,u=e.scale,l=YT(s,-1,1),c=Wp(o("labelFlush")),f=Wp(o("labelFlushOffset")),d=o("labelAlign"),h=o("labelBaseline");let p=c===0||!!c,g;const m=Ei(i);m.mult=l,m.offset=Ei(o("labelPadding")||0),m.offset.mult=l;const v={scale:u,field:bs,band:.5,offset:jhe(a.offset,o("labelOffset"))},y=Ci(s,p?Rj(u,c,'"left"','"right"','"center"'):{value:"center"},$dt(s,"left","right")),b=Ci(s,npe(s,"bottom","top"),p?Rj(u,c,'"top"','"bottom"','"middle"'):{value:"middle"}),x=Rj(u,c,"-(".concat(f,")"),f,0);p=p&&f;const w={opacity:pn,x:Ci(s,v,m),y:mu(s,v,m)},S={enter:w,update:g={opacity:xs,text:{field:wj},x:w.x,y:w.y,align:y,baseline:b},exit:{opacity:pn,x:w.x,y:w.y}};Ui(S,{dx:!d&&p?Ci(s,x):null,dy:!h&&p?mu(s,x):null}),Ui(S,{angle:o("labelAngle"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontWeight:o("labelFontWeight"),fontStyle:o("labelFontStyle"),limit:o("labelLimit"),lineHeight:o("labelLineHeight")},{align:d,baseline:h});const C=o("labelBound");let _=o("labelOverlap");return _=_||C?{separation:o("labelSeparation"),method:_,order:"datum.index",bound:C?{scale:u,orient:s,tolerance:C}:null}:void 0,g.align!==y&&(g.align=l0(g.align,y)),g.baseline!==b&&(g.baseline=l0(g.baseline,b)),Ho({type:qp,role:vct,style:rw,key:bs,from:r,encode:S,overlap:_},n)}function Zdt(e,t,n,r){const i=mo(e,t),a=e.orient,o=YT(a,-1,1);let s,u;const l={enter:s={opacity:pn,anchor:Ei(i("titleAnchor",null)),align:{signal:kj}},update:u=Rt({},s,{opacity:xs,text:Ei(e.title)}),exit:{opacity:pn}},c={signal:'lerp(range("'.concat(e.scale,'"), ').concat(HT(0,1,.5),")")};return u.x=Ci(a,c),u.y=mu(a,c),s.angle=Ci(a,pn,Vdt(o,90)),s.baseline=Ci(a,npe(a,$d,gu),{value:$d}),u.angle=s.angle,u.baseline=s.baseline,Ui(l,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),Jdt(i,a,l,n),l.update.align=l0(l.update.align,s.align),l.update.angle=l0(l.update.angle,s.angle),l.update.baseline=l0(l.update.baseline,s.baseline),Ho({type:qp,role:bct,style:_j,from:r,encode:l},n)}function Jdt(e,t,n,r){const i=(s,u)=>s!=null?(n.update[u]=l0(Ei(s),n.update[u]),!1):!i0(u,r),a=i(e("titleX"),"x"),o=i(e("titleY"),"y");n.enter.auto=o===a?Ei(o):Ci(t,Ei(o),Ei(a))}function Qdt(e,t){const n=qdt(e,t),r=e.encode||{},i=r.axis||{},a=i.name||void 0,o=i.interactive,s=i.style,u=mo(e,n),l=Xft(u),c={scale:e.scale,ticks:!!u("ticks"),labels:!!u("labels"),grid:!!u("grid"),domain:!!u("domain"),title:e.title!=null},f=ft(t.add(pu({},[c]))),d=ft(t.add(eft({scale:t.scaleRef(e.scale),extra:t.property(l.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),h=[];let p;return c.grid&&h.push(Gdt(e,n,r.grid,d,l)),c.ticks&&(p=u("tickSize"),h.push(Xdt(e,n,r.ticks,d,p,l))),c.labels&&(p=c.ticks?p:0,h.push(Ydt(e,n,r.labels,d,p,l))),c.domain&&h.push(Hdt(e,n,r.domain,f)),c.title&&h.push(Zdt(e,n,r.title,f)),XT(aw({role:pct,from:f,encode:r0(eht(u,e),i,iw),marks:h,aria:u("aria"),description:u("description"),zindex:u("zindex"),name:a,interactive:o,style:s}),t)}function eht(e,t){const n={enter:{},update:{}};return Ui(n,{orient:e("orient"),offset:e("offset")||0,position:hu(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:'abs(span(range("'.concat(t.scale,'")))')},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function spe(e,t,n){const r=wt(e.signals),i=wt(e.scales);return n||r.forEach(a=>She(a,t)),wt(e.projections).forEach(a=>Dft(a,t)),i.forEach(a=>xft(a,t)),wt(e.data).forEach(a=>Mdt(a,t)),i.forEach(a=>wft(a,t)),(n||r).forEach(a=>Qct(a,t)),wt(e.axes).forEach(a=>Qdt(a,t)),wt(e.marks).forEach(a=>XT(a,t)),wt(e.legends).forEach(a=>Sdt(a,t)),e.title&&Idt(e.title,t),t.parseLambdas(),t}const tht=e=>r0({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function nht(e,t){const n=t.config,r=ft(t.root=t.add(BT())),i=rht(e,n);i.forEach(l=>She(l,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const a=t.add(pu()),o=t.add(Ohe(whe(tht(e.encode),qT,fj,e.style,t,{pulse:ft(a)}))),s=t.add(Dhe({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:r,pulse:ft(o)}));t.operators.pop(),t.pushState(ft(o),ft(s),null),spe(e,t,i),t.operators.push(s);let u=t.add(khe({mark:r,pulse:ft(s)}));return u=t.add(Nhe({pulse:ft(u)})),u=t.add(Vp({pulse:ft(u)})),t.addData("root",new Hp(t,a,a,u)),t}function sw(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function rht(e,t){const n=o=>hu(e[o],t[o]),r=[sw("background",n("background")),sw("autosize",fct(n("autosize"))),sw("padding",hct(n("padding"))),sw("width",n("width")||0),sw("height",n("height")||0)],i=r.reduce((o,s)=>(o[s.name]=s,o),{}),a={};return wt(e.signals).forEach(o=>{_t(i,o.name)?o=Rt(i[o.name],o):r.push(o),a[o.name]=o}),wt(t.signals).forEach(o=>{!_t(a,o.name)&&!_t(i,o.name)&&r.push(o)}),r}function upe(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function lpe(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}upe.prototype=lpe.prototype={parse(e){return spe(e,this)},fork(){return new lpe(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id}),e.refs=null),e},proxy(e){const t=e instanceof pj?ft(e):e;return this.add(pft({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;this.root&&(this.root.root=!0);for(e in this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(r,i,a){let o,s;r&&(o=r.data||(r.data={}),s=o[i]||(o[i]=[]),s.push(a))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const r in t.index)n(t.index[r],e,"index:"+r)}return this},pushState(e,t,n){this._encode.push(ft(this.add(Vp({pulse:e})))),this._parent.push(t),this._lookup.push(n?ft(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return sn(this._parent)},encode(){return sn(this._encode)},lookup(){return sn(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(Bn(e))return tw(e,t);e.signal||Se("Unsupported field reference: "+gt(e));const n=e.signal;let r=this.field[n];if(!r){const i={name:this.signalRef(n)};t&&(i.as=t),this.field[n]=r=ft(this.add(ift(i)))}return r},compareRef(e){let t=!1;const n=a=>fi(a)?(t=!0,this.signalRef(a.signal)):Wct(a)?(t=!0,this.exprRef(a.expr)):a,r=wt(e.field).map(n),i=wt(e.order).map(n);return t?ft(this.add(The({fields:r,orders:i}))):Ehe(r,i)},keyRef(e,t){let n=!1;const r=a=>fi(a)?(n=!0,ft(i[a.signal])):a,i=this.signals;return e=wt(e).map(r),n?ft(this.add(aft({fields:e,flat:t}))):Bct(e,t)},sortRef(e){if(!e)return e;const t=zT(e.op,e.field),n=e.order||zct;return n.signal?ft(this.add(The({fields:t,orders:this.signalRef(n.signal)}))):Ehe(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const r=this.id();this.streams.push({id:r,source:e,type:t}),this.events[n]=r}return this.events[n]},hasOwnSignal(e){return _t(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&Se("Duplicate signal name: "+gt(e));const n=t instanceof pj?t:this.add(BT(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||Se("Unrecognized signal name: "+gt(e)),this.signals[e]},signalRef(e){return this.signals[e]?ft(this.signals[e]):(_t(this.lambdas,e)||(this.lambdas[e]=this.add(BT(null))),ft(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const r=e[t],i=xl(r,this),a=this.lambdas[r];a.params=i.$params,a.update=i.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return!e||!Nt(e)?e:this.signalRef(e.signal||Fj(e))},exprRef(e,t){const n={expr:xl(e,this)};return t&&(n.expr.$name=t),ft(this.add(nft(n)))},addBinding(e,t){this.bindings||Se("Nested signals do not support binding: "+gt(e)),this.bindings.push(Rt({signal:e},t))},addScaleProj(e,t){_t(this.scales,e)&&Se("Duplicate scale or projection name: "+gt(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,mft(t))},addProjection(e,t){this.addScaleProj(e,hft(t))},getScale(e){return this.scales[e]||Se("Unrecognized scale name: "+gt(e)),this.scales[e]},scaleRef(e){return ft(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return _t(this.data,e)&&Se("Duplicate data set name: "+gt(e)),this.data[e]=t},getData(e){return this.data[e]||Se("Undefined data set name: "+gt(e)),this.data[e]},addDataPipeline(e,t){return _t(this.data,e)&&Se("Duplicate data set name: "+gt(e)),this.addData(e,Hp.fromEntries(this,t))}};function Fj(e){return(ut(e)?iht:aht)(e)}function iht(e){const t=e.length;let n="[";for(let r=0;r<t;++r){const i=e[r];n+=(r>0?",":"")+(Nt(i)?i.signal||Fj(i):gt(i))}return n+"]"}function aht(e){let t="{",n=0,r,i;for(r in e)i=e[r],t+=(++n>1?",":"")+gt(r)+":"+(Nt(i)?i.signal||Fj(i):gt(i));return t+"}"}function oht(){const e="sans-serif",t=30,n=2,r="#4c78a8",i="#000",a="#888",o="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:r},area:{fill:r},image:null,line:{stroke:r,strokeWidth:n},path:{stroke:r},rect:{fill:r},rule:{stroke:i},shape:{stroke:r},symbol:{fill:r,size:64},text:{fill:i,font:e,fontSize:11},trail:{fill:r,size:n},style:{"guide-label":{fill:i,font:e,fontSize:10},"guide-title":{fill:i,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:i,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:i,font:e,fontSize:12},point:{size:t,strokeWidth:n,shape:"circle"},circle:{size:t,strokeWidth:n},square:{size:t,strokeWidth:n,shape:"square"},cell:{fill:"transparent",stroke:o}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:a,grid:!1,gridWidth:1,gridColor:o,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:a,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:o,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:a,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function sht(e,t,n){return Nt(e)||Se("Input Vega specification must be an object."),t=MC(oht(),t,e.config),nht(e,new upe(t,n)).toRuntime()}var uht="vega",lht="5.20.0",cht="The Vega visualization grammar.",fht=["vega","visualization","interaction","dataflow","library","data","d3"],dht="BSD-3-Clause",hht="UW Interactive Data Lab (http://idl.cs.washington.edu)",pht="build/vega-node.js",ght="build/vega.module.js",mht="build/vega.min.js",vht="build/vega.min.js",yht="index.d.ts",bht="vega/vega",xht={bundle:"rollup -c --config-bundle",prebuild:"rimraf build && rimraf build-es5",build:"rollup -c --config-core --config-bundle --config-ie",postbuild:"node schema-copy",pretest:"yarn build --config-test",test:"TZ=America/Los_Angeles tape 'test/**/*-test.js'",prepublishOnly:"yarn test && yarn build",postpublish:"./schema-deploy.sh"},wht={"vega-crossfilter":"~4.0.5","vega-dataflow":"~5.7.3","vega-encode":"~4.8.3","vega-event-selector":"~2.0.6","vega-expression":"~4.0.1","vega-force":"~4.0.7","vega-format":"~1.0.4","vega-functions":"~5.12.0","vega-geo":"~4.3.8","vega-hierarchy":"~4.0.9","vega-label":"~1.0.0","vega-loader":"~4.4.0","vega-parser":"~6.1.3","vega-projection":"~1.4.5","vega-regression":"~1.0.9","vega-runtime":"~6.1.3","vega-scale":"~7.1.1","vega-scenegraph":"~4.9.4","vega-statistics":"~1.7.9","vega-time":"~2.0.4","vega-transforms":"~4.9.3","vega-typings":"~0.20.0","vega-util":"~1.16.1","vega-view":"~5.10.0","vega-view-transforms":"~4.5.8","vega-voronoi":"~4.1.5","vega-wordcloud":"~4.1.3"},_ht={"vega-schema":"*"},Sht="f262105e75449760b0f35fda70e6b576a31d68a4",Eht={name:uht,version:lht,description:cht,keywords:fht,license:dht,author:hht,main:pht,module:ght,unpkg:mht,jsdelivr:vht,types:yht,repository:bht,scripts:xht,dependencies:wht,devDependencies:_ht,gitHead:Sht};Rt(wv,wXe,Uet,xtt,irt,Jrt,Aat,tat,Tat,qat,tot,uot);const Cht=Eht.version;var Aht=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",version:Cht,Dataflow:xv,EventStream:iA,MultiPulse:Q4,Operator:Xn,Parameters:rA,Pulse:cd,Transform:ve,changeset:vp,definition:jie,ingest:In,isTuple:eA,transform:Uie,transforms:wv,tupleid:lt,interpolate:BB,interpolateColors:zA,interpolateRange:Cse,quantizeInterpolator:Ase,scale:Sn,scheme:zB,projection:R5,View:ohe,defaultLocale:Y4,formatLocale:YC,locale:kie,resetDefaultLocale:zGe,timeFormatLocale:I1,expressionFunction:Zr,parse:sht,runtimeContext:zde,codegenExpression:yde,parseExpression:gde,parseSelector:Pd,Debug:Pne,Error:Q$,Info:Mne,None:Rne,Warn:Fne,accessor:ro,accessorFields:Yi,accessorName:Tr,array:wt,ascending:jC,clampRange:Xne,compare:r4,constant:Ji,debounce:i4,error:Se,extend:Rt,extent:tl,extentIndex:Yne,falsy:Qf,fastmap:fv,field:io,flush:Zne,hasOwnProperty:_t,id:s1,identity:Oa,inherits:$e,inrange:dv,isArray:ut,isBoolean:a4,isDate:ed,isFunction:Lt,isIterable:Jne,isNumber:td,isObject:Nt,isRegExp:Qne,isString:Bn,key:o4,lerp:ere,logger:$ne,lruCache:tre,merge:nre,mergeConfig:MC,one:cv,pad:rre,panLinear:Wne,panLog:Vne,panPow:qne,panSymlog:Hne,peek:sn,quarter:Gne,repeat:u1,span:l1,splitAccessPath:RC,stringValue:gt,toBoolean:s4,toDate:u4,toNumber:Zi,toSet:nu,toString:l4,truncate:ire,truthy:ls,utcquarter:Kne,visitArray:nd,writeConfig:PC,zero:Jf,zoomLinear:e4,zoomLog:t4,zoomPow:zC,zoomSymlog:n4,bandwidthNRD:rL,bin:Vie,bootstrapCI:qie,cumulativeLogNormal:lL,cumulativeNormal:uA,cumulativeUniform:hL,densityLogNormal:uL,densityNormal:iL,densityUniform:dL,dotbin:Hie,quantileLogNormal:cL,quantileNormal:lA,quantileUniform:pL,quantiles:tL,quartiles:nL,get random(){return ds},randomInteger:AKe,randomKDE:oL,randomLCG:CKe,randomLogNormal:Kie,randomMixture:Xie,randomNormal:aL,randomUniform:Yie,regressionExp:Jie,regressionLinear:gL,regressionLoess:rae,regressionLog:Zie,regressionPoly:eae,regressionPow:Qie,regressionQuad:mL,sampleCurve:fA,sampleLogNormal:sL,sampleNormal:sA,sampleUniform:fL,setRandom:SKe,DATE:so,DAY:ea,DAYOFYEAR:nl,HOURS:zo,MILLISECONDS:ru,MINUTES:jo,MONTH:Qi,QUARTER:oo,SECONDS:fs,TIME_UNITS:F4,WEEK:si,YEAR:$i,dayofyear:$re,timeBin:nie,timeFloor:Vre,timeInterval:mv,timeOffset:Gre,timeSequence:Yre,timeUnitSpecifier:Pre,timeUnits:P4,utcFloor:qre,utcInterval:vv,utcOffset:Kre,utcSequence:Zre,utcdayofyear:zre,utcweek:jre,week:Lre,read:Tie,inferType:sre,inferTypes:ure,typeParsers:c4,format:VC,formats:m4,responseType:mre,loader:ZC,Bounds:li,CanvasHandler:fx,CanvasRenderer:hk,Gradient:Use,GroupItem:HA,Handler:Cd,Item:qA,Marks:Uo,RenderType:kd,Renderer:pl,ResourceLoader:ZB,SVGHandler:Az,SVGRenderer:Rz,SVGStringRenderer:Pz,Scenegraph:wz,boundClip:ole,boundContext:nx,boundItem:xz,boundMark:wue,boundStroke:Tc,domChild:lo,domClear:su,domCreate:Ed,domFind:_z,font:ik,fontFamily:sx,fontSize:hl,intersect:nle,intersectBoxLine:Lv,intersectPath:iz,intersectPoint:az,intersectRule:oue,lineHeight:_d,markup:Dz,multiLineOffset:vz,pathCurves:qB,pathEqual:sle,pathParse:Mv,pathRectangle:Xse,pathRender:Z1,pathSymbols:Kse,pathTrail:Yse,point:ok,renderModule:gk,resetSVGClipId:Jse,resetSVGDefIds:net,sceneEqual:Lz,sceneFromJSON:Sue,scenePickVisit:QA,sceneToJSON:_ue,sceneVisit:ou,sceneZOrder:oz,serializeXML:que,textMetrics:dl});const kht="vega-lite",Tht='Dominik Moritz, Kanit "Ham" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer',Oht="4.13.1",Iht=["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"],Nht="https://vega.github.io/vega-lite/",Dht="Vega-Lite is a concise high-level language for interactive visualization.",Rht="build/vega-lite.js",Fht="build/vega-lite.min.js",Mht="build/vega-lite.min.js",Pht="build/src/index",$ht="build/src/index.d.ts",Lht={vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2pdf:"./bin/vl2pdf",vl2vg:"./bin/vl2vg"},Bht={test:"test"},zht={changelog:"conventional-changelog -p angular -r 2",build:"yarn build:only","build:only":"yarn tsc:src && rollup -c",postbuild:"terser build/vega-lite.js -cm --source-map content=build/vega-lite.js.map,filename=build/vega-lite.min.js.map -o build/vega-lite.min.js && yarn schema && babel build/vega-lite.js --out-dir build-es5 --config-file ./babel.config.js","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"yarn tsc:site && rollup -c site/rollup.config.js","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh",clean:"find build ! -name 'vega-lite-schema.json' -type f -delete && rm -rf site/data/* && rm -f examples/compiled/*.png && find site/examples ! -name 'index.md' ! -name 'data' -type f -delete","predeploy:site":"yarn presite","deploy:site":"gh-pages -d site",data:"rsync -r node_modules/vega-datasets/data/* site/data",schema:"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/",renameschema:"scripts/rename-schema.sh",presite:"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh",site:"pushd site && bundle exec jekyll serve -I -l && popd","tsc:src":"tsc -b src/tsconfig.src.json","tsc:site":"tsc -b site/tsconfig.site.json",prettierbase:"prettier '**/*.{md,css,yml}'",eslintbase:"eslint .",format:"yarn eslintbase --fix && yarn prettierbase --write",lint:"yarn eslintbase && yarn prettierbase --check",test:"jest test/ && yarn lint && yarn schema && jest examples/ && yarn test:runtime","test:inspect":"node --inspect-brk ./node_modules/.bin/jest --runInBand test","test:runtime":"TZ=America/Los_Angeles jest test-runtime/","test:runtime:generate":"yarn build:only && rm -Rf test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime","watch:build":"yarn build:only && concurrently --kill-others -n Typescript,Rollup 'yarn tsc:src -w' 'rollup -c -w'","watch:site":"concurrently --kill-others -n Typescript,Rollup 'yarn tsc:site -w' 'rollup -c site/rollup.config.js -w'","watch:test":"jest --watch"},jht={type:"git",url:"https://github.com/vega/vega-lite.git"},Uht="BSD-3-Clause",Wht={url:"https://github.com/vega/vega-lite/issues"},Vht={"@babel/cli":"^7.10.1","@babel/core":"^7.10.1","@babel/preset-env":"^7.10.1","@rollup/plugin-commonjs":"12.0.0","@rollup/plugin-json":"^4.0.3","@rollup/plugin-node-resolve":"^8.0.0","@types/chai":"^4.2.11","@types/d3":"^5.7.2","@types/jest":"^25.2.3","@types/mkdirp":"^1.0.0","@types/puppeteer":"^3.0.0","@typescript-eslint/eslint-plugin":"^3.0.2","@typescript-eslint/parser":"^3.0.2",ajv:"^6.12.2",chai:"^4.2.0",cheerio:"^1.0.0-rc.3",codecov:"^3.7.0",concurrently:"^5.2.0","conventional-changelog-cli":"^2.0.34",d3:"^5.16.0",eslint:"^7.1.0","eslint-config-prettier":"^6.11.0","eslint-plugin-jest":"^23.13.2","eslint-plugin-prettier":"^3.1.3","gh-pages":"^2.2.0","highlight.js":"^10.0.3","http-server":"^0.12.3",jest:"^26.0.1","jest-puppeteer":"^4.4.0",mkdirp:"^1.0.4",prettier:"^2.0.5",puppeteer:"^3.1.0",rollup:"^2.11.0","rollup-plugin-sourcemaps":"^0.6.2","rollup-plugin-terser":"^6.1.0","svg2png-many":"^0.0.7",terser:"^4.7.0","ts-jest":"^26.0.0","ts-json-schema-generator":"^0.68.1",typescript:"~3.9.3","vega-cli":"^5.12.1","vega-datasets":"^1.30.2","vega-embed":"^6.8.0","vega-tooltip":"^0.23.0","vega-typings":"^0.17.0","yaml-front-matter":"^4.1.0"},qht={"@types/clone":"~0.1.30","@types/fast-json-stable-stringify":"^2.0.0","array-flat-polyfill":"^1.0.1",clone:"~2.1.2","fast-deep-equal":"~3.1.1","fast-json-stable-stringify":"~2.1.0","json-stringify-pretty-compact":"~2.0.0",tslib:"~2.0.0","vega-event-selector":"~2.0.3","vega-expression":"~2.6.5","vega-util":"~1.14.0",yargs:"~15.3.1"},Hht={vega:"^5.12.1"},Ght={preset:"jest-puppeteer",transform:{"^.+\\.tsx?$":"ts-jest"},testRegex:"(/__tests__/.*|(\\.|/)(test|spec))\\.(jsx?|tsx?)$",moduleFileExtensions:["ts","tsx","js","jsx","json","node"],testPathIgnorePatterns:["<rootDir>/node_modules","<rootDir>/build","<rootDir>/_site","<rootDir>/src"],coverageDirectory:"./coverage/",collectCoverage:!1};var Kht={name:kht,author:Tht,version:Oht,collaborators:Iht,homepage:Nht,description:Dht,main:Rht,unpkg:Fht,jsdelivr:Mht,module:Pht,types:$ht,bin:Lht,directories:Bht,scripts:zht,repository:jht,license:Uht,bugs:Wht,devDependencies:Vht,dependencies:qht,peerDependencies:Hht,jest:Ght};function f0(e,t,n){return e.fields=t||[],e.fname=n,e}function Xht(e){return e.length===1?Yht(e[0]):Zht(e)}const Yht=e=>function(t){return t[e]},Zht=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function Mj(e){throw Error(e)}function Kp(e){var t=[],n=null,r=0,i=e.length,a="",o,s,u;e=e+"";function l(){t.push(a+e.substring(o,s)),a="",o=s+1}for(o=s=0;s<i;++s)if(u=e[s],u==="\\")a+=e.substring(o,s),a+=e.substring(++s,++s),o=s;else if(u===n)l(),n=null,r=-1;else{if(n)continue;o===r&&u==='"'||o===r&&u==="'"?(o=s+1,n=u):u==="."&&!r?s>o?l():o=s+1:u==="["?(s>o&&l(),r=o=s+1):u==="]"&&(r||Mj("Access path missing open bracket: "+e),r>0&&l(),r=0,o=s+1)}return r&&Mj("Access path missing closing bracket: "+e),n&&Mj("Access path missing closing quote: "+e),s>o&&(s++,l()),t}function Jht(e,t,n){const r=Kp(e);return e=r.length===1?r[0]:e,f0((n&&n.get||Xht)(r),[e],t||e)}var uw=[];Jht("id");var Qht=f0(function(e){return e},uw,"identity");f0(function(){return 0},uw,"zero"),f0(function(){return 1},uw,"one"),f0(function(){return!0},uw,"true"),f0(function(){return!1},uw,"false");function ZT(e,t,n){var r=[t].concat([].slice.call(n));console[e].apply(console,r)}var ept=0,tpt=1,cpe=2,npt=3,rpt=4;function ipt(e,t){var n=e||ept;return{level:function(r){return arguments.length?(n=+r,this):n},error:function(){return n>=tpt&&ZT(t||"error","ERROR",arguments),this},warn:function(){return n>=cpe&&ZT(t||"warn","WARN",arguments),this},info:function(){return n>=npt&&ZT(t||"log","INFO",arguments),this},debug:function(){return n>=rpt&&ZT(t||"log","DEBUG",arguments),this}}}var vt=Array.isArray;function Ai(e){return e===Object(e)}const fpe=e=>e!=="__proto__";function dpe(...e){return e.reduce((t,n)=>{for(var r in n)if(r==="signals")t.signals=apt(t.signals,n.signals);else{var i=r==="legend"?{layout:1}:r==="style"?!0:null;Pj(t,r,n[r],i)}return t},{})}function Pj(e,t,n,r){if(!!fpe(t)){var i,a;if(Ai(n)&&!vt(n)){a=Ai(e[t])?e[t]:e[t]={};for(i in n)r&&(r===!0||r[i])?Pj(a,i,n[i]):fpe(i)&&(a[i]=n[i])}else e[t]=n}}function apt(e,t){if(e==null)return t;const n={},r=[];function i(a){n[a.name]||(n[a.name]=1,r.push(a))}return t.forEach(i),e.forEach(i),r}function Br(e){return e!=null?vt(e)?e:[e]:[]}function opt(e){return typeof e=="function"}const spt=Object.prototype.hasOwnProperty;function Xp(e,t){return spt.call(e,t)}function lw(e){return typeof e=="boolean"}function Jr(e){return typeof e=="number"}function Xt(e){return typeof e=="string"}function gn(e){return vt(e)?"["+e.map(gn)+"]":Ai(e)||Xt(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function Yp(e){for(var t={},n=0,r=e.length;n<r;++n)t[e[n]]=!0;return t}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function dt(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,function(n,r){return Array.isArray(r)?n.push.apply(n,e.call(r,t-1)):n.push(r),n},[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var hpe={exports:{}};(function(e){var t=function(){function n(d,h){return h!=null&&d instanceof h}var r;try{r=Map}catch(d){r=function(){}}var i;try{i=Set}catch(d){i=function(){}}var a;try{a=Promise}catch(d){a=function(){}}function o(d,h,p,g,m){typeof h=="object"&&(p=h.depth,g=h.prototype,m=h.includeNonEnumerable,h=h.circular);var v=[],y=[],b=typeof Buffer!="undefined";typeof h=="undefined"&&(h=!0),typeof p=="undefined"&&(p=1/0);function x(w,S){if(w===null)return null;if(S===0)return w;var C,_;if(typeof w!="object")return w;if(n(w,r))C=new r;else if(n(w,i))C=new i;else if(n(w,a))C=new a(function(L,W){w.then(function(G){L(x(G,S-1))},function(G){W(x(G,S-1))})});else if(o.__isArray(w))C=[];else if(o.__isRegExp(w))C=new RegExp(w.source,f(w)),w.lastIndex&&(C.lastIndex=w.lastIndex);else if(o.__isDate(w))C=new Date(w.getTime());else{if(b&&Buffer.isBuffer(w))return Buffer.allocUnsafe?C=Buffer.allocUnsafe(w.length):C=new Buffer(w.length),w.copy(C),C;n(w,Error)?C=Object.create(w):typeof g=="undefined"?(_=Object.getPrototypeOf(w),C=Object.create(_)):(C=Object.create(g),_=g)}if(h){var E=v.indexOf(w);if(E!=-1)return y[E];v.push(w),y.push(C)}n(w,r)&&w.forEach(function(L,W){var G=x(W,S-1),K=x(L,S-1);C.set(G,K)}),n(w,i)&&w.forEach(function(L){var W=x(L,S-1);C.add(W)});for(var A in w){var k;_&&(k=Object.getOwnPropertyDescriptor(_,A)),!(k&&k.set==null)&&(C[A]=x(w[A],S-1))}if(Object.getOwnPropertySymbols)for(var T=Object.getOwnPropertySymbols(w),A=0;A<T.length;A++){var I=T[A],N=Object.getOwnPropertyDescriptor(w,I);N&&!N.enumerable&&!m||(C[I]=x(w[I],S-1),N.enumerable||Object.defineProperty(C,I,{enumerable:!1}))}if(m)for(var O=Object.getOwnPropertyNames(w),A=0;A<O.length;A++){var D=O[A],N=Object.getOwnPropertyDescriptor(w,D);N&&N.enumerable||(C[D]=x(w[D],S-1),Object.defineProperty(C,D,{enumerable:!1}))}return C}return x(d,p)}o.clonePrototype=function(h){if(h===null)return null;var p=function(){};return p.prototype=h,new p};function s(d){return Object.prototype.toString.call(d)}o.__objToStr=s;function u(d){return typeof d=="object"&&s(d)==="[object Date]"}o.__isDate=u;function l(d){return typeof d=="object"&&s(d)==="[object Array]"}o.__isArray=l;function c(d){return typeof d=="object"&&s(d)==="[object RegExp]"}o.__isRegExp=c;function f(d){var h="";return d.global&&(h+="g"),d.ignoreCase&&(h+="i"),d.multiline&&(h+="m"),h}return o.__getRegExpFlags=f,o}();e.exports&&(e.exports=t)})(hpe);var upt=hpe.exports,lpt=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var r,i,a;if(Array.isArray(t)){if(r=t.length,r!=n.length)return!1;for(i=r;i--!=0;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(a=Object.keys(t),r=a.length,r!==Object.keys(n).length)return!1;for(i=r;i--!=0;)if(!Object.prototype.hasOwnProperty.call(n,a[i]))return!1;for(i=r;i--!=0;){var o=a[i];if(!e(t[o],n[o]))return!1}return!0}return t!==t&&n!==n},cw=function(e,t){t||(t={}),typeof t=="function"&&(t={cmp:t});var n=typeof t.cycles=="boolean"?t.cycles:!1,r=t.cmp&&function(a){return function(o){return function(s,u){var l={key:s,value:o[s]},c={key:u,value:o[u]};return a(l,c)}}}(t.cmp),i=[];return function a(o){if(o&&o.toJSON&&typeof o.toJSON=="function"&&(o=o.toJSON()),o!==void 0){if(typeof o=="number")return isFinite(o)?""+o:"null";if(typeof o!="object")return JSON.stringify(o);var s,u;if(Array.isArray(o)){for(u="[",s=0;s<o.length;s++)s&&(u+=","),u+=a(o[s])||"null";return u+"]"}if(o===null)return"null";if(i.indexOf(o)!==-1){if(n)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var l=i.push(o)-1,c=Object.keys(o).sort(r&&r(o));for(u="",s=0;s<c.length;s++){var f=c[s],d=a(o[f]);!d||(u&&(u+=","),u+=JSON.stringify(f)+":"+d)}return i.splice(l,1),"{"+u+"}"}}(e)};function $j(e){return!!e.or}function Lj(e){return!!e.and}function Bj(e){return!!e.not}function JT(e,t){if(Bj(e))JT(e.not,t);else if(Lj(e))for(const n of e.and)JT(n,t);else if($j(e))for(const n of e.or)JT(n,t);else t(e)}function QT(e,t){return Bj(e)?{not:QT(e.not,t)}:Lj(e)?{and:e.and.map(n=>QT(n,t))}:$j(e)?{or:e.or.map(n=>QT(n,t))}:t(e)}const fw=lpt,Yt=upt;function dw(e,t){const n={};for(const r of t)Xp(e,r)&&(n[r]=e[r]);return n}function Bc(e,t){const n=Object.assign({},e);for(const r of t)delete n[r];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>cw(e)).join(",")})`};const cr=cw;function yn(e){if(Jr(e))return e;const t=Xt(e)?e:cw(e);if(t.length<250)return t;let n=0;for(let r=0;r<t.length;r++){const i=t.charCodeAt(r);n=(n<<5)-n+i,n=n&n}return n}function ppe(e){return e===!1||e===null}function bt(e,t){return e.indexOf(t)>-1}function hw(e,t){let n=0;for(const[r,i]of e.entries())if(t(i,r,n++))return!0;return!1}function gpe(e,t){let n=0;for(const[r,i]of e.entries())if(!t(i,r,n++))return!1;return!0}function cpt(e,...t){for(const n of t)fpt(e,n??{});return e}function fpt(e,t){for(const n of Be(t))Pj(e,n,t[n],!0)}function Ld(e,t){const n=[],r={};let i;for(const a of e)i=t(a),!(i in r)&&(r[i]=1,n.push(a));return n}function dpt(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function mpe(e,t){for(const n of e)if(t.has(n))return!0;return!1}function vpe(e){const t=new Set;for(const n of e){const i=Kp(n).map((o,s)=>s===0?o:`[${o}]`),a=i.map((o,s)=>i.slice(0,s+1).join(""));for(const o of a)t.add(o)}return t}function ype(e,t){return e===void 0||t===void 0?!0:mpe(vpe(e),vpe(t))}function Yn(e){return Be(e).length===0}const Be=Object.keys,Bd=Object.values;function bpe(e){const t=[];for(const n in e)Xp(e,n)&&t.push({key:n,value:e[n]});return t}function eO(e){return e===!0||e===!1}function fr(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function pw(e,t){return Bj(e)?"!("+pw(e.not,t)+")":Lj(e)?"("+e.and.map(n=>pw(n,t)).join(") && (")+")":$j(e)?"("+e.or.map(n=>pw(n,t)).join(") || (")+")":t(e)}function zj(e,t){if(t.length===0)return!0;const n=t.shift();return n in e&&zj(e[n],t)&&delete e[n],Yn(e)}function tO(e){return e.charAt(0).toUpperCase()+e.substr(1)}function xpe(e,t="datum"){const n=Kp(e),r=[];for(let i=1;i<=n.length;i++){const a=`[${n.slice(0,i).map(gn).join("][")}]`;r.push(`${t}${a}`)}return r.join(" && ")}function hpt(e,t="datum"){return`${t}[${gn(Kp(e).join("."))}]`}function ppt(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function zd(e){return`${Kp(e).map(ppt).join("\\.")}`}function d0(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function wpe(e){return`${Kp(e).join(".")}`}function gw(e){return e?Kp(e).length:0}function Qr(...e){for(const t of e)if(t!==void 0)return t}let gpt=42;function mpt(e){const t=++gpt;return e?String(e)+t:t}function vpt(e){return ypt(e)?e:`__${e}`}function ypt(e){return e.indexOf("__")===0}function nO(e){if(e!==void 0)return(e%360+360)%360}function jj(e){return Jr(e)?!0:!isNaN(e)&&!isNaN(parseFloat(e))}const _pe={domainColor:{part:"domain",vgProp:"stroke"},labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDash"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDash"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"},titleColor:{part:"title",vgProp:"fill"},title:null};function Uj(e){return e&&e.condition}const Spe=["domain","grid","labels","ticks","title"],bpt={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"main",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},Epe={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},xpt=Object.assign(Object.assign({},Epe),{style:1,labelExpr:1,encoding:1});function Cpe(e){return!!xpt[e]}const Ua={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},Ape=Ua.arc,rO=Ua.area,iO=Ua.bar,wpt=Ua.image,aO=Ua.line,oO=Ua.point,_pt=Ua.rect,sO=Ua.rule,kpe=Ua.text,Wj=Ua.tick,Spt=Ua.trail,Vj=Ua.circle,qj=Ua.square,Tpe=Ua.geoshape;function Zp(e){return bt(["line","area","trail"],e)}function Ope(e){return bt(["rect","bar","image","arc"],e)}const Ipe=Be(Ua);function wl(e){return e.type}Yp(Ipe);const Ept=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],Cpt=["fill","fillOpacity"],Apt=[...Ept,...Cpt],kpt={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBand:1,timeUnitBandPosition:1},Npe=Be(kpt),Tpt={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]},Opt={color:"#4c78a8",invalid:"filter",timeUnitBand:1},Ipt={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},Dpe=5,Npt={binSpacing:1,continuousBandSize:Dpe,timeUnitBandPosition:.5},Dpt={binSpacing:0,continuousBandSize:Dpe,timeUnitBandPosition:.5},Rpt={thickness:1};function Fpt(e){return wl(e)?e.type:e}function zc(e){return"mark"in e}class uO{constructor(t,n){this.name=t,this.run=n}hasMatchingType(t){return zc(t)?Fpt(t.mark)===this.name:!1}}const Mpt={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},Ppt={count:1,min:1,max:1};function jd(e){return!!e&&!!e.argmin}function Jp(e){return!!e&&!!e.argmax}function Hj(e){return Xt(e)&&!!Mpt[e]}const $pt=["count","valid","missing","distinct"];function Rpe(e){return Xt(e)&&bt($pt,e)}function Lpt(e){return Xt(e)&&bt(["min","max"],e)}const Bpt=["count","sum","distinct","valid","missing"],zpt=["mean","average","median","q1","q3","min","max"],jpt=Yp(zpt),jc="row",Uc="column",lO="facet",br="x",di="y",vu="x2",_l="y2",Sl="radius",Wc="radius2",yu="theta",Vc="theta2",El="latitude",Cl="longitude",bu="latitude2",ws="longitude2",vo="color",Al="fill",kl="stroke",yo="shape",qc="size",Qp="angle",Hc="opacity",Ud="fillOpacity",Wd="strokeOpacity",Vd="strokeWidth",qd="strokeDash",mw="text",vw="order",yw="detail",cO="key",eg="tooltip",fO="href",dO="url",hO="description",Upt={x:1,y:1,x2:1,y2:1},Fpe={theta:1,theta2:1,radius:1,radius2:1};function Mpe(e){return e in Fpe}const Gj={longitude:1,longitude2:1,latitude:1,latitude2:1};function Wpt(e){switch(e){case El:return"y";case bu:return"y2";case Cl:return"x";case ws:return"x2"}}function Vpt(e){return e in Gj}const qpt=Be(Gj),Ppe=Object.assign(Object.assign(Object.assign(Object.assign({},Upt),Fpe),Gj),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function h0(e){return e===vo||e===Al||e===kl}const $pe={row:1,column:1,facet:1},_s=Be($pe),Kj=Object.assign(Object.assign({},Ppe),$pe),Lpe=Be(Kj),Hpt=dt(Kj,["order","detail","tooltip"]),Gpt=dt(Hpt,["row","column","facet"]);function Kpt(e){return!!Gpt[e]}function Bpe(e){return!!Kj[e]}const Xpt=[vu,_l,bu,ws,Vc,Wc];function zpe(e){return tg(e)!==e}function tg(e){switch(e){case vu:return br;case _l:return di;case bu:return El;case ws:return Cl;case Vc:return yu;case Wc:return Sl}return e}function Hd(e){if(Mpe(e))switch(e){case yu:return"startAngle";case Vc:return"endAngle";case Sl:return"outerRadius";case Wc:return"innerRadius"}return e}function Tl(e){switch(e){case br:return vu;case di:return _l;case El:return bu;case Cl:return ws;case yu:return Vc;case Sl:return Wc}}function Ol(e){switch(e){case br:case vu:return"width";case di:case _l:return"height"}}function Ypt(e){switch(e){case br:return"xOffset";case di:return"yOffset";case vu:return"x2Offset";case _l:return"y2Offset";case yu:return"thetaOffset";case Sl:return"radiusOffset";case Vc:return"theta2Offset";case Wc:return"radius2Offset"}}const Xj=dt(Ppe,["x","y","x2","y2","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),Zpt=Be(Xj),Gd={x:1,y:1},Ss=Be(Gd);function Il(e){return e in Gd}const Yj={theta:1,radius:1},Jpt=Be(Yj);function pO(e){return e==="width"?br:di}const jpe=dt(Xj,["text","tooltip","href","url","description","detail","key","order"]),Qpt=Be(jpe);function egt(e){return!!Xj[e]}function tgt(e){switch(e){case vo:case Al:case kl:case qc:case yo:case Hc:case Vd:case qd:return!0;case Ud:case Wd:case Qp:return!1}}const Upe=Object.assign(Object.assign(Object.assign({},Gd),Yj),jpe),gO=Be(Upe);function Kd(e){return!!Upe[e]}function ngt(e,t){return igt(e)[t]}const Wpe={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},rgt=dt(Wpe,["geoshape"]);function igt(e){switch(e){case vo:case Al:case kl:case hO:case yw:case cO:case eg:case fO:case vw:case Hc:case Ud:case Wd:case Vd:case lO:case jc:case Uc:return Wpe;case br:case di:case El:case Cl:return rgt;case vu:case _l:case bu:case ws:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case qc:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case qd:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case yo:return{point:"always",geoshape:"always"};case mw:return{text:"always"};case Qp:return{point:"always",square:"always",text:"always"};case dO:return{image:"always"};case yu:return{text:"always",arc:"always"};case Sl:return{text:"always",arc:"always"};case Vc:case Wc:return{arc:"always"}}}function mO(e){switch(e){case br:case di:case yu:case Sl:case qc:case Qp:case Vd:case Hc:case Ud:case Wd:case vu:case _l:case Vc:case Wc:return;case lO:case jc:case Uc:case yo:case qd:case mw:case eg:case fO:case dO:case hO:return"discrete";case vo:case Al:case kl:return"flexible";case El:case Cl:case bu:case ws:case yw:case cO:case vw:return}}function Vpe(e){return lw(e)&&(e=TO(e,void 0)),"bin"+Be(e).map(t=>vO(e[t])?fr(`_${t}_${Object.entries(e[t])}`):fr(`_${t}_${e[t]}`)).join("")}function Qn(e){return e===!0||bw(e)&&!e.binned}function Wa(e){return e==="binned"||bw(e)&&e.binned===!0}function bw(e){return Ai(e)}function vO(e){return e==null?void 0:e.selection}function qpe(e){switch(e){case jc:case Uc:case qc:case vo:case Al:case kl:case Vd:case Hc:case Ud:case Wd:case yo:return 6;case qd:return 4;default:return 10}}function Zj(e){return`Invalid specification ${JSON.stringify(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const agt='Autosize "fit" only works for single views and layered views.';function Hpe(e){return`${e=="width"?"Width":"Height"} "container" only works for single views and layered views.`}function Gpe(e){const t=e=="width"?"Width":"Height",n=e=="width"?"x":"y";return`${t} "container" only works well with autosize "fit" or "fit-${n}".`}function Kpe(e){return e?`Dropping "fit-${e}" because spec has discrete ${Ol(e)}.`:'Dropping "fit" because spec has discrete size.'}function Xpe(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function ogt(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function sgt(e){return`The "nearest" transform is not supported for ${e} marks.`}function Ype(e){return`Selection not supported for ${e} yet.`}function ugt(e){return`Cannot find a selection named "${e}".`}const lgt="Scale bindings are currently only supported for scales with unbinned, continuous domains.",cgt="Legend bindings are only supported for selections over an individual field or encoding channel.";function fgt(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}function dgt(e){return`Unknown repeated value "${e}".`}function Zpe(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}const hgt="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function pgt(e){return`Unrecognized parse "${e}".`}function Jpe(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}function ggt(e){return`Ignoring an invalid transform: ${cr(e)}.`}const mgt='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function Qpe(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function vgt(e){return`Layer's shared ${e.join(",")} channel ${e.length===1?"is":"are"} overriden.`}function ygt(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${cr(t)} is overridden by a child projection ${cr(n)}.`}const bgt="Arc marks uses theta channel rather than angle, replacing angle with theta.";function xgt(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${cr(n)}}.`}function ege(e){return`Invalid field type "${e}".`}function wgt(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function _gt(e){return`Invalid aggregation operator "${e}".`}function Sgt(e,t){return`Missing type for channel "${e}", using "${t}" instead.`}function tge(e,t){const{fill:n,stroke:r}=t;return`Dropping color ${e} as the plot also has ${n&&r?"fill and stroke":n?"fill":"stroke"}.`}function Jj(e,t){return`Dropping ${cr(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}const Egt="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function yO(e,t,n){return`${e} dropped as it is incompatible with "${t}"${n?` when ${n}`:""}.`}function Cgt(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function Agt(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function kgt(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function Qj(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${t==="ordinal"?"order":"magnitude"}.`}function Tgt(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function Ogt(e,t){return`Specified orient "${e}" overridden with "${t}".`}const Igt=`Scale's "rangeStep" is deprecated and will be removed in Vega-Lite 5.0. Please use "width"/"height": {"step": ...} instead. See https://vega.github.io/vega-lite/docs/size.html.`;function Ngt(e){return`Cannot use the scale property "${e}" with non-color channel.`}function Dgt(e){return`Using unaggregated domain with raw field has no effect (${cr(e)}).`}function Rgt(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function Fgt(e){return`Unaggregated domain is currently unsupported for log scale (${cr(e)}).`}function Mgt(e){return`Cannot apply size to non-oriented mark "${e}".`}function Pgt(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function $gt(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function nge(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function rge(e){return`The step for "${e}" is dropped because the ${e==="width"?"x":"y"} is continuous.`}function Lgt(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${cr(n)} and ${cr(r)}). Using ${cr(n)}.`}function Bgt(e,t,n,r){return`Conflicting ${t.toString()} property "${e.toString()}" (${cr(n)} and ${cr(r)}). Using the union of the two domains.`}function zgt(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function jgt(e){return`Dropping sort property ${cr(e)} as unioned domains only support boolean or op "count", "min", and "max".`}const ige="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",Ugt="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",Wgt="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",Vgt="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.";function qgt(e){return`Cannot stack "${e}" if there is already "${e}2".`}function Hgt(e){return`Cannot stack non-linear scale (${e}).`}function Ggt(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function bO(e,t){return`Invalid ${e}: ${cr(t)}.`}function Kgt(e){return`Dropping day from datetime ${cr(e)} as day cannot be combined with other units.`}function Xgt(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function Ygt(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function Zgt(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function Jgt(e,t){return`Center is not needed to be specified in ${t} when extent is ${e}.`}function age(e){return`1D error band does not support ${e}.`}function oge(e){return`Channel ${e} is required for "binned" bin.`}function Qgt(e){return`Domain for ${e} is required for threshold scale.`}const sge=ipt(cpe);let p0=sge;function emt(e){return p0=e,p0}function tmt(){return p0=sge,p0}function Me(...e){p0.warn(...e)}function nmt(...e){p0.debug(...e)}function g0(e){if(e&&Ai(e)){for(const t of t8)if(t in e)return!0}return!1}const uge=["january","february","march","april","may","june","july","august","september","october","november","december"],rmt=uge.map(e=>e.substr(0,3)),lge=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],imt=lge.map(e=>e.substr(0,3));function amt(e){if(jj(e)&&(e=+e),Jr(e))return e>4&&Me(bO("quarter",e)),e-1;throw new Error(bO("quarter",e))}function omt(e){if(jj(e)&&(e=+e),Jr(e))return e-1;{const t=e.toLowerCase(),n=uge.indexOf(t);if(n!==-1)return n;const r=t.substr(0,3),i=rmt.indexOf(r);if(i!==-1)return i;throw new Error(bO("month",e))}}function smt(e){if(jj(e)&&(e=+e),Jr(e))return e%7;{const t=e.toLowerCase(),n=lge.indexOf(t);if(n!==-1)return n;const r=t.substr(0,3),i=imt.indexOf(r);if(i!==-1)return i;throw new Error(bO("day",e))}}function e8(e,t){const n=[];if(t&&e.day!==void 0&&Be(e).length>1&&(Me(Kgt(e)),e=Yt(e),delete e.day),e.year!==void 0?n.push(e.year):n.push(2012),e.month!==void 0){const r=t?omt(e.month):e.month;n.push(r)}else if(e.quarter!==void 0){const r=t?amt(e.quarter):e.quarter;n.push(Jr(r)?r*3:r+"*3")}else n.push(0);if(e.date!==void 0)n.push(e.date);else if(e.day!==void 0){const r=t?smt(e.day):e.day;n.push(Jr(r)?r+1:r+"+1")}else n.push(1);for(const r of["hours","minutes","seconds","milliseconds"]){const i=e[r];n.push(typeof i=="undefined"?0:i)}return n}function xw(e){const n=e8(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function umt(e){const n=e8(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function lmt(e){const t=e8(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}const cge={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},t8=Be(cge);function cmt(e){return!!cge[e]}function n8(e){return e.startsWith("utc")}function fmt(e){return e.substr(3)}const dmt={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function r8(e){const t=[];for(const n of t8)fge(e,n)&&t.push(n);return t}function fge(e,t){const n=e.indexOf(t);return!(n<0||n>0&&t==="seconds"&&e.charAt(n-1)==="i"||e.length>n+3&&t==="day"&&e.charAt(n+3)==="o"||n>0&&t==="year"&&e.charAt(n-1)==="f")}function hmt(e,t,{end:n}={end:!1}){const r=xpe(t),i=n8(e)?"utc":"";function a(u){return u==="quarter"?`(${i}quarter(${r})-1)`:`${i}${u}(${r})`}let o;const s={};for(const u of t8)fge(e,u)&&(s[u]=a(u),o=u);return n&&(s[o]+="+1"),umt(s)}function dge(e){if(!e)return;const t=r8(e);return`timeUnitSpecifier(${cw(t)}, ${cw(dmt)})`}function pmt(e,t,n){if(!e)return;const r=dge(e);return`${n||n8(e)?"utc":"time"}Format(${t}, ${r})`}function Va(e){if(!e)return;let t;return Xt(e)?t={unit:e}:Ai(e)&&(t=Object.assign(Object.assign({},e),e.unit?{unit:e.unit}:{})),n8(t.unit)&&(t.utc=!0,t.unit=fmt(t.unit)),t}function gmt(e){const t=Va(e),{utc:n}=t,r=dt(t,["utc"]);return r.unit?(n?"utc":"")+Be(r).map(i=>fr(`${i==="unit"?"":`_${i}_`}${r[i]}`)).join(""):(n?"utc":"")+"timeunit"+Be(r).map(i=>fr(`_${i}_${r[i]}`)).join("")}function Et(e){return e&&!!e.signal}function Xd(e){return!!e.step}function mmt(e){return vt(e)?!1:"fields"in e&&!("data"in e)}function vmt(e){return vt(e)?!1:"fields"in e&&"data"in e}function Yd(e){return vt(e)?!1:"field"in e&&"data"in e}const ymt={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1},bmt=Be(ymt),xmt={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},i8=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function wmt(e){return e==null?void 0:e.selection}function a8(e){return e&&!!e.field&&e.equal!==void 0}function hge(e){return e&&!!e.field&&e.lt!==void 0}function pge(e){return e&&!!e.field&&e.lte!==void 0}function gge(e){return e&&!!e.field&&e.gt!==void 0}function mge(e){return e&&!!e.field&&e.gte!==void 0}function o8(e){if(e&&e.field){if(vt(e.range)&&e.range.length===2)return!0;if(Et(e.range))return!0}return!1}function s8(e){return e&&!!e.field&&(vt(e.oneOf)||vt(e.in))}function _mt(e){return e&&!!e.field&&e.valid!==void 0}function vge(e){return s8(e)||a8(e)||o8(e)||hge(e)||gge(e)||pge(e)||mge(e)}function Nl(e,t){return C8(e,{timeUnit:t,wrapTime:!0})}function Smt(e,t){return e.map(n=>Nl(n,t))}function yge(e,t=!0){var n;const{field:r}=e,i=(n=Va(e.timeUnit))===null||n===void 0?void 0:n.unit,a=i?"time("+hmt(i,r)+")":Ue(e,{expr:"datum"});if(a8(e))return a+"==="+Nl(e.equal,i);if(hge(e)){const o=e.lt;return`${a}<${Nl(o,i)}`}else if(gge(e)){const o=e.gt;return`${a}>${Nl(o,i)}`}else if(pge(e)){const o=e.lte;return`${a}<=${Nl(o,i)}`}else if(mge(e)){const o=e.gte;return`${a}>=${Nl(o,i)}`}else{if(s8(e))return`indexof([${Smt(e.oneOf,i).join(",")}], ${a}) !== -1`;if(_mt(e))return u8(a,e.valid);if(o8(e)){const{range:o}=e,s=Et(o)?{signal:`${o.signal}[0]`}:o[0],u=Et(o)?{signal:`${o.signal}[1]`}:o[1];if(s!==null&&u!==null&&t)return"inrange("+a+", ["+Nl(s,i)+", "+Nl(u,i)+"])";const l=[];return s!==null&&l.push(`${a} >= ${Nl(s,i)}`),u!==null&&l.push(`${a} <= ${Nl(u,i)}`),l.length>0?l.join(" && "):"true"}}throw new Error(`Invalid field predicate: ${JSON.stringify(e)}`)}function u8(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function Emt(e){var t;return vge(e)&&e.timeUnit?Object.assign(Object.assign({},e),{timeUnit:(t=Va(e.timeUnit))===null||t===void 0?void 0:t.unit}):e}const m0={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"},ng=m0.quantitative,l8=m0.ordinal,v0=m0.temporal,c8=m0.nominal,y0=m0.geojson,Cmt=Be(m0);function Amt(e){if(e)switch(e=e.toLowerCase(),e){case"q":case ng:return"quantitative";case"t":case v0:return"temporal";case"o":case l8:return"ordinal";case"n":case c8:return"nominal";case y0:return"geojson"}}const ei={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},f8={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"},kmt=Be(f8);function Tmt(e,t){const n=f8[e],r=f8[t];return n===r||n==="ordinal-position"&&r==="time"||r==="ordinal-position"&&n==="time"}const Omt={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function bge(e){return Omt[e]}const xge=["linear","log","pow","sqrt","symlog","time","utc"],Imt=Yp(xge),Nmt=["linear","log","pow","sqrt","symlog"],Dmt=Yp(Nmt);function Rmt(e){return e in Dmt}const Fmt=["quantile","quantize","threshold"],Mmt=Yp(Fmt),Pmt=xge.concat(["quantile","quantize","threshold","sequential","identity"]),$mt=Yp(Pmt),Lmt=["ordinal","bin-ordinal","point","band"],Bmt=Yp(Lmt);function bo(e){return e in Bmt}function Es(e){return e in $mt}function xu(e){return e in Imt}function xO(e){return e in Mmt}const zmt={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4};function jmt(e){return!Xt(e)&&!!e.name}function wge(e){return e==null?void 0:e.selection}function Umt(e){return e&&e.unionWith}const Wmt={type:1,domain:1,domainMid:1,align:1,range:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},Vmt=dt(Wmt,["type","domain","range","scheme"]),qmt=Be(Vmt);Hmt();function _ge(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!bt(["point","band","identity"],e);case"bins":return!bt(["point","band","identity","ordinal"],e);case"round":return xu(e)||e==="band"||e==="point";case"padding":return xu(e)||bt(["point","band"],e);case"paddingOuter":case"align":return bt(["point","band"],e);case"paddingInner":return e==="band";case"domainMid":case"clamp":return xu(e);case"nice":return xu(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return Es(e)&&!bt(["log","time","utc","threshold","quantile"],e)}}function Sge(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return h0(e)?void 0:Ngt(e);case"align":case"type":case"bins":case"domain":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"reverse":case"round":case"clamp":case"zero":return}}function Ege(e,t){return bt([l8,c8],t)?e===void 0||bo(e):t===v0?bt([ei.TIME,ei.UTC,void 0],e):t===ng?bt([ei.LOG,ei.POW,ei.SQRT,ei.SYMLOG,ei.QUANTILE,ei.QUANTIZE,ei.THRESHOLD,ei.LINEAR,void 0],e):!0}function Cge(e,t){if(!Kd(e))return!1;switch(e){case br:case di:case yu:case Sl:return xu(t)||bt(["band","point"],t);case qc:case Vd:case Hc:case Ud:case Wd:case Qp:return xu(t)||xO(t)||bt(["band","point","ordinal"],t);case vo:case Al:case kl:return t!=="band";case qd:return t==="ordinal"||xO(t);case yo:return t==="ordinal"}}function Hmt(){var e;const t={};for(const n of Lpe)for(const r of Cmt)for(const i of kmt){const a=Gmt(n,r);Cge(n,i)&&Ege(i,r)&&(t[a]=(e=t[a])!==null&&e!==void 0?e:[],t[a].push(i))}return t}function Gmt(e,t){return e+"_"+t}function d8(e){const{channel:t,channelDef:n,markDef:r,scale:i,config:a}=e,o=kge(e);return We(n)&&!Rpe(n.aggregate)&&i&&xu(i.get("type"))&&i.get("zero")===!1?Age({fieldDef:n,channel:t,markDef:r,ref:o,config:a}):o}function Age({fieldDef:e,channel:t,markDef:n,ref:r,config:i}){return Zp(n.type)||Fn("invalid",n,i)===null?r:[Kmt(e,t),r]}function Kmt(e,t){const n=h8(e,!0),i=tg(t)==="y"?{field:{group:"height"}}:{value:0};return Object.assign({test:n},i)}function h8(e,t=!0){return u8(Xt(e)?e:Ue(e,{expr:"datum"}),!t)}function Xmt(e){const{datum:t}=e;return g0(t)?xw(t):`${JSON.stringify(t)}`}function rg(e,t,n,r){const i={};if(t&&(i.scale=t),Jd(e)){const{datum:a}=e;g0(a)?i.signal=xw(a):Et(a)?i.signal=a.signal:i.value=a}else i.field=Ue(e,n);if(r){const{offset:a,band:o}=r;a&&(i.offset=a),o&&(i.band=o)}return i}function wO({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:r,startSuffix:i,band:a=.5}){const o=0<a&&a<1?"datum":void 0,s=Ue(t,{expr:o,suffix:i}),u=n!==void 0?Ue(n,{expr:o}):Ue(t,{suffix:"end",expr:o}),l={};if(a===0||a===1){l.scale=e;const c=a===0?s:u;l.field=c}else{const c=`${a} * ${s} + ${1-a} * ${u}`;l.signal=`scale("${e}", ${c})`}return r&&(l.offset=r),l}function kge({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:a,scale:o,stack:s,offset:u,defaultRef:l,band:c}){var f;if(t){if(It(t)){if(Go(t)){c=c??Sw({channel:e,fieldDef:t,fieldDef2:n,markDef:r,stack:s,config:i,isMidPoint:!0});const{bin:h,timeUnit:p,type:g}=t;if(Qn(h)||c&&p&&g===v0)return s&&s.impute?rg(t,a,{binSuffix:"mid"},{offset:u}):c?wO({scaleName:a,fieldOrDatumDef:t,band:c,offset:u}):rg(t,a,Ew(t,e)?{binSuffix:"range"}:{},{offset:u});if(Wa(h)){if(We(n))return wO({scaleName:a,fieldOrDatumDef:t,fieldOrDatumDef2:n,band:c,offset:u});Me(oge(e===br?vu:_l))}}const d=o==null?void 0:o.get("type");return rg(t,a,bo(d)?{binSuffix:"range"}:{},{offset:u,band:d==="band"?(f=c??t.band)!==null&&f!==void 0?f:.5:void 0})}else if(Gc(t)){const d=t.value,h=u?{offset:u}:{};return Object.assign(Object.assign({},ww(e,d)),h)}}return opt(l)&&(l=l()),l&&Object.assign(Object.assign({},l),u?{offset:u}:{})}function ww(e,t){return bt(["x","x2"],e)&&t==="width"?{field:{group:"width"}}:bt(["y","y2"],e)&&t==="height"?{field:{group:"height"}}:zr(t)}function ig(e){return e&&e!=="number"&&e!=="time"}function Tge(e,t,n){return`${e}(${t}${n?`, ${JSON.stringify(n)}`:""})`}const Ymt=" \u2013 ";function p8({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:a}){var o,s;if(ig(n))return g8({fieldOrDatumDef:e,format:t,formatType:n,expr:r,config:a});const u=Oge(e,r,i);if(OO(e)){const l=Jmt(u,We(e)?(o=Va(e.timeUnit))===null||o===void 0?void 0:o.unit:void 0,t,a.timeFormat,w8(e)&&((s=e.scale)===null||s===void 0?void 0:s.type)===ei.UTC);return l?{signal:l}:void 0}if(t=Dge(Zd(e),t,a),We(e)&&Qn(e.bin)){const l=Ue(e,{expr:r,binSuffix:"end"});return{signal:_O(u,l,t,n,a)}}else return t||Zd(e)==="quantitative"?{signal:`${Rge(u,t)}`}:{signal:`isValid(${u}) ? ${u} : ""+${u}`}}function Oge(e,t,n){return We(e)?n?`${Ue(e,{expr:t,suffix:"end"})}-${Ue(e,{expr:t,suffix:"start"})}`:Ue(e,{expr:t}):Xmt(e)}function g8({fieldOrDatumDef:e,format:t,formatType:n,expr:r,normalizeStack:i,config:a,field:o}){if(o=o??Oge(e,r,i),We(e)&&Qn(e.bin)){const s=Ue(e,{expr:r,binSuffix:"end"});return{signal:_O(o,s,t,n,a)}}return{signal:Tge(n,o,t)}}function Ige(e,t,n,r,i,a){var o;if(!ig(r)){if(OO(e)){const s=We(e)?(o=Va(e.timeUnit))===null||o===void 0?void 0:o.unit:void 0;return Zmt(n,s,i,a)}return Dge(t,n,i)}}function Nge(e,t,n){if(e&&(Et(e)||e==="number"||e==="time"))return e;if(OO(t)&&n!=="time"&&n!=="utc")return"time"}function Dge(e,t,n){if(Xt(t))return t;if(e===ng)return n.numberFormat}function Zmt(e,t,n,r){return e||(t?{signal:dge(t)}:r?void 0:n.timeFormat)}function Rge(e,t){return`format(${e}, "${t||""}")`}function Fge(e,t,n,r){var i;return ig(n)?Tge(n,e,t):Rge(e,(i=Xt(t)?t:void 0)!==null&&i!==void 0?i:r.numberFormat)}function _O(e,t,n,r,i){const a=Fge(e,n,r,i),o=Fge(t,n,r,i);return`${u8(e,!1)} ? "null" : ${a} + "${Ymt}" + ${o}`}function Jmt(e,t,n,r,i){return!t||n?(n=Xt(n)?n:r,`${i?"utc":"time"}Format(${e}, '${n}')`):pmt(t,e,i)}const SO="min",Qmt={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function Mge(e){return e in Qmt}function Pge(e){return!!e&&!!e.encoding}function Dl(e){return!!e&&(e.op==="count"||!!e.field)}function $ge(e){return!!e&&vt(e)}function _w(e){return"row"in e||"column"in e}function m8(e){return!!e&&"header"in e}function EO(e){return"facet"in e}function evt(e){return e.selection}function tvt(e){return e&&!Xt(e)&&"repeat"in e}function Lge(e){const{field:t,timeUnit:n,bin:r,aggregate:i}=e;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),r?{bin:r}:{}),i?{aggregate:i}:{}),{field:t})}function Bge(e){return Go(e)&&"sort"in e}function Sw({channel:e,fieldDef:t,fieldDef2:n,markDef:r,stack:i,config:a,isMidPoint:o}){if(It(t)&&t.band!==void 0)return t.band;if(We(t)){const{timeUnit:s,bin:u}=t;if(s&&!n)return o?sg("timeUnitBandPosition",r,a):Ope(r.type)?sg("timeUnitBand",r,a):0;if(Qn(u))return Ope(r.type)&&!o?1:.5}if((i==null?void 0:i.fieldChannel)===e&&o)return .5}function v8(e,t,n,r,i,a){return Qn(t.bin)||t.timeUnit&&Go(t)&&t.type==="temporal"?!!Sw({channel:e,fieldDef:t,fieldDef2:n,stack:r,markDef:i,config:a}):!1}function y8(e){return!!e&&"condition"in e}function CO(e){const t=e&&e.condition;return!!t&&!vt(t)&&We(t)}function b8(e){const t=e&&e.condition;return!!t&&!vt(t)&&It(t)}function nvt(e){const t=e&&e.condition;return!!t&&(vt(t)||Gc(t))}function We(e){return!!e&&(!!e.field||e.aggregate==="count")}function Zd(e){return e&&e.type}function Jd(e){return!!e&&"datum"in e}function Rl(e){return Go(e)&&Wge(e)||x8(e)}function x8(e){return Jd(e)&&Jr(e.datum)}function It(e){return We(e)||Jd(e)}function Go(e){return!!e&&("field"in e&&"type"in e||e.aggregate==="count")}function Gc(e){return e&&"value"in e&&"value"in e}function w8(e){return!!e&&("scale"in e||"sort"in e)}function _8(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function zge(e){return!!e&&"legend"in e}function jge(e){return!!e&&("format"in e||"formatType"in e)}function rvt(e){return"op"in e}function Ue(e,t={}){var n,r,i;let a=e.field;const o=t.prefix;let s=t.suffix,u="";if(ivt(e))a=vpt("count");else{let l;if(!t.nofn)if(rvt(e))l=e.op;else{const{bin:c,aggregate:f,timeUnit:d}=e;Qn(c)?(l=Vpe(c),s=((n=t.binSuffix)!==null&&n!==void 0?n:"")+((r=t.suffix)!==null&&r!==void 0?r:"")):f?Jp(f)?(u=`["${a}"]`,a=`argmax_${f.argmax}`):jd(f)?(u=`["${a}"]`,a=`argmin_${f.argmin}`):l=String(f):d&&(l=gmt(d),s=(!bt(["range","mid"],t.binSuffix)&&t.binSuffix||"")+((i=t.suffix)!==null&&i!==void 0?i:""))}l&&(a=a?`${l}_${a}`:l)}return s&&(a=`${a}_${s}`),o&&(a=`${o}_${a}`),t.forAs?wpe(a):t.expr?hpt(a,t.expr)+u:zd(a)+u}function Uge(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return We(e)&&!!e.bin;case"temporal":return!1}throw new Error(ege(e.type))}function Wge(e){return!Uge(e)}function ivt(e){return e.aggregate==="count"}function avt(e,t){var n;const{field:r,bin:i,timeUnit:a,aggregate:o}=e;if(o==="count")return t.countTitle;if(Qn(i))return`${r} (binned)`;if(a){const s=(n=Va(a))===null||n===void 0?void 0:n.unit;if(s)return`${r} (${r8(s).join("-")})`}else if(o)return Jp(o)?`${r} for max ${o.argmax}`:jd(o)?`${r} for min ${o.argmin}`:`${tO(o)} of ${r}`;return r}function ovt(e){const{aggregate:t,bin:n,timeUnit:r,field:i}=e;if(Jp(t))return`${i} for argmax(${t.argmax})`;if(jd(t))return`${i} for argmin(${t.argmin})`;const a=Va(r),o=t||(a==null?void 0:a.unit)||(a==null?void 0:a.maxbins)&&"timeunit"||Qn(n)&&"bin";return o?o.toUpperCase()+"("+i+")":i}const Vge=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return ovt(e);default:return avt(e,t)}};let qge=Vge;function Hge(e){qge=e}function svt(){Hge(Vge)}function ag(e,t,{allowDisabling:n,includeDefault:r=!0}){var i,a;const s=((i=S8(e))!==null&&i!==void 0?i:{}).title;if(!We(e))return s;const u=e,l=r?Gge(u,t):void 0;return n?Qr(s,u.title,l):(a=s??u.title)!==null&&a!==void 0?a:l}function S8(e){if(_8(e)&&e.axis)return e.axis;if(zge(e)&&e.legend)return e.legend;if(m8(e)&&e.header)return e.header}function Gge(e,t){return qge(e,t)}function AO(e){var t;if(jge(e)){const{format:n,formatType:r}=e;return{format:n,formatType:r}}else{const n=(t=S8(e))!==null&&t!==void 0?t:{},{format:r,formatType:i}=n;return{format:r,formatType:i}}}function uvt(e,t){if(e.timeUnit)return"temporal";if(Qn(e.bin))return"quantitative";switch(mO(t)){case"continuous":return"quantitative";case"discrete":return"nominal";case"flexible":return"nominal";default:return"quantitative"}}function Fl(e){if(We(e))return e;if(CO(e))return e.condition}function hi(e){if(It(e))return e;if(b8(e))return e.condition}function E8(e,t,n){if(Xt(e)||Jr(e)||lw(e)){const r=Xt(e)?"string":Jr(e)?"number":"boolean";return Me(xgt(t,r,e)),{value:e}}return It(e)?kO(e,t,n):b8(e)?Object.assign(Object.assign({},e),{condition:kO(e.condition,t,n)}):e}function kO(e,t,n){if(jge(e)){const{format:r,formatType:i}=e,a=dt(e,["format","formatType"]);if(ig(i)&&!n.customFormatTypes)return Me(Qpe(t)),kO(a,t,n)}else{const r=_8(e)?"axis":zge(e)?"legend":m8(e)?"header":null;if(r&&e[r]){const i=e[r],{format:a,formatType:o}=i,s=dt(i,["format","formatType"]);if(ig(o)&&!n.customFormatTypes)return Me(Qpe(t)),kO(Object.assign(Object.assign({},e),{[r]:s}),t,n)}}return We(e)?Kge(e,t):lvt(e)}function lvt(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=Jr(n)?"quantitative":Xt(n)?"nominal":g0(n)?"temporal":void 0,Object.assign(Object.assign({},e),{type:t})}function Kge(e,t){const{aggregate:n,timeUnit:r,bin:i,field:a}=e,o=Object.assign({},e);if(n&&!Hj(n)&&!Jp(n)&&!jd(n)&&(Me(_gt(n)),delete o.aggregate),r&&(o.timeUnit=Va(r)),a&&(o.field=`${a}`),Qn(i)&&(o.bin=TO(i,t)),Wa(i)&&!Il(t)&&Me(`Channel ${t} should not be used with "binned" bin.`),Go(o)){const{type:s}=o,u=Amt(s);s!==u&&(o.type=u),s!=="quantitative"&&Rpe(n)&&(Me(wgt(s,n)),o.type="quantitative")}else if(!zpe(t)){const s=uvt(o,t);Me(Sgt(t,s)),o.type=s}if(Go(o)){const{compatible:s,warning:u}=cvt(o,t);s||Me(u)}if(Bge(o)&&Xt(o.sort)){const{sort:s}=o;if(Mge(s))return Object.assign(Object.assign({},o),{sort:{encoding:s}});const u=s.substr(1);if(s.charAt(0)==="-"&&Mge(u))return Object.assign(Object.assign({},o),{sort:{encoding:u,order:"descending"}})}if(m8(o)){const{header:s}=o,{orient:u}=s,l=dt(s,["orient"]);if(u)return Object.assign(Object.assign({},o),{header:Object.assign(Object.assign({},l),{labelOrient:s.labelOrient||u,titleOrient:s.titleOrient||u})})}return o}function TO(e,t){return lw(e)?{maxbins:qpe(t)}:e==="binned"?{binned:!0}:!e.maxbins&&!e.step?Object.assign(Object.assign({},e),{maxbins:qpe(t)}):e}const og={compatible:!0};function cvt(e,t){const n=e.type;if(n==="geojson"&&t!=="shape")return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case jc:case Uc:case lO:return Wge(e)?{compatible:!1,warning:Agt(t)}:og;case br:case di:case vo:case Al:case kl:case mw:case yw:case cO:case eg:case fO:case dO:case Qp:case yu:case Sl:case hO:return og;case Cl:case ws:case El:case bu:return n!==ng?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:og;case Hc:case Ud:case Wd:case Vd:case qc:case Vc:case Wc:case vu:case _l:return n==="nominal"&&!e.sort?{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`}:og;case qd:return bt(["ordinal","nominal"],e.type)?og:{compatible:!1,warning:"StrokeDash channel should be used with only discrete data."};case yo:return bt(["ordinal","nominal","geojson"],e.type)?og:{compatible:!1,warning:"Shape channel should be used with only either discrete or geojson data."};case vw:return e.type==="nominal"&&!("sort"in e)?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:og}}function OO(e){const{formatType:t}=AO(e);return t==="time"||!t&&fvt(e)}function fvt(e){return e&&(e.type==="temporal"||We(e)&&!!e.timeUnit)}function C8(e,{timeUnit:t,type:n,wrapTime:r,undefinedIfExprNotRequired:i}){var a;const o=t&&((a=Va(t))===null||a===void 0?void 0:a.unit);let s=o||n==="temporal",u;return Et(e)?u=e.signal:g0(e)?(s=!0,u=xw(e)):(Xt(e)||Jr(e))&&s&&(u=`datetime(${JSON.stringify(e)})`,cmt(o)&&(Jr(e)&&e<1e4||Xt(e)&&isNaN(Date.parse(e)))&&(u=xw({[o]:e}))),u?r&&s?`time(${u})`:u:i?void 0:JSON.stringify(e)}function Xge(e,t){const{type:n}=e;return t.map(r=>{const i=C8(r,{timeUnit:We(e)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return i!==void 0?{signal:i}:r})}function Ew(e,t){return Qn(e.bin)?Kd(t)&&bt(["ordinal","nominal"],e.type):(console.warn("Only call this method for binned field defs."),!1)}function Yge(e){const{anchor:t,frame:n,offset:r,orient:i,color:a,subtitleColor:o,subtitleFont:s,subtitleFontSize:u,subtitleFontStyle:l,subtitleFontWeight:c,subtitleLineHeight:f,subtitlePadding:d}=e,h=dt(e,["anchor","frame","offset","orient","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),p=Object.assign(Object.assign({},h),a?{fill:a}:{}),g=Object.assign(Object.assign(Object.assign(Object.assign({},t?{anchor:t}:{}),n?{frame:n}:{}),r?{offset:r}:{}),i?{orient:i}:{}),m=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},o?{subtitleColor:o}:{}),s?{subtitleFont:s}:{}),u?{subtitleFontSize:u}:{}),l?{subtitleFontStyle:l}:{}),c?{subtitleFontWeight:c}:{}),f?{subtitleLineHeight:f}:{}),d?{subtitlePadding:d}:{}),v=dw(p,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:p,subtitleMarkConfig:v,nonMark:g,subtitle:m}}function Qd(e){return Xt(e)||vt(e)&&Xt(e[0])}function zr(e){return Et(e)?e:e!==void 0?{value:e}:void 0}function Zge(e){return Et(e)?e.signal:gn(e.value)}function Cw(e){return Et(e)?e.signal:e==null?null:gn(e)}function dvt(e,t,n){for(const r of n){const i=sg(r,t.markDef,t.config);i!==void 0&&(e[r]=zr(i))}return e}function Jge(e){var t;return[].concat(e.type,(t=e.style)!==null&&t!==void 0?t:[])}function Fn(e,t,n,r={}){const{vgChannel:i,ignoreVgConfig:a}=r;return i&&t[i]!==void 0?t[i]:t[e]!==void 0?t[e]:a&&(!i||i===e)?void 0:sg(e,t,n,r)}function sg(e,t,n,{vgChannel:r}={}){return Qr(r?IO(e,t,n.style):void 0,IO(e,t,n.style),r?n[t.type][r]:void 0,n[t.type][e],r?n.mark[r]:n.mark[e])}function IO(e,t,n){return Qge(e,Jge(t),n)}function Qge(e,t,n){t=Br(t);let r;for(const i of t){const a=n[i];a&&a[e]!==void 0&&(r=a[e])}return r}function eme(e,t){return Br(e).reduce((n,r)=>{var i;return n.field.push(Ue(r,t)),n.order.push((i=r.sort)!==null&&i!==void 0?i:"ascending"),n},{field:[],order:[]})}function tme(e,t){const n=[...e];return t.forEach(r=>{for(const i of n)if(fw(i,r))return;n.push(r)}),n}function nme(e,t){return fw(e,t)||!t?e:e?[...Br(e),...Br(t)].join(", "):t}function rme(e,t){const n=e.value,r=t.value;if(n==null||r===null)return{explicit:e.explicit,value:null};if((Qd(n)||Et(n))&&(Qd(r)||Et(r)))return{explicit:e.explicit,value:nme(n,r)};if(Qd(n)||Et(n))return{explicit:e.explicit,value:n};if(Qd(r)||Et(r))return{explicit:e.explicit,value:r};if(!Qd(n)&&!Et(n)&&!Qd(r)&&!Et(r))return{explicit:e.explicit,value:tme(n,r)};throw new Error("It should never reach here")}function ug(e,t){const n=e&&e[t];return n?vt(n)?hw(n,r=>!!r.field):We(n)||CO(n):!1}function A8(e){return hw(Lpe,t=>{if(ug(e,t)){const n=e[t];if(vt(n))return hw(n,r=>!!r.aggregate);{const r=Fl(n);return r&&!!r.aggregate}}return!1})}function k8(e,t){const n=[],r=[],i=[],a=[],o={};return T8(e,(s,u)=>{if(We(s)){const{field:l,aggregate:c,bin:f,timeUnit:d}=s,h=dt(s,["field","aggregate","bin","timeUnit"]);if(c||d||f){const p=S8(s),g=p&&p.title;let m=Ue(s,{forAs:!0});const v=Object.assign(Object.assign(Object.assign({},g?[]:{title:ag(s,t,{allowDisabling:!0})}),h),{field:m});if(c){let y;if(Jp(c)?(y="argmax",m=Ue({op:"argmax",field:c.argmax},{forAs:!0}),v.field=`${m}.${l}`):jd(c)?(y="argmin",m=Ue({op:"argmin",field:c.argmin},{forAs:!0}),v.field=`${m}.${l}`):c!=="boxplot"&&c!=="errorbar"&&c!=="errorband"&&(y=c),y){const b={op:y,as:m};l&&(b.field=l),a.push(b)}}else if(n.push(m),Go(s)&&Qn(f)){if(r.push({bin:f,field:l,as:m}),n.push(Ue(s,{binSuffix:"end"})),Ew(s,u)&&n.push(Ue(s,{binSuffix:"range"})),Il(u)){const y={field:m+"_end"};o[u+"2"]=y}v.bin="binned",zpe(u)||(v.type=ng)}else if(d){i.push({timeUnit:d,field:l,as:m});const y=Go(s)&&s.type!==v0&&"time";y&&(u===mw||u===eg?v.formatType=y:egt(u)?v.legend=Object.assign({formatType:y},v.legend):Il(u)&&(v.axis=Object.assign({formatType:y},v.axis)))}o[u]=v}else n.push(l),o[u]=e[u]}else o[u]=e[u]}),{bins:r,timeUnits:i,aggregate:a,groupby:n,encoding:o}}function hvt(e,t,n){const r=ngt(t,n);if(r){if(r==="binned"){const i=e[t===vu?br:di];return!!(We(i)&&We(e[t])&&Wa(i.bin))}}else return!1;return!0}function pvt(e,t,n){const r=t.type;return Be(e).reduce((i,a)=>{if(!Bpe(a))return Me(Cgt(a)),i;const o=e[a];if(a==="angle"&&r==="arc"&&!e.theta&&(Me(bgt),a=yu),!hvt(e,a,r))return Me(yO(a,r)),i;if(a===qc&&r==="line"){const s=Fl(e[a]);if(s==null?void 0:s.aggregate)return Me(Egt),i}if(a===vo&&(t.filled?"fill"in e:"stroke"in e))return Me(tge("encoding",{fill:"fill"in e,stroke:"stroke"in e})),i;if(a===yw||a===vw&&!vt(o)&&!Gc(o)||a===eg&&vt(o))o&&(i[a]=Br(o).reduce((s,u)=>(We(u)?s.push(Kge(u,a)):Me(Jj(u,a)),s),[]));else{if(a===eg&&o===null)i[a]=null;else if(!We(o)&&!Jd(o)&&!Gc(o)&&!y8(o)&&!Et(o))return Me(Jj(o,a)),i;i[a]=E8(o,a,n)}return i},{})}function gvt(e){const t=[];for(const n of Be(e))if(ug(e,n)){const r=e[n],i=Br(r);for(const a of i)We(a)?t.push(a):CO(a)&&t.push(a.condition)}return t}function T8(e,t,n){if(!!e)for(const r of Be(e)){const i=e[r];if(vt(i))for(const a of i)t.call(n,a,r);else t.call(n,i,r)}}function ime(e,t,n,r){return e?Be(e).reduce((i,a)=>{const o=e[a];return vt(o)?o.reduce((s,u)=>t.call(r,s,u,a),i):t.call(r,i,o,a)},n):n}function ame(e,t){return Be(t).reduce((n,r)=>{switch(r){case br:case di:case fO:case hO:case dO:case vu:case _l:case yu:case Vc:case Sl:case Wc:case El:case Cl:case bu:case ws:case mw:case yo:case Qp:case eg:return n;case vw:if(e==="line"||e==="trail")return n;case yw:case cO:{const i=t[r];if(vt(i)||We(i))for(const a of Br(i))a.aggregate||n.push(Ue(a,{}));return n}case qc:if(e==="trail")return n;case vo:case Al:case kl:case Hc:case Ud:case Wd:case qd:case Vd:{const i=Fl(t[r]);return i&&!i.aggregate&&n.push(Ue(i,{})),n}}},[])}function mvt(e){const{tooltip:t}=e,n=dt(e,["tooltip"]);if(!t)return{filteredEncoding:e};let r,i;if(vt(t)){for(const a of t)a.aggregate?(r||(r=[]),r.push(a)):(i||(i=[]),i.push(a));r&&(n.tooltip=r)}else t.aggregate?n.tooltip=t:i=t;return vt(i)&&i.length===1&&(i=i[0]),{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}function O8(e,t,n,r=!0){return"tooltip"in n?{tooltip:n.tooltip}:{tooltip:[...e.map(({fieldPrefix:a,titlePrefix:o})=>{const s=r?` of ${t.field}`:"";return{field:a+t.field,type:t.type,title:Et(o)?{signal:o+`"${escape(s)}"`}:o+s}}),...gvt(n)]}}function ome(e){const{axis:t,title:n,field:r}=e;return t&&t.title!==void 0?void 0:Qr(n,r)}function I8(e,t,n,r,i){const{scale:a,axis:o}=n;return({partName:s,mark:u,positionPrefix:l,endPositionPrefix:c=void 0,aria:f,extraEncoding:d={}})=>{const h=ome(n);return sme(e,s,i,f,{mark:u,encoding:Object.assign(Object.assign(Object.assign({[t]:Object.assign(Object.assign(Object.assign({field:l+"_"+n.field,type:n.type},h!==void 0?{title:h}:{}),a!==void 0?{scale:a}:{}),o!==void 0?{axis:o}:{})},Xt(c)?{[t+"2"]:{field:c+"_"+n.field}}:{}),r),d)})}}function sme(e,t,n,r,i){const{clip:a,color:o,opacity:s}=e,u=e.type;return e[t]||e[t]===void 0&&n[t]?[Object.assign(Object.assign({},i),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[t]),a?{clip:a}:{}),o?{color:o}:{}),s?{opacity:s}:{}),wl(i.mark)?i.mark:{type:i.mark}),{style:`${u}-${t}`}),lw(e[t])?{}:e[t]),r===!1?{aria:r}:{})})]:[]}function ume(e,t,n){const{encoding:r}=e,i=t==="vertical"?"y":"x",a=r[i],o=r[i+"2"],s=r[i+"Error"],u=r[i+"Error2"];return{continuousAxisChannelDef:NO(a,n),continuousAxisChannelDef2:NO(o,n),continuousAxisChannelDefError:NO(s,n),continuousAxisChannelDefError2:NO(u,n),continuousAxis:i}}function NO(e,t){if(e&&e.aggregate){const{aggregate:n}=e,r=dt(e,["aggregate"]);return n!==t&&Me(Zgt(n,t)),r}else return e}function lme(e,t){const{mark:n,encoding:r}=e,{x:i,y:a}=r;if(Rl(i)){if(Rl(a)){const o=We(i)&&i.aggregate,s=We(a)&&a.aggregate;if(!o&&s===t)return"vertical";if(!s&&o===t)return"horizontal";if(o===t&&s===t)throw new Error("Both x and y cannot have aggregate");return wl(n)&&n.orient?n.orient:"vertical"}return"horizontal"}else{if(Rl(a))return"vertical";throw new Error("Need a valid continuous axis for "+t+"s")}}const DO="boxplot",vvt=["box","median","outliers","rule","ticks"],yvt=new uO(DO,fme);function cme(e){return Jr(e)?"tukey":e}function fme(e,{config:t}){var n,r;const{mark:i,encoding:a,selection:o,projection:s}=e,u=dt(e,["mark","encoding","selection","projection"]),l=wl(i)?i:{type:i};o&&Me(Ype("boxplot"));const c=(n=l.extent)!==null&&n!==void 0?n:t.boxplot.extent,f=Fn("size",l,t),d=cme(c),{transform:h,continuousAxisChannelDef:p,continuousAxis:g,groupby:m,aggregate:v,encodingWithoutContinuousAxis:y,ticksOrient:b,boxOrient:x,customTooltipWithoutAggregatedField:w}=bvt(e,c,t),{color:S,size:C}=y,_=dt(y,["color","size"]),E=G=>I8(l,g,p,G,t.boxplot),A=E(_),k=E(y),T=E(Object.assign(Object.assign({},_),C?{size:C}:{})),I=O8([{fieldPrefix:d==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:d==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],p,y),N={type:"tick",color:"black",opacity:1,orient:b,invalid:null},O=d==="min-max"?I:O8([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],p,y),D=[...A({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",aria:!1,extraEncoding:O}),...A({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",aria:!1,extraEncoding:O}),...A({partName:"ticks",mark:N,positionPrefix:"lower_whisker",aria:!1,extraEncoding:O}),...A({partName:"ticks",mark:N,positionPrefix:"upper_whisker",aria:!1,extraEncoding:O})],L=[...d!=="tukey"?D:[],...k({partName:"box",mark:Object.assign(Object.assign({type:"bar"},f?{size:f}:{}),{orient:x,invalid:null}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",aria:!1,extraEncoding:I}),...T({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},Ai(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{}),f?{size:f}:{}),{orient:b,ariaRoleDescription:"box"}),positionPrefix:"mid_box",extraEncoding:I})];let W;if(d!=="min-max"){const G=`datum["lower_box_${p.field}"]`,K=`datum["upper_box_${p.field}"]`,ee=`(${K} - ${G})`,ce=`${G} - ${c} * ${ee}`,he=`${K} + ${c} * ${ee}`,Oe=`datum["${p.field}"]`,Te={joinaggregate:dme(p.field),groupby:m};let De;d==="tukey"&&(De={transform:[{filter:`(${ce} <= ${Oe}) && (${Oe} <= ${he})`},{aggregate:[{op:"min",field:p.field,as:"lower_whisker_"+p.field},{op:"max",field:p.field,as:"upper_whisker_"+p.field},{op:"min",field:"lower_box_"+p.field,as:"lower_box_"+p.field},{op:"max",field:"upper_box_"+p.field,as:"upper_box_"+p.field},...v],groupby:m}],layer:D});const me=dt(_,["tooltip"]),{scale:P,axis:F}=p,V=ome(p),ae=sme(l,"outliers",t.boxplot,!0,{transform:[{filter:`(${Oe} < ${ce}) || (${Oe} > ${he})`}],mark:"point",encoding:Object.assign(Object.assign({[g]:Object.assign(Object.assign(Object.assign({field:p.field,type:p.type},V!==void 0?{title:V}:{}),P!==void 0?{scale:P}:{}),F!==void 0?{axis:F}:{})},me),w?{tooltip:w}:{})})[0];ae&&De?W={transform:[Te],layer:[ae,De]}:ae?(W=ae,W.transform.unshift(Te)):De&&(W=De,W.transform.unshift(Te))}return W?Object.assign(Object.assign({},u),{layer:[W,{transform:h,layer:L}]}):Object.assign(Object.assign({},u),{transform:((r=u.transform)!==null&&r!==void 0?r:[]).concat(h),layer:L})}function dme(e){return[{op:"q1",field:e,as:"lower_box_"+e},{op:"q3",field:e,as:"upper_box_"+e}]}function bvt(e,t,n){const r=lme(e,DO),{continuousAxisChannelDef:i,continuousAxis:a}=ume(e,r,DO),o=i.field,s=cme(t),u=[...dme(o),{op:"median",field:o,as:"mid_box_"+o},{op:"min",field:o,as:(s==="min-max"?"lower_whisker_":"min_")+o},{op:"max",field:o,as:(s==="min-max"?"upper_whisker_":"max_")+o}],l=s==="min-max"||s==="tukey"?[]:[{calculate:`datum["upper_box_${o}"] - datum["lower_box_${o}"]`,as:"iqr_"+o},{calculate:`min(datum["upper_box_${o}"] + datum["iqr_${o}"] * ${t}, datum["max_${o}"])`,as:"upper_whisker_"+o},{calculate:`max(datum["lower_box_${o}"] - datum["iqr_${o}"] * ${t}, datum["min_${o}"])`,as:"lower_whisker_"+o}],c=e.encoding,f=a;c[f];const d=dt(c,[typeof f=="symbol"?f:f+""]),{customTooltipWithoutAggregatedField:h,filteredEncoding:p}=mvt(d),{bins:g,timeUnits:m,aggregate:v,groupby:y,encoding:b}=k8(p,n),x=r==="vertical"?"horizontal":"vertical",w=r;return{transform:[...g,...m,{aggregate:[...v,...u],groupby:y},...l],groupby:y,aggregate:v,continuousAxisChannelDef:i,continuousAxis:a,encodingWithoutContinuousAxis:b,ticksOrient:x,boxOrient:w,customTooltipWithoutAggregatedField:h}}const N8="errorbar",xvt=["ticks","rule"],wvt=new uO(N8,hme);function hme(e,{config:t}){const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:a,ticksOrient:o,markDef:s,outerSpec:u,tooltipEncoding:l}=pme(e,N8,t),c=I8(s,i,r,a,t.errorbar),f={type:"tick",orient:o},d=[...c({partName:"ticks",mark:f,positionPrefix:"lower",aria:!1,extraEncoding:l}),...c({partName:"ticks",mark:f,positionPrefix:"upper",aria:!1,extraEncoding:l}),...c({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar"},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l})];return Object.assign(Object.assign(Object.assign({},u),{transform:n}),d.length>1?{layer:d}:Object.assign({},d[0]))}function _vt(e,t){const{encoding:n}=e;if(Svt(n))return{orient:lme(e,t),inputType:"raw"};const r=Evt(n),i=Cvt(n),a=n.x,o=n.y;if(r){if(i)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const s=n.x2,u=n.y2;if(It(s)&&It(u))throw new Error(`${t} cannot have both x2 and y2`);if(It(s)){if(Rl(a))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}else if(It(u)){if(Rl(o))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}else{const s=n.xError,u=n.xError2,l=n.yError,c=n.yError2;if(It(u)&&!It(s))throw new Error(`${t} cannot have xError2 without xError`);if(It(c)&&!It(l))throw new Error(`${t} cannot have yError2 without yError`);if(It(s)&&It(l))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(It(s)){if(Rl(a))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}else if(It(l)){if(Rl(o))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function Svt(e){return(It(e.x)||It(e.y))&&!It(e.x2)&&!It(e.y2)&&!It(e.xError)&&!It(e.xError2)&&!It(e.yError)&&!It(e.yError2)}function Evt(e){return It(e.x2)||It(e.y2)}function Cvt(e){return It(e.xError)||It(e.xError2)||It(e.yError)||It(e.yError2)}function pme(e,t,n){var r;const{mark:i,encoding:a,selection:o,projection:s}=e,u=dt(e,["mark","encoding","selection","projection"]),l=wl(i)?i:{type:i};o&&Me(Ype(t));const{orient:c,inputType:f}=_vt(e,t),{continuousAxisChannelDef:d,continuousAxisChannelDef2:h,continuousAxisChannelDefError:p,continuousAxisChannelDefError2:g,continuousAxis:m}=ume(e,c,t),{errorBarSpecificAggregate:v,postAggregateCalculates:y,tooltipSummary:b,tooltipTitleWithFieldName:x}=Avt(l,d,h,p,g,f,t,n),w=a,S=m;w[S];const C=m==="x"?"x2":"y2";w[C];const _=m==="x"?"xError":"yError";w[_];const E=m==="x"?"xError2":"yError2";w[E];const A=dt(w,[typeof S=="symbol"?S:S+"",typeof C=="symbol"?C:C+"",typeof _=="symbol"?_:_+"",typeof E=="symbol"?E:E+""]),{bins:k,timeUnits:T,aggregate:I,groupby:N,encoding:O}=k8(A,n),D=[...I,...v],L=f!=="raw"?[]:N,W=O8(b,d,O,x);return{transform:[...(r=u.transform)!==null&&r!==void 0?r:[],...k,...T,...D.length===0?[]:[{aggregate:D,groupby:L}],...y],groupby:L,continuousAxisChannelDef:d,continuousAxis:m,encodingWithoutContinuousAxis:O,ticksOrient:c==="vertical"?"horizontal":"vertical",markDef:l,outerSpec:u,tooltipEncoding:W}}function Avt(e,t,n,r,i,a,o,s){let u=[],l=[];const c=t.field;let f,d=!1;if(a==="raw"){const h=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":s.errorbar.center,p=e.extent?e.extent:h==="mean"?"stderr":"iqr";if(h==="median"!=(p==="iqr")&&Me(Ygt(h,p,o)),p==="stderr"||p==="stdev")u=[{op:p,field:c,as:"extent_"+c},{op:h,field:c,as:"center_"+c}],l=[{calculate:`datum["center_${c}"] + datum["extent_${c}"]`,as:"upper_"+c},{calculate:`datum["center_${c}"] - datum["extent_${c}"]`,as:"lower_"+c}],f=[{fieldPrefix:"center_",titlePrefix:tO(h)},{fieldPrefix:"upper_",titlePrefix:gme(h,p,"+")},{fieldPrefix:"lower_",titlePrefix:gme(h,p,"-")}],d=!0;else{e.center&&e.extent&&Me(Jgt(e.extent,o));let g,m,v;p==="ci"?(g="mean",m="ci0",v="ci1"):(g="median",m="q1",v="q3"),u=[{op:m,field:c,as:"lower_"+c},{op:v,field:c,as:"upper_"+c},{op:g,field:c,as:"center_"+c}],f=[{fieldPrefix:"upper_",titlePrefix:ag({field:c,aggregate:v,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:ag({field:c,aggregate:m,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:ag({field:c,aggregate:g,type:"quantitative"},s,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&Me(Xgt(e.center,e.extent)),a==="aggregated-upper-lower"?(f=[],l=[{calculate:`datum["${n.field}"]`,as:"upper_"+c},{calculate:`datum["${c}"]`,as:"lower_"+c}]):a==="aggregated-error"&&(f=[{fieldPrefix:"",titlePrefix:c}],l=[{calculate:`datum["${c}"] + datum["${r.field}"]`,as:"upper_"+c}],i?l.push({calculate:`datum["${c}"] + datum["${i.field}"]`,as:"lower_"+c}):l.push({calculate:`datum["${c}"] - datum["${r.field}"]`,as:"lower_"+c}));for(const h of l)f.push({fieldPrefix:h.as.substring(0,6),titlePrefix:d0(d0(h.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:l,errorBarSpecificAggregate:u,tooltipSummary:f,tooltipTitleWithFieldName:d}}function gme(e,t,n){return tO(e)+" "+n+" "+t}const D8="errorband",kvt=["band","borders"],Tvt=new uO(D8,mme);function mme(e,{config:t}){const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:a,markDef:o,outerSpec:s,tooltipEncoding:u}=pme(e,D8,t),l=o,c=I8(l,i,r,a,t.errorband),f=e.encoding.x!==void 0&&e.encoding.y!==void 0;let d={type:f?"area":"rect"},h={type:f?"line":"rule"};const p=Object.assign(Object.assign({},l.interpolate?{interpolate:l.interpolate}:{}),l.tension&&l.interpolate?{tension:l.tension}:{});return f?(d=Object.assign(Object.assign(Object.assign({},d),p),{ariaRoleDescription:"errorband"}),h=Object.assign(Object.assign({},h),p)):l.interpolate?Me(age("interpolate")):l.tension&&Me(age("tension")),Object.assign(Object.assign({},s),{transform:n,layer:[...c({partName:"band",mark:d,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"lower",aria:!1,extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"upper",aria:!1,extraEncoding:u})]})}const vme={};function R8(e,t,n){const r=new uO(e,t);vme[e]={normalizer:r,parts:n}}function Ovt(){return Be(vme)}R8(DO,fme,vvt),R8(N8,hme,xvt),R8(D8,mme,kvt);const Ivt=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],yme=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],Nvt={fillColor:{part:"legend",vgProp:"fill"},gradientStrokeColor:{part:"gradient",vgProp:"stroke"},labelColor:{part:"labels",vgProp:"fill"},strokeColor:{part:"legend",vgProp:"stroke"},symbolFillColor:{part:"symbols",vgProp:"fill"},symbolStrokeColor:{part:"symbols",vgProp:"stroke"},titleColor:{part:"title",vgProp:"fill"}},Dvt={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},Rvt={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},b0="_vgsid_",Fvt={single:{on:"click",fields:[b0],resolve:"global",empty:"all",clear:"dblclick"},multi:{on:"click",fields:[b0],toggle:"event.shiftKey",resolve:"global",empty:"all",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function F8(e){return!!e&&(e==="legend"||!!e.legend)}function M8(e){return F8(e)&&Ai(e)}function Mvt(e){return RO(e)||$8(e)||P8(e)}function P8(e){return"concat"in e}function RO(e){return"vconcat"in e}function $8(e){return"hconcat"in e}function Ml(e){return Ai(e)&&e.step!==void 0}function bme(e){return e.view||e.width||e.height}const xme=20,Pvt={align:1,bounds:1,center:1,columns:1,spacing:1},$vt=Be(Pvt);function Lvt(e,t,n){var r,i;const a=n[t],o={},{spacing:s,columns:u}=a;s!==void 0&&(o.spacing=s),u!==void 0&&(EO(e)&&!_w(e.facet)||P8(e))&&(o.columns=u),RO(e)&&(o.columns=1);for(const l of $vt)if(e[l]!==void 0)if(l==="spacing"){const c=e[l];o[l]=Jr(c)?c:{row:(r=c.row)!==null&&r!==void 0?r:s,column:(i=c.column)!==null&&i!==void 0?i:s}}else o[l]=e[l];return o}function L8(e,t){var n;return(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"continuousWidth":"continuousHeight"]}function FO(e,t){const n=Aw(e,t);return Ml(n)?n.step:B8}function Aw(e,t){var n;const r=(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"discreteWidth":"discreteHeight"];return Qr(r,{step:e.step})}const B8=20,Bvt={continuousWidth:200,continuousHeight:200,step:B8},zvt={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:Bvt,mark:Opt,arc:{},area:{},bar:Npt,circle:{},geoshape:{},image:{},line:{},point:{},rect:Dpt,rule:{color:"black"},square:{},text:{color:"black"},tick:Rpt,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:zmt,projection:{},legend:Dvt,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:Fvt,style:{},title:{},facet:{spacing:xme},concat:{spacing:xme}},Kc=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],wme={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},_me={blue:Kc[0],orange:Kc[1],red:Kc[2],teal:Kc[3],green:Kc[4],yellow:Kc[5],purple:Kc[6],pink:Kc[7],brown:Kc[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function jvt(e={}){return{signals:[{name:"color",value:Ai(e)?Object.assign(Object.assign({},_me),e):_me}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function Uvt(e){return{signals:[{name:"fontSize",value:Ai(e)?Object.assign(Object.assign({},wme),e):wme}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function Wvt(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function Sme(e={}){const{color:t,font:n,fontSize:r}=e,i=dt(e,["color","font","fontSize"]);return dpe({},zvt,n?Wvt(n):{},t?jvt(t):{},r?Uvt(r):{},i||{})}const Vvt=["view",...Ipe],qvt=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],Hvt=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},Tpt);function Gvt(e){e=Yt(e);for(const t of qvt)delete e[t];if(e.axis)for(const t in e.axis)Uj(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of Ivt)delete e.legend[t];if(e.mark){for(const t of Npe)delete e.mark[t];e.mark.tooltip&&Ai(e.mark.tooltip)&&delete e.mark.tooltip}for(const t of Vvt){for(const r of Npe)delete e[t][r];const n=Hvt[t];if(n)for(const r of n)delete e[t][r];Xvt(e,t)}for(const t of Ovt())delete e[t];Kvt(e);for(const t in e)Ai(e[t])&&Yn(e[t])&&delete e[t];return Yn(e)?void 0:e}function Kvt(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:r}=Yge(e.title);Yn(t)||(e.style["group-title"]=Object.assign(Object.assign({},e.style["group-title"]),t)),Yn(n)||(e.style["group-subtitle"]=Object.assign(Object.assign({},e.style["group-subtitle"]),n)),Yn(r)?delete e.title:e.title=r}function Xvt(e,t,n,r){const i=r?e[t][r]:e[t];t==="view"&&(n="cell");const a=Object.assign(Object.assign({},i),e.style[n??t]);Yn(a)||(e.style[n??t]=a),r||delete e[t]}function MO(e){return"layer"in e}function Yvt(e){return"repeat"in e}function Zvt(e){return!vt(e.repeat)&&e.repeat.layer}class Eme{map(t,n){return EO(t)?this.mapFacet(t,n):Yvt(t)?this.mapRepeat(t,n):$8(t)?this.mapHConcat(t,n):RO(t)?this.mapVConcat(t,n):P8(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(MO(t))return this.mapLayer(t,n);if(zc(t))return this.mapUnit(t,n);throw new Error(Zj(t))}mapLayer(t,n){return Object.assign(Object.assign({},t),{layer:t.layer.map(r=>this.mapLayerOrUnit(r,n))})}mapHConcat(t,n){return Object.assign(Object.assign({},t),{hconcat:t.hconcat.map(r=>this.map(r,n))})}mapVConcat(t,n){return Object.assign(Object.assign({},t),{vconcat:t.vconcat.map(r=>this.map(r,n))})}mapConcat(t,n){const{concat:r}=t,i=dt(t,["concat"]);return Object.assign(Object.assign({},i),{concat:r.map(a=>this.map(a,n))})}mapFacet(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}mapRepeat(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}}const Jvt={zero:1,center:1,normalize:1};function Qvt(e){return e in Jvt}const e0t=new Set([Ape,iO,rO,sO,oO,Vj,qj,aO,kpe,Wj]),t0t=new Set([iO,rO,Ape]);function Cme(e,t){var n,r;const i=t==="x"?"y":"radius",a=e[t],o=e[i];if(We(a)&&We(o))if(Zd(a)==="quantitative"&&Zd(o)==="quantitative"){if(a.stack)return t;if(o.stack)return i;const s=We(a)&&!!a.aggregate,u=We(o)&&!!o.aggregate;if(s!==u)return s?t:i;{const l=(n=a.scale)===null||n===void 0?void 0:n.type,c=(r=o.scale)===null||r===void 0?void 0:r.type;if(l&&l!=="linear")return i;if(c&&c!=="linear")return t}}else{if(Zd(a)==="quantitative")return t;if(Zd(o)==="quantitative")return i}else{if(Zd(a)==="quantitative")return t;if(Zd(o)==="quantitative")return i}}function n0t(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function Ame(e,t,n={}){const r=wl(e)?e.type:e;if(!e0t.has(r))return null;const i=Cme(t,"x")||Cme(t,"theta");if(!i)return null;const a=t[i],o=We(a)?Ue(a,{}):void 0;let s=n0t(i),u=t[s],l=We(u)?Ue(u,{}):void 0;l===o&&(l=void 0,u=void 0,s=void 0);const c=Zpt.reduce((d,h)=>{if(h!=="tooltip"&&ug(t,h)){const p=t[h];for(const g of Br(p)){const m=Fl(g);if(m.aggregate)continue;const v=Ue(m,{});(!v||v!==l)&&d.push({channel:h,fieldDef:m})}}return d},[]);let f;if(a.stack!==void 0?lw(a.stack)?f=a.stack?"zero":null:f=a.stack:c.length>0&&t0t.has(r)&&(f="zero"),!f||!Qvt(f)||A8(t)&&c.length===0)return null;if(a.scale&&a.scale.type&&a.scale.type!==ei.LINEAR){if(n.disallowNonLinearStack)return null;Me(Hgt(a.scale.type))}return It(t[Tl(i)])?(a.stack!==void 0&&Me(qgt(i)),null):(We(a)&&a.aggregate&&!bt(Bpt,a.aggregate)&&Me(Ggt(a.aggregate)),{groupbyChannel:u?s:void 0,groupbyField:l,fieldChannel:i,impute:a.impute===null?!1:Zp(r),stackBy:c,offset:f})}function r0t(e){const t=dt(e,["point","line"]);return Be(t).length>1?t:t.type}function i0t(e){for(const t of["line","area","rule","trail"])e[t]&&(e=Object.assign(Object.assign({},e),{[t]:Bc(e[t],["point","line"])}));return e}function z8(e,t={},n){return e.point==="transparent"?{opacity:0}:e.point?Ai(e.point)?e.point:{}:e.point!==void 0?null:t.point||n.shape?Ai(t.point)?t.point:{}:void 0}function kme(e,t={}){return e.line?e.line===!0?{}:e.line:e.line!==void 0?null:t.line?t.line===!0?{}:t.line:void 0}class a0t{constructor(){this.name="path-overlay"}hasMatchingType(t,n){if(zc(t)){const{mark:r,encoding:i}=t,a=wl(r)?r:{type:r};switch(a.type){case"line":case"rule":case"trail":return!!z8(a,n[a.type],i);case"area":return!!z8(a,n[a.type],i)||!!kme(a,n[a.type])}}return!1}run(t,n,r){const{config:i}=n,{selection:a,projection:o,encoding:s,mark:u}=t,l=dt(t,["selection","projection","encoding","mark"]),c=wl(u)?u:{type:u},f=z8(c,i[c.type],s),d=c.type==="area"&&kme(c,i[c.type]),h=[Object.assign(Object.assign({},a?{selection:a}:{}),{mark:r0t(Object.assign(Object.assign({},c.type==="area"&&c.opacity===void 0&&c.fillOpacity===void 0?{opacity:.7}:{}),c)),encoding:Bc(s,["shape"])})],p=Ame(c,s);let g=s;if(p){const{fieldChannel:m,offset:v}=p;g=Object.assign(Object.assign({},s),{[m]:Object.assign(Object.assign({},s[m]),v?{stack:v}:{})})}return d&&h.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"line"},dw(c,["clip","interpolate","tension","tooltip"])),d),encoding:g})),f&&h.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},dw(c,["clip","tooltip"])),f),encoding:g})),r(Object.assign(Object.assign({},l),{layer:h}),Object.assign(Object.assign({},n),{config:i0t(i)}))}}class o0t{constructor(){this.name="RangeStep"}hasMatchingType(t){var n;if(zc(t)&&t.encoding)for(const r of Ss){const i=t.encoding[r];if(i&&It(i)&&((n=i==null?void 0:i.scale)===null||n===void 0?void 0:n.rangeStep))return!0}return!1}run(t){var n;const r={};let i=Object.assign({},t.encoding);for(const a of Ss){const o=Ol(a),s=i[a];if(s&&It(s)&&((n=s==null?void 0:s.scale)===null||n===void 0?void 0:n.rangeStep)){const{scale:u}=s,l=dt(s,["scale"]),c=u,f=dt(c,["rangeStep"]);r[o]={step:u.rangeStep},Me(Igt),i=Object.assign(Object.assign({},i),{[a]:Object.assign(Object.assign({},l),Yn(f)?{}:{scale:f})})}}return Object.assign(Object.assign(Object.assign({},r),t),{encoding:i})}}function s0t(e,t){return t?_w(e)?Nme(e,t):Tme(e,t):e}function j8(e,t){return t?Nme(e,t):e}function U8(e,t,n){const r=t[e];if(tvt(r)){if(r.repeat in n)return Object.assign(Object.assign({},t),{[e]:n[r.repeat]});Me(dgt(r.repeat));return}return t}function Tme(e,t){if(e=U8("field",e,t),e!==void 0){if(e===null)return null;if(Bge(e)&&Dl(e.sort)){const n=U8("field",e.sort,t);e=Object.assign(Object.assign({},e),n?{sort:n}:{})}return e}}function Ome(e,t){if(We(e))return Tme(e,t);{const n=U8("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function Ime(e,t){if(It(e)){const n=Ome(e,t);if(n)return n;if(y8(e))return{condition:e.condition}}else{if(b8(e)){const n=Ome(e.condition,t);return n?Object.assign(Object.assign({},e),{condition:n}):dt(e,["condition"])}return e}}function Nme(e,t){const n={};for(const r in e)if(Xp(e,r)){const i=e[r];if(vt(i))n[r]=i.map(a=>Ime(a,t)).filter(a=>a);else{const a=Ime(i,t);a!==void 0&&(n[r]=a)}}return n}class u0t{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(zc(t)){const{encoding:n,mark:r}=t;if(r==="line")for(const i of Xpt){const a=tg(i),o=n[a];if(n[i]&&(We(o)&&!Wa(o.bin)||Jd(o)))return!0}}return!1}run(t,n,r){const{encoding:i}=t;return Me(Tgt(!!i.x2,!!i.y2)),r(Object.assign(Object.assign({},t),{mark:"rule"}),n)}}class l0t extends Eme{constructor(){super(...arguments);this.nonFacetUnitNormalizers=[yvt,wvt,Tvt,new a0t,new u0t,new o0t]}map(t,n){if(zc(t)){const r=ug(t.encoding,jc),i=ug(t.encoding,Uc),a=ug(t.encoding,lO);if(r||i||a)return this.mapFacetedUnit(t,n)}return super.map(t,n)}mapUnit(t,n){const{parentEncoding:r,parentProjection:i}=n,a=Object.assign(Object.assign({},t),{encoding:j8(t.encoding,n.repeater)});if(r||i)return this.mapUnitWithParentEncodingOrProjection(a,n);const o=this.mapLayerOrUnit.bind(this);for(const s of this.nonFacetUnitNormalizers)if(s.hasMatchingType(a,n.config))return s.run(a,n,o);return a}mapRepeat(t,n){return Zvt(t)?this.mapLayerRepeat(t,n):this.mapNonLayerRepeat(t,n)}mapLayerRepeat(t,n){const{repeat:r,spec:i}=t,a=dt(t,["repeat","spec"]),{row:o,column:s,layer:u}=r,{repeater:l={},repeaterPrefix:c=""}=n;return o||s?this.mapRepeat(Object.assign(Object.assign({},t),{repeat:Object.assign(Object.assign({},o?{row:o}:{}),s?{column:s}:{}),spec:{repeat:{layer:u},spec:i}}),n):Object.assign(Object.assign({},a),{layer:u.map(f=>{const d=Object.assign(Object.assign({},l),{layer:f}),h=(i.name||"")+c+`child__layer_${fr(f)}`,p=this.mapLayerOrUnit(i,Object.assign(Object.assign({},n),{repeater:d,repeaterPrefix:h}));return p.name=h,p})})}mapNonLayerRepeat(t,n){var r;const{repeat:i,spec:a,data:o}=t,s=dt(t,["repeat","spec","data"]);!vt(i)&&t.columns&&(t=Bc(t,["columns"]),Me(Zpe("repeat")));const u=[],{repeater:l={},repeaterPrefix:c=""}=n,f=!vt(i)&&i.row||[l?l.row:null],d=!vt(i)&&i.column||[l?l.column:null],h=vt(i)&&i||[l?l.repeat:null];for(const g of h)for(const m of f)for(const v of d){const y={repeat:g,row:m,column:v,layer:l.layer},b=(a.name||"")+c+"child__"+(vt(i)?`${fr(g)}`:(i.row?`row_${fr(m)}`:"")+(i.column?`column_${fr(v)}`:"")),x=this.map(a,Object.assign(Object.assign({},n),{repeater:y,repeaterPrefix:b}));x.name=b,u.push(Bc(x,["data"]))}const p=vt(i)?t.columns:i.column?i.column.length:1;return Object.assign(Object.assign({data:(r=a.data)!==null&&r!==void 0?r:o,align:"all"},s),{columns:p,concat:u})}mapFacet(t,n){const{facet:r}=t;return _w(r)&&t.columns&&(t=Bc(t,["columns"]),Me(Zpe("facet"))),super.mapFacet(t,n)}mapUnitWithParentEncodingOrProjection(t,n){const{encoding:r,projection:i}=t,{parentEncoding:a,parentProjection:o,config:s}=n,u=Rme({parentProjection:o,projection:i}),l=Dme({parentEncoding:a,encoding:j8(r,n.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},t),u?{projection:u}:{}),l?{encoding:l}:{}),{config:s})}mapFacetedUnit(t,n){const r=t.encoding,{row:i,column:a,facet:o}=r,s=dt(r,["row","column","facet"]),{mark:u,width:l,projection:c,height:f,view:d,selection:h,encoding:p}=t,g=dt(t,["mark","width","projection","height","view","selection","encoding"]),{facetMapping:m,layout:v}=this.getFacetMappingAndLayout({row:i,column:a,facet:o},n),y=j8(s,n.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},g),v),{facet:m,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},l?{width:l}:{}),f?{height:f}:{}),d?{view:d}:{}),c?{projection:c}:{}),{mark:u,encoding:y}),h?{selection:h}:{})}),n)}getFacetMappingAndLayout(t,n){var r;const{row:i,column:a,facet:o}=t;if(i||a){o&&Me(kgt([...i?[jc]:[],...a?[Uc]:[]]));const s={},u={};for(const l of[jc,Uc]){const c=t[l];if(c){const f=dt(c,["align","center","spacing","columns"]);s[l]=f;for(const d of["align","center","spacing"])c[d]!==void 0&&(u[d]=(r=u[d])!==null&&r!==void 0?r:{},u[d][l]=c[d])}}return{facetMapping:s,layout:u}}else{const{align:s,center:u,spacing:l,columns:c}=o,f=dt(o,["align","center","spacing","columns"]);return{facetMapping:s0t(f,n.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},s?{align:s}:{}),u?{center:u}:{}),l?{spacing:l}:{}),c?{columns:c}:{})}}}mapLayer(t,n){var{parentEncoding:r,parentProjection:i}=n,a=dt(n,["parentEncoding","parentProjection"]);const{encoding:o,projection:s}=t,u=dt(t,["encoding","projection"]),l=Object.assign(Object.assign({},a),{parentEncoding:Dme({parentEncoding:r,encoding:o}),parentProjection:Rme({parentProjection:i,projection:s})});return super.mapLayer(u,l)}}function Dme(e){const{parentEncoding:t,encoding:n}=e;if(t&&n){const i=Be(t).reduce((a,o)=>(n[o]&&a.push(o),a),[]);i.length>0&&Me(vgt(i))}const r=Object.assign(Object.assign({},t??{}),n??{});return Yn(r)?void 0:r}function Rme(e){const{parentProjection:t,projection:n}=e;return t&&n&&Me(ygt({parentProjection:t,projection:n})),n??t}function Fme(e,t){t===void 0&&(t=Sme(e.config));const n=f0t(e,t),{width:r,height:i}=e,a=d0t(n,{width:r,height:i,autosize:e.autosize},t);return Object.assign(Object.assign({},n),a?{autosize:a}:{})}const c0t=new l0t;function f0t(e,t={}){return c0t.map(e,{config:t})}function Mme(e){return Xt(e)?{type:e}:e??{}}function d0t(e,t,n){let{width:r,height:i}=t;const a=zc(e)||MO(e),o={};a?r=="container"&&i=="container"?(o.type="fit",o.contains="padding"):r=="container"?(o.type="fit-x",o.contains="padding"):i=="container"&&(o.type="fit-y",o.contains="padding"):(r=="container"&&(Me(Hpe("width")),r=void 0),i=="container"&&(Me(Hpe("height")),i=void 0));const s=Object.assign(Object.assign(Object.assign({type:"pad"},o),n?Mme(n.autosize):{}),Mme(e.autosize));if(s.type==="fit"&&!a&&(Me(agt),s.type="pad"),r=="container"&&!(s.type=="fit"||s.type=="fit-x")&&Me(Gpe("width")),i=="container"&&!(s.type=="fit"||s.type=="fit-y")&&Me(Gpe("height")),!fw(s,{type:"pad"}))return s}function h0t(e){return e==="fit"||e==="fit-x"||e==="fit-y"}function p0t(e){return e?`fit-${pO(e)}`:"fit"}const g0t=["background","padding"];function Pme(e){return g0t.reduce((t,n)=>(e&&e[n]!==void 0&&(t[n]=e[n]),t),{})}class Xc{constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new Xc(Yt(this.explicit),Yt(this.implicit))}combine(){return Object.assign(Object.assign({},this.explicit),this.implicit)}get(t){return Qr(this.explicit[t],this.implicit[t])}getWithExplicit(t){return this.explicit[t]!==void 0?{explicit:!0,value:this.explicit[t]}:this.implicit[t]!==void 0?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,n){n.value!==void 0&&this.set(t,n.value,n.explicit)}set(t,n,r){return delete this[r?"implicit":"explicit"][t],this[r?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,n){n.explicit[t]!==void 0?this.set(t,n.explicit[t],!0):n.implicit[t]!==void 0&&this.set(t,n.implicit[t],!1)}copyKeyFromObject(t,n){n[t]!==void 0&&this.set(t,n[t],!0)}copyAll(t){for(const n of Be(t.combine())){const r=t.getWithExplicit(n);this.setWithExplicit(n,r)}}}function lg(e){return{explicit:!0,value:e}}function Ko(e){return{explicit:!1,value:e}}function $me(e){return(t,n,r,i)=>{const a=e(t.value,n.value);return a>0?t:a<0?n:PO(t,n,r,i)}}function PO(e,t,n,r){return e.explicit&&t.explicit&&Me(Lgt(n,r,e.value,t.value)),e}function eh(e,t,n,r,i=PO){return e===void 0||e.value===void 0?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:fw(e.value,t.value)?e:i(e,t,n,r)}class m0t extends Xc{constructor(t={},n={},r=!1){super(t,n);this.explicit=t,this.implicit=n,this.parseNothing=r}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function kw(e){return"url"in e}function $O(e){return"values"in e}function Lme(e){return"name"in e&&!kw(e)&&!$O(e)&&!cg(e)}function cg(e){return e&&(Bme(e)||zme(e)||W8(e))}function Bme(e){return"sequence"in e}function zme(e){return"sphere"in e}function W8(e){return"graticule"in e}const sa="main",LO="raw";function jme(e){return"filter"in e}function v0t(e){return(e==null?void 0:e.stop)!==void 0}function y0t(e){return"lookup"in e}function b0t(e){return"data"in e}function x0t(e){return"selection"in e}function w0t(e){return"pivot"in e}function _0t(e){return"density"in e}function S0t(e){return"quantile"in e}function E0t(e){return"regression"in e}function C0t(e){return"loess"in e}function A0t(e){return"sample"in e}function k0t(e){return"window"in e}function T0t(e){return"joinaggregate"in e}function O0t(e){return"flatten"in e}function I0t(e){return"calculate"in e}function N0t(e){return"bin"in e}function D0t(e){return"impute"in e}function R0t(e){return"timeUnit"in e}function F0t(e){return"aggregate"in e}function M0t(e){return"stack"in e}function P0t(e){return"fold"in e}function $0t(e){return e.map(t=>jme(t)?{filter:QT(t.filter,Emt)}:t)}function Tw(e,t,n,r){const i=y8(t)&&t.condition,a=r(t);if(i){const s=Br(i).map(u=>{const l=r(u),c=evt(u)?Ave(e,u.selection):YO(e,u.test);return Object.assign({test:c},l)});return{[n]:[...s,...a!==void 0?[a]:[]]}}else return a!==void 0?{[n]:a}:{}}function V8(e,t="text"){const n=e.encoding[t];return Tw(e,n,t,r=>BO(r,e.config))}function BO(e,t,n="datum"){if(e){if(Gc(e))return zr(e.value);if(It(e)){const{format:r,formatType:i}=AO(e);return p8({fieldOrDatumDef:e,format:r,formatType:i,expr:n,config:t})}}}function Ume(e,t={}){const{encoding:n,markDef:r,config:i,stack:a}=e,o=n.tooltip;if(vt(o))return{tooltip:Vme({tooltip:o},a,i,t)};{const s=t.reactiveGeom?"datum.datum":"datum";return Tw(e,o,"tooltip",u=>{const l=BO(u,i,s);if(l)return l;if(u===null)return;let c=Fn("tooltip",r,i);if(c===!0&&(c={content:"encoding"}),Xt(c))return{value:c};if(Ai(c))return c.content==="encoding"?Vme(n,a,i,t):{signal:s}})}}function Wme(e,t,n,{reactiveGeom:r}={}){const i={},a=r?"datum.datum":"datum",o=[];function s(l,c){const f=tg(c),d=Go(l)?l:Object.assign(Object.assign({},l),{type:e[f].type}),h=Br(ag(d,n,{allowDisabling:!1})).join(", ");let p;if(Il(c)){const g=c==="x"?"x2":"y2",m=Fl(e[g]);if(Wa(d.bin)&&m){const v=Ue(d,{expr:a}),y=Ue(m,{expr:a}),{format:b,formatType:x}=AO(d);p=_O(v,y,b,x,n),i[g]=!0}else if(t&&t.fieldChannel===c&&t.offset==="normalize"){const{format:v,formatType:y}=AO(d);p=p8({fieldOrDatumDef:d,format:v,formatType:y,expr:a,config:n,normalizeStack:!0}).signal}}p=p??BO(d,n,a).signal,o.push({channel:c,key:h,value:p})}T8(e,(l,c)=>{We(l)?s(l,c):CO(l)&&s(l.condition,c)});const u={};for(const{channel:l,key:c,value:f}of o)!i[l]&&!u[c]&&(u[gn(c)]=f);return u}function Vme(e,t,n,{reactiveGeom:r}={}){const i=Wme(e,t,n,{reactiveGeom:r}),a=bpe(i).map(({key:o,value:s})=>`${o}: ${s}`);return a.length>0?{signal:`{${a.join(", ")}}`}:void 0}function L0t(e){const{markDef:t,config:n}=e,r=Fn("aria",t,n);return r===!1?{}:Object.assign(Object.assign(Object.assign({},r?{aria:r}:{}),B0t(e)),z0t(e))}function B0t(e){const{mark:t,markDef:n,config:r}=e;if(r.aria===!1)return{};const i=Fn("ariaRoleDescription",n,r);return i!=null?{ariaRoleDescription:{value:i}}:t in xmt?{}:{ariaRoleDescription:{value:t}}}function z0t(e){const{encoding:t,markDef:n,config:r,stack:i}=e,a=t.description;if(a)return Tw(e,a,"description",u=>BO(u,e.config));const o=Fn("description",n,r);if(o!=null)return{description:zr(o)};if(r.aria===!1)return{};const s=Wme(t,i,r);if(!Yn(s))return{description:{signal:bpe(s).map(({key:u,value:l})=>`${u} + ": " + (${l})`).join(' + "; " + ')}}}function ki(e,t,n={}){const{markDef:r,encoding:i,config:a}=t,{vgChannel:o}=n;let{defaultRef:s,defaultValue:u}=n;s===void 0&&(u=u??Fn(e,r,a,{vgChannel:o,ignoreVgConfig:!0}),u!==void 0&&(s=zr(u)));const l=i[e];return Tw(t,l,o??e,c=>kge({channel:e,channelDef:c,markDef:r,config:a,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:s}))}function qme(e,t={filled:void 0}){var n,r,i,a;const{markDef:o,encoding:s,config:u}=e,{type:l}=o,c=(n=t.filled)!==null&&n!==void 0?n:Fn("filled",o,u),f=bt(["bar","point","circle","square","geoshape"],l)?"transparent":void 0,d=(i=(r=Fn(c===!0?"color":void 0,o,u,{vgChannel:"fill"}))!==null&&r!==void 0?r:u.mark[c===!0&&"color"])!==null&&i!==void 0?i:f,h=(a=Fn(c===!1?"color":void 0,o,u,{vgChannel:"stroke"}))!==null&&a!==void 0?a:u.mark[c===!1&&"color"],p=c?"fill":"stroke",g=Object.assign(Object.assign({},d?{fill:zr(d)}:{}),h?{stroke:zr(h)}:{});return o.color&&(c?o.fill:o.stroke)&&Me(tge("property",{fill:"fill"in o,stroke:"stroke"in o})),Object.assign(Object.assign(Object.assign(Object.assign({},g),ki("color",e,{vgChannel:p,defaultValue:c?d:h})),ki("fill",e,{defaultValue:s.fill?d:void 0})),ki("stroke",e,{defaultValue:s.stroke?h:void 0}))}function Ow(e,t){const n=Ypt(e),r=t[n];if(r)return r}function ua(e,t,{defaultPos:n,vgChannel:r,isMidPoint:i}){const{encoding:a,markDef:o,config:s,stack:u}=t,l=a[e],c=a[Tl(e)],f=t.scaleName(e),d=t.getScaleComponent(e),h=Ow(e,o),p=q8({model:t,defaultPos:n,channel:e,scaleName:f,scale:d}),g=!l&&Il(e)&&(a.latitude||a.longitude)?{field:t.getName(e)}:j0t({channel:e,channelDef:l,channel2Def:c,markDef:o,config:s,isMidPoint:i,scaleName:f,scale:d,stack:u,offset:h,defaultRef:p});return g?{[r||e]:g}:void 0}function j0t(e){const{channel:t,channelDef:n,isMidPoint:r,scaleName:i,stack:a,offset:o,markDef:s,config:u}=e;if(It(n)&&a&&t===a.fieldChannel){if(We(n)){const l=Sw({channel:t,fieldDef:n,isMidPoint:r,markDef:s,stack:a,config:u});if(l!==void 0)return wO({scaleName:i,fieldOrDatumDef:n,startSuffix:"start",band:l,offset:o})}return rg(n,i,{suffix:"end"},{offset:o})}return d8(e)}function q8({model:e,defaultPos:t,channel:n,scaleName:r,scale:i}){const{markDef:a,config:o}=e;return()=>{const s=tg(n),u=Hd(n),l=Fn(n,a,o,{vgChannel:u});if(l!==void 0)return ww(n,l);switch(t){case"zeroOrMin":case"zeroOrMax":if(r){const c=i.get("type");if(!bt([ei.LOG,ei.TIME,ei.UTC],c)){if(i.domainDefinitelyIncludesZero())return{scale:r,value:0}}}if(t==="zeroOrMin")return s==="y"?{field:{group:"height"}}:{value:0};switch(s){case"radius":return{signal:`min(${e.width.signal},${e.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":{const c=e[Ol(n)];return Object.assign(Object.assign({},c),{mult:.5})}}}}const U0t={left:"x",center:"xc",right:"x2"},W0t={top:"y",middle:"yc",bottom:"y2"};function Hme(e,t,n,r="middle"){if(e==="radius"||e==="theta")return Hd(e);const a=Fn(e==="x"?"align":"baseline",t,n);return e==="x"?U0t[a||(r==="top"?"left":"center")]:W0t[a||r]}function zO(e,t,{defaultPos:n,defaultPos2:r,range:i}){return i?Gme(e,t,{defaultPos:n,defaultPos2:r}):ua(e,t,{defaultPos:n})}function Gme(e,t,{defaultPos:n,defaultPos2:r}){const{markDef:i,config:a}=t,o=Tl(e),s=Ol(e),u=V0t(t,r,o),l=u[s]?Hme(e,i,a):Hd(e);return Object.assign(Object.assign({},ua(e,t,{defaultPos:n,vgChannel:l})),u)}function V0t(e,t,n){const{encoding:r,mark:i,markDef:a,stack:o,config:s}=e,u=tg(n),l=Ol(n),c=Hd(n),f=r[u],d=e.scaleName(u),h=e.getScaleComponent(u),p=n in r||n in a?Ow(n,e.markDef):Ow(u,e.markDef);if(!f&&(n==="x2"||n==="y2")&&(r.latitude||r.longitude))return{[c]:{field:e.getName(n)}};const g=q0t({channel:n,channelDef:f,channel2Def:r[n],markDef:a,config:s,scaleName:d,scale:h,stack:o,offset:p,defaultRef:void 0});return g!==void 0?{[c]:g}:jO(n,a)||jO(n,{[n]:IO(n,a,s.style),[l]:IO(l,a,s.style)})||jO(n,s[i])||jO(n,s.mark)||{[c]:q8({model:e,defaultPos:t,channel:n,scaleName:d,scale:h})()}}function q0t({channel:e,channelDef:t,channel2Def:n,markDef:r,config:i,scaleName:a,scale:o,stack:s,offset:u,defaultRef:l}){return It(t)&&s&&e.charAt(0)===s.fieldChannel.charAt(0)?rg(t,a,{suffix:"start"},{offset:u}):d8({channel:e,channelDef:n,scaleName:a,scale:o,stack:s,markDef:r,config:i,offset:u,defaultRef:l})}function jO(e,t){const n=Ol(e),r=Hd(e);if(t[r]!==void 0)return{[r]:ww(e,t[r])};if(t[e]!==void 0)return{[r]:ww(e,t[e])};if(t[n])return{[n]:ww(e,t[n])}}function th(e,t,n){var r,i,a,o;const{config:s,encoding:u,markDef:l,stack:c}=e,f=Tl(t),d=Ol(t),h=u[t],p=u[f],g=e.getScaleComponent(t),m=g?g.get("type"):void 0,v=e.scaleName(t),y=l.orient,b=(i=(r=u[d])!==null&&r!==void 0?r:u.size)!==null&&i!==void 0?i:Fn("size",l,s,{vgChannel:d}),x=n==="bar"&&(t==="x"?y==="vertical":y==="horizontal");if(We(h)&&(Qn(h.bin)||Wa(h.bin)||h.timeUnit&&!p)&&!b&&!bo(m)){const w=Sw({channel:t,fieldDef:h,stack:c,markDef:l,config:s}),S=(a=e.component.axes[t])===null||a===void 0?void 0:a[0],C=(o=S==null?void 0:S.get("translate"))!==null&&o!==void 0?o:.5;return K0t({fieldDef:h,fieldDef2:p,channel:t,markDef:l,scaleName:v,band:w,axisTranslate:C,spacing:Il(t)?Fn("binSpacing",l,s):void 0,reverse:g.get("reverse"),config:s})}else return(It(h)&&bo(m)||x)&&!p?G0t(n,h,t,e):Gme(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function H0t(e,t,n,r,i,a){if(r){const u=r.get("type");if(u==="point"||u==="band"){if(i[e].discreteBandSize!==void 0)return{value:i[e].discreteBandSize};if(u===ei.POINT){const l=r.get("range");return Xd(l)&&Jr(l.step)?{value:l.step-2}:{value:B8-2}}else return{scale:n,band:a}}else return{value:i[e].continuousBandSize}}const o=FO(i.view,t),s=Qr(i[e].discreteBandSize,o-2);return s!==void 0?{value:s}:void 0}function G0t(e,t,n,r){var i;const{markDef:a,encoding:o,config:s,stack:u}=r,l=a.orient,c=r.scaleName(n),f=r.getScaleComponent(n),d=Ol(n),h=Tl(n),p=l==="horizontal"&&n==="y"||l==="vertical"&&n==="x",g=Fn(p?"size":d,a,s,{vgChannel:d});let m;(o.size||g!==void 0)&&(p?m=ki("size",r,{vgChannel:d,defaultValue:g}):Me(Mgt(a.type)));const v=(i=It(t)?Sw({channel:n,fieldDef:t,markDef:a,stack:u,config:s}):void 0)!==null&&i!==void 0?i:1;m=m||{[d]:H0t(e,d,c,f,s,v)};const y=(f==null?void 0:f.get("type"))!=="band"||!("band"in m[d]),b=Hme(n,a,s,y?"middle":"top"),x=Ow(n,a),w=d8({channel:n,channelDef:t,markDef:a,config:s,scaleName:c,scale:f,stack:u,offset:x,defaultRef:q8({model:r,defaultPos:"mid",channel:n,scaleName:c,scale:f}),band:y?.5:(1-v)/2});if(d)return Object.assign({[b]:w},m);{const S=Hd(h),C=m[d],_=x?Object.assign(Object.assign({},C),{offset:x}):C;return{[b]:w,[S]:vt(w)?[w[0],Object.assign(Object.assign({},w[1]),{offset:_})]:Object.assign(Object.assign({},w),{offset:_})}}}function Iw(e,t,n,r,i){if(Mpe(e))return 0;const a=e==="x"||e==="y2"?-t/2:t/2;if(Et(n)){const o=Cw(i);return{signal:`${n.signal} ? ${r-a}${o?"-"+o:""} : ${r+a}${o?"+"+o:""}`}}else{if(Et(i)){const o=r+(n?-a:a);return{signal:`${o||""}${n?" - ":o?" + ":""}${i.signal}`}}return i=i||0,r+(n?-i-a:+i+a)}}function K0t({fieldDef:e,fieldDef2:t,channel:n,band:r,scaleName:i,markDef:a,spacing:o=0,axisTranslate:s,reverse:u,config:l}){const c=Tl(n),f=Hd(n),d=Hd(c),h=Ow(n,a);if(Qn(e.bin)||e.timeUnit)return{[d]:Kme({channel:n,fieldDef:e,scaleName:i,markDef:a,band:(1-r)/2,offset:Iw(c,o,u,s,h),config:l}),[f]:Kme({channel:n,fieldDef:e,scaleName:i,markDef:a,band:1-(1-r)/2,offset:Iw(n,o,u,s,h),config:l})};if(Wa(e.bin)){const p=rg(e,i,{},{offset:Iw(c,o,u,s,h)});if(We(t))return{[d]:p,[f]:rg(t,i,{},{offset:Iw(n,o,u,s,h)})};if(bw(e.bin)&&e.bin.step)return{[d]:p,[f]:{signal:`scale("${i}", ${Ue(e,{expr:"datum"})} + ${e.bin.step})`,offset:Iw(n,o,u,s,h)}}}Me(oge(c))}function Kme({channel:e,fieldDef:t,scaleName:n,markDef:r,band:i,offset:a,config:o}){const s=wO({scaleName:n,fieldOrDatumDef:t,band:i,offset:a});return Age({fieldDef:t,channel:e,markDef:r,ref:s,config:o})}const X0t=new Set(["aria"]);function Cs(e,t){const{fill:n=void 0,stroke:r=void 0}=t.color==="include"?qme(e):{};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Y0t(e.markDef,t)),Xme(e,"fill",n)),Xme(e,"stroke",r)),ki("opacity",e)),ki("fillOpacity",e)),ki("strokeOpacity",e)),ki("strokeWidth",e)),ki("strokeDash",e)),Ume(e)),V8(e,"href")),L0t(e))}function Xme(e,t,n){const{config:r,mark:i,markDef:a}=e;if(Fn("invalid",a,r)==="hide"&&n&&!Zp(i)){const s=Z0t(e,{invalid:!0,channels:gO});if(s)return{[t]:[{test:s,value:null},...Br(n)]}}return n?{[t]:n}:{}}function Y0t(e,t){return bmt.reduce((n,r)=>(!X0t.has(r)&&e[r]!==void 0&&t[r]!=="ignore"&&(n[r]=zr(e[r])),n),{})}function Z0t(e,{invalid:t=!1,channels:n}){const r=n.reduce((a,o)=>{const s=e.getScaleComponent(o);if(s){const u=s.get("type"),l=e.vgField(o,{expr:"datum"});l&&Es(u)&&(a[l]=!0)}return a},{}),i=Be(r);if(i.length>0){const a=t?"||":"&&";return i.map(o=>h8(o,t)).join(` ${a} `)}}function H8(e){const{config:t,markDef:n}=e;if(Fn("invalid",n,t)){const i=J0t(e,{channels:Ss});if(i)return{defined:{signal:i}}}return{}}function J0t(e,{invalid:t=!1,channels:n}){const r=n.reduce((a,o)=>{const s=e.getScaleComponent(o);if(s){const u=s.get("type"),l=e.vgField(o,{expr:"datum"});l&&Es(u)&&(a[l]=!0)}return a},{}),i=Be(r);if(i.length>0){const a=t?"||":"&&";return i.map(o=>h8(o,t)).join(` ${a} `)}}function Yme(e,t){if(t!==void 0)return{[e]:zr(t)}}const G8="voronoi",Zme={has:e=>e.type!=="interval"&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(G8)},marks:(e,t,n)=>{const{x:r,y:i}=t.project.hasChannel,a=e.mark;if(Zp(a))return Me(sgt(a)),n;const o={name:e.getName(G8),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},Ume(e,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:r||!i?"datum.datum.x || 0":"0"},y:{expr:i||!r?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let s=0,u=!1;return n.forEach((l,c)=>{var f;const d=(f=l.name)!==null&&f!==void 0?f:"";d===e.component.mark[0].name?s=c:d.indexOf(G8)>=0&&(u=!0)}),u||n.splice(s+1,0,o),n}};class qn{constructor(t,n){this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){if(this._children.indexOf(t)>-1){console.warn("Attempt to add the same child twice.");return}n!==void 0?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){const n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(const n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){const n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){const t=this._parent,n=t.parent;for(const r of this._children)r.parent=t;this._children=[],t.removeChild(this),t.parent.removeChild(t),this.parent=n,t.parent=this}}class qa extends qn{constructor(t,n,r,i){super(t,n);this.type=r,this.refCounts=i,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){const t=new this.constructor;return t.debugName="clone_"+this.debugName,t._source=this._source,t._name="clone_"+this._name,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}dependentFields(){return new Set}producedFields(){return new Set}hash(){return this._hash===void 0&&(this._hash=`Output ${mpt()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}class Pl extends qn{constructor(t,n){super(t);this.formula=n}clone(){return new Pl(null,Yt(this.formula))}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,a,o)=>{const{field:s,timeUnit:u}=a,l=Nr(n)?n.encoding[Tl(o)]:void 0,c=Nr(n)&&v8(o,a,l,n.stack,n.markDef,n.config);if(u){const f=Ue(a,{forAs:!0});i[yn({as:f,field:s,timeUnit:u})]=Object.assign({as:f,field:s,timeUnit:u},c?{band:!0}:{})}return i},{});return Yn(r)?null:new Pl(t,r)}static makeFromTransform(t,n){const r=Object.assign({},n),{timeUnit:i}=r,a=dt(r,["timeUnit"]),o=Va(i),s=Object.assign(Object.assign({},a),{timeUnit:o});return new Pl(t,{[yn(s)]:s})}merge(t){this.formula=Object.assign({},this.formula);for(const n in t.formula)(!this.formula[n]||t.formula[n].band)&&(this.formula[n]=t.formula[n]);for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}producedFields(){return new Set(Bd(this.formula).map(t=>t.as))}dependentFields(){return new Set(Bd(this.formula).map(t=>t.field))}hash(){return`TimeUnit ${yn(this.formula)}`}assemble(){const t=[];for(const n of Bd(this.formula)){const{field:r,as:i,timeUnit:a}=n,o=Va(a),{unit:s,utc:u}=o,l=dt(o,["unit","utc"]);t.push(Object.assign(Object.assign(Object.assign(Object.assign({field:zd(r),type:"timeunit"},s?{units:r8(s)}:{}),u?{timezone:"utc"}:{}),l),{as:[i,`${i}_end`]}))}return t}}const Nw="_tuple_fields";class Q0t{constructor(...t){this.items=t,this.hasChannel={},this.hasField={}}}const eyt={has:()=>!0,parse:(e,t,n)=>{var r,i,a;const o=t.name,s=(r=t.project)!==null&&r!==void 0?r:t.project=new Q0t,u={},l={},c=new Set,f=(d,h)=>{const p=h==="visual"?d.channel:d.field;let g=fr(`${o}_${p}`);for(let m=1;c.has(g);m++)g=fr(`${o}_${p}_${m}`);return c.add(g),{[h]:g}};if(!n.fields&&!n.encodings){const d=e.config.selection[n.type];if(n.init)for(const h of Br(n.init))for(const p of Be(h))Kpt(p)?(n.encodings||(n.encodings=[])).push(p):n.type==="interval"?(Me('Interval selections should be initialized using "x" and/or "y" keys.'),n.encodings=d.encodings):(n.fields||(n.fields=[])).push(p);else n.encodings=d.encodings,n.fields=d.fields}for(const d of(i=n.fields)!==null&&i!==void 0?i:[]){const h={type:"E",field:d};h.signals=Object.assign({},f(h,"data")),s.items.push(h),s.hasField[d]=h}for(const d of(a=n.encodings)!==null&&a!==void 0?a:[]){const h=e.fieldDef(d);if(h){let p=h.field;if(h.aggregate){Me(ogt(d,h.aggregate));continue}else if(!p){Me(Xpe(d));continue}if(h.timeUnit){p=e.vgField(d);const g={timeUnit:h.timeUnit,as:p,field:h.field};l[yn(g)]=g}if(!u[p]){let g="E";if(t.type==="interval"){const v=e.getScaleComponent(d).get("type");Es(v)&&(g="R")}else h.bin&&(g="R-RE");const m={field:p,channel:d,type:g};m.signals=Object.assign(Object.assign({},f(m,"data")),f(m,"visual")),s.items.push(u[p]=m),s.hasField[p]=s.hasChannel[d]=u[p]}}else Me(Xpe(d))}if(n.init){const d=h=>s.items.map(p=>h[p.channel]!==void 0?h[p.channel]:h[p.field]);if(n.type==="interval")t.init=d(n.init);else{const h=Br(n.init);t.init=h.map(d)}}Yn(l)||(s.timeUnit=new Pl(null,l))},signals:(e,t,n)=>{const r=t.name+Nw;return n.filter(a=>a.name===r).length>0?n:n.concat({name:r,value:t.project.items.map(a=>{const o=dt(a,["signals","hasLegend"]);return o.field=zd(o.field),o})})}},Jme={has:e=>e.type==="single"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!F8(e.bind),parse:(e,t,n,r)=>{r.on||delete t.events,r.clear||delete t.clear},topLevelSignals:(e,t,n)=>{const r=t.name,i=t.project,a=t.bind,o=t.init&&t.init[0],s=Zme.has(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return i.items.forEach((u,l)=>{var c,f;const d=fr(`${r}_${u.field}`);n.filter(p=>p.name===d).length||n.unshift(Object.assign(Object.assign({name:d},o?{init:x0(o[l])}:{value:null}),{on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${s}[${gn(u.field)}] : null`}]:[],bind:(f=(c=a[u.field])!==null&&c!==void 0?c:a[u.channel])!==null&&f!==void 0?f:a}))}),n},signals:(e,t,n)=>{const r=t.name,i=t.project,a=n.filter(l=>l.name===r+$l)[0],o=r+Nw,s=i.items.map(l=>fr(`${r}_${l.field}`)),u=s.map(l=>`${l} !== null`).join(" && ");return s.length&&(a.update=`${u} ? {fields: ${o}, values: [${s.join(", ")}]} : null`),delete a.value,delete a.on,n}},UO="_toggle",Qme={has:e=>e.type==="multi"&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+UO,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+$l,r=t.name+UO;return`${r} ? null : ${n}, `+(t.resolve==="global"?`${r} ? null : true, `:`${r} ? null : {unit: ${Yc(e)}}, `)+`${r} ? ${n} : null`}},tyt={has:e=>e.clear!==void 0&&e.clear!==!1,parse:(e,t,n)=>{n.clear&&(t.clear=Xt(n.clear)?Pd(n.clear,"scope"):n.clear)},topLevelSignals:(e,t,n)=>{if(Jme.has(t))for(const r of t.project.items){const i=n.findIndex(a=>a.name===fr(`${t.name}_${r.field}`));i!==-1&&n[i].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function r(i,a){i!==-1&&n[i].on&&n[i].on.push({events:t.clear,update:a})}if(t.type==="interval")for(const i of t.project.items){const a=n.findIndex(o=>o.name===i.signals.visual);if(r(a,"[0, 0]"),a===-1){const o=n.findIndex(s=>s.name===i.signals.data);r(o,"null")}}else{let i=n.findIndex(a=>a.name===t.name+$l);r(i,"null"),Qme.has(t)&&(i=n.findIndex(a=>a.name===t.name+UO),r(i,"false"))}return n}},nh={has:e=>e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales",parse:(e,t)=>{const n=t.scales=[];for(const r of t.project.items){const i=r.channel;if(!Kd(i))continue;const a=e.getScaleComponent(i),o=a?a.get("type"):void 0;if(!a||!Es(o)){Me(lgt);continue}const s={selection:t.name,field:r.field};a.set("selectionExtent",s,!0),n.push(r)}},topLevelSignals:(e,t,n)=>{const r=t.scales.filter(o=>n.filter(s=>s.name===o.signals.data).length===0);if(!e.parent||X8(e)||r.length===0)return n;const i=n.filter(o=>o.name===t.name)[0];let a=i.update;if(a.indexOf(cve)>=0)i.update=`{${r.map(o=>`${gn(o.field)}: ${o.signals.data}`).join(", ")}}`;else{for(const o of r){const s=`${gn(o.field)}: ${o.signals.data}`;a.indexOf(s)<0&&(a=`${a.substring(0,a.length-1)}, ${s}}`)}i.update=a}return n.concat(r.map(o=>({name:o.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!X8(e))for(const r of t.scales){const i=n.filter(a=>a.name===r.signals.data)[0];i.push="outer",delete i.value,delete i.update}return n}};function K8(e,t){return`domain(${gn(e.scaleName(t))})`}function X8(e){var t;return e.parent&&O0(e.parent)&&((t=!e.parent.parent)!==null&&t!==void 0?t:X8(e.parent.parent))}const eve={has:e=>{const t=e.resolve==="global"&&e.bind&&F8(e.bind),n=e.project.items.length===1&&e.project.items[0].field!==b0;return t&&!n&&Me(cgt),t&&n},parse:(e,t,n,r)=>{var i;if(r.on||delete t.events,r.clear||delete t.clear,r.on||r.clear){const s='event.item && indexof(event.item.mark.role, "legend") < 0';for(const u of t.events)u.filter=Br((i=u.filter)!==null&&i!==void 0?i:[]),u.filter.indexOf(s)<0&&u.filter.push(s)}const a=M8(t.bind)?t.bind.legend:"click",o=Xt(a)?Pd(a,"view"):Br(a);t.bind={legend:{merge:o}}},topLevelSignals:(e,t,n)=>{const r=t.name,i=M8(t.bind)&&t.bind.legend,a=o=>s=>{const u=Yt(s);return u.markname=o,u};for(const o of t.project.items){if(!o.hasLegend)continue;const s=`${fr(o.field)}_legend`,u=`${r}_${s}`;if(n.filter(c=>c.name===u).length===0){const c=i.merge.map(a(`${s}_symbols`)).concat(i.merge.map(a(`${s}_labels`))).concat(i.merge.map(a(`${s}_entries`)));n.unshift(Object.assign(Object.assign({name:u},t.init?{}:{value:null}),{on:[{events:c,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:`!event.item || !datum ? null : ${u}`,force:!0}]}))}}return n},signals:(e,t,n)=>{const r=t.name,i=t.project,a=n.find(d=>d.name===r+$l),o=r+Nw,s=i.items.filter(d=>d.hasLegend).map(d=>fr(`${r}_${fr(d.field)}_legend`)),l=`${s.map(d=>`${d} !== null`).join(" && ")} ? {fields: ${o}, values: [${s.join(", ")}]} : null`;t.events&&s.length>0?a.on.push({events:s.map(d=>({signal:d})),update:l}):s.length>0&&(a.update=l,delete a.value,delete a.on);const c=n.find(d=>d.name===r+UO),f=M8(t.bind)&&t.bind.legend;return c&&(t.events?c.on.push(Object.assign(Object.assign({},c.on[0]),{events:f})):c.on[0].events=f),n}};function nyt(e,t,n){var r;const i=(r=e.fieldDef(t))===null||r===void 0?void 0:r.field;dg(e,a=>{var o,s;const u=(o=a.project.hasField[i])!==null&&o!==void 0?o:a.project.hasChannel[t];if(u&&eve.has(a)){const l=(s=n.get("selections"))!==null&&s!==void 0?s:[];l.push(a.name),n.set("selections",l,!1),u.hasLegend=!0}})}const tve="_translate_anchor",nve="_translate_delta",ryt={has:e=>e.type==="interval"&&e.translate,signals:(e,t,n)=>{const r=t.name,i=nh.has(t),a=r+tve,{x:o,y:s}=t.project.hasChannel;let u=Pd(t.translate,"scope");return i||(u=u.map(l=>(l.between[0].markname=r+Dw,l))),n.push({name:a,value:{},on:[{events:u.map(l=>l.between[0]),update:"{x: x(unit), y: y(unit)"+(o!==void 0?", extent_x: "+(i?K8(e,br):`slice(${o.signals.visual})`):"")+(s!==void 0?", extent_y: "+(i?K8(e,di):`slice(${s.signals.visual})`):"")+"}"}]},{name:r+nve,value:{},on:[{events:u,update:`{x: ${a}.x - x(unit), y: ${a}.y - y(unit)}`}]}),o!==void 0&&rve(e,t,o,"width",n),s!==void 0&&rve(e,t,s,"height",n),n}};function rve(e,t,n,r,i){var a;const o=t.name,s=o+tve,u=o+nve,l=n.channel,c=nh.has(t),f=i.filter(x=>x.name===n.signals[c?"data":"visual"])[0],d=e.getSizeSignalRef(r).signal,h=e.getScaleComponent(l),p=h.get("type"),g=c&&l===br?"-":"",m=`${s}.extent_${l}`,v=`${g}${u}.${l} / `+(c?`${d}`:`span(${m})`),b=`${c?p==="log"?"panLog":p==="pow"?"panPow":"panLinear":"panLinear"}(${m}, ${v}`+(c&&p==="pow"?`, ${(a=h.get("exponent"))!==null&&a!==void 0?a:1}`:"")+")";f.on.push({events:{signal:u},update:c?b:`clampRange(${b}, 0, ${d})`})}const ive="_zoom_anchor",ave="_zoom_delta",iyt={has:e=>e.type==="interval"&&e.zoom,signals:(e,t,n)=>{const r=t.name,i=nh.has(t),a=r+ave,{x:o,y:s}=t.project.hasChannel,u=gn(e.scaleName(br)),l=gn(e.scaleName(di));let c=Pd(t.zoom,"scope");return i||(c=c.map(f=>(f.markname=r+Dw,f))),n.push({name:r+ive,on:[{events:c,update:i?"{"+[u?`x: invert(${u}, x(unit))`:"",l?`y: invert(${l}, y(unit))`:""].filter(f=>!!f).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:a,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),o!==void 0&&ove(e,t,o,"width",n),s!==void 0&&ove(e,t,s,"height",n),n}};function ove(e,t,n,r,i){var a;const o=t.name,s=n.channel,u=nh.has(t),l=i.filter(y=>y.name===n.signals[u?"data":"visual"])[0],c=e.getSizeSignalRef(r).signal,f=e.getScaleComponent(s),d=f.get("type"),h=u?K8(e,s):l.name,p=o+ave,g=`${o}${ive}.${s}`,v=`${u?d==="log"?"zoomLog":d==="pow"?"zoomPow":"zoomLinear":"zoomLinear"}(${h}, ${g}, ${p}`+(u&&d==="pow"?`, ${(a=f.get("exponent"))!==null&&a!==void 0?a:1}`:"")+")";l.on.push({events:{signal:p},update:u?v:`clampRange(${v}, 0, ${c})`})}const ayt=[eyt,Qme,nh,eve,ryt,iyt,Jme,Zme,tyt];function WO(e,t){for(const n of ayt)n.has(e)&&t(n)}function x0(e,t=!0,n=Qht){if(vt(e)){const r=e.map(i=>x0(i,t,n));return t?`[${r.join(", ")}]`:r}else if(g0(e))return n(t?xw(e):lmt(e));return t?n(JSON.stringify(e)):e}function oyt(e,t){return dg(e,(n,r)=>{const i=n.name;let a=r.modifyExpr(e,n);t.push(...r.signals(e,n)),WO(n,o=>{o.signals&&(t=o.signals(e,n,t)),o.modifyExpr&&(a=o.modifyExpr(e,n,a))}),t.push({name:i+myt,on:[{events:{signal:n.name+$l},update:`modify(${gn(n.name+fg)}, ${a})`}]})}),Y8(t)}function syt(e,t){if(e.component.selection&&Be(e.component.selection).length){const n=gn(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:Pd("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return Y8(t)}function uyt(e,t){let n=!1;return dg(e,(r,i)=>{const a=r.name,o=gn(a+fg);if(t.filter(u=>u.name===a).length===0){const u=r.resolve==="global"?"union":r.resolve,l=r.type==="multi"?", true)":")";t.push({name:r.name,update:`${cve}(${o}, ${gn(u)}${l}`})}n=!0,i.topLevelSignals&&(t=i.topLevelSignals(e,r,t)),WO(r,u=>{u.topLevelSignals&&(t=u.topLevelSignals(e,r,t))})}),n&&t.filter(i=>i.name==="unit").length===0&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]}),Y8(t)}function lyt(e,t){const n=[...t];return dg(e,r=>{const i={name:r.name+fg};if(r.init){const o=r.project.items.map(u=>dt(u,["signals"])),s=r.init.map(u=>x0(u,!1));i.values=r.type==="interval"?[{unit:Yc(e,{escape:!1}),fields:o,values:s}]:s.map(u=>({unit:Yc(e,{escape:!1}),fields:o,values:u}))}n.filter(o=>o.name===r.name+fg).length||n.push(i)}),n}function sve(e,t){return dg(e,(n,r)=>{t=r.marks?r.marks(e,n,t):t,WO(n,i=>{i.marks&&(t=i.marks(e,n,t))})}),t}function cyt(e,t){for(const n of e.children)Nr(n)&&(t=sve(n,t));return t}function fyt(e,t){const n=t.selection,r=e.getSelectionComponent(n,fr(n));return{signal:kve(r,t)}}function Y8(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}const Dw="_brush",Z8="_scale_trigger",dyt={signals:(e,t)=>{const n=t.name,r=n+Nw,i=nh.has(t),a=[],o=[],s=[];if(t.translate&&!i){const c=`!event.item || event.item.mark.name !== ${gn(n+Dw)}`;uve(t,(f,d)=>{var h;const p=Br((h=d.between[0].filter)!==null&&h!==void 0?h:d.between[0].filter=[]);return p.indexOf(c)<0&&p.push(c),f})}t.project.items.forEach((c,f)=>{const d=c.channel;if(d!==br&&d!==di){Me("Interval selections only support x and y encoding channels.");return}const h=t.init?t.init[f]:null,p=hyt(e,t,c,h),g=c.signals.data,m=c.signals.visual,v=gn(e.scaleName(d)),y=e.getScaleComponent(d).get("type"),b=Es(y)?"+":"";a.push(...p),o.push(g),s.push({scaleName:e.scaleName(d),expr:`(!isArray(${g}) || (${b}invert(${v}, ${m})[0] === ${b}${g}[0] && ${b}invert(${v}, ${m})[1] === ${b}${g}[1]))`})}),i||a.push({name:n+Z8,value:{},on:[{events:s.map(c=>({scale:c.scaleName})),update:s.map(c=>c.expr).join(" && ")+` ? ${n+Z8} : {}`}]});const u=t.init,l=`unit: ${Yc(e)}, fields: ${r}, values`;return a.concat(Object.assign(Object.assign({name:n+$l},u?{init:`{${l}: ${x0(u)}}`}:{}),{on:[{events:[{signal:o.join(" || ")}],update:o.join(" && ")+` ? {${l}: [${o}]} : null`}]}))},modifyExpr:(e,t)=>t.name+$l+", "+(t.resolve==="global"?"true":`{unit: ${Yc(e)}}`),marks:(e,t,n)=>{const r=t.name,{x:i,y:a}=t.project.hasChannel,o=i&&i.signals.visual,s=a&&a.signals.visual,u=`data(${gn(t.name+fg)})`;if(nh.has(t))return n;const l={x:i!==void 0?{signal:`${o}[0]`}:{value:0},y:a!==void 0?{signal:`${s}[0]`}:{value:0},x2:i!==void 0?{signal:`${o}[1]`}:{field:{group:"width"}},y2:a!==void 0?{signal:`${s}[1]`}:{field:{group:"height"}}};if(t.resolve==="global")for(const m of Be(l))l[m]=[Object.assign({test:`${u}.length && ${u}[0].unit === ${Yc(e)}`},l[m]),{value:0}];const c=t.mark,{fill:f,fillOpacity:d,cursor:h}=c,p=dt(c,["fill","fillOpacity","cursor"]),g=Be(p).reduce((m,v)=>(m[v]=[{test:[i!==void 0&&`${o}[0] !== ${o}[1]`,a!==void 0&&`${s}[0] !== ${s}[1]`].filter(y=>y).join(" && "),value:p[v]},{value:null}],m),{});return[{name:r+Dw+"_bg",type:"rect",clip:!0,encode:{enter:{fill:{value:f},fillOpacity:{value:d}},update:l}},...n,{name:r+Dw,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},h?{cursor:{value:h}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},l),g)}}]}};function hyt(e,t,n,r){const i=n.channel,a=n.signals.visual,o=n.signals.data,s=nh.has(t),u=gn(e.scaleName(i)),l=e.getScaleComponent(i),c=l?l.get("type"):void 0,f=g=>`scale(${u}, ${g})`,d=e.getSizeSignalRef(i===br?"width":"height").signal,h=`${i}(unit)`,p=uve(t,(g,m)=>[...g,{events:m.between[0],update:`[${h}, ${h}]`},{events:m,update:`[${a}[0], clamp(${h}, 0, ${d})]`}]);return p.push({events:{signal:t.name+Z8},update:Es(c)?`[${f(`${o}[0]`)}, ${f(`${o}[1]`)}]`:"[0, 0]"}),s?[{name:o,on:[]}]:[Object.assign(Object.assign({name:a},r?{init:x0(r,!0,f)}:{value:[]}),{on:p}),Object.assign(Object.assign({name:o},r?{init:x0(r)}:{}),{on:[{events:{signal:a},update:`${a}[0] === ${a}[1] ? null : invert(${u}, ${a})`}]})]}function uve(e,t){return e.events.reduce((n,r)=>r.between?t(n,r):(Me(`${r} is not an ordered event stream for interval selections.`),n),[])}function lve(e,t){const n=t.name,r=n+Nw,i=t.project,a="(item().isVoronoi ? datum.datum : datum)",o=i.items.map(l=>{const c=e.fieldDef(l.channel);return c&&c.bin?`[${a}[${gn(e.vgField(l.channel,{}))}], ${a}[${gn(e.vgField(l.channel,{binSuffix:"end"}))}]]`:`${a}[${gn(l.field)}]`}).join(", "),s=`unit: ${Yc(e)}, fields: ${r}, values`,u=t.events;return[{name:n+$l,on:u?[{events:u,update:`datum && item().mark.marktype !== 'group' ? {${s}: [${o}]} : null`,force:!0}]:[]}]}const pyt={signals:lve,modifyExpr:(e,t)=>t.name+$l+", "+(t.resolve==="global"?"null":`{unit: ${Yc(e)}}`)},gyt={signals:lve,modifyExpr:(e,t)=>t.name+$l+", "+(t.resolve==="global"?"true":`{unit: ${Yc(e)}}`)},fg="_store",$l="_tuple",myt="_modify",cve="vlSelectionResolve",vyt={single:gyt,multi:pyt,interval:dyt};function dg(e,t){const n=e.component.selection;if(n){for(const r of Bd(n))if(t(r,vyt[r.type])===!0)break}}function yyt(e){let t=e.parent;for(;t&&!Eu(t);)t=t.parent;return t}function Yc(e,{escape:t}={escape:!0}){let n=t?gn(e.name):e.name;const r=yyt(e);if(r){const{facet:i}=r;for(const a of _s)i[a]&&(n+=` + '__facet_${a}_' + (facet[${gn(r.vgField(a))}])`)}return n}function J8(e){let t=!1;return dg(e,n=>{t=t||n.project.items.some(r=>r.field===b0)}),t}const byt="RawCode",xyt="Literal",wyt="Property",_yt="Identifier",Syt="ArrayExpression",Eyt="BinaryExpression",Cyt="CallExpression",Ayt="ConditionalExpression",kyt="LogicalExpression",Tyt="MemberExpression",Oyt="ObjectExpression",Iyt="UnaryExpression";function wu(e){this.type=e}wu.prototype.visit=function(e){let t,n,r;if(e(this))return 1;for(t=Nyt(this),n=0,r=t.length;n<r;++n)if(t[n].visit(e))return 1};function Nyt(e){switch(e.type){case Syt:return e.elements;case Eyt:case kyt:return[e.left,e.right];case Cyt:return[e.callee].concat(e.arguments);case Ayt:return[e.test,e.consequent,e.alternate];case Tyt:return[e.object,e.property];case Oyt:return e.properties;case wyt:return[e.key,e.value];case Iyt:return[e.argument];case _yt:case xyt:case byt:default:return[]}}var Ll,ot,_e,la,jn,VO=1,Rw=2,hg=3,rh=4,qO=5,pg=6,xo=7,Fw=8,Dyt=9;Ll={},Ll[VO]="Boolean",Ll[Rw]="<end>",Ll[hg]="Identifier",Ll[rh]="Keyword",Ll[qO]="Null",Ll[pg]="Numeric",Ll[xo]="Punctuator",Ll[Fw]="String",Ll[Dyt]="RegularExpression";var Ryt="ArrayExpression",Fyt="BinaryExpression",Myt="CallExpression",Pyt="ConditionalExpression",fve="Identifier",$yt="Literal",Lyt="LogicalExpression",Byt="MemberExpression",zyt="ObjectExpression",jyt="Property",Uyt="UnaryExpression",Wi="Unexpected token %0",Wyt="Unexpected number",Vyt="Unexpected string",qyt="Unexpected identifier",Hyt="Unexpected reserved word",Gyt="Unexpected end of input",Q8="Invalid regular expression",e9="Invalid regular expression: missing /",dve="Octal literals are not allowed in strict mode.",Kyt="Duplicate data property in object literal not allowed in strict mode",ca="ILLEGAL",Mw="Disabled.",Xyt=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),Yyt=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function HO(e,t){if(!e)throw new Error("ASSERT: "+t)}function Zc(e){return e>=48&&e<=57}function t9(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function Pw(e){return"01234567".indexOf(e)>=0}function Zyt(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function $w(e){return e===10||e===13||e===8232||e===8233}function Lw(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&Xyt.test(String.fromCharCode(e))}function GO(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&Yyt.test(String.fromCharCode(e))}var Jyt={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function hve(){for(var e;_e<la&&(e=ot.charCodeAt(_e),Zyt(e)||$w(e));)++_e}function n9(e){var t,n,r,i=0;for(n=e==="u"?4:2,t=0;t<n;++t)_e<la&&t9(ot[_e])?(r=ot[_e++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):Nn({},Wi,ca);return String.fromCharCode(i)}function Qyt(){var e,t,n,r;for(e=ot[_e],t=0,e==="}"&&Nn({},Wi,ca);_e<la&&(e=ot[_e++],!!t9(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&Nn({},Wi,ca),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function pve(){var e,t;for(e=ot.charCodeAt(_e++),t=String.fromCharCode(e),e===92&&(ot.charCodeAt(_e)!==117&&Nn({},Wi,ca),++_e,e=n9("u"),(!e||e==="\\"||!Lw(e.charCodeAt(0)))&&Nn({},Wi,ca),t=e);_e<la&&(e=ot.charCodeAt(_e),!!GO(e));)++_e,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),ot.charCodeAt(_e)!==117&&Nn({},Wi,ca),++_e,e=n9("u"),(!e||e==="\\"||!GO(e.charCodeAt(0)))&&Nn({},Wi,ca),t+=e);return t}function ebt(){var e,t;for(e=_e++;_e<la;){if(t=ot.charCodeAt(_e),t===92)return _e=e,pve();if(GO(t))++_e;else break}return ot.slice(e,_e)}function tbt(){var e,t,n;return e=_e,t=ot.charCodeAt(_e)===92?pve():ebt(),t.length===1?n=hg:Jyt.hasOwnProperty(t)?n=rh:t==="null"?n=qO:t==="true"||t==="false"?n=VO:n=hg,{type:n,value:t,start:e,end:_e}}function r9(){var e=_e,t=ot.charCodeAt(_e),n,r=ot[_e],i,a,o;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++_e,{type:xo,value:String.fromCharCode(t),start:e,end:_e};default:if(n=ot.charCodeAt(_e+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return _e+=2,{type:xo,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:_e};case 33:case 61:return _e+=2,ot.charCodeAt(_e)===61&&++_e,{type:xo,value:ot.slice(e,_e),start:e,end:_e}}}if(o=ot.substr(_e,4),o===">>>=")return _e+=4,{type:xo,value:o,start:e,end:_e};if(a=o.substr(0,3),a===">>>"||a==="<<="||a===">>=")return _e+=3,{type:xo,value:a,start:e,end:_e};if(i=a.substr(0,2),r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>")return _e+=2,{type:xo,value:i,start:e,end:_e};if("<>=!+-*%&|^/".indexOf(r)>=0)return++_e,{type:xo,value:r,start:e,end:_e};Nn({},Wi,ca)}function nbt(e){for(var t="";_e<la&&t9(ot[_e]);)t+=ot[_e++];return t.length===0&&Nn({},Wi,ca),Lw(ot.charCodeAt(_e))&&Nn({},Wi,ca),{type:pg,value:parseInt("0x"+t,16),start:e,end:_e}}function rbt(e){for(var t="0"+ot[_e++];_e<la&&Pw(ot[_e]);)t+=ot[_e++];return(Lw(ot.charCodeAt(_e))||Zc(ot.charCodeAt(_e)))&&Nn({},Wi,ca),{type:pg,value:parseInt(t,8),octal:!0,start:e,end:_e}}function gve(){var e,t,n;if(n=ot[_e],HO(Zc(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=_e,e="",n!=="."){if(e=ot[_e++],n=ot[_e],e==="0"){if(n==="x"||n==="X")return++_e,nbt(t);if(Pw(n))return rbt(t);n&&Zc(n.charCodeAt(0))&&Nn({},Wi,ca)}for(;Zc(ot.charCodeAt(_e));)e+=ot[_e++];n=ot[_e]}if(n==="."){for(e+=ot[_e++];Zc(ot.charCodeAt(_e));)e+=ot[_e++];n=ot[_e]}if(n==="e"||n==="E")if(e+=ot[_e++],n=ot[_e],(n==="+"||n==="-")&&(e+=ot[_e++]),Zc(ot.charCodeAt(_e)))for(;Zc(ot.charCodeAt(_e));)e+=ot[_e++];else Nn({},Wi,ca);return Lw(ot.charCodeAt(_e))&&Nn({},Wi,ca),{type:pg,value:parseFloat(e),start:t,end:_e}}function ibt(){var e="",t,n,r,i,a=!1;for(t=ot[_e],HO(t==="'"||t==='"',"String literal must starts with a quote"),n=_e,++_e;_e<la;)if(r=ot[_e++],r===t){t="";break}else if(r==="\\")if(r=ot[_e++],!r||!$w(r.charCodeAt(0)))switch(r){case"u":case"x":ot[_e]==="{"?(++_e,e+=Qyt()):e+=n9(r);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:Pw(r)?(i="01234567".indexOf(r),i!==0&&(a=!0),_e<la&&Pw(ot[_e])&&(a=!0,i=i*8+"01234567".indexOf(ot[_e++]),"0123".indexOf(r)>=0&&_e<la&&Pw(ot[_e])&&(i=i*8+"01234567".indexOf(ot[_e++]))),e+=String.fromCharCode(i)):e+=r;break}else r==="\r"&&ot[_e]===`
`&&++_e;else{if($w(r.charCodeAt(0)))break;e+=r}return t!==""&&Nn({},Wi,ca),{type:Fw,value:e,octal:a,start:n,end:_e}}function abt(e,t){var n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,function(r,i){if(parseInt(i,16)<=1114111)return"x";Nn({},Q8)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){Nn({},Q8)}try{return new RegExp(e,t)}catch(r){return null}}function obt(){var e,t,n,r,i;for(e=ot[_e],HO(e==="/","Regular expression literal must start with a slash"),t=ot[_e++],n=!1,r=!1;_e<la;)if(e=ot[_e++],t+=e,e==="\\")e=ot[_e++],$w(e.charCodeAt(0))&&Nn({},e9),t+=e;else if($w(e.charCodeAt(0)))Nn({},e9);else if(n)e==="]"&&(n=!1);else if(e==="/"){r=!0;break}else e==="["&&(n=!0);return r||Nn({},e9),i=t.substr(1,t.length-2),{value:i,literal:t}}function sbt(){var e,t,n;for(t="",n="";_e<la&&(e=ot[_e],!!GO(e.charCodeAt(0)));)++_e,e==="\\"&&_e<la?Nn({},Wi,ca):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&Nn({},Q8,n),{value:n,literal:t}}function ubt(){var e,t,n,r;return jn=null,hve(),e=_e,t=obt(),n=sbt(),r=abt(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:_e}}function lbt(e){return e.type===hg||e.type===rh||e.type===VO||e.type===qO}function mve(){var e;return hve(),_e>=la?{type:Rw,start:_e,end:_e}:(e=ot.charCodeAt(_e),Lw(e)?tbt():e===40||e===41||e===59?r9():e===39||e===34?ibt():e===46?Zc(ot.charCodeAt(_e+1))?gve():r9():Zc(e)?gve():r9())}function wo(){var e;return e=jn,_e=e.end,jn=mve(),_e=e.end,e}function vve(){var e;e=_e,jn=mve(),_e=e}function cbt(e){var t=new wu(Ryt);return t.elements=e,t}function yve(e,t,n){var r=new wu(e==="||"||e==="&&"?Lyt:Fyt);return r.operator=e,r.left=t,r.right=n,r}function fbt(e,t){var n=new wu(Myt);return n.callee=e,n.arguments=t,n}function dbt(e,t,n){var r=new wu(Pyt);return r.test=e,r.consequent=t,r.alternate=n,r}function i9(e){var t=new wu(fve);return t.name=e,t}function Bw(e){var t=new wu($yt);return t.value=e.value,t.raw=ot.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function bve(e,t,n){var r=new wu(Byt);return r.computed=e==="[",r.object=t,r.property=n,r.computed||(n.member=!0),r}function hbt(e){var t=new wu(zyt);return t.properties=e,t}function xve(e,t,n){var r=new wu(jyt);return r.key=t,r.value=n,r.kind=e,r}function pbt(e,t){var n=new wu(Uyt);return n.operator=e,n.argument=t,n.prefix=!0,n}function Nn(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,function(a,o){return HO(o<r.length,"Message reference must be in range"),r[o]});throw n=new Error(i),n.index=_e,n.description=i,n}function KO(e){e.type===Rw&&Nn(e,Gyt),e.type===pg&&Nn(e,Wyt),e.type===Fw&&Nn(e,Vyt),e.type===hg&&Nn(e,qyt),e.type===rh&&Nn(e,Hyt),Nn(e,Wi,e.value)}function fa(e){var t=wo();(t.type!==xo||t.value!==e)&&KO(t)}function ar(e){return jn.type===xo&&jn.value===e}function a9(e){return jn.type===rh&&jn.value===e}function gbt(){var e=[];for(_e=jn.start,fa("[");!ar("]");)ar(",")?(wo(),e.push(null)):(e.push(gg()),ar("]")||fa(","));return wo(),cbt(e)}function wve(){var e;return _e=jn.start,e=wo(),e.type===Fw||e.type===pg?(e.octal&&Nn(e,dve),Bw(e)):i9(e.value)}function mbt(){var e,t,n,r;if(_e=jn.start,e=jn,e.type===hg)return n=wve(),fa(":"),r=gg(),xve("init",n,r);if(e.type===Rw||e.type===xo)KO(e);else return t=wve(),fa(":"),r=gg(),xve("init",t,r)}function vbt(){var e=[],t,n,r,i={},a=String;for(_e=jn.start,fa("{");!ar("}");)t=mbt(),t.key.type===fve?n=t.key.name:n=a(t.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?Nn({},Kyt):i[r]=!0,e.push(t),ar("}")||fa(",");return fa("}"),hbt(e)}function ybt(){var e;return fa("("),e=o9(),fa(")"),e}var bbt={if:1};function xbt(){var e,t,n;if(ar("("))return ybt();if(ar("["))return gbt();if(ar("{"))return vbt();if(e=jn.type,_e=jn.start,e===hg||bbt[jn.value])n=i9(wo().value);else if(e===Fw||e===pg)jn.octal&&Nn(jn,dve),n=Bw(wo());else{if(e===rh)throw new Error(Mw);e===VO?(t=wo(),t.value=t.value==="true",n=Bw(t)):e===qO?(t=wo(),t.value=null,n=Bw(t)):ar("/")||ar("/=")?(n=Bw(ubt()),vve()):KO(wo())}return n}function wbt(){var e=[];if(fa("("),!ar(")"))for(;_e<la&&(e.push(gg()),!ar(")"));)fa(",");return fa(")"),e}function _bt(){var e;return _e=jn.start,e=wo(),lbt(e)||KO(e),i9(e.value)}function Sbt(){return fa("."),_bt()}function Ebt(){var e;return fa("["),e=o9(),fa("]"),e}function Cbt(){var e,t,n;for(e=xbt();;)if(ar("."))n=Sbt(),e=bve(".",e,n);else if(ar("("))t=wbt(),e=fbt(e,t);else if(ar("["))n=Ebt(),e=bve("[",e,n);else break;return e}function _ve(){var e=Cbt();if(jn.type===xo&&(ar("++")||ar("--")))throw new Error(Mw);return e}function XO(){var e,t;if(jn.type!==xo&&jn.type!==rh)t=_ve();else{if(ar("++")||ar("--"))throw new Error(Mw);if(ar("+")||ar("-")||ar("~")||ar("!"))e=wo(),t=XO(),t=pbt(e.value,t);else{if(a9("delete")||a9("void")||a9("typeof"))throw new Error(Mw);t=_ve()}}return t}function Sve(e){var t=0;if(e.type!==xo&&e.type!==rh)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function Abt(){var e,t,n,r,i,a,o,s,u,l;if(e=jn,u=XO(),r=jn,i=Sve(r),i===0)return u;for(r.prec=i,wo(),t=[e,jn],o=XO(),a=[u,r,o];(i=Sve(jn))>0;){for(;a.length>2&&i<=a[a.length-2].prec;)o=a.pop(),s=a.pop().value,u=a.pop(),t.pop(),n=yve(s,u,o),a.push(n);r=wo(),r.prec=i,a.push(r),t.push(jn),n=XO(),a.push(n)}for(l=a.length-1,n=a[l],t.pop();l>1;)t.pop(),n=yve(a[l-1].value,a[l-2],n),l-=2;return n}function gg(){var e,t,n;return e=Abt(),ar("?")&&(wo(),t=gg(),fa(":"),n=gg(),e=dbt(e,t,n)),e}function o9(){var e=gg();if(ar(","))throw new Error(Mw);return e}function kbt(e){ot=e,_e=0,la=ot.length,jn=null,vve();var t=o9();if(jn.type!==Rw)throw new Error("Unexpect token after expression.");return t}function w0(e,t,n){return e.fields=t||[],e.fname=n,e}function Tbt(e){return e.length===1?Obt(e[0]):Ibt(e)}const Obt=e=>function(t){return t[e]},Ibt=e=>{const t=e.length;return function(n){for(let r=0;r<t;++r)n=n[e[r]];return n}};function s9(e){throw Error(e)}function Nbt(e){const t=[],n=e.length;let r=null,i=0,a="",o,s,u;e=e+"";function l(){t.push(a+e.substring(o,s)),a="",o=s+1}for(o=s=0;s<n;++s)if(u=e[s],u==="\\")a+=e.substring(o,s),a+=e.substring(++s,++s),o=s;else if(u===r)l(),r=null,i=-1;else{if(r)continue;o===i&&u==='"'||o===i&&u==="'"?(o=s+1,r=u):u==="."&&!i?s>o?l():o=s+1:u==="["?(s>o&&l(),i=o=s+1):u==="]"&&(i||s9("Access path missing open bracket: "+e),i>0&&l(),i=0,o=s+1)}return i&&s9("Access path missing closing bracket: "+e),r&&s9("Access path missing closing quote: "+e),s>o&&(s++,l()),t}function Dbt(e,t,n){const r=Nbt(e);return e=r.length===1?r[0]:e,w0((n&&n.get||Tbt)(r),[e],t||e)}Dbt("id"),w0(e=>e,[],"identity"),w0(()=>0,[],"zero"),w0(()=>1,[],"one"),w0(()=>!0,[],"true"),w0(()=>!1,[],"false");function u9(e){const t=[];return e.type==="Identifier"?[e.name]:e.type==="Literal"?[e.value]:(e.type==="MemberExpression"&&(t.push(...u9(e.object)),t.push(...u9(e.property))),t)}function Eve(e){return e.object.type==="MemberExpression"?Eve(e.object):e.object.name==="datum"}function Cve(e){const t=kbt(e),n=new Set;return t.visit(r=>{r.type==="MemberExpression"&&Eve(r)&&n.add(u9(r).slice(1).join("."))}),n}class _0 extends qn{constructor(t,n,r){super(t);this.model=n,this.filter=r,this.expr=YO(this.model,this.filter,this),this._dependentFields=Cve(this.expr)}clone(){return new _0(null,this.model,Yt(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function Rbt(e,t){var n;const r={},i=e.config.selection;for(const a of Be(t??{})){const o=Yt(t[a]),s=i[o.type],u=dt(s,["fields","encodings"]);for(const f in u)f==="encodings"&&o.fields||f==="fields"&&o.encodings||(f==="mark"&&(o[f]=Object.assign(Object.assign({},u[f]),o[f])),(o[f]===void 0||o[f]===!0)&&(o[f]=(n=u[f])!==null&&n!==void 0?n:o[f]));const l=fr(a),c=r[l]=Object.assign(Object.assign({},o),{name:l,events:Xt(o.on)?Pd(o.on,"scope"):Yt(o.on)});WO(c,f=>{f.has(c)&&f.parse&&f.parse(e,c,o,t[a])})}return r}function Ave(e,t,n,r="datum"){const i=[];function a(s){const u=fr(s),l=e.getSelectionComponent(u,s),c=gn(u+fg);if(l.project.timeUnit){const f=n??e.component.data.raw,d=l.project.timeUnit.clone();f.parent?d.insertAsParentOf(f):f.parent=d}return l.empty!=="none"&&i.push(c),`vlSelectionTest(${c}, ${r}`+(l.resolve==="global"?")":`, ${gn(l.resolve)})`)}const o=pw(t,a);return(i.length?"!("+i.map(s=>`length(data(${s}))`).join(" || ")+") || ":"")+`(${o})`}function kve(e,t){const n=t.encoding;let r=t.field;if(!n&&!r)r=e.project.items[0].field,e.project.items.length>1&&Me(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${gn(r)}.`);else if(n&&!r){const i=e.project.items.filter(a=>a.channel===n);!i.length||i.length>1?(r=e.project.items[0].field,Me((i.length?"Multiple ":"No ")+`matching ${gn(n)} encoding found for selection ${gn(t.selection)}. Using "field": ${gn(r)}.`)):r=i[0].field}return`${e.name}[${gn(r)}]`}function Fbt(e,t){dg(e,n=>{const r=n.name,i=e.getName(`lookup_${r}`);e.component.data.outputNodes[i]=n.materialized=new qa(new _0(t,e,{selection:r}),i,"lookup",e.component.data.outputNodeRefCounts)})}function YO(e,t,n){return pw(t,r=>Xt(r)?r:wmt(r)?Ave(e,r.selection,n):yge(r))}function Mbt(e,t){if(!!e)return vt(e)&&!Qd(e)?e.map(n=>Gge(n,t)).join(", "):e}function l9(e,t,n,r){var i,a,o;e.encode=(i=e.encode)!==null&&i!==void 0?i:{},e.encode[t]=(a=e.encode[t])!==null&&a!==void 0?a:{},e.encode[t].update=(o=e.encode[t].update)!==null&&o!==void 0?o:{},e.encode[t].update[n]=r}function zw(e,t,n,r={header:!1}){var i,a;const o=e.combine(),{disable:s,orient:u,scale:l,labelExpr:c,title:f,zindex:d}=o,h=dt(o,["disable","orient","scale","labelExpr","title","zindex"]);if(!s){for(const p in h){const g=bpt[p],m=h[p];if(g&&g!==t&&g!=="both")delete h[p];else if(Uj(m)){const{condition:v}=m,y=dt(m,["condition"]),b=Br(v),x=_pe[p];if(x){const{vgProp:w,part:S}=x,C=[...b.map(_=>{const{test:E}=_,A=dt(_,["test"]);return Object.assign({test:YO(null,E)},A)}),y];l9(h,S,w,C),delete h[p]}else if(x===null){const w={signal:b.map(S=>{const{test:C}=S,_=dt(S,["test"]);return`${YO(null,C)} ? ${Zge(_)} : `}).join("")+Zge(y)};h[p]=w}}else if(Et(m)){const v=_pe[p];if(v){const{vgProp:y,part:b}=v;l9(h,b,y,m),delete h[p]}}}if(t==="grid"){if(!h.grid)return;if(h.encode){const{grid:p}=h.encode;h.encode=Object.assign({},p?{grid:p}:{}),Yn(h.encode)&&delete h.encode}return Object.assign(Object.assign({scale:l,orient:u},h),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:Qr(d,0)})}else{if(!r.header&&e.mainExtracted)return;if(c!==void 0){let g=c;((a=(i=h.encode)===null||i===void 0?void 0:i.labels)===null||a===void 0?void 0:a.update)&&Et(h.encode.labels.update.text)&&(g=d0(c,"datum.label",h.encode.labels.update.text.signal)),l9(h,"labels","text",{signal:g})}if(h.labelAlign===null&&delete h.labelAlign,h.encode){for(const g of Spe)e.hasAxisPart(g)||delete h.encode[g];Yn(h.encode)&&delete h.encode}const p=Mbt(f,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:l,orient:u,grid:!1},p?{title:p}:{}),h),n.aria===!1?{aria:!1}:{}),{zindex:Qr(d,0)})}}}function Tve(e){const{axes:t}=e.component,n=[];for(const r of Ss)if(t[r]){for(const i of t[r])if(!i.get("disable")&&!i.get("gridScale")){const a=r==="x"?"height":"width",o=e.getSizeSignalRef(a).signal;a!==o&&n.push({name:a,update:o})}}return n}function Pbt(e,t){const{x:n=[],y:r=[]}=e;return[...n.map(i=>zw(i,"grid",t)),...r.map(i=>zw(i,"grid",t)),...n.map(i=>zw(i,"main",t)),...r.map(i=>zw(i,"main",t))].filter(i=>i)}const Ove={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},Ive={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},$bt=Be(Ove),Lbt=Be(Ive);function Nve(e,t,n,r){return Object.assign.apply(null,[{},...e.map(i=>{if(i==="axisOrient"){const a=n==="x"?"bottom":"left",o=t[n==="x"?"axisBottom":"axisLeft"]||{},s=t[n==="x"?"axisTop":"axisRight"]||{},u=new Set([...Be(o),...Be(s)]),l={};for(const c of u.values())l[c]={signal:`${r.signal} === "${a}" ? ${Cw(o[c])} : ${Cw(s[c])}`};return l}return t[i]})])}function Bbt(e,t,n,r){const i=t==="band"?["axisDiscrete","axisBand"]:t==="point"?["axisDiscrete","axisPoint"]:Rmt(t)?["axisQuantitative"]:t==="time"||t==="utc"?["axisTemporal"]:[],a=e==="x"?"axisX":"axisY",o=Et(n)?"axisOrient":"axis"+tO(n),s=[...i,...i.map(l=>a+l.substr(4))],u=["axis",o,a];return{vlOnlyAxisConfig:Nve(s,r,e,n),vgAxisConfig:Nve(u,r,e,n),axisConfigStyle:zbt([...u,...s],r)}}function zbt(e,t){var n;const r=[{}];for(const i of e){let a=(n=t[i])===null||n===void 0?void 0:n.style;if(a){a=Br(a);for(const o of a)r.push(t.style[o])}}return Object.assign.apply(null,r)}function c9(e,t,n,r={}){var i;const a=Qge(e,n,t.style);if(a!==void 0)return{configFrom:"style",configValue:a};for(const o of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(((i=r[o])===null||i===void 0?void 0:i[e])!==void 0)return{configFrom:o,configValue:r[o][e]};return{}}const Dve={scale:({model:e,channel:t})=>e.scaleName(t),format:({fieldOrDatumDef:e,config:t,axis:n})=>{const{format:r,formatType:i}=n;return Ige(e,e.type,r,i,t,!0)},formatType:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:r}=e;return Nge(r,t,n)},grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>{var r;return We(e)&&Wa(e.bin)?!1:(r=t.grid)!==null&&r!==void 0?r:jbt(n,e)},gridScale:({model:e,channel:t})=>Ubt(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelAlign||Fve(t,n,r),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:r})=>e.labelBaseline||Rve(t,n,r),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>{var r;return(r=e.labelFlush)!==null&&r!==void 0?r:Vbt(t.type,n)},labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{var r;return(r=e.labelOverlap)!==null&&r!==void 0?r:qbt(t.type,n)},orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:r,scaleType:i})=>{var a;const o=e==="x"?"width":e==="y"?"height":void 0,s=o?t.getSizeSignalRef(o):void 0;return(a=n.tickCount)!==null&&a!==void 0?a:Gbt({fieldOrDatumDef:r,scaleType:i,size:s,values:n.values})},title:({axis:e,model:t,channel:n})=>{if(e.title!==void 0)return e.title;const r=Mve(t,n);if(r!==void 0)return r;const i=t.typedFieldDef(n),a=n==="x"?"x2":"y2",o=t.fieldDef(a);return tme(i?[Lge(i)]:[],We(o)?[Lge(o)]:[])},values:({axis:e,fieldOrDatumDef:t})=>Kbt(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>{var r;return(r=e.zindex)!==null&&r!==void 0?r:Xbt(n,t)}};function jbt(e,t){return!bo(e)&&We(t)&&!Qn(t==null?void 0:t.bin)}function Ubt(e,t){const n=t==="x"?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}function Wbt(e,t,n,r,i){const a=t==null?void 0:t.labelAngle;if(a!==void 0)return Et(a)?a:nO(a);{const{configValue:o}=c9("labelAngle",e.config,t==null?void 0:t.style,i);return o!==void 0?nO(o):n===br&&bt([c8,l8],r.type)?270:void 0}}function f9(e){return`(((${e.signal} % 360) + 360) % 360)`}function Rve(e,t,n,r){if(e!==void 0)if(n==="x"){if(Et(e)){const i=f9(e),a=Et(t)?`(${t.signal} === "top")`:t==="top";return{signal:`(45 < ${i} && ${i} < 135) || (225 < ${i} && ${i} < 315) ? "middle" :(${i} <= 45 || 315 <= ${i}) === ${a} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(Et(t)){const i=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${i} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==(t==="top")?"bottom":"top"}else{if(Et(e)){const i=f9(e),a=Et(t)?`(${t.signal} === "left")`:t==="left";return{signal:`${i} <= 45 || 315 <= ${i} || (135 <= ${i} && ${i} <= 225) ? ${r?'"middle"':"null"} : (45 <= ${i} && ${i} <= 135) === ${a} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return r?"middle":null;if(Et(t)){const i=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${i} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==(t==="left")?"top":"bottom"}}function Fve(e,t,n){if(e===void 0)return;const r=n==="x",i=r?0:90,a=r?"bottom":"left";if(Et(e)){const o=f9(e),s=Et(t)?`(${t.signal} === "${a}")`:t===a;return{signal:`(${i?"("+o+" + 90)":o} % 180 === 0) ? ${r?null:'"center"'} :(${i} < ${o} && ${o} < ${180+i}) === ${s} ? "left" : "right"`}}if((e+i)%180==0)return r?null:"center";if(Et(t)){const o=i<e&&e<180+i?"===":"!==";return{signal:`${`${t.signal} ${o} "${a}"`} ? "left" : "right"`}}return(i<e&&e<180+i)==(t===a)?"left":"right"}function Vbt(e,t){if(t==="x"&&bt(["quantitative","temporal"],e))return!0}function qbt(e,t){if(e!=="nominal")return t==="log"?"greedy":!0}function Hbt(e){return e==="x"?"bottom":"left"}function Gbt({fieldOrDatumDef:e,scaleType:t,size:n,values:r}){var i;if(!r&&!bo(t)&&t!=="log"){if(We(e)){if(Qn(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&bt(["month","hours","day","quarter"],(i=Va(e.timeUnit))===null||i===void 0?void 0:i.unit))return}return{signal:`ceil(${n.signal}/40)`}}}function Mve(e,t){const n=t==="x"?"x2":"y2",r=e.fieldDef(t),i=e.fieldDef(n),a=r?r.title:void 0,o=i?i.title:void 0;if(a&&o)return nme(a,o);if(a)return a;if(o)return o;if(a!==void 0)return a;if(o!==void 0)return o}function Kbt(e,t){const n=e.values;if(vt(n))return Xge(t,n);if(Et(n))return n}function Xbt(e,t){return e==="rect"&&Uge(t)?1:0}class S0 extends qn{constructor(t,n){super(t);this.transform=n,this._dependentFields=Cve(this.transform.calculate)}clone(){return new S0(null,Yt(this.transform))}static parseAllForSortIndex(t,n){return n.forEachFieldDef((r,i)=>{if(!!w8(r)&&$ge(r.sort)){const{field:a,timeUnit:o}=r,s=r.sort,u=s.map((l,c)=>`${yge({field:a,timeUnit:o,equal:l})} ? ${c} : `).join("")+s.length;t=new S0(t,{calculate:u,as:E0(r,i,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${yn(this.transform)}`}}function E0(e,t,n){return Ue(e,Object.assign({prefix:t,suffix:"sort_index"},n??{}))}function ZO(e,t){return bt(["top","bottom"],t)?"column":bt(["left","right"],t)||e==="row"?"row":"column"}function C0(e,t,n,r){const i=r==="row"?n.headerRow:r==="column"?n.headerColumn:n.headerFacet;return Qr(((t==null?void 0:t.header)||{})[e],i[e],n.header[e])}function JO(e,t,n,r){const i={};for(const a of e){const o=C0(a,t,n,r);o!==void 0&&(i[a]=o)}return i}const d9=["row","column"],h9=["header","footer"];function Ybt(e,t){const n=e.component.layoutHeaders[t].title,r=e.config?e.config:void 0,i=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:a,titleAngle:o,titleOrient:s}=JO(["titleAnchor","titleAngle","titleOrient"],i,r,t),u=ZO(t,s),l=nO(o);return{name:`${t}-title`,type:"group",role:`${u}-title`,title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},t==="row"?{orient:"left"}:{}),{style:"guide-title"}),$ve(l,u)),Pve(u,l,a)),Lve(r,i,t,$bt,Ove))}}function Pve(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const r=Fve(t,e==="row"?"left":"top",e==="row"?"y":"x");return r?{align:r}:{}}function $ve(e,t){const n=Rve(e,t==="row"?"left":"top",t==="row"?"y":"x",!0);return n?{baseline:n}:{}}function Zbt(e,t){const n=e.component.layoutHeaders[t],r=[];for(const i of h9)if(n[i])for(const a of n[i]){const o=Qbt(e,t,i,n,a);o!=null&&r.push(o)}return r}function Jbt(e,t){var n;const{sort:r}=e;return Dl(r)?{field:Ue(r,{expr:"datum"}),order:(n=r.order)!==null&&n!==void 0?n:"ascending"}:vt(r)?{field:E0(e,t,{expr:"datum"}),order:"ascending"}:{field:Ue(e,{expr:"datum"}),order:r??"ascending"}}function p9(e,t,n){const{format:r,formatType:i,labelAngle:a,labelAnchor:o,labelOrient:s,labelExpr:u}=JO(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e,n,t),l=p8({fieldOrDatumDef:e,format:r,formatType:i,expr:"parent",config:n}).signal,c=ZO(t,s);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:u?d0(d0(u,"datum.label",l),"datum.value",Ue(e,{expr:"parent"})):l}},t==="row"?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),$ve(a,c)),Pve(c,a,o)),Lve(n,e,t,Lbt,Ive))}function Qbt(e,t,n,r,i){if(i){let a=null;const{facetFieldDef:o}=r,s=e.config?e.config:void 0;if(o&&i.labels){const{labelOrient:f}=JO(["labelOrient"],o,s,t);(t==="row"&&!bt(["top","bottom"],f)||t==="column"&&!bt(["left","right"],f))&&(a=p9(o,t,s))}const u=Eu(e)&&!_w(e.facet),l=i.axes,c=(l==null?void 0:l.length)>0;if(a||c){const f=t==="row"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`},r.facetFieldDef?{from:{data:e.getName(t+"_domain")},sort:Jbt(o,t)}:{}),c&&u?{from:{data:e.getName(`facet_domain_${t}`)}}:{}),a?{title:a}:{}),i.sizeSignal?{encode:{update:{[f]:i.sizeSignal}}}:{}),c?{axes:l}:{})}}return null}const e1t={column:{start:0,end:1},row:{start:1,end:0}};function t1t(e,t){return e1t[t][e]}function n1t(e,t){const n={};for(const r of _s){const i=e[r];if(i==null?void 0:i.facetFieldDef){const{titleAnchor:a,titleOrient:o}=JO(["titleAnchor","titleOrient"],i.facetFieldDef,t,r),s=ZO(r,o),u=t1t(a,s);u!==void 0&&(n[s]=u)}}return Yn(n)?void 0:n}function Lve(e,t,n,r,i){const a={};for(const o of r){if(!i[o])continue;const s=C0(o,t,e,n);s!==void 0&&(a[i[o]]=s)}return a}function g9(e){return[...QO(e,"width"),...QO(e,"height"),...QO(e,"childWidth"),...QO(e,"childHeight")]}function QO(e,t){const n=t==="width"?"x":"y",r=e.component.layoutSize.get(t);if(!r||r==="merged")return[];const i=e.getSizeSignalRef(t).signal;if(r==="step"){const a=e.getScaleComponent(n);if(a){const o=a.get("type"),s=a.get("range");if(bo(o)&&Xd(s)){const u=e.scaleName(n);return Eu(e.parent)&&e.parent.component.resolve.scale[n]==="independent"?[Bve(u,s)]:[Bve(u,s),{name:i,update:zve(u,a,`domain('${u}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}else if(r=="container"){const a=i.endsWith("width"),o=a?"containerSize()[0]":"containerSize()[1]",s=L8(e.config.view,a?"width":"height"),u=`isFinite(${o}) ? ${o} : ${s}`;return[{name:i,init:u,on:[{update:u,events:"window:resize"}]}]}else return[{name:i,value:r}]}function Bve(e,t){return{name:e+"_step",value:t.step}}function zve(e,t,n){const r=t.get("type"),i=t.get("padding"),a=Qr(t.get("paddingOuter"),i);let o=t.get("paddingInner");return o=r==="band"?o!==void 0?o:i:1,`bandspace(${n}, ${o}, ${a}) * ${e}_step`}function jve(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}function Uve(e,t){return Be(e).reduce((n,r)=>{const i=e[r];return Object.assign(Object.assign({},n),Tw(t,i,r,a=>Et(a)?a:{value:a.value}))},{})}function r1t(e,t){if(O0(t)||Eu(t))return"shared";if(T9(t))return Il(e)?"independent":"shared";throw new Error("invalid model type for resolve")}function m9(e,t){const n=e.scale[t],r=Il(t)?"axis":"legend";return n==="independent"?(e[r][t]==="shared"&&Me(zgt(t)),"independent"):e[r][t]||"shared"}const i1t=Object.assign(Object.assign({},Rvt),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),Wve=Be(i1t);class a1t extends Xc{}const Vve={symbols:o1t,gradient:s1t,labels:u1t,entries:l1t};function o1t(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i,legendType:a}){var o,s,u,l,c;if(a!=="symbol")return;const{markDef:f,encoding:d,config:h,mark:p}=n,g=f.filled&&p!=="trail";let m=Object.assign(Object.assign({},dvt({},n,Apt)),qme(n,{filled:g}));const v=(o=qve(d.opacity))!==null&&o!==void 0?o:f.opacity;if(m.fill){if(r==="fill"||g&&r===vo)delete m.fill;else if(m.fill.field)i.get("symbolFillColor")?delete m.fill:(m.fill=zr((s=h.legend.symbolBaseFillColor)!==null&&s!==void 0?s:"black"),m.fillOpacity=zr(v??1));else if(vt(m.fill)){const y=(c=(l=v9((u=d.fill)!==null&&u!==void 0?u:d.color))!==null&&l!==void 0?l:f.fill)!==null&&c!==void 0?c:g&&f.color;y&&(m.fill=zr(y))}}if(m.stroke){if(r==="stroke"||!g&&r===vo)delete m.stroke;else if(m.stroke.field)delete m.stroke;else if(vt(m.stroke)){const y=Qr(v9(d.stroke||d.color),f.stroke,g?f.color:void 0);y&&(m.stroke={value:y})}}if(r!==Hc){const y=We(t)&&Gve(n,i,t);y?m.opacity=[Object.assign({test:y},zr(v??1)),zr(h.legend.unselectedOpacity)]:v&&(m.opacity=zr(v))}return m=Object.assign(Object.assign({},m),e),Yn(m)?void 0:m}function s1t(e,{model:t,legendType:n}){if(n!=="gradient")return;let r={};const i=qve(t.encoding.opacity)||t.markDef.opacity;return i&&(r.opacity=zr(i)),r=Object.assign(Object.assign({},r),e),Yn(r)?void 0:r}function u1t(e,{fieldOrDatumDef:t,model:n,channel:r,legendCmpt:i}){const a=n.legend(r)||{},o=n.config,s=We(t)?Gve(n,i,t):void 0,u=s?[{test:s,value:1},{value:o.legend.unselectedOpacity}]:void 0,{format:l,formatType:c}=a,f=ig(c)?g8({fieldOrDatumDef:t,field:"datum.value",format:l,formatType:c,config:o}):void 0,d=Object.assign(Object.assign(Object.assign({},u?{opacity:u}:{}),f?{text:f}:{}),e);return Yn(d)?void 0:d}function l1t(e,{legendCmpt:t}){const n=t.get("selections");return(n==null?void 0:n.length)?Object.assign(Object.assign({},e),{fill:{value:"transparent"}}):e}function qve(e){return Hve(e,(t,n)=>Math.max(t,n.value))}function v9(e){return Hve(e,(t,n)=>Qr(t,n.value))}function Hve(e,t){if(nvt(e))return Br(e.condition).reduce(t,e.value);if(Gc(e))return e.value}function Gve(e,t,n){const r=t.get("selections");if(!(r==null?void 0:r.length))return;const i=gn(n.field);return r.map(a=>`(!length(data(${gn(fr(a)+fg)})) || (${a}[${i}] && indexof(${a}[${i}], datum.value) >= 0))`).join(" || ")}const Kve={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:r,formatType:i}=t;return Ige(e,e.type,r,i,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:r}=e;return Nge(r,t,n)},gradientLength:e=>{var t,n;const{legend:r,legendConfig:i}=e;return(n=(t=r.gradientLength)!==null&&t!==void 0?t:i.gradientLength)!==null&&n!==void 0?n:m1t(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>{var r,i;return(i=(r=e.labelOverlap)!==null&&r!==void 0?r:t.labelOverlap)!==null&&i!==void 0?i:v1t(n)},symbolType:({legend:e,markDef:t,channel:n,encoding:r})=>{var i;return(i=e.symbolType)!==null&&i!==void 0?i:f1t(t.type,n,r.shape,t.shape)},title:({fieldOrDatumDef:e,config:t})=>ag(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(h0(n)&&xu(t)){if(e==="gradient")return}else if(e==="symbol")return;return e},values:({fieldOrDatumDef:e,legend:t})=>c1t(t,e)};function c1t(e,t){const n=e.values;if(vt(n))return Xge(t,n);if(Et(n))return n}function f1t(e,t,n,r){var i;if(t!=="shape"){const a=(i=v9(n))!==null&&i!==void 0?i:r;if(a)return a}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function d1t(e){const{legend:t}=e;return Qr(t.type,h1t(e))}function h1t({channel:e,timeUnit:t,scaleType:n}){if(h0(e)){if(bt(["quarter","month","day"],t))return"symbol";if(xu(n))return"gradient"}return"symbol"}function p1t({legendConfig:e,legendType:t,orient:n,legend:r}){var i,a;return(a=(i=r.direction)!==null&&i!==void 0?i:e[t?"gradientDirection":"symbolDirection"])!==null&&a!==void 0?a:g1t(n,t)}function g1t(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return t==="gradient"?"horizontal":void 0}}function m1t({legendConfig:e,model:t,direction:n,orient:r,scaleType:i}){const{gradientHorizontalMaxLength:a,gradientHorizontalMinLength:o,gradientVerticalMaxLength:s,gradientVerticalMinLength:u}=e;if(xu(i))return n==="horizontal"?r==="top"||r==="bottom"?Xve(t,"width",o,a):o:Xve(t,"height",u,s)}function Xve(e,t,n,r){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${r})`}}function v1t(e){if(bt(["quantile","threshold","log"],e))return"greedy"}function Yve(e){const t=Nr(e)?y1t(e):_1t(e);return e.component.legends=t,t}function y1t(e){const{encoding:t}=e,n={};for(const r of[vo,...yme]){const i=hi(t[r]);!i||!e.getScaleComponent(r)||r===yo&&We(i)&&i.type===y0||(n[r]=w1t(e,r))}return n}function b1t(e,t){const n=e.scaleName(t);if(e.mark==="trail"){if(t==="color")return{stroke:n};if(t==="size")return{strokeWidth:n}}return t==="color"?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}function x1t(e,t,n,r){switch(t){case"disable":return n!==void 0;case"values":return!!(n==null?void 0:n.values);case"title":if(t==="title"&&e===(r==null?void 0:r.title))return!0}return e===(n||{})[t]}function w1t(e,t){var n,r,i;let a=e.legend(t);const{markDef:o,encoding:s,config:u}=e,l=u.legend,c=new a1t({},b1t(e,t));nyt(e,t,c);const f=a!==void 0?!a:l.disable;if(c.set("disable",f,a!==void 0),f)return c;a=a||{};const d=e.getScaleComponent(t).get("type"),h=hi(s[t]),p=We(h)?(n=Va(h.timeUnit))===null||n===void 0?void 0:n.unit:void 0,g=a.orient||u.legend.orient||"right",m=d1t({legend:a,channel:t,timeUnit:p,scaleType:d}),v=p1t({legend:a,legendType:m,orient:g,legendConfig:l}),y={legend:a,channel:t,model:e,markDef:o,encoding:s,fieldOrDatumDef:h,legendConfig:l,config:u,scaleType:d,orient:g,legendType:m,direction:v};for(const C of Wve){const _=C in Kve?Kve[C](y):a[C];if(_!==void 0){const E=x1t(_,C,a,e.fieldDef(t));(E||u.legend[C]===void 0)&&c.set(C,_,E)}}const b=(r=a==null?void 0:a.encoding)!==null&&r!==void 0?r:{},x=c.get("selections"),w={},S={fieldOrDatumDef:h,model:e,channel:t,legendCmpt:c,legendType:m};for(const C of["labels","legend","title","symbols","gradient","entries"]){const _=Uve((i=b[C])!==null&&i!==void 0?i:{},e),E=C in Vve?Vve[C](_,S):_;E!==void 0&&!Yn(E)&&(w[C]=Object.assign(Object.assign(Object.assign({},(x==null?void 0:x.length)&&We(h)?{name:`${fr(h.field)}_legend_${C}`}:{}),(x==null?void 0:x.length)?{interactive:!!x}:{}),{update:E}))}return Yn(w)||c.set("encode",w,!!(a==null?void 0:a.encoding)),c}function _1t(e){const{legends:t,resolve:n}=e.component;for(const r of e.children){Yve(r);for(const i of Be(r.component.legends))n.legend[i]=m9(e.component.resolve,i),n.legend[i]==="shared"&&(t[i]=Zve(t[i],r.component.legends[i]),t[i]||(n.legend[i]="independent",delete t[i]))}for(const r of Be(t))for(const i of e.children)!i.component.legends[r]||n.legend[r]==="shared"&&delete i.component.legends[r];return t}function Zve(e,t){var n,r,i,a;if(!e)return t.clone();const o=e.getWithExplicit("orient"),s=t.getWithExplicit("orient");if(o.explicit&&s.explicit&&o.value!==s.value)return;let u=!1;for(const l of Wve){const c=eh(e.getWithExplicit(l),t.getWithExplicit(l),l,"legend",(f,d)=>{switch(l){case"symbolType":return S1t(f,d);case"title":return rme(f,d);case"type":return u=!0,Ko("symbol")}return PO(f,d,l,"legend")});e.setWithExplicit(l,c)}return u&&(((r=(n=e.implicit)===null||n===void 0?void 0:n.encode)===null||r===void 0?void 0:r.gradient)&&zj(e.implicit,["encode","gradient"]),((a=(i=e.explicit)===null||i===void 0?void 0:i.encode)===null||a===void 0?void 0:a.gradient)&&zj(e.explicit,["encode","gradient"])),e}function S1t(e,t){return t.value==="circle"?t:e}function Jve(e,t,n,r){var i,a,o;e.encode=(i=e.encode)!==null&&i!==void 0?i:{},e.encode[t]=(a=e.encode[t])!==null&&a!==void 0?a:{},e.encode[t].update=(o=e.encode[t].update)!==null&&o!==void 0?o:{},e.encode[t].update[n]=r}function Qve(e){const t=e.component.legends,n={};for(const i of Be(t)){const a=e.getScaleComponent(i),o=cr(a.get("domains"));if(n[o])for(const s of n[o])Zve(s,t[i])||n[o].push(t[i]);else n[o]=[t[i].clone()]}return Bd(n).flat().map(i=>E1t(i,e.config)).filter(i=>i!==void 0)}function E1t(e,t){var n,r,i;const a=e.combine(),{disable:o,labelExpr:s,selections:u}=a,l=dt(a,["disable","labelExpr","selections"]);if(!o){if(t.aria===!1&&l.aria==null&&(l.aria=!1),(n=l.encode)===null||n===void 0?void 0:n.symbols){const c=l.encode.symbols.update;c.fill&&c.fill.value!=="transparent"&&!c.stroke&&!l.stroke&&(c.stroke={value:"transparent"});for(const f of yme)l[f]&&delete c[f]}if(l.title||delete l.title,s!==void 0){let c=s;((i=(r=l.encode)===null||r===void 0?void 0:r.labels)===null||i===void 0?void 0:i.update)&&Et(l.encode.labels.update.text)&&(c=d0(s,"datum.label",l.encode.labels.update.text.signal)),Jve(l,"labels","text",{signal:c})}for(const c in l){const f=l[c];if(Et(f)){const d=Nvt[c];if(d){const{vgProp:h,part:p}=d;Jve(l,p,h,f),delete l[c]}}}return l}}function C1t(e){return O0(e)||T9(e)?A1t(e):e0e(e)}function A1t(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),e0e(e))}function e0e(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:r}=n;if(t.data){const i={signal:`[${t.size.map(o=>o.signal).join(", ")}]`},a=t.data.reduce((o,s)=>{const u=Et(s)?s.signal:`data('${e.lookupDataSource(s)}')`;return bt(o,u)||o.push(u),o},[]);if(a.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:r,size:i,fit:{signal:a.length>1?`[${a.join(", ")}]`:a[0]}},n)]}else return[Object.assign(Object.assign({name:r},{translate:{signal:"[width / 2, height / 2]"}}),n)]}const k1t=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class t0e extends Xc{constructor(t,n,r,i){super(Object.assign({},n),{name:t});this.specifiedProjection=n,this.size=r,this.data=i,this.merged=!1}get isFit(){return!!this.data}}function n0e(e){e.component.projection=Nr(e)?T1t(e):N1t(e)}function T1t(e){var t;if(e.hasProjection){const n=e.specifiedProjection,r=!(n&&(n.scale!=null||n.translate!=null)),i=r?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,a=r?O1t(e):void 0;return new t0e(e.projectionName(!0),Object.assign(Object.assign({},(t=e.config.projection)!==null&&t!==void 0?t:{}),n??{}),i,a)}}function O1t(e){const t=[],{encoding:n}=e;for(const r of[[Cl,El],[ws,bu]])(hi(n[r[0]])||hi(n[r[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(yo)&&e.typedFieldDef(yo).type===y0&&t.push({signal:e.getName(`geojson_${t.length}`)}),t.length===0&&t.push(e.requestDataName(sa)),t}function I1t(e,t){const n=gpe(k1t,i=>!!(!Xp(e.explicit,i)&&!Xp(t.explicit,i)||Xp(e.explicit,i)&&Xp(t.explicit,i)&&cr(e.get(i))===cr(t.get(i))));if(cr(e.size)===cr(t.size)){if(n)return e;if(cr(e.explicit)===cr({}))return t;if(cr(t.explicit)===cr({}))return e}return null}function N1t(e){if(e.children.length===0)return;let t;for(const r of e.children)n0e(r);const n=gpe(e.children,r=>{const i=r.component.projection;if(i)if(t){const a=I1t(t,i);return a&&(t=a),!!a}else return t=i,!0;else return!0});if(t&&n){const r=e.projectionName(!0),i=new t0e(r,t.specifiedProjection,t.size,Yt(t.data));for(const a of e.children){const o=a.component.projection;o&&(o.isFit&&i.data.push(...a.component.projection.data),a.renameProjection(o.get("name"),r),o.merged=!0)}return i}}function D1t(e,t,n,r){var i,a;if(Ew(t,n)){const o=Nr(e)?(a=(i=e.axis(n))!==null&&i!==void 0?i:e.legend(n))!==null&&a!==void 0?a:{}:{},s=Ue(t,{expr:"datum"}),u=Ue(t,{expr:"datum",binSuffix:"end"});return{formulaAs:Ue(t,{binSuffix:"range",forAs:!0}),formula:_O(s,u,o.format,o.formatType,r)}}return{}}function r0e(e,t){return`${Vpe(e)}_${t}`}function R1t(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}function y9(e,t,n){var r;const i=(r=TO(n,void 0))!==null&&r!==void 0?r:{},a=r0e(i,t);return e.getName(`${a}_bins`)}function F1t(e){return"as"in e}function i0e(e,t,n){let r,i;F1t(e)?r=Xt(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:r=[Ue(e,{forAs:!0}),Ue(e,{binSuffix:"end",forAs:!0})];const a=Object.assign({},TO(t,void 0)),o=r0e(a,e.field),{signal:s,extentSignal:u}=R1t(n,o);if(vO(a.extent)){const c=a.extent,f=c.selection;i=kve(n.getSelectionComponent(fr(f),f),c),delete a.extent}const l=Object.assign(Object.assign(Object.assign({bin:a,field:e.field,as:[r]},s?{signal:s}:{}),u?{extentSignal:u}:{}),i?{span:i}:{});return{key:o,binComponent:l}}class Bl extends qn{constructor(t,n){super(t);this.bins=n}clone(){return new Bl(null,Yt(this.bins))}static makeFromEncoding(t,n){const r=n.reduceFieldDef((i,a,o)=>{if(Go(a)&&Qn(a.bin)){const{key:s,binComponent:u}=i0e(a,a.bin,n);i[s]=Object.assign(Object.assign(Object.assign({},u),i[s]),D1t(n,a,o,n.config))}return i},{});return Yn(r)?null:new Bl(t,r)}static makeFromTransform(t,n,r){const{key:i,binComponent:a}=i0e(n,n.bin,r);return new Bl(t,{[i]:a})}merge(t,n){for(const r of Be(t.bins))r in this.bins?(n(t.bins[r].signal,this.bins[r].signal),this.bins[r].as=Ld([...this.bins[r].as,...t.bins[r].as],yn)):this.bins[r]=t.bins[r];for(const r of t.children)t.removeChild(r),r.parent=this;t.remove()}producedFields(){return new Set(Bd(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(Bd(this.bins).map(t=>t.field))}hash(){return`Bin ${yn(this.bins)}`}assemble(){return Bd(this.bins).flatMap(t=>{const n=[],[r,...i]=t.as,a=t.bin,{extent:o}=a,s=dt(a,["extent"]),u=Object.assign(Object.assign(Object.assign({type:"bin",field:zd(t.field),as:r,signal:t.signal},vO(o)?{extent:null}:{extent:o}),t.span?{span:{signal:`span(${t.span})`}}:{}),s);!o&&t.extentSignal&&(n.push({type:"extent",field:zd(t.field),signal:t.extentSignal}),u.extent={signal:t.extentSignal}),n.push(u);for(const l of i)for(let c=0;c<2;c++)n.push({type:"formula",expr:Ue({field:r[c]},{expr:"datum"}),as:l[c]});return t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n})}}class A0 extends qn{constructor(t){super(null);t=t??{name:"source"};let n;if(cg(t)||(n=t.format?Object.assign({},Bc(t.format,["parse"])):{}),$O(t))this._data={values:t.values};else if(kw(t)){if(this._data={url:t.url},!n.type){let r=/(?:\.([^.]+))?$/.exec(t.url)[1];bt(["json","csv","tsv","dsv","topojson"],r)||(r="json"),n.type=r}}else zme(t)?this._data={values:[{type:"Sphere"}]}:(Lme(t)||cg(t))&&(this._data={});this._generator=cg(t),t.name&&(this._name=t.name),n&&!Yn(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}function b9(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return console.error("Dataflow graph is inconsistent.",t,n),!1;if(!b9(t.children))return!1}return!0}class jw extends qn{constructor(t,n){super(t);this.params=n}clone(){return new jw(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${yn(this.params)}`}assemble(){return Object.assign({type:"graticule"},this.params===!0?{}:this.params)}}class Uw extends qn{constructor(t,n){super(t);this.params=n}clone(){return new Uw(null,this.params)}dependentFields(){return new Set}producedFields(){var t;return new Set([(t=this.params.as)!==null&&t!==void 0?t:"data"])}hash(){return`Hash ${yn(this.params)}`}assemble(){return Object.assign({type:"sequence"},this.params)}}function eI(e){return e instanceof A0||e instanceof jw||e instanceof Uw}class a0e{constructor(){this._mutated=!1}setMutated(){this._mutated=!0}get mutatedFlag(){return this._mutated}}class Jc extends a0e{constructor(){super();this._continue=!1}setContinue(){this._continue=!0}get continueFlag(){return this._continue}get flags(){return{continueFlag:this.continueFlag,mutatedFlag:this.mutatedFlag}}set flags({continueFlag:t,mutatedFlag:n}){t&&this.setContinue(),n&&this.setMutated()}reset(){}optimizeNextFromLeaves(t){if(eI(t))return!1;const n=t.parent,{continueFlag:r}=this.run(t);return r&&this.optimizeNextFromLeaves(n),this.mutatedFlag}}class x9 extends a0e{}function M1t(e,t,n,r){const i=Nr(r)?r.encoding[Tl(t)]:void 0;if(Go(n)&&Nr(r)&&v8(t,n,i,r.stack,r.markDef,r.config))e.add(Ue(n,{})),e.add(Ue(n,{suffix:"end"})),n.bin&&Ew(n,t)&&e.add(Ue(n,{binSuffix:"range"}));else if(Vpt(t)){const a=Wpt(t);e.add(r.getName(a))}else e.add(Ue(n));return e}function P1t(e,t){var n;for(const r of Be(t)){const i=t[r];for(const a of Be(i))r in e?e[r][a]=new Set([...(n=e[r][a])!==null&&n!==void 0?n:[],...i[a]]):e[r]={[a]:i[a]}}}class _u extends qn{constructor(t,n,r){super(t);this.dimensions=n,this.measures=r}clone(){return new _u(null,new Set(this.dimensions),Yt(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let r=!1;n.forEachFieldDef(o=>{o.aggregate&&(r=!0)});const i={},a=new Set;return!r||(n.forEachFieldDef((o,s)=>{var u,l,c,f;const{aggregate:d,field:h}=o;if(d)if(d==="count")i["*"]=(u=i["*"])!==null&&u!==void 0?u:{},i["*"].count=new Set([Ue(o,{forAs:!0})]);else{if(jd(d)||Jp(d)){const p=jd(d)?"argmin":"argmax",g=d[p];i[g]=(l=i[g])!==null&&l!==void 0?l:{},i[g][p]=new Set([Ue({op:p,field:g},{forAs:!0})])}else i[h]=(c=i[h])!==null&&c!==void 0?c:{},i[h][d]=new Set([Ue(o,{forAs:!0})]);Kd(s)&&n.scaleDomain(s)==="unaggregated"&&(i[h]=(f=i[h])!==null&&f!==void 0?f:{},i[h].min=new Set([Ue({field:h,aggregate:"min"},{forAs:!0})]),i[h].max=new Set([Ue({field:h,aggregate:"max"},{forAs:!0})]))}else M1t(a,s,o,n)}),a.size+Be(i).length===0)?null:new _u(t,a,i)}static makeFromTransform(t,n){var r,i,a;const o=new Set,s={};for(const u of n.aggregate){const{op:l,field:c,as:f}=u;l&&(l==="count"?(s["*"]=(r=s["*"])!==null&&r!==void 0?r:{},s["*"].count=new Set([f||Ue(u,{forAs:!0})])):(s[c]=(i=s[c])!==null&&i!==void 0?i:{},s[c][l]=new Set([f||Ue(u,{forAs:!0})])))}for(const u of(a=n.groupby)!==null&&a!==void 0?a:[])o.add(u);return o.size+Be(s).length===0?null:new _u(t,o,s)}merge(t){return dpt(this.dimensions,t.dimensions)?(P1t(this.measures,t.measures),!0):(nmt("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...Be(this.measures)])}producedFields(){const t=new Set;for(const n of Be(this.measures))for(const r of Be(this.measures[n])){const i=this.measures[n][r];i.size===0?t.add(`${r}_${n}`):i.forEach(t.add,t)}return t}hash(){return`Aggregate ${yn({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],n=[],r=[];for(const a of Be(this.measures))for(const o of Be(this.measures[a]))for(const s of this.measures[a][o])r.push(s),t.push(o),n.push(a==="*"?null:zd(a));return{type:"aggregate",groupby:[...this.dimensions].map(zd),ops:t,fields:n,as:r}}}class k0 extends qn{constructor(t,n,r,i){super(t);this.model=n,this.name=r,this.data=i;for(const a of _s){const o=n.facet[a];if(o){const{bin:s,sort:u}=o;this[a]=Object.assign({name:n.getName(`${a}_domain`),fields:[Ue(o),...Qn(s)?[Ue(o,{binSuffix:"end"})]:[]]},Dl(u)?{sortField:u}:vt(u)?{sortIndexField:E0(o,a)}:{})}}this.childModel=n.child}hash(){let t="Facet";for(const n of _s)this[n]&&(t+=` ${n.charAt(0)}:${yn(this[n])}`);return t}get fields(){var t;const n=[];for(const r of _s)((t=this[r])===null||t===void 0?void 0:t.fields)&&n.push(...this[r].fields);return n}dependentFields(){const t=new Set(this.fields);for(const n of _s)this[n]&&(this[n].sortField&&t.add(this[n].sortField.field),this[n].sortIndexField&&t.add(this[n].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const n of Ss){const r=this.childModel.component.scales[n];if(r&&!r.merged){const i=r.get("type"),a=r.get("range");if(bo(i)&&Xd(a)){const o=nI(this.childModel,n),s=A9(o);s?t[n]=s:Me(`Unknown field for ${n}. Cannot calculate view size.`)}}}return t}assembleRowColumnHeaderData(t,n,r){const i={row:"y",column:"x"}[t],a=[],o=[],s=[];r&&r[i]&&(n?(a.push(`distinct_${r[i]}`),o.push("max")):(a.push(r[i]),o.push("distinct")),s.push(`distinct_${r[i]}`));const{sortField:u,sortIndexField:l}=this[t];if(u){const{op:c=SO,field:f}=u;a.push(f),o.push(c),s.push(Ue(u,{forAs:!0}))}else l&&(a.push(l),o.push("max"),s.push(l));return{name:this[t].name,source:n??this.data,transform:[Object.assign({type:"aggregate",groupby:this[t].fields},a.length?{fields:a,ops:o,as:s}:{})]}}assembleFacetHeaderData(t){var n,r;const{columns:i}=this.model.layout,{layoutHeaders:a}=this.model.component,o=[],s={};for(const c of d9){for(const f of h9){const d=(n=a[c]&&a[c][f])!==null&&n!==void 0?n:[];for(const h of d)if(((r=h.axes)===null||r===void 0?void 0:r.length)>0){s[c]=!0;break}}if(s[c]){const f=`length(data("${this.facet.name}"))`,d=c==="row"?i?{signal:`ceil(${f} / ${i})`}:1:i?{signal:`min(${f}, ${i})`}:{signal:f};o.push({name:`${this.facet.name}_${c}`,transform:[{type:"sequence",start:0,stop:d}]})}}const{row:u,column:l}=s;return(u||l)&&o.unshift(this.assembleRowColumnHeaderData("facet",null,t)),o}assemble(){var t,n;const r=[];let i=null;const a=this.getChildIndependentFieldsWithStep(),{column:o,row:s,facet:u}=this;if(o&&s&&(a.x||a.y)){i=`cross_${this.column.name}_${this.row.name}`;const l=[].concat((t=a.x)!==null&&t!==void 0?t:[],(n=a.y)!==null&&n!==void 0?n:[]),c=l.map(()=>"distinct");r.push({name:i,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:l,ops:c}]})}for(const l of[Uc,jc])this[l]&&r.push(this.assembleRowColumnHeaderData(l,i,a));if(u){const l=this.assembleFacetHeaderData(a);l&&r.push(...l)}return r}}function o0e(e){return e[0]==="'"&&e[e.length-1]==="'"||e[0]==='"'&&e[e.length-1]==='"'?e.slice(1,-1):e}function $1t(e,t){const n=xpe(e);if(t==="number")return`toNumber(${n})`;if(t==="boolean")return`toBoolean(${n})`;if(t==="string")return`toString(${n})`;if(t==="date")return`toDate(${n})`;if(t==="flatten")return n;if(t.indexOf("date:")===0){const r=o0e(t.slice(5,t.length));return`timeParse(${n},'${r}')`}else if(t.indexOf("utc:")===0){const r=o0e(t.slice(4,t.length));return`utcParse(${n},'${r}')`}else return Me(pgt(t)),null}function L1t(e){const t={};return JT(e.filter,n=>{var r;if(vge(n)){let i=null;a8(n)?i=n.equal:o8(n)?i=n.range[0]:s8(n)&&(i=((r=n.oneOf)!==null&&r!==void 0?r:n.in)[0]),i&&(g0(i)?t[n.field]="date":Jr(i)?t[n.field]="number":Xt(i)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}function B1t(e){const t={};function n(r){OO(r)?t[r.field]="date":r.type==="quantitative"&&Lpt(r.aggregate)?t[r.field]="number":gw(r.field)>1?r.field in t||(t[r.field]="flatten"):w8(r)&&Dl(r.sort)&&gw(r.sort.field)>1&&(r.sort.field in t||(t[r.sort.field]="flatten"))}if((Nr(e)||Eu(e))&&e.forEachFieldDef((r,i)=>{if(Go(r))n(r);else{const a=tg(i),o=e.fieldDef(a);n(Object.assign(Object.assign({},r),{type:o.type}))}}),Nr(e)){const{mark:r,markDef:i,encoding:a}=e;if(Zp(r)&&!e.encoding.order){const o=i.orient==="horizontal"?"y":"x",s=a[o];We(s)&&s.type==="quantitative"&&!(s.field in t)&&(t[s.field]="number")}}return t}function z1t(e){const t={};if(Nr(e)&&e.component.selection)for(const n of Be(e.component.selection)){const r=e.component.selection[n];for(const i of r.project.items)!i.channel&&gw(i.field)>1&&(t[i.field]="flatten")}return t}class da extends qn{constructor(t,n){super(t);this._parse=n}clone(){return new da(null,Yt(this._parse))}hash(){return`Parse ${yn(this._parse)}`}static makeExplicit(t,n,r){let i={};const a=n.data;return!cg(a)&&a&&a.format&&a.format.parse&&(i=a.format.parse),this.makeWithAncestors(t,i,{},r)}static makeWithAncestors(t,n,r,i){for(const s of Be(r)){const u=i.getWithExplicit(s);u.value!==void 0&&(u.explicit||u.value===r[s]||u.value==="derived"||r[s]==="flatten"?delete r[s]:Me(Jpe(s,r[s],u.value)))}for(const s of Be(n)){const u=i.get(s);u!==void 0&&(u===n[s]?delete n[s]:Me(Jpe(s,n[s],u)))}const a=new Xc(n,r);i.copyAll(a);const o={};for(const s of Be(a.combine())){const u=a.get(s);u!==null&&(o[s]=u)}return Be(o).length===0||i.parseNothing?null:new da(t,o)}get parse(){return this._parse}merge(t){this._parse=Object.assign(Object.assign({},this._parse),t.parse),t.remove()}assembleFormatParse(){const t={};for(const n of Be(this._parse)){const r=this._parse[n];gw(n)===1&&(t[n]=r)}return t}producedFields(){return new Set(Be(this._parse))}dependentFields(){return new Set(Be(this._parse))}assembleTransforms(t=!1){return Be(this._parse).filter(n=>t?gw(n)>1:!0).map(n=>{const r=$1t(n,this._parse[n]);return r?{type:"formula",expr:r,as:wpe(n)}:null}).filter(n=>n!==null)}}class ih extends qn{clone(){return new ih(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([b0])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:b0}}}class mg extends qn{constructor(t,n){super(t);this.transform=n}clone(){return new mg(null,Yt(this.transform))}addDimensions(t){this.transform.groupby=Ld(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!==null&&n!==void 0?n:Ue(t)}hash(){return`JoinAggregateTransform ${yn(this.transform)}`}assemble(){const t=[],n=[],r=[];for(const a of this.transform.joinaggregate)n.push(a.op),r.push(this.getDefaultName(a)),t.push(a.field===void 0?null:a.field);const i=this.transform.groupby;return Object.assign({type:"joinaggregate",as:r,ops:n,fields:t},i!==void 0?{groupby:i}:{})}}function j1t(e){return e.stack.stackBy.reduce((t,n)=>{const r=n.fieldDef,i=Ue(r);return i&&t.push(i),t},[])}function U1t(e){return vt(e)&&e.every(t=>Xt(t))&&e.length>1}class Qc extends qn{constructor(t,n){super(t);this._stack=n}clone(){return new Qc(null,Yt(this._stack))}static makeFromTransform(t,n){const{stack:r,groupby:i,as:a,offset:o="zero"}=n,s=[],u=[];if(n.sort!==void 0)for(const f of n.sort)s.push(f.field),u.push(Qr(f.order,"ascending"));const l={field:s,order:u};let c;return U1t(a)?c=a:Xt(a)?c=[a,a+"_end"]:c=[n.stack+"_start",n.stack+"_end"],new Qc(t,{stackField:r,groupby:i,offset:o,sort:l,facetby:[],as:c})}static makeFromEncoding(t,n){const r=n.stack,{encoding:i}=n;if(!r)return null;const{groupbyChannel:a,fieldChannel:o,offset:s,impute:u}=r;let l;if(a){const h=i[a];l=Fl(h)}const c=j1t(n),f=n.encoding.order;let d;return vt(f)||We(f)?d=eme(f):d=c.reduce((h,p)=>(h.field.push(p),h.order.push(o==="y"?"descending":"ascending"),h),{field:[],order:[]}),new Qc(t,{dimensionFieldDef:l,stackField:n.vgField(o),facetby:[],stackby:c,sort:d,offset:s,impute:u,as:[n.vgField(o,{suffix:"start",forAs:!0}),n.vgField(o,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${yn(this._stack)}`}getGroupbyFields(){const{dimensionFieldDef:t,impute:n,groupby:r}=this._stack;return t?t.bin?n?[Ue(t,{binSuffix:"mid"})]:[Ue(t,{}),Ue(t,{binSuffix:"end"})]:[Ue(t)]:r??[]}assemble(){const t=[],{facetby:n,dimensionFieldDef:r,stackField:i,stackby:a,sort:o,offset:s,impute:u,as:l}=this._stack;if(u&&r){const{band:c=.5,bin:f}=r;f&&t.push({type:"formula",expr:`${c}*`+Ue(r,{expr:"datum"})+`+${1-c}*`+Ue(r,{expr:"datum",binSuffix:"end"}),as:Ue(r,{binSuffix:"mid",forAs:!0})}),t.push({type:"impute",field:i,groupby:[...a,...n],key:Ue(r,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:i,sort:o,as:l,offset:s}),t}}class T0 extends qn{constructor(t,n){super(t);this.transform=n}clone(){return new T0(null,Yt(this.transform))}addDimensions(t){this.transform.groupby=Ld(this.transform.groupby.concat(t),n=>n)}dependentFields(){var t,n;const r=new Set;return((t=this.transform.groupby)!==null&&t!==void 0?t:[]).forEach(r.add,r),((n=this.transform.sort)!==null&&n!==void 0?n:[]).forEach(i=>r.add(i.field)),this.transform.window.map(i=>i.field).filter(i=>i!==void 0).forEach(r.add,r),r}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!==null&&n!==void 0?n:Ue(t)}hash(){return`WindowTransform ${yn(this.transform)}`}assemble(){var t;const n=[],r=[],i=[],a=[];for(const d of this.transform.window)r.push(d.op),i.push(this.getDefaultName(d)),a.push(d.param===void 0?null:d.param),n.push(d.field===void 0?null:d.field);const o=this.transform.frame,s=this.transform.groupby;if(o&&o[0]===null&&o[1]===null&&r.every(d=>Hj(d)))return Object.assign({type:"joinaggregate",as:i,ops:r,fields:n},s!==void 0?{groupby:s}:{});const u=[],l=[];if(this.transform.sort!==void 0)for(const d of this.transform.sort)u.push(d.field),l.push((t=d.order)!==null&&t!==void 0?t:"ascending");const c={field:u,order:l},f=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:a,as:i,ops:r,fields:n,sort:c},f!==void 0?{ignorePeers:f}:{}),s!==void 0?{groupby:s}:{}),o!==void 0?{frame:o}:{})}}class W1t extends Jc{run(t){const n=t.parent;if(t instanceof da){if(eI(n))return this.flags;if(n.numChildren()>1)return this.setContinue(),this.flags;if(n instanceof da)this.setMutated(),n.merge(t);else{if(ype(n.producedFields(),t.dependentFields()))return this.setContinue(),this.flags;this.setMutated(),t.swapWithParent()}}return this.setContinue(),this.flags}}class V1t extends x9{mergeNodes(t,n){const r=n.shift();for(const i of n)t.removeChild(i),i.parent=r,i.remove()}run(t){const n=t.children.map(i=>i.hash()),r={};for(let i=0;i<n.length;i++)r[n[i]]===void 0?r[n[i]]=[t.children[i]]:r[n[i]].push(t.children[i]);for(const i of Be(r))r[i].length>1&&(this.setMutated(),this.mergeNodes(t,r[i]));for(const i of t.children)this.run(i);return this.mutatedFlag}}class q1t extends Jc{run(t){return t instanceof qa||t.numChildren()>0||t instanceof k0?this.flags:(this.setMutated(),t.remove(),this.flags)}}class H1t extends Jc{constructor(){super(...arguments);this.fields=new Set,this.prev=null}run(t){if(this.setContinue(),t instanceof Pl){const n=t.producedFields();mpe(n,this.fields)?(this.setMutated(),this.prev.remove()):this.fields=new Set([...this.fields,...n]),this.prev=t}return this.flags}reset(){this.fields.clear()}}class G1t extends Jc{run(t){this.setContinue();const r=t.parent.children.filter(a=>a instanceof Pl),i=r.pop();for(const a of r)this.setMutated(),i.merge(a);return this.flags}}function K1t(e){function t(n){if(!(n instanceof k0)){const r=n.clone();if(r instanceof qa){const i=_9+r.getSource();r.setSource(i),e.model.component.data.outputNodes[i]=r}else(r instanceof _u||r instanceof Qc||r instanceof T0||r instanceof mg)&&r.addDimensions(e.fields);for(const i of n.children.flatMap(t))i.parent=r;return[r]}return n.children.flatMap(t)}return t}function w9(e){if(e instanceof k0)if(e.numChildren()===1&&!(e.children[0]instanceof qa)){const t=e.children[0];(t instanceof _u||t instanceof Qc||t instanceof T0||t instanceof mg)&&t.addDimensions(e.fields),t.swapWithParent(),w9(e)}else{const t=e.model.component.data.main;s0e(t);const n=K1t(e),r=e.children.map(n).flat();for(const i of r)i.parent=t}else e.children.map(w9)}function s0e(e){if(e instanceof qa&&e.type===sa&&e.numChildren()===1){const t=e.children[0];t instanceof k0||(t.swapWithParent(),s0e(e))}}class X1t extends x9{constructor(){super()}run(t){t instanceof qa&&!t.isRequired()&&(this.setMutated(),t.remove());for(const n of t.children)this.run(n);return this.mutatedFlag}}class Y1t extends x9{constructor(t){super();this.requiresSelectionId=t&&J8(t)}run(t){t instanceof ih&&(this.requiresSelectionId&&(eI(t.parent)||t.parent instanceof _u||t.parent instanceof da)||(this.setMutated(),t.remove()));for(const n of t.children)this.run(n);return this.mutatedFlag}}class Z1t extends Jc{run(t){const n=t.parent,r=[...n.children],i=n.children.filter(a=>a instanceof da);if(n.numChildren()>1&&i.length>=1){const a={},o=new Set;for(const s of i){const u=s.parse;for(const l of Be(u))l in a?a[l]!==u[l]&&o.add(l):a[l]=u[l]}for(const s of o)delete a[s];if(!Yn(a)){this.setMutated();const s=new da(n,a);for(const u of r){if(u instanceof da)for(const l of Be(a))delete u.parse[l];n.removeChild(u),u.parent=s,u instanceof da&&Be(u.parse).length===0&&u.remove()}}}return this.setContinue(),this.flags}}class J1t extends Jc{run(t){const n=t.parent,r=n.children.filter(a=>a instanceof _u),i={};for(const a of r){const o=yn(a.groupBy);o in i||(i[o]=[]),i[o].push(a)}for(const a of Be(i)){const o=i[a];if(o.length>1){const s=o.pop();for(const u of o)s.merge(u)&&(n.removeChild(u),u.parent=s,u.remove(),this.setMutated())}}return this.setContinue(),this.flags}}class Q1t extends Jc{constructor(t){super();this.model=t}run(t){const n=t.parent,r=!(eI(n)||n instanceof _0||n instanceof da||n instanceof ih),i=[],a=[];for(const o of n.children)o instanceof Bl&&(r&&!ype(n.producedFields(),o.dependentFields())?i.push(o):a.push(o));if(i.length>0){const o=i.pop();for(const s of i)o.merge(s,this.model.renameSignal.bind(this.model));this.setMutated(),n instanceof Bl?n.merge(o,this.model.renameSignal.bind(this.model)):o.swapWithParent()}if(a.length>1){const o=a.pop();for(const s of a)o.merge(s,this.model.renameSignal.bind(this.model));this.setMutated()}return this.setContinue(),this.flags}}class ext extends Jc{run(t){const n=t.parent,r=[...n.children];if(!hw(r,s=>s instanceof qa)||n.numChildren()<=1)return this.setContinue(),this.flags;const a=[];let o;for(const s of r)if(s instanceof qa){let u=s;for(;u.numChildren()===1;){const l=u.children[0];if(l instanceof qa)u=l;else break}a.push(...u.children),o?(n.removeChild(s),s.parent=o.parent,o.parent.removeChild(o),o.parent=u,this.setMutated()):o=u}else a.push(s);if(a.length){this.setMutated();for(const s of a)s.parent.removeChild(s),s.parent=o}return this.setContinue(),this.flags}}const _9="scale_",tI=5;function ah(e){const t=[];function n(r){if(r.numChildren()===0)t.push(r);else for(const i of r.children)n(i)}for(const r of e)n(r);return t}function txt(e){return e}function Su(e,t){return t.map(r=>{if(e instanceof Jc){const i=e.optimizeNextFromLeaves(r);return e.reset(),i}else return e.run(r)}).some(txt)}function u0e(e,t){let n=e.sources;const r=new Set;return r.add(Su(new X1t,n)),r.add(Su(new Y1t(t),n)),n=n.filter(i=>i.numChildren()>0),r.add(Su(new q1t,ah(n))),n=n.filter(i=>i.numChildren()>0),r.add(Su(new W1t,ah(n))),r.add(Su(new Q1t(t),ah(n))),r.add(Su(new H1t,ah(n))),r.add(Su(new Z1t,ah(n))),r.add(Su(new J1t,ah(n))),r.add(Su(new G1t,ah(n))),r.add(Su(new V1t,n)),r.add(Su(new ext,ah(n))),e.sources=n,r.has(!0)}function nxt(e,t){b9(e.sources);let n=0,r=0;for(let i=0;i<tI&&u0e(e,t);i++)n++;e.sources.map(w9);for(let i=0;i<tI&&u0e(e,t);i++)r++;b9(e.sources),Math.max(n,r)===tI&&Me(`Maximum optimization runs(${tI}) reached.`)}class Xo{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,n){return new Xo(()=>t(n))}}function l0e(e){Nr(e)?rxt(e):ixt(e)}function rxt(e){const t=e.component.scales;for(const n of Be(t)){const r=oxt(e,n);if(t[n].setWithExplicit("domains",r),uxt(e,n),e.component.data.isFaceted){let a=e;for(;!Eu(a)&&a.parent;)a=a.parent;if(a.component.resolve.scale[n]==="shared")for(const s of r.value)Yd(s)&&(s.data=_9+s.data.replace(_9,""))}}}function ixt(e){for(const n of e.children)l0e(n);const t=e.component.scales;for(const n of Be(t)){let r,i=null;for(const a of e.children){const o=a.component.scales[n];if(o){r===void 0?r=o.getWithExplicit("domains"):r=eh(r,o.getWithExplicit("domains"),"domains","scale",C9);const s=o.get("selectionExtent");i&&s&&i.selection!==s.selection&&Me("The same selection must be used to override scale domains in a layered view."),i=s}}t[n].setWithExplicit("domains",r),i&&t[n].set("selectionExtent",i,!0)}}function axt(e,t,n,r){if(e==="unaggregated"){const{valid:i,reason:a}=c0e(t,n);if(!i){Me(a);return}}else if(e===void 0&&r.useUnaggregatedDomain){const{valid:i}=c0e(t,n);if(i)return"unaggregated"}return e}function oxt(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:r}=e,i=axt(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return i!==e.scaleDomain(t)&&(e.specifiedScales[t]=Object.assign(Object.assign({},e.specifiedScales[t]),{domain:i})),t==="x"&&hi(r.x2)?hi(r.x)?eh(oh(n,i,e,"x"),oh(n,i,e,"x2"),"domain","scale",C9):oh(n,i,e,"x2"):t==="y"&&hi(r.y2)?hi(r.y)?eh(oh(n,i,e,"y"),oh(n,i,e,"y2"),"domain","scale",C9):oh(n,i,e,"y2"):oh(n,i,e,t)}function sxt(e,t,n){return e.map(r=>({signal:`{data: ${C8(r,{timeUnit:n,type:t})}}`}))}function S9(e,t,n){var r;const i=(r=Va(n))===null||r===void 0?void 0:r.unit;return t==="temporal"||i?sxt(e,t,i):[e]}function oh(e,t,n,r){const{encoding:i}=n,a=hi(i[r]),{type:o}=a,s=a.timeUnit;if(Umt(t)){const f=oh(e,void 0,n,r),d=S9(t.unionWith,o,s);return lg([...f.value,...d])}else{if(Et(t))return lg([t]);if(t&&t!=="unaggregated"&&!wge(t))return lg(S9(t,o,s))}const u=n.stack;if(u&&r===u.fieldChannel){if(u.offset==="normalize")return Ko([[0,1]]);const f=n.requestDataName(sa);return Ko([{data:f,field:n.vgField(r,{suffix:"start"})},{data:f,field:n.vgField(r,{suffix:"end"})}])}const l=Kd(r)&&We(a)?lxt(n,r,e):void 0;if(Jd(a)){const f=S9([a.datum],o,s);return Ko(f)}const c=a;if(t==="unaggregated"){const f=n.requestDataName(sa),{field:d}=a;return Ko([{data:f,field:Ue({field:d,aggregate:"min"})},{data:f,field:Ue({field:d,aggregate:"max"})}])}else if(Qn(c.bin)){if(bo(e))return Ko(e==="bin-ordinal"?[]:[{data:eO(l)?n.requestDataName(sa):n.requestDataName(LO),field:n.vgField(r,Ew(c,r)?{binSuffix:"range"}:{}),sort:l===!0||!Ai(l)?{field:n.vgField(r,{}),op:"min"}:l}]);{const{bin:f}=c;if(Qn(f)){const d=y9(n,c.field,f);return Ko([new Xo(()=>{const h=n.getSignalName(d);return`[${h}.start, ${h}.stop]`})])}else return Ko([{data:n.requestDataName(sa),field:n.vgField(r,{})}])}}else if(c.timeUnit&&bt(["time","utc"],e)&&v8(r,c,Nr(n)?n.encoding[Tl(r)]:void 0,n.stack,n.markDef,n.config)){const f=n.requestDataName(sa);return Ko([{data:f,field:n.vgField(r)},{data:f,field:n.vgField(r,{suffix:"end"})}])}else return Ko(l?[{data:eO(l)?n.requestDataName(sa):n.requestDataName(LO),field:n.vgField(r),sort:l}]:[{data:n.requestDataName(sa),field:n.vgField(r)}])}function E9(e,t){const{op:n,field:r,order:i}=e;return Object.assign(Object.assign({op:n??(t?"sum":SO)},r?{field:zd(r)}:{}),i?{order:i}:{})}function uxt(e,t){var n;const r=e.component.scales[t],i=e.specifiedScales[t].domain,a=(n=e.fieldDef(t))===null||n===void 0?void 0:n.bin,o=wge(i)&&i,s=bw(a)&&vO(a.extent)&&a.extent;(o||s)&&r.set("selectionExtent",o??s,!0)}function lxt(e,t,n){if(!bo(n))return;const r=e.fieldDef(t),i=r.sort;if($ge(i))return{op:"min",field:E0(r,t),order:"ascending"};const{stack:a}=e,o=a?[...a.groupbyField?[a.groupbyField]:[],...a.stackBy.map(s=>s.fieldDef.field)]:void 0;if(Dl(i)){const s=a&&!bt(o,i.field);return E9(i,s)}else if(Pge(i)){const{encoding:s,order:u}=i,l=e.fieldDef(s),{aggregate:c,field:f}=l,d=a&&!bt(o,f);if(jd(c)||Jp(c))return E9({field:Ue(l),order:u},d);if(Hj(c)||!c)return E9({op:c,field:f,order:u},d)}else{if(i==="descending")return{op:"min",field:e.vgField(t),order:"descending"};if(bt(["ascending",void 0],i))return!0}}function c0e(e,t){const{aggregate:n,type:r}=e;return n?Xt(n)&&!jpt[n]?{valid:!1,reason:Rgt(n)}:r==="quantitative"&&t==="log"?{valid:!1,reason:Fgt(e)}:{valid:!0}:{valid:!1,reason:Dgt(e)}}function C9(e,t,n,r){return e.explicit&&t.explicit&&Me(Bgt(n,r,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function cxt(e){const t=Ld(e.map(o=>Yd(o)?dt(o,["sort"]):o),yn),n=Ld(e.map(o=>{if(Yd(o)){const s=o.sort;return s!==void 0&&!eO(s)&&("op"in s&&s.op==="count"&&delete s.field,s.order==="ascending"&&delete s.order),s}}).filter(o=>o!==void 0),yn);if(t.length===0)return;if(t.length===1){const o=e[0];if(Yd(o)&&n.length>0){let s=n[0];if(n.length>1)Me(ige),s=!0;else if(Ai(s)&&"field"in s){const u=s.field;o.field===u&&(s=s.order?{order:s.order}:!0)}return Object.assign(Object.assign({},o),{sort:s})}return o}const r=Ld(n.map(o=>eO(o)||!("op"in o)||o.op in Ppt?o:(Me(jgt(o)),!0)),yn);let i;r.length===1?i=r[0]:r.length>1&&(Me(ige),i=!0);const a=Ld(e.map(o=>Yd(o)?o.data:null),o=>o);return a.length===1&&a[0]!==null?Object.assign({data:a[0],fields:t.map(s=>s.field)},i?{sort:i}:{}):Object.assign({fields:t},i?{sort:i}:{})}function A9(e){if(Yd(e)&&Xt(e.field))return e.field;if(mmt(e)){let t;for(const n of e.fields)if(Yd(n)&&Xt(n.field)){if(!t)t=n.field;else if(t!==n.field)return Me(Ugt),t}return Me(Wgt),t}else if(vmt(e)){Me(Vgt);const t=e.fields[0];return Xt(t)?t:void 0}}function nI(e,t){const r=e.component.scales[t].get("domains").map(i=>(Yd(i)&&(i.data=e.lookupDataSource(i.data)),i));return cxt(r)}function f0e(e){return O0(e)||T9(e)?e.children.reduce((t,n)=>t.concat(f0e(n)),d0e(e)):d0e(e)}function d0e(e){return Be(e.component.scales).reduce((t,n)=>{const r=e.component.scales[n];if(r.merged)return t;const i=r.combine(),{name:a,type:o,selectionExtent:s,domains:u,range:l,reverse:c}=i,f=dt(i,["name","type","selectionExtent","domains","range","reverse"]),d=fxt(i.range,a,n);let h;s&&(h=fyt(e,s));const p=nI(e,n);return t.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:a,type:o},p?{domain:p}:{}),h?{domainRaw:h}:{}),{range:d}),c!==void 0?{reverse:c}:{}),f)),t},[])}function fxt(e,t,n){return Il(n)&&Xd(e)?{step:{signal:t+"_step"}}:e}class h0e extends Xc{constructor(t,n){super({},{name:t});this.merged=!1,this.setWithExplicit("type",n)}domainDefinitelyIncludesZero(){return this.get("zero")!==!1?!0:hw(this.get("domains"),t=>vt(t)&&t.length===2&&t[0]<=0&&t[1]>=0)}}const dxt=["range","scheme"];function p0e(e){return e==="x"?"width":e==="y"?"height":void 0}function hxt(e){const t=e.component.scales;for(const n of gO){const r=t[n];if(!r)continue;const i=pxt(n,e);r.setWithExplicit("range",i)}}function g0e(e,t){const n=e.fieldDef(t);if(n&&n.bin&&Qn(n.bin)){const r=y9(e,n.field,n.bin),i=p0e(t),a=e.getName(i);return new Xo(()=>{const o=e.getSignalName(r),s=`(${o}.stop - ${o}.start) / ${o}.step`;return`${e.getSignalName(a)} / (${s})`})}}function pxt(e,t){const n=t.specifiedScales[e],{size:r}=t,a=t.getScaleComponent(e).get("type");for(const o of dxt)if(n[o]!==void 0){const s=_ge(a,o),u=Sge(e,o);if(!s)Me(nge(a,o,e));else if(u)Me(u);else switch(o){case"range":return vt(n.range)&&Il(e)?lg(n.range.map(l=>{if(l==="width"||l==="height"){const c=t.getName(l),f=t.getSignalName.bind(t);return Xo.fromName(f,c)}return l})):lg(n.range);case"scheme":return lg(gxt(n[o]))}}if(e===br||e===di){const o=e===br?"width":"height",s=r[o];if(Ml(s)){if(bo(a))return lg({step:s.step});Me(rge(o))}}return Ko(mxt(e,t))}function gxt(e){return jmt(e)?Object.assign({scheme:e.name},Bc(e,["name"])):{scheme:e}}function mxt(e,t){const{size:n,config:r,mark:i,encoding:a}=t,o=t.getSignalName.bind(t),{type:s}=hi(a[e]),l=t.getScaleComponent(e).get("type"),{domain:c,domainMid:f}=t.specifiedScales[e];switch(e){case br:case di:{if(bt(["point","band"],l)){if(e===br&&!n.width){const p=Aw(r.view,"width");if(Ml(p))return p}else if(e===di&&!n.height){const p=Aw(r.view,"height");if(Ml(p))return p}}const d=p0e(e),h=t.getName(d);return e===di&&Es(l)?[Xo.fromName(o,h),0]:[0,Xo.fromName(o,h)]}case qc:{const d=t.component.scales[e].get("zero"),h=m0e(i,d,r),p=bxt(i,n,t,r);return xO(l)?yxt(h,p,vxt(l,r,c,e)):[h,p]}case yu:return[0,Math.PI*2];case Qp:return[0,360];case Sl:return[0,new Xo(()=>{const d=t.getSignalName("width"),h=t.getSignalName("height");return`min(${d},${h})/2`})];case Vd:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case qd:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case yo:return"symbol";case vo:case Al:case kl:return l==="ordinal"?s==="nominal"?"category":"ordinal":f!==void 0?"diverging":i==="rect"||i==="geoshape"?"heatmap":"ramp";case Hc:case Ud:case Wd:return[r.scale.minOpacity,r.scale.maxOpacity]}throw new Error(`Scale range undefined for channel ${e}`)}function vxt(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return n!==void 0&&vt(n)?n.length+1:(Me(Qgt(r)),3)}}function yxt(e,t,n){const r=()=>{const i=Cw(t),a=Cw(e),o=`(${i} - ${a}) / (${n} - 1)`;return`sequence(${a}, ${i} + ${o}, ${o})`};return Et(t)?new Xo(r):{signal:r()}}function m0e(e,t,n){if(t)return Et(t)?{signal:`${t.signal} ? 0 : ${m0e(e,!1,n)}`}:0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(yO("size",e))}const v0e=.95;function bxt(e,t,n,r){const i={x:g0e(n,"x"),y:g0e(n,"y")};switch(e){case"bar":case"tick":{if(r.scale.maxBandSize!==void 0)return r.scale.maxBandSize;const a=y0e(t,i,r.view);return Jr(a)?a-1:new Xo(()=>`${a.signal} - 1`)}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;const a=y0e(t,i,r.view);return Jr(a)?Math.pow(v0e*a,2):new Xo(()=>`pow(${v0e} * ${a.signal}, 2)`)}}throw new Error(yO("size",e))}function y0e(e,t,n){const r=Ml(e.width)?e.width.step:FO(n,"width"),i=Ml(e.height)?e.height.step:FO(n,"height");return t.x||t.y?new Xo(()=>`min(${[t.x?t.x.signal:r,t.y?t.y.signal:i].join(", ")})`):Math.min(r,i)}function b0e(e,t){Nr(e)?xxt(e,t):_0e(e,t)}function xxt(e,t){const n=e.component.scales,{config:r,encoding:i,markDef:a,specifiedScales:o}=e;for(const s of Be(n)){const u=o[s],l=n[s],c=e.getScaleComponent(s),f=hi(i[s]),d=u[t],h=c.get("type"),p=c.get("padding"),g=c.get("paddingInner"),m=_ge(h,t),v=Sge(s,t);if(d!==void 0&&(m?v&&Me(v):Me(nge(h,t,s))),m&&v===void 0)if(d!==void 0)l.copyKeyFromObject(t,u);else{const y=t in x0e?x0e[t]({model:e,channel:s,fieldOrDatumDef:f,scaleType:h,scalePadding:p,scalePaddingInner:g,domain:u.domain,markDef:a,config:r}):r.scale[t];y!==void 0&&l.set(t,y,!1)}}}const x0e={bins:({model:e,fieldOrDatumDef:t})=>We(t)?wxt(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>_xt(e,t.type),nice:({scaleType:e,channel:t,fieldOrDatumDef:n})=>Sxt(e,t,n),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:r,config:i})=>Ext(e,t,i.scale,n,r,i.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,config:r})=>Cxt(e,t,n.type,r.scale),paddingOuter:({scalePadding:e,channel:t,scaleType:n,markDef:r,scalePaddingInner:i,config:a})=>Axt(e,t,n,r.type,i,a.scale),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:r})=>{const i=We(e)?e.sort:void 0;return kxt(t,i,n,r.scale)},zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:r,scaleType:i})=>Txt(e,t,n,r,i)};function w0e(e){Nr(e)?hxt(e):_0e(e,"range")}function _0e(e,t){const n=e.component.scales;for(const r of e.children)t==="range"?w0e(r):b0e(r,t);for(const r of Be(n)){let i;for(const a of e.children){const o=a.component.scales[r];if(o){const s=o.getWithExplicit(t);i=eh(i,s,t,"scale",$me((u,l)=>{switch(t){case"range":return u.step&&l.step?u.step-l.step:0}return 0}))}}n[r].setWithExplicit(t,i)}}function wxt(e,t){const n=t.bin;if(Qn(n)){const r=y9(e,t.field,n);return new Xo(()=>e.getSignalName(r))}else if(Wa(n)&&bw(n)&&n.step!==void 0)return{step:n.step}}function _xt(e,t){if(bt([vo,Al,kl],e)&&t!=="nominal")return"hcl"}function Sxt(e,t,n){var r;if(!(((r=Fl(n))===null||r===void 0?void 0:r.bin)||bt([ei.TIME,ei.UTC],e)))return t in Gd?!0:void 0}function Ext(e,t,n,r,i,a){if(e in Gd){if(xu(t)){if(n.continuousPadding!==void 0)return n.continuousPadding;const{type:o,orient:s}=i;if(o==="bar"&&!(We(r)&&(r.bin||r.timeUnit))&&(s==="vertical"&&e==="x"||s==="horizontal"&&e==="y"))return a.continuousBandSize}if(t===ei.POINT)return n.pointPadding}}function Cxt(e,t,n,r){if(e===void 0&&t in Gd){const{bandPaddingInner:i,barBandPaddingInner:a,rectBandPaddingInner:o}=r;return Qr(i,n==="bar"?a:o)}}function Axt(e,t,n,r,i,a){if(e===void 0&&t in Gd&&n===ei.BAND){const{bandPaddingOuter:o}=a;return Qr(o,Et(i)?{signal:`${i.signal}/2`}:i/2)}}function kxt(e,t,n,r){if(n==="x"&&r.xReverse!==void 0)return Es(e)&&t==="descending"?Et(r.xReverse)?{signal:`!${r.xReverse.signal}`}:!r.xReverse:r.xReverse;if(Es(e)&&t==="descending")return!0}function Txt(e,t,n,r,i){if(!!n&&n!=="unaggregated"&&Es(i)){if(vt(n)){const o=n[0],s=n[n.length-1];if(o<=0&&s>=0)return!0}return!1}if(e==="size"&&t.type==="quantitative"&&!xO(i))return!0;if(!(We(t)&&t.bin)&&bt([...Ss,...Jpt],e)){const{orient:o,type:s}=r;return!(bt(["bar","area","line","trail"],s)&&(o==="horizontal"&&e==="y"||o==="vertical"&&e==="x"))}return!1}function Oxt(e,t,n,r){const i=Ixt(t,n,r),{type:a}=e;return Kd(t)?a!==void 0?Cge(t,a)?We(n)&&!Ege(a,n.type)?(Me($gt(a,i)),i):a:(Me(Pgt(t,a,i)),i):i:null}function Ixt(e,t,n){var r;switch(t.type){case"nominal":case"ordinal":if(h0(e)||mO(e)==="discrete")return e==="shape"&&t.type==="ordinal"&&Me(Qj(e,"ordinal")),"ordinal";if(e in Gd){if(bt(["rect","bar","image","rule"],n))return"band"}else if(n==="arc"&&e in Yj)return"band";return t.band!==void 0||_8(t)&&((r=t.axis)===null||r===void 0?void 0:r.tickBand)?"band":"point";case"temporal":return h0(e)?"time":mO(e)==="discrete"?(Me(Qj(e,"temporal")),"ordinal"):We(t)&&t.timeUnit&&Va(t.timeUnit).utc?"utc":"time";case"quantitative":return h0(e)?We(t)&&Qn(t.bin)?"bin-ordinal":"linear":mO(e)==="discrete"?(Me(Qj(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(ege(t.type))}function Nxt(e,{ignoreRange:t}={}){S0e(e),l0e(e);for(const n of qmt)b0e(e,n);t||w0e(e)}function S0e(e){Nr(e)?e.component.scales=Dxt(e):e.component.scales=Fxt(e)}function Dxt(e){const{encoding:t,mark:n}=e;return gO.reduce((r,i)=>{const a=hi(t[i]);if(a&&n===Tpe&&i===yo&&a.type===y0)return r;let o=a&&a.scale;if(a&&o!==null&&o!==!1){o=o??{};const s=Oxt(o,i,a,n);r[i]=new h0e(e.scaleName(i+"",!0),{value:s,explicit:o.type===s})}return r},{})}const Rxt=$me((e,t)=>bge(e)-bge(t));function Fxt(e){var t;const n=e.component.scales={},r={},i=e.component.resolve;for(const a of e.children){S0e(a);for(const o of Be(a.component.scales))if(i.scale[o]=(t=i.scale[o])!==null&&t!==void 0?t:r1t(o,e),i.scale[o]==="shared"){const s=r[o],u=a.component.scales[o].getWithExplicit("type");s?Tmt(s.value,u.value)?r[o]=eh(s,u,"type","scale",Rxt):(i.scale[o]="independent",delete r[o]):r[o]=u}}for(const a of Be(r)){const o=e.scaleName(a,!0),s=r[a];n[a]=new h0e(o,s);for(const u of e.children){const l=u.component.scales[a];l&&(u.renameScale(l.get("name"),o),l.merged=!0)}}return n}class k9{constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return this.nameMap[t]!==void 0}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function Nr(e){return(e==null?void 0:e.type)==="unit"}function Eu(e){return(e==null?void 0:e.type)==="facet"}function T9(e){return(e==null?void 0:e.type)==="concat"}function O0(e){return(e==null?void 0:e.type)==="layer"}class O9{constructor(t,n,r,i,a,o,s){var u,l;this.type=n,this.parent=r,this.config=a,this.view=s,this.children=[],this.correctDataNames=c=>(c.from&&c.from.data&&(c.from.data=this.lookupDataSource(c.from.data)),c.from&&c.from.facet&&c.from.facet.data&&(c.from.facet.data=this.lookupDataSource(c.from.facet.data)),c),this.parent=r,this.config=a,this.name=(u=t.name)!==null&&u!==void 0?u:i,this.title=Qd(t.title)?{text:t.title}:t.title,this.scaleNameMap=r?r.scaleNameMap:new k9,this.projectionNameMap=r?r.projectionNameMap:new k9,this.signalNameMap=r?r.signalNameMap:new k9,this.data=t.data,this.description=t.description,this.transforms=$0t((l=t.transform)!==null&&l!==void 0?l:[]),this.layout=n==="layer"||n==="unit"?{}:Lvt(t,n,a),this.component={data:{sources:r?r.component.data.sources:[],outputNodes:r?r.component.data.outputNodes:{},outputNodeRefCounts:r?r.component.data.outputNodeRefCounts:{},isFaceted:EO(t)||r&&r.component.data.isFaceted&&t.data===void 0},layoutSize:new Xc,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},o?Yt(o):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){Nxt(this)}parseProjection(){n0e(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegends(){Yve(this)}assembleGroupStyle(){var t,n;if(this.type==="unit"||this.type==="layer")return(n=(t=this.view)===null||t===void 0?void 0:t.style)!==null&&n!==void 0?n:"cell"}assembleEncodeFromView(t){const n=dt(t,["style"]),r={};for(const i of Be(n)){const a=n[i];a!==void 0&&(r[i]=zr(a))}return r}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),!t&&(this.description&&(n.description=zr(this.description)),this.type==="unit"||this.type==="layer")?Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},n??{}):Yn(n)?void 0:n}assembleLayout(){if(!this.layout)return;const t=this.layout,{spacing:n}=t,r=dt(t,["spacing"]),{component:i,config:a}=this,o=n1t(i.layoutHeaders,a);return Object.assign(Object.assign(Object.assign({padding:n},this.assembleDefaultLayout()),r),o?{titleBand:o}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let n=[];for(const r of _s)t[r].title&&n.push(Ybt(this,r));for(const r of d9)n=n.concat(Zbt(this,r));return n}assembleAxes(){return Pbt(this.component.axes,this.config)}assembleLegends(){return Qve(this)}assembleProjections(){return C1t(this)}assembleTitle(){var t,n,r;const i=(t=this.title)!==null&&t!==void 0?t:{},{encoding:a}=i,o=dt(i,["encoding"]),s=Object.assign(Object.assign(Object.assign({},Yge(this.config.title).nonMark),o),a?{encode:{update:a}}:{});if(s.text)return bt(["unit","layer"],this.type)?bt(["middle",void 0],s.anchor)&&(s.frame=(n=s.frame)!==null&&n!==void 0?n:"group"):s.anchor=(r=s.anchor)!==null&&r!==void 0?r:"start",Yn(s)?void 0:s}assembleGroup(t=[]){const n={};t=t.concat(this.assembleSignals()),t.length>0&&(n.signals=t);const r=this.assembleLayout();r&&(n.layout=r),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const i=!this.parent||Eu(this.parent)?f0e(this):[];i.length>0&&(n.scales=i);const a=this.assembleAxes();a.length>0&&(n.axes=a);const o=this.assembleLegends();return o.length>0&&(n.legends=o),n}getName(t){return fr((this.name?this.name+"_":"")+t)}requestDataName(t){var n;const r=this.getName(t),i=this.component.data.outputNodeRefCounts;return i[r]=((n=i[r])!==null&&n!==void 0?n:0)+1,r}getSizeSignalRef(t){if(Eu(this.parent)){const n=jve(t),r=pO(n),i=this.component.scales[r];if(i&&!i.merged){const a=i.get("type"),o=i.get("range");if(bo(a)&&Xd(o)){const s=i.get("name"),u=nI(this,r),l=A9(u);if(l){const c=Ue({aggregate:"distinct",field:l},{expr:"datum"});return{signal:zve(s,i,c)}}else return Me(`Unknown field for ${r}. Cannot calculate view size.`),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){if(n)return this.getName(t);if(Bpe(t)&&Kd(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t)))return this.scaleNameMap.get(this.getName(t))}projectionName(t){if(t)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"))}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getSelectionComponent(t,n){let r=this.component.selection[t];if(!r&&this.parent&&(r=this.parent.getSelectionComponent(t,n)),!r)throw new Error(ugt(n));return r}hasAxisOrientSignalRef(){var t,n;return((t=this.component.axes.x)===null||t===void 0?void 0:t.some(r=>r.hasOrientSignalRef()))||((n=this.component.axes.y)===null||n===void 0?void 0:n.some(r=>r.hasOrientSignalRef()))}}class E0e extends O9{vgField(t,n={}){const r=this.fieldDef(t);if(!!r)return Ue(r,n)}reduceFieldDef(t,n){return ime(this.getMapping(),(r,i,a)=>{const o=Fl(i);return o?t(r,o,a):r},n)}forEachFieldDef(t,n){T8(this.getMapping(),(r,i)=>{const a=Fl(r);a&&t(a,i)},n)}}class rI extends qn{constructor(t,n){var r,i,a;super(t);this.transform=n,this.transform=Yt(n);const o=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=o[0])!==null&&i!==void 0?i:"value",(a=o[1])!==null&&a!==void 0?a:"density"]}clone(){return new rI(null,Yt(this.transform))}dependentFields(){var t;return new Set([this.transform.density,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${yn(this.transform)}`}assemble(){const t=this.transform,{density:n}=t,r=dt(t,["density"]);return Object.assign({type:"kde",field:n},r)}}class Ww extends qn{constructor(t,n){super(t);this.filter=n}clone(){return new Ww(null,Object.assign({},this.filter))}static make(t,n){const{config:r,mark:i,markDef:a}=n;if(Fn("invalid",a,r)!=="filter")return null;const s=n.reduceFieldDef((u,l,c)=>{const f=Kd(c)&&n.getScaleComponent(c);if(f){const d=f.get("type");Es(d)&&l.aggregate!=="count"&&!Zp(i)&&(u[l.field]=l)}return u},{});return Be(s).length?new Ww(t,s):null}dependentFields(){return new Set(Be(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${yn(this.filter)}`}assemble(){const t=Be(this.filter).reduce((n,r)=>{const i=this.filter[r],a=Ue(i,{expr:"datum"});return i!==null&&(i.type==="temporal"?n.push(`(isDate(${a}) || (isValid(${a}) && isFinite(+${a})))`):i.type==="quantitative"&&(n.push(`isValid(${a})`),n.push(`isFinite(+${a})`))),n},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}class iI extends qn{constructor(t,n){super(t);this.transform=n,this.transform=Yt(n);const{flatten:r,as:i=[]}=this.transform;this.transform.as=r.map((a,o)=>{var s;return(s=i[o])!==null&&s!==void 0?s:a})}clone(){return new iI(this.parent,Yt(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${yn(this.transform)}`}assemble(){const{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}}class aI extends qn{constructor(t,n){var r,i,a;super(t);this.transform=n,this.transform=Yt(n);const o=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=o[0])!==null&&i!==void 0?i:"key",(a=o[1])!==null&&a!==void 0?a:"value"]}clone(){return new aI(null,Yt(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${yn(this.transform)}`}assemble(){const{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}}class I0 extends qn{constructor(t,n,r,i){super(t);this.fields=n,this.geojson=r,this.signal=i}clone(){return new I0(null,Yt(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;let r=0;for(const i of[[Cl,El],[ws,bu]]){const a=i.map(o=>{const s=hi(n.encoding[o]);return We(s)?s.field:Jd(s)?{expr:`${s.datum}`}:Gc(s)?{expr:`${s.value}`}:void 0});(a[0]||a[1])&&(t=new I0(t,a,null,n.getName(`geojson_${r++}`)))}if(n.channelHasField(yo)){const i=n.typedFieldDef(yo);i.type===y0&&(t=new I0(t,null,i.field,n.getName(`geojson_${r++}`)))}return t}dependentFields(){var t;const n=((t=this.fields)!==null&&t!==void 0?t:[]).filter(Xt);return new Set([...this.geojson?[this.geojson]:[],...n])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${yn(this.fields)}`}assemble(){return Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})}}class Vw extends qn{constructor(t,n,r,i){super(t);this.projection=n,this.fields=r,this.as=i}clone(){return new Vw(null,this.projection,Yt(this.fields),Yt(this.as))}static parseAll(t,n){if(!n.projectionName())return t;for(const r of[[Cl,El],[ws,bu]]){const i=r.map(o=>{const s=hi(n.encoding[o]);return We(s)?s.field:Jd(s)?{expr:`${s.datum}`}:Gc(s)?{expr:`${s.value}`}:void 0}),a=r[0]===ws?"2":"";(i[0]||i[1])&&(t=new Vw(t,n.projectionName(),i,[n.getName("x"+a),n.getName("y"+a)]))}return t}dependentFields(){return new Set(this.fields.filter(Xt))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${yn(this.fields)} ${yn(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class vg extends qn{constructor(t,n){super(t);this.transform=n}clone(){return new vg(null,Yt(this.transform))}dependentFields(){var t;return new Set([this.transform.impute,this.transform.key,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:n=0,stop:r,step:i}=t;return{signal:`sequence(${[n,r,...i?[i]:[]].join(",")})`}}static makeFromTransform(t,n){return new vg(t,n)}static makeFromEncoding(t,n){const r=n.encoding,i=r.x,a=r.y;if(We(i)&&We(a)){const o=i.impute?i:a.impute?a:void 0;if(o===void 0)return;const s=i.impute?a:a.impute?i:void 0,{method:u,value:l,frame:c,keyvals:f}=o.impute,d=ame(n.mark,r);return new vg(t,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:o.field,key:s.field},u?{method:u}:{}),l!==void 0?{value:l}:{}),c?{frame:c}:{}),f!==void 0?{keyvals:f}:{}),d.length?{groupby:d}:{}))}return null}hash(){return`Impute ${yn(this.transform)}`}assemble(){const{impute:t,key:n,keyvals:r,method:i,groupby:a,value:o,frame:s=[null,null]}=this.transform,u=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:t,key:n},r?{keyvals:v0t(r)?this.processSequence(r):r}:{}),{method:"value"}),a?{groupby:a}:{}),{value:!i||i==="value"?o:null});if(i&&i!=="value"){const l=Object.assign({type:"window",as:[`imputed_${t}_value`],ops:[i],fields:[t],frame:s,ignorePeers:!1},a?{groupby:a}:{}),c={type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t};return[u,l,c]}else return[u]}}class oI extends qn{constructor(t,n){var r,i,a;super(t);this.transform=n,this.transform=Yt(n);const o=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=o[0])!==null&&i!==void 0?i:n.on,(a=o[1])!==null&&a!==void 0?a:n.loess]}clone(){return new oI(null,Yt(this.transform))}dependentFields(){var t;return new Set([this.transform.loess,this.transform.on,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${yn(this.transform)}`}assemble(){const t=this.transform,{loess:n,on:r}=t,i=dt(t,["loess","on"]);return Object.assign({type:"loess",x:r,y:n},i)}}class qw extends qn{constructor(t,n,r){super(t);this.transform=n,this.secondary=r}clone(){return new qw(null,Yt(this.transform),this.secondary)}static make(t,n,r,i){const a=n.component.data.sources,{from:o}=r;let s=null;if(b0t(o)){let u=T0e(o.data,a);u||(u=new A0(o.data),a.push(u));const l=n.getName(`lookup_${i}`);s=new qa(u,l,"lookup",n.component.data.outputNodeRefCounts),n.component.data.outputNodes[l]=s}else if(x0t(o)){const u=o.selection;if(r=Object.assign({as:u},r),s=n.getSelectionComponent(fr(u),u).materialized,!s)throw new Error(fgt(u))}return new qw(t,r,s.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?Br(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${yn({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t=Object.assign({values:this.transform.from.fields},this.transform.as?{as:Br(this.transform.as)}:{});else{let n=this.transform.as;Xt(n)||(Me(mgt),n="_lookup"),t={as:[n]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},t),this.transform.default?{default:this.transform.default}:{})}}class sI extends qn{constructor(t,n){var r,i,a;super(t);this.transform=n,this.transform=Yt(n);const o=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=o[0])!==null&&i!==void 0?i:"prob",(a=o[1])!==null&&a!==void 0?a:"value"]}clone(){return new sI(null,Yt(this.transform))}dependentFields(){var t;return new Set([this.transform.quantile,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${yn(this.transform)}`}assemble(){const t=this.transform,{quantile:n}=t,r=dt(t,["quantile"]);return Object.assign({type:"quantile",field:n},r)}}class uI extends qn{constructor(t,n){var r,i,a;super(t);this.transform=n,this.transform=Yt(n);const o=(r=this.transform.as)!==null&&r!==void 0?r:[void 0,void 0];this.transform.as=[(i=o[0])!==null&&i!==void 0?i:n.on,(a=o[1])!==null&&a!==void 0?a:n.regression]}clone(){return new uI(null,Yt(this.transform))}dependentFields(){var t;return new Set([this.transform.regression,this.transform.on,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${yn(this.transform)}`}assemble(){const t=this.transform,{regression:n,on:r}=t,i=dt(t,["regression","on"]);return Object.assign({type:"regression",x:r,y:n},i)}}class lI extends qn{constructor(t,n){super(t);this.transform=n}clone(){return new lI(null,Yt(this.transform))}addDimensions(t){var n;this.transform.groupby=Ld(((n=this.transform.groupby)!==null&&n!==void 0?n:[]).concat(t),r=>r)}producedFields(){}dependentFields(){var t;return new Set([this.transform.pivot,this.transform.value,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}hash(){return`PivotTransform ${yn(this.transform)}`}assemble(){const{pivot:t,value:n,groupby:r,limit:i,op:a}=this.transform;return Object.assign(Object.assign(Object.assign({type:"pivot",field:t,value:n},i!==void 0?{limit:i}:{}),a!==void 0?{op:a}:{}),r!==void 0?{groupby:r}:{})}}class cI extends qn{constructor(t,n){super(t);this.transform=n}clone(){return new cI(null,Yt(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${yn(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function C0e(e){let t=0;function n(r,i){var a;if(r instanceof A0&&!r.isGenerator&&!kw(r.data)&&(e.push(i),i={name:null,source:i.name,transform:[]}),r instanceof da&&(r.parent instanceof A0&&!i.source?(i.format=Object.assign(Object.assign({},(a=i.format)!==null&&a!==void 0?a:{}),{parse:r.assembleFormatParse()}),i.transform.push(...r.assembleTransforms(!0))):i.transform.push(...r.assembleTransforms())),r instanceof k0){i.name||(i.name=`data_${t++}`),!i.source||i.transform.length>0?(e.push(i),r.data=i.name):r.data=i.source;for(const o of r.assemble())e.push(o);return}switch((r instanceof jw||r instanceof Uw||r instanceof Ww||r instanceof _0||r instanceof S0||r instanceof Vw||r instanceof I0||r instanceof _u||r instanceof qw||r instanceof T0||r instanceof mg||r instanceof aI||r instanceof iI||r instanceof rI||r instanceof oI||r instanceof sI||r instanceof uI||r instanceof ih||r instanceof cI||r instanceof lI)&&i.transform.push(r.assemble()),(r instanceof Bl||r instanceof Pl||r instanceof vg||r instanceof Qc)&&i.transform.push(...r.assemble()),r instanceof qa&&(i.source&&i.transform.length===0?r.setSource(i.source):r.parent instanceof qa?r.setSource(i.name):(i.name||(i.name=`data_${t++}`),r.setSource(i.name),r.numChildren()===1&&(e.push(i),i={name:null,source:i.name,transform:[]}))),r.numChildren()){case 0:r instanceof qa&&(!i.source||i.transform.length>0)&&e.push(i);break;case 1:n(r.children[0],i);break;default:{i.name||(i.name=`data_${t++}`);let o=i.name;!i.source||i.transform.length>0?e.push(i):o=i.source;for(const s of r.children)n(s,{name:null,source:o,transform:[]});break}}}return n}function Mxt(e){const t=[],n=C0e(t);for(const r of e.children)n(r,{source:e.name,name:null,transform:[]});return t}function Pxt(e,t){var n,r;const i=[],a=C0e(i);let o=0;for(const u of e.sources){u.hasName()||(u.dataName=`source_${o++}`);const l=u.assemble();a(u,l)}for(const u of i)u.transform.length===0&&delete u.transform;let s=0;for(const[u,l]of i.entries())((n=l.transform)!==null&&n!==void 0?n:[]).length===0&&!l.source&&i.splice(s++,0,i.splice(u,1)[0]);for(const u of i)for(const l of(r=u.transform)!==null&&r!==void 0?r:[])l.type==="lookup"&&(l.from=e.outputNodes[l.from].getSource());for(const u of i)u.name in t&&(u.values=t[u.name]);return i}function $xt(e){return e==="top"||e==="left"||Et(e)?"header":"footer"}function Lxt(e){for(const t of _s)Bxt(e,t);k0e(e,"x"),k0e(e,"y")}function Bxt(e,t){var n;const{facet:r,config:i,child:a,component:o}=e;if(e.channelHasField(t)){const s=r[t],u=C0("title",null,i,t);let l=ag(s,i,{allowDisabling:!0,includeDefault:u===void 0||!!u});a.component.layoutHeaders[t].title&&(l=vt(l)?l.join(", "):l,l+=" / "+a.component.layoutHeaders[t].title,a.component.layoutHeaders[t].title=null);const c=C0("labelOrient",s,i,t),f=(n=s.header)!==null&&n!==void 0?n:{},d=Qr(f.labels,i.header.labels,!0),h=bt(["bottom","right"],c)?"footer":"header";o.layoutHeaders[t]={title:l,facetFieldDef:s,[h]:t==="facet"?[]:[A0e(e,t,d)]}}}function A0e(e,t,n){const r=t==="row"?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(r)?e.child.getSizeSignalRef(r):void 0,axes:[]}}function k0e(e,t){var n;const{child:r}=e;if(r.component.axes[t]){const{layoutHeaders:i,resolve:a}=e.component;if(a.axis[t]=m9(a,t),a.axis[t]==="shared"){const o=t==="x"?"column":"row",s=i[o];for(const u of r.component.axes[t]){const l=$xt(u.get("orient"));s[l]=(n=s[l])!==null&&n!==void 0?n:[A0e(e,o,!1)];const c=zw(u,"main",e.config,{header:!0});c&&s[l][0].axes.push(c),u.mainExtracted=!0}}}}function zxt(e){I9(e),fI(e,"width"),fI(e,"height")}function jxt(e){I9(e);const t=e.layout.columns===1?"width":"childWidth",n=e.layout.columns===void 0?"height":"childHeight";fI(e,t),fI(e,n)}function I9(e){for(const t of e.children)t.parseLayoutSize()}function fI(e,t){const n=jve(t),r=pO(n),i=e.component.resolve,a=e.component.layoutSize;let o;for(const s of e.children){const u=s.component.layoutSize.getWithExplicit(n),l=i.scale[r];if(l==="independent"&&u.value==="step"){o=void 0;break}if(o){if(l==="independent"&&o.value!==u.value){o=void 0;break}o=eh(o,u,n,"")}else o=u}if(o){for(const s of e.children)e.renameSignal(s.getName(n),e.getName(t)),s.component.layoutSize.set(n,"merged",!1);a.setWithExplicit(t,o)}else a.setWithExplicit(t,{explicit:!1,value:void 0})}function Uxt(e){const{size:t,component:n}=e;for(const r of Ss){const i=Ol(r);if(t[i]){const a=t[i];n.layoutSize.set(i,Ml(a)?"step":a,!0)}else{const a=Wxt(e,i);n.layoutSize.set(i,a,!1)}}}function Wxt(e,t){const n=t==="width"?"x":"y",r=e.config,i=e.getScaleComponent(n);if(i){const a=i.get("type"),o=i.get("range");if(bo(a)){const s=Aw(r.view,t);return Xd(o)||Ml(s)?"step":s}else return L8(r.view,t)}else{if(e.hasProjection||e.mark==="arc")return L8(r.view,t);{const a=Aw(r.view,t);return Ml(a)?a.step:a}}}function N9(e,t,n){return Ue(t,Object.assign({suffix:`by_${Ue(e)}`},n??{}))}class Hw extends E0e{constructor(t,n,r,i){super(t,"facet",n,r,i,t.resolve);this.child=M9(t.spec,this,this.getName("child"),void 0,i),this.children=[this.child],this.facet=this.initFacet(t.facet,i)}initFacet(t,n){return _w(t)?ime(t,(r,i,a)=>bt([jc,Uc],a)?i.field===void 0?(Me(Jj(i,a)),r):(r[a]=E8(i,a,n),r):(Me(yO(a,"facet")),r),{}):{facet:E8(t,"facet",n)}}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=dI(this),this.child.parseData()}parseLayoutSize(){I9(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),Lxt(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){var t,n,r;const i={};for(const a of _s)for(const o of h9){const s=this.component.layoutHeaders[a],u=s[o],{facetFieldDef:l}=s;if(l){const c=C0("titleOrient",l,this.config,a);if(bt(["right","bottom"],c)){const f=ZO(a,c);i.titleAnchor=(t=i.titleAnchor)!==null&&t!==void 0?t:{},i.titleAnchor[f]="end"}}if(u==null?void 0:u[0]){const c=a==="row"?"height":"width",f=o==="header"?"headerBand":"footerBand";a!=="facet"&&!this.child.component.layoutSize.get(c)&&(i[f]=(n=i[f])!==null&&n!==void 0?n:{},i[f][a]=.5),s.title&&(i.offset=(r=i.offset)!==null&&r!==void 0?r:{},i.offset[a==="row"?"rowTitle":"columnTitle"]=10)}}return i}assembleDefaultLayout(){const{column:t,row:n}=this.facet,r=t?this.columnDistinctSignal():n?1:void 0;let i="all";return(!n&&this.component.resolve.scale.x==="independent"||!t&&this.component.resolve.scale.y==="independent")&&(i="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),r?{columns:r}:{}),{bounds:"full",align:i})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof Hw))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroup(t){return this.parent&&this.parent instanceof Hw?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:Ue(this.facet.column,{prefix:"distinct"})}}}}:{}),super.assembleGroup(t)):super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],n=[],r=[];if(this.child instanceof Hw){if(this.child.channelHasField("column")){const i=Ue(this.child.facet.column);t.push(i),n.push("distinct"),r.push(`distinct_${i}`)}}else for(const i of Ss){const a=this.child.component.scales[i];if(a&&!a.merged){const o=a.get("type"),s=a.get("range");if(bo(o)&&Xd(s)){const u=nI(this.child,i),l=A9(u);l?(t.push(l),n.push("distinct"),r.push(`distinct_${l}`)):Me(`Unknown field for ${i}. Cannot calculate view size.`)}}}return{fields:t,ops:n,as:r}}assembleFacet(){const{name:t,data:n}=this.component.data.facetRoot,{row:r,column:i}=this.facet,{fields:a,ops:o,as:s}=this.getCardinalityAggregateForChild(),u=[];for(const c of _s){const f=this.facet[c];if(f){u.push(Ue(f));const{bin:d,sort:h}=f;if(Qn(d)&&u.push(Ue(f,{binSuffix:"end"})),Dl(h)){const{field:p,op:g=SO}=h,m=N9(f,h);r&&i?(a.push(m),o.push("max"),s.push(m)):(a.push(p),o.push(g),s.push(m))}else if(vt(h)){const p=E0(f,c);a.push(p),o.push("max"),s.push(p)}}}const l=!!r&&!!i;return Object.assign({name:t,data:n,groupby:u},l||a.length>0?{aggregate:Object.assign(Object.assign({},l?{cross:l}:{}),a.length?{fields:a,ops:o,as:s}:{})}:{})}facetSortFields(t){const{facet:n}=this,r=n[t];return r?Dl(r.sort)?[N9(r,r.sort,{expr:"datum"})]:vt(r.sort)?[E0(r,t,{expr:"datum"})]:[Ue(r,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:n}=this,r=n[t];if(r){const{sort:i}=r;return[(Dl(i)?i.order:!vt(i)&&i)||"ascending"]}return[]}assembleLabelTitle(){const{facet:t,config:n}=this;if(t.facet)return p9(t.facet,"facet",n);const r={row:["top","bottom"],column:["left","right"]};for(const i of d9)if(t[i]){const a=C0("labelOrient",t[i],n,i);if(bt(r[i],a))return p9(t[i],i,n)}}assembleMarks(){const{child:t}=this,n=this.component.data.facetRoot,r=Mxt(n),i=t.assembleGroupEncodeEntry(!1),a=this.assembleLabelTitle()||t.assembleTitle(),o=t.assembleGroupStyle();return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},a?{title:a}:{}),o?{style:o}:{}),{from:{facet:this.assembleFacet()},sort:{field:_s.map(u=>this.facetSortFields(u)).flat(),order:_s.map(u=>this.facetSortOrder(u)).flat()}}),r.length>0?{data:r}:{}),i?{encode:{update:i}}:{}),t.assembleGroup(syt(this,[])))]}getMapping(){return this.facet}}function Vxt(e,t){const{row:n,column:r}=t;if(n&&r){let i=null;for(const a of[n,r])if(Dl(a.sort)){const{field:o,op:s=SO}=a.sort;e=i=new mg(e,{joinaggregate:[{op:s,field:o,as:N9(a,a.sort,{forAs:!0})}],groupby:[Ue(a)]})}return i}return null}function T0e(e,t){var n,r,i,a,o,s,u,l,c,f;for(const d of t){const h=d.data;if(!(e.name&&d.hasName()&&e.name!==d.dataName)&&!(((n=e.format)===null||n===void 0?void 0:n.mesh)&&((r=h.format)===null||r===void 0?void 0:r.feature))&&!((((i=e.format)===null||i===void 0?void 0:i.feature)||((a=h.format)===null||a===void 0?void 0:a.feature))&&((o=e.format)===null||o===void 0?void 0:o.feature)!==((s=h.format)===null||s===void 0?void 0:s.feature))&&!((((u=e.format)===null||u===void 0?void 0:u.mesh)||((l=h.format)===null||l===void 0?void 0:l.mesh))&&((c=e.format)===null||c===void 0?void 0:c.mesh)!==((f=h.format)===null||f===void 0?void 0:f.mesh))){if($O(e)&&$O(h)){if(fw(e.values,h.values))return d}else if(kw(e)&&kw(h)){if(e.url===h.url)return d}else if(Lme(e)&&e.name===d.dataName)return d}}return null}function qxt(e,t){if(e.data||!e.parent){if(e.data===null){const r=new A0({values:[]});return t.push(r),r}const n=T0e(e.data,t);if(n)return cg(e.data)||(n.data.format=cpt({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const r=new A0(e.data);return t.push(r),r}}else return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function Hxt(e,t,n){var r,i;let a=0;for(const o of t.transforms){let s,u;if(I0t(o))u=e=new S0(e,o),s="derived";else if(jme(o)){const l=L1t(o);u=e=(r=da.makeWithAncestors(e,{},l,n))!==null&&r!==void 0?r:e,e=new _0(e,t,o.filter)}else if(N0t(o))u=e=Bl.makeFromTransform(e,o,t),s="number";else if(R0t(o))s="date",n.getWithExplicit(o.field).value===void 0&&(e=new da(e,{[o.field]:s}),n.set(o.field,s,!1)),u=e=Pl.makeFromTransform(e,o);else if(F0t(o))u=e=_u.makeFromTransform(e,o),s="number",J8(t)&&(e=new ih(e));else if(y0t(o))u=e=qw.make(e,t,o,a++),s="derived";else if(k0t(o))u=e=new T0(e,o),s="number";else if(T0t(o))u=e=new mg(e,o),s="number";else if(M0t(o))u=e=Qc.makeFromTransform(e,o),s="derived";else if(P0t(o))u=e=new aI(e,o),s="derived";else if(O0t(o))u=e=new iI(e,o),s="derived";else if(w0t(o))u=e=new lI(e,o),s="derived";else if(A0t(o))e=new cI(e,o);else if(D0t(o))u=e=vg.makeFromTransform(e,o),s="derived";else if(_0t(o))u=e=new rI(e,o),s="derived";else if(S0t(o))u=e=new sI(e,o),s="derived";else if(E0t(o))u=e=new uI(e,o),s="derived";else if(C0t(o))u=e=new oI(e,o),s="derived";else{Me(ggt(o));continue}if(u&&s!==void 0)for(const l of(i=u.producedFields())!==null&&i!==void 0?i:[])n.set(l,s,!1)}return e}function dI(e){var t,n,r,i,a,o,s,u,l,c;let f=qxt(e,e.component.data.sources);const{outputNodes:d,outputNodeRefCounts:h}=e.component.data,p=e.parent?e.parent.component.data.ancestorParse.clone():new m0t,g=e.data;cg(g)?(Bme(g)?f=new Uw(f,g.sequence):W8(g)&&(f=new jw(f,g.graticule)),p.parseNothing=!0):((t=g==null?void 0:g.format)===null||t===void 0?void 0:t.parse)===null&&(p.parseNothing=!0),f=(n=da.makeExplicit(f,e,p))!==null&&n!==void 0?n:f,f=new ih(f);const m=e.parent&&O0(e.parent);(Nr(e)||Eu(e))&&m&&(f=(r=Bl.makeFromEncoding(f,e))!==null&&r!==void 0?r:f),e.transforms.length>0&&(f=Hxt(f,e,p));const v=z1t(e),y=B1t(e);f=(i=da.makeWithAncestors(f,{},Object.assign(Object.assign({},v),y),p))!==null&&i!==void 0?i:f,Nr(e)&&(f=I0.parseAll(f,e),f=Vw.parseAll(f,e)),(Nr(e)||Eu(e))&&(m||(f=(a=Bl.makeFromEncoding(f,e))!==null&&a!==void 0?a:f),f=(o=Pl.makeFromEncoding(f,e))!==null&&o!==void 0?o:f,f=S0.parseAllForSortIndex(f,e));const b=e.getName(LO),x=new qa(f,b,LO,h);if(d[b]=x,f=x,Nr(e)){const _=_u.makeFromEncoding(f,e);_&&(f=_,J8(e)&&(f=new ih(f))),f=(s=vg.makeFromEncoding(f,e))!==null&&s!==void 0?s:f,f=(u=Qc.makeFromEncoding(f,e))!==null&&u!==void 0?u:f}Nr(e)&&(f=(l=Ww.make(f,e))!==null&&l!==void 0?l:f);const w=e.getName(sa),S=new qa(f,w,sa,h);d[w]=S,f=S,Nr(e)&&Fbt(e,S);let C=null;if(Eu(e)){const _=e.getName("facet");f=(c=Vxt(f,e.facet))!==null&&c!==void 0?c:f,C=new k0(f,e,_,S.getSource()),d[_]=C}return Object.assign(Object.assign({},e.component.data),{outputNodes:d,outputNodeRefCounts:h,raw:x,main:S,facetRoot:C,ancestorParse:p})}class Gxt extends O9{constructor(t,n,r,i){var a,o,s,u;super(t,"concat",n,r,i,t.resolve);(((o=(a=t.resolve)===null||a===void 0?void 0:a.axis)===null||o===void 0?void 0:o.x)==="shared"||((u=(s=t.resolve)===null||s===void 0?void 0:s.axis)===null||u===void 0?void 0:u.y)==="shared")&&Me(hgt),this.children=this.getChildren(t).map((l,c)=>M9(l,this,this.getName("concat_"+c),void 0,i))}parseData(){this.component.data=dI(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of Be(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return RO(t)?t.vconcat:$8(t)?t.hconcat:t.concat}parseLayoutSize(){jxt(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){const t=g9(this);for(const n of this.children)t.push(...n.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{const n=t.assembleTitle(),r=t.assembleGroupStyle(),i=t.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:t.getName("group")},n?{title:n}:{}),r?{style:r}:{}),i?{encode:{update:i}}:{}),t.assembleGroup())})}assembleDefaultLayout(){const t=this.layout.columns;return Object.assign(Object.assign({},t!=null?{columns:t}:{}),{bounds:"full",align:"each"})}}function Kxt(e){return e===!1||e===null}const Xxt=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},Epe),{labelExpr:1,encode:1}),O0e=Be(Xxt);class D9 extends Xc{constructor(t={},n={},r=!1){super();this.explicit=t,this.implicit=n,this.mainExtracted=r}clone(){return new D9(Yt(this.explicit),Yt(this.implicit),this.mainExtracted)}hasAxisPart(t){return t==="axis"?!0:t==="grid"||t==="title"?!!this.get(t):!Kxt(this.get(t))}hasOrientSignalRef(){return Et(this.explicit.orient)}}function Yxt(e,t,n){var r;const{encoding:i,config:a}=e,o=(r=hi(i[t]))!==null&&r!==void 0?r:hi(i[Tl(t)]),s=e.axis(t)||{},{format:u,formatType:l}=s;return ig(l)?Object.assign({text:g8({fieldOrDatumDef:o,field:"datum.value",format:u,formatType:l,config:a})},n):n}function Zxt(e){return Ss.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[iwt(n,e)]),t),{})}const Jxt={bottom:"top",top:"bottom",left:"right",right:"left"};function Qxt(e){var t;const{axes:n,resolve:r}=e.component,i={top:0,bottom:0,right:0,left:0};for(const a of e.children){a.parseAxesAndHeaders();for(const o of Be(a.component.axes))r.axis[o]=m9(e.component.resolve,o),r.axis[o]==="shared"&&(n[o]=ewt(n[o],a.component.axes[o]),n[o]||(r.axis[o]="independent",delete n[o]))}for(const a of Ss){for(const o of e.children)if(!!o.component.axes[a]){if(r.axis[a]==="independent"){n[a]=((t=n[a])!==null&&t!==void 0?t:[]).concat(o.component.axes[a]);for(const s of o.component.axes[a]){const{value:u,explicit:l}=s.getWithExplicit("orient");if(!Et(u)){if(i[u]>0&&!l){const c=Jxt[u];i[u]>i[c]&&s.set("orient",c,!1)}i[u]++}}}delete o.component.axes[a]}if(r.axis[a]==="independent"&&n[a]&&n[a].length>1)for(const o of n[a])!!o.get("grid")&&!o.explicit.grid&&(o.implicit.grid=!1)}}function ewt(e,t){if(e){if(e.length!==t.length)return;const n=e.length;for(let r=0;r<n;r++){const i=e[r],a=t[r];if(!!i!=!!a)return;if(i&&a){const o=i.getWithExplicit("orient"),s=a.getWithExplicit("orient");if(o.explicit&&s.explicit&&o.value!==s.value)return;e[r]=twt(i,a)}}}else return t.map(n=>n.clone());return e}function twt(e,t){for(const n of O0e){const r=eh(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(i,a)=>{switch(n){case"title":return rme(i,a);case"gridScale":return{explicit:i.explicit,value:Qr(i.value,a.value)}}return PO(i,a,n,"axis")});e.setWithExplicit(n,r)}return e}function nwt(e,t,n,r,i){if(t==="disable")return n!==void 0;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(Et(n.labelAngle)?n.labelAngle:nO(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===Mve(r,i))return!0}return e===n[t]}const rwt=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function iwt(e,t){var n,r,i;let a=t.axis(e);const o=new D9,s=hi(t.encoding[e]),{mark:u,config:l}=t,c=(a==null?void 0:a.orient)||((n=l[e==="x"?"axisX":"axisY"])===null||n===void 0?void 0:n.orient)||((r=l.axis)===null||r===void 0?void 0:r.orient)||Hbt(e),f=t.getScaleComponent(e).get("type"),d=Bbt(e,f,c,t.config),h=a!==void 0?!a:c9("disable",l,a==null?void 0:a.style,d).configValue;if(o.set("disable",h,a!==void 0),h)return o;a=a||{};const p=Wbt(t,a,e,s,d),g={fieldOrDatumDef:s,axis:a,channel:e,model:t,scaleType:f,orient:c,labelAngle:p,mark:u,config:l};for(const y of O0e){const b=y in Dve?Dve[y](g):Cpe(y)?a[y]:void 0,x=b!==void 0,w=nwt(b,y,a,t,e);if(x&&w)o.set(y,b,w);else{const{configValue:S=void 0,configFrom:C=void 0}=Cpe(y)&&y!=="values"?c9(y,t.config,a.style,d):{},_=S!==void 0;x&&!_?o.set(y,b,w):(C!=="vgAxisConfig"||rwt.has(y)&&_||Uj(S)||Et(S))&&o.set(y,S,!1)}}const m=(i=a.encoding)!==null&&i!==void 0?i:{},v=Spe.reduce((y,b)=>{var x;if(!o.hasAxisPart(b))return y;const w=Uve((x=m[b])!==null&&x!==void 0?x:{},t),S=b==="labels"?Yxt(t,e,w):w;return S!==void 0&&!Yn(S)&&(y[b]={update:S}),y},{});return Yn(v)||o.set("encode",v,!!a.encoding||a.labelAngle!==void 0),o}function awt({encoding:e,size:t}){for(const n of Ss){const r=Ol(n);Ml(t[r])&&Rl(e[n])&&(delete t[r],Me(rge(r)))}return t}function owt(e,t,n,{graticule:r}){const i=wl(e)?Object.assign({},e):{type:e},a=Fn("orient",i,n);if(i.orient=cwt(i.type,t,a),a!==void 0&&a!==i.orient&&Me(Ogt(i.orient,a)),i.type==="bar"&&i.orient){const l=Fn("cornerRadiusEnd",i,n);if(l!==void 0){const c=i.orient==="horizontal"&&t.x2||i.orient==="vertical"&&t.y2?["cornerRadius"]:Ipt[i.orient];for(const f of c)i[f]=l;i.cornerRadiusEnd!==void 0&&delete i.cornerRadiusEnd}}return Fn("opacity",i,n)===void 0&&(i.opacity=uwt(i.type,t)),i.filled===void 0&&(i.filled=r?!1:lwt(i,n)),Fn("cursor",i,n)===void 0&&(i.cursor=swt(i,t,n)),i}function swt(e,t,n){return t.href||e.href||Fn("href",e,n)?"pointer":e.cursor}function uwt(e,t){if(bt([oO,Wj,Vj,qj],e)&&!A8(t))return .7}function lwt(e,t){const n=sg("filled",e,t),r=e.type;return Qr(n,r!==oO&&r!==aO&&r!==sO)}function cwt(e,t,n){switch(e){case oO:case Vj:case qj:case kpe:case _pt:case wpt:return}const{x:r,y:i,x2:a,y2:o}=t;switch(e){case iO:if(We(r)&&(Wa(r.bin)||We(i)&&i.aggregate&&!r.aggregate))return"vertical";if(We(i)&&(Wa(i.bin)||We(r)&&r.aggregate&&!i.aggregate))return"horizontal";if(o||a){if(n)return n;if(!a&&(We(r)&&r.type===ng&&!Qn(r.bin)||x8(r)))return"horizontal";if(!o&&(We(i)&&i.type===ng&&!Qn(i.bin)||x8(i)))return"vertical"}case sO:if(a&&!(We(r)&&Wa(r.bin))&&o&&!(We(i)&&Wa(i.bin)))return;case rO:if(o)return We(i)&&Wa(i.bin)?"horizontal":"vertical";if(a)return We(r)&&Wa(r.bin)?"vertical":"horizontal";if(e===sO){if(r&&!i)return"vertical";if(i&&!r)return"horizontal"}case aO:case Wj:{const s=Rl(r),u=Rl(i);if(s&&!u)return e!=="tick"?"horizontal":"vertical";if(!s&&u)return e!=="tick"?"vertical":"horizontal";if(s&&u){const l=r,c=i,f=l.type===v0,d=c.type===v0;return f&&!d?e!=="tick"?"vertical":"horizontal":!f&&d?e!=="tick"?"horizontal":"vertical":!l.aggregate&&c.aggregate?e!=="tick"?"vertical":"horizontal":l.aggregate&&!c.aggregate?e!=="tick"?"horizontal":"vertical":n||"vertical"}else return n||void 0}}return"vertical"}const fwt={vgMark:"arc",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Cs(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),ua("x",e,{defaultPos:"mid"})),ua("y",e,{defaultPos:"mid"})),th(e,"radius","arc")),th(e,"theta","arc"))},dwt={vgMark:"area",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Cs(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),zO("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"})),zO("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"})),H8(e))},hwt={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Cs(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),th(e,"x","bar")),th(e,"y","bar"))},pwt={vgMark:"shape",encodeEntry:e=>Object.assign({},Cs(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[Object.assign({type:"geoshape",projection:e.projectionName()},n&&We(n)&&n.type===y0?{field:Ue(n,{expr:"datum"})}:{})]}},gwt={vgMark:"image",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Cs(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),th(e,"x","image")),th(e,"y","image")),V8(e,"url"))},mwt={vgMark:"line",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Cs(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),ua("x",e,{defaultPos:"mid"})),ua("y",e,{defaultPos:"mid"})),ki("size",e,{vgChannel:"strokeWidth"})),H8(e))},vwt={vgMark:"trail",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Cs(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),ua("x",e,{defaultPos:"mid"})),ua("y",e,{defaultPos:"mid"})),ki("size",e)),H8(e))};function R9(e,t){const{config:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Cs(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),ua("x",e,{defaultPos:"mid"})),ua("y",e,{defaultPos:"mid"})),ki("size",e)),ki("angle",e)),ywt(e,n,t))}function ywt(e,t,n){return n?{shape:{value:n}}:ki("shape",e)}const bwt={vgMark:"symbol",encodeEntry:e=>R9(e)},xwt={vgMark:"symbol",encodeEntry:e=>R9(e,"circle")},wwt={vgMark:"symbol",encodeEntry:e=>R9(e,"square")},_wt={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Cs(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),th(e,"x","rect")),th(e,"y","rect"))},Swt={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude?{}:Object.assign(Object.assign(Object.assign(Object.assign({},Cs(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),zO("x",e,{defaultPos:n==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="vertical"})),zO("y",e,{defaultPos:n==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="horizontal"})),ki("size",e,{vgChannel:"strokeWidth"}))}},Ewt={vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Cs(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),ua("x",e,{defaultPos:"mid"})),ua("y",e,{defaultPos:"mid"})),V8(e)),ki("size",e,{vgChannel:"fontSize"})),ki("angle",e)),Yme("align",Cwt(e.markDef,n,t))),Yme("baseline",Awt(e.markDef,n,t))),ua("radius",e,{defaultPos:null,isMidPoint:!0})),ua("theta",e,{defaultPos:null,isMidPoint:!0}))}};function Cwt(e,t,n){if(Fn("align",e,n)===void 0)return"center"}function Awt(e,t,n){if(Fn("baseline",e,n)===void 0)return"middle"}const kwt={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,r=n.orient,i=r==="horizontal"?"width":"height",a=r==="horizontal"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Cs(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),ua("x",e,{defaultPos:"mid",vgChannel:"xc"})),ua("y",e,{defaultPos:"mid",vgChannel:"yc"})),ki("size",e,{defaultValue:Twt(e),vgChannel:i})),{[a]:zr(Fn("thickness",n,t))})}};function Twt(e){var t;const{config:n,markDef:r}=e,{orient:i}=r,a=i==="horizontal"?"width":"height",o=e.getScaleComponent(i==="horizontal"?"x":"y"),s=(t=Fn("size",r,n,{vgChannel:a}))!==null&&t!==void 0?t:n.tick.bandSize;if(s!==void 0)return s;{const u=o?o.get("range"):void 0;return u&&Xd(u)&&Jr(u.step)?u.step*3/4:FO(n.view,a)*3/4}}const hI={arc:fwt,area:dwt,bar:hwt,circle:xwt,geoshape:pwt,image:gwt,line:mwt,point:bwt,rect:_wt,rule:Swt,square:wwt,text:Ewt,tick:kwt,trail:vwt};function Owt(e){return bt([aO,rO,Spt],e.mark)?Iwt(e):bt([iO],e.mark)?Nwt(e):pI(e)}const I0e="faceted_path_";function Iwt(e){const t=ame(e.mark,e.encoding),n=pI(e,{fromPrefix:t.length>0?I0e:""});return t.length>0?[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:I0e+e.requestDataName(sa),data:e.requestDataName(sa),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:n}]:n}const N0e="stack_group_";function Nwt(e){const t=i8.some(n=>Fn(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t){const[n]=pI(e,{fromPrefix:N0e}),r=e.scaleName(e.stack.fieldChannel),i=(f={})=>e.vgField(e.stack.fieldChannel,f),a=(f,d)=>{const h=[i({prefix:"min",suffix:"start",expr:d}),i({prefix:"max",suffix:"start",expr:d}),i({prefix:"min",suffix:"end",expr:d}),i({prefix:"max",suffix:"end",expr:d})];return`${f}(${h.map(p=>`scale('${r}',${p})`).join(",")})`};let o,s;e.stack.fieldChannel==="x"?(o=Object.assign(Object.assign({},dw(n.encode.update,["y","yc","y2","height",...i8])),{x:{signal:a("min","datum")},x2:{signal:a("max","datum")},clip:{value:!0}}),s={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},n.encode.update=Object.assign(Object.assign({},Bc(n.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(o=Object.assign(Object.assign({},dw(n.encode.update,["x","xc","x2","width"])),{y:{signal:a("min","datum")},y2:{signal:a("max","datum")},clip:{value:!0}}),s={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},n.encode.update=Object.assign(Object.assign({},Bc(n.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));for(const f of i8){const d=sg(f,e.markDef,e.config);n.encode.update[f]?(o[f]=n.encode.update[f],delete n.encode.update[f]):d&&(o[f]=zr(d)),d&&(n.encode.update[f]={value:0})}const u=e.fieldDef(e.stack.groupbyChannel),l=Ue(u)?[Ue(u)]:[];return((u==null?void 0:u.bin)||(u==null?void 0:u.timeUnit))&&l.push(Ue(u,{binSuffix:"end"})),o=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((f,d)=>{if(n.encode.update[d])return Object.assign(Object.assign({},f),{[d]:n.encode.update[d]});{const h=sg(d,e.markDef,e.config);return h!==void 0?Object.assign(Object.assign({},f),{[d]:zr(h)}):f}},o),o.stroke&&(o.strokeForeground={value:!0},o.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(sa),name:N0e+e.requestDataName(sa),groupby:l,aggregate:{fields:[i({suffix:"start"}),i({suffix:"start"}),i({suffix:"end"}),i({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:o},marks:[{type:"group",encode:{update:s},marks:[n]}]}]}else return pI(e)}function Dwt(e){const{encoding:t,stack:n,mark:r,markDef:i,config:a}=e,o=t.order;if(!(!vt(o)&&Gc(o)&&ppe(o.value)||!o&&ppe(Fn("order",i,a)))){if((vt(o)||We(o))&&!n)return eme(o,{expr:"datum"});if(Zp(r)){const s=i.orient==="horizontal"?"y":"x",u=t[s];if(We(u)){const l=u.sort;if(vt(l))return{field:Ue(u,{prefix:s,suffix:"sort_index",expr:"datum"})};if(Dl(l))return{field:Ue({aggregate:A8(e.encoding)?l.op:void 0,field:l.field},{expr:"datum"})};if(Pge(l)){const c=e.fieldDef(l.encoding);return{field:Ue(c,{expr:"datum"}),order:l.order}}else return l===null?void 0:{field:Ue(u,{binSuffix:e.stack&&e.stack.impute?"mid":void 0,expr:"datum"})}}return}}}function pI(e,t={fromPrefix:""}){const{mark:n,markDef:r,config:i}=e,a=Qr(r.clip,Rwt(e),Fwt(e)),o=Jge(r),s=e.encoding.key,u=Dwt(e),l=Mwt(e),c=Fn("aria",r,i),f=hI[n].postEncodingTransform?hI[n].postEncodingTransform(e):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("marks"),type:hI[n].vgMark},a?{clip:!0}:{}),o?{style:o}:{}),s?{key:s.field}:{}),u?{sort:u}:{}),l||{}),c===!1?{aria:c}:{}),{from:{data:t.fromPrefix+e.requestDataName(sa)},encode:{update:hI[n].encodeEntry(e)}}),f?{transform:f}:{})]}function Rwt(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return t&&t.get("selectionExtent")||n&&n.get("selectionExtent")?!0:void 0}function Fwt(e){const t=e.component.projection;return t&&!t.isFit?!0:void 0}function Mwt(e){if(!e.component.selection)return null;const t=Be(e.component.selection).length;let n=t,r=e.parent;for(;r&&n===0;)n=Be(r.component.selection).length,r=r.parent;return n?{interactive:t>0}:null}class D0e extends E0e{constructor(t,n,r,i={},a){var o,s;super(t,"unit",n,r,a,void 0,bme(t)?t.view:void 0);this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection={},this.children=[];const u=wl(t.mark)?t.mark.type:t.mark;this.markDef=owt(t.mark,(o=t.encoding)!==null&&o!==void 0?o:{},a,{graticule:t.data&&W8(t.data)});const l=this.encoding=pvt((s=t.encoding)!==null&&s!==void 0?s:{},this.markDef,a);this.size=awt({encoding:l,size:bme(t)?Object.assign(Object.assign(Object.assign({},i),t.width?{width:t.width}:{}),t.height?{height:t.height}:{}):i}),this.stack=Ame(u,l),this.specifiedScales=this.initScales(u,l),this.specifiedAxes=this.initAxes(l),this.specifiedLegends=this.initLegend(l),this.specifiedProjection=t.projection,this.selection=t.selection}get hasProjection(){const{encoding:t}=this,n=this.mark===Tpe,r=t&&qpt.some(i=>It(t[i]));return n||r}scaleDomain(t){const n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return gO.reduce((r,i)=>{var a;const o=hi(n[i]);return o&&(r[i]=(a=o.scale)!==null&&a!==void 0?a:{}),r},{})}initAxes(t){return Ss.reduce((n,r)=>{const i=t[r];if(It(i)||r===br&&It(t.x2)||r===di&&It(t.y2)){const a=It(i)?i.axis:void 0;n[r]=a&&Object.assign({},a)}return n},{})}initLegend(t){return Qpt.reduce((n,r)=>{const i=hi(t[r]);if(i&&tgt(r)){const a=i.legend;n[r]=a&&Object.assign({},a)}return n},{})}parseData(){this.component.data=dI(this)}parseLayoutSize(){Uxt(this)}parseSelections(){this.component.selection=Rbt(this,this.selection)}parseMarkGroup(){this.component.mark=Owt(this)}parseAxesAndHeaders(){this.component.axes=Zxt(this)}assembleSelectionTopLevelSignals(t){return uyt(this,t)}assembleSignals(){return[...Tve(this),...oyt(this,[])]}assembleSelectionData(t){return lyt(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return g9(this)}assembleMarks(){var t;let n=(t=this.component.mark)!==null&&t!==void 0?t:[];return(!this.parent||!O0(this.parent))&&(n=sve(this,n)),n.map(this.correctDataNames)}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return ug(this.encoding,t)}fieldDef(t){const n=this.encoding[t];return Fl(n)}typedFieldDef(t){const n=this.fieldDef(t);return Go(n)?n:null}}class F9 extends O9{constructor(t,n,r,i,a){super(t,"layer",n,r,a,t.resolve,t.view);const o=Object.assign(Object.assign(Object.assign({},i),t.width?{width:t.width}:{}),t.height?{height:t.height}:{});this.children=t.layer.map((s,u)=>{if(MO(s))return new F9(s,this,this.getName("layer_"+u),o,a);if(zc(s))return new D0e(s,this,this.getName("layer_"+u),o,a);throw new Error(Zj(s))})}parseData(){this.component.data=dI(this);for(const t of this.children)t.parseData()}parseLayoutSize(){zxt(this)}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of Be(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){Qxt(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,r)=>r.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSignals()),Tve(this))}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),g9(this))}assembleSelectionData(t){return this.children.reduce((n,r)=>r.assembleSelectionData(n),t)}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return cyt(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),Qve(this))}}function M9(e,t,n,r,i){if(EO(e))return new Hw(e,t,n,i);if(MO(e))return new F9(e,t,n,r,i);if(zc(e))return new D0e(e,t,n,r,i);if(Mvt(e))return new Gxt(e,t,n,i);throw new Error(Zj(e))}function Pwt(e,t={}){t.logger&&emt(t.logger),t.fieldTitle&&Hge(t.fieldTitle);try{const n=Sme(dpe(t.config,e.config)),r=Fme(e,n),i=M9(r,null,"",void 0,n);return i.parse(),nxt(i.component.data,i),{spec:Lwt(i,$wt(e,r.autosize,n,i),e.datasets,e.usermeta),normalized:r}}finally{t.logger&&tmt(),t.fieldTitle&&svt()}}function $wt(e,t,n,r){const i=r.component.layoutSize.get("width"),a=r.component.layoutSize.get("height");if(t===void 0?(t={type:"pad"},r.hasAxisOrientSignalRef()&&(t.resize=!0)):Xt(t)&&(t={type:t}),i&&a&&h0t(t.type)){if(i==="step"&&a==="step")Me(Kpe()),t.type="pad";else if(i==="step"||a==="step"){const o=i==="step"?"width":"height";Me(Kpe(pO(o)));const s=o==="width"?"height":"width";t.type=p0t(s)}}return Object.assign(Object.assign(Object.assign({},Be(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t}),Pme(n)),Pme(e))}function Lwt(e,t,n={},r){const i=e.config?Gvt(e.config):void 0,a=[].concat(e.assembleSelectionData([]),Pxt(e.component.data,n)),o=e.assembleProjections(),s=e.assembleTitle(),u=e.assembleGroupStyle(),l=e.assembleGroupEncodeEntry(!0);let c=e.assembleLayoutSignals();return c=c.filter(f=>(f.name==="width"||f.name==="height")&&f.value!==void 0?(t[f.name]=+f.value,!1):!0),Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),t),s?{title:s}:{}),u?{style:u}:{}),l?{encode:{update:l}}:{}),{data:a}),o.length>0?{projections:o}:{}),e.assembleGroup([...c,...e.assembleSelectionTopLevelSignals([])])),i?{config:i}:{}),r?{usermeta:r}:{})}class Bwt extends Eme{mapUnit(t,{config:n}){if(t.encoding){const{encoding:r,transform:i}=t,{bins:a,timeUnits:o,aggregate:s,groupby:u,encoding:l}=k8(r,n),c=[...i||[],...a,...o,...s.length===0?[]:[{aggregate:s,groupby:u}]];return Object.assign(Object.assign(Object.assign({},t),c.length>0?{transform:c}:{}),{encoding:l})}else return t}}const zwt=new Bwt;function jwt(e,t){return zwt.map(e,{config:t})}const Uwt=Kht.version;var Wwt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",normalize:Fme,version:Uwt,compile:Pwt,extractTransforms:jwt});function R0e(e){const[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}}var Vwt="vega-themes",qwt="2.10.0",Hwt="Themes for stylized Vega and Vega-Lite visualizations.",Gwt=["vega","vega-lite","themes","style"],Kwt="BSD-3-Clause",Xwt={name:"UW Interactive Data Lab",url:"https://idl.cs.washington.edu"},Ywt=[{name:"Emily Gu",url:"https://github.com/emilygu"},{name:"Arvind Satyanarayan",url:"http://arvindsatya.com"},{name:"Jeffrey Heer",url:"https://idl.cs.washington.edu"},{name:"Dominik Moritz",url:"https://www.domoritz.de"}],Zwt="build/vega-themes.js",Jwt="build/vega-themes.module.js",Qwt="build/vega-themes.min.js",e2t="build/vega-themes.min.js",t2t="build/vega-themes.module.d.ts",n2t={type:"git",url:"https://github.com/vega/vega-themes.git"},r2t=["src","build"],i2t={prebuild:"yarn clean",build:"rollup -c",clean:"rimraf build && rimraf examples/build","copy:data":"rsync -r node_modules/vega-datasets/data/* examples/data","copy:build":"rsync -r build/* examples/build","deploy:gh":"yarn build && mkdir -p examples/build && rsync -r build/* examples/build && gh-pages -d examples",prepublishOnly:"yarn clean && yarn build",preversion:"yarn lint",serve:"browser-sync start -s -f build examples --serveStatic examples",start:"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'",prepare:"beemo create-config",eslintbase:"beemo eslint .",format:"yarn eslintbase --fix",lint:"yarn eslintbase"},a2t={"@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^11.2.0","@wessberg/rollup-plugin-ts":"^1.3.8","browser-sync":"^2.26.14",concurrently:"^6.0.0","gh-pages":"^3.1.0",rollup:"^2.39.1","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-terser":"^7.0.2",typescript:"^4.2.2",vega:"^5.19.1","vega-lite":"^5.0.0","vega-lite-dev-config":"^0.16.1"},o2t={vega:"*","vega-lite":"*"},s2t={name:Vwt,version:qwt,description:Hwt,keywords:Gwt,license:Kwt,author:Xwt,contributors:Ywt,main:Zwt,module:Jwt,unpkg:Qwt,jsdelivr:e2t,types:t2t,repository:n2t,files:r2t,scripts:i2t,devDependencies:a2t,peerDependencies:o2t};const N0="#fff",u2t="#888",l2t={background:"#333",title:{color:N0,subtitleColor:N0},style:{"guide-label":{fill:N0},"guide-title":{fill:N0}},axis:{domainColor:N0,gridColor:u2t,tickColor:N0}},yg="#4572a7",c2t={background:"#fff",arc:{fill:yg},area:{fill:yg},line:{stroke:yg,strokeWidth:2},path:{stroke:yg},rect:{fill:yg},shape:{stroke:yg},symbol:{fill:yg,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},bg="#30a2da",P9="#cbcbcb",f2t="#999",d2t="#333",F0e="#f0f0f0",M0e="#333",h2t={arc:{fill:bg},area:{fill:bg},axis:{domainColor:P9,grid:!0,gridColor:P9,gridWidth:1,labelColor:f2t,labelFontSize:10,titleColor:d2t,tickColor:P9,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:F0e,group:{fill:F0e},legend:{labelColor:M0e,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:M0e,titleFontSize:14,titlePadding:10},line:{stroke:bg,strokeWidth:2},path:{stroke:bg,strokeWidth:.5},rect:{fill:bg},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:bg},bar:{binSpacing:2,fill:bg,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},xg="#000",p2t={group:{fill:"#e5e5e5"},arc:{fill:xg},area:{fill:xg},line:{stroke:xg},path:{stroke:xg},rect:{fill:xg},shape:{stroke:xg},symbol:{fill:xg,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},g2t=22,m2t="normal",P0e="Benton Gothic, sans-serif",$0e=11.5,v2t="normal",wg="#82c6df",$9="Benton Gothic Bold, sans-serif",L0e="normal",B0e=13,Gw={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},y2t={background:"#ffffff",title:{anchor:"start",color:"#000000",font:$9,fontSize:g2t,fontWeight:m2t},arc:{fill:wg},area:{fill:wg},line:{stroke:wg,strokeWidth:2},path:{stroke:wg},rect:{fill:wg},shape:{stroke:wg},symbol:{fill:wg,size:30},axis:{labelFont:P0e,labelFontSize:$0e,labelFontWeight:v2t,titleFont:$9,titleFontSize:B0e,titleFontWeight:L0e},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:P0e,labelFontSize:$0e,symbolType:"square",titleFont:$9,titleFontSize:B0e,titleFontWeight:L0e},range:{category:Gw["category-6"],diverging:Gw["fireandice-6"],heatmap:Gw["fire-7"],ordinal:Gw["fire-7"],ramp:Gw["fire-7"]}},_g="#ab5787",gI="#979797",b2t={background:"#f9f9f9",arc:{fill:_g},area:{fill:_g},line:{stroke:_g},path:{stroke:_g},rect:{fill:_g},shape:{stroke:_g},symbol:{fill:_g,size:30},axis:{domainColor:gI,domainWidth:.5,gridWidth:.2,labelColor:gI,tickColor:gI,tickWidth:.2,titleColor:gI},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},Sg="#3e5c69",x2t={background:"#fff",arc:{fill:Sg},area:{fill:Sg},line:{stroke:Sg},path:{stroke:Sg},rect:{fill:Sg},shape:{stroke:Sg},symbol:{fill:Sg},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},As="#1696d2",z0e="#000000",w2t="#FFFFFF",mI="Lato",L9="Lato",_2t="Lato",S2t="#DEDDDD",E2t=18,Kw={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},C2t={background:w2t,title:{anchor:"start",fontSize:E2t,font:mI},axisX:{domain:!0,domainColor:z0e,domainWidth:1,grid:!1,labelFontSize:12,labelFont:L9,labelAngle:0,tickColor:z0e,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:mI},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:S2t,gridWidth:1,labelFontSize:12,labelFont:L9,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:mI,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:L9,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:mI,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:Kw["six-groups-cat-1"],diverging:Kw["diverging-colors"],heatmap:Kw["diverging-colors"],ordinal:Kw["six-groups-seq"],ramp:Kw["shades-blue"]},area:{fill:As},rect:{fill:As},line:{color:As,stroke:As,strokeWidth:5},trail:{color:As,stroke:As,strokeWidth:0,size:1},path:{stroke:As,strokeWidth:.5},point:{filled:!0},text:{font:_2t,color:As,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:As,stroke:null}},arc:{fill:As},shape:{stroke:As},symbol:{fill:As,size:30}},Eg="#3366CC",j0e="#ccc",vI="Arial, sans-serif",A2t={arc:{fill:Eg},area:{fill:Eg},path:{stroke:Eg},rect:{fill:Eg},shape:{stroke:Eg},symbol:{stroke:Eg},circle:{fill:Eg},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:vI,fontSize:12},"guide-title":{font:vI,fontSize:12},"group-title":{font:vI,fontSize:12}},title:{font:vI,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:j0e,tickColor:j0e,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},k2t=s2t.version;var T2t=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",dark:l2t,excel:c2t,fivethirtyeight:h2t,ggplot2:p2t,googlecharts:A2t,latimes:y2t,quartz:b2t,urbaninstitute:C2t,version:k2t,vox:x2t}),O2t=`#vg-tooltip-element {
  visibility: hidden;
  padding: 8px;
  position: fixed;
  z-index: 1000;
  font-family: sans-serif;
  font-size: 11px;
  border-radius: 3px;
  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  /* The default theme is the light theme. */
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid #d9d9d9;
  color: black; }
  #vg-tooltip-element.visible {
    visibility: visible; }
  #vg-tooltip-element h2 {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 13px; }
  #vg-tooltip-element img {
    max-width: 200px;
    max-height: 200px; }
  #vg-tooltip-element table {
    border-spacing: 0; }
    #vg-tooltip-element table tr {
      border: none; }
      #vg-tooltip-element table tr td {
        overflow: hidden;
        text-overflow: ellipsis;
        padding-top: 2px;
        padding-bottom: 2px; }
        #vg-tooltip-element table tr td.key {
          color: #808080;
          max-width: 150px;
          text-align: right;
          padding-right: 4px; }
        #vg-tooltip-element table tr td.value {
          display: block;
          max-width: 300px;
          max-height: 7em;
          text-align: left; }
  #vg-tooltip-element.dark-theme {
    background-color: rgba(32, 32, 32, 0.9);
    border: 1px solid #f5f5f5;
    color: white; }
    #vg-tooltip-element.dark-theme td.key {
      color: #bfbfbf; }
`;const U0e="vg-tooltip-element",I2t={offsetX:10,offsetY:10,id:U0e,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:N2t,maxDepth:2};function N2t(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function D2t(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return O2t.toString().replace(U0e,e)}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function R2t(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function F2t(e,t,n){if(ut(e))return`[${e.map(r=>t(Bn(r)?r:W0e(r,n))).join(", ")}]`;if(Nt(e)){let r="";const i=e,{title:a,image:o}=i,s=R2t(i,["title","image"]);a&&(r+=`<h2>${t(a)}</h2>`),o&&(r+=`<img src="${t(o)}">`);const u=Object.keys(s);if(u.length>0){r+="<table>";for(const l of u){let c=s[l];c!==void 0&&(Nt(c)&&(c=W0e(c,n)),r+=`<tr><td class="key">${t(l)}:</td><td class="value">${t(c)}</td></tr>`)}r+="</table>"}return r||"{}"}return t(e)}function M2t(e){const t=[];return function(n,r){if(typeof r!="object"||r===null)return r;const i=t.indexOf(this)+1;return t.length=i,t.length>e?"[Object]":t.indexOf(r)>=0?"[Circular]":(t.push(r),r)}}function W0e(e,t){return JSON.stringify(e,M2t(t))}function P2t(e,t,n,r){let i=e.clientX+n;i+t.width>window.innerWidth&&(i=+e.clientX-n-t.width);let a=e.clientY+r;return a+t.height>window.innerHeight&&(a=+e.clientY-r-t.height),{x:i,y:a}}class $2t{constructor(t){this.options=Object.assign(Object.assign({},I2t),t);const n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const r=document.createElement("style");r.setAttribute("id",this.options.styleId),r.innerHTML=D2t(n);const i=document.head;i.childNodes.length>0?i.insertBefore(r,i.childNodes[0]):i.appendChild(r)}}tooltipHandler(t,n,r,i){if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el)),(document.fullscreenElement!=null?document.fullscreenElement:document.body).appendChild(this.el),i==null||i===""){this.el.classList.remove("visible",`${this.options.theme}-theme`);return}this.el.innerHTML=F2t(i,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:o,y:s}=P2t(n,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${s}px; left: ${o}px`)}}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function yI(e,t,n,r){function i(a){return a instanceof n?a:new n(function(o){o(a)})}return new(n||(n=Promise))(function(a,o){function s(c){try{l(r.next(c))}catch(f){o(f)}}function u(c){try{l(r.throw(c))}catch(f){o(f)}}function l(c){c.done?a(c.value):i(c.value).then(s,u)}l((r=r.apply(e,t||[])).next())})}function L2t(e,t,n){const r=e.open(t),i=1e4,a=250,{origin:o}=new URL(t);let s=~~(i/a);function u(c){c.source===r&&(s=0,e.removeEventListener("message",u,!1))}e.addEventListener("message",u,!1);function l(){s<=0||(r.postMessage(n,o),setTimeout(l,a),s-=1)}setTimeout(l,a)}var B2t=`.vega-embed {
  position: relative;
  display: inline-block;
  box-sizing: border-box; }
  .vega-embed.has-actions {
    padding-right: 38px; }
  .vega-embed details:not([open]) > :not(summary) {
    display: none !important; }
  .vega-embed summary {
    list-style: none;
    position: absolute;
    top: 0;
    right: 0;
    padding: 6px;
    z-index: 1000;
    background: white;
    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
    color: #1b1e23;
    border: 1px solid #aaa;
    border-radius: 999px;
    opacity: 0.2;
    transition: opacity 0.4s ease-in;
    outline: none;
    cursor: pointer;
    line-height: 0px; }
    .vega-embed summary::-webkit-details-marker {
      display: none; }
    .vega-embed summary:active {
      box-shadow: #aaa 0px 0px 0px 1px inset; }
    .vega-embed summary svg {
      width: 14px;
      height: 14px; }
  .vega-embed details[open] summary {
    opacity: 0.7; }
  .vega-embed:hover summary,
  .vega-embed:focus summary {
    opacity: 1 !important;
    transition: opacity 0.2s ease; }
  .vega-embed .vega-actions {
    position: absolute;
    z-index: 1001;
    top: 35px;
    right: -9px;
    display: flex;
    flex-direction: column;
    padding-bottom: 8px;
    padding-top: 8px;
    border-radius: 4px;
    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
    border: 1px solid #d9d9d9;
    background: white;
    animation-duration: 0.15s;
    animation-name: scale-in;
    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);
    text-align: left; }
    .vega-embed .vega-actions a {
      padding: 8px 16px;
      font-family: sans-serif;
      font-size: 14px;
      font-weight: 600;
      white-space: nowrap;
      color: #434a56;
      text-decoration: none; }
      .vega-embed .vega-actions a:hover {
        background-color: #f7f7f9;
        color: black; }
    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
      content: "";
      display: inline-block;
      position: absolute; }
    .vega-embed .vega-actions::before {
      left: auto;
      right: 14px;
      top: -16px;
      border: 8px solid #0000;
      border-bottom-color: #d9d9d9; }
    .vega-embed .vega-actions::after {
      left: auto;
      right: 15px;
      top: -14px;
      border: 7px solid #0000;
      border-bottom-color: #fff; }
  .vega-embed .chart-wrapper {
    width: 100%;
    height: 100%; }

.vega-embed-wrapper {
  max-width: 100%;
  overflow: auto;
  padding-right: 14px; }

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6); }
  to {
    opacity: 1;
    transform: scale(1); } }
`;String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e});function V0e(e,...t){for(const n of t)z2t(e,n);return e}function z2t(e,t){for(const n of Object.keys(t))PC(e,n,t[n],!0)}var B9;const ef=Aht;let D0=Wwt;const bI=typeof window!="undefined"?window:void 0;D0===void 0&&((B9=bI==null?void 0:bI.vl)===null||B9===void 0?void 0:B9.compile)&&(D0=bI.vl);const q0e={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},j2t={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},Xw={vega:"Vega","vega-lite":"Vega-Lite"},xI={vega:ef.version,"vega-lite":D0?D0.version:"not available"},U2t={vega:e=>e,"vega-lite":(e,t)=>D0.compile(e,{config:t}).spec},W2t=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`,V2t="chart-wrapper";function q2t(e){return typeof e=="function"}function H0e(e,t,n,r){const i=`<html><head>${t}</head><body><pre><code class="json">`,a=`</code></pre>${n}</body></html>`,o=window.open("");o.document.write(i+e+a),o.document.title=`${Xw[r]} JSON Source`}function G0e(e,t){var n;if(e.$schema){const r=R0e(e.$schema);t&&t!==r.library&&console.warn(`The given visualization spec is written in ${Xw[r.library]}, but mode argument sets ${(n=Xw[t])!==null&&n!==void 0?n:t}.`);const i=r.library;return Nne.satisfies(xI[i],`^${r.version.slice(1)}`)||console.warn(`The input spec uses ${Xw[i]} ${r.version}, but the current version of ${Xw[i]} is v${xI[i]}.`),i}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":t??"vega"}function H2t(e){return!!(e&&"load"in e)}function K0e(e){return H2t(e)?e:ef.loader(e)}function X0e(e){var t;return(t=e.usermeta&&e.usermeta.embedOptions)!==null&&t!==void 0?t:{}}function G2t(e,t,n={}){var r,i,a;return yI(this,void 0,void 0,function*(){let o,s;Bn(t)?(s=K0e(n.loader),o=JSON.parse(yield s.load(t))):o=t;const u=X0e(o).loader;(!s||u)&&(s=K0e((r=n.loader)!==null&&r!==void 0?r:u));const l=yield Y0e(X0e(o),s),c=yield Y0e(n,s),f=Object.assign(Object.assign({},V0e(c,l)),{config:MC((i=c.config)!==null&&i!==void 0?i:{},(a=l.config)!==null&&a!==void 0?a:{})});return yield X2t(e,o,f,s)})}function Y0e(e,t){var n;return yI(this,void 0,void 0,function*(){const r=Bn(e.config)?JSON.parse(yield t.load(e.config)):(n=e.config)!==null&&n!==void 0?n:{},i=Bn(e.patch)?JSON.parse(yield t.load(e.patch)):e.patch;return Object.assign(Object.assign(Object.assign({},e),i?{patch:i}:{}),r?{config:r}:{})})}function K2t(e){var t;const n=e.getRootNode?e.getRootNode():document;return n instanceof ShadowRoot?{root:n,rootContainer:n}:{root:document,rootContainer:(t=document.head)!==null&&t!==void 0?t:document.body}}function X2t(e,t,n={},r){var i,a,o,s,u,l;return yI(this,void 0,void 0,function*(){const c=n.theme?MC(T2t[n.theme],(i=n.config)!==null&&i!==void 0?i:{}):n.config,f=a4(n.actions)?n.actions:V0e({},q0e,(a=n.actions)!==null&&a!==void 0?a:{}),d=Object.assign(Object.assign({},j2t),n.i18n),h=(o=n.renderer)!==null&&o!==void 0?o:"canvas",p=(s=n.logLevel)!==null&&s!==void 0?s:ef.Warn,g=(u=n.downloadFileName)!==null&&u!==void 0?u:"visualization",m=typeof e=="string"?document.querySelector(e):e;if(!m)throw new Error(`${e} does not exist`);if(n.defaultStyle!==!1){const k="vega-embed-style",{root:T,rootContainer:I}=K2t(m);if(!T.getElementById(k)){const N=document.createElement("style");N.id=k,N.innerText=n.defaultStyle===void 0||n.defaultStyle===!0?B2t.toString():n.defaultStyle,I.appendChild(N)}}const v=G0e(t,n.mode);let y=U2t[v](t,c);if(v==="vega-lite"&&y.$schema){const k=R0e(y.$schema);Nne.satisfies(xI.vega,`^${k.version.slice(1)}`)||console.warn(`The compiled spec uses Vega ${k.version}, but current version is v${xI.vega}.`)}m.classList.add("vega-embed"),f&&m.classList.add("has-actions"),m.innerHTML="";let b=m;if(f){const k=document.createElement("div");k.classList.add(V2t),m.appendChild(k),b=k}const x=n.patch;x&&(x instanceof Function?y=x(y):y=yC(y,x,!0,!1).newDocument),n.formatLocale&&ef.formatLocale(n.formatLocale),n.timeFormatLocale&&ef.timeFormatLocale(n.timeFormatLocale);const{ast:w}=n,S=ef.parse(y,v==="vega-lite"?{}:c,{ast:w}),C=new(n.viewClass||ef.View)(S,Object.assign({loader:r,logLevel:p,renderer:h},w?{expr:ef.expressionInterpreter}:{}));if(n.tooltip!==!1){let k;q2t(n.tooltip)?k=n.tooltip:k=new $2t(n.tooltip===!0?{}:n.tooltip).call,C.tooltip(k)}let{hover:_}=n;if(_===void 0&&(_=v==="vega"),_){const{hoverSet:k,updateSet:T}=typeof _=="boolean"?{}:_;C.hover(k,T)}n&&(n.width!=null&&C.width(n.width),n.height!=null&&C.height(n.height),n.padding!=null&&C.padding(n.padding)),yield C.initialize(b,n.bind).runAsync();let E;if(f!==!1){let k=m;if(n.defaultStyle!==!1){const I=document.createElement("details");I.title=d.CLICK_TO_VIEW_ACTIONS,m.append(I),k=I;const N=document.createElement("summary");N.innerHTML=W2t,I.append(N),E=O=>{I.contains(O.target)||I.removeAttribute("open")},document.addEventListener("click",E)}const T=document.createElement("div");if(k.append(T),T.classList.add("vega-actions"),f===!0||f.export!==!1){for(const I of["svg","png"])if(f===!0||f.export===!0||f.export[I]){const N=d[`${I.toUpperCase()}_ACTION`],O=document.createElement("a");O.text=N,O.href="#",O.target="_blank",O.download=`${g}.${I}`,O.addEventListener("mousedown",function(D){return yI(this,void 0,void 0,function*(){D.preventDefault();const L=yield C.toImageURL(I,n.scaleFactor);this.href=L})}),T.append(O)}}if(f===!0||f.source!==!1){const I=document.createElement("a");I.text=d.SOURCE_ACTION,I.href="#",I.addEventListener("click",function(N){var O,D;H0e(P$(t),(O=n.sourceHeader)!==null&&O!==void 0?O:"",(D=n.sourceFooter)!==null&&D!==void 0?D:"",v),N.preventDefault()}),T.append(I)}if(v==="vega-lite"&&(f===!0||f.compiled!==!1)){const I=document.createElement("a");I.text=d.COMPILED_ACTION,I.href="#",I.addEventListener("click",function(N){var O,D;H0e(P$(y),(O=n.sourceHeader)!==null&&O!==void 0?O:"",(D=n.sourceFooter)!==null&&D!==void 0?D:"","vega"),N.preventDefault()}),T.append(I)}if(f===!0||f.editor!==!1){const I=(l=n.editorUrl)!==null&&l!==void 0?l:"https://vega.github.io/editor/",N=document.createElement("a");N.text=d.EDITOR_ACTION,N.href="#",N.addEventListener("click",function(O){L2t(window,I,{config:c,mode:v,renderer:h,spec:P$(t)}),O.preventDefault()}),T.append(N)}}function A(){E&&document.removeEventListener("click",E),C.finalize()}return{view:C,spec:t,vgSpec:y,finalize:A}})}var Y2t=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:G2t,DEFAULT_ACTIONS:q0e,guessMode:G0e,vega:ef,get vegaLite(){return D0}}),R0=mh(Y2t),ks={},Le={};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var Z0e=Object.getOwnPropertySymbols,Z2t=Object.prototype.hasOwnProperty,J2t=Object.prototype.propertyIsEnumerable;function Q2t(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function e_t(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;var r=Object.getOwnPropertyNames(t).map(function(a){return t[a]});if(r.join("")!=="0123456789")return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(a){i[a]=a}),Object.keys(Object.assign({},i)).join("")==="abcdefghijklmnopqrst"}catch(a){return!1}}var z9=e_t()?Object.assign:function(e,t){for(var n,r=Q2t(e),i,a=1;a<arguments.length;a++){n=Object(arguments[a]);for(var o in n)Z2t.call(n,o)&&(r[o]=n[o]);if(Z0e){i=Z0e(n);for(var s=0;s<i.length;s++)J2t.call(n,i[s])&&(r[i[s]]=n[i[s]])}}return r},j9={};Object.defineProperty(j9,"__esModule",{value:!0}),j9.StyleSheet=eye;var t_t=z9,n_t=r_t(t_t);function r_t(e){return e&&e.__esModule?e:{default:e}}function i_t(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}else return Array.from(e)}function U9(e){return e[e.length-1]}function J0e(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}var Cg=typeof window!="undefined",a_t=!1,o_t=function(){if(Cg){var e=document.createElement("div");return e.innerHTML="<!--[if lt IE 10]><i></i><![endif]-->",e.getElementsByTagName("i").length===1}}();function Q0e(){var e=document.createElement("style");return e.type="text/css",e.setAttribute("data-glamor",""),e.appendChild(document.createTextNode("")),(document.head||document.getElementsByTagName("head")[0]).appendChild(e),e}function eye(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.speedy,n=t===void 0?!a_t:t,r=e.maxLength,i=r===void 0?Cg&&o_t?4e3:65e3:r;this.isSpeedy=n,this.sheet=void 0,this.tags=[],this.maxLength=i,this.ctr=0}(0,n_t.default)(eye.prototype,{getSheet:function(){return J0e(U9(this.tags))},inject:function(){var t=this;if(this.injected)throw new Error("already injected stylesheet!");Cg?this.tags[0]=Q0e():this.sheet={cssRules:[],insertRule:function(r){t.sheet.cssRules.push({cssText:r})}},this.injected=!0},speedy:function(t){if(this.ctr!==0)throw new Error("cannot change speedy mode after inserting any rule to sheet. Either call speedy("+t+") earlier in your app, or call flush() before speedy("+t+")");this.isSpeedy=!!t},_insert:function(t){try{var n=this.getSheet();n.insertRule(t,t.indexOf("@import")!==-1?0:n.cssRules.length)}catch(r){}},insert:function(t){if(Cg)if(this.isSpeedy&&this.getSheet().insertRule)this._insert(t);else if(t.indexOf("@import")!==-1){var n=U9(this.tags);n.insertBefore(document.createTextNode(t),n.firstChild)}else U9(this.tags).appendChild(document.createTextNode(t));else this.sheet.insertRule(t,t.indexOf("@import")!==-1?0:this.sheet.cssRules.length);return this.ctr++,Cg&&this.ctr%this.maxLength==0&&this.tags.push(Q0e()),this.ctr-1},delete:function(t){return this.replace(t,"")},flush:function(){Cg?(this.tags.forEach(function(t){return t.parentNode.removeChild(t)}),this.tags=[],this.sheet=null,this.ctr=0):this.sheet.cssRules=[],this.injected=!1},rules:function(){if(!Cg)return this.sheet.cssRules;var t=[];return this.tags.forEach(function(n){return t.splice.apply(t,[t.length,0].concat(i_t(Array.from(J0e(n).cssRules))))}),t}});var F0={},s_t=/-(.)/g;function u_t(e){return e.replace(s_t,function(t,n){return n.toUpperCase()})}var l_t=u_t,c_t=l_t,f_t=/^-ms-/;function d_t(e){return c_t(e.replace(f_t,"ms-"))}var h_t=d_t,W9={},V9={};Object.defineProperty(V9,"__esModule",{value:!0});var wI={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowStart:!0,gridRowEnd:!0,gridColumn:!0,gridColumnStart:!0,gridColumnEnd:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};function p_t(e,t){return e+t.charAt(0).toUpperCase()+t.substring(1)}var g_t=["Webkit","ms","Moz","O"];Object.keys(wI).forEach(function(e){g_t.forEach(function(t){wI[p_t(t,e)]=wI[e]})});var m_t={background:{backgroundAttachment:!0,backgroundColor:!0,backgroundImage:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0},backgroundPosition:{backgroundPositionX:!0,backgroundPositionY:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0},outline:{outlineWidth:!0,outlineStyle:!0,outlineColor:!0}},v_t={isUnitlessNumber:wI,shorthandPropertyExpansions:m_t};V9.default=v_t;function _I(e){return function(){return e}}var Ag=function(){};Ag.thatReturns=_I,Ag.thatReturnsFalse=_I(!1),Ag.thatReturnsTrue=_I(!0),Ag.thatReturnsNull=_I(null),Ag.thatReturnsThis=function(){return this},Ag.thatReturnsArgument=function(e){return e};var y_t=Ag,b_t=y_t,x_t=b_t,tye=x_t;Object.defineProperty(W9,"__esModule",{value:!0});var w_t=V9,__t=nye(w_t),S_t=tye;nye(S_t);function nye(e){return e&&e.__esModule?e:{default:e}}var rye=__t.default.isUnitlessNumber;function E_t(e,t,n){var r=t==null||typeof t=="boolean"||t==="";if(r)return"";var i=isNaN(t);return i||t===0||rye.hasOwnProperty(e)&&rye[e]?""+t:(typeof t=="string"&&(t=t.trim()),t+"px")}W9.default=E_t;var C_t=/([A-Z])/g;function A_t(e){return e.replace(C_t,"-$1").toLowerCase()}var k_t=A_t,T_t=k_t,O_t=/^ms-/;function I_t(e){return T_t(e).replace(O_t,"-ms-")}var N_t=I_t;function D_t(e){var t={};return function(n){return t.hasOwnProperty(n)||(t[n]=e.call(this,n)),t[n]}}var R_t=D_t;Object.defineProperty(F0,"__esModule",{value:!0}),F0.processStyleName=void 0,F0.createMarkupForStyles=W_t;var F_t=h_t;Yw(F_t);var M_t=W9,P_t=Yw(M_t),$_t=N_t,L_t=Yw($_t),B_t=R_t,z_t=Yw(B_t),j_t=tye;Yw(j_t);function Yw(e){return e&&e.__esModule?e:{default:e}}var U_t=F0.processStyleName=(0,z_t.default)(L_t.default);function W_t(e,t){var n="";for(var r in e){var i=r.indexOf("--")===0;if(!!e.hasOwnProperty(r)&&r!=="label"){var a=e[r];a!=null&&(i?n+=r+":"+a+";":(n+=U_t(r)+":",n+=(0,P_t.default)(r,a,t)+";"))}}return n||null}var q9={};Object.defineProperty(q9,"__esModule",{value:!0});var iye=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};q9.default=H9;function V_t(e){return e==null||e===!1||(typeof e=="undefined"?"undefined":iye(e))==="object"&&Object.keys(e).length===0}function q_t(e){if(V_t(e))return null;if((typeof e=="undefined"?"undefined":iye(e))!=="object")return e;for(var t={},n=Object.keys(e),r=!1,i=0;i<n.length;i++){var a=e[n[i]],o=H9(a);(o===null||o!==a)&&(r=!0),o!==null&&(t[n[i]]=o)}return Object.keys(t).length===0?null:r?t:e}function H_t(e){var t=!1,n=[];return e.forEach(function(r){var i=H9(r);(i===null||i!==r)&&(t=!0),i!==null&&n.push(i)}),n.length==0?null:t?n:e}function H9(e){return Array.isArray(e)?H_t(e):q_t(e)}var M0={},G9={},K9={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=["Webkit"],r=["Moz"],i=["ms"],a=["Webkit","Moz"],o=["Webkit","ms"],s=["Webkit","Moz","ms"];t.default={plugins:[],prefixMap:{appearance:a,userSelect:s,textEmphasisPosition:n,textEmphasis:n,textEmphasisStyle:n,textEmphasisColor:n,boxDecorationBreak:n,clipPath:n,maskImage:n,maskMode:n,maskRepeat:n,maskPosition:n,maskClip:n,maskOrigin:n,maskSize:n,maskComposite:n,mask:n,maskBorderSource:n,maskBorderMode:n,maskBorderSlice:n,maskBorderWidth:n,maskBorderOutset:n,maskBorderRepeat:n,maskBorder:n,maskType:n,textDecorationStyle:n,textDecorationSkip:n,textDecorationLine:n,textDecorationColor:n,filter:n,fontFeatureSettings:n,breakAfter:s,breakBefore:s,breakInside:s,columnCount:a,columnFill:a,columnGap:a,columnRule:a,columnRuleColor:a,columnRuleStyle:a,columnRuleWidth:a,columns:a,columnSpan:a,columnWidth:a,writingMode:o,flex:n,flexBasis:n,flexDirection:n,flexGrow:n,flexFlow:n,flexShrink:n,flexWrap:n,alignContent:n,alignItems:n,alignSelf:n,justifyContent:n,order:n,transform:n,transformOrigin:n,transformOriginX:n,transformOriginY:n,backfaceVisibility:n,perspective:n,perspectiveOrigin:n,transformStyle:n,transformOriginZ:n,animation:n,animationDelay:n,animationDirection:n,animationFillMode:n,animationDuration:n,animationIterationCount:n,animationName:n,animationPlayState:n,animationTimingFunction:n,backdropFilter:n,fontKerning:n,scrollSnapType:o,scrollSnapPointsX:o,scrollSnapPointsY:o,scrollSnapDestination:o,scrollSnapCoordinate:o,shapeImageThreshold:n,shapeImageMargin:n,shapeImageOutside:n,hyphens:s,flowInto:o,flowFrom:o,regionFragment:o,textAlignLast:r,tabSize:r,wrapFlow:i,wrapThrough:i,wrapMargin:i,gridTemplateColumns:i,gridTemplateRows:i,gridTemplateAreas:i,gridTemplate:i,gridAutoColumns:i,gridAutoRows:i,gridAutoFlow:i,grid:i,gridRowStart:i,gridColumnStart:i,gridRowEnd:i,gridRow:i,gridColumn:i,gridColumnEnd:i,gridColumnGap:i,gridRowGap:i,gridArea:i,gridGap:i,textSizeAdjust:o,borderImage:n,borderImageOutset:n,borderImageRepeat:n,borderImageSlice:n,borderImageSource:n,borderImageWidth:n,transitionDelay:n,transitionDuration:n,transitionProperty:n,transitionTimingFunction:n}},e.exports=t.default})(K9,K9.exports);var X9={exports:{}},SI={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;function n(r){return r.charAt(0).toUpperCase()+r.slice(1)}e.exports=t.default})(SI,SI.exports),function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var n=SI.exports,r=i(n);function i(o){return o&&o.__esModule?o:{default:o}}function a(o,s,u){if(o.hasOwnProperty(s))for(var l=o[s],c=0,f=l.length;c<f;++c)u[l[c]+(0,r.default)(s)]=u[s]}e.exports=t.default}(X9,X9.exports);var Y9={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;function n(r,i,a,o,s){for(var u=0,l=r.length;u<l;++u){var c=r[u](i,a,o,s);if(c)return c}}e.exports=t.default})(Y9,Y9.exports);var Z9={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var n=["-webkit-","-moz-",""],r={"zoom-in":!0,"zoom-out":!0,grab:!0,grabbing:!0};function i(a,o){if(a==="cursor"&&r.hasOwnProperty(o))return n.map(function(s){return s+o})}e.exports=t.default})(Z9,Z9.exports);var J9={exports:{}},kg={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var n=/-webkit-|-moz-|-ms-/;function r(i){return typeof i=="string"&&n.test(i)}e.exports=t.default})(kg,kg.exports),function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var n=kg.exports,r=i(n);function i(s){return s&&s.__esModule?s:{default:s}}var a=["-webkit-",""];function o(s,u){if(typeof u=="string"&&!(0,r.default)(u)&&u.indexOf("cross-fade(")>-1)return a.map(function(l){return u.replace(/cross-fade\(/g,l+"cross-fade(")})}e.exports=t.default}(J9,J9.exports);var Q9={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var n=kg.exports,r=i(n);function i(s){return s&&s.__esModule?s:{default:s}}var a=["-webkit-",""];function o(s,u){if(typeof u=="string"&&!(0,r.default)(u)&&u.indexOf("filter(")>-1)return a.map(function(l){return u.replace(/filter\(/g,l+"filter(")})}e.exports=t.default})(Q9,Q9.exports);var e7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var n={flex:["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex","flex"],"inline-flex":["-webkit-inline-box","-moz-inline-box","-ms-inline-flexbox","-webkit-inline-flex","inline-flex"]};function r(i,a){if(i==="display"&&n.hasOwnProperty(a))return n[a]}e.exports=t.default})(e7,e7.exports);var t7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var n={"space-around":"justify","space-between":"justify","flex-start":"start","flex-end":"end","wrap-reverse":"multiple",wrap:"multiple"},r={alignItems:"WebkitBoxAlign",justifyContent:"WebkitBoxPack",flexWrap:"WebkitBoxLines"};function i(a,o,s){a==="flexDirection"&&typeof o=="string"&&(o.indexOf("column")>-1?s.WebkitBoxOrient="vertical":s.WebkitBoxOrient="horizontal",o.indexOf("reverse")>-1?s.WebkitBoxDirection="reverse":s.WebkitBoxDirection="normal"),r.hasOwnProperty(a)&&(s[r[a]]=n[o]||o)}e.exports=t.default})(t7,t7.exports);var n7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var n=kg.exports,r=i(n);function i(u){return u&&u.__esModule?u:{default:u}}var a=["-webkit-","-moz-",""],o=/linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient/;function s(u,l){if(typeof l=="string"&&!(0,r.default)(l)&&o.test(l))return a.map(function(c){return c+l})}e.exports=t.default})(n7,n7.exports);var r7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var n=kg.exports,r=i(n);function i(s){return s&&s.__esModule?s:{default:s}}var a=["-webkit-",""];function o(s,u){if(typeof u=="string"&&!(0,r.default)(u)&&u.indexOf("image-set(")>-1)return a.map(function(l){return u.replace(/image-set\(/g,l+"image-set(")})}e.exports=t.default})(r7,r7.exports);var i7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;function n(r,i){if(r==="position"&&i==="sticky")return["-webkit-sticky","sticky"]}e.exports=t.default})(i7,i7.exports);var a7={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var n=["-webkit-","-moz-",""],r={maxHeight:!0,maxWidth:!0,width:!0,height:!0,columnWidth:!0,minWidth:!0,minHeight:!0},i={"min-content":!0,"max-content":!0,"fill-available":!0,"fit-content":!0,"contain-floats":!0};function a(o,s){if(r.hasOwnProperty(o)&&i.hasOwnProperty(s))return n.map(function(u){return u+s})}e.exports=t.default})(a7,a7.exports);var o7={exports:{}},s7={exports:{}},G_t=/[A-Z]/g,K_t=/^ms-/,u7={};function X_t(e){return"-"+e.toLowerCase()}function Y_t(e){if(u7.hasOwnProperty(e))return u7[e];var t=e.replace(G_t,X_t);return u7[e]=K_t.test(t)?"-"+t:t}var Z_t=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Y_t}),J_t=mh(Z_t);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var n=J_t,r=i(n);function i(o){return o&&o.__esModule?o:{default:o}}function a(o){return(0,r.default)(o)}e.exports=t.default})(s7,s7.exports),function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=d;var n=s7.exports,r=u(n),i=kg.exports,a=u(i),o=SI.exports,s=u(o);function u(h){return h&&h.__esModule?h:{default:h}}var l={transition:!0,transitionProperty:!0,WebkitTransition:!0,WebkitTransitionProperty:!0,MozTransition:!0,MozTransitionProperty:!0},c={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-"};function f(h,p){if((0,a.default)(h))return h;for(var g=h.split(/,(?![^()]*(?:\([^()]*\))?\))/g),m=0,v=g.length;m<v;++m){var y=g[m],b=[y];for(var x in p){var w=(0,r.default)(x);if(y.indexOf(w)>-1&&w!=="order")for(var S=p[x],C=0,_=S.length;C<_;++C)b.unshift(y.replace(w,c[S[C]]+w))}g[m]=b.join(",")}return g.join(",")}function d(h,p,g,m){if(typeof p=="string"&&l.hasOwnProperty(h)){var v=f(p,m),y=v.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter(function(x){return!/-moz-|-ms-/.test(x)}).join(",");if(h.indexOf("Webkit")>-1)return y;var b=v.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter(function(x){return!/-webkit-|-ms-/.test(x)}).join(",");return h.indexOf("Moz")>-1?b:(g["Webkit"+(0,s.default)(h)]=y,g["Moz"+(0,s.default)(h)]=b,v)}}e.exports=t.default}(o7,o7.exports),Object.defineProperty(G9,"__esModule",{value:!0}),G9.default=ASt;var Q_t=K9.exports,eSt=Yo(Q_t),tSt=X9.exports,nSt=Yo(tSt),rSt=Y9.exports,iSt=Yo(rSt),aSt=Z9.exports,oSt=Yo(aSt),sSt=J9.exports,uSt=Yo(sSt),lSt=Q9.exports,cSt=Yo(lSt),fSt=e7.exports,dSt=Yo(fSt),hSt=t7.exports,pSt=Yo(hSt),gSt=n7.exports,mSt=Yo(gSt),vSt=r7.exports,ySt=Yo(vSt),bSt=i7.exports,xSt=Yo(bSt),wSt=a7.exports,_St=Yo(wSt),SSt=o7.exports,ESt=Yo(SSt);function Yo(e){return e&&e.__esModule?e:{default:e}}var CSt=[uSt.default,oSt.default,cSt.default,pSt.default,mSt.default,ySt.default,xSt.default,_St.default,ESt.default,dSt.default],aye=eSt.default.prefixMap;function ASt(e){for(var t in e){var n=e[t],r=(0,iSt.default)(CSt,t,n,e,aye);r&&(e[t]=r),(0,nSt.default)(aye,t,e)}return e}Object.defineProperty(M0,"__esModule",{value:!0});var l7=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};M0.PluginSet=sye,M0.fallbacks=DSt,M0.contentWrap=FSt,M0.prefixes=MSt;var kSt=z9,c7=oye(kSt),TSt=F0,OSt=G9,ISt=oye(OSt);function oye(e){return e&&e.__esModule?e:{default:e}}var NSt=function(e){return e==="development"||!e}("production");function sye(e){this.fns=e||[]}(0,c7.default)(sye.prototype,{add:function(){for(var t=this,n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach(function(a){t.fns.indexOf(a)>=0?NSt&&console.warn("adding the same plugin again, ignoring"):t.fns=[a].concat(t.fns)})},remove:function(t){this.fns=this.fns.filter(function(n){return n!==t})},clear:function(){this.fns=[]},transform:function(t){return this.fns.reduce(function(n,r){return r(n)},t)}});function DSt(e){var t=Object.keys(e.style).map(function(i){return Array.isArray(e.style[i])}).indexOf(!0)>=0;if(t){var n=e.style,r=Object.keys(n).reduce(function(i,a){return i[a]=Array.isArray(n[a])?n[a].join("; "+(0,TSt.processStyleName)(a)+": "):n[a],i},{});return(0,c7.default)({},e,{style:r})}return e}var RSt=["normal","none","counter","open-quote","close-quote","no-open-quote","no-close-quote","initial","inherit"];function FSt(e){if(e.style.content){var t=e.style.content;return RSt.indexOf(t)>=0||/^(attr|calc|counters?|url)\(/.test(t)||t.charAt(0)===t.charAt(t.length-1)&&(t.charAt(0)==='"'||t.charAt(0)==="'")?e:l7({},e,{style:l7({},e.style,{content:'"'+t+'"'})})}return e}function MSt(e){return(0,c7.default)({},e,{style:(0,ISt.default)(l7({},e.style))})}var f7={};Object.defineProperty(f7,"__esModule",{value:!0}),f7.default=PSt;function PSt(e,t){for(var n=1540483477,r=24,i=t^e.length,a=e.length,o=0;a>=4;){var s=$St(e,o);s=Tg(s,n),s^=s>>>r,s=Tg(s,n),i=Tg(i,n),i^=s,o+=4,a-=4}switch(a){case 3:i^=uye(e,o),i^=e.charCodeAt(o+2)<<16,i=Tg(i,n);break;case 2:i^=uye(e,o),i=Tg(i,n);break;case 1:i^=e.charCodeAt(o),i=Tg(i,n);break}return i^=i>>>13,i=Tg(i,n),i^=i>>>15,i>>>0}function $St(e,t){return e.charCodeAt(t++)+(e.charCodeAt(t++)<<8)+(e.charCodeAt(t++)<<16)+(e.charCodeAt(t)<<24)}function uye(e,t){return e.charCodeAt(t++)+(e.charCodeAt(t++)<<8)}function Tg(e,t){e=e|0,t=t|0;var n=e&65535,r=e>>>16,i=n*t+((r*t&65535)<<16)|0;return i}Object.defineProperty(Le,"__esModule",{value:!0}),Le.compose=Le.merge=Le.$=Le.style=Le.presets=Le.keyframes=Le.fontFace=Le.insertGlobal=Le.insertRule=Le.plugins=Le.styleSheet=void 0,Le.speedy=VSt,Le.simulations=qSt,Le.simulate=HSt,Le.cssLabels=GSt,Le.isLikeRule=m7,Le.idFor=v7,Le.css=Ti,Le.rehydrate=sEt,Le.flush=uEt,Le.select=x7,Le.parent=cEt,Le.media=fEt,Le.pseudo=kt,Le.active=dEt,Le.any=hEt,Le.checked=pEt,Le.disabled=gEt,Le.empty=mEt,Le.enabled=vEt,Le._default=yEt,Le.first=bEt,Le.firstChild=xEt,Le.firstOfType=wEt,Le.fullscreen=_Et,Le.focus=SEt,Le.hover=EEt,Le.indeterminate=CEt,Le.inRange=AEt,Le.invalid=kEt,Le.lastChild=TEt,Le.lastOfType=OEt,Le.left=IEt,Le.link=NEt,Le.onlyChild=DEt,Le.onlyOfType=REt,Le.optional=FEt,Le.outOfRange=MEt,Le.readOnly=PEt,Le.readWrite=$Et,Le.required=LEt,Le.right=BEt,Le.root=zEt,Le.scope=jEt,Le.target=UEt,Le.valid=WEt,Le.visited=VEt,Le.dir=qEt,Le.lang=HEt,Le.not=GEt,Le.nthChild=KEt,Le.nthLastChild=XEt,Le.nthLastOfType=YEt,Le.nthOfType=ZEt,Le.after=JEt,Le.before=QEt,Le.firstLetter=eCt,Le.firstLine=tCt,Le.selection=nCt,Le.backdrop=rCt,Le.placeholder=iCt,Le.cssFor=aCt,Le.attribsFor=oCt;var LSt=z9,BSt=h7(LSt),zSt=j9,d7=F0,jSt=q9,sh=h7(jSt),tf=M0,USt=f7,WSt=h7(USt);function h7(e){return e&&e.__esModule?e:{default:e}}function Zw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Zo=Le.styleSheet=new zSt.StyleSheet;Zo.inject();function VSt(e){return Zo.speedy(e)}var Jw=Le.plugins=Zo.plugins=new tf.PluginSet([tf.prefixes,tf.contentWrap,tf.fallbacks]);Jw.media=new tf.PluginSet,Jw.fontFace=new tf.PluginSet,Jw.keyframes=new tf.PluginSet([tf.prefixes,tf.fallbacks]);var p7=!1,EI=typeof window!="undefined",g7=p7,lye=!1,cye=!1;function qSt(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;g7=!!e}function HSt(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t=(0,sh.default)(t),t?g7?t.reduce(function(r,i){return r["data-simulate-"+CI(i)]="",r},{}):(lye||(console.warn("can't simulate without once calling simulations(true)"),lye=!0),cye||(console.warn("don't use simulation outside dev"),cye=!0),{}):{}}var Qw=p7;function GSt(e){Qw=!!e}function CI(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return e.toLowerCase().replace(/[^a-z0-9]/g,t)}function e2(e){var t=JSON.stringify(e),n=(0,WSt.default)(t).toString(36);return e.label&&e.label.length>0&&p7?CI(e.label.join("."),"-")+"-"+n:n}function m7(e){var t=Object.keys(e).filter(function(n){return n!=="toString"});return t.length!==1?!1:!!/data\-css\-([a-zA-Z0-9\-_]+)/.exec(t[0])}function v7(e){var t=Object.keys(e).filter(function(i){return i!=="toString"});if(t.length!==1)throw new Error("not a rule");var n=/data\-css\-([a-zA-Z0-9\-_]+)/,r=n.exec(t[0]);if(!r)throw new Error("not a rule");return r[1]}var KSt=/[(),]|"(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\//g;function y7(e){if(e.indexOf(",")===-1)return[e];for(var t=[],n=[],r=0,i;i=KSt.exec(e);)switch(i[0]){case"(":r++;break;case")":r--;break;case",":if(r)break;t.push(i.index)}for(i=t.length;i--;)n.unshift(e.slice(t[i]+1)),e=e.slice(0,t[i]);return n.unshift(e),n}function fye(e,t){if(!e)return t.replace(/\&/g,"");if(!t)return".css-"+e+",[data-css-"+e+"]";var n=y7(t).map(function(r){return r.indexOf("&")>=0?[r.replace(/\&/mg,".css-"+e),r.replace(/\&/mg,"[data-css-"+e+"]")].join(","):".css-"+e+r+",[data-css-"+e+"]"+r}).join(",");return g7&&/^\&\:/.exec(t)&&!/\s/.exec(t)&&(n+=",.css-"+e+"[data-simulate-"+CI(t)+"],[data-css-"+e+"][data-simulate-"+CI(t)+"]"),n}function b7(e){var t=e.selector,n=e.style,r=Jw.transform({selector:t,style:n});return r.selector+"{"+(0,d7.createMarkupForStyles)(r.style)+"}"}function AI(e){var t=void 0,n=void 0,r=void 0,i=void 0;return Object.keys(e).forEach(function(a){a.indexOf("&")>=0?(n=n||{},n[a]=e[a]):a.indexOf("@media")===0?(r=r||{},r[a]=AI(e[a])):a.indexOf("@supports")===0?(i=i||{},i[a]=AI(e[a])):a==="label"?e.label.length>0&&(t=t||{},t.label=Qw?e.label.join("."):""):(t=t||{},t[a]=e[a])}),{plain:t,selects:n,medias:r,supports:i}}function kI(e,t){var n=[],r=t.plain,i=t.selects,a=t.medias,o=t.supports;return r&&n.push(b7({style:r,selector:fye(e)})),i&&Object.keys(i).forEach(function(s){return n.push(b7({style:i[s],selector:fye(e,s)}))}),a&&Object.keys(a).forEach(function(s){return n.push(s+"{"+kI(e,a[s]).join("")+"}")}),o&&Object.keys(o).forEach(function(s){return n.push(s+"{"+kI(e,o[s]).join("")+"}")}),n}var Cu=Zo.inserted={};function XSt(e){if(!Cu[e.id]){Cu[e.id]=!0;var t=AI(e.style),n=kI(e.id,t);Cu[e.id]=EI?!0:n,n.forEach(function(r){return Zo.insert(r)})}}var t2=Zo.registered={};function TI(e){t2[e.id]||(t2[e.id]=e)}function YSt(e){if(m7(e)){var t=t2[v7(e)];if(t==null)throw new Error("[glamor] an unexpected rule cache miss occurred. This is probably a sign of multiple glamor instances in your app. See https://github.com/threepointone/glamor/issues/79");return t}return e}var OI={};function ZSt(e){if(TI(e),XSt(e),OI[e.id])return OI[e.id];var t=Zw({},"data-css-"+e.id,Qw&&e.label||"");return Object.defineProperty(t,"toString",{enumerable:!1,value:function(){return"css-"+e.id}}),OI[e.id]=t,t}function JSt(e){for(var t=[":",".","[",">"," "],n=!1,r=e.charAt(0),i=0;i<t.length;i++)if(r===t[i]){n=!0;break}return n||e.indexOf("&")>=0}function dye(e,t){var n=y7(e).map(function(i){return i.indexOf("&")>=0?i:"&"+i}),r=y7(t).map(function(i){return i.indexOf("&")>=0?i:"&"+i});return r.reduce(function(i,a){return i.concat(n.map(function(o){return a.replace(/\&/g,o)}))},[]).join(",")}function QSt(e,t){return e?"@media "+e.substring(6)+" and "+t.substring(6):t}function eEt(e){return e.indexOf("@media")===0}function tEt(e){return e.indexOf("@supports")===0}function nEt(e,t){return e?"@supports "+e.substring(9)+" and "+t.substring(9):t}function hye(e){for(var t=[],n=0;n<e.length;n++)Array.isArray(e[n])?t=t.concat(hye(e[n])):t=t.concat(e[n]);return t}var pye={"::placeholder":["::-webkit-input-placeholder","::-moz-placeholder","::-ms-input-placeholder"],":fullscreen":[":-webkit-full-screen",":-moz-full-screen",":-ms-fullscreen"]};function Og(e,t){var n=t.selector,r=n===void 0?"":n,i=t.mq,a=i===void 0?"":i,o=t.supp,s=o===void 0?"":o,u=t.src,l=u===void 0?{}:u;Array.isArray(l)||(l=[l]),l=hye(l),l.forEach(function(c){if(m7(c)){var f=YSt(c);if(f.type!=="css")throw new Error("cannot merge this rule");c=f.style}c=(0,sh.default)(c),c&&c.composes&&Og(e,{selector:r,mq:a,supp:s,src:c.composes}),Object.keys(c||{}).forEach(function(d){if(JSt(d))pye[d]&&pye[d].forEach(function(p){return Og(e,{selector:dye(r,p),mq:a,supp:s,src:c[d]})}),Og(e,{selector:dye(r,d),mq:a,supp:s,src:c[d]});else if(eEt(d))Og(e,{selector:r,mq:QSt(a,d),supp:s,src:c[d]});else if(tEt(d))Og(e,{selector:r,mq:a,supp:nEt(s,d),src:c[d]});else if(d!=="composes"){var h=e;s&&(h[s]=h[s]||{},h=h[s]),a&&(h[a]=h[a]||{},h=h[a]),r&&(h[r]=h[r]||{},h=h[r]),d==="label"?Qw&&(e.label=e.label.concat(c.label)):h[d]=c[d]}})})}function gye(e){var t={label:[]};Og(t,{src:e});var n={id:e2(t),style:t,label:Qw?t.label.join("."):"",type:"css"};return ZSt(n)}var II={};Object.defineProperty(II,"toString",{enumerable:!1,value:function(){return"css-nil"}});var NI=typeof WeakMap!="undefined"?[II,new WeakMap,new WeakMap,new WeakMap]:[II];function rEt(e){return function(t){if(NI[t.length]){for(var n=NI[t.length],r=0;r<t.length-1;)n.has(t[r])||n.set(t[r],new WeakMap),n=n.get(t[r]),r++;if(n.has(t[t.length-1])){var i=n.get(t[r]);if(t2[i.toString().substring(4)])return i}}var a=e(t);if(NI[t.length]){for(var o=0,s=NI[t.length];o<t.length-1;)s=s.get(t[o]),o++;try{s.set(t[o],a)}catch(u){}}return a}}var iEt=typeof WeakMap!="undefined"?rEt(gye):gye;function Ti(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(t[0]&&t[0].length&&t[0].raw)throw new Error("you forgot to include glamor/babel in your babel plugins.");return t=(0,sh.default)(t),t?iEt(t):II}Ti.insert=function(e){var t={id:e2(e),css:e,type:"raw"};TI(t),Cu[t.id]||(Zo.insert(t.css),Cu[t.id]=EI?!0:[t.css])},Le.insertRule=Ti.insert,Ti.global=function(e,t){if(t=(0,sh.default)(t),t)return Ti.insert(b7({selector:e,style:t}))},Le.insertGlobal=Ti.global;function aEt(e){if(!Cu[e.id]){var t=Object.keys(e.keyframes).map(function(r){var i=Jw.keyframes.transform({id:e.id,name:r,style:e.keyframes[r]});return i.name+"{"+(0,d7.createMarkupForStyles)(i.style)+"}"}).join(""),n=["-webkit-","-moz-","-o-",""].map(function(r){return"@"+r+"keyframes "+(e.name+"_"+e.id)+"{"+t+"}"});n.forEach(function(r){return Zo.insert(r)}),Cu[e.id]=EI?!0:n}}Ti.keyframes=function(e,t){t||(t=e,e="animation"),t=(0,sh.default)(t)||{};var n={id:e2({name:e,kfs:t}),type:"keyframes",name:e,keyframes:t};return TI(n),aEt(n),e+"_"+n.id},Ti.fontFace=function(e){e=(0,sh.default)(e);var t={id:e2(e),type:"font-face",font:e};return TI(t),oEt(t),e.fontFamily},Le.fontFace=Ti.fontFace,Le.keyframes=Ti.keyframes;function oEt(e){if(!Cu[e.id]){var t="@font-face{"+(0,d7.createMarkupForStyles)(e.font)+"}";Zo.insert(t),Cu[e.id]=EI?!0:[t]}}function sEt(e){(0,BSt.default)(Cu,e.reduce(function(t,n){return t[n]=!0,t},{}))}function uEt(){Cu=Zo.inserted={},t2=Zo.registered={},OI={},Zo.flush(),Zo.inject()}Le.presets={mobile:"(min-width: 400px)",Mobile:"@media (min-width: 400px)",phablet:"(min-width: 550px)",Phablet:"@media (min-width: 550px)",tablet:"(min-width: 750px)",Tablet:"@media (min-width: 750px)",desktop:"(min-width: 1000px)",Desktop:"@media (min-width: 1000px)",hd:"(min-width: 1200px)",Hd:"@media (min-width: 1200px)"};var lEt=Le.style=Ti;function x7(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e?Ti(Zw({},e,n)):lEt(n)}Le.$=x7;function cEt(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Ti(Zw({},e+" &",n))}Le.merge=Ti,Le.compose=Ti;function fEt(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Ti(Zw({},"@media "+e,n))}function kt(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Ti(Zw({},e,n))}function dEt(e){return kt(":active",e)}function hEt(e){return kt(":any",e)}function pEt(e){return kt(":checked",e)}function gEt(e){return kt(":disabled",e)}function mEt(e){return kt(":empty",e)}function vEt(e){return kt(":enabled",e)}function yEt(e){return kt(":default",e)}function bEt(e){return kt(":first",e)}function xEt(e){return kt(":first-child",e)}function wEt(e){return kt(":first-of-type",e)}function _Et(e){return kt(":fullscreen",e)}function SEt(e){return kt(":focus",e)}function EEt(e){return kt(":hover",e)}function CEt(e){return kt(":indeterminate",e)}function AEt(e){return kt(":in-range",e)}function kEt(e){return kt(":invalid",e)}function TEt(e){return kt(":last-child",e)}function OEt(e){return kt(":last-of-type",e)}function IEt(e){return kt(":left",e)}function NEt(e){return kt(":link",e)}function DEt(e){return kt(":only-child",e)}function REt(e){return kt(":only-of-type",e)}function FEt(e){return kt(":optional",e)}function MEt(e){return kt(":out-of-range",e)}function PEt(e){return kt(":read-only",e)}function $Et(e){return kt(":read-write",e)}function LEt(e){return kt(":required",e)}function BEt(e){return kt(":right",e)}function zEt(e){return kt(":root",e)}function jEt(e){return kt(":scope",e)}function UEt(e){return kt(":target",e)}function WEt(e){return kt(":valid",e)}function VEt(e){return kt(":visited",e)}function qEt(e,t){return kt(":dir("+e+")",t)}function HEt(e,t){return kt(":lang("+e+")",t)}function GEt(e,t){var n=e.split(",").map(function(r){return r.trim()}).map(function(r){return":not("+r+")"});return n.length===1?kt(":not("+e+")",t):x7(n.join(""),t)}function KEt(e,t){return kt(":nth-child("+e+")",t)}function XEt(e,t){return kt(":nth-last-child("+e+")",t)}function YEt(e,t){return kt(":nth-last-of-type("+e+")",t)}function ZEt(e,t){return kt(":nth-of-type("+e+")",t)}function JEt(e){return kt("::after",e)}function QEt(e){return kt("::before",e)}function eCt(e){return kt("::first-letter",e)}function tCt(e){return kt("::first-line",e)}function nCt(e){return kt("::selection",e)}function rCt(e){return kt("::backdrop",e)}function iCt(e){return Ti({"::placeholder":e})}function aCt(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t=(0,sh.default)(t),t?t.map(function(r){var i={label:[]};return Og(i,{src:r}),kI(e2(i),AI(i)).join("")}).join(""):""}function oCt(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];t=(0,sh.default)(t);var r=t?t.map(function(i){v7(i);var a=Object.keys(i)[0],o=i[a];return a+'="'+(o||"")+'"'}).join(" "):"";return r}var Ha={},n2={};Object.defineProperty(n2,"__esModule",{value:!0});function sCt(e){return e.name!=null}n2.isSurfaceInfo=sCt;function uCt(e){return e.drawArea instanceof HTMLElement}n2.isSurface=uCt;var r2={},w7={};function lCt(){}var _o={},P0=[],mye=[];function i2(e,t){var n=mye,r,i,a,o;for(o=arguments.length;o-- >2;)P0.push(arguments[o]);for(t&&t.children!=null&&(P0.length||P0.push(t.children),delete t.children);P0.length;)if((i=P0.pop())&&i.pop!==void 0)for(o=i.length;o--;)P0.push(i[o]);else typeof i=="boolean"&&(i=null),(a=typeof e!="function")&&(i==null?i="":typeof i=="number"?i=String(i):typeof i!="string"&&(a=!1)),a&&r?n[n.length-1]+=i:n===mye?n=[i]:n.push(i),r=a;var s=new lCt;return s.nodeName=e,s.children=n,s.attributes=t??void 0,s.key=t==null?void 0:t.key,_o.vnode!==void 0&&_o.vnode(s),s}function uh(e,t){for(var n in t)e[n]=t[n];return e}var cCt=typeof Promise=="function"?Promise.resolve().then.bind(Promise.resolve()):setTimeout;function vye(e,t){return i2(e.nodeName,uh(uh({},e.attributes),t),arguments.length>2?[].slice.call(arguments,2):e.children)}var fCt=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,_7=[];function yye(e){!e._dirty&&(e._dirty=!0)&&_7.push(e)==1&&(_o.debounceRendering||cCt)(S7)}function S7(){var e,t=_7;for(_7=[];e=t.pop();)e._dirty&&FI(e)}function dCt(e,t,n){return typeof t=="string"||typeof t=="number"?e.splitText!==void 0:typeof t.nodeName=="string"?!e._componentConstructor&&bye(e,t.nodeName):n||e._componentConstructor===t.nodeName}function bye(e,t){return e.normalizedNodeName===t||e.nodeName.toLowerCase()===t.toLowerCase()}function xye(e){var t=uh({},e.attributes);t.children=e.children;var n=e.nodeName.defaultProps;if(n!==void 0)for(var r in n)t[r]===void 0&&(t[r]=n[r]);return t}function hCt(e,t){var n=t?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e);return n.normalizedNodeName=e,n}function E7(e){var t=e.parentNode;t&&t.removeChild(e)}function wye(e,t,n,r,i){if(t==="className"&&(t="class"),t!=="key")if(t==="ref")n&&n(null),r&&r(e);else if(t==="class"&&!i)e.className=r||"";else if(t==="style"){if((!r||typeof r=="string"||typeof n=="string")&&(e.style.cssText=r||""),r&&typeof r=="object"){if(typeof n!="string")for(var a in n)a in r||(e.style[a]="");for(var a in r)e.style[a]=typeof r[a]=="number"&&fCt.test(a)===!1?r[a]+"px":r[a]}}else if(t==="dangerouslySetInnerHTML")r&&(e.innerHTML=r.__html||"");else if(t[0]=="o"&&t[1]=="n"){var o=t!==(t=t.replace(/Capture$/,""));t=t.toLowerCase().substring(2),r?n||e.addEventListener(t,_ye,o):e.removeEventListener(t,_ye,o),(e._listeners||(e._listeners={}))[t]=r}else if(t!=="list"&&t!=="type"&&!i&&t in e)pCt(e,t,r??""),(r==null||r===!1)&&e.removeAttribute(t);else{var s=i&&t!==(t=t.replace(/^xlink:?/,""));r==null||r===!1?s?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):typeof r!="function"&&(s?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),r):e.setAttribute(t,r))}}function pCt(e,t,n){try{e[t]=n}catch(r){}}function _ye(e){return this._listeners[e.type](_o.event&&_o.event(e)||e)}var Sye=[],C7=0,lh=!1,DI=!1;function Eye(){for(var e;e=Sye.pop();)_o.afterMount&&_o.afterMount(e),e.componentDidMount&&e.componentDidMount()}function Cye(e,t,n,r,i,a){C7++||(lh=i!=null&&i.ownerSVGElement!==void 0,DI=e!=null&&!("__preactattr_"in e));var o=Aye(e,t,n,r,a);return i&&o.parentNode!==i&&i.appendChild(o),--C7||(DI=!1,a||Eye()),o}function Aye(e,t,n,r,i){var a=e,o=lh;if((t==null||typeof t=="boolean")&&(t=""),typeof t=="string"||typeof t=="number")return e&&e.splitText!==void 0&&e.parentNode&&(!e._component||i)?e.nodeValue!=t&&(e.nodeValue=t):(a=document.createTextNode(t),e&&(e.parentNode&&e.parentNode.replaceChild(a,e),Ig(e,!0))),a.__preactattr_=!0,a;var s=t.nodeName;if(typeof s=="function")return bCt(e,t,n,r);if(lh=s==="svg"?!0:s==="foreignObject"?!1:lh,s=String(s),(!e||!bye(e,s))&&(a=hCt(s,lh),e)){for(;e.firstChild;)a.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(a,e),Ig(e,!0)}var u=a.firstChild,l=a.__preactattr_,c=t.children;if(l==null){l=a.__preactattr_={};for(var f=a.attributes,d=f.length;d--;)l[f[d].name]=f[d].value}return!DI&&c&&c.length===1&&typeof c[0]=="string"&&u!=null&&u.splitText!==void 0&&u.nextSibling==null?u.nodeValue!=c[0]&&(u.nodeValue=c[0]):(c&&c.length||u!=null)&&gCt(a,c,n,r,DI||l.dangerouslySetInnerHTML!=null),mCt(a,t.attributes,l),lh=o,a}function gCt(e,t,n,r,i){var a=e.childNodes,o=[],s={},u=0,l=0,c=a.length,f=0,d=t?t.length:0,h,p,g,m,v;if(c!==0)for(var y=0;y<c;y++){var b=a[y],x=b.__preactattr_,w=d&&x?b._component?b._component.__key:x.key:null;w!=null?(u++,s[w]=b):(x||(b.splitText!==void 0?i?b.nodeValue.trim():!0:i))&&(o[f++]=b)}if(d!==0)for(var y=0;y<d;y++){m=t[y],v=null;var w=m.key;if(w!=null)u&&s[w]!==void 0&&(v=s[w],s[w]=void 0,u--);else if(!v&&l<f){for(h=l;h<f;h++)if(o[h]!==void 0&&dCt(p=o[h],m,i)){v=p,o[h]=void 0,h===f-1&&f--,h===l&&l++;break}}v=Aye(v,m,n,r),g=a[y],v&&v!==e&&v!==g&&(g==null?e.appendChild(v):v===g.nextSibling?E7(g):e.insertBefore(v,g))}if(u)for(var y in s)s[y]!==void 0&&Ig(s[y],!1);for(;l<=f;)(v=o[f--])!==void 0&&Ig(v,!1)}function Ig(e,t){var n=e._component;n?MI(n):(e.__preactattr_!=null&&e.__preactattr_.ref&&e.__preactattr_.ref(null),(t===!1||e.__preactattr_==null)&&E7(e),kye(e))}function kye(e){for(e=e.lastChild;e;){var t=e.previousSibling;Ig(e,!0),e=t}}function mCt(e,t,n){var r;for(r in n)!(t&&t[r]!=null)&&n[r]!=null&&wye(e,r,n[r],n[r]=void 0,lh);for(r in t)r!=="children"&&r!=="innerHTML"&&(!(r in n)||t[r]!==(r==="value"||r==="checked"?e[r]:n[r]))&&wye(e,r,n[r],n[r]=t[r],lh)}var A7={};function vCt(e){var t=e.constructor.name;(A7[t]||(A7[t]=[])).push(e)}function Tye(e,t,n){var r=A7[e.name],i;if(e.prototype&&e.prototype.render?(i=new e(t,n),a2.call(i,t,n)):(i=new a2(t,n),i.constructor=e,i.render=yCt),r){for(var a=r.length;a--;)if(r[a].constructor===e){i.nextBase=r[a].nextBase,r.splice(a,1);break}}return i}function yCt(e,t,n){return this.constructor(e,n)}function RI(e,t,n,r,i){e._disable||(e._disable=!0,(e.__ref=t.ref)&&delete t.ref,(e.__key=t.key)&&delete t.key,!e.base||i?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,r),r&&r!==e.context&&(e.prevContext||(e.prevContext=e.context),e.context=r),e.prevProps||(e.prevProps=e.props),e.props=t,e._disable=!1,n!==0&&(n===1||_o.syncComponentUpdates!==!1||!e.base?FI(e,1,i):yye(e)),e.__ref&&e.__ref(e))}function FI(e,t,n,r){if(!e._disable){var i=e.props,a=e.state,o=e.context,s=e.prevProps||i,u=e.prevState||a,l=e.prevContext||o,c=e.base,f=e.nextBase,d=c||f,h=e._component,p=!1,g,m,v;if(c&&(e.props=s,e.state=u,e.context=l,t!==2&&e.shouldComponentUpdate&&e.shouldComponentUpdate(i,a,o)===!1?p=!0:e.componentWillUpdate&&e.componentWillUpdate(i,a,o),e.props=i,e.state=a,e.context=o),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!p){g=e.render(i,a,o),e.getChildContext&&(o=uh(uh({},o),e.getChildContext()));var y=g&&g.nodeName,b,x;if(typeof y=="function"){var w=xye(g);m=h,m&&m.constructor===y&&w.key==m.__key?RI(m,w,1,o,!1):(b=m,e._component=m=Tye(y,w,o),m.nextBase=m.nextBase||f,m._parentComponent=e,RI(m,w,0,o,!1),FI(m,1,n,!0)),x=m.base}else v=d,b=h,b&&(v=e._component=null),(d||t===1)&&(v&&(v._component=null),x=Cye(v,g,o,n||!c,d&&d.parentNode,!0));if(d&&x!==d&&m!==h){var S=d.parentNode;S&&x!==S&&(S.replaceChild(x,d),b||(d._component=null,Ig(d,!1)))}if(b&&MI(b),e.base=x,x&&!r){for(var C=e,_=e;_=_._parentComponent;)(C=_).base=x;x._component=C,x._componentConstructor=C.constructor}}if(!c||n?Sye.unshift(e):p||(e.componentDidUpdate&&e.componentDidUpdate(s,u,l),_o.afterUpdate&&_o.afterUpdate(e)),e._renderCallbacks!=null)for(;e._renderCallbacks.length;)e._renderCallbacks.pop().call(e);!C7&&!r&&Eye()}}function bCt(e,t,n,r){for(var i=e&&e._component,a=i,o=e,s=i&&e._componentConstructor===t.nodeName,u=s,l=xye(t);i&&!u&&(i=i._parentComponent);)u=i.constructor===t.nodeName;return i&&u&&(!r||i._component)?(RI(i,l,3,n,r),e=i.base):(a&&!s&&(MI(a),e=o=null),i=Tye(t.nodeName,l,n),e&&!i.nextBase&&(i.nextBase=e,o=null),RI(i,l,1,n,r),e=i.base,o&&e!==o&&(o._component=null,Ig(o,!1))),e}function MI(e){_o.beforeUnmount&&_o.beforeUnmount(e);var t=e.base;e._disable=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var n=e._component;n?MI(n):t&&(t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),e.nextBase=t,E7(t),vCt(e),kye(t)),e.__ref&&e.__ref(null)}function a2(e,t){this._dirty=!0,this.context=t,this.props=e,this.state=this.state||{}}uh(a2.prototype,{setState:function(t,n){var r=this.state;this.prevState||(this.prevState=uh({},r)),uh(r,typeof t=="function"?t(r,this.props):t),n&&(this._renderCallbacks=this._renderCallbacks||[]).push(n),yye(this)},forceUpdate:function(t){t&&(this._renderCallbacks=this._renderCallbacks||[]).push(t),FI(this,2)},render:function(){}});function Oye(e,t,n){return Cye(n,e,{},!1,t,!1)}var xCt={h:i2,createElement:i2,cloneElement:vye,Component:a2,render:Oye,rerender:S7,options:_o},wCt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:xCt,h:i2,createElement:i2,cloneElement:vye,Component:a2,render:Oye,rerender:S7,options:_o}),k7=mh(wCt),T7={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(T7,"__esModule",{value:!0});const PI=k7,O7=Le;class $0 extends PI.Component{componentDidMount(){const{name:t,tab:n}=this.props;this.props.registerSurface(t,n,this)}componentDidUpdate(){return!1}render(){const{name:t,visible:n,styles:r}=this.props,i=Object.assign({},$0.defaultStyles,r),{width:a,height:o}=i;let{maxHeight:s,maxWidth:u}=i;s=o===$0.defaultStyles.height?s:o,u=a===$0.defaultStyles.width?u:a;const l=O7.css({display:n?"block":"none",backgroundColor:"white",marginTop:"10px",marginBottom:"10px",boxShadow:"0 0 6px -3px #777",padding:"10px !important",height:o,width:a,maxHeight:s,maxWidth:u,overflow:"auto"}),c=O7.css({backgroundColor:"white",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",marginBottom:"20px",fontWeight:"600",textAlign:"center"}),f=O7.css({boxSizing:"border-box"});return PI.h("div",{className:`${l} tf-surface`,ref:d=>this.container=d,"data-visible":n},PI.h("div",{className:`${c} tf-label`,ref:d=>this.label=d},t),PI.h("div",{className:`${f} tf-draw-area`,ref:d=>this.drawArea=d}))}}$0.defaultStyles={maxWidth:"550px",maxHeight:"580px",height:"auto",width:"auto"},T7.SurfaceComponent=$0;var I7={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(I7,"__esModule",{value:!0});const o2=k7,Iye=Le;class _Ct extends o2.Component{render(){const{tabNames:t,activeTab:n,handleClick:r}=this.props,i=t.length>0?t.map(o=>o2.h(SCt,{key:o,id:o,handleClick:r,isActive:o===n},o)):null,a=Iye.css({overflowX:"scroll",overflowY:"hidden",whiteSpace:"nowrap",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"#eee",paddingBottom:"1rem",marginTop:"1rem"});return o2.h("div",{className:`${a} visor-tabs`},i)}}I7.Tabs=_Ct;class SCt extends o2.Component{render(){const{children:t,isActive:n,handleClick:r,id:i}=this.props,a=Iye.css({borderBottomColor:n?"#357EDD":"#AAAAAA",borderBottomWidth:"1px",borderBottomStyle:"solid",cursor:"pointer",":hover":{color:"#357EDD"},display:"inline-block",marginRight:"1rem",padding:".5rem",fontSize:"1rem",fontWeight:"bold"});return o2.h("a",{className:`${a} tf-tab`,"data-isactive":n,onClick:()=>r(i)},t)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(w7,"__esModule",{value:!0});const Au=k7,Ng=Le,ECt=T7,CCt=I7;class N7 extends Au.Component{static render(t,n,r){return Au.render(Au.h(N7,Object.assign({},r)),t,n)}constructor(t){super(t);this.surfaces=new Map;const n=t.startOpen==null?!0:t.startOpen;this.state={isOpen:n,isFullscreen:!1,activeTab:null,tabs:new Set},this.keyHandler=this.keyHandler.bind(this)}close(){this.setState({isOpen:!1})}open(){this.setState({isOpen:!0})}toggle(){this.setState({isOpen:!this.state.isOpen})}toggleFullScreen(){this.setState({isFullscreen:!this.state.isFullscreen})}isOpen(){return this.state.isOpen}isFullscreen(){return this.state.isFullscreen}getSurface(t,n){const r=this.surfaceId(t,n);let i;if(this.surfaces.has(r))i=this.surfaces.get(r);else throw Error(`Surface not found with id: ${r}`);return{container:i.container,label:i.label,drawArea:i.drawArea}}bindKeys(){document.addEventListener("keydown",this.keyHandler,!1)}unbindKeys(){document.removeEventListener("keydown",this.keyHandler)}surfaceId(t,n){return t+n}setTabs(t){const n=t.map(a=>a.tab),r=this.state.tabs;let i;for(const a of n)r.has(a)||(r.add(a),i=a);i!=null&&this.setState({tabs:r,activeTab:i})}getTabs(){return this.state.tabs}registerSurface(t,n,r){const i=this.surfaceId(t,n);this.surfaces.set(i,r)}keyHandler(t){const n=192;t.keyCode===n&&(t.shiftKey?this.toggleFullScreen():this.toggle())}setActiveTab(t){this.setState({activeTab:t})}componentDidMount(){this.bindKeys()}componentWillMount(){this.setTabs(this.props.surfaceList)}componentWillReceiveProps(t){this.setTabs(t.surfaceList)}render(){const{isOpen:t,isFullscreen:n,activeTab:r}=this.state,{surfaceList:i}=this.props,a=Array.from(this.getTabs().values()),u=n?"90vw":"550px",l=Ng.css({width:u,height:"100%",backgroundColor:"#fafafa",boxSizing:"border-box",padding:"10px",position:"fixed",top:"0px",transition:"right 0.5s cubic-bezier(0.645, 0.045, 0.355, 1), width 0.5s cubic-bezier(0.645, 0.045, 0.355, 1)",boxShadow:"0 2px 5px rgba(0, 0, 0, 0.12), 0 2px 5px rgba(0, 0, 0, 0.24)",overflow:"auto",fontFamily:"sans-serif",fontSize:"14px",zIndex:1e3}),c=Ng.css({right:"0"}),f=Ng.css({right:`calc(-${u} - 10px)`}),d=t?c:f,h=Ng.css({});return Au.h("div",{className:`${l} ${d} visor`,"data-isopen":t,"data-isfullscreen":n},Au.h(ACt,{fullScreenHandler:this.toggleFullScreen.bind(this),closeHandler:this.close.bind(this),isFullScreen:n}),Au.h(CCt.Tabs,{tabNames:a,activeTab:r,handleClick:this.setActiveTab.bind(this)}),Au.h("div",{className:`${h} visor-surfaces`},i.map(p=>Au.h(ECt.SurfaceComponent,{key:p.name+p.tab,name:p.name,tab:p.tab,styles:p.styles,registerSurface:this.registerSurface.bind(this),visible:r===p.tab}))))}}w7.VisorComponent=N7;function ACt(e){const{isFullScreen:t,fullScreenHandler:n,closeHandler:r}=e,i=Ng.css({display:"flex",backgroundColor:"white",border:"1px solid white",padding:"6px",paddingTop:"10px",marginBottom:"10px",borderRadius:"6px",marginTop:"-16px"}),a=Ng.css({fontSize:".875rem",borderRadius:".25rem",paddingLeft:"1rem",paddingRight:"1rem",paddingTop:".5rem",paddingBottom:".5rem",textDecoration:"none",transition:"color .15s ease-in",color:"#111"}),o=Ng.css({marginLeft:"auto"});return Au.h("div",{className:`${i} visor-controls`},Au.h("button",{className:`${a}`,onClick:n},t?"Minimize":"Maximize"),Au.h("button",{className:`${a} ${o}`,onClick:r},"Hide"))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(r2,"__esModule",{value:!0});const kCt=w7;let $I;const TCt="Visor",D7="tfjs-visor-container";function OCt(){if(typeof document=="undefined")throw new Error("No document defined. This library needs a browser/dom to work");if(document.getElementById(D7)&&$I!=null)return $I;let e=document.getElementById(D7);e==null&&(e=document.createElement("div"),e.id=D7,document.body.appendChild(e));let t;function n(a,o){let s=null;return t=kCt.VisorComponent.render(a,t,{ref:u=>s=u,surfaceList:Array.from(o.values())}),s}const r=new Map,i=n(e,r);return $I=new Nye(i,e,r,n),$I}r2.visor=OCt;class Nye{constructor(t,n,r,i){this.visorComponent=t,this.el=n,this.surfaceList=r,this.renderVisor=i}surface(t){const{name:n}=t,r=t.tab==null?TCt:t.tab;if(n==null||!(typeof n=="string"||n instanceof String))throw new Error("You must pass a config object with a 'name' property to create or retrieve a surface");const i=Object.assign({},t,{tab:r}),a=`${n}-${r}`;return this.surfaceList.has(a)||this.surfaceList.set(a,i),this.renderVisor(this.el,this.surfaceList),this.visorComponent.getSurface(n,r)}isFullscreen(){return this.visorComponent.isFullscreen()}isOpen(){return this.visorComponent.isOpen()}close(){return this.visorComponent.close()}open(){return this.visorComponent.open()}toggle(){return this.visorComponent.toggle()}toggleFullScreen(){return this.visorComponent.toggleFullScreen()}bindKeys(){return this.visorComponent.bindKeys()}unbindKeys(){return this.visorComponent.unbindKeys()}setActiveTab(t){if(!this.visorComponent.state.tabs.has(t))throw new Error(`Tab '${t}' does not exist`);this.visorComponent.setState({activeTab:t})}}r2.Visor=Nye;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ICt=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(Ha,"__esModule",{value:!0});const Dye=n2,NCt=r2;function DCt(e){if(e instanceof HTMLElement)return e;if(Dye.isSurface(e))return e.drawArea;if(Dye.isSurfaceInfo(e))return NCt.visor().surface({name:e.name,tab:e.tab,styles:e.styles}).drawArea;throw new Error("Not a drawable")}Ha.getDrawArea=DCt;function RCt(e,t){const n=Object.getOwnPropertyNames(e),r=Object.getOwnPropertyNames(t);if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++){const a=n[i];if(e[a]!==t[a])return!1}return!0}Ha.shallowEquals=RCt;function FCt(){return ICt(this,void 0,void 0,function*(){yield new Promise(e=>requestAnimationFrame(e))})}Ha.nextFrame=FCt;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(ks,"__esModule",{value:!0});const Rye=Le,MCt=Ha,PCt={prepend:!1};function $Ct(e,t,n={}){const r=MCt.getDrawArea(e),i=Rye.css({"& canvas":{display:"block"},marginTop:".5rem",marginBottom:".5rem"}),a=Rye.css({backgroundColor:"white",display:"inline-block",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",padding:"0 10px 0 10px",marginBottom:"20px",fontWeight:"600",textAlign:"left"}),o=Object.assign({},PCt,n);let s=r.querySelector(`div[data-name=${t}]`);if(!s){if(s=document.createElement("div"),s.setAttribute("class",`${i}`),s.dataset.name=t,o.title){const u=document.createElement("div");u.setAttribute("class",`subsurface-title ${a}`),u.innerText=o.title,s.appendChild(u)}o.prepend?r.insertBefore(s,r.firstChild):r.appendChild(s)}return s}ks.subSurface=$Ct;function LCt(e){const t=50;let n=0,r=e;for(;r&&r.clientWidth===0;)r=r.parentElement,n=t;return r.clientWidth-n}ks.getDefaultWidth=LCt;function BCt(e){return e.clientHeight===0?200:e.clientHeight}ks.getDefaultHeight=BCt;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var zCt=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},jCt=Ye&&Ye.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(T$,"__esModule",{value:!0});const UCt=jCt(R0),Fye=ks,LI=Ha;function WCt(e,t,n={}){return zCt(this,void 0,void 0,function*(){const r=LI.getDrawArea(e),i=t,a=Object.assign({},VCt,n);if(R7.has(r)){const m=R7.get(r);if(LI.shallowEquals(a,m.lastOptions)){yield LI.nextFrame();const v=m.view,y=v.changeset().remove(()=>!0).insert(i);yield v.change("values",y).runAsync();return}}const{xLabel:o,yLabel:s,xType:u,yType:l}=a;let c=null;o!=null&&(c={title:o});let f=null;s!=null&&(f={title:s});const d={actions:!1,mode:"vega-lite",defaultStyle:!1};let h;a.color!=null?Array.isArray(a.color)?h={field:"index",type:"nominal",scale:{range:a.color}}:h={value:a.color}:h={value:"#4C78A0"};const p={width:a.width||Fye.getDefaultWidth(r),height:a.height||Fye.getDefaultHeight(r),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:a.fontSize,titleFontSize:a.fontSize},text:{fontSize:a.fontSize},legend:{labelFontSize:a.fontSize,titleFontSize:a.fontSize}},data:{values:i,name:"values"},mark:{type:"bar",tooltip:!0},encoding:{x:{field:"index",type:u,axis:c},y:{field:"value",type:l,axis:f},color:h}};yield LI.nextFrame();const g=yield UCt.default(r,p,d);R7.set(r,{view:g.view,lastOptions:a})})}T$.barchart=WCt;const VCt={xLabel:"",yLabel:"",xType:"ordinal",yType:"quantitative",fontSize:11},R7=new Map;var F7={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var qCt=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},HCt=Ye&&Ye.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(F7,"__esModule",{value:!0});const GCt=HCt(R0),Mye=ks,KCt=Ha;function XCt(e,t,n={}){return qCt(this,void 0,void 0,function*(){const r=Object.assign({},YCt,n),i=KCt.getDrawArea(e),a=[],o=t.values,s=t.tickLabels||[],u=s.length===0;let l=!0;for(let h=0;h<o.length;h++){const p=u?`Class ${h}`:s[h];u&&s.push(p);for(let g=0;g<o[h].length;g++){const m=u?`Class ${g}`:s[g],v=o[h][g];h===g&&!r.shadeDiagonal?a.push({label:p,prediction:m,count:v,noFill:!0}):(a.push({label:p,prediction:m,count:v,scaleCount:v}),v!==0&&(l=!1))}}if(!r.shadeDiagonal&&l)for(const h of a)h.noFill===!0&&(h.noFill=!1,h.scaleCount=h.count);const c={actions:!1,mode:"vega-lite",defaultStyle:!1},f={width:r.width||Mye.getDefaultWidth(i),height:r.height||Mye.getDefaultHeight(i),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:r.fontSize,titleFontSize:r.fontSize},text:{fontSize:r.fontSize},legend:{labelFontSize:r.fontSize,titleFontSize:r.fontSize}},data:{values:a},encoding:{x:{field:"prediction",type:"ordinal",title:r.xLabel||"prediction",scale:{domain:s}},y:{field:"label",type:"ordinal",title:r.yLabel||"label",scale:{domain:s}}},layer:[{transform:[{filter:"datum.noFill != true"}],mark:{type:"rect"},encoding:{color:{field:"scaleCount",type:"quantitative",scale:{range:r.colorMap}},tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}]};r.shadeDiagonal===!1&&f.layer.push({transform:[{filter:"datum.noFill == true"}],mark:{type:"rect",fill:"white"},encoding:{tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}),r.showTextOverlay&&f.layer.push({mark:{type:"text",baseline:"middle"},encoding:{text:{field:"count",type:"nominal"}}});const d=typeof r.colorMap=="string"?{scheme:r.colorMap}:r.colorMap;f.layer[0].encoding.color.scale.range=d,yield GCt.default(i,f,c)})}F7.confusionMatrix=XCt;const YCt={xLabel:null,yLabel:null,xType:"nominal",yType:"nominal",shadeDiagonal:!0,fontSize:12,showTextOverlay:!0,height:400,colorMap:["#f7fbff","#4292c6"]};var M7={},nf={};Object.defineProperty(nf,"__esModule",{value:!0});/*
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pye(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}nf.assert=Pye;function ZCt(e,t,n=""){Pye($ye(e,t),n+` Shapes ${e} and ${t} must match`)}nf.assertShapesMatch=ZCt;function $ye(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}nf.arraysEqual=$ye,nf.DECIMAL_PLACES_TO_CHECK=4;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Lye=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},JCt=Ye&&Ye.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},QCt=Ye&&Ye.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(M7,"__esModule",{value:!0});const s2=JCt(ste),eAt=QCt(R0),Bye=ks,u2=nf,tAt=Ha;function nAt(e,t,n={}){return Lye(this,void 0,void 0,function*(){const r=Object.assign({},iAt,n),i=tAt.getDrawArea(e);let a=t.values;r.rowMajor&&(a=yield rAt(t.values));const{xTickLabels:o,yTickLabels:s}=t;o!=null&&zye(a,o,0),s!=null&&zye(a,s,1);const u="@tfidx@",l=[];if(a instanceof s2.Tensor){u2.assert(a.rank===2,"Input to renderHeatmap must be a 2d array or Tensor2d");const g=yield a.data(),[m,v]=a.shape;for(let y=0;y<m;y++){const b=o?`${o[y]}${u}${y}`:y;for(let x=0;x<v;x++){const w=s?`${s[x]}${u}${x}`:x,S=y*v+x,C=g[S];l.push({x:b,y:w,value:C})}}}else{const g=a;for(let m=0;m<g.length;m++){const v=o?`${o[m]}${u}${m}`:m;for(let y=0;y<g[m].length;y++){const b=s?`${s[y]}${u}${y}`:y,x=g[m][y];l.push({x:v,y:b,value:x})}}}const c={actions:!1,mode:"vega-lite",defaultStyle:!1},f={width:r.width||Bye.getDefaultWidth(i),height:r.height||Bye.getDefaultHeight(i),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:r.fontSize,titleFontSize:r.fontSize},text:{fontSize:r.fontSize},legend:{labelFontSize:r.fontSize,titleFontSize:r.fontSize},scale:{bandPaddingInner:0,bandPaddingOuter:0}},data:{values:l},mark:{type:"rect",tooltip:!0},encoding:{x:{field:"x",type:r.xType,title:r.xLabel,sort:!1},y:{field:"y",type:r.yType,title:r.yLabel,sort:!1},fill:{field:"value",type:"quantitative"}}},d=`${u}\\d+$`,h=new RegExp(d);o&&(f.encoding.x.axis={labelExpr:`replace(datum.value, regexp(/${d}/), '')`}),s&&(f.encoding.y.axis={labelExpr:`replace(datum.value, regexp(/${d}/), '')`}),(o||s)&&(c.tooltip={sanitize:g=>String(g).replace(h,"")});let p;switch(r.colorMap){case"blues":p=["#f7fbff","#4292c6"];break;case"greyscale":p=["#000000","#ffffff"];break;case"viridis":default:p="viridis";break}if(p!=="viridis"){const g=f.encoding.fill;g.scale={range:p}}if(r.domain){const g=f.encoding.fill;g.scale!=null?g.scale=Object.assign({},g.scale,{domain:r.domain}):g.scale={domain:r.domain}}yield eAt.default(i,f,c)})}M7.heatmap=nAt;function rAt(e){return Lye(this,void 0,void 0,function*(){let t,n;e instanceof s2.Tensor?(t=e.shape,n=e.transpose()):(t=[e.length,e[0].length],n=s2.tidy(()=>s2.tensor2d(e).transpose())),u2.assert(n.rank===2,"Input to renderHeatmap must be a 2d array or Tensor2d");const r=yield n.array();n.dispose();const i=[r.length,r[0].length];return u2.assert(t[0]===i[1]&&t[1]===i[0],`Unexpected transposed shape. Original ${t} : Transposed ${i}`),r})}function zye(e,t,n){const r=e instanceof s2.Tensor?e.shape:[e.length,e[0].length];n===0?u2.assert(r[0]===t.length,`Length of xTickLabels (${t.length}) must match number of rows (${r[0]})`):n===1&&u2.assert(r[1]===t.length,`Length of yTickLabels (${t.length}) must match number of columns (${r[1]})`)}const iAt={xLabel:null,yLabel:null,xType:"ordinal",yType:"ordinal",colorMap:"viridis",fontSize:12,domain:null,rowMajor:!1};var l2={},jye=mh(VYe),zl={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var BI=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(zl,"__esModule",{value:!0});const Dg=ste,ch=nf;function aAt(e){if(!Array.isArray(e))throw new Error("input must be an array");if(e.length===0)return{numVals:0,numNans:0,numZeros:0,max:void 0,min:void 0};const t=e.length;let n=-1/0,r=1/0,i=0,a=0,o=0;for(let u=0;u<t;u++){const l=e[u];l>n&&(n=l),l<r&&(r=l),l===0&&(i+=1),isNaN(l)?a+=1:isFinite(l)||(o+=1)}const s={numVals:t,numZeros:i,numNans:a,max:n,min:r,numInfs:o};return s.max===-1/0&&(s.max=NaN),s.min===1/0&&(s.min=NaN),s}zl.arrayStats=aAt;function oAt(e){return BI(this,void 0,void 0,function*(){const[t,n,r]=Dg.tidy(()=>{const i=Dg.scalar(0,e.dtype),a=e.min(),o=e.max(),s=e.equal(i).sum();return[a,o,s]});return Promise.all([e.data(),t.data(),n.data(),r.data()]).then(([i,a,o,s])=>{const u=i.length;let l=0,c=0;for(let p=0;p<u;p++){const g=i[p];isNaN(g)?l+=1:isFinite(g)||(c+=1)}let f=a[0],d=o[0];return l===u&&(f=NaN,d=NaN),{numVals:u,numZeros:s[0],numNans:l,min:f,max:d,numInfs:c}})})}zl.tensorStats=oAt;function sAt(e,t,n,r){return BI(this,void 0,void 0,function*(){ch.assert(e.rank===1,"labels must be a 1D tensor"),ch.assert(t.rank===1,"predictions must be a 1D tensor"),ch.assert(e.size===t.size,"labels and predictions must be the same length"),r!=null&&ch.assert(r.size===t.size,"labels and predictions must be the same length");const i=e.cast("int32"),a=t.cast("int32");n==null&&(n=Dg.tidy(()=>Dg.maximum(i.max(),a.max()).cast("int32").dataSync()[0]+1));let o=Promise.resolve(null);return r!=null&&(o=r.data()),Promise.all([i.data(),a.data(),o]).then(([s,u,l])=>{const c=Array(n).fill(0);for(let f=0;f<n;f++)c[f]=Array(n).fill(0);for(let f=0;f<s.length;f++){const d=s[f],h=u[f];l!=null?c[d][h]+=l[f]:c[d][h]+=1}return c})})}zl.confusionMatrix=sAt;function uAt(e,t){return BI(this,void 0,void 0,function*(){ch.assertShapesMatch(e.shape,t.shape,"Error computing accuracy.");const n=e.equal(t),r=n.mean(),i=(yield r.data())[0];return Dg.dispose([n,r]),i})}zl.accuracy=uAt;function lAt(e,t,n){return BI(this,void 0,void 0,function*(){return ch.assert(e.rank===1,"labels must be a 1D tensor"),ch.assert(t.rank===1,"predictions must be a 1D tensor"),ch.assert(e.size===t.size,"labels and predictions must be the same length"),n==null&&(n=Dg.tidy(()=>Dg.maximum(e.max(),t.max()).dataSync()[0]+1)),Promise.all([e.data(),t.data()]).then(([r,i])=>{const a=Array(n).fill(0),o=Array(n).fill(0);for(let u=0;u<r.length;u++){const l=r[u],c=i[u];a[l]+=1,l===c&&(o[l]+=1)}const s=[];for(let u=0;u<a.length;u++)s.push({count:a[u],accuracy:a[u]===0?0:o[u]/a[u]});return s})})}zl.perClassAccuracy=lAt;var L0={},P7="http://www.w3.org/1999/xhtml",$7={svg:"http://www.w3.org/2000/svg",xhtml:P7,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function L7(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),$7.hasOwnProperty(t)?{space:$7[t],local:e}:e}function cAt(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===P7&&t.documentElement.namespaceURI===P7?t.createElement(e):t.createElementNS(n,e)}}function fAt(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function zI(e){var t=L7(e);return(t.local?fAt:cAt)(t)}function dAt(){}function B7(e){return e==null?dAt:function(){return this.querySelector(e)}}function hAt(e){typeof e!="function"&&(e=B7(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,s=r[i]=new Array(o),u,l,c=0;c<o;++c)(u=a[c])&&(l=e.call(u,u.__data__,c,a))&&("__data__"in u&&(l.__data__=u.__data__),s[c]=l);return new Ga(r,this._parents)}function pAt(){return[]}function Uye(e){return e==null?pAt:function(){return this.querySelectorAll(e)}}function gAt(e){typeof e!="function"&&(e=Uye(e));for(var t=this._groups,n=t.length,r=[],i=[],a=0;a<n;++a)for(var o=t[a],s=o.length,u,l=0;l<s;++l)(u=o[l])&&(r.push(e.call(u,u.__data__,l,o)),i.push(u));return new Ga(r,i)}var Wye=function(e){return function(){return this.matches(e)}};if(typeof document!="undefined"){var c2=document.documentElement;if(!c2.matches){var mAt=c2.webkitMatchesSelector||c2.msMatchesSelector||c2.mozMatchesSelector||c2.oMatchesSelector;Wye=function(e){return function(){return mAt.call(this,e)}}}}var Vye=Wye;function vAt(e){typeof e!="function"&&(e=Vye(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,s=r[i]=[],u,l=0;l<o;++l)(u=a[l])&&e.call(u,u.__data__,l,a)&&s.push(u);return new Ga(r,this._parents)}function qye(e){return new Array(e.length)}function yAt(){return new Ga(this._enter||this._groups.map(qye),this._parents)}function jI(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}jI.prototype={constructor:jI,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function bAt(e){return function(){return e}}var Hye="$";function xAt(e,t,n,r,i,a){for(var o=0,s,u=t.length,l=a.length;o<l;++o)(s=t[o])?(s.__data__=a[o],r[o]=s):n[o]=new jI(e,a[o]);for(;o<u;++o)(s=t[o])&&(i[o]=s)}function wAt(e,t,n,r,i,a,o){var s,u,l={},c=t.length,f=a.length,d=new Array(c),h;for(s=0;s<c;++s)(u=t[s])&&(d[s]=h=Hye+o.call(u,u.__data__,s,t),h in l?i[s]=u:l[h]=u);for(s=0;s<f;++s)h=Hye+o.call(e,a[s],s,a),(u=l[h])?(r[s]=u,u.__data__=a[s],l[h]=null):n[s]=new jI(e,a[s]);for(s=0;s<c;++s)(u=t[s])&&l[d[s]]===u&&(i[s]=u)}function _At(e,t){if(!e)return h=new Array(this.size()),l=-1,this.each(function(S){h[++l]=S}),h;var n=t?wAt:xAt,r=this._parents,i=this._groups;typeof e!="function"&&(e=bAt(e));for(var a=i.length,o=new Array(a),s=new Array(a),u=new Array(a),l=0;l<a;++l){var c=r[l],f=i[l],d=f.length,h=e.call(c,c&&c.__data__,l,r),p=h.length,g=s[l]=new Array(p),m=o[l]=new Array(p),v=u[l]=new Array(d);n(c,f,g,m,v,h,t);for(var y=0,b=0,x,w;y<p;++y)if(x=g[y]){for(y>=b&&(b=y+1);!(w=m[b])&&++b<p;);x._next=w||null}}return o=new Ga(o,r),o._enter=s,o._exit=u,o}function SAt(){return new Ga(this._exit||this._groups.map(qye),this._parents)}function EAt(e){for(var t=this._groups,n=e._groups,r=t.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var u=t[s],l=n[s],c=u.length,f=o[s]=new Array(c),d,h=0;h<c;++h)(d=u[h]||l[h])&&(f[h]=d);for(;s<r;++s)o[s]=t[s];return new Ga(o,this._parents)}function CAt(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,a=r[i],o;--i>=0;)(o=r[i])&&(a&&a!==o.nextSibling&&a.parentNode.insertBefore(o,a),a=o);return this}function AAt(e){e||(e=kAt);function t(f,d){return f&&d?e(f.__data__,d.__data__):!f-!d}for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var o=n[a],s=o.length,u=i[a]=new Array(s),l,c=0;c<s;++c)(l=o[c])&&(u[c]=l);u.sort(t)}return new Ga(i,this._parents).order()}function kAt(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function TAt(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function OAt(){var e=new Array(this.size()),t=-1;return this.each(function(){e[++t]=this}),e}function IAt(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null}function NAt(){var e=0;return this.each(function(){++e}),e}function DAt(){return!this.node()}function RAt(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],a=0,o=i.length,s;a<o;++a)(s=i[a])&&e.call(s,s.__data__,a,i);return this}function FAt(e){return function(){this.removeAttribute(e)}}function MAt(e){return function(){this.removeAttributeNS(e.space,e.local)}}function PAt(e,t){return function(){this.setAttribute(e,t)}}function $At(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function LAt(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function BAt(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function zAt(e,t){var n=L7(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?MAt:FAt:typeof t=="function"?n.local?BAt:LAt:n.local?$At:PAt)(n,t))}function z7(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function jAt(e){return function(){this.style.removeProperty(e)}}function UAt(e,t,n){return function(){this.style.setProperty(e,t,n)}}function WAt(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function VAt(e,t,n){return arguments.length>1?this.each((t==null?jAt:typeof t=="function"?WAt:UAt)(e,t,n??"")):Gye(this.node(),e)}function Gye(e,t){return e.style.getPropertyValue(t)||z7(e).getComputedStyle(e,null).getPropertyValue(t)}function qAt(e){return function(){delete this[e]}}function HAt(e,t){return function(){this[e]=t}}function GAt(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function KAt(e,t){return arguments.length>1?this.each((t==null?qAt:typeof t=="function"?GAt:HAt)(e,t)):this.node()[e]}function Kye(e){return e.trim().split(/^|\s+/)}function j7(e){return e.classList||new Xye(e)}function Xye(e){this._node=e,this._names=Kye(e.getAttribute("class")||"")}Xye.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Yye(e,t){for(var n=j7(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function Zye(e,t){for(var n=j7(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function XAt(e){return function(){Yye(this,e)}}function YAt(e){return function(){Zye(this,e)}}function ZAt(e,t){return function(){(t.apply(this,arguments)?Yye:Zye)(this,e)}}function JAt(e,t){var n=Kye(e+"");if(arguments.length<2){for(var r=j7(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?ZAt:t?XAt:YAt)(n,t))}function QAt(){this.textContent=""}function ekt(e){return function(){this.textContent=e}}function tkt(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function nkt(e){return arguments.length?this.each(e==null?QAt:(typeof e=="function"?tkt:ekt)(e)):this.node().textContent}function rkt(){this.innerHTML=""}function ikt(e){return function(){this.innerHTML=e}}function akt(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function okt(e){return arguments.length?this.each(e==null?rkt:(typeof e=="function"?akt:ikt)(e)):this.node().innerHTML}function skt(){this.nextSibling&&this.parentNode.appendChild(this)}function ukt(){return this.each(skt)}function lkt(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ckt(){return this.each(lkt)}function fkt(e){var t=typeof e=="function"?e:zI(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function dkt(){return null}function hkt(e,t){var n=typeof e=="function"?e:zI(e),r=t==null?dkt:typeof t=="function"?t:B7(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function pkt(){var e=this.parentNode;e&&e.removeChild(this)}function gkt(){return this.each(pkt)}function mkt(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function vkt(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}function ykt(e){return this.select(e?vkt:mkt)}function bkt(e){return arguments.length?this.property("__data__",e):this.node().__data__}var Jye={},rf=null;if(typeof document!="undefined"){var xkt=document.documentElement;"onmouseenter"in xkt||(Jye={mouseenter:"mouseover",mouseleave:"mouseout"})}function wkt(e,t,n){return e=Qye(e,t,n),function(r){var i=r.relatedTarget;(!i||i!==this&&!(i.compareDocumentPosition(this)&8))&&e.call(this,r)}}function Qye(e,t,n){return function(r){var i=rf;rf=r;try{e.call(this,this.__data__,t,n)}finally{rf=i}}}function _kt(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function Skt(e){return function(){var t=this.__on;if(!!t){for(var n=0,r=-1,i=t.length,a;n<i;++n)a=t[n],(!e.type||a.type===e.type)&&a.name===e.name?this.removeEventListener(a.type,a.listener,a.capture):t[++r]=a;++r?t.length=r:delete this.__on}}}function Ekt(e,t,n){var r=Jye.hasOwnProperty(e.type)?wkt:Qye;return function(i,a,o){var s=this.__on,u,l=r(t,a,o);if(s){for(var c=0,f=s.length;c<f;++c)if((u=s[c]).type===e.type&&u.name===e.name){this.removeEventListener(u.type,u.listener,u.capture),this.addEventListener(u.type,u.listener=l,u.capture=n),u.value=t;return}}this.addEventListener(e.type,l,n),u={type:e.type,name:e.name,value:t,listener:l,capture:n},s?s.push(u):this.__on=[u]}}function Ckt(e,t,n){var r=_kt(e+""),i,a=r.length,o;if(arguments.length<2){var s=this.node().__on;if(s){for(var u=0,l=s.length,c;u<l;++u)for(i=0,c=s[u];i<a;++i)if((o=r[i]).type===c.type&&o.name===c.name)return c.value}return}for(s=t?Ekt:Skt,n==null&&(n=!1),i=0;i<a;++i)this.each(s(r[i],t,n));return this}function Akt(e,t,n,r){var i=rf;e.sourceEvent=rf,rf=e;try{return t.apply(n,r)}finally{rf=i}}function ebe(e,t,n){var r=z7(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function kkt(e,t){return function(){return ebe(this,e,t)}}function Tkt(e,t){return function(){return ebe(this,e,t.apply(this,arguments))}}function Okt(e,t){return this.each((typeof t=="function"?Tkt:kkt)(e,t))}var U7=[null];function Ga(e,t){this._groups=e,this._parents=t}function tbe(){return new Ga([[document.documentElement]],U7)}Ga.prototype=tbe.prototype={constructor:Ga,select:hAt,selectAll:gAt,filter:vAt,data:_At,enter:yAt,exit:SAt,merge:EAt,order:CAt,sort:AAt,call:TAt,nodes:OAt,node:IAt,size:NAt,empty:DAt,each:RAt,attr:zAt,style:VAt,property:KAt,classed:JAt,text:nkt,html:okt,raise:ukt,lower:ckt,append:fkt,insert:hkt,remove:gkt,clone:ykt,datum:bkt,on:Ckt,dispatch:Okt};function nbe(e){return typeof e=="string"?new Ga([[document.querySelector(e)]],[document.documentElement]):new Ga([[e]],U7)}function Ikt(e){return nbe(zI(e).call(document.documentElement))}var Nkt=0;function rbe(){return new W7}function W7(){this._="@"+(++Nkt).toString(36)}W7.prototype=rbe.prototype={constructor:W7,get:function(e){for(var t=this._;!(t in e);)if(!(e=e.parentNode))return;return e[t]},set:function(e,t){return e[this._]=t},remove:function(e){return this._ in e&&delete e[this._]},toString:function(){return this._}};function V7(){for(var e=rf,t;t=e.sourceEvent;)e=t;return e}function UI(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}function Dkt(e){var t=V7();return t.changedTouches&&(t=t.changedTouches[0]),UI(e,t)}function Rkt(e){return typeof e=="string"?new Ga([document.querySelectorAll(e)],[document.documentElement]):new Ga([e??[]],U7)}function Fkt(e,t,n){arguments.length<3&&(n=t,t=V7().changedTouches);for(var r=0,i=t?t.length:0,a;r<i;++r)if((a=t[r]).identifier===n)return UI(e,a);return null}function Mkt(e,t){t==null&&(t=V7().touches);for(var n=0,r=t?t.length:0,i=new Array(r);n<r;++n)i[n]=UI(e,t[n]);return i}var Pkt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",create:Ikt,creator:zI,local:rbe,matcher:Vye,mouse:Dkt,namespace:L7,namespaces:$7,clientPoint:UI,select:nbe,selectAll:Rkt,selection:tbe,selector:B7,selectorAll:Uye,style:Gye,touch:Fkt,touches:Mkt,window:z7,get event(){return rf},customEvent:Akt}),$kt=mh(Pkt);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.defineProperty(L0,"__esModule",{value:!0});const Lkt=jye,ibe=$kt,q7=Le,Bkt=Ha;function zkt(e,t,n={}){if(t&&t.headers==null)throw new Error('Data to render must have a "headers" property');if(t&&t.values==null)throw new Error('Data to render must have a "values" property');const r=Bkt.getDrawArea(e),i=Object.assign({},jkt,n);let a=ibe.select(r).select("table.tf-table");const o=q7.css({fontSize:i.fontSize||".875rem",width:"100%",maxWidth:"64rem",marginRight:"auto",marginLeft:"auto"});if(a.size()===0&&(a=ibe.select(r).append("table"),a.attr("class",` ${o} tf-table`),a.append("thead").append("tr"),a.append("tbody")),a.size()!==1)throw new Error("Error inserting table");const s=q7.css({fontWeight:"600",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )",textAlign:"left",paddingBottom:"1rem",paddingRight:"1rem",backgroundColor:"#fff"}),u=a.select("thead").select("tr").selectAll("th").data(t.headers),l=u.enter().append("th").attr("class",`${s}`);u.merge(l).html(m=>m),u.exit().remove();const c=Lkt.format(",.4~f"),f=a.select("tbody").selectAll("tr").data(t.values),d=f.enter().append("tr"),h=q7.css({padding:"0.25rem",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )"}),p=f.merge(d).selectAll("td").data(m=>m),g=p.enter().append("td").attr("class",`${h}`);p.merge(g).html(m=>typeof m=="number"?c(m):m),p.exit().remove(),f.exit().remove()}L0.table=zkt;const jkt={fontSize:14};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ukt=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},Wkt=Ye&&Ye.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(l2,"__esModule",{value:!0});const abe=jye,Vkt=Wkt(R0),WI=ks,qkt=zl,Hkt=L0,Gkt={maxBins:12,fontSize:11};function Kkt(e,t,n={}){return Ukt(this,void 0,void 0,function*(){const r=Ykt(t),i=Object.assign({},Gkt,n),a={actions:!1,mode:"vega-lite",defaultStyle:!1},o=WI.subSurface(e,"histogram");if(n.stats!==!1){const l=WI.subSurface(e,"stats",{prepend:!0});let c;n.stats?c=n.stats:c=qkt.arrayStats(r.map(f=>f.value)),Xkt(c,l,{fontSize:i.fontSize})}if(r.length===0)return;const s=[];for(let l=0;l<r.length;l++){const c=r[l].value;c!=null&&isFinite(c)&&s.push(r[l])}const u={width:i.width||WI.getDefaultWidth(o),height:i.height||WI.getDefaultHeight(o),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},data:{values:s},mark:{type:"bar",tooltip:!0},config:{axis:{labelFontSize:i.fontSize,titleFontSize:i.fontSize},text:{fontSize:i.fontSize},legend:{labelFontSize:i.fontSize,titleFontSize:i.fontSize}},encoding:{x:{bin:{maxbins:i.maxBins},field:"value",type:"quantitative"},y:{aggregate:"count",type:"quantitative"},color:{value:i.color||"#001B44"}}};return Vkt.default(o,u,a)})}l2.histogram=Kkt;function Xkt(e,t,n){const r=abe.format(",.4~f"),i=abe.format(".4~p"),a=[],o=[];if(e.numVals!=null&&(a.push("Num Vals"),o.push(r(e.numVals))),e.min!=null&&(a.push("Min"),o.push(r(e.min))),e.max!=null&&(a.push("Max"),o.push(r(e.max))),e.numZeros!=null){a.push("# Zeros");let s="";e.numVals&&(s=e.numZeros>0?`(${i(e.numZeros/e.numVals)})`:""),o.push(`${r(e.numZeros)} ${s}`)}if(e.numNans!=null){a.push("# NaNs");let s="";e.numVals&&(s=e.numNans>0?`(${i(e.numNans/e.numVals)})`:""),o.push(`${r(e.numNans)} ${s}`)}if(e.numInfs!=null){a.push("# Infinity");let s="";e.numVals&&(s=e.numInfs>0?`(${i(e.numInfs/e.numVals)})`:""),o.push(`${r(e.numInfs)} ${s}`)}Hkt.table(t,{headers:a,values:[o]},n)}function Ykt(e){if(e.length==null)throw new Error("input data must be an array");if(e.length===0)return[];if(typeof e[0]=="object"){if(e[0].value==null)throw new Error("input data must have a value field");return e}else{const t=Array(e.length);for(let n=0;n<e.length;n++)t[n]={value:e[n]};return t}}var VI={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Zkt=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},Jkt=Ye&&Ye.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(VI,"__esModule",{value:!0});const Qkt=Jkt(R0),obe=ks,sbe=nf,eTt=Ha;function tTt(e,t,n={}){return Zkt(this,void 0,void 0,function*(){const r=Array.isArray(t.values[0])?t.values:[t.values],i=r[0].length,a=t.series?t.series:r.map((g,m)=>`Series ${m+1}`);sbe.assert(a.length===r.length,"Must have an equal number of series labels as there are data series"),n.seriesColors!=null&&sbe.assert(n.seriesColors.length===r.length,"Must have an equal number of series colors as there are data series");const o=[];for(let g=0;g<i;g++){const m={x:g};a.forEach((v,y)=>{const b=r[y][g].y;m[v]=b,m[`${v}-name`]=v}),o.push(m)}const s=Object.assign({},nTt,n),u=()=>{if(s.zoomToFit)return{zero:!1};if(s.yAxisDomain!=null)return{domain:s.yAxisDomain}},l={x:{field:"x",type:s.xType,title:s.xLabel},tooltip:[{field:"x",type:"quantitative"},...a.map(g=>({field:g,type:"quantitative"}))]},c=a.map(g=>({data:void 0,mark:{type:"line",clip:!0},encoding:{y:{field:g,type:s.yType,title:s.yLabel,scale:u()},color:{field:`${g}-name`,type:"nominal",legend:{values:a,title:null},scale:{range:s.seriesColors}}}})),f={mark:"rule",selection:{hover:{type:"single",on:"mouseover",nearest:!0,clear:"mouseout"}},encoding:{color:{value:"grey",condition:{selection:{not:"hover"},value:"transparent"}}}},d=eTt.getDrawArea(e),h={width:s.width||obe.getDefaultWidth(d),height:s.height||obe.getDefaultHeight(d),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:s.fontSize,titleFontSize:s.fontSize},text:{fontSize:s.fontSize},legend:{labelFontSize:s.fontSize,titleFontSize:s.fontSize}},data:{values:o},encoding:l,layer:[...c,f]},p={actions:!1,mode:"vega-lite",defaultStyle:!1};return yield Qkt.default(d,h,p),Promise.resolve()})}VI.linechart=tTt;const nTt={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11};var H7={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var rTt=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})},iTt=Ye&&Ye.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(H7,"__esModule",{value:!0});const aTt=iTt(R0),ube=ks,oTt=nf,sTt=Ha;function uTt(e,t,n={}){return rTt(this,void 0,void 0,function*(){let r=t.values;const i=t.series==null?[]:t.series;r=Array.isArray(r[0])?r:[r];const a=[];r.forEach((d,h)=>{const p=i[h]!=null?i[h]:`Series ${h+1}`,g=d.map(m=>Object.assign({},m,{series:p}));a.push(...g)}),n.seriesColors!=null&&oTt.assert(n.seriesColors.length===r.length,"Must have an equal number of series colors as there are data series");const o=sTt.getDrawArea(e),s=Object.assign({},lTt,n),u={actions:!1,mode:"vega-lite",defaultStyle:!1},l=()=>{if(s.zoomToFit)return{zero:!1};if(s.xAxisDomain!=null)return{domain:s.xAxisDomain}},c=()=>{if(s.zoomToFit)return{zero:!1};if(s.yAxisDomain!=null)return{domain:s.yAxisDomain}},f={width:s.width||ube.getDefaultWidth(o),height:s.height||ube.getDefaultHeight(o),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:s.fontSize,titleFontSize:s.fontSize},text:{fontSize:s.fontSize},legend:{labelFontSize:s.fontSize,titleFontSize:s.fontSize}},data:{values:a},mark:{type:"point",clip:!0,tooltip:{content:"data"}},encoding:{x:{field:"x",type:s.xType,title:s.xLabel,scale:l()},y:{field:"y",type:s.yType,title:s.yLabel,scale:c()},color:{field:"series",type:"nominal",scale:{range:s.seriesColors}},shape:{field:"series",type:"nominal"}}};return yield aTt.default(o,f,u),Promise.resolve()})}H7.scatterplot=uTt;const lTt={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11};var qI={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var lbe=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(qI,"__esModule",{value:!0});const cTt=VI,G7=Ha,cbe=ks;function fbe(e,t,n,r={}){return lbe(this,void 0,void 0,function*(){const i=G7.getDrawArea(e),a={};for(const l of n)if(/val_/.test(l)){const c=l.replace("val_","");dbe(a,c);const f=hbe(t,l,n.indexOf(l));a[c].series.push(l),a[c].values.push(f)}else{const c=hbe(t,l,n.indexOf(l));dbe(a,l),a[l].series.push(l),a[l].values.push(c)}const o=Object.keys(a),s=Object.assign({},{xLabel:"Iteration",yLabel:"Value"},r),u=[];for(const l of o){const c=cbe.subSurface(i,l),f=a[l].series,d=a[l].values;f.every(p=>Boolean(p.match("acc")))&&(s.zoomToFitAccuracy?s.zoomToFit=!0:(s.yAxisDomain=[0,1],delete s.zoomToFit));const h=cTt.linechart(c,{values:d,series:f},s);u.push(h)}yield Promise.all(u)})}qI.history=fbe;function dbe(e,t){e[t]==null&&(e[t]={series:[],values:[]})}function hbe(e,t,n){if(Array.isArray(e)){const r=Array.isArray(e[0])?e[n]:e,i=[];for(let a=0;a<r.length;a++){const o=r[a];i.push({x:a,y:o[t]})}return i}else return e.history[t].map((r,i)=>({x:i,y:r}))}function fTt(e,t,n={}){const r={},i=n.callbacks||["onEpochEnd","onBatchEnd"],a=G7.getDrawArea(e),o=Object.assign({},n);delete o.callbacks;function s(l){return(c,f)=>lbe(this,void 0,void 0,function*(){/batch/i.test(l)?o.xLabel="Batch":/epoch/i.test(l)&&(o.xLabel="Epoch");const d=[],h=[];for(const g of t)if(f[g]!=null){h.push(g);const m=dTt(r,l,g);m.push({[g]:f[g]}),d.push(m)}const p=cbe.subSurface(a,l,{title:l});fbe(p,d,h,o),yield G7.nextFrame()})}const u={};return i.forEach(l=>{u[l]=s(l)}),u}qI.fitCallbacks=fTt;function dTt(e,t,n){return e[t]==null&&(e[t]={}),e[t][n]==null&&(e[t][n]=[]),e[t][n]}var HI={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var GI=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(HI,"__esModule",{value:!0});const hTt=l2,pbe=Ha,gbe=L0,K7=ks,pTt=zl;function gTt(e,t){return GI(this,void 0,void 0,function*(){const n=pbe.getDrawArea(e),r=vTt(t),i=["Layer Name","Output Shape","# Of Params","Trainable"],a=r.layers.map(o=>[o.name,o.outputShape,o.parameters,o.trainable]);gbe.table(n,{headers:i,values:a})})}HI.modelSummary=gTt;function mTt(e,t){return GI(this,void 0,void 0,function*(){const n=pbe.getDrawArea(e),r=yield bTt(t),i=["Weight Name","Shape","Min","Max","# Params","# Zeros","# NaNs","# Infinity"],a=K7.subSurface(n,"layer-weights-info"),o=r.map(c=>[c.name,c.shape,c.stats.min,c.stats.max,c.weight.size,c.stats.numZeros,c.stats.numNans,c.stats.numInfs]);gbe.table(a,{headers:i,values:o});const s=K7.subSurface(n,"select-layer"),u=K7.subSurface(n,"param-distribution"),l=c=>GI(this,void 0,void 0,function*(){const d=yield r.filter(h=>h.name===c)[0].weight.data();hTt.histogram(u,d,{height:150,width:460,stats:!1})});xTt(r.map(c=>c.name),s,l)})}HI.layer=mTt;function vTt(e){return{layers:e.layers.map(yTt)}}function yTt(e){let t;return Array.isArray(e.outputShape[0])?t=`[${e.outputShape.map(r=>X7(r)).join(", ")}]`:t=X7(e.outputShape),{name:e.name,trainable:e.trainable,parameters:e.countParams(),outputShape:t}}function bTt(e){return GI(this,void 0,void 0,function*(){const t=e.getWeights(),n=e.weights,r=t.map(pTt.tensorStats),i=yield Promise.all(r),a=t.map(o=>o.shape);return t.map((o,s)=>({name:n[s].name,stats:i[s],shape:X7(a[s]),weight:o}))})}function X7(e){const t=e.slice();return t.length===0?"Scalar":(t[0]===null&&(t[0]="batch"),`[${t.join(",")}]`)}function xTt(e,t,n){const a=`<div><button>Show Values Distribution for:</button>${`
    <select>
      ${e.map(u=>`<option value=${u}>${u}</option>`)}
    </select>
  `}</div>`;t.innerHTML=a;const o=t.querySelector("button"),s=t.querySelector("select");o.addEventListener("click",()=>{n(s.selectedOptions[0].label)})}var Y7={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var wTt=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(Y7,"__esModule",{value:!0});const _Tt=Ha,STt=L0;function ETt(e,t,n){return wTt(this,void 0,void 0,function*(){const r=_Tt.getDrawArea(e),i=["Class","Accuracy","# Samples"],a=[];for(let o=0;o<t.length;o++){const s=n?n[o]:o.toString(),u=t[o];a.push([s,u.accuracy,u.count])}return STt.table(r,{headers:i,values:a})})}Y7.perClassAccuracy=ETt;var Z7={};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var CTt=Ye&&Ye.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(l){try{u(r.next(l))}catch(c){a(c)}}function s(l){try{u(r.throw(l))}catch(c){a(c)}}function u(l){l.done?i(l.value):new n(function(c){c(l.value)}).then(o,s)}u((r=r.apply(e,t||[])).next())})};Object.defineProperty(Z7,"__esModule",{value:!0});const ATt=l2,kTt=Ha,TTt=zl;function OTt(e,t){return CTt(this,void 0,void 0,function*(){const n=kTt.getDrawArea(e),r=yield TTt.tensorStats(t),i=yield t.data();ATt.histogram(n,i,{height:150,stats:r})})}Z7.valuesDistribution=OTt;var J7={};/** @license See the LICENSE file. */Object.defineProperty(J7,"__esModule",{value:!0});const ITt="1.5.1";J7.version=ITt,function(e){function t(b){for(var x in b)e.hasOwnProperty(x)||(e[x]=b[x])}Object.defineProperty(e,"__esModule",{value:!0});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n=T$,r=F7,i=M7,a=l2,o=VI,s=H7,u=L0,l=qI,c=HI,f=Y7,d=Z7,h=zl,p=J7;e.version_vis=p.version;const g={barchart:n.barchart,table:u.table,histogram:a.histogram,linechart:o.linechart,scatterplot:s.scatterplot,confusionMatrix:r.confusionMatrix,heatmap:i.heatmap};e.render=g;const m={accuracy:h.accuracy,perClassAccuracy:h.perClassAccuracy,confusionMatrix:h.confusionMatrix};e.metrics=m;const v={history:l.history,fitCallbacks:l.fitCallbacks,perClassAccuracy:f.perClassAccuracy,valuesDistribution:d.valuesDistribution,layer:c.layer,modelSummary:c.modelSummary};e.show=v;var y=r2;e.visor=y.visor,t(n2)}(ote);var mbe={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.9.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(e,t){(function(n){e.exports=n()})(function(){return function n(r,i,a){function o(l,c){if(!i[l]){if(!r[l]){var f=typeof ff=="function"&&ff;if(!c&&f)return f(l,!0);if(s)return s(l,!0);var d=new Error("Cannot find module '"+l+"'");throw d.code="MODULE_NOT_FOUND",d}var h=i[l]={exports:{}};r[l][0].call(h.exports,function(p){var g=r[l][1][p];return o(g||p)},h,h.exports,n,r,i,a)}return i[l].exports}for(var s=typeof ff=="function"&&ff,u=0;u<a.length;u++)o(a[u]);return o}({1:[function(n,r,i){(function(a){var o=a.MutationObserver||a.WebKitMutationObserver,s;if(o){var u=0,l=new o(p),c=a.document.createTextNode("");l.observe(c,{characterData:!0}),s=function(){c.data=u=++u%2}}else if(!a.setImmediate&&typeof a.MessageChannel!="undefined"){var f=new a.MessageChannel;f.port1.onmessage=p,s=function(){f.port2.postMessage(0)}}else"document"in a&&"onreadystatechange"in a.document.createElement("script")?s=function(){var m=a.document.createElement("script");m.onreadystatechange=function(){p(),m.onreadystatechange=null,m.parentNode.removeChild(m),m=null},a.document.documentElement.appendChild(m)}:s=function(){setTimeout(p,0)};var d,h=[];function p(){d=!0;for(var m,v,y=h.length;y;){for(v=h,h=[],m=-1;++m<y;)v[m]();y=h.length}d=!1}r.exports=g;function g(m){h.push(m)===1&&!d&&s()}}).call(this,typeof Ye!="undefined"?Ye:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],2:[function(n,r,i){var a=n(1);function o(){}var s={},u=["REJECTED"],l=["FULFILLED"],c=["PENDING"];r.exports=f;function f(w){if(typeof w!="function")throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,w!==o&&g(this,w)}f.prototype.catch=function(w){return this.then(null,w)},f.prototype.then=function(w,S){if(typeof w!="function"&&this.state===l||typeof S!="function"&&this.state===u)return this;var C=new this.constructor(o);if(this.state!==c){var _=this.state===l?w:S;h(C,_,this.outcome)}else this.queue.push(new d(C,w,S));return C};function d(w,S,C){this.promise=w,typeof S=="function"&&(this.onFulfilled=S,this.callFulfilled=this.otherCallFulfilled),typeof C=="function"&&(this.onRejected=C,this.callRejected=this.otherCallRejected)}d.prototype.callFulfilled=function(w){s.resolve(this.promise,w)},d.prototype.otherCallFulfilled=function(w){h(this.promise,this.onFulfilled,w)},d.prototype.callRejected=function(w){s.reject(this.promise,w)},d.prototype.otherCallRejected=function(w){h(this.promise,this.onRejected,w)};function h(w,S,C){a(function(){var _;try{_=S(C)}catch(E){return s.reject(w,E)}_===w?s.reject(w,new TypeError("Cannot resolve promise with itself")):s.resolve(w,_)})}s.resolve=function(w,S){var C=m(p,S);if(C.status==="error")return s.reject(w,C.value);var _=C.value;if(_)g(w,_);else{w.state=l,w.outcome=S;for(var E=-1,A=w.queue.length;++E<A;)w.queue[E].callFulfilled(S)}return w},s.reject=function(w,S){w.state=u,w.outcome=S;for(var C=-1,_=w.queue.length;++C<_;)w.queue[C].callRejected(S);return w};function p(w){var S=w&&w.then;if(w&&(typeof w=="object"||typeof w=="function")&&typeof S=="function")return function(){S.apply(w,arguments)}}function g(w,S){var C=!1;function _(T){C||(C=!0,s.reject(w,T))}function E(T){C||(C=!0,s.resolve(w,T))}function A(){S(E,_)}var k=m(A);k.status==="error"&&_(k.value)}function m(w,S){var C={};try{C.value=w(S),C.status="success"}catch(_){C.status="error",C.value=_}return C}f.resolve=v;function v(w){return w instanceof this?w:s.resolve(new this(o),w)}f.reject=y;function y(w){var S=new this(o);return s.reject(S,w)}f.all=b;function b(w){var S=this;if(Object.prototype.toString.call(w)!=="[object Array]")return this.reject(new TypeError("must be an array"));var C=w.length,_=!1;if(!C)return this.resolve([]);for(var E=new Array(C),A=0,k=-1,T=new this(o);++k<C;)I(w[k],k);return T;function I(N,O){S.resolve(N).then(D,function(L){_||(_=!0,s.reject(T,L))});function D(L){E[O]=L,++A===C&&!_&&(_=!0,s.resolve(T,E))}}}f.race=x;function x(w){var S=this;if(Object.prototype.toString.call(w)!=="[object Array]")return this.reject(new TypeError("must be an array"));var C=w.length,_=!1;if(!C)return this.resolve([]);for(var E=-1,A=new this(o);++E<C;)k(w[E]);return A;function k(T){S.resolve(T).then(function(I){_||(_=!0,s.resolve(A,I))},function(I){_||(_=!0,s.reject(A,I))})}}},{"1":1}],3:[function(n,r,i){(function(a){typeof a.Promise!="function"&&(a.Promise=n(2))}).call(this,typeof Ye!="undefined"?Ye:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"2":2}],4:[function(n,r,i){var a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(z){return typeof z}:function(z){return z&&typeof Symbol=="function"&&z.constructor===Symbol&&z!==Symbol.prototype?"symbol":typeof z};function o(z,Z){if(!(z instanceof Z))throw new TypeError("Cannot call a class as a function")}function s(){try{if(typeof indexedDB!="undefined")return indexedDB;if(typeof webkitIndexedDB!="undefined")return webkitIndexedDB;if(typeof mozIndexedDB!="undefined")return mozIndexedDB;if(typeof OIndexedDB!="undefined")return OIndexedDB;if(typeof msIndexedDB!="undefined")return msIndexedDB}catch(z){return}}var u=s();function l(){try{if(!u||!u.open)return!1;var z=typeof openDatabase!="undefined"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),Z=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!z||Z)&&typeof indexedDB!="undefined"&&typeof IDBKeyRange!="undefined"}catch(q){return!1}}function c(z,Z){z=z||[],Z=Z||{};try{return new Blob(z,Z)}catch(te){if(te.name!=="TypeError")throw te;for(var q=typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder,re=new q,oe=0;oe<z.length;oe+=1)re.append(z[oe]);return re.getBlob(Z.type)}}typeof Promise=="undefined"&&n(3);var f=Promise;function d(z,Z){Z&&z.then(function(q){Z(null,q)},function(q){Z(q)})}function h(z,Z,q){typeof Z=="function"&&z.then(Z),typeof q=="function"&&z.catch(q)}function p(z){return typeof z!="string"&&(console.warn(z+" used as a key, but it is not a string."),z=String(z)),z}function g(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var m="local-forage-detect-blob-support",v=void 0,y={},b=Object.prototype.toString,x="readonly",w="readwrite";function S(z){for(var Z=z.length,q=new ArrayBuffer(Z),re=new Uint8Array(q),oe=0;oe<Z;oe++)re[oe]=z.charCodeAt(oe);return q}function C(z){return new f(function(Z){var q=z.transaction(m,w),re=c([""]);q.objectStore(m).put(re,"key"),q.onabort=function(oe){oe.preventDefault(),oe.stopPropagation(),Z(!1)},q.oncomplete=function(){var oe=navigator.userAgent.match(/Chrome\/(\d+)/),te=navigator.userAgent.match(/Edge\//);Z(te||!oe||parseInt(oe[1],10)>=43)}}).catch(function(){return!1})}function _(z){return typeof v=="boolean"?f.resolve(v):C(z).then(function(Z){return v=Z,v})}function E(z){var Z=y[z.name],q={};q.promise=new f(function(re,oe){q.resolve=re,q.reject=oe}),Z.deferredOperations.push(q),Z.dbReady?Z.dbReady=Z.dbReady.then(function(){return q.promise}):Z.dbReady=q.promise}function A(z){var Z=y[z.name],q=Z.deferredOperations.pop();if(q)return q.resolve(),q.promise}function k(z,Z){var q=y[z.name],re=q.deferredOperations.pop();if(re)return re.reject(Z),re.promise}function T(z,Z){return new f(function(q,re){if(y[z.name]=y[z.name]||ce(),z.db)if(Z)E(z),z.db.close();else return q(z.db);var oe=[z.name];Z&&oe.push(z.version);var te=u.open.apply(u,oe);Z&&(te.onupgradeneeded=function(Ce){var Re=te.result;try{Re.createObjectStore(z.storeName),Ce.oldVersion<=1&&Re.createObjectStore(m)}catch(Fe){if(Fe.name==="ConstraintError")console.warn('The database "'+z.name+'" has been upgraded from version '+Ce.oldVersion+" to version "+Ce.newVersion+', but the storage "'+z.storeName+'" already exists.');else throw Fe}}),te.onerror=function(Ce){Ce.preventDefault(),re(te.error)},te.onsuccess=function(){q(te.result),A(z)}})}function I(z){return T(z,!1)}function N(z){return T(z,!0)}function O(z,Z){if(!z.db)return!0;var q=!z.db.objectStoreNames.contains(z.storeName),re=z.version<z.db.version,oe=z.version>z.db.version;if(re&&(z.version!==Z&&console.warn('The database "'+z.name+`" can't be downgraded from version `+z.db.version+" to version "+z.version+"."),z.version=z.db.version),oe||q){if(q){var te=z.db.version+1;te>z.version&&(z.version=te)}return!0}return!1}function D(z){return new f(function(Z,q){var re=new FileReader;re.onerror=q,re.onloadend=function(oe){var te=btoa(oe.target.result||"");Z({__local_forage_encoded_blob:!0,data:te,type:z.type})},re.readAsBinaryString(z)})}function L(z){var Z=S(atob(z.data));return c([Z],{type:z.type})}function W(z){return z&&z.__local_forage_encoded_blob}function G(z){var Z=this,q=Z._initReady().then(function(){var re=y[Z._dbInfo.name];if(re&&re.dbReady)return re.dbReady});return h(q,z,z),q}function K(z){E(z);for(var Z=y[z.name],q=Z.forages,re=0;re<q.length;re++){var oe=q[re];oe._dbInfo.db&&(oe._dbInfo.db.close(),oe._dbInfo.db=null)}return z.db=null,I(z).then(function(te){return z.db=te,O(z)?N(z):te}).then(function(te){z.db=Z.db=te;for(var Ce=0;Ce<q.length;Ce++)q[Ce]._dbInfo.db=te}).catch(function(te){throw k(z,te),te})}function ee(z,Z,q,re){re===void 0&&(re=1);try{var oe=z.db.transaction(z.storeName,Z);q(null,oe)}catch(te){if(re>0&&(!z.db||te.name==="InvalidStateError"||te.name==="NotFoundError"))return f.resolve().then(function(){if(!z.db||te.name==="NotFoundError"&&!z.db.objectStoreNames.contains(z.storeName)&&z.version<=z.db.version)return z.db&&(z.version=z.db.version+1),N(z)}).then(function(){return K(z).then(function(){ee(z,Z,q,re-1)})}).catch(q);q(te)}}function ce(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function he(z){var Z=this,q={db:null};if(z)for(var re in z)q[re]=z[re];var oe=y[q.name];oe||(oe=ce(),y[q.name]=oe),oe.forages.push(Z),Z._initReady||(Z._initReady=Z.ready,Z.ready=G);var te=[];function Ce(){return f.resolve()}for(var Re=0;Re<oe.forages.length;Re++){var Fe=oe.forages[Re];Fe!==Z&&te.push(Fe._initReady().catch(Ce))}var Pe=oe.forages.slice(0);return f.all(te).then(function(){return q.db=oe.db,I(q)}).then(function(je){return q.db=je,O(q,Z._defaultConfig.version)?N(q):je}).then(function(je){q.db=oe.db=je,Z._dbInfo=q;for(var it=0;it<Pe.length;it++){var Ft=Pe[it];Ft!==Z&&(Ft._dbInfo.db=q.db,Ft._dbInfo.version=q.version)}})}function Oe(z,Z){var q=this;z=p(z);var re=new f(function(oe,te){q.ready().then(function(){ee(q._dbInfo,x,function(Ce,Re){if(Ce)return te(Ce);try{var Fe=Re.objectStore(q._dbInfo.storeName),Pe=Fe.get(z);Pe.onsuccess=function(){var je=Pe.result;je===void 0&&(je=null),W(je)&&(je=L(je)),oe(je)},Pe.onerror=function(){te(Pe.error)}}catch(je){te(je)}})}).catch(te)});return d(re,Z),re}function Te(z,Z){var q=this,re=new f(function(oe,te){q.ready().then(function(){ee(q._dbInfo,x,function(Ce,Re){if(Ce)return te(Ce);try{var Fe=Re.objectStore(q._dbInfo.storeName),Pe=Fe.openCursor(),je=1;Pe.onsuccess=function(){var it=Pe.result;if(it){var Ft=it.value;W(Ft)&&(Ft=L(Ft));var bn=z(Ft,it.key,je++);bn!==void 0?oe(bn):it.continue()}else oe()},Pe.onerror=function(){te(Pe.error)}}catch(it){te(it)}})}).catch(te)});return d(re,Z),re}function De(z,Z,q){var re=this;z=p(z);var oe=new f(function(te,Ce){var Re;re.ready().then(function(){return Re=re._dbInfo,b.call(Z)==="[object Blob]"?_(Re.db).then(function(Fe){return Fe?Z:D(Z)}):Z}).then(function(Fe){ee(re._dbInfo,w,function(Pe,je){if(Pe)return Ce(Pe);try{var it=je.objectStore(re._dbInfo.storeName);Fe===null&&(Fe=void 0);var Ft=it.put(Fe,z);je.oncomplete=function(){Fe===void 0&&(Fe=null),te(Fe)},je.onabort=je.onerror=function(){var bn=Ft.error?Ft.error:Ft.transaction.error;Ce(bn)}}catch(bn){Ce(bn)}})}).catch(Ce)});return d(oe,q),oe}function me(z,Z){var q=this;z=p(z);var re=new f(function(oe,te){q.ready().then(function(){ee(q._dbInfo,w,function(Ce,Re){if(Ce)return te(Ce);try{var Fe=Re.objectStore(q._dbInfo.storeName),Pe=Fe.delete(z);Re.oncomplete=function(){oe()},Re.onerror=function(){te(Pe.error)},Re.onabort=function(){var je=Pe.error?Pe.error:Pe.transaction.error;te(je)}}catch(je){te(je)}})}).catch(te)});return d(re,Z),re}function P(z){var Z=this,q=new f(function(re,oe){Z.ready().then(function(){ee(Z._dbInfo,w,function(te,Ce){if(te)return oe(te);try{var Re=Ce.objectStore(Z._dbInfo.storeName),Fe=Re.clear();Ce.oncomplete=function(){re()},Ce.onabort=Ce.onerror=function(){var Pe=Fe.error?Fe.error:Fe.transaction.error;oe(Pe)}}catch(Pe){oe(Pe)}})}).catch(oe)});return d(q,z),q}function F(z){var Z=this,q=new f(function(re,oe){Z.ready().then(function(){ee(Z._dbInfo,x,function(te,Ce){if(te)return oe(te);try{var Re=Ce.objectStore(Z._dbInfo.storeName),Fe=Re.count();Fe.onsuccess=function(){re(Fe.result)},Fe.onerror=function(){oe(Fe.error)}}catch(Pe){oe(Pe)}})}).catch(oe)});return d(q,z),q}function V(z,Z){var q=this,re=new f(function(oe,te){if(z<0){oe(null);return}q.ready().then(function(){ee(q._dbInfo,x,function(Ce,Re){if(Ce)return te(Ce);try{var Fe=Re.objectStore(q._dbInfo.storeName),Pe=!1,je=Fe.openKeyCursor();je.onsuccess=function(){var it=je.result;if(!it){oe(null);return}z===0||Pe?oe(it.key):(Pe=!0,it.advance(z))},je.onerror=function(){te(je.error)}}catch(it){te(it)}})}).catch(te)});return d(re,Z),re}function ae(z){var Z=this,q=new f(function(re,oe){Z.ready().then(function(){ee(Z._dbInfo,x,function(te,Ce){if(te)return oe(te);try{var Re=Ce.objectStore(Z._dbInfo.storeName),Fe=Re.openKeyCursor(),Pe=[];Fe.onsuccess=function(){var je=Fe.result;if(!je){re(Pe);return}Pe.push(je.key),je.continue()},Fe.onerror=function(){oe(Fe.error)}}catch(je){oe(je)}})}).catch(oe)});return d(q,z),q}function Y(z,Z){Z=g.apply(this,arguments);var q=this.config();z=typeof z!="function"&&z||{},z.name||(z.name=z.name||q.name,z.storeName=z.storeName||q.storeName);var re=this,oe;if(!z.name)oe=f.reject("Invalid arguments");else{var te=z.name===q.name&&re._dbInfo.db,Ce=te?f.resolve(re._dbInfo.db):I(z).then(function(Re){var Fe=y[z.name],Pe=Fe.forages;Fe.db=Re;for(var je=0;je<Pe.length;je++)Pe[je]._dbInfo.db=Re;return Re});z.storeName?oe=Ce.then(function(Re){if(!!Re.objectStoreNames.contains(z.storeName)){var Fe=Re.version+1;E(z);var Pe=y[z.name],je=Pe.forages;Re.close();for(var it=0;it<je.length;it++){var Ft=je[it];Ft._dbInfo.db=null,Ft._dbInfo.version=Fe}var bn=new f(function(Cn,Dr){var dr=u.open(z.name,Fe);dr.onerror=function(Oi){var hh=dr.result;hh.close(),Dr(Oi)},dr.onupgradeneeded=function(){var Oi=dr.result;Oi.deleteObjectStore(z.storeName)},dr.onsuccess=function(){var Oi=dr.result;Oi.close(),Cn(Oi)}});return bn.then(function(Cn){Pe.db=Cn;for(var Dr=0;Dr<je.length;Dr++){var dr=je[Dr];dr._dbInfo.db=Cn,A(dr._dbInfo)}}).catch(function(Cn){throw(k(z,Cn)||f.resolve()).catch(function(){}),Cn})}}):oe=Ce.then(function(Re){E(z);var Fe=y[z.name],Pe=Fe.forages;Re.close();for(var je=0;je<Pe.length;je++){var it=Pe[je];it._dbInfo.db=null}var Ft=new f(function(bn,Cn){var Dr=u.deleteDatabase(z.name);Dr.onerror=Dr.onblocked=function(dr){var Oi=Dr.result;Oi&&Oi.close(),Cn(dr)},Dr.onsuccess=function(){var dr=Dr.result;dr&&dr.close(),bn(dr)}});return Ft.then(function(bn){Fe.db=bn;for(var Cn=0;Cn<Pe.length;Cn++){var Dr=Pe[Cn];A(Dr._dbInfo)}}).catch(function(bn){throw(k(z,bn)||f.resolve()).catch(function(){}),bn})})}return d(oe,Z),oe}var M={_driver:"asyncStorage",_initStorage:he,_support:l(),iterate:Te,getItem:Oe,setItem:De,removeItem:me,clear:P,length:F,key:V,keys:ae,dropInstance:Y};function B(){return typeof openDatabase=="function"}var R="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",X="~~local_forage_type~",ge=/^~~local_forage_type~([^~]+)~/,xe="__lfsc__:",ze=xe.length,Ke="arbf",Ze="blob",Bt="si08",Je="ui08",Zt="uic8",mn="si16",Hn="si32",ti="ur16",er="ui32",Dn="fl32",Jo="fl64",Ka=ze+Ke.length,jl=Object.prototype.toString;function Ts(z){var Z=z.length*.75,q=z.length,re,oe=0,te,Ce,Re,Fe;z[z.length-1]==="="&&(Z--,z[z.length-2]==="="&&Z--);var Pe=new ArrayBuffer(Z),je=new Uint8Array(Pe);for(re=0;re<q;re+=4)te=R.indexOf(z[re]),Ce=R.indexOf(z[re+1]),Re=R.indexOf(z[re+2]),Fe=R.indexOf(z[re+3]),je[oe++]=te<<2|Ce>>4,je[oe++]=(Ce&15)<<4|Re>>2,je[oe++]=(Re&3)<<6|Fe&63;return Pe}function Os(z){var Z=new Uint8Array(z),q="",re;for(re=0;re<Z.length;re+=3)q+=R[Z[re]>>2],q+=R[(Z[re]&3)<<4|Z[re+1]>>4],q+=R[(Z[re+1]&15)<<2|Z[re+2]>>6],q+=R[Z[re+2]&63];return Z.length%3==2?q=q.substring(0,q.length-1)+"=":Z.length%3==1&&(q=q.substring(0,q.length-2)+"=="),q}function Ul(z,Z){var q="";if(z&&(q=jl.call(z)),z&&(q==="[object ArrayBuffer]"||z.buffer&&jl.call(z.buffer)==="[object ArrayBuffer]")){var re,oe=xe;z instanceof ArrayBuffer?(re=z,oe+=Ke):(re=z.buffer,q==="[object Int8Array]"?oe+=Bt:q==="[object Uint8Array]"?oe+=Je:q==="[object Uint8ClampedArray]"?oe+=Zt:q==="[object Int16Array]"?oe+=mn:q==="[object Uint16Array]"?oe+=ti:q==="[object Int32Array]"?oe+=Hn:q==="[object Uint32Array]"?oe+=er:q==="[object Float32Array]"?oe+=Dn:q==="[object Float64Array]"?oe+=Jo:Z(new Error("Failed to get type for BinaryArray"))),Z(oe+Os(re))}else if(q==="[object Blob]"){var te=new FileReader;te.onload=function(){var Ce=X+z.type+"~"+Os(this.result);Z(xe+Ze+Ce)},te.readAsArrayBuffer(z)}else try{Z(JSON.stringify(z))}catch(Ce){console.error("Couldn't convert value into a JSON string: ",z),Z(null,Ce)}}function Wl(z){if(z.substring(0,ze)!==xe)return JSON.parse(z);var Z=z.substring(Ka),q=z.substring(ze,Ka),re;if(q===Ze&&ge.test(Z)){var oe=Z.match(ge);re=oe[1],Z=Z.substring(oe[0].length)}var te=Ts(Z);switch(q){case Ke:return te;case Ze:return c([te],{type:re});case Bt:return new Int8Array(te);case Je:return new Uint8Array(te);case Zt:return new Uint8ClampedArray(te);case mn:return new Int16Array(te);case ti:return new Uint16Array(te);case Hn:return new Int32Array(te);case er:return new Uint32Array(te);case Dn:return new Float32Array(te);case Jo:return new Float64Array(te);default:throw new Error("Unkown type: "+q)}}var af={serialize:Ul,deserialize:Wl,stringToBuffer:Ts,bufferToString:Os};function f2(z,Z,q,re){z.executeSql("CREATE TABLE IF NOT EXISTS "+Z.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],q,re)}function d2(z){var Z=this,q={db:null};if(z)for(var re in z)q[re]=typeof z[re]!="string"?z[re].toString():z[re];var oe=new f(function(te,Ce){try{q.db=openDatabase(q.name,String(q.version),q.description,q.size)}catch(Re){return Ce(Re)}q.db.transaction(function(Re){f2(Re,q,function(){Z._dbInfo=q,te()},function(Fe,Pe){Ce(Pe)})},Ce)});return q.serializer=af,oe}function ku(z,Z,q,re,oe,te){z.executeSql(q,re,oe,function(Ce,Re){Re.code===Re.SYNTAX_ERR?Ce.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[Z.storeName],function(Fe,Pe){Pe.rows.length?te(Fe,Re):f2(Fe,Z,function(){Fe.executeSql(q,re,oe,te)},te)},te):te(Ce,Re)},te)}function h2(z,Z){var q=this;z=p(z);var re=new f(function(oe,te){q.ready().then(function(){var Ce=q._dbInfo;Ce.db.transaction(function(Re){ku(Re,Ce,"SELECT * FROM "+Ce.storeName+" WHERE key = ? LIMIT 1",[z],function(Fe,Pe){var je=Pe.rows.length?Pe.rows.item(0).value:null;je&&(je=Ce.serializer.deserialize(je)),oe(je)},function(Fe,Pe){te(Pe)})})}).catch(te)});return d(re,Z),re}function fh(z,Z){var q=this,re=new f(function(oe,te){q.ready().then(function(){var Ce=q._dbInfo;Ce.db.transaction(function(Re){ku(Re,Ce,"SELECT * FROM "+Ce.storeName,[],function(Fe,Pe){for(var je=Pe.rows,it=je.length,Ft=0;Ft<it;Ft++){var bn=je.item(Ft),Cn=bn.value;if(Cn&&(Cn=Ce.serializer.deserialize(Cn)),Cn=z(Cn,bn.key,Ft+1),Cn!==void 0){oe(Cn);return}}oe()},function(Fe,Pe){te(Pe)})})}).catch(te)});return d(re,Z),re}function p2(z,Z,q,re){var oe=this;z=p(z);var te=new f(function(Ce,Re){oe.ready().then(function(){Z===void 0&&(Z=null);var Fe=Z,Pe=oe._dbInfo;Pe.serializer.serialize(Z,function(je,it){it?Re(it):Pe.db.transaction(function(Ft){ku(Ft,Pe,"INSERT OR REPLACE INTO "+Pe.storeName+" (key, value) VALUES (?, ?)",[z,je],function(){Ce(Fe)},function(bn,Cn){Re(Cn)})},function(Ft){if(Ft.code===Ft.QUOTA_ERR){if(re>0){Ce(p2.apply(oe,[z,Fe,q,re-1]));return}Re(Ft)}})})}).catch(Re)});return d(te,q),te}function Vl(z,Z,q){return p2.apply(this,[z,Z,q,1])}function KI(z,Z){var q=this;z=p(z);var re=new f(function(oe,te){q.ready().then(function(){var Ce=q._dbInfo;Ce.db.transaction(function(Re){ku(Re,Ce,"DELETE FROM "+Ce.storeName+" WHERE key = ?",[z],function(){oe()},function(Fe,Pe){te(Pe)})})}).catch(te)});return d(re,Z),re}function XI(z){var Z=this,q=new f(function(re,oe){Z.ready().then(function(){var te=Z._dbInfo;te.db.transaction(function(Ce){ku(Ce,te,"DELETE FROM "+te.storeName,[],function(){re()},function(Re,Fe){oe(Fe)})})}).catch(oe)});return d(q,z),q}function YI(z){var Z=this,q=new f(function(re,oe){Z.ready().then(function(){var te=Z._dbInfo;te.db.transaction(function(Ce){ku(Ce,te,"SELECT COUNT(key) as c FROM "+te.storeName,[],function(Re,Fe){var Pe=Fe.rows.item(0).c;re(Pe)},function(Re,Fe){oe(Fe)})})}).catch(oe)});return d(q,z),q}function ZI(z,Z){var q=this,re=new f(function(oe,te){q.ready().then(function(){var Ce=q._dbInfo;Ce.db.transaction(function(Re){ku(Re,Ce,"SELECT key FROM "+Ce.storeName+" WHERE id = ? LIMIT 1",[z+1],function(Fe,Pe){var je=Pe.rows.length?Pe.rows.item(0).key:null;oe(je)},function(Fe,Pe){te(Pe)})})}).catch(te)});return d(re,Z),re}function JI(z){var Z=this,q=new f(function(re,oe){Z.ready().then(function(){var te=Z._dbInfo;te.db.transaction(function(Ce){ku(Ce,te,"SELECT key FROM "+te.storeName,[],function(Re,Fe){for(var Pe=[],je=0;je<Fe.rows.length;je++)Pe.push(Fe.rows.item(je).key);re(Pe)},function(Re,Fe){oe(Fe)})})}).catch(oe)});return d(q,z),q}function Is(z){return new f(function(Z,q){z.transaction(function(re){re.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(oe,te){for(var Ce=[],Re=0;Re<te.rows.length;Re++)Ce.push(te.rows.item(Re).name);Z({db:z,storeNames:Ce})},function(oe,te){q(te)})},function(re){q(re)})})}function QI(z,Z){Z=g.apply(this,arguments);var q=this.config();z=typeof z!="function"&&z||{},z.name||(z.name=z.name||q.name,z.storeName=z.storeName||q.storeName);var re=this,oe;return z.name?oe=new f(function(te){var Ce;z.name===q.name?Ce=re._dbInfo.db:Ce=openDatabase(z.name,"","",0),z.storeName?te({db:Ce,storeNames:[z.storeName]}):te(Is(Ce))}).then(function(te){return new f(function(Ce,Re){te.db.transaction(function(Fe){function Pe(bn){return new f(function(Cn,Dr){Fe.executeSql("DROP TABLE IF EXISTS "+bn,[],function(){Cn()},function(dr,Oi){Dr(Oi)})})}for(var je=[],it=0,Ft=te.storeNames.length;it<Ft;it++)je.push(Pe(te.storeNames[it]));f.all(je).then(function(){Ce()}).catch(function(bn){Re(bn)})},function(Fe){Re(Fe)})})}):oe=f.reject("Invalid arguments"),d(oe,Z),oe}var eN={_driver:"webSQLStorage",_initStorage:d2,_support:B(),iterate:fh,getItem:h2,setItem:Vl,removeItem:KI,clear:XI,length:YI,key:ZI,keys:JI,dropInstance:QI};function tN(){try{return typeof localStorage!="undefined"&&"setItem"in localStorage&&!!localStorage.setItem}catch(z){return!1}}function g2(z,Z){var q=z.name+"/";return z.storeName!==Z.storeName&&(q+=z.storeName+"/"),q}function nN(){var z="_localforage_support_test";try{return localStorage.setItem(z,!0),localStorage.removeItem(z),!1}catch(Z){return!0}}function of(){return!nN()||localStorage.length>0}function rN(z){var Z=this,q={};if(z)for(var re in z)q[re]=z[re];return q.keyPrefix=g2(z,Z._defaultConfig),of()?(Z._dbInfo=q,q.serializer=af,f.resolve()):f.reject()}function iN(z){var Z=this,q=Z.ready().then(function(){for(var re=Z._dbInfo.keyPrefix,oe=localStorage.length-1;oe>=0;oe--){var te=localStorage.key(oe);te.indexOf(re)===0&&localStorage.removeItem(te)}});return d(q,z),q}function aN(z,Z){var q=this;z=p(z);var re=q.ready().then(function(){var oe=q._dbInfo,te=localStorage.getItem(oe.keyPrefix+z);return te&&(te=oe.serializer.deserialize(te)),te});return d(re,Z),re}function oN(z,Z){var q=this,re=q.ready().then(function(){for(var oe=q._dbInfo,te=oe.keyPrefix,Ce=te.length,Re=localStorage.length,Fe=1,Pe=0;Pe<Re;Pe++){var je=localStorage.key(Pe);if(je.indexOf(te)===0){var it=localStorage.getItem(je);if(it&&(it=oe.serializer.deserialize(it)),it=z(it,je.substring(Ce),Fe++),it!==void 0)return it}}});return d(re,Z),re}function sN(z,Z){var q=this,re=q.ready().then(function(){var oe=q._dbInfo,te;try{te=localStorage.key(z)}catch(Ce){te=null}return te&&(te=te.substring(oe.keyPrefix.length)),te});return d(re,Z),re}function sf(z){var Z=this,q=Z.ready().then(function(){for(var re=Z._dbInfo,oe=localStorage.length,te=[],Ce=0;Ce<oe;Ce++){var Re=localStorage.key(Ce);Re.indexOf(re.keyPrefix)===0&&te.push(Re.substring(re.keyPrefix.length))}return te});return d(q,z),q}function uN(z){var Z=this,q=Z.keys().then(function(re){return re.length});return d(q,z),q}function lN(z,Z){var q=this;z=p(z);var re=q.ready().then(function(){var oe=q._dbInfo;localStorage.removeItem(oe.keyPrefix+z)});return d(re,Z),re}function cN(z,Z,q){var re=this;z=p(z);var oe=re.ready().then(function(){Z===void 0&&(Z=null);var te=Z;return new f(function(Ce,Re){var Fe=re._dbInfo;Fe.serializer.serialize(Z,function(Pe,je){if(je)Re(je);else try{localStorage.setItem(Fe.keyPrefix+z,Pe),Ce(te)}catch(it){(it.name==="QuotaExceededError"||it.name==="NS_ERROR_DOM_QUOTA_REACHED")&&Re(it),Re(it)}})})});return d(oe,q),oe}function fN(z,Z){if(Z=g.apply(this,arguments),z=typeof z!="function"&&z||{},!z.name){var q=this.config();z.name=z.name||q.name,z.storeName=z.storeName||q.storeName}var re=this,oe;return z.name?oe=new f(function(te){z.storeName?te(g2(z,re._defaultConfig)):te(z.name+"/")}).then(function(te){for(var Ce=localStorage.length-1;Ce>=0;Ce--){var Re=localStorage.key(Ce);Re.indexOf(te)===0&&localStorage.removeItem(Re)}}):oe=f.reject("Invalid arguments"),d(oe,Z),oe}var dN={_driver:"localStorageWrapper",_initStorage:rN,_support:tN(),iterate:oN,getItem:aN,setItem:cN,removeItem:lN,clear:iN,length:uN,key:sN,keys:sf,dropInstance:fN},hN=function(Z,q){return Z===q||typeof Z=="number"&&typeof q=="number"&&isNaN(Z)&&isNaN(q)},B0=function(Z,q){for(var re=Z.length,oe=0;oe<re;){if(hN(Z[oe],q))return!0;oe++}return!1},m2=Array.isArray||function(z){return Object.prototype.toString.call(z)==="[object Array]"},Tu={},Rg={},uf={INDEXEDDB:M,WEBSQL:eN,LOCALSTORAGE:dN},Fg=[uf.INDEXEDDB._driver,uf.WEBSQL._driver,uf.LOCALSTORAGE._driver],dh=["dropInstance"],z0=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(dh),pN={description:"",driver:Fg.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function gN(z,Z){z[Z]=function(){var q=arguments;return z.ready().then(function(){return z[Z].apply(z,q)})}}function Mg(){for(var z=1;z<arguments.length;z++){var Z=arguments[z];if(Z)for(var q in Z)Z.hasOwnProperty(q)&&(m2(Z[q])?arguments[0][q]=Z[q].slice():arguments[0][q]=Z[q])}return arguments[0]}var mN=function(){function z(Z){o(this,z);for(var q in uf)if(uf.hasOwnProperty(q)){var re=uf[q],oe=re._driver;this[q]=oe,Tu[oe]||this.defineDriver(re)}this._defaultConfig=Mg({},pN),this._config=Mg({},this._defaultConfig,Z),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return z.prototype.config=function(q){if((typeof q=="undefined"?"undefined":a(q))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var re in q){if(re==="storeName"&&(q[re]=q[re].replace(/\W/g,"_")),re==="version"&&typeof q[re]!="number")return new Error("Database version must be a number.");this._config[re]=q[re]}return"driver"in q&&q.driver?this.setDriver(this._config.driver):!0}else return typeof q=="string"?this._config[q]:this._config},z.prototype.defineDriver=function(q,re,oe){var te=new f(function(Ce,Re){try{var Fe=q._driver,Pe=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!q._driver){Re(Pe);return}for(var je=z0.concat("_initStorage"),it=0,Ft=je.length;it<Ft;it++){var bn=je[it],Cn=!B0(dh,bn);if((Cn||q[bn])&&typeof q[bn]!="function"){Re(Pe);return}}var Dr=function(){for(var hh=function(yN){return function(){var Pg=new Error("Method "+yN+" is not implemented by the current driver"),$g=f.reject(Pg);return d($g,arguments[arguments.length-1]),$g}},j0=0,U0=dh.length;j0<U0;j0++){var W0=dh[j0];q[W0]||(q[W0]=hh(W0))}};Dr();var dr=function(hh){Tu[Fe]&&console.info("Redefining LocalForage driver: "+Fe),Tu[Fe]=q,Rg[Fe]=hh,Ce()};"_support"in q?q._support&&typeof q._support=="function"?q._support().then(dr,Re):dr(!!q._support):dr(!0)}catch(Oi){Re(Oi)}});return h(te,re,oe),te},z.prototype.driver=function(){return this._driver||null},z.prototype.getDriver=function(q,re,oe){var te=Tu[q]?f.resolve(Tu[q]):f.reject(new Error("Driver not found."));return h(te,re,oe),te},z.prototype.getSerializer=function(q){var re=f.resolve(af);return h(re,q),re},z.prototype.ready=function(q){var re=this,oe=re._driverSet.then(function(){return re._ready===null&&(re._ready=re._initDriver()),re._ready});return h(oe,q,q),oe},z.prototype.setDriver=function(q,re,oe){var te=this;m2(q)||(q=[q]);var Ce=this._getSupportedDrivers(q);function Re(){te._config.driver=te.driver()}function Fe(it){return te._extend(it),Re(),te._ready=te._initStorage(te._config),te._ready}function Pe(it){return function(){var Ft=0;function bn(){for(;Ft<it.length;){var Cn=it[Ft];return Ft++,te._dbInfo=null,te._ready=null,te.getDriver(Cn).then(Fe).catch(bn)}Re();var Dr=new Error("No available storage method found.");return te._driverSet=f.reject(Dr),te._driverSet}return bn()}}var je=this._driverSet!==null?this._driverSet.catch(function(){return f.resolve()}):f.resolve();return this._driverSet=je.then(function(){var it=Ce[0];return te._dbInfo=null,te._ready=null,te.getDriver(it).then(function(Ft){te._driver=Ft._driver,Re(),te._wrapLibraryMethodsWithReady(),te._initDriver=Pe(Ce)})}).catch(function(){Re();var it=new Error("No available storage method found.");return te._driverSet=f.reject(it),te._driverSet}),h(this._driverSet,re,oe),this._driverSet},z.prototype.supports=function(q){return!!Rg[q]},z.prototype._extend=function(q){Mg(this,q)},z.prototype._getSupportedDrivers=function(q){for(var re=[],oe=0,te=q.length;oe<te;oe++){var Ce=q[oe];this.supports(Ce)&&re.push(Ce)}return re},z.prototype._wrapLibraryMethodsWithReady=function(){for(var q=0,re=z0.length;q<re;q++)gN(this,z0[q])},z.prototype.createInstance=function(q){return new z(q)},z}(),vN=new mN;r.exports=vN},{"3":3}]},{},[4])(4)})})(mbe);var NTt=mbe.exports;export{c3e as $,st as A,wa as B,fDe as C,xK as D,pDe as E,dDe as F,hDe as G,Bwe as H,G_ as I,Zbe as J,IDe as K,$De as L,mK as M,DDe as N,v3e as O,TS as P,m3e as Q,FDe as R,DG as S,ZDe as T,PDe as U,p3e as V,WDe as W,BDe as X,X_ as Y,le as Z,u3e as _,jFe as a,l3e as a0,d3e as a1,f3e as a2,NTt as a3,Bg as a4,q1e as a5,Oke as a6,vK as b,bK as c,Vi as d,K6e as e,wG as f,Uu as g,QLe as h,H1e as i,Rze as j,ote as k,an as l,V1e as m,Ybe as n,x3e as o,eBe as p,JDe as q,Wf as r,pt as s,tRe as t,VU as u,ue as v,eRe as w,QDe as x,qt as y,nRe as z};
//# sourceMappingURL=vendor.9dc21fde.js.map
